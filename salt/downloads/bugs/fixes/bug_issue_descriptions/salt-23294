Hi,

I just managed to trigger a funny bug I need some input from you guys.

```
$ salt --versions
           Salt: 2014.7.5
         Python: 2.7.5 (default, Jun 17 2014, 18:11:42)
         Jinja2: 2.7.2
       M2Crypto: 0.21.1
 msgpack-python: 0.4.6
   msgpack-pure: Not Installed
       pycrypto: 2.6.1
        libnacl: Not Installed
         PyYAML: 3.10
          ioflo: Not Installed
          PyZMQ: 14.3.1
           RAET: Not Installed
            ZMQ: 3.2.5
           Mako: Not Installed
```

Target file:

```
$ cat /etc/sysconfig/network-scripts/ifcfg-eth1
# Generated by parse-kickstart
UUID=c8f0fafb-ea51-40f4-83fa-a4a7e709c5eb
GATEWAY=
IPV6_AUTOCONF=yes
BOOTPROTO=none
DEVICE=eth1
ONBOOT=yes
IPV6INIT=yes
TYPE=Ethernet
IPADDR=10.2.6.3
PREFIX=24
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6_DEFROUTE=yes
IPV6_PEERDNS=no
IPV6_PEERROUTES=yes
IPV6_FAILURE_FATAL=no
NAME="System eth1"
```

The issue is that I want to manage my own /etc/resolv.conf file with salt hence I have no DNS specification in my interface config. Redhat manages /etc/resolv.conf by default with PEERDNS=yes resulting an empty resolv.conf file after reboot so I have to append PEERDNS=no to my interface config for BOTH IPV6 and IPV4 to avoid this. As you can see, the installer only added IPV6_PEERDNS so my search string is partially available in the file content.

```
$ vim test.sls
test:
  file.replace:
    - name: /etc/sysconfig/network-scripts/ifcfg-eth1
    - pattern: funnybug
    - repl: PEERDNS=no
    - append_if_not_found: True

$ salt -v test.centos state.sls test
Executing job with jid 20150502115657247951
-------------------------------------------

test.centos:
----------
          ID: test
    Function: file.replace
        Name: /etc/sysconfig/network-scripts/ifcfg-eth1
      Result: True
     Comment: No changes needed to be made
     Started: 11:57:00.147777
    Duration: 2.554 ms
     Changes:

Summary
------------
Succeeded: 1
Failed:    0
------------
Total states run:     1
```

funnybug is not part of the target file and the reason why the repl string is not appended is caused by the logic which is trying to check if it was already appended:
https://github.com/saltstack/salt/blob/2014.7/salt/modules/file.py#L1125
https://github.com/saltstack/salt/blob/2014.7/salt/modules/file.py#L1155
Even if I specified ^string to specifically indicate line start, it is not taken into account.

I would not know right now how I would tackle this sort of issue so if you guys think it is not something worth to fix, I just fall back to cmd.run solution.

Thanks,
Ivan
