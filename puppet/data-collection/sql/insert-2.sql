INSERT INTO `bugs_fixes_filtered` (`system`, `issue_id`, `pull_request_id`, `number`, `title`, `body`, `issue_url`, `pull_request_url`, `created_at`, `closed_at`, `updated_at`, `state`, `labels`, `comments`, `comments_url`, `commits`, `additions`, `deletions`, `changed_files`, `commits_data`) VALUES
('puppet', 222712, 153447189, 6373, 'The PAL API evaluation methods does not instantiate definitions', 'When using Puppet::Pal to evaluate string, file, or parsed model, the methods does not instantiate the definitions (functions, plans, etc). The only way to get definitions is to define the environment with a main manifest.\r\n\r\nThe evaluating methods should also instantiate the definitions.', 'https://tickets.puppetlabs.com/browse/PUP-8185', 'https://github.com/puppetlabs/puppet/pull/6373', '2017-11-18T03:27:02.000-0800', '2018-02-15T06:49:16.000-0800', '2018-02-15T06:49:16.000-0800', 'Closed', '', 1, '0', 1, 61, 2, 2, '06ed5cb8d69ab52fa79b10d0cec9e7883344ed82'),
('puppet', 231987, 167792688, 6619, 'NameService inconsistent with setting the environment in which commands are executed', 'When we execute commands to create, set, and modify something on the system, we should be maintaining a consistent environment. Currently, when we create that thing, we''re passing in a custom environment (as defined in {{lib/puppet/provider/nameservice.rb}})\r\n\r\n{code}\r\n167   def create\r\n168     if exists?\r\n169       info _("already exists")\r\n170       # The object already exists\r\n171       return nil\r\n172     end\r\n173\r\n174     begin\r\n175       execute(self.addcmd, {:failonfail => true, :combine => true, :custom_environment => @custom_environment})\r\n176       if feature?(:manages_password_age) && (cmd = passcmd)\r\n177         execute(cmd)\r\n178       end\r\n179     rescue Puppet::ExecutionFailure => detail\r\n180       raise Puppet::Error, _("Could not create %{resource} %{name}: %{detail}") % { resource: @resource.class.name, name: @resource.name, detail: detail }, detail.backtrace\r\n181     end\r\n182   end\r\n{code}\r\n\r\nbut not when we set or delete with the same command\r\n{code}\r\n184   def delete\r\n185     unless exists?\r\n186       info _("already absent")\r\n187       # the object already doesn''t exist\r\n188       return nil\r\n189     end\r\n190\r\n191     begin\r\n192       execute(self.deletecmd)\r\n193     rescue Puppet::ExecutionFailure => detail\r\n194       raise Puppet::Error, _("Could not delete %{resource} %{name}: %{detail}") % { resource: @resource.class.name, name: @resource.name, detail: detail }, detail.backtrace\r\n195     end\r\n196   end\r\n.\r\n.\r\n.\r\n299   def set(param, value)\r\n300     self.class.validate(param, value)\r\n301     cmd = modifycmd(param, munge(param, value))\r\n302     raise Puppet::DevError, _("Nameservice command must be an array") unless cmd.is_a?(Array)\r\n303     begin\r\n304       execute(cmd)\r\n305     rescue Puppet::ExecutionFailure => detail\r\n306       raise Puppet::Error, _("Could not set %{param} on %{resource}[%{name}]: %{detail}") % { param: param, resource: @resource.class.name, name: @resource.name, detail: detail },     detail.backtrace\r\n307     end\r\n308   end\r\n{code}\r\n\r\nAll of these execution environments should be consistent, if that is the desired behavior defined in the provider.', 'https://tickets.puppetlabs.com/browse/PUP-8374', 'https://github.com/puppetlabs/puppet/pull/6619', '2018-01-19T15:57:15.000-0800', '2018-02-15T06:49:17.000-0800', '2018-02-15T06:49:17.000-0800', 'Closed', '', 2, '0', 1, 60, 60, 8, '6468ee982a722472350006f201990611850d9129'),
('puppet', 221191, 151606334, 6347, 'run_script function does not accept arguments', 'The run_script function does not accept arguments and does not pass anything on to the Bolt executor. As a result, any attempt to use run_script fails.\r\n\r\nThe run_script function should accept a variable number of {{String}} arguments. The data type is {{String}} because the arguments are basically arguments as given on a command line and such can only be strings.', 'https://tickets.puppetlabs.com/browse/PUP-8137', 'https://github.com/puppetlabs/puppet/pull/6347', '2017-11-09T01:26:33.000-0800', '2018-02-15T06:49:17.000-0800', '2018-02-15T06:49:17.000-0800', 'Closed', '', 1, '0', 1, 39, 6, 2, '6f34359ddb37df605042a24e3c05d101fa869d5e'),
('puppet', 224761, 154350032, 6389, 'Tidy should only log a notice if there are changes to be made', 'If there are 0 files to delete, we still emit a notice message: {{Tidying 0 files}}. The resource should be "insync" if there aren''t any files to delete.', 'https://tickets.puppetlabs.com/browse/PUP-8219', 'https://github.com/puppetlabs/puppet/pull/6389', '2017-11-29T17:37:17.000-0800', '2018-02-15T06:49:17.000-0800', '2018-02-15T06:49:17.000-0800', 'Closed', '', 1, '0', 1, 4, 2, 1, 'b36a6b41c6876d82daec397bfec8595e1af16df6'),
('puppet', 228129, 160719785, 6479, 'Puppet rejects tasks with valid non-Data types like ''Hash''', '*Puppet Version:* Bolt\r\n\r\nPuppet Tasks can only accept parameters as JSON. However it should be valid in task metadata to use puppet types that *may* be assignable to JSON like bare {{Hash}}. Puppet seems to be rejecting these\r\n\r\n{code}\r\nError: Failed to load metadata for task example_tasks::hash_get: Task initializer has wrong type, entry ''parameters'' entry ''data'' entry ''type'' expects a Type[Data] value, got Type[Hash] in /Users/adreyer/src/puppetlabs/puppetconf_modules/example_tasks/tasks/hash_get.json\r\n{code}\r\n\r\n\r\n*Desired Behavior:*\r\n\r\nTask metadata that gives parameters types that may be assignable to {{Data}} should be considered valid.\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet refuses to load tasks that use types which are not assignable to {{Data}} like {{Hash}}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8283', 'https://github.com/puppetlabs/puppet/pull/6479', '2017-12-21T09:28:17.000-0800', '2018-02-15T06:49:18.000-0800', '2018-02-15T06:49:18.000-0800', 'Closed', '', 4, '0', 1, 49, 22, 2, '391efb8b0b7de0a03db92e4c0598690286fcd5e8'),
('puppet', 221194, 151606301, 6346, 'Ruby true and false should be inferred to corresponding parameterized Boolean data type', 'This ticket addresses an oversight in the implementation of PUP-8117. The {{TypeCalculator}} should of course infer {{true}} to {{Boolean\[true]}} and false to {{Boolean\[false]}}. They are presently just inferred as {{Boolean}}', 'https://tickets.puppetlabs.com/browse/PUP-8138', 'https://github.com/puppetlabs/puppet/pull/6346', '2017-11-09T01:48:43.000-0800', '2018-02-15T06:49:18.000-0800', '2018-02-15T06:49:18.000-0800', 'Closed', '', 4, '0', 1, 7, 7, 3, 'a27116e79dde66f09445b58810c34aa81ea3ce4c'),
('puppet', 223845, 154844655, 6391, 'loader.discover(:type) with --tasks on crashes because it tries to load rake tasks in puppet', 'The puppet code base has a directory named "tasks" that contains rake tasks.\r\nWhen trying to discover all data types and --tasks is on, the loader will try to load those as if they were instances of Task.\r\n\r\nThis fails miserably in task_instantiator with the following stack trace:\r\n{code}\r\n     Failure/Error: constants[''executable''] = Pathname(task_source).relative_path_from(Pathname(loader.path) + ''tasks'').to_s\r\n\r\n     Puppet::Error:\r\n       no implicit conversion of nil into String on node henrik2\r\n     # ./lib/puppet/pops/loader/task_instantiator.rb:95:in `initialize''\r\n     # ./lib/puppet/pops/loader/task_instantiator.rb:95:in `Pathname''\r\n     # ./lib/puppet/pops/loader/task_instantiator.rb:95:in `create_task_type_from_hash''\r\n     # ./lib/puppet/pops/loader/task_instantiator.rb:31:in `create_task_type''\r\n     # ./lib/puppet/pops/loader/task_instantiator.rb:26:in `create''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:222:in `instantiate''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:198:in `find''\r\n     # ./lib/puppet/pops/loader/base_loader.rb:161:in `internal_load''\r\n     # ./lib/puppet/pops/loader/base_loader.rb:42:in `load_typed''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:117:in `block (2 levels) in discover''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:114:in `each''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:114:in `block in discover''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:113:in `each''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:113:in `discover''\r\n     # ./lib/puppet/pops/loader/base_loader.rb:28:in `discover''\r\n     # ./lib/puppet/pops/loader/module_loaders.rb:121:in `discover''\r\n     # ./lib/puppet/pops/loader/dependency_loader.rb:28:in `block in discover''\r\n     # ./lib/puppet/pops/loader/dependency_loader.rb:28:in `each''\r\n     # ./lib/puppet/pops/loader/dependency_loader.rb:28:in `discover''\r\n     # ./lib/puppet_pal.rb:213:in `list_loadable_kind''\r\n     # ./lib/puppet_pal.rb:265:in `list_tasks''\r\n     # ./spec/unit/puppet_pal_2pec.rb:674:in `block (7 levels) in <top (required)>''\r\n     # ./lib/puppet_pal.rb:611:in `call''\r\n     # ./lib/puppet_pal.rb:611:in `block (2 levels) in main''\r\n     # ./lib/puppet/parser/script_compiler.rb:47:in `block in compile''\r\n     # ./lib/puppet/context.rb:65:in `override''\r\n     # ./lib/puppet.rb:263:in `override''\r\n     # ./lib/puppet/parser/script_compiler.rb:42:in `compile''\r\n     # ./lib/puppet_pal.rb:609:in `block in main''\r\n     # ./lib/puppet/context.rb:65:in `override''\r\n     # ./lib/puppet.rb:263:in `override''\r\n     # ./lib/puppet_pal.rb:578:in `main''\r\n     # ./lib/puppet_pal.rb:341:in `block in with_script_compiler''\r\n     # ./lib/puppet/context.rb:65:in `override''\r\n     # ./lib/puppet.rb:263:in `override''\r\n     # ./lib/puppet_pal.rb:338:in `with_script_compiler''\r\n     # ./spec/unit/puppet_pal_2pec.rb:674:in `block (6 levels) in <top (required)>''\r\n     # ./lib/puppet_pal.rb:506:in `call''\r\n     # ./lib/puppet_pal.rb:506:in `block in in_environment_context''\r\n     # ./lib/puppet/context.rb:65:in `override''\r\n     # ./lib/puppet.rb:263:in `override''\r\n     # ./lib/puppet_pal.rb:498:in `in_environment_context''\r\n     # ./lib/puppet_pal.rb:398:in `in_tmp_environment''\r\n     # ./spec/unit/puppet_pal_2pec.rb:673:in `block (5 levels) in <top (required)>''\r\n{code}\r\n\r\nIt fails because loader.path is nil. The real problem is that it should not try to load tasks from puppet in that location.', 'https://tickets.puppetlabs.com/browse/PUP-8204', 'https://github.com/puppetlabs/puppet/pull/6391', '2017-11-22T15:26:17.000-0800', '2018-02-15T06:49:19.000-0800', '2018-02-15T06:49:19.000-0800', 'Closed', '', 1, '0', 2, 104, 12, 3, '17dacc44dc3e7da14652af0736bed56da5e1b891'),
('puppet', 220050, 150555174, 6336, 'Init[T] close to unusuable due to relaxed signatures in several core data types', 'A total "WAT" feast occurs when trying to use {{Init}} data type with several of the core data types.\r\n{code:puppet}\r\n"blue" =~ Init[Boolean]  # true - WAT\r\n"sock" =~ Init[Integer] # true - WAT\r\n"salami" =~ Init[Float] # true - WAT\r\n{code}\r\n...this because the {{new}} method is typed to accept {{String}} instead of an appropriately constrained string.\r\n\r\nReview all new operator signatures for the core type to ensure that only acceptable initialization values match an Init. ', 'https://tickets.puppetlabs.com/browse/PUP-8121', 'https://github.com/puppetlabs/puppet/pull/6336', '2017-11-02T09:18:15.000-0700', '2018-02-15T06:49:19.000-0800', '2018-02-15T06:49:19.000-0800', 'Closed', '', 0, '0', 3, 245, 79, 6, '07452ecd3b34925f80d965a7efc8ce28da4b4229'),
('puppet', 212189, 142416245, 6227, 'gem package provider doesn''t match exact on windows', 'When calling the gemlist and gemsplit commands (https://github.com/puppetlabs/puppet/blob/5.2.0/lib/puppet/provider/package/gem.rb#L22-L71) the provider attempts an exact match with {{^}} and {{$}} however on windows only the {{$}} is honored:\r\n{noformat}\r\nC:\Program Files\Puppet Labs\Puppet\sys\ruby\bin>gem.bat list --remote ^pry$\r\n\r\n*** REMOTE GEMS ***\r\n\r\nawesome-pry (0.0.4)\r\nawesome_pry (0.0.1)\r\nbetter_errors-pry (1.0.2)\r\ndebugger-pry (0.1.1)\r\ndontkillmypry (0.0.1)\r\nfog-pry (0.0.1)\r\nlemme-pry (0.5.0)\r\nmiddleman-pry (1.0.1)\r\npry (0.11.0 ruby java, 0.10.2 i386-mingw32 i386-mswin32 x64-mingw32)\r\nrack-webconsole-pry (0.1.9)\r\nrails-console-pry (0.0.5)\r\nrails-pry (0.0.1)\r\nruby-debug-pry (0.0.3)\r\nspry (0.0.2)\r\nsuper-pry (0.1.1)\r\nweb-console-pry (0.2.1)\r\n{noformat}\r\n\r\nIf instead we use {{\A}} and {{\z}} then it functions as expected:\r\n\r\n{noformat}\r\nC:\Program Files\Puppet Labs\Puppet\sys\ruby\bin>gem.bat list --remote \Apry\z\r\n\r\n*** REMOTE GEMS ***\r\n\r\npry (0.11.0 ruby java, 0.10.2 i386-mingw32 i386-mswin32 x64-mingw32)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7973', 'https://github.com/puppetlabs/puppet/pull/6227', '2017-09-21T11:40:38.000-0700', '2018-02-15T06:50:14.000-0800', '2018-02-15T06:50:14.000-0800', 'Closed', '', 5, '0', 1, 2, 2, 2, '2d8a595a38f93bcc91c7ed89ac35b5fe2894df74'),
('puppet', 210505, 140761574, 6199, 'Scope.to_s fails if there is no source and no path to env in Environment obj', 'If the environment does not refer to an actual environment directory the {{Scope.to_s}} method will fail when running {{puppet script}} since the {{Environment}} instance has a {{nil}} path.', 'https://tickets.puppetlabs.com/browse/PUP-7945', 'https://github.com/puppetlabs/puppet/pull/6199', '2017-09-12T13:34:02.000-0700', '2018-02-15T06:50:16.000-0800', '2018-02-15T06:50:16.000-0800', 'Closed', '', 0, '0', 2, 6, 2, 1, '29e6d397bb7c4d837b634b991643641db4619967'),
('puppet', 213226, 143172780, 6235, 'run_task crashes with bad message when passed a string that doesn''t represent a task', 'When the first argument to run_task is a string that doesn''t resolve to a {{Task}}, an attempt is till made to call to #new using the {{nil}} value returned from the loader and errors with "''new'' parameter ''type'' expects a Type value, got Undef".', 'https://tickets.puppetlabs.com/browse/PUP-7994', 'https://github.com/puppetlabs/puppet/pull/6235', '2017-09-26T08:41:55.000-0700', '2018-02-15T06:50:16.000-0800', '2018-02-15T06:50:16.000-0800', 'Closed', '', 0, '0', 1, 13, 0, 3, '46635670bb30f01acf531db0637b6233e8856ef0'),
('puppet', 215714, 145900140, 6277, 'Add test to assert that task metadata type is validated according to spec.', 'The {{Puppet::Pops::Loader::TaskInstantiator}} performs rigid type checking of the task metadata and since the specification for this metadata has changed ("puppet_task_version" is now an {{Integer}} rather than a {{String}}), a maint release has been merged to also change the actual type used when performing the check.\r\n\r\nAdditional tests are needed that verifies that the declared type used for the check has 100% conformance to the specification.', 'https://tickets.puppetlabs.com/browse/PUP-8043', 'https://github.com/puppetlabs/puppet/pull/6277', '2017-10-11T00:45:35.000-0700', '2018-02-15T06:50:16.000-0800', '2018-02-15T06:50:16.000-0800', 'Closed', '', 0, '0', 1, 33, 2, 1, '8d647c759faa23fcddbcaabd23a385cfb285866c'),
('puppet', 217191, 147659081, 6291, 'cannot extract partial result from errors in plans', 'Given a simple task:\r\n\r\n{code}\r\n#!/opt/puppetlabs/puppet/bin/ruby\r\n\r\nrequire ''json''\r\n\r\nputs Time.now\r\nexit 1\r\n{code}\r\n\r\nAnd a plan:\r\n\r\n{code}\r\nplan mymod () {\r\n  $r = run_task("mymod::sample", ["dev1"])\r\n  $r.error_nodes.each |$node, $error| {\r\n    notice($node)\r\n    notice($error)\r\n    if $error =~ Error {\r\n      notice($error.partial_result())\r\n    }\r\n  }\r\n}\r\n{code}\r\n\r\nI expect to get the data out of partial result, but:\r\n\r\n{code}\r\nbolt plan run mymod --modules .\r\nWarning: Support for ruby version 2.0.0 is deprecated and will be removed in a future release. See https://docs.puppet.com/puppet/latest/system_requirements.html#ruby for a list of supported ruby versions.\r\n   (at /home/rip/.gem/ruby/gems/bolt-0.5.1/vendored/puppet/lib/puppet.rb:134:in `<module:Puppet>'')\r\nNotice: Scope(/home/rip/temp/bolts/mymod/plans/init.pp, 4): dev1\r\nNotice: Scope(/home/rip/temp/bolts/mymod/plans/init.pp, 5): Error({''message'' => ''The task failed with exit code 1'', ''kind'' => ''puppetlabs.tasks/task-error'', ''issue_code'' => ''TASK_ERROR'', ''partial_result'' => "2017-10-19 12:23:59 +0200\n", ''details'' => {''exit_code'' => 1}})\r\nError: Evaluation Error: Unknown function: ''partial_result''. at /home/rip/temp/bolts/mymod/plans/init.pp:6:34 on node dev2.devco.net\r\nExiting because of an error in Puppet code\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8070', 'https://github.com/puppetlabs/puppet/pull/6291', '2017-10-19T03:24:30.000-0700', '2018-02-15T06:50:16.000-0800', '2018-02-15T06:50:16.000-0800', 'Closed', '', 1, '0', 5, 225, 403, 15, '4b19284f77dfbea716ecaa73f70d4397e7b68058'),
('puppet', 212092, 157059421, 6427, 'debug message for notify relationship is inaccurate - should be ''notifies'' not ''subscribes''', 'When a resource subscribes to another resource, the debug output is as you might expect. Given:\r\n\r\n{code}\r\nclass foo {\r\n  exec { ''notify test'':\r\n    command => ''/usr/bin/true'',\r\n    refreshonly => true,\r\n  }\r\n}\r\n\r\nclass test {\r\n  include foo\r\n  exec { ''test'':\r\n    command => ''/usr/bin/true'',\r\n    subscribe => Class[''foo''],\r\n  }\r\n}\r\n\r\ninclude test\r\n{code}\r\n\r\nThis debug line is logged:\r\n{code}\r\nDebug: /Stage[main]/Test/Exec[test]/subscribe: subscribes to Class[Foo]\r\n{code}\r\n\r\nAll good so far. But if I have a notify, I get the _same_ line. I.e., given:\r\n{code}\r\n    notify => Class[''foo''],\r\n{code}\r\n\r\nI get:\r\n{code}\r\nDebug: /Stage[main]/Test/Exec[test]/notify: subscribes to Class[Foo]\r\n{code}\r\n\r\nThis line should read "*notifies* Class\[Foo\]", not "*subscribes* to Class\[Foo]".\r\n\r\nThis is important because this aspect of puppet is already hard enough to understand without inaccurate relationship reporting between resources. In puppet it is a very different thing to say something subscribes to another thing vs notifies it.', 'https://tickets.puppetlabs.com/browse/PUP-7969', 'https://github.com/puppetlabs/puppet/pull/6427', '2017-09-20T15:08:43.000-0700', '2018-02-15T06:50:17.000-0800', '2018-02-15T06:50:17.000-0800', 'Closed', 'beginner;the-goods', 3, '0', 6, 29, 3, 1, 'f0ff1eaa20560f125a73770fe624bafc831e57e2'),
('puppet', 217384, 152045311, 6355, 'Make it possible to create parameterized Object data types', 'It is currently not possible to create an {{Object}} data type that is parameterized. The type itself can thus only be used to filter instances based on their type, not on contents. This is highly desirable in some cases.\r\n\r\nA first implementation should allow parameterized types to be created with filtering logic implemented in Ruby. Later, we might add predefined filters such as using {{Pattern}}, {{String}}, or {{Enum}} to match string attributes, min/max filters for magnitudes, or {{Boolean}} filters to match if attributes have a value or not.\r\n\r\nThe parameters for an {{Object}} type can be added using a new top level property named {{type_parameters}}. The value of this property is a hash similar to {{attributes}} where a parameter declaration is a subset of an attribute declaration. The parameter can have a {{type}} and a {{value}} but is different from an attribute in that a parameter is always optional (a required parameter would break the current pattern where a fully generalized type exists for each parameterized type).\r\n\r\nA parameterized `Object` type, when serialized, must retain the values of its parameters.\r\n\r\nExample:\r\n{code:puppet}\r\ntype Error = Object[\r\n  type_parameters => {\r\n    kind => Variant[String, Regexp, Type[Enum], Type[Pattern]],\r\n    issue_code => Variant[String, Regexp, Type[Enum], Type[Pattern]]\r\n  },\r\n  attributes => {\r\n    message => String[1],\r\n    kind => { type => Optional[String[1]], value => undef },\r\n    issue_code => { type => Optional[String[1]], value => ''ERROR'' },\r\n    partial_result => { type => Data, value => undef },\r\n    details => { type => Optional[Hash[String[1],Data]], value => undef },\r\n  }]\r\n{code}\r\n\r\nThe above declaration makes it possible to create a parameterized {{Error}} by either providing no parameters at all, one {{Hash}} parameter with named arguments, or one or two anonymous (positional) arguments.', 'https://tickets.puppetlabs.com/browse/PUP-8078', 'https://github.com/puppetlabs/puppet/pull/6355', '2017-10-20T02:00:54.000-0700', '2018-02-15T06:50:17.000-0800', '2018-02-15T06:50:17.000-0800', 'Closed', '', 3, '0', 1, 22, 1, 3, '4bf35381322fe380612578c71c3fe2f85d1bd352'),
('puppet', 218980, 149182637, 6317, 'Add ''acltype'' to list of supported ZFS properties', 'The property ''acltype'' is a valid ZFS property:\r\n\r\n\r\n{noformat}\r\n[root@host ~]# zfs get all zpool1/files | grep acltype\r\nzpool1/files  acltype               posixacl               inherited from zpool1\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8098', 'https://github.com/puppetlabs/puppet/pull/6317', '2017-10-27T05:55:24.000-0700', '2018-02-15T06:50:18.000-0800', '2018-02-15T06:50:18.000-0800', 'Closed', 'community', 3, '0', 1, 28, 2, 3, 'c58e5a306413a4ec31d5c9a1264e2b7d9a758c63'),
('puppet', 211477, 141651799, 6210, 'Puppet uses SHA1 when revoking certificates', 'When Puppet revokes a certificate and updates the corresponding CRL, it uses SHA1 for generating the [CRL signature|https://github.com/puppetlabs/puppet/blob/5.2.0/lib/puppet/ssl/certificate_revocation_list.rb#L108]. SHA1 is being deprecated and should be replaced by SHA256 or better.', 'https://tickets.puppetlabs.com/browse/PUP-7957', 'https://github.com/puppetlabs/puppet/pull/6210', '2017-09-18T09:22:23.000-0700', '2018-02-15T06:50:19.000-0800', '2018-02-15T06:50:19.000-0800', 'Closed', '', 4, '0', 1, 9, 2, 3, '33ea4938864185c5d38e77004b38e893ce8eec3d'),
('puppet', 210293, 153682389, 6375, 'extra "." or missing "." in csr message', 'I was reviewing the puppet.po file for Japanese when I noticed these 2 messages which are very similar. We appear to end a sentence of the message on line 2, but in the 2nd case there is no "." before we start the next sentence: "  To continue"...\r\n\r\n{code}\r\n#: ../lib/puppet/ssl/certificate_authority.rb:397\r\nmsgid ""\r\n"CSR ''%{csr}'' contains a subjectAltName outside the DNS label space: "\r\n"%{alt_names}.  To continue, this CSR needs to be cleaned."\r\nmsgstr ""\r\n"CSR ''%{csr}''にDNSラベルスペース外のsubjectAltNameが含まれています: "\r\n"%{alt_names}。続行するには、このCSRを削除する必要があります。"\r\n\r\n#: ../lib/puppet/ssl/certificate_authority.rb:402\r\nmsgid ""\r\n"CSR ''%{csr}'' subjectAltName contains a wildcard, which is not allowed: "\r\n"%{alt_names}  To continue, this CSR needs to be cleaned."\r\nmsgstr ""\r\n"CSR ''%{csr}'' subjectAltNameに、許可されていないワイルドカードが含まれています: "\r\n"%{alt_names}。続行するには、このCSRを削除する必要があります。 "\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7937', 'https://github.com/puppetlabs/puppet/pull/6375', '2017-09-11T13:54:57.000-0700', '2018-02-15T06:50:20.000-0800', '2018-02-15T06:50:20.000-0800', 'Closed', '', 2, '0', 1, 1, 1, 1, 'f3279da64bc2f77cfb28df07048392e86f8a0297'),
('puppet', 216664, 165523907, 6580, 'Failing acceptance tests in FIPS mode', 'Following acceptance tests fail when running in FIPS mode using PA linked against system openssl. \r\n\r\n* acceptance/tests/face/loadable_from_modules.rb\r\n* acceptance/tests/loader/func4x_loadable_from_modules.rb\r\n* acceptance/tests/modules/build/build_agent.rb\r\n* acceptance/tests/modules/build/build_should_not_create_changes.rb\r\n* acceptance/tests/modules/install/basic_install.rb\r\n* acceptance/tests/modules/install/with_version.rb\r\n* acceptance/tests/parser_functions/calling_all_functions.rb\r\n* acceptance/tests/puppet_apply_a_file_should_create_a_file_and_report_the_md5.rb\r\n* acceptance/tests/resource/file/content_attribute.rb\r\n* acceptance/tests/ticket_1334_clientbucket_corrupted.rb\r\n* acceptance/tests/ticket_6541_invalid_filebucket_files.rb\r\n\r\nThey need to be investigated and adjusted appropriately.', 'https://tickets.puppetlabs.com/browse/PUP-8066', 'https://github.com/puppetlabs/puppet/pull/6580', '2017-10-17T15:19:26.000-0700', '2018-02-15T06:50:21.000-0800', '2018-02-15T06:50:21.000-0800', 'Closed', '', 7, '0', 1, 60, 4, 7, '52bf2650efa701cbe1ec93f0356aefd0dd928739'),
('puppet', 216292, 146769158, 6285, 'Error type docs show new from hash - does not work as intended', 'The plan error docs https://puppet.com/docs/bolt/0.5/writing_plans.html#returning-errors-in-plans suggest this would work:\r\n\r\n{code}\r\nplan mymodule::myplan {\r\n  Error(\r\n    message    => "Sorry, this plan does not work yet.",\r\n    kind       => ''mymodule/error'',\r\n    issue_code => ''NOT_IMPLEMENTED''\r\n    )\r\n  }\r\n{code}\r\n\r\nThis gives:\r\n\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Function Call, ''new_error'' parameter ''message'' expects a String value, got Struct at /home/rip/temp/bolts/mymod/plans/discover.pp:2:3 on node dev2.devco.net\r\n{code}\r\n\r\nAppears the code does not support that syntax it wants params of strings https://github.com/puppetlabs/puppet/blob/7fce55c2395df4c9547220169f82c97bb92b4574/lib/puppet/pops/types/p_error_type.rb#L59\r\n\r\nHenrik points out and I seem to recall that there''s something that should allow a hash to be passed in and mapped to param names - this might be the actual thing thats broken (Henrik: yes this is an implementation bug).', 'https://tickets.puppetlabs.com/browse/PUP-8056', 'https://github.com/puppetlabs/puppet/pull/6285', '2017-10-16T04:41:20.000-0700', '2018-02-15T06:50:22.000-0800', '2018-02-15T06:50:22.000-0800', 'Closed', '', 9, '0', 1, 24, 0, 2, 'f039f33112c136465c523d8419a2b2380f0aea03'),
('puppet', 23162, 128046071, 6026, 'puppet device cannot create certs when run as root', 'broken -- output of `puppet device --debug` when ran as root:\r\n{noformat}\r\ninfo: Creating a new SSL key for 10.0.1.3\r\nerr: Could not request certificate: Could not write /var/opt/lib/pe-puppet/devices/10.0.1.3/ssl/private_keys/10.0.1.3.pem to privatekeydir: Permission denied - /var/opt/lib/pe-puppet/devices/10.0.1.3/ssl/private_keys/10.0.1.3.pem\r\n{noformat}\r\n\r\nsuccess -- output of `puppet device --debug` when ran as a normal user:\r\n{noformat}\r\nwarning: peer certificate won''t be verified in this SSL session\r\ninfo: Caching certificate for ca\r\nwarning: peer certificate won''t be verified in this SSL session\r\nwarning: peer certificate won''t be verified in this SSL session\r\ninfo: Creating a new SSL certificate request for 10.0.1.3\r\ninfo: Certificate Request fingerprint (md5): 6C:1C:4C:37:A7:1D:B3:6E:F3:94:25:67:55:27:89:4C\r\nwarning: peer certificate won''t be verified in this SSL session\r\ndebug: Using cached certificate for ca\r\nwarning: peer certificate won''t be verified in this SSL session\r\ninfo: Caching certificate for 10.0.1.3\r\n{noformat}\r\n\r\nNote, that you have to copy `/etc/puppetlabs/puppet/device.conf` to `~/.puppet/`', 'https://tickets.puppetlabs.com/browse/PUP-1391', 'https://github.com/puppetlabs/puppet/pull/6026', '2014-01-08T02:37:50.000-0800', '2018-02-15T06:51:34.000-0800', '2018-02-15T06:51:34.000-0800', 'Closed', 'redmine', 8, '0', 1, 2, 0, 1, '12101b1d103eb13c280a619f0a2f0f17f50d4941'),
('puppet', 207700, 137499651, 6154, 'Make node_terminus=ldap working with jruby/puppetserver', '* jruby-ldap does not provide a to_hash method - add a ldap_entry_to_hash() method based on jruby-ldap PR#5\r\n* the environment parameter from ldap was accessed with a string instead of a symbol (or the PR#5 in jruby-ldap did not replicate ruby-ldap''s behaviour correctly)\r\n* remove environment from parameters hash to prevent duplicate declaration error\r\n* downcase key in ldap_entry_to_hash for consistent key names and to ensure acceptable puppet variable names (first char needs to be lowercase in any case)\r\n\r\nSee also: SERVER-711, https://github.com/jruby/jruby-ldap/pull/5, https://groups.google.com/forum/#!topic/puppet-users/DKu4e7dzhvE', 'https://tickets.puppetlabs.com/browse/PUP-7883', 'https://github.com/puppetlabs/puppet/pull/6154', '2017-08-27T00:31:50.000-0700', '2018-02-15T06:51:34.000-0800', '2018-02-15T06:51:34.000-0800', 'Closed', '', 3, '0', 5, 34, 15, 2, 'd1f9ceec1c77fc5ba786d64e09e8605635cef003'),
('puppet', 196301, 146342487, 6282, 'The ZFS zoned property is not portable', 'On Solaris ZFS has a ''zoned'' property. On Linux it''s a noop, on FreeBSD it is called ''jailed''.  \r\n\r\nExemple :\r\n\r\n{noformat}\r\n$ bundle exec puppet resource zfs\r\nError: Could not run: Execution of ''/sbin/zfs get -H -o value zoned SSD'' returned 2: bad property list: invalid property ''zoned''\r\n{noformat}\r\n\r\n{{/sbin/zfs get -H -o value zoned SSD}} should be {{/sbin/zfs get -H -o value jailed SSD}} on FreeBSD', 'https://tickets.puppetlabs.com/browse/PUP-7672', 'https://github.com/puppetlabs/puppet/pull/6282', '2017-06-16T05:16:25.000-0700', '2018-02-15T06:51:36.000-0800', '2018-02-15T06:51:36.000-0800', 'Closed', '', 3, '0', 5, 54, 2, 2, '5b1a9e1eeaf1ef80f55515cc3422fb01f7aa37ac'),
('puppet', 66895, 157064432, 6428, 'Error message gives wrong advice for allowed module names', 'Under some conditions, Puppet will issue an error message like {{Error: Invalid module name .gitignore; module names must be alphanumeric (plus ''-''), not ''.gitignore''}}. \r\n\r\nThat''s wrong! You should definitely never have hyphens in your module names, but underscores are encouraged. \r\n\r\nThe docs do not list hyphens as valid characters in module and class names, and we''ve publicly stated for years that it''s a bug that it works and we''ll make it stop working at our earliest convenience. \r\n\r\nHere''s the relevant code:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/module.rb#L343', 'https://tickets.puppetlabs.com/browse/PUP-3963', 'https://github.com/puppetlabs/puppet/pull/6428', '2015-02-04T16:56:57.000-0800', '2018-02-15T06:51:37.000-0800', '2018-02-15T06:51:37.000-0800', 'Closed', 'beginner;community;puppethack;the-goods', 4, '0', 1, 5, 1, 1, '37ae1f801489e441f8aea4504886d07022cd093f'),
('puppet', 198699, 128435021, 6033, 'package latest method does not refresh metadata on Solaris', 'The current behavior from `latest` does not refresh package metadata. \r\n\r\nSimply adding `pkg(:refresh)` to `latest` addresses the minor issue. \r\n\r\nA refactor to use `pkg update -n res` will be undertaken at a later date.', 'https://tickets.puppetlabs.com/browse/PUP-7745', 'https://github.com/puppetlabs/puppet/pull/6033', '2017-06-30T11:28:49.000-0700', '2018-02-15T06:51:38.000-0800', '2018-02-15T06:51:38.000-0800', 'Closed', '', 3, '0', 1, 6, 0, 2, '13c3570856ba15a2dd67b0d77c0f6c955d2b6156'),
('puppet', 120825, 156598949, 6419, 'puppet apply -e states "syntax error at end of file" when there is no file', '{code}\r\n$> puppet apply -e ''assert_type(type(Integer, "yes. hello")''\r\nError: Could not parse for environment production: Syntax error at end of file on node r794dzncqml7hgf.delivery.puppetlabs.net\r\n{code}\r\n\r\ni believe this is a regression, or duplicate ticket, but i could not find the older ticket (if it exists)', 'https://tickets.puppetlabs.com/browse/PUP-6043', 'https://github.com/puppetlabs/puppet/pull/6419', '2016-03-10T16:34:20.000-0800', '2018-02-15T06:51:38.000-0800', '2018-02-15T06:51:38.000-0800', 'Closed', '', 4, '0', 1, 3, 3, 2, '48277552fc88a37bfe28d08d6f9a210181295c7c'),
('puppet', 91330, 162194795, 6508, '"puppet module build" fails on FIPS-enabled system', 'When I try to run {{puppet module build .}} to package up my module, the following messages happen:\r\n\r\n{noformat}\r\nmd5_dgst.c(78): OpenSSL internal error, assertion failed: Digest MD5 forbidden in FIPS mode!\r\nAborted (core dumped)\r\n{noformat}\r\n\r\nAnd it doesn''t make the tar.gz I wanted it to.\r\n\r\nThe Ruby code that causes the crash(*) is the checksum method of the Puppet::ModuleTool::Checksums module, in lib/puppet/module_tool/checksums.rb. I looked in the source of 3.7.4, in my oldest copy of Puppet (2.7.something), and in the trunk on GitHub, and found in all places that the module_tool/checksums.rb solely uses MD5, which does not work in FIPS mode.\r\n\r\nIn the case of Puppet itself (PUP-1840), the fix for the failure of MD5 under FIPS mode was to let FIPS users dictate the digest algorithm to be used at their own site. This issue, in contrast, appears to be a matter of the definition of a Puppet module, and therefore necessarily global. Does the definition of checksums.json allow solely for MD5 checksums? \r\n\r\nAside: My Ruby interpreter (1.8.7.374-4.el6_6), like all Ruby interpreters, has the bug reported at https://bugs.ruby-lang.org/issues/9659, which makes the Ruby interpreter crash when Digest::MD5 is used in FIPS mode, instead of raising an exception. You may note that the issue has languished, even though a patch has been provided. If anyone else, who worked for a company that uses Ruby a lot, were to want this rough edge of Ruby filed off, they may want to tell the Ruby folks.\r\n\r\n(*) To get the Ruby backtrace, I ran `puppet module build` inside gdb, and used the trick from http://weblog.jamisbuck.org/2006/9/22/inspecting-a-live-ruby-process to get the Ruby backtrace. On a 64-bit system, I had to use "long" instead of "int", 16 instead of 8, and 24 instead of 12.', 'https://tickets.puppetlabs.com/browse/PUP-4963', 'https://github.com/puppetlabs/puppet/pull/6508', '2015-07-30T15:39:47.000-0700', '2018-02-15T06:51:38.000-0800', '2018-02-15T06:51:38.000-0800', 'Closed', 'fips;help_wanted', 3, '0', 1, 46, 0, 12, '0df67c6333cdde0eee42409c56fe396cda23aa69'),
('puppet', 159155, 111333963, 5730, 'OSX: Warning output when using puppet resource service', '_puppet resource service .*_ always seems to include some warning output.\r\npuppet seems to be able to query and modify services despite the warning.\r\n\r\n{code}rfoie66a86vs98y:~ root# puppet resource service puppet\r\nWarning: The /System/Library/LaunchDaemons/com.apple.jetsamproperties.Mac.plist plist does not contain a ''label'' key; Puppet is skipping it\r\nservice { ''puppet'':\r\n  ensure => ''stopped'',\r\n  enable => ''false'',\r\n}\r\nrfoie66a86vs98y:~ root# puppet resource service pxp-agent\r\nWarning: The /System/Library/LaunchDaemons/com.apple.jetsamproperties.Mac.plist plist does not contain a ''label'' key; Puppet is skipping it\r\nservice { ''pxp-agent'':\r\n  ensure => ''running'',\r\n  enable => ''true'',\r\n}\r\nrfoie66a86vs98y:~ root# puppet resource service dragons\r\nWarning: The /System/Library/LaunchDaemons/com.apple.jetsamproperties.Mac.plist plist does not contain a ''label'' key; Puppet is skipping it\r\nservice { ''dragons'':\r\n  ensure => ''absent'',\r\n}{code}', 'https://tickets.puppetlabs.com/browse/PUP-6854', 'https://github.com/puppetlabs/puppet/pull/5730', '2016-11-01T03:47:47.000-0700', '2018-02-15T06:51:41.000-0800', '2018-02-15T06:51:41.000-0800', 'Closed', '', 6, '0', 1, 24, 8, 1, '2ed43ac67cf2e8fdb354773d0c48b7de72620970'),
('puppet', 102773, 164454761, 6562, 'config set ignores --section and can insert duplicate settings if they are in [main]', '{code}\r\n[root@qcpd7c0tnvnp4kd ~]# cat /etc/puppetlabs/puppet/puppet.conf\r\n# This file can be used to override the default puppet settings.\r\n# See the following links for more details on what settings are available:\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html\r\n# - https://docs.puppetlabs.com/references/latest/configuration.html\r\n[main]\r\nserver = exl7i0vi62ouagu.delivery.puppetlabs.net\r\nenvironment = production\r\n[agent]\r\ncertname = qcpd7c0tnvnp4kd.delivery.puppetlabs.net\r\nserver = exl7i0vi62ouagu.delivery.puppetlabs.net\r\n[root@qcpd7c0tnvnp4kd ~]# puppet config set environment node_ordering --section agent\r\n[root@qcpd7c0tnvnp4kd ~]# cat /etc/puppetlabs/puppet/puppet.conf\r\n# This file can be used to override the default puppet settings.\r\n# See the following links for more details on what settings are available:\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html\r\n# - https://docs.puppetlabs.com/references/latest/configuration.html\r\n[main]\r\nserver = exl7i0vi62ouagu.delivery.puppetlabs.net\r\nenvironment = node_ordering\r\nenvironment = production\r\n[agent]\r\ncertname = qcpd7c0tnvnp4kd.delivery.puppetlabs.net\r\nserver = exl7i0vi62ouagu.delivery.puppetlabs.net\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5426', 'https://github.com/puppetlabs/puppet/pull/6562', '2015-10-23T14:27:02.000-0700', '2018-02-15T06:51:42.000-0800', '2018-02-15T06:51:42.000-0800', 'Closed', '', 10, '0', 1, 25, 0, 2, '2489c43f00718df0dcd925cb1c5a398da8b618c9'),
('puppet', 203364, 146350709, 6283, 'AIX mount resource remounts without options', 'When using NFS mounts on an AIX agent with the mount resource, the remount does not ensure the options persist. The `mount -o remount filesystem` does not read from `/etc/filesystems` on AIX so the options are not present in the remount.\r\n\r\nBelow is an example of a remount that strips the options from the mount on a remount. \r\n\r\n{code}\r\n0] [AIX] root@pe-aix-71-support:~ # mount\r\n  node       mounted        mounted over    vfs       date        options\r\n-------- ---------------  ---------------  ------ ------------ ---------------\r\n10.32.171.166 /tmp/test        /mnt/test        nfs3   Aug 01 08:47 rw,bg,hard,nointr,rsize=32768,wsize=32768,timeo=600\r\n[0] [AIX] root@pe-aix-71-support:~ # puppet apply mount.pp\r\nNotice: Compiled catalog for pe-aix-71-support.delivery.puppetlabs.net in environment production in 0.18 seconds\r\nNotice: /Stage[main]/Main/Mount[/mnt/test]/options: options changed ''rw,bg,hard,nointr,rsize=32768,wsize=32768,timeo=600,account=true,mount=true'' to ''rw,bg,hard,nointr,rsize=32768,wsize=32768,timeo=600,mount=true,account=true,''\r\nNotice: /Stage[main]/Main/Mount[/mnt/test]: Triggered ''refresh'' from 1 events\r\nNotice: Applied catalog in 0.22 seconds\r\n[0] [AIX] root@pe-aix-71-support:~ # mount\r\n  node       mounted        mounted over    vfs       date        options\r\n-------- ---------------  ---------------  ------ ------------ ---------------\r\n10.32.171.166 /tmp/test        /mnt/test        nfs3   Aug 01 08:47\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7807', 'https://github.com/puppetlabs/puppet/pull/6283', '2017-08-01T08:49:35.000-0700', '2018-02-15T06:51:42.000-0800', '2018-02-15T06:51:42.000-0800', 'Closed', '', 6, '0', 4, 43, 13, 2, '1ef4450c00bc101aab0973b8770c3474d3e322ba'),
('puppet', 200584, 130712845, 6075, 'yumrepo don''t support payload_gpgcheck option', 'Since RHEL 7.4 an new yum repo option is available to verify the payload of an rpm package.\r\nSee [here|https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7-Beta/html/7.4_Release_Notes/new_features_system_and_subscription_management.html] for the description of it. ', 'https://tickets.puppetlabs.com/browse/PUP-7781', 'https://github.com/puppetlabs/puppet/pull/6075', '2017-07-15T01:55:10.000-0700', '2018-02-15T06:51:43.000-0800', '2018-02-15T06:51:43.000-0800', 'Closed', '', 2, '0', 1, 14, 0, 2, 'e7745fd9b096ec4b91d42fbfed3bebe84450343b'),
('puppet', 52027, 166088332, 6592, 'config set adds a preceding newline to value if previous value was empty', 'Using `puppet config set` to set a value if the value was previously present, puts the value on a separate line and makes the config file unparsable.\r\n\r\nSteps to reproduce\r\n1. Either add a config entry by hand or with config set with no value\r\n2. Use `puppet config set` to set the entry with a value\r\n\r\nResult: The value is placed on a separate line.\r\n\r\nExample session showing the error:\r\n{code}\r\n[root@centos6-64-ma environmentpath.6nQgZ4]# cat my.conf \r\n[main]\r\n    foo = bar\r\n    bar = baz\r\n[root@centos6-64-ma environmentpath.6nQgZ4]# puppet config  set foo '''' --section main --config my.conf \r\n[root@centos6-64-ma environmentpath.6nQgZ4]# cat my.conf \r\n[main]\r\n    foo = \r\n    bar = baz\r\n[root@centos6-64-ma environmentpath.6nQgZ4]# puppet config  set foo ''bar'' --section main --config my.conf \r\n[root@centos6-64-ma environmentpath.6nQgZ4]# cat my.conf \r\n[main]\r\n    foo = \r\nbar\r\n    bar = baz\r\n[root@centos6-64-ma environmentpath.6nQgZ4]# puppet config  set foo ''foo'' --section main --config my.conf \r\nError: Could not parse /tmp/environmentpath.6nQgZ4/my.conf: Could not match line bar\r\n at /tmp/environmentpath.6nQgZ4/my.conf:3\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3321', 'https://github.com/puppetlabs/puppet/pull/6592', '2014-09-19T16:32:11.000-0700', '2018-02-15T06:51:43.000-0800', '2018-02-15T06:51:43.000-0800', 'Closed', '', 4, '0', 1, 41, 1, 2, '582ae94e5f84a034ffa767a0edffd27ee1566d17'),
('puppet', 212111, 144211649, 6249, 'In module ruby loading does not work in Pal API', 'I was hacking on some bolt plans today, specifically how I could re-use existing Puppet functions to augment plans.  I''ve ran into an issue where bolt isn''t loading some code shipped in modules.\r\n\r\nWhen Google built the recent release of the GCP modules they added a lot of in ruby module code: {{https://github.com/GoogleCloudPlatform/puppet-google-auth/blob/master/lib/google/authorization.rb}}.  If I use a function that requires {{google/authorization}} then I get a failure in bolt but not when running a {{puppet apply}}.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8007', 'https://github.com/puppetlabs/puppet/pull/6249', '2017-09-20T16:56:22.000-0700', '2018-02-15T06:58:01.000-0800', '2018-02-15T06:58:01.000-0800', 'Closed', '', 5, '0', 1, 63, 25, 2, '093b49c2f386a83f764005cc0bfc23ce45b1ee56'),
('puppet', 214732, 145920258, 6279, 'Puppet considers directories as tasks', 'When puppet loads tasks from a module it does not exclude directories this means that \r\n\r\nCurrently the following module has two tasks:\r\n<module>\r\n<module>::foo\r\nIt should only have a single task <module> and the directory should be ignore.\r\n{noformat}\r\n.\r\n└── tasks\r\n    ├── foo\r\n    │   └── bar.sh\r\n    ├── init.json\r\n    └── init.rb\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8028', 'https://github.com/puppetlabs/puppet/pull/6279', '2017-10-05T10:39:44.000-0700', '2018-02-15T06:58:01.000-0800', '2018-02-15T06:58:01.000-0800', 'Closed', '', 4, '0', 2, 91, 0, 3, '86dc0fdc9ce57386e3844fefcdde18f9331e35ca'),
('puppet', 226845, 166602626, 6600, 'Cached catalogs settings are ignored if noop is set to true', 'When using the following configuration options together:\r\n\r\n{code}\r\n[agent]\r\nuse_cached_catalog = true\r\nnoop = true\r\n{code}\r\n\r\nCached catalogs settings are ignored and a new catalog is compiled every run.  It is desirable to use both of these items together if you are controlling the rollout of changes (cached catalogs) and having to do so during change windows (noop); but still want the ability to remediate drift against the original catalog (cached catalogs; `puppet agent -t`).  \r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8258', 'https://github.com/puppetlabs/puppet/pull/6600', '2017-12-15T11:26:39.000-0800', '2018-02-15T11:28:25.000-0800', '2018-02-15T11:28:25.000-0800', 'Closed', '', 9, '0', 2, 67, 36, 10, '038ee85453558ff850b9f2388a777f437279ce72'),
('puppet', 216691, 151931846, 6352, 'Selector expression ignored in some scenarios', 'Hello,\r\n\r\nIn some situations, a selector expression will be ignored in favor of the statement that it''s testing. This seems like an operator precedence problem.\r\n\r\nThe following manifest should notify two lines, "I am an array", and "I am still an array":\r\n{code:puppet}\r\n$value = ''nonsense''\r\n\r\n$test = [\r\n  ''I am'',\r\n  $value =~ Array ? {\r\n    default => ''not an array'',\r\n    true    => ''an array'',\r\n  },\r\n].join('' '')\r\n\r\n$test2 = [\r\n  ''I am still'',\r\n  ($value =~ Array) ? {\r\n    default => ''not an array'',\r\n    true    => ''an array'',\r\n  },\r\n].join('' '')\r\n\r\nnotify{ $test: }\r\nnotify{ $test2: }\r\n{code}\r\nInstead, the first notify becomes "I am false", because "$value =~ Array" resolves without consulting the selector.\r\nThe parentheses in $test2''s assignment seem to workaround this behavior. \r\n\r\n\r\nAnd similarly in a function, the same occurs due to implicit returning:\r\n{code:puppet}\r\n$value = ''asdasd''\r\n\r\nfunction test_broken ($item) {\r\n  $value =~ /\d/ ? {\r\n    default => ''non-numeric'',\r\n    true    => ''numeric'',\r\n  }\r\n}\r\n\r\nfunction test_works ($item) {\r\n  ($value =~ /\d/) ? {\r\n    default => ''non-numeric'',\r\n    true    => ''numeric'',\r\n  }\r\n}\r\n$x = test_broken($value)\r\n$y = test_works($value)\r\nnotify{ "$x": }\r\nnotify{ "$y": }\r\n{code}\r\n\r\n\r\nThe following manifest should notify ''I am less than or equal to three''::\r\n{code:puppet}\r\n$value = 3\r\n\r\n$test = [\r\n  ''I am'',\r\n  $value > 3 ? {\r\n    default => ''less than or equal to three'',\r\n    true    => ''larger than three'',\r\n  },\r\n].join('' '')\r\n{code}\r\nThe parser instead errors with:\r\n\r\n{code}\r\nEvaluation Error: Comparison of: Integer > String, is not possible. Caused by ''A Numeric is not comparable to non Numeric''. at /test.pp:5:10\r\n{code}\r\n\r\nIf I can provide further information or help in any way with this issue, please let me know.', 'https://tickets.puppetlabs.com/browse/PUP-8067', 'https://github.com/puppetlabs/puppet/pull/6352', '2017-10-17T16:55:38.000-0700', '2018-02-17T09:19:35.000-0800', '2018-02-17T09:19:35.000-0800', 'Closed', 'parser;selector', 17, '0', 1, 583, 573, 3, '10e4a9b7c0bfb777857d3d56a9150312ad31fcea'),
('puppet', 154391, 94244536, 5387, 'systemd provider does not understand "indirect" status / tries to turn off service on each run', 'Following occurs with each puppet run, which causes annoyance:\r\n_*Service[rpcbind]/enable: enable changed ''true'' to ''false''*_\r\n\r\nThe rpcbind service returns "indirect" as a status to is-enabled\r\n_*/bin/systemctl is-enabled rpcbind\r\nindirect*_\r\n\r\nThis presumably causes puppet to constantly think it''s not turned off (standard output should be enabled/disabled\r\n\r\nAdditional info from systemctl\r\n_*/bin/systemctl status  rpcbind.service\r\nâ rpcbind.service - RPC bind service\r\n   Loaded: loaded (/usr/lib/systemd/system/rpcbind.service; indirect; vendor preset: enabled)\r\n   Active: inactive (dead)*\r\n_\r\n\r\nNote that a workaround is to set enable to "true" and ensure to "stopped" to keep it stopped, BUT that requires the hosts to have rpcbind installed - if it is not then it produces an error in the puppet run.', 'https://tickets.puppetlabs.com/browse/PUP-6759', 'https://github.com/puppetlabs/puppet/pull/5387', '2016-09-30T04:37:00.000-0700', '2018-02-28T02:46:16.000-0800', '2018-02-28T02:46:16.000-0800', 'Resolved', 'maintenance;provider;resolved-issue-added;systemd', 5, '0', 1, 11, 1, 2, 'd458739418e83c430a7098416b234a835c3102a2'),
('puppet', 111721, 50740711, 4450, 'yumrepo doesn''t handle enabled => false correctly', 'This code:\r\n{code}\r\n  yumrepo { ''puppetlabs-pc1'':\r\n    ensure   => present,\r\n    baseurl  => ''http://yum.puppetlabs.com/el/7/dependencies/$basearch'',\r\n    descr    => ''Puppet Labs PC1 Repository el 7 - $basearch'',\r\n    enabled  => false,\r\n    gpgkey   => ''file:///etc/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs-PC1'',\r\n    gpgcheck => false,\r\n  }\r\n{code}\r\n\r\nGenerates this repo file:\r\n{code}\r\n[puppetlabs-pc1]\r\nname=Puppet Labs PC1 Repository el 7 - $basearch\r\nbaseurl=http://yum.puppetlabs.com/el/7/dependencies/$basearch\r\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs-PC1\r\n{code}\r\n\r\n`enabled` and `gpgcheck` are now missing from the configuration, and the yum default seems to be to enable the repository:\r\n{code}\r\n[root@node1 vagrant]# yum repolist\r\nLoaded plugins: fastestmirror\r\nLoading mirror speeds from cached hostfile\r\n * base: ftp-stud.fht-esslingen.de\r\n * extras: mirror.ratiokontakt.de\r\n * updates: ftp-stud.fht-esslingen.de\r\nrepo id                                                   repo name                                                                    status\r\nbase/7/x86_64                                             CentOS-7 - Base                                                              9,007\r\nextras/7/x86_64                                           CentOS-7 - Extras                                                              191\r\npuppetlabs-pc1/x86_64                                     Puppet Labs PC1 Repository el 7 - x86_64                                        17\r\nupdates/7/x86_64                                          CentOS-7 - Updates                                                             458\r\nrepolist: 9,673\r\n{code}\r\n\r\nIt works when it''s being used like this:\r\n{code}\r\n  yumrepo { ''puppetlabs-pc1'':\r\n    ensure   => present,\r\n    baseurl  => ''http://yum.puppetlabs.com/el/7/dependencies/$basearch'',\r\n    descr    => ''Puppet Labs PC1 Repository el 7 - $basearch'',\r\n    enabled  => ''false'',\r\n    gpgkey   => ''file:///etc/pki/rpm-gpg/RPM-GPG-KEY-puppetlabs-PC1'',\r\n    gpgcheck => ''false'',\r\n  }\r\n{code}\r\n\r\nTested this on the following systems and got the same behavior:\r\nPuppet 4.3.1 on CentOS 7.0.1406\r\nPuppet 3.8.4 on CentOS 6.6\r\n\r\nNote that if you previously set\r\n{code}\r\n  enabled => ''true'',\r\n{code}\r\n\r\nand then switch this later to: \r\n{code}\r\n  enabled => false,\r\n{code}\r\nThe repo file will not get changed at all.\r\n\r\n\r\nAlso setting these to true/enabled/yes in the configuration file is undocumented behavior, quote `man yum.conf`:\r\n{quote}\r\nenabled Either `1'' or `0''. This tells yum whether or not use this repository.\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-5682', 'https://github.com/puppetlabs/puppet/pull/4450', '2016-01-09T02:08:25.000-0800', '2018-03-08T11:42:27.000-0800', '2018-03-08T11:42:27.000-0800', 'Closed', '', 0, '0', 1, 23, 3, 3, 'b3ed6415bfdacfefb6df5148cb968eebe35b857e'),
('puppet', 233929, 166073947, 6591, 'Puppet benchmarks fail due to gettext-setup initialization', '*Puppet Version:* 5.3.x\r\n*Puppet Server Version:* n/a\r\n\r\nRunning puppet benchmarks fails:\r\n\r\n{noformat}\r\n$ bx rake benchmark:many_modules:run\r\nmkdir -p /var/folders/8m/d6146zxd6bv_3h8y4ykvvxh40000gn/T/many_modules20180130-73932-2mw6bc\r\n                 user     system      total        real\r\nRun 1      rake aborted!\r\nno implicit conversion of nil into String\r\n/Users/josh/work/puppet/lib/puppet/module.rb:316:in `join''\r\n/Users/josh/work/puppet/lib/puppet/module.rb:316:in `has_translations?''\r\n/Users/josh/work/puppet/lib/puppet/gettext/module_translations.rb:12:in `block in load_from_modulepath''\r\n/Users/josh/work/puppet/lib/puppet/gettext/module_translations.rb:11:in `each''\r\n/Users/josh/work/puppet/lib/puppet/gettext/module_translations.rb:11:in `load_from_modulepath''\r\n/Users/josh/work/puppet/lib/puppet/node/environment.rb:444:in `use_text_domain''\r\n/Users/josh/work/puppet/lib/puppet/indirector/catalog/compiler.rb:52:in `find''\r\n{noformat}\r\n\r\nThe issue is that puppet sets FastGettext.default_available_locales to nil to prevent FastGettext from selecting the best available default locale. Later puppet''s Rakefile loads the gettext-setup gem. It sets FastGettext.default_available_locales to empty string (instead of nil). This activates the "available locales" machinery in FastGettext. Then GettextSetup.initialize tries to set the default locale, which due to the empty array causes the default locale to be set to nil.\r\n\r\n{noformat}\r\n(byebug) best_locale_in(new_locale)\r\nnil\r\n(byebug) new_locale\r\n"en"\r\n{noformat}\r\n\r\nThis is only an issue when running puppet via the Rakefile, e.g. benchmarks and {{rake parallel:spec}}, not when puppet is running from source, e.g. {{bundle exec puppet agent}} or from packages.', 'https://tickets.puppetlabs.com/browse/PUP-8407', 'https://github.com/puppetlabs/puppet/pull/6591', '2018-01-30T11:11:03.000-0800', '2018-03-12T10:45:57.000-0700', '2018-03-12T10:45:57.000-0700', 'Closed', '', 2, '0', 1, 7, 5, 1, '4ad1f430c09df91238e9710fb617786b36a08efa'),
('puppet', 21413, 688117746, 8692, 'Exported resources is exporting to the database with --noop flag', 'When I run puppet with the noop flag resources are being exported to the\r\ndb.\r\n\r\nI would expect it to simulate the transaction with the db...\r\n\r\nThis is causing things like nagios host resources being created before the plugins get there, so I get invalid alerts.\r\n\r\n-Andrew', 'https://tickets.puppetlabs.com/browse/PUP-1079', 'https://github.com/puppetlabs/puppet/pull/8692', '2013-12-16T11:03:02.000-0800', '2018-03-14T02:04:17.000-0700', '2018-03-14T02:04:17.000-0700', 'Needs Information', 'customer;needs_decision;redmine', 10, '0', 1, 2, 2, 2, '2c4e357a9b1eb0303ee4acb1d9baab3632678b83'),
('puppet', 236277, 0, 0, 'ENC acceptance tests didn''t catch regression', '*Puppet Version:* 5.3.x\r\n*Puppet Server Version:* 5.1.x\r\n\r\nWe have various beaker acceptance tests to ensure agent and server-specified environments work as expected. Unfortunately they did not catch the regression introduced by PUP-8225 and fixed in PUP-8419. The reason is because the tests only verify that the agent eventually converges on the right environment, but doesn''t test that the agent''s initial node request succeeds and starts the agent off in the correct environment.\r\n\r\nFor example, the following test only verifies that the notify resource emits the correct environment, but the agent''s not request should not have failed, and it shouldn''t have had to switch environments based on the catalog''s environment:\r\n\r\n{noformat}\r\n17:23:17 Begin ruby/puppet/acceptance/tests/environment/use_enc_environment.rb\r\n...\r\n17:23:44 u0nh9955a5qfx91.delivery.puppetlabs.net (redhat6-64-2) 01:23:44$ puppet agent --no-daemonize --onetime --server cuzrxlwd8pszvvb.delivery.puppetlabs.net --verbose\r\n17:23:44   Warning: Unable to fetch my node definition, but the agent run will continue:\r\n17:23:46   Warning: Could not intern from application/json: Could not find a directory environment named ''special'' anywhere in the path: /etc/puppetlabs/code/environments. Does the directory exist?\r\n17:23:46   Info: Retrieving pluginfacts\r\n17:23:46   Info: Retrieving plugin\r\n17:23:46   Info: Retrieving locales\r\n17:23:46   Info: Caching catalog for u0nh9955a5qfx91.delivery.puppetlabs.net\r\n17:23:46   Notice: Local environment: ''production'' doesn''t match server specified environment ''special'', restarting agent run with environment ''special''\r\n17:23:46   Info: Retrieving pluginfacts\r\n17:23:46   Info: Retrieving plugin\r\n17:23:46   Info: Retrieving locales\r\n17:23:46   Info: Caching catalog for u0nh9955a5qfx91.delivery.puppetlabs.net\r\n17:23:47   Info: Applying configuration version ''1517448226''\r\n17:23:47   Notice: expected_string\r\n17:23:47   Notice: /Stage[main]/Main/Notify[expected_string]/message: defined ''message'' as ''expected_string''\r\n17:23:47   Notice: Applied catalog in 0.02 seconds\r\n{noformat}\r\n\r\nWe also need to test that setting {{server_list}} also works (since we make a node request to see if the server is available).', 'https://tickets.puppetlabs.com/browse/PUP-8459', 'https://github.com/puppetlabs/puppet/commit/975fab3e8f0aa873372d6f9495ecbee1a7da416b', '2018-02-12T10:02:18.000-0800', '2018-03-20T13:28:40.000-0700', '2018-03-20T13:28:40.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, '975fab3e8f0aa873372d6f9495ecbee1a7da416b'),
('puppet', 240442, 173980673, 6725, 'Validator incorrectly reports result of regexp match as being forgotten', 'The following manifest errors when evaluated using {{puppet apply}}:\r\n{code:puppet}\r\n''cdf'' =~ /^([a-z])(.*)/\r\nnotice($2)\r\n{code}\r\nThe error is:\r\n{code}\r\nThis ''=~'' expression has no effect. A value was produced and then forgotten (one or more preceding expressions may have the wrong form)\r\n{code}\r\nThis is not correct since the result of the match is stored in numeric variables $1 ... $n and can be used.\r\n\r\nTurning the comparison into an assignment, i.e.:\r\n{code:puppet}\r\n$x = ''cdf'' =~ /^([a-z])(.*)/\r\nnotice($2)\r\n{code}\r\nyields the correct result:\r\n{code}\r\nNotice: Scope(Class[main]): df\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8537', 'https://github.com/puppetlabs/puppet/pull/6725', '2018-03-08T23:05:28.000-0800', '2018-03-20T13:28:41.000-0700', '2018-03-20T13:28:41.000-0700', 'Closed', 'Language', 0, '0', 1, 7, 1, 2, '4f11cc8d8cfdac0ac8f8939345ef555cc4fab3b9'),
('puppet', 236090, 168644703, 6630, 'Topscope ''environment'' can become nil when setting node parameters in a custom terminus', '*Puppet Version:* 5.3.4\r\n *Puppet Server Version:* 5.1.4\r\n *OS Name/Version:* RHEL7.4\r\n\r\n*Summary:* Catalogs fail to compile on puppet-server 5.1.5 when using puppet-agent 5.3.4. When puppet-agent is downgraded on puppet-server 5.1.5 compiles are successful. ** \r\n\r\n \r\n\r\n*Baseline/Working Example*\r\n\r\nWith puppet-agent 5.3.3 and puppet-server 5.1.5, I can successfully compile a catalog for my client.\r\n{code:java}\r\n[root@puppet5 ~]# rpm -q puppet-agent puppetserver\r\npuppet-agent-5.3.3-1.el7.x86_64\r\npuppetserver-5.1.5-1.el7.noarch{code}\r\nClient:\r\n{code:java}\r\n[root@led ~]# rpm -q puppet-agent\r\npuppet-agent-5.3.4-1.el7.x86_64\r\n[root@led ~]# puppet agent -t --environment production --server puppet5.corp.com\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for led\r\nInfo: Unable to serialize catalog to json, retrying with pson\r\nInfo: Applying configuration version ''c30a9ad''\r\nNotice: Applied catalog in 9.63 seconds{code}\r\n \r\n\r\n*Broken Example*\r\n\r\nUpgrading the agent on the server will prevent the server from compiling a catalog.\r\n{code:java}\r\n[root@puppet5 ~]# yum -y update puppet-agent\r\n...\r\n[root@puppet5 ~]# rpm -q puppet-agent puppetserver\r\npuppet-agent-5.3.4-1.el7.x86_64\r\npuppetserver-5.1.5-1.el7.noarch\r\n[root@puppet5 ~]# systemctl restart puppetserver{code}\r\n \r\n\r\nClient:\r\n{code:java}\r\n[root@led ~]# puppet agent -t --environment production --server puppet5.corp.com\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Resource Statement, Evaluation Error: Error while evaluating a Function Call, Class[Eash::Client]: expects a value for parameter ''pem'' (file: /etc/puppetlabs/code/environments/production/.site/profile/manifests/common.pp, line: 42, column: 21) on node led.corp.com\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run{code}\r\n \r\n\r\n*Why I think it''s Hiera Related*\r\n\r\nMy hiera.yaml\r\n{code:java}\r\n[puppet5 ~]$ cat /etc/puppetlabs/code/hiera.yaml\r\n# managed by puppet: modules/puppet/files/etc/puppetlabs/code/hiera.yaml/common.erb, called by: Class[Role::Infra::Puppet_server]\r\n---\r\n:backends:\r\n  - modularfiles\r\n  - eyaml\r\n  - yaml\r\n\r\n:hierarchy:\r\n  - "host/%{::fqdn}"\r\n  - "role/%{::role}"\r\n  - "hostgroup/%{::hostgroup}"\r\n  - "team/%{::team}"\r\n  - "enclave/%{::enclave}"\r\n  - common\r\n\r\n:yaml:\r\n  :datadir: "/etc/puppetlabs/code/environments/%{environment}/hieradata"\r\n\r\n:eyaml:\r\n  :datadir: "/etc/puppetlabs/code/environments/%{environment}/hieradata"\r\n  :pkcs7_private_key: /etc/puppetlabs/keys/private_key.pkcs7.pem\r\n  :pkcs7_public_key:  /etc/puppetlabs/keys/public_key.pkcs7.pem\r\n  :extension: ''yaml''\r\n\r\n:merge_behavior: native{code}\r\nRunning puppet server in debug mode\r\n{code:java}\r\n[root@puppet5 ~]# puppetserver foreground --debug\r\n...\r\n2018-02-09 15:27:40,269 DEBUG [qtp194608888-66] [puppetserver] Puppet Lookup of ''telegraf::outputs''\r\n  Searching for "telegraf::outputs"\r\n    Global Data Provider (hiera configuration version 3)\r\n      Using configuration "/etc/puppetlabs/code/hiera.yaml"\r\n      Merge strategy hash\r\n...\r\n        Hierarchy entry "yaml"\r\n          Merge strategy hash\r\n            Path "/etc/puppetlabs/code/environments//hieradata/host/led.corp.com.yaml"\r\n              Original path: "host/%{::fqdn}"\r\n              Path not found\r\n            Path "/etc/puppetlabs/code/environments//hieradata/role/infra::led.yaml"\r\n              Original path: "role/%{::role}"\r\n              Path not found\r\n            Path "/etc/puppetlabs/code/environments//hieradata/hostgroup/.yaml"\r\n              Original path: "hostgroup/%{::hostgroup}"\r\n              Path not found\r\n            Path "/etc/puppetlabs/code/environments//hieradata/team/infra.yaml"\r\n              Original path: "team/%{::team}"\r\n              Path not found\r\n            Path "/etc/puppetlabs/code/environments//hieradata/enclave/ccs.yaml"\r\n              Original path: "enclave/%{::enclave}"\r\n              Path not found\r\n            Path "/etc/puppetlabs/code/environments//hieradata/common.yaml"\r\n              Original path: "common"\r\n              Path not found\r\n...\r\n2018-02-09 15:27:40,735 ERROR [qtp194608888-66] [puppetserver] Puppet Evaluation Error: Error while evaluating a Resource Statement, Evaluation Error: Error while evaluating a Function Call, Class[Dns::Client]: expects a value for parameter ''server'' (file: /etc/puppetlabs/code/environments/production/.site/profile/manifests/common.pp, line: 42, column: 2\r\n1) on node led.corp.com\r\n...{code}\r\nAs you can see the %\{environment} variable is not expanded\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8443', 'https://github.com/puppetlabs/puppet/pull/6630', '2018-02-09T12:33:22.000-0800', '2018-03-20T13:28:43.000-0700', '2018-03-20T13:28:43.000-0700', 'Closed', '', 11, '0', 1, 15, 0, 2, '01b996cf66c86db4a30330fa0cf21c61ac03beba'),
('puppet', 237457, 170589673, 6663, 'TypeSet loading of internal references is broken', 'A {{TypeSet}} that contains a type that references another type in the same set will not resolve correctly when loaded from disk using the module loader.\r\n\r\nThe reason is that the {{TypeParser}} prefers the loader associated with the loaded file over a loader passed as an argument. The {{TypeSet#resolve}} method is however counting on that the local loader that it provides (which enables unqualified access to the types contained in the {{TypeSet}}) is used.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8471', 'https://github.com/puppetlabs/puppet/pull/6663', '2018-02-20T03:28:50.000-0800', '2018-03-20T13:28:44.000-0700', '2018-03-20T13:28:44.000-0700', 'Closed', '', 0, '0', 1, 34, 1, 3, 'f74195bdc523d4fdbb121e35ae1a08894add7b8d'),
('puppet', 241008, 174759020, 6733, 'puppet 5/ruby 2.4 can''t handle invalid plists', '*Puppet Version: 5.4.0*\r\n *Puppet Server Version: n/a*\r\n *OS Name/Version: macOS 10.13.3*\r\n\r\nPuppet 5.4.0 using ruby 2.4.3 can''t handle invalid plists.\r\n\r\nIf a plist contains and invalid comment (e.g., a comment with ''–'' in the text), CFPropertyList will fail to parse it, passing it on to a shell out to `plutil -convert xml1 -o /dev/stdout`. However, it seems some subsystem (I believe it may be ruby 2.4) doesn''t allow operations on `/dev/stdout`\r\n\r\n{{Warning: Cannot read file /Library/LaunchDaemons/badcomment.plist; Puppet is skipping it.\nDetails: Execution of ''/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/badcomment.plist'' returned 1: <?xml version="1.0" encoding="UTF-8"?>Warning: Cannot read file /Library/LaunchDaemons/badcomment.plist; Puppet is skipping it.\n}}\r\n\r\n{{[...]}}\r\n\r\n{{/dev/stdout: Operation not supported}}\r\n\r\nTo reproduce, add a comment containing ''–'' to any plist in /Library/LaunchDaemons, then run puppet.\r\n\r\n*Desired Behavior:*\r\n\r\nPuppet should handle the malformed plist and successfully call plutil.\r\n\r\n*Actual Behavior:*\r\n\r\nAfter CFPropertyList fails, the plutil call also fails.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8545', 'https://github.com/puppetlabs/puppet/pull/6733', '2018-03-13T11:57:58.000-0700', '2018-03-20T13:28:45.000-0700', '2018-03-20T13:28:45.000-0700', 'Closed', '', 7, '0', 1, 4, 4, 2, '97603673fd871cc90be1c9b21421ea89ca03db84'),
('puppet', 237462, 170433917, 6657, 'ModelTreeDumper looses character casing when dumping QualifiedReference', 'A {{QualifiedName}} is indistinguishable from a {{QualifiedReference}} in the output from the ModelTreeDumper since the dumper simply dumps the {{value}} attribute in both cases. For a {{QualifiedReference}} it ought to dump the {{cased_value}}.', 'https://tickets.puppetlabs.com/browse/PUP-8474', 'https://github.com/puppetlabs/puppet/pull/6657', '2018-02-20T04:04:27.000-0800', '2018-03-20T13:28:47.000-0700', '2018-03-20T13:28:47.000-0700', 'Closed', '', 2, '0', 3, 57, 53, 10, '90107897b77ac3f653fd7aa200a592c271e7db70'),
('puppet', 237463, 170428802, 6656, 'Parser creates QNAME for capability component although it must start with upper case', 'The parser creates a {{QualifiedName}} instead of a {{QualifiedReference}} when for the {{component}} of a {{CapabilityExpression}}. The validator then checks if the {{component}} conforms to {{Patterns::CLASSREF_EXT}} (which it does). The pattern asserts that the string starts with an upper-case letter and this makes the {{component}} a {{QualifiedReference}} per definition.\r\n\r\nThe parser should change and instead create the expected {{QualifiedReference}}.', 'https://tickets.puppetlabs.com/browse/PUP-8475', 'https://github.com/puppetlabs/puppet/pull/6656', '2018-02-20T04:28:14.000-0800', '2018-03-20T13:28:49.000-0700', '2018-03-20T13:28:49.000-0700', 'Closed', '', 2, '0', 1, 14, 14, 5, '35ed8b4dfd63939497826a32fabc7fc41f74b1a7'),
('puppet', 41099, 173313289, 6713, 'yumrepo type includepkgs and exclude properties don''t handle list as documented', 'The documentation for the yumrepo type''s "exclude" and "includepkgs" properties say "List of shell globs". In fact, these properties seem to write out only the first item in a list to the file, not all of them.\r\n\r\n{code}\r\n[root@djaapafes50 yum.repos.d]# cd /etc/yum.repos.d/\r\n[root@djaapafes50 yum.repos.d]# rm -f ius-python.repo \r\n[root@djaapafes50 yum.repos.d]# cat /home/jantman/temp/rm_me/yum_ius.pp\r\nyumrepo { ''ius-python'':\r\n  descr          => "IUS Community Packages for Enterprise Linux ${::operatingsystemmajrelease} - ${::architecture}",\r\n  mirrorlist     => "http://dmirr.iuscommunity.org/mirrorlist/?repo=ius-centos${::operatingsystemmajrelease}&arch=${::architecture}",\r\n  failovermethod => priority,\r\n  enabled        => true,\r\n  gpgcheck       => true,\r\n  gpgkey         => ''file:///etc/pki/rpm-gpg/IUS-COMMUNITY-GPG-KEY'',\r\n  includepkgs    => [''python27-*'', ''python32-*'', ''python33-*'', ''expat*''],\r\n  exclude        => [''foo'', ''bar*'', ''baz-*''],\r\n}\r\n[root@djaapafes50 yum.repos.d]# puppet apply /home/jantman/temp/rm_me/yum_ius.pp\r\nNotice: Compiled catalog for djaapafes50.ddtc.cmgdigital.com in environment production in 0.10 seconds\r\nNotice: /Stage[main]/Main/Yumrepo[ius-python]/ensure: created\r\nNotice: Finished catalog run in 0.18 seconds\r\n[root@djaapafes50 yum.repos.d]# cat ius-python.repo \r\n[ius-python]\r\nincludepkgs=python27-*\r\nname=IUS Community Packages for Enterprise Linux 5 - x86_64\r\nmirrorlist=http://dmirr.iuscommunity.org/mirrorlist/?repo=ius-centos5&arch=x86_64\r\nenabled=true\r\nfailovermethod=priority\r\ngpgcheck=true\r\nexclude=foo\r\ngpgkey=file:///etc/pki/rpm-gpg/IUS-COMMUNITY-GPG-KEY\r\n{code}\r\n\r\nI''m marking this as Major because the effect is that any packages/globs in the {{exclude}} list after the first one will be silently ignored. This behavior could very easily break many systems (especially in the RHEL/Cent world).', 'https://tickets.puppetlabs.com/browse/PUP-2884', 'https://github.com/puppetlabs/puppet/pull/6713', '2014-07-02T13:58:33.000-0700', '2018-03-20T13:30:43.000-0700', '2018-03-20T13:30:43.000-0700', 'Closed', 'docs;yumrepo', 4, '0', 1, 6, 4, 1, 'f2327637073952a82e3dce8a0a140d33531fae41'),
('puppet', 18724, 175037552, 6735, 'Due to prefetching, Yumrepo clobbers any definition that it does not create', 'Yumrepo appears to be checking file existence before allowing the package command to complete, meaning that it creates a file containing only "[remi]" and "enabled=1", overwriting the file that the RPM installed.\r\n\r\nManifests, additional debug output, etc., available upon request.  Just tell me what you need to know.  Workarounds especially welcomed.  Puppet v. 0.24.4, running with --debug --test, on Ruby 1.8.6.114-1, compiled from source with default options.\r\n\r\n{code}\r\ndebug: //Node[default]/remi_enabled/Yumrepo[remi]/require: requires Package[remi-release-5-4.el5.remi]\r\n{code}\r\n...\r\n{code}\r\ndebug: Puppet::Type::Package::ProviderRpm: Not suitable: false value\r\ndebug: Puppet::Type::Package::ProviderRpm: Executing ''/bin/rpm -q remi-release-5-4.el5.remi --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}''\r\ndebug: /Package[remi-release-5-4.el5.remi]: Changing ensure\r\ndebug: /Package[remi-release-5-4.el5.remi]: 1 change(s)\r\ndebug: Puppet::Type::Package::ProviderRpm: Executing ''/bin/rpm -i --oldpackage http://rpms.famillecollet.com/el5.x86_64/remi-release-5-4.el5.remi.noarch.rpm''\r\nnotice: /Package[remi-release-5-4.el5.remi]/ensure: created\r\ninfo: create new repo remi in file /etc/yum.repos.d/remi.repo\r\ndebug: //Node[default]/remi_enabled/Yumrepo[remi]: Changing enabled\r\ndebug: //Node[default]/remi_enabled/Yumrepo[remi]: 1 change(s)\r\nnotice: //Node[default]/remi_enabled/Yumrepo[remi]/enabled: defined ''enabled'' as ''1''\r\ninfo: Filebucket[/var/lib/puppet/clientbucket]: Adding /etc/yum.repos.d/remi.repo(18f7009978e772c9c646b9410fa3a8b6)\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-723', 'https://github.com/puppetlabs/puppet/pull/6735', '2013-11-12T11:54:21.000-0800', '2018-03-20T13:30:44.000-0700', '2018-03-20T13:30:44.000-0700', 'Closed', 'redmine', 12, '0', 1, 96, 9, 2, 'd8537524e0a3a18e3e186bd18a5261682017f9ae'),
('puppet', 148117, 172633019, 6707, 'Yumrepo can''t work with files using spaces in their INI format', 'Yumrepo seems to work fine with YUM repository defined in ''.repo'' files as long as the INI styled file doesn''t use spaces around equal signs.\r\nBut if spaces around equal signs are used (and the ''redhat.repo'' on RHEL does that), then the Yumrepo resource cannot manage settings for a repository.\r\n\r\nHow it fails to do so seems to have changed since PUP-5682, before 4.4.0 such repos were ignored, now Puppet tries to modify the value on every run like so:\r\n{code:bash}\r\n/Stage[main]/Main/Yumrepo[rhel-6-server-extras-rpms]/enabled: enabled changed '' 0'' to ''False''\r\n{code}\r\nThat message clearly shows that spaces aren''t trimmed and Puppet fails to convert the value to a boolean representing a state. Same happens if the catalogue tries to apply false.', 'https://tickets.puppetlabs.com/browse/PUP-6639', 'https://github.com/puppetlabs/puppet/pull/6707', '2016-08-19T00:13:12.000-0700', '2018-03-20T13:30:47.000-0700', '2018-03-20T13:30:47.000-0700', 'Closed', '', 6, '0', 1, 38, 8, 2, 'f2eb9dfa66441218cf8f2f22fa574d544cec74fe'),
('puppet', 225741, 168141981, 6625, 'Managing an existing Windows Group resource may error when any of its members is a virtual account (like IIS AppPool\DefaultAppPool or NT Service\Dhcp)', 'Steps to reproduce\r\n\r\n1. Create Group "TestGroup" with "IIS AppPool\DefaultAppPool" as a member\r\n{code}group { ''TestGroup'':\r\n    name            => ''TestGroup'',\r\n    ensure          => present,\r\n    members         => [''IIS AppPool\DefaultAppPool''],\r\n    auth_membership => false,\r\n}\r\n{code}\r\n2. Re-run the same manifest\r\n{code}group { ''TestGroup'':\r\n    name            => ''TestGroup'',\r\n    ensure          => present,\r\n    members         => [''IIS AppPool\DefaultAppPool''],\r\n    auth_membership => false,\r\n}\r\n{code}\r\n3. Once the group exists on the system, Puppet fails to resolve the virtual account properly and generates an error like:\r\n{code}"Could not resolve name: DefaultAppPool"{code}', 'https://tickets.puppetlabs.com/browse/PUP-8231', 'https://github.com/puppetlabs/puppet/pull/6625', '2017-12-06T17:38:46.000-0800', '2018-03-20T13:30:48.000-0700', '2018-03-20T13:30:48.000-0700', 'Closed', 'customer-escalation', 6, '0', 1, 60, 10, 3, 'bef10f187f10b5083e73c888d1b4f663ce3a67d9'),
('puppet', 215619, 148270062, 6299, 'Puppet does not initialize I18N locale per thread', 'From a few hours of investigation, the puppetserver appears to track translation repositories from compile to compile, but either "forgets" about the locale after each compile, or must have the locale initialized in EVERY thread individually.\r\n\r\nSome technical details:\r\n- {{Puppet::GettextConfig.initialize_i18n}} checks {{translation_repositories}} before initializing {{FastGettext.locale}}, and thus only initializes the locale once ever (see https://github.com/puppetlabs/puppet/blob/5.3.2/lib/puppet/module.rb#L427-L446).\r\n- {{FastGettext.translation_repositories}} are a class variable. According to the FastGettext readme, {{FastGettext.locale}} must be initialized once per thread: https://github.com/grosser/fast_gettext#3-choose-text-domain-and-locale-for-translation\r\n- The locale should be negotiated at every module load, contrary to what this says: https://github.com/puppetlabs/puppet/blob/5.3.2/lib/puppet/gettext/config.rb#L83-L84 (watch out for performance implications) but the translation repositories should only needed to be loaded once.\r\n\r\nWe are going to explore refactoring the gettext initialization code to skip the logic around {{available_locales}} and {{FastGettext.locale}} in favor of just setting {{FastGettext.default_locale}} to the system locale directly, since {{default_locale}} is not thread local, unlike {{FastGettext.locale}}. That library should already handle the fallback cases from this configuration (though we will be writing tests to verify this, see PUP-8080). In order to avoid breaking other users of GettextSetup, we will likely be implementing most of this directly in Puppet as gettext utils, and drop our runtime dependency on GettextSetup.\r\n\r\nIt looks like we might run into a similar issue when we start trying to use more text domains (see PUP-8013 and https://github.com/grosser/fast_gettext/blob/master/lib/fast_gettext/storage.rb#L54) as the current text domain also appears to be a thread-local variable. Currently we''re avoiding issues here by only using one text domain which is both set as {{FastGettext.text_domain}} and {{FastGettext.default_text_domain}}, the latter of which is not thread local.\r\n\r\n----\r\n\r\nReproduction steps in a basic PE 2017.3.1 install\r\n- {{localectl set-locale LANG=ja_JP.UTF-8}}\r\n- add {{fail(''trigger failure'')}} to {{node default}} section of {{/etc/puppetlabs/code/environments/production/manifests/site.pp}}\r\n- set {{disable_i18n=false}} in {{/etc/puppetlabs/puppet/puppet.conf}}\r\n- {{systemctl restart pe-puppetserver}}\r\n- {{puppet agent -t --noop}} (several times)\r\n\r\nExpect to see\r\n{quote}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: サーバエラー: Evaluation Error: a Function Callの検証中にエラーが生じました。trigger failure at /etc/puppetlabs/code/environments/production/manifests/site.pp:31:3 on node hwcijw3gfrqxsiw.delivery.puppetlabs.net\r\n{quote}\r\nWill mostly see\r\n{quote}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Function Call, trigger failure at /etc/puppetlabs/code/environments/production/manifests/site.pp:31:3 on node hwcijw3gfrqxsiw.delivery.puppetlabs.net\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-8040', 'https://github.com/puppetlabs/puppet/pull/6299', '2017-10-10T06:01:38.000-0700', '2018-03-25T23:10:46.000-0700', '2018-03-25T23:10:46.000-0700', 'Closed', 'i18n', 10, '0', 1, 109, 66, 6, 'f9d5016619ba6782acc2d8d7271294f591a2b9f6'),
('puppet', 102964, 49213673, 4391, 'solaris 10 sparc, acceptance/tests/reports/submission test fails', 'Using {{puppet-agent}} at SHA {{41de77924}}, the {{acceptance/tests/reports/submission.rb}} acceptance test fails to find the expected report.\r\n\r\n{code}\r\n#<RuntimeError: PuppetAcceptance::DSL::Helpers.with_puppet_running_on failed (check backtrace for location) because: Host ''ufzkt2bzifa2ycj.delivery.puppetlabs.net'' exited with 1 running:\r\n grep -q sol10.delivery.puppetlabs.net /tmp/report_submission.ynlz9i/*/*\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5432', 'https://github.com/puppetlabs/puppet/pull/4391', '2015-10-27T07:09:08.000-0700', '2018-04-03T11:15:25.000-0700', '2018-04-03T11:15:25.000-0700', 'Closed', '', 3, '0', 1, 1, 1, 1, 'ee5dd81a3a18ef50c893aab7c5361ffc81f8f925'),
('puppet', 74099, 32462049, 3781, 'Update per-user directories to ~/.puppetlabs', 'When running as non-root, puppet should create its directories under {{\~/.puppetlabs}} instead of {{\~/.puppet}}.\r\n\r\nPreviously, puppet''s {{confdir}} was {{\~/.puppet}}, and since it''s a setting, puppet would create it when first run. In the move to AIO, the {{confdir}} will be {{\~/.puppetlabs/puppet}} and it will need to create the intermediate directories.\r\n\r\nrisk: medium\r\nseverity: medium (confusing to user, possible bugs)\r\nprobability: medium (only non-root users)\r\ntest layer: acceptance', 'https://tickets.puppetlabs.com/browse/PUP-4355', 'https://github.com/puppetlabs/puppet/pull/3781', '2015-03-31T13:46:53.000-0700', '2018-04-03T11:15:27.000-0700', '2018-04-03T11:15:27.000-0700', 'Closed', 'AIO', 7, '0', 1, 11, 11, 2, 'fccd76a6c39eaf5eed13f1d8cd7919812138a3a8'),
('puppet', 145290, 81389353, 5201, 'User resource always reports password changed when account disabled', 'On Windows 2008R2, when managing a local user the password will always report as changed if the user''s account is disabled.  This appears to be due to the provider not checking for the ERROR_ACCOUNT_DISABLED return code as outlined in PUP-6569.\r\n\r\nTo recreate:\r\n\r\n1.  Create a new local user, "testuser", on Win 2k8R2 (also seen on 2012) and set the account to disabled.\r\n2.  Run `puppet apply -e "user {''testuser'': ensure => present, password => ''Puppet11''}"`.  Note that no matter how many times it is run, the output will report "Notice: /Stage[main]/Main/User[testuser]/password: changed password".\r\n3.  Re-enable the account\r\n4.  Run `puppet apply -e "user {''testuser'': ensure => present, password => ''Puppet11''}"`.  Note that the notice is no longer shown.', 'https://tickets.puppetlabs.com/browse/PUP-6586', 'https://github.com/puppetlabs/puppet/pull/5201', '2016-08-04T16:24:41.000-0700', '2018-04-03T11:15:27.000-0700', '2018-04-03T11:15:27.000-0700', 'Closed', 'customer-escalation', 12, '0', 2, 83, 37, 7, '9e9c01f2831c45c12f61d14e9af7ee6050d7cb14'),
('puppet', 49695, 20523665, 3036, 'Fix /var/lib/puppet/reports permissions on debian/redhat', 'On deb/el platforms, we do not correctly set the permissions for /var/lib/puppet/reports, which prevents any applications from writing to this directory.', 'https://tickets.puppetlabs.com/browse/PUP-3163', 'https://github.com/puppetlabs/puppet/pull/3036', '2014-08-29T14:10:25.000-0700', '2018-04-03T11:16:10.000-0700', '2018-04-03T11:16:10.000-0700', 'Closed', '', 3, '0', 1, 6, 1, 3, '2a284f13c2865b94483ef669ffd16c87f90185fa'),
('puppet', 46938, 20142790, 3001, 'Debian package does not create /var/run/puppet dir during install', 'It looks like `/var/run/puppet` has typically been created during by the debian init script if it didn''t exist already: https://github.com/puppetlabs/puppet/blob/master/ext/debian/puppetmaster.init#L22\r\n\r\nThis should instead be handled by the `puppet-common.dirs` file in the `puppet-common` package. I say that it should be included in the `puppet-common` package because it is used by components other than the `puppetmaster` daemon (for example `jvm-puppet` which does not currently depend on `puppetmaster` being installed, just `puppet-common`)', 'https://tickets.puppetlabs.com/browse/PUP-3035', 'https://github.com/puppetlabs/puppet/pull/3001', '2014-08-07T14:37:17.000-0700', '2018-04-03T11:16:15.000-0700', '2018-04-03T11:16:15.000-0700', 'Closed', '', 6, '0', 2, 7, 8, 2, '3037334a3ad973246f2bc889df0dd232b7b2ca2f'),
('puppet', 49549, 20461751, 3029, 'Need to guard against `nil` when calling `Uniquefile#close!` in `ensure` blocks', 'in `util.rb#replace_file`, there is an `ensure` block that calls `close!` on the `Uniquefile` object.  However, if an exception is thrown during the call to the constructor for `Uniquefile` (e.g., if the user does not have write permissions to the specified directory), then this attempt to call `close!` will result in a NilClass exception, which will mask the original exception.', 'https://tickets.puppetlabs.com/browse/PUP-3153', 'https://github.com/puppetlabs/puppet/pull/3029', '2014-08-28T12:09:59.000-0700', '2018-04-03T11:16:18.000-0700', '2018-04-03T11:16:18.000-0700', 'Closed', '', 6, '0', 1, 7, 3, 3, 'ccb7ff634b423b1cec53d1ac7786a65849043629'),
('puppet', 37629, 17134905, 2772, 'Puppet 3.6.1 File recurse improperly handles spaces in filenames', 'This one''s new on me.\r\nWe''re using file{ : recurse => remote} to pull a directory structure from a remote puppet fileserver. It would appear that there''s a mismatch causing it to multiply urlencode resources it''s recursing over, causing it to render a space '' '' as %2520 in the file_content call.\r\n\r\nHere''s a convenient, if ugly, example:\r\n\r\nIn the Fileserver:\r\n\r\n{noformat}\r\n[29/May/2014:14:15:18 -0700] "GET /production/file_content/puppet/python340/lib/python3.4/site-packages/setuptools/__pycache__/script%2520template%2520(dev).cpython-34.pyc HTTP/1.1" 404 147 "-" "-"\r\n{noformat}\r\n\r\nin the client:\r\n\r\n{noformat}\r\nError 404 on SERVER: Not Found: Could not find file_content puppet/python340/lib/python3.4/site-packages/setuptools/__pycache__/script%20template%20(dev).cpython-34.pyc\r\nError: /Stage[main]/.../File[/opt/python340/lib/python3.4/site-packages/setuptools/__pycache__/script template (dev).cpython-34.pyc]/ensure: change from absent to file failed:\r\nCould not set ''file'' on ensure: \r\nError 404 on SERVER: Not Found: \r\nCould not find file_content puppet/python340/lib/python3.4/site-packages/setuptools/__pycache__/script%20template%20(dev).cpython-34.pyc\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-2700', 'https://github.com/puppetlabs/puppet/pull/2772', '2014-05-29T14:23:18.000-0700', '2018-04-03T11:16:18.000-0700', '2018-04-03T11:16:18.000-0700', 'Closed', '', 20, '0', 2, 56, 74, 2, 'bfec60f4f2b32a64f9f9e59bd6ba47c26e30e884'),
('puppet', 40777, 172105564, 6692, '`puppet config print` confusing for users', '{{puppet config print}} doesn''t require a {{\-\-section}} to be specified and doesn''t inform the user what section of the config file it is showing the value for. Users then get unexpected information from the command.\r\n\r\nThe command needs to change in some way to make it clear what sections the information is coming from and provide a good way to request information from a specific section.  ''main'' is the default.\r\n\r\nAn example:  You may have a server setting that is already in the agent setting.  When you ran puppet config set server "value" - that will throw it in the "main" section.  There already exists a server setting in the "agent" section that is overriding this.  The next time you run puppet config print - you will get the one out of the main section (not the overriding agent setting)\r\n\r\n1. Always print section info to stderr:\r\n\r\n$ puppet config print server\r\nResolving settings from section ''main'' in environment ''production''\r\npuppetserver.example.com\r\nAlso print any other settings found that may/will override this setting as in the example above - "Setting is also defined in the following sections: X, Y, Z"\r\n\r\n2. If section is omitted, also emit a warning to stderr:\r\n\r\n$ puppet config print server\r\nResolving settings from section ''main'' in environment ''production''\r\nNo section specified, using ''user'' section - settings will not affect agent execution!\r\npuppetserver.example.com\r\n\r\n3. Update "config" help to strongly recommend always specifying a section (should probably work with [~garrett.guillotte] on this):\r\n* what the list of commonly used sections are \r\n* guidance on naming sections\r\n* the output of the help command point to the sections documentation\r\n* Include a good solid example of sections (what settings go in what section)', 'https://tickets.puppetlabs.com/browse/PUP-2868', 'https://github.com/puppetlabs/puppet/pull/6692', '2014-06-30T14:07:43.000-0700', '2018-04-11T11:02:34.000-0700', '2018-04-11T11:02:34.000-0700', 'Closed', '', 16, '0', 2, 110, 2, 3, 'e90d162519dcc5eafb1dd2f2a30f4c6ba1538d8c'),
('puppet', 168318, 179232302, 6775, 'Update password property of User type to mention Sensitive data type', 'When the user provider changes a managed users password, the plaintext password is shown in the console even if the password is encrypted in hiera.\r\n\r\nTo reproduce: \r\n1) In PE Console go to report where the password was changed. \r\n2) Click on Events tab \r\n3) Under resource type click user \r\n4) The User resource will show the password in the Changed to column.\r\n\r\n*Notes*\r\n- Currently, Puppet will include password value(s) in the resource event logs when they change. This means passwords are written to the reports in plain text (though these reports are only root-readable).\r\n- The {{Sensitive}} type was recently added to Puppet, which obscures associated values where applicable. Ostensibly passwords are sensitive information and are applicable for this new type.\r\n\r\n*In Scope*\r\n- Plumb the {{Sensitive}} data type through the Puppet type system as needed, if at all, so that we can:\r\n- Set the {{password}} property of the {{user}} type to {{Sensitive}}. This will then apply to all {{user}} providers.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7057', 'https://github.com/puppetlabs/puppet/pull/6775', '2017-01-03T02:23:47.000-0800', '2018-04-18T06:21:33.000-0700', '2018-04-18T06:21:33.000-0700', 'Closed', 'generated-docs;product-security;security', 12, '0', 1, 34, 3, 1, 'b67d50a68943646eb9a7115d53a187458d327c9c'),
('puppet', 209079, 179229452, 6774, 'return() documentation incorrect regarding lambdas', 'So the documentation for {{return()}} says plainly that it will return from a lambda, ending evaluation of the function.\r\n\r\nhttps://docs.puppet.com/puppet/4.10/function.html#return:\r\n{quote}\r\nIf called from within a lambda the return will return from the function evaluating the lambda.\r\n{quote}\r\n\r\nSo let''s build a short manifest and use a function that evaluates a lambda:\r\n{code}\r\nwith(1) |$num| {\r\n  return()\r\n}\r\n{code}\r\n\r\nThis creates an error:\r\n{code}\r\n$ puppet apply return_bug.pp\r\nError: return() from context where this is illegal at /tmp/return_bug.pp:2 on node \r\n{code}\r\n\r\nReading the spec test confirms that this is expected behavior?\r\nhttps://github.com/puppetlabs/puppet/blob/ebd96213cab43bb2a8071b7ac0206c3ed0be8e58/spec/unit/functions/return_spec.rb#L85-L94\r\n\r\nI thought of perhaps creating this as a documentation bug, but this is failing on documented (and desirable) functionality.', 'https://tickets.puppetlabs.com/browse/PUP-7904', 'https://github.com/puppetlabs/puppet/pull/6774', '2017-09-04T13:06:59.000-0700', '2018-04-18T06:21:34.000-0700', '2018-04-18T06:21:34.000-0700', 'Closed', 'generated-docs', 7, '0', 1, 22, 1, 1, '9f6dff151e999b49465913076a513fc035c44e32'),
('puppet', 241813, 177165653, 6762, 'File performance nearly twice as slow after update', 'Hello,\r\n\r\nwe noticed that puppet runs take twice as long after updating to latest version. We did some research and noticed that "time - file" (–profile --summarize) doubled.\r\n\r\nThe puppetdb version had no effect on this.\r\n\r\nExample node with agent 5.4.0 and server 5.2 :\r\n\r\ntime file : 163,63\r\n\r\nSame node with agent 5.2 and server 5.1.4\r\n\r\ntime file : 80,54\r\n\r\n \r\n\r\nvisual:\r\n\r\n!image.png!\r\n\r\nPlease let me know if you need further data.\r\n\r\nalso avail on slack as "betriebsrat"', 'https://tickets.puppetlabs.com/browse/PUP-8562', 'https://github.com/puppetlabs/puppet/pull/6762', '2018-03-19T02:23:37.000-0700', '2018-04-18T19:03:19.000-0700', '2018-04-18T19:03:19.000-0700', 'Closed', '', 11, '0', 3, 59, 20, 4, '47980726ef023355d102aec8222fa9c2b8f07637'),
('puppet', 241646, 177818626, 6765, 'Fix JrJackson serialization of numbers so we can use it', 'We''re not entirely sure what causes this, but sometimes JrJackson seems to output numbers -> JSON strings. PuppetDB, at least, expects these to be numbers and will blow up on submitting reports. We probably need to add custom serialization logic after we figure out exactly what''s going wrong.', 'https://tickets.puppetlabs.com/browse/PUP-8583', 'https://github.com/puppetlabs/puppet/pull/6765', '2018-03-15T16:13:32.000-0700', '2018-04-19T11:22:29.000-0700', '2018-04-19T11:22:29.000-0700', 'Closed', '', 4, '0', 1, 1, 1, 1, '2135fb68f780b8173e11e2bd6148d1e24d6a8f82'),
('puppet', 237928, 175046933, 6737, 'Reduce regular expression garbage in puppet', 'Lots of garbage is generated by the ValidTagRegex in tagging.rb, as on JRuby it''s forced to rebuild the regular expression every time it is matched against a string of a different encoding.\r\n\r\n \r\n\r\nOne solution is to put a u on the end to force UTF-8 and not let it change. It will fail hard if it encounters something other than UTF-8 or ASCII. There is a test that fails when this change is applied and I''m not sure whether the test is wrong or the fix is wrong.\r\n\r\n \r\n\r\nAnother solution would be to make sure strings reaching that are almost always UTF-8 (an occasional cache invalidation won''t hurt too much, but right now it seems to happen on every match).', 'https://tickets.puppetlabs.com/browse/PUP-8549', 'https://github.com/puppetlabs/puppet/pull/6737', '2018-02-22T16:02:18.000-0800', '2018-04-19T11:22:30.000-0700', '2018-04-19T11:22:30.000-0700', 'Closed', '', 7, '0', 3, 31, 4, 2, '382089e813a5b9ea21b266348af86137c7e3f400'),
('puppet', 226134, 176746642, 6755, 'ERB and EPP templates handle CRLF line endings inconsistently', 'Via [~williams.geoff] on DOCUMENT-779:\r\n\r\n*expected result*\r\n\r\nWhen applying a puppet manifest and its EPP template using CRLF line endings to generate a file, the generated file should also use CRLF line endings.\r\n\r\nWhen using a CRLF escape sequence in ERB or EPP templates ({{\r\n}}), Puppet should replace the sequence with a CRLF line ending in the generated file.\r\n\r\nThis is documented at [Handling line endings on Resource tips and Examples: File on Windows|https://puppet.com/docs/puppet/5.3/resources_file_windows.html#handling-line-endings]:\r\n\r\n* If a file resource uses the content or source attributes, Puppet will write the file in “binary” mode, using whatever line endings are present in the content.\r\n** If the manifest, template, or source file is saved with CRLF line endings, Puppet will use those endings in the destination file.\r\n** If the manifest, template, or source file is saved with LF line endings, you can use the {{\r\n}} escape sequence to create literal CRLFs.\r\n\r\n*actual result*\r\n\r\nFollowing the instructions produces one long line of text instead of text with CRLF line breaks, and {{\r\n}} appears literally in the output instead of being replaced with a CRLF line break.\r\n\r\n*test case*\r\n\r\ntest.pp:\r\n\r\n{code}\r\nfile { "c:/test.txt":\r\n  content => epp("c:/test.epp")\r\n}\r\n{code}\r\n\r\ntest.epp:\r\n\r\n{code}\r\nline 1\r\nline 2\r\n:P\r\n{code}\r\n\r\ntest.txt (result)\r\n\r\n{code}\r\nline 1line 2:P\r\n{code}\r\n\r\nFiles were created in notepad to get the line endings. See the attachment.\r\n\r\nEscape codes in the template:\r\n\r\ntest.epp:\r\n\r\n{code}\r\nline 1\r\n\r\nline 2\r\n\r\n:P\r\n\r\n{code}\r\n\r\ntest.txt output:\r\n\r\n{code}\r\nline 1\r\nline 2\r\n:P\r\n\r\n{code}\r\n\r\nHow to run testcase (save to c:\):\r\n\r\n{code}\r\npuppet apply c:\test.pp\r\n{code}\r\n\r\n*workaround*\r\nTraditional *erb* templates'' {{template()}} handle CRLF line endings as documented and expected, although these also result in literal {{\r\n}} in the output, which still conflicts with the documentation.', 'https://tickets.puppetlabs.com/browse/PUP-8240', 'https://github.com/puppetlabs/puppet/pull/6755', '2017-12-11T11:15:22.000-0800', '2018-04-19T11:22:30.000-0700', '2018-04-19T11:22:30.000-0700', 'Closed', '', 25, '0', 1, 4, 0, 1, '8344baddf563fc92d7fdae411975170874f08e05'),
('puppet', 165938, 176607022, 6751, 'Puppet automatically creates the production environment with the incorrect permissions', 'If the production environment does not exist, Puppet will automatically create it as a result of PUP-2519.  Unfortunately, it creates the directory with ownership of root:root.  To be consistent with Code Manager and file sync, it should be owned by puppet user and group (pe-puppet:pe-puppet for PE installations).', 'https://tickets.puppetlabs.com/browse/PUP-6996', 'https://github.com/puppetlabs/puppet/pull/6751', '2016-12-12T09:14:59.000-0800', '2018-04-19T11:22:33.000-0700', '2018-04-19T11:22:33.000-0700', 'Closed', '', 3, '0', 1, 52, 5, 2, '47d75dce01255aa6314c4990739de541467f4e1a'),
('puppet', 36803, 0, 0, 'Puppet Cron Resource Overwrites Crontab File Under Certain Situations', 'In the case where a crontab file has invalid entries the cron resource ends up overwriting the whole file with just the resources puppet knows about and removes any manually entered crontab entries even if they were valid.  \r\n\r\nOn a fresh system I have the following crontab setup provided by puppet:\r\n{noformat}\r\n[root@master323-centos ~]# crontab -l\r\n# HEADER: This file was autogenerated at 2014-05-02 17:31:32 +0000 by puppet.\r\n# HEADER: While it can still be managed manually, it is definitely not recommended.\r\n# HEADER: Note particularly that the comments starting with ''Puppet Name'' should\r\n# HEADER: not be deleted, as doing so could cause duplicate cron jobs.\r\n# Puppet Name: pe-mcollective-metadata\r\n0,15,30,45 * * * * /opt/puppet/sbin/refresh-mcollective-metadata\r\n# Puppet Name: pe-puppet-console-prune-task\r\n* 1 * * * /opt/puppet/bin/rake -f /opt/puppet/share/puppet-dashboard/Rakefile RAILS_ENV=production reports:prune reports:prune:failed upto=30 unit=day > /dev/null\r\n{noformat}\r\n\r\nI then use {{crontab -e}} to add a new entry:\r\n{noformat}\r\n[root@master323-centos ~]# crontab -e\r\ncrontab: installing new crontab\r\n[root@master323-centos ~]# crontab -l\r\n# HEADER: This file was autogenerated at 2014-05-02 17:31:32 +0000 by puppet.\r\n# HEADER: While it can still be managed manually, it is definitely not recommended.\r\n# HEADER: Note particularly that the comments starting with ''Puppet Name'' should\r\n# HEADER: not be deleted, as doing so could cause duplicate cron jobs.\r\n# Puppet Name: pe-mcollective-metadata\r\n0,15,30,45 * * * * /opt/puppet/sbin/refresh-mcollective-metadata\r\n# Puppet Name: pe-puppet-console-prune-task\r\n* 1 * * * /opt/puppet/bin/rake -f /opt/puppet/share/puppet-dashboard/Rakefile RAILS_ENV=production reports:prune reports:prune:failed upto=30 unit=day > /dev/null\r\n0,15,30,45 * * * * /opt/puppet/bin/facter -p\r\n{noformat}\r\n\r\nNow I add an invalid entry by editing the file directly: \r\n{noformat}\r\n[root@master323-centos ~]# vim /var/spool/cron/root\r\n[root@master323-centos ~]# crontab -l\r\n# HEADER: This file was autogenerated at 2014-05-22 21:32:18 +0000 by puppet.\r\n# HEADER: While it can still be managed manually, it is definitely not recommended.\r\n# HEADER: Note particularly that the comments starting with ''Puppet Name'' should\r\n# HEADER: not be deleted, as doing so could cause duplicate cron jobs.\r\n# Puppet Name: pe-mcollective-metadata\r\n0,15,30,45 * * * * /opt/puppet/sbin/refresh-mcollective-metadata\r\n# Puppet Name: pe-puppet-console-prune-task\r\n* 1 * * * /opt/puppet/bin/rake -f /opt/puppet/share/puppet-dashboard/Rakefile RAILS_ENV=production reports:prune reports:prune:failed upto=30 unit=day > /dev/null\r\n0,15,30,45 * * * * /opt/puppet/bin/facter -p\r\nsafdljasdflkja\r\n{noformat}\r\n\r\nWhen I run puppet it overwrite the file and I lose the legitimate entry that I had entered with {{crontab -e}}:\r\n{noformat}\r\n[root@master323-centos ~]# puppet agent -t\r\nInfo: Retrieving plugin\r\nInfo: Loading facts in ...\r\n...\r\nInfo: Caching catalog for master323-centos\r\nInfo: Applying configuration version ''1400794238''\r\nError: Could not prefetch cron provider ''crontab'': Could not parse line "safdljasdflkja" at root:7\r\nNotice: /Stage[main]/Pe_mcollective::Server/Cron[pe-mcollective-metadata]/ensure: created\r\nNotice: /Stage[main]/Pe_console_prune/Cron[pe-puppet-console-prune-task]/ensure: created\r\nNotice: Finished catalog run in 14.11 seconds\r\n{noformat}\r\n\r\nI''m not sure of the ideal behavior but I see two options that could make it better:\r\n1.  Backup the crontab file to the filebucket so atleast if it gets wiped out I can just restore to the previous version.\r\n2. Fail completely and do not manage the crontab entries if the file is in an invalid state.  \r\n', 'https://tickets.puppetlabs.com/browse/PUP-2643', 'https://github.com/puppetlabs/puppet/commit/9f85c1c1ee189066e3619ca353d641e6b725c448', '2014-05-22T14:52:23.000-0700', '2018-04-20T09:15:52.000-0700', '2018-04-20T09:15:52.000-0700', 'Resolved', 'customer;support', 2, '0', 0, 0, 0, 0, '9f85c1c1ee189066e3619ca353d641e6b725c448'),
('puppet', 133483, 181606324, 6787, 'metrics.time.total does not correlate to time reported in log', 'The time reported by a `puppet agent -t` run for "Applied catalog in" does not appear to correlate to the times reported in the Puppet::Util::Metric "time" array.  The applied catalog time should be the time used to apply the resources in the catalog, and the times returned to the report processor in the Puppet::Util::Metric "time" array should be the amount of time spent applying each resource, yet the two do not add up.  Sometimes the applied catalog line is larger and sometimes the total time is larger.\r\n\r\n{code:java}\r\n# cat lib/puppet/reports/myreport.rb\r\nrequire ''puppet''\r\nPuppet::Reports.register_report(:myreport) do\r\n  desc "Testing"\r\n\r\n  def process\r\n    Puppet.notice "METRICS: Process Puppet Report"\r\n    Puppet.notice "METRICS: self.logs.last.message: #{self.logs.last.message}"\r\n    self.metrics[''time''].values.each { |val|\r\n      Puppet.notice "METRICS: #{val[1]} : #{val[2]}"\r\n    }\r\n  end\r\n# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201612-master.puppetdebug.vlan\r\nInfo: Applying configuration version ''1464042693''\r\nNotice: Applied catalog in 9.18 seconds\r\n# tail -n 21 /var/log/puppetlabs/puppetserver/puppetserver.log\r\n2016-05-23 22:31:53,920 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Process Puppet Report\r\n2016-05-23 22:31:53,920 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: self.logs.last.message: Applied catalog in 9.18 seconds\r\n2016-05-23 22:31:53,920 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Augeas : 1.017779943\r\n2016-05-23 22:31:53,920 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Config retrieval : 10.645895659\r\n2016-05-23 22:31:53,920 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Cron : 0.001115222\r\n2016-05-23 22:31:53,920 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Exec : 0.169413854\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: File : 0.45819617799999984\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Filebucket : 0.000103239\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Group : 0.000411452\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Package : 0.7939065209999999\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe anchor : 7.1151e-05\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe file line : 0.0023166209999999996\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe hocon setting : 1.4407772629999998\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe ini setting : 0.020410037\r\n2016-05-23 22:31:53,921 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe ini subsetting : 0.0049442060000000005\r\n2016-05-23 22:31:53,922 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe java ks : 1.454764838\r\n2016-05-23 22:31:53,922 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Pe puppet authorization hocon rule : 1.8567533360000004\r\n2016-05-23 22:31:53,922 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Schedule : 0.00041616200000000003\r\n2016-05-23 22:31:53,922 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Service : 0.35225476499999997\r\n2016-05-23 22:31:53,923 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: Total : 18.221604979000002\r\n2016-05-23 22:31:53,923 INFO  [qtp1308528397-63] [puppet-server] Puppet METRICS: User : 0.002074532\r\n{code}\r\n\r\nIn this case, the catalog applied in 9.18 seconds, but the (Total) - (Config retrieval) is 7.57 even though the documentation would seem to indicate they are measuring the same thing.', 'https://tickets.puppetlabs.com/browse/PUP-6344', 'https://github.com/puppetlabs/puppet/pull/6787', '2016-05-23T16:16:01.000-0700', '2018-04-23T07:50:40.000-0700', '2018-04-23T07:50:40.000-0700', 'Closed', '', 21, '0', 1, 117, 110, 2, '5c092467789093d87228c1f471a469d314e3ae4f'),
('puppet', 84676, 131401003, 6080, 'Puppet config set --section main foo bar does not set or respect an empty [main] section', 'With a puppet.conf that does not have a [main] section, `puppet config set --section main foo bar` does not create a [main] section.\r\n\r\nWith a puppet.conf that has an empty [main] section, `puppet config set --section main foo bar` places the setting at the top of the file, outside of the [main] section.\r\n\r\nBoth cases I believe are because it the default section is treated as ''[main]''\r\n\r\nThis only came up because we test for augeas functionality on puppet.conf in PE, and augeas does not like to parse a puppet.conf with settings that are not in a section, and the pe_repo adds settings to [main], but the default puppet.conf no longer has sections...', 'https://tickets.puppetlabs.com/browse/PUP-4755', 'https://github.com/puppetlabs/puppet/pull/6080', '2015-06-15T19:46:58.000-0700', '2018-05-02T15:44:04.000-0700', '2018-05-02T15:44:04.000-0700', 'Closed', 'cs_pr_review', 6, '0', 2, 33, 2, 2, 'b1990afa77800597acbdc683500f8b61e0caaa68'),
('puppet', 69559, 0, 0, 'System module path should be a thing on Windows', 'puppet''s `basemodulepath` defaults to:\r\n\r\n{code:ruby}\r\n    :basemodulepath => {\r\n      :default => "$codedir/modules#{File::PATH_SEPARATOR}/opt/puppetlabs/puppet/modules",\r\n{code}\r\n\r\nThe system module path is hardcoded to be *nix specific. The default value should be updated to a place that makes sense on Windows, likely {{C:\ProgramData\PuppetLabs\puppet\modules}}.\r\n\r\nhttps://github.com/puppetlabs/puppet-specifications/blob/master/file_paths.md will need to be updated too.', 'https://tickets.puppetlabs.com/browse/PUP-4049', 'https://github.com/puppetlabs/puppet/commit/d46c1545043c341e853027c84f276b8c239ed65a', '2015-02-26T12:05:31.000-0800', '2018-05-11T11:58:12.000-0700', '2018-05-11T11:58:12.000-0700', 'Closed', 'AIO_TechDebt;windows', 3, '0', 0, 0, 0, 0, 'd46c1545043c341e853027c84f276b8c239ed65a'),
('puppet', 201487, 131520969, 6081, 'Downgrading a package with pkgin fails silents', 'Due to a bug in pkgsrc (https://github.com/NetBSDfr/pkgin/issues/73), the pkgin provider fails silently when trying to ensure a particular version of a package is installed when a newer one is already installed.', 'https://tickets.puppetlabs.com/browse/PUP-7790', 'https://github.com/puppetlabs/puppet/pull/6081', '2017-07-20T03:29:34.000-0700', '2018-05-21T13:14:59.000-0700', '2018-05-21T13:14:59.000-0700', 'Closed', '', 2, '0', 2, 5, 2, 2, ''),
('puppet', 183767, 114118012, 5778, 'Make Pcore loaders available to relevant CLI apps', 'The Pcore loader is normally initialized by the compiler. For CLI applications such as puppet apply, puppet resource, or puppet device, there might never be a compiler available. Those commands needs to initialize the loaders differently.\r\n\r\nExploratory work for this has already been made on a test branch used by netconf.\r\n\r\nLoading without compiler also relates to PUP-7197 since these commands are expected to function when executed on the agent.', 'https://tickets.puppetlabs.com/browse/PUP-7423', 'https://github.com/puppetlabs/puppet/pull/5778', '2017-04-03T07:43:16.000-0700', '2018-05-21T13:43:03.000-0700', '2018-05-21T13:43:03.000-0700', 'Closed', '', 4, '0', 3, 120, 62, 6, '72ecbe429ce5136ffe4ab628672d6dc9faabfcdc'),
('puppet', 69740, 0, 0, 'autoload.loadall does not use current environment', 'UPDATE\r\n----\r\nThe documented way of loading functions to allow calling them is not correct. The docs at this location: https://docs.puppetlabs.com/guides/custom_functions.html#calling-functions-from-functions says that the function "loadall" should be called. That is neither recommended nor required. The function can simply be called (as already documented), or loaded by name (also as documented). \r\n\r\nThe reported problem can be fixed by specifying the environment from which the function should be loaded in the call to loadall. This is however already\r\ncorrectly done by the direct call using the {{function_}} prefix, as well as and the load of a single function. The load is useful if the user wants to check\r\nif the function is available (to give a custom error message).\r\n\r\nUsing {{loadall}} is not recommended (even when given an environment), since it loads *all* functions - which is both slow and makes unused functions take up memory. User code should not really interact directly with the autoloaders. Suggest skipping mentioning loadall in the documentation.\r\n\r\nORIGINAL\r\n----\r\nAccording to puppet custom function documentation, if one wanted to call a custom function from within another custom function, `Puppet::Parser::Functions.autoloader.loadall()` is required first.  While creating a function library I noticed that older versions of my functions were being run even when restarting my master server.  Upon further digging and running puppet from source, I found a few things:\r\n\r\n1. It appears that in lib/puppet/util/autoload.rb, line 131 (acd5fd0 Merge branch ''PUP-2478/3.6.1/security_fixes'' into stable) `env` is not getting set to the current_environment.\r\n2. A good workaround for me is to use `Puppet::Parser::Functions.autoloader.load(:function)`, although this may result in loading functions more times than necessary.\r\n3. In later releases, another suitable workaround might be to call `Puppet::Parser::Functions.autoloader.loadall(Puppet.lookup(:current_environment))` instead.\r\n4. Modifying the source of line 131 to load the current env also fixed my issue, so you may want to investigate that as a possible upstream solution.\r\n\r\nIt looks like this bug has been there for some time, so I must be exercising an usual use case if I''m the first to hit it.  Or maybe there is something else I''m missing.  Please let me know. Thanks.', 'https://tickets.puppetlabs.com/browse/PUP-4058', 'https://github.com/puppetlabs/puppet/commit/4909a533fb771ccfd96c8a7e99f0b9ede513a097', '2015-02-27T15:59:53.000-0800', '2018-05-24T13:49:37.000-0700', '2018-05-24T13:49:37.000-0700', 'Closed', '', 8, '0', 0, 0, 0, 0, '4909a533fb771ccfd96c8a7e99f0b9ede513a097'),
('puppet', 177590, 111184441, 5725, 'Instantiating Puppet::SSL::DefaultValidator shouldn''t trigger client SSL initialization', 'The {{Puppet::SSL::DefaultValidator}} class is unsafe to call when the Puppet client SSL state isn''t initialized. The {{#initialize}} method takes a {{Puppet::SSL::Host}} object which is reasonable(ish), but the default value calls {{Puppet::SSL::Host.localhost}} which has the side effect of trying to generate a certificate if no certificate exists. This is cause and symptom of the unholy thicket of implicit SSL initialization, and this behavior introduces a lot of weird behavior.\r\n\r\nTo add to the fun, the {{DefaultValidator}} also switches behavior at runtime depending on if the CA or client certificates are available. This is fairly magic behavior and can be replaced with a proper concept of an "upgrading" validator that uses the best validator available, and multiple validators that perform different validation (and connection setup) based on what sort of validation credentials are available.\r\n\r\nIn order to detangle this, we need to break up the {{DefaultValidator}}', 'https://tickets.puppetlabs.com/browse/PUP-7283', 'https://github.com/puppetlabs/puppet/pull/5725', '2017-02-28T11:56:18.000-0800', '2018-05-25T08:38:08.000-0700', '2018-05-25T08:38:08.000-0700', 'Closed', '', 5, '0', 2, 585, 407, 19, '1ec3b277826af178d52a074f26a8cf8bf2cdb84f'),
('puppet', 138873, 79074848, 5153, 'Win32-Service Windows Gem 0.8.9 causing CI PR failures in AppVeyor', 'During investigation into CI PR failures for Puppet [~daniel.lu] found that several gems had been updated and that all subsequent PRs in Appveyor were failing with the same error.\r\n\r\ne.g.\r\n{code}\r\nC:\source\puppet-pete>bundle exec rspec spec/unit\r\nDL is deprecated, please use Fiddle\r\nC:/source/puppet-pete/lib/puppet/defaults.rb:274:in `block in <module:Puppet>'': undefined method `split'' for nil:NilClass (NoMethodError)\r\n        from C:/source/puppet-pete/lib/puppet/settings.rb:919:in `block in define_settings''\r\n        from C:/source/puppet-pete/lib/puppet/settings.rb:918:in `each''\r\n        from C:/source/puppet-pete/lib/puppet/settings.rb:918:in `define_settings''\r\n        from C:/source/puppet-pete/lib/puppet.rb:81:in `define_settings''\r\n        from C:/source/puppet-pete/lib/puppet/defaults.rb:151:in `<module:Puppet>''\r\n        from C:/source/puppet-pete/lib/puppet/defaults.rb:1:in `<top (required)>''\r\n        from C:/source/puppet-pete/lib/puppet.rb:116:in `require''\r\n        from C:/source/puppet-pete/lib/puppet.rb:116:in `<module:Puppet>''\r\n        from C:/source/puppet-pete/lib/puppet.rb:33:in `<top (required)>''\r\n{code}\r\n\r\nThis error could replicated locally on a Windows workstation as well.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6445', 'https://github.com/puppetlabs/puppet/pull/5153', '2016-06-27T09:45:07.000-0700', '2018-06-05T15:55:35.000-0700', '2018-06-05T15:55:35.000-0700', 'Closed', '', 7, '0', 1, 14, 10, 1, 'd4d6734e5f858b4e3f4db24c356ea7cb9db2d991'),
('puppet', 18321, 156554087, 6418, 'Comparing package versions in puppet behaves differently to yum', 'I''m trying to make use of the yum downgrade functionality which is described in Issue #2866.\r\n\r\nOur build process creates packages with a typical rpm version say:\r\n\r\nfoo-2.2-405.noarch.rpm which compared with package foo-2.2-406.noarch.rpm works perfectly fine\r\n\r\nBut If I build a local version of my package there is no build number and the package is named for ex:\r\n\r\nfoo-2.2-SNAPSHOT20121119105647.noarch.rpm which compared with foo-2.2-405.noarch.rpm in puppet returns as a higher version.\r\n\r\nWith foo-2.2-405.noarch.rpm installed I can do yum downgrade foo-2.2-SNAPSHOT20121119105647 but the same thing in a puppet manifest fails at this stage in puppet/provider/package/yum.rb:\r\n\r\n<pre>if is && Puppet::Util::Package.versioncmp(should, is[:ensure]) < 0</pre>\r\n\r\nWhich leads me to:\r\npuppet/util/package.rb where the version compare is happening. Can this be updated to compare the versions in the same way yum does?\r\n\r\nFor completeness I want the puppet manifests to be the same in all environments, from LOCAL->DEV->QA->PROD and not have to add any extra exec''s to uninstall packages.\r\n\r\nThanks,\r\nPierre', 'https://tickets.puppetlabs.com/browse/PUP-682', 'https://github.com/puppetlabs/puppet/pull/6418', '2013-11-06T11:39:57.000-0800', '2018-06-07T13:30:28.000-0700', '2018-06-07T13:30:28.000-0700', 'Closed', 'customer;redmine;yum', 6, '0', 1, 25, 4, 2, '7afb055d65e9baecf2ab7d54b8453d7bef647896'),
('puppet', 150403, 0, 0, 'Broken repo link', 'PM V2015.3.1\r\nAgent 4.6.1\r\nAfter adding class "pe_repo::platform::el_6_x86_64"\r\n\r\n\r\npuppet agent -t on PM fails\r\n\r\n\r\n{code:java}\r\nNotice: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::File[puppet-agent-el-6-x86_64.tar.gz]/Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6.1/puppet-agent-el-6-x86_64.tar.gz]/returns:   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\nNotice: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::File[puppet-agent-el-6-x86_64.tar.gz]/Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6.1/puppet-agent-el-6-x86_64.tar.gz]/returns:                                  Dload  Upload   Total   Spent    Left  Speed\r\nNotice: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::File[puppet-agent-el-6-x86_64.tar.gz]/Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:100   286  100   286    0     0   1150      0 --:--:-- --:--:-- --:--:--  1153\r\nNotice: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::File[puppet-agent-el-6-x86_64.tar.gz]/Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r\nNotice: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::File[puppet-agent-el-6-x86_64.tar.gz]/Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6.1/puppet-agent-el-6-x86_64.tar.gz]/returns: curl: (22) The requested URL returned error: 404 Not Found\r\nError: curl  -f -L -o puppet-agent-el-6-x86_64.tar.gz https://pm.puppetlabs.com/puppet-agent/2015.3.1/1.6.1/repos/puppet-agent-el-6-x86_64.tar.gz returned 22 instead of one of [0]\r\nError: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::File[puppet-agent-el-6-x86_64.tar.gz]/Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6.1/puppet-agent-el-6-x86_64.tar.gz]/returns: change from notrun to 0 failed: curl  -f -L -o puppet-agent-el-6-x86_64.tar.gz https://pm.puppetlabs.com/puppet-agent/2015.3.1/1.6.1/repos/puppet-agent-el-6-x86_64.tar.gz returned 22 instead of one of [0]\r\nNotice: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::Extract[puppet-agent-el-6-x86_64.tar.gz]/Exec[extract puppet-agent-el-6-x86_64.tar.gz]: Dependency Exec[/opt/puppetlabs/server/data/staging/pe_repo-puppet-agent-1.6.1/puppet-agent-el-6-x86_64.tar.gz] has failures: true\r\nWarning: /Stage[main]/Pe_repo::Platform::El_6_x86_64/Pe_repo::El[el-6-x86_64]/Pe_repo::Repo[el-6-x86_64 2015.3.1]/Pe_staging::Deploy[puppet-agent-el-6-x86_64.tar.gz]/Pe_staging::Extract[puppet-agent-el-6-x86_64.tar.gz]/Exec[extract puppet-agent-el-6-x86_64.tar.gz]: Skipping because of failed dependencies\r\nNotice: Applied catalog in 12.20 seconds\r\n\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6676', 'https://github.com/puppetlabs/puppet/commit/9257810a4a90f3a483e039635a98c1ab5c9bc02c', '2016-09-02T15:24:20.000-0700', '2018-06-07T13:32:00.000-0700', '2018-06-07T13:32:00.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, '9257810a4a90f3a483e039635a98c1ab5c9bc02c'),
('puppet', 166323, 97979540, 5435, 'Raise errors if hiera.yaml version 4 is used globally', 'Since PUP-6980 (not yet released), it is possible to use a hiera.yaml version 4 in the global layer. It shouldn''t be. Only version 3 and version 5 should be allowed in global scope.', 'https://tickets.puppetlabs.com/browse/PUP-7013', 'https://github.com/puppetlabs/puppet/pull/5435', '2016-12-14T07:21:42.000-0800', '2018-06-07T13:33:29.000-0700', '2018-06-07T13:33:29.000-0700', 'Closed', '', 2, '0', 1, 73, 6, 5, 'abb3378d55115aad7292fd8274b412c8580e5125'),
('puppet', 245717, 185791233, 6815, 'http_keepalive_timeout setting doesn''t work correctly under Ruby 2.x', 'Back when the {{http_keepalive_timeout}} setting was introduced, Puppet ran under Ruby 1.9.3 and life was good:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/5.5.0/lib/puppet/network/http/pool.rb\r\n\r\nThen Ruby 2.x descended from the mountains and brought with it a {{Net::HTTP#keep_alive_timeout}}:\r\n\r\nhttps://github.com/ruby/ruby/blob/v2_4_3/lib/net/http.rb#L664\r\n\r\nRuby''s timeout defaults to 2 seconds and always overrides the timeout used by the Puppet agent. This causes HTTP connections to be closed early instead of being re-used which increases the TLS handshake load on Puppet Server along with the amount of connection state that network devices between the agent and server have to contend with.\r\n\r\n\r\nh2. Reproduction Case\r\n\r\n  - Install {{puppet-agent}} 5.5.0 and {{puppetserver}} 5.3.0 on a CentOS 7\r\n    node:\r\n\r\n{code:bash}\r\nrpm -Uvh http://yum.puppetlabs.com/puppet5/puppet5-release-el-7.noarch.rpm\r\nyum install -y puppet-agent-5.5.0 puppetserver-5.3.0\r\n{code}\r\n\r\n  - Configure the puppet agent to connect to the local host and start\r\n    puppetserver:\r\n\r\n{code:bash}\r\n/opt/puppetlabs/bin/puppet config set --section main server $(hostname -f)\r\nsystemctl start puppetserver\r\n{code}\r\n\r\n\r\n  - Run {{puppet agent -t}} to verify things work.\r\n\r\n  - Add a custom fact that will sleep for 4 seconds, which delays the\r\n    HTTP POST request for a catalog:\r\n\r\n{code:bash}\r\ncat <<-''EOF'' > /etc/puppetlabs/code/modules/testmod/lib/facter/sleep_fact.rb\r\nFacter.add(:sleep_fact) do\r\n  setcode do\r\n    $stdout.puts("Sleeping for 4 seconds...")\r\n    Kernel.sleep(4)\r\n    nil\r\n  end\r\nend\r\nEOF\r\n{code}\r\n\r\n  - Set Puppet''s {{http_keepalive_timeout}} to 15 seconds:\r\n\r\n{code:bash}\r\n/opt/puppetlabs/bin/puppet config set --section main http_keepalive_timeout 15s\r\n{code}\r\n\r\n  - Run {{puppet agent -t}} and track HTTP connections:\r\n\r\n{code:bash}\r\n/opt/puppetlabs/bin/puppet agent -t --http_debug 2>&1|grep -v ''^->\|<-''\r\n{code}\r\n\r\n\r\nh3. Outcome\r\n\r\nThe Puppet Agent opens a new TCP connection after loading facts despite\r\n{{http_keepalive_timeout}} being set to 15 seconds:\r\n\r\n{noformat}\r\n# /opt/puppetlabs/bin/puppet agent -t --http_debug 2>&1|grep -v ''^->\|<-''\r\nopening connection to m4t83ynafhampi9.delivery.puppetlabs.net:8140...\r\nopened\r\nstarting SSL for m4t83ynafhampi9.delivery.puppetlabs.net:8140...\r\nSSL established\r\nreading 3339 bytes...\r\nread 3339 bytes\r\nConn keep-alive\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nreading 204 bytes...\r\nread 204 bytes\r\nConn keep-alive\r\nInfo: Retrieving plugin\r\nreading 259 bytes...\r\nread 259 bytes\r\nConn keep-alive\r\nInfo: Retrieving locales\r\nreading 204 bytes...\r\nread 204 bytes\r\nConn keep-alive\r\n\r\nInfo: Loading facts\r\nSleeping for 4 seconds...\r\nConn close because of keep_alive_timeout\r\nopening connection to m4t83ynafhampi9.delivery.puppetlabs.net:8140...\r\nopened\r\nstarting SSL for m4t83ynafhampi9.delivery.puppetlabs.net:8140...\r\nSSL established\r\n\r\nreading 310 bytes...\r\nread 310 bytes\r\nConn keep-alive\r\nInfo: Caching catalog for m4t83ynafhampi9.delivery.puppetlabs.net\r\nInfo: Applying configuration version ''1523668333''\r\nNotice: Applied catalog in 0.11 seconds\r\nreading 9 bytes...\r\nread 9 bytes\r\nConn keep-alive\r\n{noformat}\r\n\r\n\r\nh3. Expected Outcome\r\n\r\nThe Puppet agent should re-use the connection opened at the beginning of the run.', 'https://tickets.puppetlabs.com/browse/PUP-8663', 'https://github.com/puppetlabs/puppet/pull/6815', '2018-04-13T18:14:53.000-0700', '2018-06-08T13:34:58.000-0700', '2018-06-08T13:34:58.000-0700', 'Closed', '', 4, '0', 4, 38, 28, 2, '27202a4ac3f085b336b44c2885ee3a8a2eac4873'),
('puppet', 244650, 181110636, 6786, 'freeze_main setting breaks when used with type aliases', 'The {{freeze_main}} setting throws an error when used with code containing type aliases.\r\n\r\nReproduction:\r\n\r\n{code}\r\nmkdir -p test/modules test/manifests\r\npuppet module install --modulepath test/modules puppetlabs-stdlib\r\npuppet module install --modulepath test/modules puppetlabs-haproxy\r\necho ''include haproxy; notify { "test": }'' > test/manifests/site.pp\r\npuppet apply --modulepath test/modules --freeze_main test/manifests/site.pp --noop\r\n{code}\r\n\r\nThis error will be thrown:\r\n\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Type-Name, Cannot have code outside of a class/node/define because ''freeze_main'' is enabled at /Users/reidmv/tmp/modules/haproxy/manifests/init.pp:123:3 on node halcyon.corp.puppetlabs.net\r\n{code}\r\n\r\nThe line number reported is [this one|https://github.com/puppetlabs/puppetlabs-haproxy/blob/2.1.0/manifests/init.pp#L123]:\r\n\r\n{code}\r\nclass haproxy (\r\n  ...\r\n  Stdlib::Absolutepath $config_dir                             = $haproxy::params::config_dir,\r\n  ...\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8637', 'https://github.com/puppetlabs/puppet/pull/6786', '2018-04-06T11:56:23.000-0700', '2018-06-08T13:40:35.000-0700', '2018-06-08T13:40:35.000-0700', 'Closed', '', 5, '0', 1, 46, 8, 3, 'd8a33edac065b626e640313e419ad63c283125a7'),
('puppet', 249893, 0, 0, 'Default basemodulepath should exclude /opt on Windows', 'On Windows, {{basemodulepath}} defaults to {{C:/ProgramData/PuppetLabs/code/modules;C:/opt/puppetlabs/puppet/modules}} when running as a privileged user. An unprivileged user can drop a custom ruby fact into {{C:/opt/puppetlabs/puppet/modules/<module>/lib/facter/<fact>.rb}} and escalate privileges the next time the puppet service runs. This is possible because Windows allows all users to create directories in C:/\r\n\r\nThe {{basemodulepath}} should not include {{/opt}} on Windows.', 'https://tickets.puppetlabs.com/browse/PUP-8707', 'https://github.com/puppetlabs/puppet/commit/ce899336560ade7d417915afd873a5357cfb65f2', '2018-05-09T11:10:59.000-0700', '2018-06-13T09:44:14.000-0700', '2018-06-13T09:44:14.000-0700', 'Closed', 'security', 4, '0', 0, 0, 0, 0, 'ce899336560ade7d417915afd873a5357cfb65f2'),
('puppet', 230681, 163302192, 6533, 'Listing tasks incorrectly maps files to task names', 'Currently, puppet uses basic substring matching to determine which files are associated with a given task. That causes task files to be incorrectly associated with tasks in the case where the name of one task is a prefix of another task. For example:\r\n\r\n{code}\r\n$ ls tasks\r\nfoo.sh\r\nfoo.json\r\nfoobar.sh\r\nfoobar.json\r\n{code}\r\n\r\nIn this case, all four files will match for task "foo", which will cause an error when trying to load that task (because a task is only allowed one executable file).\r\n\r\nPuppet should ensure that it matches only at the file extension boundary, so {{foo.sh}} and {{foo.json}} are the only files associated with task "foo".', 'https://tickets.puppetlabs.com/browse/PUP-8357', 'https://github.com/puppetlabs/puppet/pull/6533', '2018-01-16T11:06:35.000-0800', '2018-06-18T12:12:08.000-0700', '2018-06-18T12:12:08.000-0700', 'Closed', '', 3, '0', 1, 52, 4, 3, '1c262644f8a91b1281466c996b941e3c6e127124'),
('puppet', 227136, 159286454, 6466, 'Application management ''plan'' not working', 'Acceptance test failure https://cinext-jenkinsmaster-enterprise-prod-1.delivery.puppetlabs.net/job/enterprise_pe-orchestrator-client_intn-van-sys_irving/97/SLAVE_LABEL=beaker,TEST_TARGET=centos7-64.mdc-osx1011-64client.a-redhat7-64af-64af-64af,UNEEDED=UNEEDED/testReport/junit/(root)/tests_job/plan_rb/\r\n\r\n{code:title=/etc/puppetlabs/code/environments/plan_dakgj3/manifests/site.pp}\r\n\r\nsite {\r\n  plan { "plan_dakgj3":\r\n    nodes       => {\r\n      Node["v5mxsg11vm4ogwc.delivery.puppetlabs.net"] => Plan::Node_file["node_file_plan_dakgj3"],\r\n    }\r\n  }\r\n{code}\r\n\r\n{code:title=Server_Error}\r\nndocka1xg1rqbk0.delivery.puppetlabs.net (redhat7-64-1) 15:31:12$ /opt/puppetlabs/client-tools/bin/puppet-job plan --environment plan_dakgj3 --nodes v5mxsg11vm4ogwc.delivery.puppetlabs.net\r\n  Failed to submit plan: puppetlabs.orchestrator/request-failure: Server Error: Evaluation Error: Illegal Resource Type expression, expected result to be a type name, or untitled Resource, got String at /etc/puppetlabs/code/environments/plan_dakgj3/manifests/site.pp:3:3 in environment plan_dakgj3\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8269', 'https://github.com/puppetlabs/puppet/pull/6466', '2017-12-18T15:56:21.000-0800', '2018-06-18T12:12:22.000-0700', '2018-06-18T12:12:22.000-0700', 'Closed', '', 4, '0', 1, 1515, 1538, 8, 'fde509691009cf5d341badb4989c4d750e547890'),
('puppet', 233892, 166408987, 6598, 'Puppet Error datatype uses ''message'' not ''msg'' as hash key', 'This means using it requires translation from bolt task output and does not align with our standard API data representation of hashes that use ''msg''. The error datatype should be updates to create data hashes that include {{msg}} not {{message}} keys and it should expect that key when it is instantiated from a hash.', 'https://tickets.puppetlabs.com/browse/PUP-8406', 'https://github.com/puppetlabs/puppet/pull/6598', '2018-01-30T10:16:11.000-0800', '2018-06-18T12:12:25.000-0700', '2018-06-18T12:12:25.000-0700', 'Closed', '', 6, '0', 1, 57, 25, 4, '3e03e734dda415272ec156b03ed9f021ba243228'),
('puppet', 223709, 154273102, 6387, 'Parameters property in Task metadata should be optional', 'Tasks will run and accept any arguments if no metadata is provided. However, if a metadata file is present then it requires a parameters key; that violates the [specification|https://github.com/puppetlabs/puppet-specifications/tree/master/tasks#task-metadata].\r\n\r\nAn example of the error given (using BOLT-66) is\r\n{code}\r\n$ bolt task run echo message=''{"a": 1}'' foo=1 -n node1 --modulepath site\r\nError: The metadata for task echo has wrong type, expects a value for key ''parameters'' in site/echo/tasks/init.json on node mylaptop\r\nTask parameters did not match\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8197', 'https://github.com/puppetlabs/puppet/pull/6387', '2017-11-22T10:07:11.000-0800', '2018-06-18T12:12:30.000-0700', '2018-06-18T12:12:30.000-0700', 'Closed', '', 1, '0', 1, 1, 1, 1, '998ac378b976041d3bd2bff4af860174d6bc4f1f'),
('puppet', 223715, 155560485, 6403, 'Parameters in Task metadata should not collide with metadata keys', 'If a task declares a parameter that is also a metadata key, such as {{description}}, Puppet will fail to load the task.\r\n\r\nWith BOLT-66:\r\n{code}\r\n$ bolt task run echo message=''{"a": 1}'' -n node --modulepath site\r\nError: attribute Echo[description] is defined as both a constant and an attribute on node mylaptop\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8199', 'https://github.com/puppetlabs/puppet/pull/6403', '2017-11-22T10:24:56.000-0800', '2018-06-18T12:13:03.000-0700', '2018-06-18T12:13:03.000-0700', 'Closed', 'docs_reviewed', 5, '0', 3, 235, 479, 11, '13fc07efc348f2ca0ece352c33e5c799c25accc5'),
('puppet', 227063, 158494826, 6454, 'Non-existent Solaris SMF services are no longer defined as :stopped (LTS breaking change)', 'In Puppet 4.10.9, the behavior of non-existent Solaris SMF services changed, and at least one PE customer with a large Solaris install base has reported that this is preventing them from upgrading within the LTS series. \r\n\r\nPreviously, non-existent Solaris SMF services reported their state as :stopped, and could be defined as :stopped in Puppet code, to ensure that unwanted services were not running, even if they were not installed. \r\n\r\nIn Puppet 4.10.9, this behavior was changed to cause non-existent Solaris SMF services to report a state of :absent. A change like this should probably not be included in our LTS releases. Reverting the commits related to this change should be sufficient to resolve this issue for our customers.  ', 'https://tickets.puppetlabs.com/browse/PUP-8262', 'https://github.com/puppetlabs/puppet/pull/6454', '2017-12-18T09:11:31.000-0800', '2018-06-25T14:16:51.000-0700', '2018-06-25T14:16:51.000-0700', 'Closed', '', 0, '0', 1, 134, 36, 7, '516595760379def5aa14140e1cca71d0db8e8a71'),
('puppet', 18234, 83314409, 5244, 'Remove broken macauthorization provider from core types', '*Update 12/22*: Based on comments from Allister and Nigel this should be removed from core types. That may need to wait until Puppet 5 for semver reasons.\r\n\r\nIn OS X 10.9, `/etc/authorization` has been "deprecated"; as of the GM, the update will move `/etc/authorization` to `/etc/authorization.deprecated`.\r\n\r\nThere is now `/System/Library/Security/authorization.plist` but it seems to just be the defaults; changing a right with the `security authorizationdb` command doesn''t change that file, but instead updates a sqlite db at `/var/db/auth.db`.\r\n\r\nI did some quick testing, and just changing `AuthDB` in `puppet/provider/macauthorization/macauthorization.rb` isn''t enough because the provider reads the plist to determine current state, but in the 10.9 world the current state is reflected in the `auth.db` file (or the output of `security authorizationdb` commands) so even when a right change is applied, puppet doesn''t know.', 'https://tickets.puppetlabs.com/browse/PUP-661', 'https://github.com/puppetlabs/puppet/pull/5244', '2013-11-05T09:31:53.000-0800', '2018-07-03T14:58:43.000-0700', '2018-07-03T14:58:43.000-0700', 'Closed', 'breaking;macos;redmine;removal;type_and_provider', 13, '0', 1, 2, 0, 1, '26af1815f839d8abae99bd35e15f531afd05ac2d'),
('puppet', 13658, 16398037, 2700, 'Allow puppet to manage owner & group file settings (Redmine 18342)', 'From original Redmine ticket 18342 comment from [~josh], which this duplicates:\r\n\r\n{quote}I disabled the file settings code that manages owner and group on Windows, because at the time we didn’t yet have the ability to chown/chgrp. This has since been implemented, and so the ability to manage owner and group should be added.\r\n\r\nIn lib/puppet/settings/file_setting.rb\r\n\r\n# REMIND fails on Windows because chown/chgrp functionality not supported yet\r\nif Puppet.features.root? and !Puppet.features.microsoft_windows?\r\nWe also need to unconfine the acceptance test acceptance/tests/config/apply_file_metadata_specified_in_config.rb so that it runs on windows. See [#17371|https://projects.puppetlabs.com/issues/17371]{quote}', 'https://tickets.puppetlabs.com/browse/PUP-266', 'https://github.com/puppetlabs/puppet/pull/2700', '2013-08-26T15:38:36.000-0700', '2018-07-12T14:18:25.000-0700', '2018-07-12T14:18:25.000-0700', 'Closed', 'windows', 21, '0', 3, 40, 22, 3, '403a9a398c52382bb1982f610f7588144ff11ccc'),
('puppet', 217236, 163415419, 6543, 'Enforcement via ''puppet resource/apply'' overwrites transactionstore.yaml', 'Enforcing change using "puppet resource" or "puppet apply" causes the transactionstore.yaml file to be overwritten. This is often done as part of our integrations plus is common puppet usage among customers. The loss of the tx store mans that corrective change is not correctly identified on the run immediately afterwards. The next run causes the agent to restore the tx store again.\r\n\r\nStep 1 - After a run the tx store looks as expected\r\n!step1-after-puppet-run-the-txstore-looks-good.png|thumbnail!\r\nStep 2 - Enforce a change with puppet resource and the tx store is overwritten\r\n!step2-puppet-resource-enforcement-overwrites-txstore.png|thumbnail!\r\nStep 3 - The next agent run restores the expected tx store\r\n!step3-agreen-run-restores-txstore.png|thumbnail!\r\nStep 4 - Same issue using puppet apply, also doesn''t matter if the enforcement succeeds or fails\r\n!step4-puppet-apply-breaks-too.png|thumbnail!\r\n\r\nThe proposed fix is to modify the agent to load and store the transaction file only for agent runs, not puppet resource/apply, and consider making that behaviour configurable. We should also document that if you use "puppet resource" to modify a resource that is also managed by the agent, this is considered an out-of-band change and reported as corrective (e.g. agent creates file foo, user removes file foo using "puppet resource", agent recreates file foo and considers it a corrective change).\r\n\r\nHere''s the original description explaining how this manifests in the wild.\r\n\r\n{quote}\r\nJust had this happen during demo of 2017.3.0. I have a simple apache role with profiles and demo drift remediation by removing the index.html and having puppet heal it.\r\n\r\nhttps://github.com/puppetlabs/puppet-vro-starter_content/blob/production/site/profile/manifests/sample_website/linux.pp#L36-L39\r\n\r\nBut on the first noop run, it shows that "intentional changes" would be needed, and then enforcement shows "intentional changes". When I did the same thing again, it showed "corrective changes". Baffling. Also, the node graph did not update with colors representing corrective or intentional change (separate ticket coming).\r\n\r\n!Screen Shot 2017-10-19 at 8.34.57 AM.png|thumbnail!\r\n\r\nexplanation of above:\r\n* first run (bottom) is initial provisioning (intentional change makes sense)\r\n* second run is green, (no changes makes sense)\r\n* third run is after I executed {{rm -f /var/www/sample_website/index.html}} in an ssh session on the target machine. Shows intentional noop changes needed! Should be corrective noop!\r\n* fourth run is intentional change, wrong, should be corrective.\r\n* fifth run is after I executed {{rm -f /var/www/sample_website/index.html}} again. Got corrective noop this time, which is correct.\r\n* sixth run is enforcement of corrective change, which is correct.\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-8227', 'https://github.com/puppetlabs/puppet/pull/6543', '2017-10-19T08:34:16.000-0700', '2018-07-16T17:11:45.000-0700', '2018-07-16T17:11:45.000-0700', 'Closed', '', 16, '0', 1, 6, 6, 1, '20645e193764c1c3fbbcd649ba6bfd8a7f10ebb1'),
('puppet', 252295, 189985733, 6852, 'Logging as JSON broken', '*Puppet Version: 5.5.1*\r\n *Puppet Server Version: n/a*\r\n *OS Name/Version: RHEL 7.x*\r\n\r\nRunning the puppet agent with the --logdest option pointing at a JSON target file causes a Ruby backtrace.\r\n\r\n*Desired Behavior:*\r\n\r\nPuppet should log as JSON.\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\nExample output:\r\n{noformat}# puppet agent -t --noop --logdest /tmp/foo.json\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_gems/gems/multi_json-1.13.1/lib/multi_json.rb:130:in `current_adapter'': undefined method `[]'' for #<File:/tmp/foo.json> (NoMethodError)\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_gems/gems/multi_json-1.13.1/lib/multi_json.rb:139:in `dump''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/json.rb:70:in `dump''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log/destinations.rb:112:in `handle''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:191:in `block in newmessage''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:190:in `each''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:190:in `newmessage''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:308:in `initialize''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:88:in `new''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:88:in `create''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:11:in `send_log''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:20:in `block (2 levels) in <module:Logging>''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:69:in `log_exception''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:673:in `rescue in exit_on_fail''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:660:in `exit_on_fail''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:366:in `run''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:137:in `run''\r\n        from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:73:in `execute''\r\n        from /opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n{noformat}\r\nChange the log destination to /tmp/foo.txt and it doesn''t error.\r\n\r\nIt looks like this bug was introduced in 5.5.0, 5.4.0 still works as expected, possibly related to PUP-8501.', 'https://tickets.puppetlabs.com/browse/PUP-8773', 'https://github.com/puppetlabs/puppet/pull/6852', '2018-05-23T04:36:08.000-0700', '2018-07-18T06:39:36.000-0700', '2018-07-18T06:39:36.000-0700', 'Closed', '', 3, '0', 1, 29, 13, 2, '35e8f8e18dd6105867e27c710922d13ba0b539db'),
('puppet', 246866, 183186379, 6796, 'Memory leak in Puppet Server from loading translations', 'There is a memory leak introduced with i18n which is triggered when an environment is expired. If the environment was ephemeral and will never be used again, then the translation repository related to that environment will never be deleted.\r\n\r\nSpecifically https://github.com/puppetlabs/puppet/blob/master/lib/puppet/gettext/config.rb#L120 never successfully clears a translation repository. When we add a text domain, we always use a symbolized version of the environment name. When we delete the domain, it uses the environment name in the environment cache (which is almost always a string). Meaning we almost never actually delete a domain. When an environment is used again, it will overwrite the previous {{translation_repositories}} entry, so garbage collection will then cleanup the old translation repository.\r\n\r\nWhile digging into this, we also found that successfully deleting domains leads to a thread-local storage issue in Puppet Server that will need to be addressed:\r\n* thread A creates an environment as part of a request\r\n* thread B deletes it because it''s expired (so A''s {{text_domain}} now refers to an absent domain) and creates a different environment\r\n* thread A tries to handle a request and fails because it''s configured for an unknown domain.', 'https://tickets.puppetlabs.com/browse/PUP-8672', 'https://github.com/puppetlabs/puppet/pull/6796', '2018-04-20T13:47:24.000-0700', '2018-07-18T06:39:43.000-0700', '2018-07-18T06:39:43.000-0700', 'Closed', '', 4, '0', 6, 73, 30, 7, 'cee544ae8252cd816b6f13ae1debb53b06e35781'),
('puppet', 242614, 186965427, 6826, 'puppet device --resource should fail if non-existent target is given', 'The error message is not displayed unless --debug is passed.', 'https://tickets.puppetlabs.com/browse/PUP-8585', 'https://github.com/puppetlabs/puppet/pull/6826', '2018-03-22T09:15:37.000-0700', '2018-07-18T06:39:46.000-0700', '2018-07-18T06:39:46.000-0700', 'Closed', '', 2, '0', 1, 34, 39, 2, '3bbff2a8115bba25acaea8707268db7388d25668'),
('puppet', 82885, 191285958, 6859, 'windows file resource doesn''t grant group full permissions', 'If you grant {{rwx}} permission to a file''s group:\r\n\r\n{code:puppet}\r\nuser { ''foo'':\r\n  ensure => present,\r\n  managehome => false,\r\n  password => ''foo1234!'',\r\n  groups => [''Users''],\r\n}\r\nfile { ''C:\foo'':\r\n  ensure => directory,\r\n  owner => ''foo'',\r\n  group => ''Administrators'',\r\n  mode => ''0770'',\r\n}\r\nfile { ''C:\foo\foo.bat'':\r\n  ensure => file,\r\n  content => ''echo "hello"''\r\n}\r\n{code}\r\n\r\nThe windows provider does not map that to full control. Instead the group receives a subset of permissions. More specifically, any file contained in the directory being managed is not executable:\r\n\r\n{noformat}\r\nC:\> puppet apply foo.pp\r\nNotice: Compiled catalog for win-qp47voha2p4.solar.lan in environment production in 0.50 seconds\r\nNotice: /Stage[main]/Main/File[C:\foo]/ensure: created\r\nNotice: /Stage[main]/Main/File[C:\foo\foo.bat]/ensure: defined content as ''{md5}84b8f5c3577073eac07c9e9915e5b8c9''\r\nNotice: Applied catalog in 0.06 seconds\r\nC:\> icacls c:\foo\r\nc:\foo WIN-QP47VOHA2P4\foo:(F)\r\n       BUILTIN\Administrators:(RX,W,DC)\r\n       Everyone:(Rc,S,RA)\r\n       NT AUTHORITY\SYSTEM:(F)\r\n       CREATOR OWNER:(CI)(IO)(F)\r\n       CREATOR GROUP:(CI)(IO)(RX,W,DC)\r\n       CREATOR OWNER:(OI)(IO)(R,W,D,WDAC,WO,DC)\r\n       CREATOR GROUP:(OI)(IO)(R,W,DC)\r\n\r\nSuccessfully processed 1 files; Failed processing 0 files\r\nC:\> icacls C:\foo\foo.bat\r\nC:\foo\foo.bat BUILTIN\Administrators:(I)(R,W,D,WDAC,WO,DC)\r\n               WIN-QP47VOHA2P4\None:(I)(R,W,DC)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-4684', 'https://github.com/puppetlabs/puppet/pull/6859', '2015-06-02T17:00:37.000-0700', '2018-07-18T06:39:47.000-0700', '2018-07-18T06:39:47.000-0700', 'Closed', 'windows', 1, '0', 1, 58, 15, 3, '14f429a8bc96d807280668b80c56a542dacce15e'),
('puppet', 221627, 154216527, 6384, 'Service SMF provider tries to stop absent service', 'A behavior change introduced in PUP-6797 for the SMF service provider breaks existing code for customers that are upgrading. The SMF provider now sets a service as _absent_ instead of _stopped_ when the service is not found on the system. The service provider does not check for the existence of the service when trying to stop the service. The result is that configuring an absent service to be stopped will error out, where as it previously succeeded. \r\n\r\nThe issue is not with the _absent_ change, but rather that the _stop_ is run against the _absent_ service. Below is an easy reproduction case. \r\n\r\nInstall any agent 4.9.0+ and apply the following manifest. \r\n\r\n{code}\r\n# cat test.pp\r\nservice {''svc:/system/console-login:terma'':\r\nensure => stopped,\r\nenable => false,\r\nprovider => ''smf'',\r\n}\r\n{code}\r\n\r\nThe resulting output is as follows.\r\n\r\n{code}\r\nDebug: Executing: ''/usr/bin/svcs -H -o state,nstate svc:/system/console-login:terma''\r\nDebug: Service[svc:/system/console-login:terma](provider=smf): Could not get status on service svc:/system/console-login:terma Execution of ''/usr/bin/svcs -H -o state,nstate svc:/system/console-login:terma'' returned 1: svcs: Pattern ''svc:/system/console-login:terma'' doesn''t match any instances\r\nDebug: Executing: ''/usr/sbin/svcadm disable -s svc:/system/console-login:terma''\r\nError: Could not stop Service[svc:/system/console-login:terma]: Execution of ''/usr/sbin/svcadm disable -s svc:/system/console-login:terma'' returned 1: svcadm: Pattern ''svc:/system/console-login:terma'' doesn''t match any instances\r\nError: /Stage[main]/Main/Service[svc:/system/console-login:terma]/ensure: change from absent to stopped failed: Could not stop Service[svc:/system/console-login:terma]: Execution of ''/usr/sbin/svcadm disable -s svc:/system/console-login:terma'' returned 1: svcadm: Pattern ''svc:/system/console-login:terma'' doesn''t match any instances\r\n{code}\r\n\r\nWhat I would expect is that since the service is marked as absent per [this commit|https://github.com/puppetlabs/puppet/commit/3d7a3c4c1c6697047ae356c8765928f68618bc69#diff-aacae589790e4f5cfb9e267afbffa294] and then the stop service should not be run since the service is absent. The service resource does not provide an _absent_ value to the _ensure_ parameter. ', 'https://tickets.puppetlabs.com/browse/PUP-8167', 'https://github.com/puppetlabs/puppet/pull/6384', '2017-11-12T19:06:14.000-0800', '2018-07-20T06:22:17.000-0700', '2018-07-20T06:22:17.000-0700', 'Closed', '', 4, '0', 1, 14, 0, 3, '7183a352288867392c1c934270c494e7b1270ab0'),
('puppet', 222298, 153474240, 6374, 'break() fails with illegal context error within hash iteration outside any function', 'break() fails with an illegal context error within hash iteration outside any function\r\n\r\nIt may be that I simply need to use a function and call it a day... I am, however, surprised that this doesn''t work, and I wonder if this is by design or by accident.\r\n\r\n{code:puppet}\r\n# test2.pp\r\n\r\n$test_hash = {\r\n  ''Linus''   => ''Torvalds'',\r\n  ''Richard'' => ''Stallman'',\r\n  ''Dennis''  => ''Ritchie'',\r\n}\r\n\r\n$test_hash.each |String $first, String $last| {\r\n  if $last == ''Stallman'' {\r\n    notice("YES")\r\n    break()\r\n  }\r\n  else {\r\n    notice("NO")\r\n  }\r\n}\r\n{code}\r\n\r\n{code:bash}\r\n$ puppet apply test2.pp\r\nNotice: Scope(Class[main]): NO\r\nNotice: Scope(Class[main]): YES\r\nError: break() from context where this is illegal at /tmp/test2.pp:12 on node <node>\r\n{code}\r\n\r\n\r\nI''ve tried the same thing with {{return()}}:\r\n{code:bash}\r\n$ puppet apply test2.pp\r\nNotice: Scope(Class[main]): NO\r\nNotice: Scope(Class[main]): YES\r\nError: return() from context where this is illegal at /tmp/test2.pp:13 on node <node>\r\n{code}\r\n\r\nIf I run {{break()}} within a class, I get the same error.\r\n\r\nIf I run {{return()}} within a class, it breaks out of the entire class rather than just the lambda in the {{.each}} loop:\r\n{code:puppet}\r\n# test3.pp\r\n\r\nclass test_class {\r\n  $test_hash = {\r\n    ''Linus''   => ''Torvalds'',\r\n    ''Richard'' => ''Stallman'',\r\n    ''Dennis''  => ''Ritchie'',\r\n  }\r\n\r\n  $test_hash.each |String $first, String $last| {\r\n    if $last == ''Stallman'' {\r\n      notice("YES")\r\n      return()\r\n    }\r\n    else {\r\n      notice("NO")\r\n    }\r\n  }\r\n\r\n  notice("OUT OF THE LOOP")\r\n}\r\n\r\ninclude ::test_class\r\n{code}\r\n\r\n{code:bash}\r\n$ puppet apply test3.pp\r\nNotice: Scope(Class[Test_class]): NO\r\nNotice: Scope(Class[Test_class]): YES\r\nNotice: Compiled catalog for <node> in environment production in 0.26 seconds\r\nNotice: Applied catalog in 0.45 seconds\r\n{code}\r\n\r\n\r\nEdit: Issue may be confined to hashes. I''m trying `map` like in the language doc''s examples (https://puppet.com/docs/puppet/5.3/function.html#break). The array example works fine. The hash example breaks.\r\n{code:bash}\r\n# test4.pp\r\n\r\nclass test_class {\r\n  $data = [1,2,3]\r\n  notice $data.map |$x| {\r\n    if $x == 3 {\r\n      break()\r\n    }\r\n    $x*10\r\n  }\r\n\r\n  $data_hash = { ''a'' => 1, ''b'' => 2, ''c'' => 3 }\r\n  notice $data_hash.map |$key, $value| {\r\n    if $value == 3 {\r\n      break()\r\n    }\r\n    $value*10\r\n  }\r\n\r\n  notice("OUT OF THE LOOP")\r\n}\r\n\r\ninclude ::test_class\r\n{code}\r\n{code:bash}\r\n$ puppet apply test4.pp\r\nNotice: Scope(Class[Test_class]): [10, 20]\r\nError: break() from context where this is illegal at /tmp/test4.pp:15 on node <node>\r\n{code}\r\n\r\n\r\nExample of a workaround using a function and {{return()}}:\r\n{code:puppet}\r\n# test5.pp\r\nfunction has_two($data) {\r\n  $data.each |$key, $value| {\r\n    if $value == 2 {\r\n      return(true)\r\n    }\r\n  }\r\n\r\n  return(false)\r\n}\r\n\r\n$data = { ''a'' => 1, ''b'' => 2, ''c'' => 3 }\r\nif has_two($data) {\r\n  notice "YES"\r\n}\r\nelse {\r\n  notice "NO"\r\n}\r\n{code}\r\n\r\n{code:bash}\r\n$ puppet apply test5.pp\r\nNotice: Scope(Class[main]): YES\r\nNotice: Compiled catalog for <node> in environment production in 0.16 seconds\r\nNotice: Applied catalog in 0.49 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8181', 'https://github.com/puppetlabs/puppet/pull/6374', '2017-11-15T16:11:24.000-0800', '2018-07-23T15:28:01.000-0700', '2018-07-23T15:28:01.000-0700', 'Closed', '', 7, '0', 1, 57, 9, 3, '9043efdbb700a284e241fa47635ab3294378d57b'),
('puppet', 233021, 177866253, 6766, 'Puppet Resource Service fails on Debian/Ubuntu when non systemd service is called', '*Puppet Version:* 5.3.3\r\n*Puppet Server Version:* 5.3.3\r\n*OS Name/Version:* Ubuntu 16.04\r\n\r\nDescribe your issue in as much detail as possible…\r\n\r\nIn 16.04 when using puppet resource service, it bombs out if some of the services aren''t using systemd, and trying to contact upstart, we should be handling this error better \r\n\r\nDescribe steps to reproduce…\r\n\r\nIt seems that a vanilla install of Ubuntu 16.x is OK, however when intalling additional Ubuntu packages such as the GUI, we se this error\r\n\r\nTo reproduce\r\n\r\nInstall Ubuntu 16.04\r\n\r\nInstall the desktop packages\r\n\r\n\r\n{code:java}\r\nsudo apt-get update\r\nsudo apt-get install ubuntu-desktop\r\nreboot\r\n{code}\r\n\r\nLogin via the GUI and open up a terminal or  SSH into the server\r\n\r\nrun puppet resource service \r\n\r\nand you will get the error \r\n\r\n\r\n{code:java}\r\nDebug: Executing ''/sbin/initctl list''\r\nError: Could not run: #<IO:0x00000000017b6cf8>\r\n{code}\r\n\r\nDebug run attached\r\n\r\n\r\n*Desired Behavior:*\r\n\r\nWhen the service cannot connect to jumpstart/returns it shouldn''t break the command, the error should be handled and the services are returned \r\n\r\n*Actual Behavior:*\r\n\r\nThe command errors out \r\n\r\n\r\nPlease take a moment and attach any relevant log output and/or manifests. This will help us immensely when troubleshooting the issue.\r\n\r\nAttached \r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8396', 'https://github.com/puppetlabs/puppet/pull/6766', '2018-01-25T06:07:44.000-0800', '2018-07-24T09:27:00.000-0700', '2018-07-24T09:27:00.000-0700', 'Closed', 'cs_pr_review;cspapercuts;linux;sadness;service;type_and_provider;ubuntu', 6, '0', 1, 2, 0, 1, 'a8f42c5802357bd5125fea9dce6c36af1de8252f'),
('puppet', 212078, 157122014, 6433, 'group resource doesn''t default to ensure=>present', '{code:puppet}\r\ngroup { ''what'':\r\n#ensure => present,\r\n#gid => 1234,\r\n}\r\n{code}\r\nIf I do a "puppet apply --debug /tmp/x.pp" the group will not be created with the manifest as above. The relevant line in the debug output appears to be:\r\n{code}\r\nDebug: /Stage[main]/Main/Group[what]: Nothing to manage: no ensure and the resource doesn''t exist\r\n{code}\r\nIt will be created if I uncomment either of the ensure or gid parameters.\r\n\r\nWith only the gid uncommented the debug output includes:\r\n{code}\r\nDebug: Executing: ''/sbin/groupadd -g 1234 what''\r\nNotice: /Stage[main]/Main/Group[what]/ensure: created\r\n{code}\r\nWith only the ensure uncommented the debug output includes:\r\n{code}\r\nDebug: Executing: ''/sbin/groupadd what''\r\nNotice: /Stage[main]/Main/Group[what]/ensure: created\r\n{code}\r\nWith both uncommented the debug output includes:\r\n{code}\r\nDebug: Executing: ''/sbin/groupadd -g 1234 what''\r\nNotice: /Stage[main]/Main/Group[what]/ensure: created\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7968', 'https://github.com/puppetlabs/puppet/pull/6433', '2017-09-20T13:23:18.000-0700', '2018-08-01T08:00:44.000-0700', '2018-08-01T08:00:44.000-0700', 'Closed', 'beginner', 4, '0', 3, 11, 0, 2, '426de2c3dae42fe7f8b7061d94ad65d9a3f54256'),
('puppet', 267129, 204731668, 6953, 'tagged function should downcase arguments', '*Puppet Version: 5.5.3*\r\n *Puppet Server Version: 5.3.4*\r\n *OS Name/Version: Ubuntu 18.04.1 LTS (Bionic Beaver)*\r\n\r\nAs Puppet always makes resource tags downcased and the same thing is doing PuppetDB while querying ([https://github.com/puppetlabs/puppetdb/pull/260),] tagged function should probably do the same.\r\n\r\n*Desired Behavior:*\r\n\r\nFollowing code should notify ''true'':\r\n\r\n \r\n{code:java}# cat test.pp \r\nclass foo { }\r\ninclude foo\r\nif tagged("Class") {\r\n	notify { ''true'': }\r\n} else {\r\n	notify { ''false'': }\r\n}\r\n# puppet apply -t test.pp\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nNotice: Compiled catalog for local.local in environment production in 0.06 seconds\r\nInfo: Applying configuration version ''87c2c0fd052b62985e08e77716d9ee223c690c3d''\r\nNotice: false\r\nNotice: /Stage[main]/Main/Notify[false]/message: defined ''message'' as ''false''\r\nNotice: Applied catalog in 0.87 seconds\r\n{code}\r\n \r\n\r\n*Actual Behavior:*\r\n\r\nMentioned code returns Notify[false], which is incorrect.', 'https://tickets.puppetlabs.com/browse/PUP-9024', 'https://github.com/puppetlabs/puppet/pull/6953', '2018-07-30T01:27:17.000-0700', '2018-08-22T13:14:10.000-0700', '2018-08-22T13:14:10.000-0700', 'Closed', 'docs_reviewed', 2, '0', 1, 17, 4, 2, 'f8a21d6eb0b1bc0509e38b3b8cb09203df3b5265'),
('puppet', 263153, 198779888, 6903, 'augeas provider calls eval to convert stringified arrays into ruby arrays', 'The augeas provider calls ruby''s {{Kernel.eval}} to covert a stringified array, e.g. {{''["/etc/ssh/ssh_host_rsa_key"]''}} into a ruby array {{["/etc/ssh/ssh_host_rsa_key"]}}. The values always come from the manifest so are not typically arbitrary user-input.\r\n\r\nHowever, if a manifest were to rely on facts that an unprivileged user could write, then it would result in privilege escalation. I don''t think this is really exploitable, but it would be good to fix the provider to not use {{eval}}.\r\n{noformat}[root@h9smfls1mfp5thy ~]# cat manifest.pp\r\n# $keys =  ''["/etc/ssh/ssh_host_rsa_key"]''\r\n\r\naugeas {"sshd_config":\r\n   context => "/files/etc/ssh/sshd_config",\r\n   changes => [\r\n      "set PermitRootLogin yes",\r\n   ],\r\n  onlyif => "values HostKey == $keys"\r\n}\r\n[root@h9smfls1mfp5thy ~]# cat /etc/ssh/sshd_config\r\n# File is managed by Puppet\r\n\r\nAcceptEnv LANG LC_*\r\nChallengeResponseAuthentication no\r\nGSSAPIAuthentication no\r\nPermitRootLogin no\r\nPrintMotd no\r\nSubsystem sftp /usr/libexec/openssh/sftp-server\r\nUseDNS no\r\nUsePAM yes\r\nX11Forwarding yes\r\n# HostKeys for protocol version 2\r\nHostKey /etc/ssh/ssh_host_rsa_key\r\n[root@h9smfls1mfp5thy ~]# FACTER_keys=''puts "hi"'' puppet apply --noop manifest.pp\r\nNotice: Compiled catalog for h9smfls1mfp5thy.delivery.puppetlabs.net in environment production in 0.03 seconds\r\nhi\r\nNotice: Applied catalog in 0.37 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8974', 'https://github.com/puppetlabs/puppet/pull/6903', '2018-06-28T14:21:07.000-0700', '2018-08-22T13:15:08.000-0700', '2018-08-22T13:15:08.000-0700', 'Closed', 'docs_reviewed', 1, '0', 1, 33, 4, 2, '086f7851252112ab20c06ea5011f3d81455be3fc'),
('puppet', 265325, 210830486, 7018, 'The zypper and rpm providers have duplicate instance lists', '*Problem*\r\nPE package inventory shows duplicate packages for the {{rpm}} and {{zypper}} providers on SLES.\r\n\r\n*Expected behavior*\r\nPE package inventory shows one copy of the package. This behavior is seen on EL, but not SLES. \r\n\r\n*What we think is happening*\r\nThe {{zypper}} provider for the package resource inherits from the {{rpm}} provider, but does not specify it as the {{:source}}. This results in both {{zypper}} and {{rpm}} being returned by the [providers_by_source |https://www.rubydoc.info/gems/puppet/Puppet/Type#providers_by_source-class_method] method. The result is that PE package inventory shows duplicate packages for these two providers on SLES.\r\n\r\nThe zypper provider: \r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/zypper.rb#L1\r\n\r\nThis behavior is not seen on RHEL as the {{yum}} provider has {{rpm}} as a {{:source}}. https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/yum.rb#L1 \r\n\r\n*Questions*\r\nWhat are risks of setting {{:source => :rpm}} in the {{zypper}} provider?', 'https://tickets.puppetlabs.com/browse/PUP-9009', 'https://github.com/puppetlabs/puppet/pull/7018', '2018-07-18T11:55:11.000-0700', '2018-08-30T22:31:31.000-0700', '2018-08-30T22:31:31.000-0700', 'Resolved', 'cspapercuts;package;rpm;sles;type_and_provider;zypper', 1, '0', 1, 1, 1, 1, '73ba0d9000ee247684e198fef474557d550ebd90'),
('puppet', 175926, 0, 0, 'AIX - Errors when parsing lsuser output with special characters (#!)', '*Description*\r\nWhen attempting to manage a user on AIX, the puppet agent runs fail with the following error.\r\n\r\n{code}\r\nError: /User[username]: Could not evaluate: undefined method `to_sym'' for nil:NilClass\r\n{code}\r\n\r\nThe problem is occurring when the attributes have an odd number of colons in the output of {{lsuser -c}}. \r\n\r\n*Reproduction Steps*\r\n\r\nThis can be reproduced with following these steps: \r\n1. Login to the AIX node with an IPv6 address\r\n2. Run the puppet agent\r\n\r\n*Technical details*\r\n\r\nThe {{host_last_login}} from {{lsuser -c -R files username}} contains {{:}} characters, which are not parsed properly since it is a colon seperated list. This fails in <https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/aixobject.rb#L199>. A IPv6 address of the form {{2001:0db8:85a3:0000:0000:8a2e:0370:7334}} will need to have the {{:}} escaped to fit into a colon separated list. Since the regex does not account for these escaped characters, the property list has more values than keys (i.e 8a2e would be a value without a key). \r\n\r\n*Proposed fix*\r\nUse {{lsuser -f}} instead of {{lsuser -c}} to output a list of attribute pairs instead of a colon list, as it should automatically use {{parse_attr_list}} instead. Since {{lsuser -f}} will not have to escape the colons, this issue should no longer be seen. ', 'https://tickets.puppetlabs.com/browse/PUP-7241', 'https://github.com/puppetlabs/puppet/commit/f2886b889441ee5886e97c887fc1aaae0987cd75', '2017-02-21T15:04:50.000-0800', '2018-09-11T09:56:42.000-0700', '2018-09-11T09:56:42.000-0700', 'Resolved', 'aix;maintenance;type_and_provider;user', 3, '0', 0, 0, 0, 0, 'f2886b889441ee5886e97c887fc1aaae0987cd75'),
('puppet', 193326, 0, 0, 'The AIX ''group'' provider should not quote ''gid'' (it is supposed to be numeric)', 'The AIX provider for the {{group}} resource type produces a String instead of a Numeric value for the {{gid}} attribute. \r\n\r\nThis was found when working with PUP-7155.', 'https://tickets.puppetlabs.com/browse/PUP-7604', 'https://github.com/puppetlabs/puppet/commit/b02b1e1dee2ce7f4a2fd9d69efd896b181a7da69', '2017-05-29T10:10:05.000-0700', '2018-09-11T09:56:51.000-0700', '2018-09-11T09:56:51.000-0700', 'Resolved', 'aix;group;type_and_provider', 1, '0', 0, 0, 0, 0, 'b02b1e1dee2ce7f4a2fd9d69efd896b181a7da69'),
('puppet', 191018, 0, 0, 'User resource in AIX does not update attributes', 'This is a bug specific to AIX. Updating user attributes with the User resource does not actually update the resources when there is more than one attribute defined. \r\n\r\n*Example*\r\n\r\nNote that the lsuser output is truncated for readability. \r\n\r\n{code}\r\n# lsuser testuser\r\ntestuser ... minage=0 maxage=1 ...\r\n\r\n# cat testuser.pp\r\nuser { ''testuser'':\r\nensure => present,\r\nattributes => [ ''minage=0'', ''maxage=5'', ''SYSTEM=compat''],\r\n}\r\n\r\n# puppet apply testuser.pp\r\nNotice: Compiled catalog for pe-aix-71-support.delivery.puppetlabs.net in environment production in 0.11 seconds\r\nNotice: /Stage[main]/Main/User[testuser]/attributes: attributes changed ''SYSTEM=compat'' to ''SYSTEM=compat minage=0 maxage=5''\r\nNotice: Applied catalog in 0.32 seconds\r\n\r\n# lsuser testuser\r\ntestuser ... minage=0 maxage=1 ...\r\n{code}\r\n\r\nThe output of the puppet run indicates that the attributes have been updated despite not changing it on the system. Subsequent runs will show the same result as the attributes have not been updated.  The user resource does not detect these attributes. \r\n\r\n{code}\r\n# puppet resource user testuser\r\nuser { ''testuser'':\r\n  ensure           => ''present'',\r\n  attributes       => {''SYSTEM'' => ''compat'', ''account_locked'' => ''false'', ''admin'' => ''false'', ''auth1'' => ''SYSTEM'', ''auth2'' => ''NONE'', ''core'' => ''2097151'', ''cpu'' => ''-1'', ''daemon'' => ''true'', ''data'' => ''262144'', ''fsize'' => ''2097151'', ''histexpire'' => ''0'', ''histsize'' => ''0'', ''login'' => ''true'', ''loginretries'' => ''0'', ''maxexpired'' => ''-1'', ''maxrepeats'' => ''8'', ''minalpha'' => ''0'', ''mindiff'' => ''0'', ''mindigit'' => ''0'', ''minlen'' => ''0'', ''minloweralpha'' => ''0'', ''minother'' => ''0'', ''minspecialchar'' => ''0'', ''minupperalpha'' => ''0'', ''name'' => ''testuser'', ''nofiles'' => ''2000'', ''pwdwarntime'' => ''0'', ''registry'' => ''files'', ''rlogin'' => ''true'', ''rss'' => ''65536'', ''stack'' => ''65536'', ''su'' => ''true'', ''sugroups'' => ''ALL'', ''tpath'' => ''nosak'', ''ttys'' => ''ALL'', ''umask'' => ''22''},\r\n  gid              => ''1'',\r\n  groups           => [''staff''],\r\n  home             => ''/home/testuser'',\r\n  password_max_age => ''1'',\r\n  password_min_age => ''0'',\r\n  shell            => ''/usr/bin/ksh'',\r\n  uid              => ''207'',\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7533', 'https://github.com/puppetlabs/puppet/commit/f2886b889441ee5886e97c887fc1aaae0987cd75', '2017-05-15T10:27:53.000-0700', '2018-09-11T09:56:55.000-0700', '2018-09-11T09:56:55.000-0700', 'Resolved', 'aix;type_and_provider;user', 1, '0', 0, 0, 0, 0, 'f2886b889441ee5886e97c887fc1aaae0987cd75'),
('puppet', 225926, 168977049, 6636, 'Starting to get broken pipe (HTTP 500) on certain manifest - gone after restarting puppetserver', 'After a while a certain manifest started firing HTTP 500 on the puppetserver side, though nothing had changed.\r\n\r\nclients were aborting catalog compilation with:\r\n\r\n{code}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Method call, Broken pipe - <STDERR> at /srv/puppet/code/environments/production/modules/amodule/manifests/init.pp:16:35 on node node1.example.com\r\n{code}\r\n\r\nServer logs were showing the following:\r\n\r\n{code}\r\n2017-12-08 18:29:02,277 ERROR [qtp526724218-38738] [puppetserver] Puppet Evaluation Error: Error while evaluating a Method call, Broken pipe - <STDERR> at /srv/puppet/code/environments/production/modules/amodule/manifests/init.pp:16:35 on node node1.example.com\r\norg/jruby/RubyIO.java:1457:in `write''\r\norg/jruby/RubyIO.java:1428:in `write''\r\norg/jruby/RubyKernel.java:1000:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/ruby_function_instantiator.rb:22:in `create''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/module_loaders.rb:166:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:151:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:143:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:143:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:143:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:143:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/loader.rb:53:in `load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:304:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:951:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:944:in `eval_CallMethodExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:358:in `eval_AssignmentExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:646:in `block in eval_BlockExpression''\r\norg/jruby/RubyArray.java:1734:in `each''\r\norg/jruby/RubyEnumerable.java:936:in `inject''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:646:in `eval_BlockExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:32:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:72:in `block in evaluate''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:71:in `block in evaluate''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:70:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:136:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\norg/jruby/RubyArray.java:1734:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:384:in `evaluate_classes''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/include.rb:16:in `include''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n/srv/puppet/code/environments/production/modules/site/configsets/manifests/types/immerx_10.pp:6:in `<eval>''\r\norg/jruby/RubyKernel.java:1000:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:307:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:949:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:918:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:646:in `block in eval_BlockExpression''\r\norg/jruby/RubyArray.java:1734:in `each''\r\norg/jruby/RubyEnumerable.java:936:in `inject''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:646:in `eval_BlockExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:32:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:72:in `block in evaluate''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:71:in `block in evaluate''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:70:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:136:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\norg/jruby/RubyArray.java:1734:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:384:in `evaluate_classes''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/include.rb:16:in `include''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\norg/jruby/RubyKernel.java:1120:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n/srv/puppet/code/environments/production/manifests/site.pp:121:in `<eval>''\r\norg/jruby/RubyKernel.java:1000:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:307:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:949:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:918:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:646:in `block in eval_BlockExpression''\r\norg/jruby/RubyArray.java:1734:in `each''\r\norg/jruby/RubyEnumerable.java:936:in `inject''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:646:in `eval_BlockExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:32:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:133:in `block in evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:953:in `with_guarded_scope''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:131:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:505:in `evaluate_ast_node''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:168:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:168:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:263:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:153:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:297:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:295:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:224:in `block in benchmark''\r\nuri:classloader:/META-INF/jruby.home/lib/ruby/stdlib/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:293:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:52:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:195:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:121:in `do_find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:48:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:263:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:47:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:82:in `block in process''\r\n{code}\r\n\r\nRestarting the puppetserver made the problem go away.\r\n\r\nAll hosts using that module were affected.\r\n\r\nThe offending line in the manifest looks like:\r\n\r\n{code}\r\n   $dump_sources = $hosts.map |$h| { "https://${acustomfcuntion(''somevalue'',$h)}.example.com" }\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8467', 'https://github.com/puppetlabs/puppet/pull/6636', '2017-12-08T10:02:16.000-0800', '2018-09-12T01:36:38.000-0700', '2018-09-12T01:36:38.000-0700', 'Closed', '', 14, '0', 1, 1, 1, 1, '8bcff31759c4578116c5eb481f72599e8b8f96f5'),
('puppet', 260799, 194654390, 6882, 'Selmodule thinks foo exists if myfoo is loaded', 'The selmodule provider runs {{selmodule --list}} to check if a module is already loaded in the  exists? method.\r\n\r\nThe regex only checks {{modulename\b}} and does not anchor to the beginning of line.\r\n\r\nIf I want to manage {{foo}} and a module {{myfoo}} isl aready loaded the provider thinks {{foo} is loaded and whereas it actually isn''t.', 'https://tickets.puppetlabs.com/browse/PUP-8943', 'https://github.com/puppetlabs/puppet/pull/6882', '2018-06-13T10:00:33.000-0700', '2018-09-19T12:14:03.000-0700', '2018-09-19T12:14:03.000-0700', 'Closed', '', 4, '0', 55, 419, 230, 70, 'af4d1a281c00abd38347be42052699496f5bc33f'),
('puppet', 237925, 176030902, 6750, 'Require ruby 2.3 or greater', 'Update Gemfile, .gemspec, ext/project_data.yaml so that puppet requires ruby 2.3 or greater.\r\n\r\nAttempting to install puppet as a gem, running puppet via bundler, or running module tests using a local checkout of puppet should all fail when using ruby < 2.3.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8483', 'https://github.com/puppetlabs/puppet/pull/6750', '2018-02-22T15:50:49.000-0800', '2018-09-19T12:32:25.000-0700', '2018-09-19T12:32:25.000-0700', 'Closed', '', 3, '0', 1, 9, 43, 7, '4be4bc27011ad35201ad10ca71902a1ba2f77dba'),
('puppet', 54238, 188212789, 6836, 'File type redefined when required in code', '*NOTE*: If you have found your way to this issue based on troubleshooting an issue with the file_concat module, please see SERVER-40 for an easy workaround.\r\n\r\nThis issue was uncovered by SERVER-40.\r\n\r\nThere is a difference in how Kernel.load() and require interact when referencing the same Ruby file -- at least the file type -- under an MRI puppet master vs. Puppet Server, both running 3.7.1 core Ruby Puppet code and 1.9-based Ruby.\r\n\r\nDuring settings initialization, both masters will perform a:\r\n\r\n{code}\r\nKernel.load(".../lib/puppet/type/file.rb", nil)\r\n{code}\r\n\r\nThis causes the Puppet::Type::File type to be defined, as well as several related types, e.g., Puppet::Type::File::Owner, by virtue of "file.rb" doing _require ''puppet/type/file/*''_ calls.\r\n\r\nAssuming a custom module which includes a _require ''puppet/type/file''_ call in some Ruby code is in place, the behavior when that line is exercised under MRI Ruby Puppet vs. Puppet Server during a catalog request differs.\r\n\r\nUnder the MRI Ruby Puppet master, the file require call does not result in the "file.rb" file being re-executed.\r\n\r\nUnder Puppet Server, however, the file require call does result in the "file.rb" file being re-executed.  The Puppet::Type::File type is subsequently redefined, causing the subordinate types like Puppet::Type::File::Owner to no longer be defined.  The "file.rb" file executes the _require ''puppet/type/file/..._ calls again but because JRuby''s loader interprets the associated files as already having been executed, the files are not executed again and the Puppet::Type::File::* types are not redefined.  Any subsequent attempts to reference these subordinate types in code would, therefore, result in an error.\r\n\r\nI suspect this may be showing a difference between how the caching behind Kernel.load() and Kernel.require() is linked under MRI Ruby vs. JRuby 1.9.  This will probably involve further research into the loaders for those respective runtimes.\r\n\r\nTo demonstrate this problem, I created the following custom function and placed it under "<confdir>/<modules>/<modname>/lib/puppet/parser/functions/owner_defed_after_require.rb" on the server:\r\n\r\n{code}\r\nrequire ''puppet/type/file''\r\n\r\nmodule Puppet::Parser::Functions\r\n  newfunction(:owner_defed_after_require, :type => :rvalue) do |args|\r\n    Puppet.info "owner_defed_after_require: enter"\r\n\r\n    klass_defined = false\r\n    if Object.const_defined?("Puppet")\r\n      klass = Object.const_get("Puppet")\r\n      if (klass.const_defined?("Type"))\r\n        klass = klass.const_get("Type")\r\n        if (klass.const_defined?("File"))\r\n          klass_defined = klass.const_get("File").const_defined?("Owner")\r\n        end\r\n      end\r\n    end\r\n\r\n    Puppet.info "owner_defed_after_require: exit (#{klass_defined})"\r\n    klass_defined\r\n  end\r\nend\r\n{code}\r\n\r\nOn the same server, I stored the following at "<confdir>/manifests/site.pp":\r\n\r\n{code}\r\nnotify { ''owner_defed_after_require'':\r\n  message  => owner_defed_after_require()\r\n}\r\n{code}\r\n\r\nWhen I performed a catalog request to the master, I saw "true" for the owner_defed_after_require message in the response for the MRI Ruby master vs. "false" for the same message in the response for the Puppet Server master.\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8733', 'https://github.com/puppetlabs/puppet/pull/6836', '2014-10-10T12:12:36.000-0700', '2018-09-19T12:32:28.000-0700', '2018-09-19T12:32:28.000-0700', 'Closed', '', 9, '0', 2, 8, 13, 3, '6618b209c95f049e2ba86b02ff9dc6ab7fcc4897'),
('puppet', 40322, 189177182, 6848, 'Puppet generates invalid .dot files due to missing escapes of quoted strings in resource names', 'Puppet generates invalid .dot files.\r\nIf a resource name contains a quoted string the name is not escaped in the .dot file.\r\n\r\nExample content generated by puppet:\r\n{code}\r\n    "Postgresql_psql[GRANT ALL ON DATABASE "puppetdb" TO "puppetdb"]" [\r\n        fontsize = 8,\r\n        label = "Postgresql_psql[GRANT ALL ON DATABASE "puppetdb" TO "puppetdb"]"\r\n    ]\r\n{code}\r\n\r\nresulting in something like this:\r\n!graph_fail.png|thumbnail!\r\n\r\n\r\nCorrectly escaped it would look like this:\r\n{code}\r\n    "Postgresql_psql[GRANT ALL ON DATABASE \"puppetdb\" TO \"puppetdb\"]" [\r\n        fontsize = 8,\r\n        label = "Postgresql_psql[GRANT ALL ON DATABASE \"puppetdb\" TO \"puppetdb\"]"\r\n    ]\r\n{code}\r\n\r\n\r\nThe behavior has been reproduced with Puppet 3.6.1 and 3.6.2', 'https://tickets.puppetlabs.com/browse/PUP-2838', 'https://github.com/puppetlabs/puppet/pull/6848', '2014-06-25T05:30:49.000-0700', '2018-09-19T12:32:30.000-0700', '2018-09-19T12:32:30.000-0700', 'Closed', 'community;puppethack;the-goods', 9, '0', 3, 65, 22, 3, '6667735769d7df03bca0d9eb7789759e53a93cfb'),
('puppet', 237926, 192780608, 6868, 'Update ruby 1.9.3 code paths', 'Search puppet''s code base for all of the places where we branch based on {{RUBY_VERSION}}.\r\n\r\n1. Remove code paths for < 2.\r\n2. Trying to {{require ''puppet''}} should generate a {{LoadError}} if ruby < 2\r\n3. Update {{Puppet::OLDEST_RECOMMENDED_RUBY_VERSION}} to whatever minimum makes sense.\r\n4. Remove conditional logic for Puppet[:sourceaddress]', 'https://tickets.puppetlabs.com/browse/PUP-8484', 'https://github.com/puppetlabs/puppet/pull/6868', '2018-02-22T15:51:52.000-0800', '2018-09-19T12:32:31.000-0700', '2018-09-19T12:32:31.000-0700', 'Closed', '', 2, '0', 1, 46, 269, 29, 'b59a58d3f3b189809335e322df1b2b0dbb628fcf'),
('puppet', 261846, 196297383, 6891, 'The new Rest::Client does not respect the server_list setting', 'The way the new rest client is currently being used (see https://github.com/puppetlabs/puppet/blob/master/lib/puppet/rest/routes.rb) does not respect the server list setting, because we are always setting a default server, which skips server resolution (see https://github.com/puppetlabs/puppet/blob/master/lib/puppet/rest/route.rb#L66-L90). Assuming that HA expects the CA to fail over along with the rest of the master functions, we need to update this logic so that if {{server_list}} is specified, the values there are preferred over the {{ca_server}} setting that we would normally check (which itself defaults to the {{server}} setting).', 'https://tickets.puppetlabs.com/browse/PUP-8952', 'https://github.com/puppetlabs/puppet/pull/6891', '2018-06-20T12:03:08.000-0700', '2018-09-19T12:32:32.000-0700', '2018-09-19T12:32:32.000-0700', 'Closed', '', 1, '0', 2, 168, 144, 8, '6596208461597ffceb4f1b48b9822a701ed96bfc'),
('puppet', 264444, 0, 0, 'Puppet failover breaks when additional requests are made during server list resolution', 'Implementing CRL re-downloading uncovered an existing bug in HA failover where Puppet will crash if additional requests are made as a by-product of attempting to make the {{node}} request that is used to find a functional server, and the first server in {{server_list}} is unavailable. Rather than continuing to check later servers in the list, it will simply exit with an "unable to connect" error.\r\n\r\nThis was probably unlikely to surface in the past, because such additional requests were only made on initial agent runs, during SSL bootstrapping. However, we are now attempting to redownload the CRL on every request (which causes an additional request to be made to the server being tested), so failover now doesn''t work at all.\r\n\r\nThe easiest solution to this is probably to restrict when the CRL re-download happens, possibly so that it happens explictly after failover has been resolved. However, this does not fix the underlying issue, where failover still breaks on initial agent runs.', 'https://tickets.puppetlabs.com/browse/PUP-8999', 'https://github.com/puppetlabs/puppet/commit/35b23fe5ead507d47bba6265f7575cba08028052', '2018-07-11T10:38:35.000-0700', '2018-09-19T12:33:56.000-0700', '2018-09-19T12:33:56.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, '35b23fe5ead507d47bba6265f7575cba08028052'),
('puppet', 264049, 203369416, 6939, 'Don''t pluginsync vendored modules', 'Currently in puppet#master, we treat vendored modules just like any another module in the environment-specific modulepath, just that they have the least preference.\r\n\r\nThis is desirable to ensure that the version of the type we''re compiling for, is the same version that the agent uses during catalog application. This is important to ensure the code in the type (title patterns, munge, validate, auto relations) is consistent to prevent subtle and difficult to reproduce bugs. It would also prevent problems like PUP-2746.\r\n\r\nHowever, it causes a few problems:\r\n * it will cause additional pluginsync''ing of types and providers\r\n * we have to be careful about introducing changes to types that are not compatible with older agents. For example, the yumrepo type now marks the {{password}} and {{proxy_password}} properties as sensitive, but the {{Puppet::Parameter#sensitive}} method is not available in older puppet versions.\r\n * it is a departure from how puppet currently works\r\n\r\nThis ticket proposes we:\r\n * remove the vendored modules from the module path so that they are not pluginsync''ed automatically\r\n * add a puppet setting for vendored modulepath\r\n * add the path to the autoloader search path with least precedence\r\n\r\nThis way vendored types can be autoloaded locally, but we never pluginsync (types/providers/facts/files/etc) them.\r\n\r\n/cc [~ericsorenson], [~jacob.helwig], [~melissa], [~branan]', 'https://tickets.puppetlabs.com/browse/PUP-8988', 'https://github.com/puppetlabs/puppet/pull/6939', '2018-07-06T16:31:03.000-0700', '2018-09-19T12:33:58.000-0700', '2018-09-19T12:33:58.000-0700', 'Closed', '', 5, '0', 1, 1, 1, 1, '6a96dc22839b363cf9d3d2125896ac71cb68b5f5'),
('puppet', 249125, 192776089, 6867, 'Puppet loses track of the current environment', 'Puppet loses track of the current environment when calling the autoloader to load/find:\r\n\r\n* applications\r\n* features\r\n* parent providers that haven''t been loaded yet, e.g. {{openbsd}} which is a parent of {{freebsd}}, where {{freebsd}} is loaded first because of its name.\r\n* termini\r\n\r\nPuppet then falls back to the configured environment ({{Puppet[:environment]}}), which may not match the current environment ({{Puppet.lookup(:current_environment)}}). For the agent specifically, it means we sometimes use the configured environment''s modulepath which has a higher precedence than our {{libdir}} containing pluginsync''ed files. This is a problem, because when we include {{vendor_modules}} in the {{basemodulepath}} (see PUP-8582), we don''t want that to have higher precedence that the {{libdir}} as the agent might load a type/provider that is incompatible with the type that the master used during compilation.\r\n\r\nTo reproduce, create the following files on the master:\r\n\r\n{noformat}\r\n[root@yhw77y0zn0j776u ~]# tree /etc/puppetlabs/code/environments/production/\r\n/etc/puppetlabs/code/environments/production/\r\n├── data\r\n├── environment.conf\r\n├── hiera.yaml\r\n├── manifests\r\n│   └── site.pp\r\n└── modules\r\n    └── foo\r\n        └── lib\r\n            └── puppet\r\n                ├── feature\r\n                │   └── foo.rb\r\n                ├── provider\r\n                │   └── foo\r\n                │       └── foo.rb\r\n                └── type\r\n                    └── foo.rb\r\n\r\n10 directories, 6 files\r\n[root@yhw77y0zn0j776u ~]# find /etc/puppetlabs/code/environments/production/{manifests,modules} -type f -print -exec cat {} \;\r\n/etc/puppetlabs/code/environments/production/manifests/site.pp\r\nfoo { ''hi'': }\r\n/etc/puppetlabs/code/environments/production/modules/foo/lib/puppet/type/foo.rb\r\nPuppet::Type.newtype(:foo) do\r\n  newparam(:name, namevar: true)\r\n  newproperty(:message)\r\nend\r\n/etc/puppetlabs/code/environments/production/modules/foo/lib/puppet/feature/foo.rb\r\nPuppet.features.add(:foo, libs: [''pp''])\r\n/etc/puppetlabs/code/environments/production/modules/foo/lib/puppet/provider/foo/foo.rb\r\nPuppet::Type.type(:foo).provide(:foo) do\r\n  confine :feature => :foo\r\n\r\n  def message=(value)\r\n    puts value\r\n  end\r\n\r\n  def message\r\n    :absent\r\n  end\r\nend\r\n{noformat}\r\n\r\nOn the agent which must be one a different host, create a bogus feature:\r\n\r\n{noformat}\r\n$ tree ~/.puppetlabs/etc/code/environments/production/modules\r\n/Users/josh/.puppetlabs/etc/code/environments/production/modules\r\n└── foo\r\n    └── lib\r\n        └── puppet\r\n            └── feature\r\n                └── foo.rb\r\n\r\n4 directories, 1 file\r\n$ cat ~/.puppetlabs/etc/code/environments/production/modules/foo/lib/puppet/feature/foo.rb\r\nBOOM!!\r\n{noformat}\r\n\r\nThe agent run will fail, with the path to the bogus feature:\r\n\r\n{noformat}\r\n$ bx puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for localhost\r\nError: Could not autoload puppet/feature/foo: /Users/josh/.puppetlabs/etc/code/environments/production/modules/foo/lib/puppet/feature/foo.rb:1: syntax error, unexpected end-of-input\r\nError: Failed to apply catalog: Could not autoload puppet/feature/foo: /Users/josh/.puppetlabs/etc/code/environments/production/modules/foo/lib/puppet/feature/foo.rb:1: syntax error, unexpected end-of-input\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8696', 'https://github.com/puppetlabs/puppet/pull/6867', '2018-05-03T14:11:16.000-0700', '2018-09-19T12:34:01.000-0700', '2018-09-19T12:34:01.000-0700', 'Closed', '', 3, '0', 7, 195, 158, 34, '770201f11e5f63a201c7b395c06fc1390b762873'),
('puppet', 263245, 198337296, 6901, 'A hash containing the key __ptype cannot be serialized using the human readable JSON format', 'Using a Hash with the key {{__ptype}} will not serialize correctly as that is a reserved tag.\r\nThere is already a mechanism in place to use an alternative representation when a Hash contains non JSON string compliant keys so the fix is simply to treat a hash with the key in question as one that has non-string keys as that will use the alternative encoding.', 'https://tickets.puppetlabs.com/browse/PUP-8976', 'https://github.com/puppetlabs/puppet/pull/6901', '2018-06-29T07:34:29.000-0700', '2018-09-19T12:34:06.000-0700', '2018-09-19T12:34:06.000-0700', 'Closed', '', 3, '0', 1, 12, 1, 2, '3bf4caad5e928cb653f04e965f01694e185898fc'),
('puppet', 266122, 205638745, 6965, 'Can''t puppet describe vendored modules if provider requires helper code', 'If a vendored modules'' provider includes helper code within the same module, then running {{puppet describe}} will fail, because the module''s lib directory is not on the ruby $LOAD_PATH. For example, the [{{mount}} provider calls|https://github.com/puppetlabs/puppetlabs-mount_core/blob/master/lib/puppet/provider/mount/parsed.rb#L2]\r\n\r\n{code:ruby}\r\nrequire ''puppet/provider/mount''\r\n{code}\r\n\r\nwhich is helper code in the same module, and results in:\r\n\r\n{noformat}\r\n# puppet describe -l\r\nError: Could not autoload puppet/provider/mount/parsed: cannot load such file -- puppet/provider/mount\r\nError: Could not autoload puppet/type/mount: Could not autoload puppet/provider/mount/parsed: cannot load such file -- puppet/provider/mount\r\nError: Could not run: Could not autoload puppet/type/mount: Could not autoload puppet/provider/mount/parsed: cannot load such file -- puppet/provider/mount\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9015', 'https://github.com/puppetlabs/puppet/pull/6965', '2018-07-23T14:55:43.000-0700', '2018-09-19T12:34:55.000-0700', '2018-09-19T12:34:55.000-0700', 'Closed', '', 2, '0', 4, 67, 72, 4, 'bc9e8318ae0fe504abe00799746a7b6cd10fe94c'),
('puppet', 271041, 208744138, 7003, 'Puppet assumes all SSL certs it verifies have client purpose set', '[This PR|https://github.com/puppetlabs/puppet/pull/6973] is open to update Travis & Appveyor to test puppet''s master branch using ruby 2.5; The Appveyor tests have uncovered a legitimate puppet failure ([link to the full log here|https://ci.appveyor.com/project/puppetlabs/puppet/build/4.1.0.8733/job/bmcje50w2tvej3pw]):\r\n{code}Failures:\r\n  1) Puppet::Indirector::CertificateStatus::File when searching should return a list of all hosts with certificate requests, signed certs, or revoked certs\r\n     Failure/Error: expect(results).to eq([["ca","signed"],["requested_host","requested"],["revoked_host","revoked"],["signed_host","signed"]])\r\n       expected: [["ca", "signed"], ["requested_host", "requested"], ["revoked_host", "revoked"], ["signed_host", "signed"]]\r\n            got: [["ca", "revoked"], ["requested_host", "requested"], ["revoked_host", "revoked"], ["signed_host", "signed"]]\r\n       (compared using ==)\r\n     # ./spec/unit/indirector/certificate_status/file_spec.rb:188:in `block (3 levels) in <top (required)>''\r\n     # util/rspec_runner:44:in `run''\r\n     # util/rspec_runner:59:in `<main>''\r\nFinished in 49.26 seconds (files took 7.23 seconds to load)\r\n{code}\r\nA summary of some discussion we''ve had around this in PRs and chat so far:\r\n * This happens with Ruby 2.5.x and and OpenSSL 1.1.0. We suspect we''re seeing this failure in Appveyor and not Travis because Travis may build their Ruby 2.5.x against an earlier version of OpenSSL\r\n * We set purpose to SSL_CLIENT, and OpenSSL 1.1.0, unlike earlier versions, will check the purpose of each certificate and fail verification if purpose does not match.\r\n * This failure only manifests when verifying the CA using itself:\r\n ** This normally works because the CA is a self-signed cert\r\n ** But the CA does not have the SSL_CLIENT purpose (and it should never set that), so it fails verification now\r\n * To fix this, we need to find some way not to set the purpose when verifying the CA cert using itself:\r\n ** We may add an optional purpose parameter to the [verify method|https://github.com/puppetlabs/puppet/blob/8ee569d00a3dd8664998ff89db75c7c16703e99e/lib/puppet/ssl/certificate_authority.rb#L495], and have it default to {{OpenSSL::X509::PURPOSE_SSL_CLIENT}}. Then, Host''s state method could pass {{OpenSSL::PURPOSE_ANY}} [here|https://github.com/puppetlabs/puppet/blob/8ee569d00a3dd8664998ff89db75c7c16703e99e/lib/puppet/ssl/host.rb#L405].\r\n\r\n[~sean.mcdonald] provided [this script|https://gist.githubusercontent.com/McdonaldSeanp/3d92c654ee16acc37b590b3d5dac3fc2/raw/7c42eeffaebf391a38485a0b54911d7a021c1c5a/certificate_check.rb] to perform a test that creates a CA and attempts to verify it with and without the purpose set (requires system openssl installed).\r\n\r\nThis issue blocks PUP-8614 (adding ruby 2.5 to puppet''s Travis/Appveyor config), which blocks the upgrade to ruby 2.5.1 in puppet-agent.', 'https://tickets.puppetlabs.com/browse/PUP-9064', 'https://github.com/puppetlabs/puppet/pull/7003', '2018-08-14T09:30:16.000-0700', '2018-09-19T12:34:56.000-0700', '2018-09-19T12:34:56.000-0700', 'Closed', '', 2, '0', 3, 7, 133, 2, '46b923fefce3514b4dee173b536b6015de6a3014'),
('puppet', 275331, 214867968, 7075, 'Namespaced pluginsync functions should be found by Loaders', '*Puppet Version:*\r\n*Puppet Server Version:*\r\n*OS Name/Version:*\r\n\r\nDescribe your issue in as much detail as possible…\r\nDescribe steps to reproduce…\r\n\r\n*Desired Behavior:*\r\n\r\n\r\n*Actual Behavior:*\r\n\r\n\r\nPlease take a moment and attach any relevant log output and/or manifests. This will help us immensely when troubleshooting the issue.\r\n\r\nExamples:\r\nRun puppet agent with --test --trace --debug\r\n\r\nRelevant sections of {{/var/log/puppetlabs/puppetserver/puppetserver.log}} or any applicable logs from the same directory.\r\n\r\nFor more detailed information turn up the server logs by upping the log level in the server''s logback.xml\r\n\r\nRelevant sections of configurations files (puppet.conf, hiera.conf, Server''s conf.d, defaults/sysconfig)\r\n\r\nFor memory issues with server heap dumps are also helpful.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9133', 'https://github.com/puppetlabs/puppet/pull/7075', '2018-09-12T00:52:28.000-0700', '2018-09-19T12:34:58.000-0700', '2018-09-19T12:34:58.000-0700', 'Closed', '', 1, '0', 2, 33, 4, 2, 'b886fd075dfce53be6f4ba207436c75b76af1190'),
('puppet', 272667, 214150414, 7062, 'Rich data tags __ptype and __pvalue must not be allowed as attribute names', 'An attempt to use the rich data tag ''\_\_ptype'' as the name of an attribute in an {{Object}} will cause a failure to serialize that object using the human readable Data format. An {{Object}} is represented as a {{Hash}} where ''\_\_ptype'' is supposed to be a {{String}} representation of the type and an attribute using the same name causes the type to be overwritten. Use of ''\_\_pvalue'' will cause a similar confusion when reading the `Object`.\r\n\r\nThe special rich data tags''\_\_ptype'' and ''\_\_pvalue'' should not be permitted as names of attributes in an {{Object}}.', 'https://tickets.puppetlabs.com/browse/PUP-9079', 'https://github.com/puppetlabs/puppet/pull/7062', '2018-08-24T00:08:45.000-0700', '2018-09-19T12:37:12.000-0700', '2018-09-19T12:37:12.000-0700', 'Closed', '', 5, '0', 1, 23, 0, 2, 'ad2105408b60a315f48faad7c4120a5a1619b48c'),
('puppet', 275883, 216104612, 7097, 'Puppet device raises `undefined method` error', '*Puppet Version: 6.0.0*\r\n *Puppet Server Version:*\r\n *OS Name/Version:* \r\n\r\nThe following behaviour was found in `master` and `6.0.x` branches\r\n\r\n*Desired Behavior:*\r\n\r\nRunning *`*puppet device --verbose --trace --strict=error --modulepath spec/fixtures --target the_node*`* should raise an error similar to:\r\n\r\n`Error: Target device / certificate ''the_node'' not found in /Users/david.armstrong/.puppetlabs/etc/puppet/device.conf`\r\n\r\n*Actual Behavior:*\r\n\r\nInstead, the error received is:\r\n\r\n"undefined method `ca_location='' for Puppet::SSL::Host:Class`"\r\n\r\nThis can be observed in the Travis job: [https://travis-ci.org/puppetlabs/puppet-resource_api/builds/429478193?utm_source=github_status&utm_medium=notification]\r\n{code:java}\r\nError: Could not prepare for execution: undefined method `ca_location='' for Puppet::SSL::Host:Class\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/lib/puppet/application/device.rb:382:in `setup''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/lib/puppet/application.rb:374:in `block in run''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/lib/puppet/util.rb:667:in `exit_on_fail''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/lib/puppet/application.rb:374:in `run''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/lib/puppet/util/command_line.rb:136:in `run''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/lib/puppet/util/command_line.rb:73:in `execute''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bundler/gems/puppet-7a952fe11207/bin/puppet:5:in `<top (required)>''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bin/puppet:23:in `load''\r\n/home/travis/build/puppetlabs/puppet-resource_api/vendor/bundle/ruby/2.5.0/bin/puppet:23:in `<main>''\r\n{code}\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9143', 'https://github.com/puppetlabs/puppet/pull/7097', '2018-09-17T02:56:57.000-0700', '2018-09-19T12:37:14.000-0700', '2018-09-19T12:37:14.000-0700', 'Closed', '', 6, '0', 1, 0, 12, 2, 'c4125200bd76158fb6c153caf31babe1b2add610'),
('puppet', 275210, 214678829, 7070, 'tagging with undef should not add a tag', 'In PUP-9112 we stopped translating puppet''s {{undef}} to Ruby symbol {{:undef}} in the resource API. As a consequence, if trying to tag with an {{undef}} value this ended up as an empty string (nil.to_s is an empty string). This was then correctly flagged as an error.\r\n\r\nThe change in PUP-9112 thus revealed a long standing bug, where tagging with {{undef}} actually tagged the resource with the string {{"undef"}}, which is completely useless since it cannot be used or queried using {{undef}}.\r\n\r\nAny undef/nil values should simply be dropped in the tagging process.', 'https://tickets.puppetlabs.com/browse/PUP-9130', 'https://github.com/puppetlabs/puppet/pull/7070', '2018-09-11T08:25:26.000-0700', '2018-09-19T12:37:15.000-0700', '2018-09-19T12:37:15.000-0700', 'Closed', '', 1, '0', 1, 12, 1, 2, '02951a3d059a98f1d02ba6b11e834639549bb397'),
('puppet', 275447, 215073572, 7080, 'FromDataHash should not crash if hash with __ptype key is not a type', 'In case FromDataHash is given a hash where a key is {{"__ptype"}}, and its value is not a type, it should then assume that what it is looking at is just a hash instead of crashing.\r\n\r\nThis is caused by the ToStringifiedConverter not converting to a safe form when seeing such a hash. The ToStringifyConverter should simply generate {{"reserved-key: __ptype"}} for such hashes since the result is for human consumption.', 'https://tickets.puppetlabs.com/browse/PUP-9134', 'https://github.com/puppetlabs/puppet/pull/7080', '2018-09-12T11:58:56.000-0700', '2018-09-19T12:37:16.000-0700', '2018-09-19T12:37:16.000-0700', 'Closed', '', 1, '0', 2, 26, 4, 4, 'fa96d3cbf6eeeea40e70636c94e9fc0fd85900de'),
('puppet', 275642, 215389644, 7085, 'Puppet should save cached catalogs with rich_data when rich_data is enabled', '', 'https://tickets.puppetlabs.com/browse/PUP-9138', 'https://github.com/puppetlabs/puppet/pull/7085', '2018-09-13T12:18:15.000-0700', '2018-09-19T12:37:18.000-0700', '2018-09-19T12:37:18.000-0700', 'Closed', '', 1, '0', 1, 12, 2, 1, '77a60ab0e590d6ec08b2d83f758ab63e56703e9d'),
('puppet', 274774, 213884498, 7055, 'Puppet PAL for catalog compilation cannot use resources in subsequent evaluations.', 'When using Puppet PAL to compile a catalog (new in Puppet 6.0.0) it is not possible to use any catalog related definitions in code evaluated after the initial evaluation. This is because the evaluate method is inherited from basic script compiler and it can only define non catalog related definitions.\r\n\r\nThis is a major issue with using the new API.', 'https://tickets.puppetlabs.com/browse/PUP-9114', 'https://github.com/puppetlabs/puppet/pull/7055', '2018-09-07T03:17:32.000-0700', '2018-09-19T12:37:19.000-0700', '2018-09-19T12:37:19.000-0700', 'Closed', '', 1, '0', 1, 35, 1, 2, 'f389743b4b730aede26591bde35d7d1398587b3d'),
('puppet', 119006, 209229461, 7008, 'Features are not being re-evaluated when a block is used', 'When a block is passed to the add method of Puppet::Util::Feature, it will only get evaluated once. This makes the "feature" feature practically unusable for anything except ruby libraries.\r\n\r\n*Updated*:\r\n\r\nFeatures should behave consistently when passed a block or an explicit list of ruby libraries. By default, they should not cache misses. If {{always_retry_plugins}} is false, then both block and non-block forms should cache misses, so that puppetserver doesn''t try to reevaluate features.', 'https://tickets.puppetlabs.com/browse/PUP-5985', 'https://github.com/puppetlabs/puppet/pull/7008', '2016-02-28T07:17:26.000-0800', '2018-09-19T12:37:25.000-0700', '2018-09-19T12:37:25.000-0700', 'Closed', '', 12, '0', 5, 458, 447, 142, 'c22ea8ec3241dcea30b7369134a10d0e84f68905'),
('puppet', 274286, 213522650, 7048, 'YAML safe_load prevents aliases', '*Puppet Version:* current master, e.g. ddd5610aa9ffb5eb9da13521f1fc68e562a2e0b3\r\n*Puppet Server Version:* n/a\r\n*OS Name/Version:* n/a\r\n\r\n*Actual Behavior:*\r\n\r\nIn some cases puppet creates a {{transactionstore.yaml}} that are not able to be read back, causing \r\n\r\n{code}\r\nError: Transaction store file /home/david/.puppetlabs/opt/puppet/cache/devices/pavm/state/transactionstore.yaml is corrupt (Unknown alias: 1); replacing\r\n{code}\r\n\r\n*Desired Behavior:*\r\n\r\nNo errors or stacktraces on regular puppet use.\r\n\r\n*Reproduction:*\r\n\r\n[~thomas.franklin] has put together a detailed description and a potential fix in https://github.com/Thomas-Franklin/puppet/commit/49b8e023c6c9bb551bd0ce21648a604042c490ff\r\n\r\nThe issue is also visible in the panos acceptance pipelines: https://jenkins-master-prod-1.delivery.puppetlabs.net/view/modules/view/networking/view/panos/view/master/job/forge-module_puppetlabs-panos_intn-sys_full-pe-future-master/8/\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9104', 'https://github.com/puppetlabs/puppet/pull/7048', '2018-09-05T05:35:27.000-0700', '2018-09-19T22:46:17.000-0700', '2018-09-19T22:46:17.000-0700', 'Closed', '', 8, '0', 1, 9, 1, 2, '9827c70e5e7faf50e644708b515071c56dfdaef3'),
('puppet', 277595, 218272694, 7122, 'nested :undef symbol transformed to empty string in 3x function calls', 'Nested :undef symbol is transformed to empty string in 3x function calls. This is a side effect of PUP-9112 as the language no longer uses :undef, and the return values of 3x functions are transformed to not contain :undef. There is however a problem in that there are many tests that test against :undef inside structures in the belief that this is how the language would present the value to the function (it once was).\r\n\r\nThus, it would be beneficial to allow these tests to continue working.', 'https://tickets.puppetlabs.com/browse/PUP-9180', 'https://github.com/puppetlabs/puppet/pull/7122', '2018-09-26T03:29:07.000-0700', '2018-10-02T12:45:10.000-0700', '2018-10-02T12:45:10.000-0700', 'Closed', '', 3, '0', 2, 24, 6, 2, '5a69a0bf17193e5f4fd06785ea51e8ed3dc6afb0'),
('puppet', 182318, 215721700, 7090, 'AIX Provider acts strange with user resource', 'When a user is in a group on a Linux server and a user resource is created for that user, if new groups are specified in the resource, the user is moved out of his previous groups into the groups specified. \r\n\r\nIn AIX the user stays in his old groups and gets added to his new groups. The AIX functionality should mimic the Linux functionality.', 'https://tickets.puppetlabs.com/browse/PUP-7393', 'https://github.com/puppetlabs/puppet/pull/7090', '2017-03-23T12:44:08.000-0700', '2018-10-02T12:45:11.000-0700', '2018-10-02T12:45:11.000-0700', 'Closed', 'aix;aix-parity;type_and_provider;user', 3, '0', 4, 304, 29, 8, 'f349cbdc7508980149a55d302121ecacb32644c3'),
('puppet', 275893, 216736911, 7102, 'PAL for Catalog Compilation does not evaluate defines and classes', 'The PAL support for catalog compilation does not evaluate defines and classes if they are defined inside of the body of the PAL. Thus a catalog will only instances of classes and resources that were evaluated during the main part of the compilation (i.e. if given a manifest or initial code to evaluate). Three new methods were added to the API to control lazy evaluation and validation of the result.', 'https://tickets.puppetlabs.com/browse/PUP-9144', 'https://github.com/puppetlabs/puppet/pull/7102', '2018-09-17T05:12:11.000-0700', '2018-10-02T12:45:11.000-0700', '2018-10-02T12:45:11.000-0700', 'Closed', '', 3, '0', 2, 120, 1, 4, '41fa45862e6ea7c635a171e71f0d490be40fe0b4'),
('puppet', 269911, 216713885, 7101, 'Update puppet portage package provider for new output generated by qatom', '*Puppet Version: puppet-agent-5.5.4*\r\n *Puppet Server Version: 5.3.4*\r\n *OS Name/Version: Gentoo*\r\n\r\nqatom output used to look like:\r\n\r\n# qatom app-admin/puppet\r\napp-admin puppet (null)\r\n\r\n...but now looks like...\r\n\r\n# qatom app-admin/puppet\r\napp-admin puppet <unset>\r\n\r\nin app-portage/portage-utils-0.72 and above.\r\n\r\n*Desired Behavior:* the qatom output to be parsed correctly\r\n\r\n*Actual Behavior:*\r\n\r\nError: Could not update: Execution of ''/usr/bin/emerge --update app-admin/puppet-<unset>'' returned 1: !!! ''app-admin/puppet-<unset>'' is not a valid package atom.', 'https://tickets.puppetlabs.com/browse/PUP-9044', 'https://github.com/puppetlabs/puppet/pull/7101', '2018-08-06T22:58:21.000-0700', '2018-10-02T12:45:12.000-0700', '2018-10-02T12:45:12.000-0700', 'Closed', 'gentoo;package;portage;type_and_provider', 8, '0', 1, 2, 2, 1, '6853132d8b85e844390749c7e906d90be45ee8dd'),
('puppet', 276783, 217131653, 7108, 'Request "master" server status ', 'When using {{server_list}} the agent will request server status from {{status/v1/services}}. It is possible for the compiler to be ready, but other trapperkeeper services unrelated to compilation to be unavailable such as the {{broker-service}}. For example:\r\n\r\n{noformat}\r\n<- "GET /status/v1/simple HTTP/1.1\r\nAccept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\r\nAccept: */*\r\nUser-Agent: Puppet/6.0.0 Ruby/2.5.1-p57 (x86_64-linux)\r\nHost: puppet:8140\r\n\r\n"\r\n-> "HTTP/1.1 503 Service Unavailable\r\n"\r\n-> "Date: Wed, 19 Sep 2018 22:50:52 GMT\r\n"\r\n-> "Content-Type: text/plain;charset=utf-8\r\n"\r\n-> "Content-Length: 5\r\n"\r\n-> "Server: Jetty(9.4.z-SNAPSHOT)\r\n"\r\n-> "\r\n"\r\nreading 5 bytes...\r\n-> "error"\r\n{noformat}\r\n\r\nThe agent should request status from {{status/v1/services/master}} instead\r\n\r\n{noformat}\r\n$ curl -ks https://puppet:8140/status/v1/simple/master\r\nrunning\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9159', 'https://github.com/puppetlabs/puppet/pull/7108', '2018-09-20T15:42:17.000-0700', '2018-10-02T12:45:15.000-0700', '2018-10-02T12:45:15.000-0700', 'Closed', '', 2, '0', 1, 12, 1, 2, '604212978d5564a75b9cb55abd4f187f4efbb6eb'),
('puppet', 276326, 216763841, 7103, '`puppet cert` does not output helpful error text when called with args', 'In Puppet 6, we disabled the {{puppet cert}} command, with the intention of making it print helpful error output in lieu of doing anything. However, the error text does not print when {{puppet cert}} is called with an action. We should update it to print the error output in all cases.', 'https://tickets.puppetlabs.com/browse/PUP-9155', 'https://github.com/puppetlabs/puppet/pull/7103', '2018-09-18T16:09:46.000-0700', '2018-10-02T12:45:16.000-0700', '2018-10-02T12:45:16.000-0700', 'Closed', '', 1, '0', 1, 2, 112, 1, '1bea1a27ca33d2a85f847ac7cf9576426c65cd76'),
('puppet', 274976, 215624128, 7089, 'puppet apply --catalog cat.json does not trigger resolution of Deferred values', 'As the summary says: puppet apply --catalog cat.json does not trigger resolution of Deferred values\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9121', 'https://github.com/puppetlabs/puppet/pull/7089', '2018-09-10T03:39:55.000-0700', '2018-10-02T12:45:19.000-0700', '2018-10-02T12:45:19.000-0700', 'Closed', '', 3, '0', 2, 113, 59, 2, 'd475e3889a27cc89cd0b9309569e12c22aa28b35'),
('puppet', 274715, 216795231, 7105, 'Restarting services using launchd service provider is flaky', '*Puppet Version: 5.4.0*\r\n *OS Name/Version: macOS 10.13.6*\r\n\r\nRestarting jobs will frequently fail. When restarting a service, the {{launchd}} provider calls {{stop}} and then {{start}}. The {{stop}} method executes {{launchctl unload -w <plist path>}}, and then calls {{enable}} The {{enable}} method reads the disable overrides pilst ({{/var/db/com.apple.xpc.launchd/disabled.plist}}) and modifies it.\r\n\r\nHowever, there is a race. While the {{launchd}} process is changing states, the disables plist is sometimes zero-length. When this occurs, {{read_plist}} (which is just {{Puppet::Util::(Plist.read_plist_file}} fails:\r\n\r\n{noformat}\r\nInfo: /Stage[main]/Main/File[/tmp/foo]: Scheduling refresh of Service[keepalive]\r\nWarning: Cannot read file /var/db/com.apple.xpc.launchd/disabled.plist; Puppet is skipping it.\nDetails: Execution of ''/usr/bin/plutil -convert xml1 -o - /var/db/com.apple.xpc.launchd/disabled.plist'' returned 1: /var/db/com.apple.xpc.launchd/disabled.plist: Property List error: Cannot parse a NULL or zero-length data / JSON error: No value.\r\nError: /Stage[main]/Main/Service[keepalive]: Failed to call refresh: undefined method `[]='' for nil:NilClass\r\nError: /Stage[main]/Main/Service[keepalive]: undefined method `[]='' for nil:NilClass \r\n{noformat}\r\n\r\nThis leaves the service stopped and disabled, and the puppet run is unsuccessful. A subsequent puppet run will restart and re-enable the job.\r\n\r\nA simple workaround would be to loop and sleep while reading the overrides plist. I have a small commit that does this.\r\n\r\nThere is a larger architectural issue with the {{launchd}} provider, however. We only get into this error state because the provider is trying to reconcile a service resource that should be {{ensure => running}} and {{enable => true}}. When it calls {{stop}}, the resource that should be running/enabled is now stopped/disabled, and the {{stop}} method helpfully tries to fix the disabled bit by calling {{enable}}. But the {{enable}} (and {{disable}}) methods use direct modification of the overrides plist to do their work, and this is not a supported method.\r\n\r\nFrom the {{launchctl}} man page:\r\nbq. Overrides the Disabled key and sets it to false or true for the load and unload subcommands respectively. In previous versions, this option would modify the configuration file. Now the state of the Disabled key is stored elsewhere on- disk in a location that *may not be directly manipulated by any process other than launchd.*\r\n\r\nI think a larger re-thinking of how to manage {{launchd}} services with this provider is needed.\r\n\r\n*Desired Behavior:*\r\n\r\nThe service successfully restarts.\r\n\r\n*Actual Behavior:*\r\n\r\nThe service is left stopped and disabled until a subsequent puppet run.\r\n\r\n*Steps to reproduce:*\r\nTrigger a refresh on a {{launchd service}}. This doesn''t happen on every service restart, but if you do several in a row eventually this will crop up.\r\n\r\nI''ve attached a {{keepalive.sh}}. Put this in {{/tmp}} and make it executable. Put {{keepalive.plist}} in {{/Library/LaunchDaemons/}}. Run this repeatedly until puppet fails:\r\n{code}sudo rm -f /tmp/foo; sudo puppet apply --verbose --color=true --trace keepalive.pp{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9111', 'https://github.com/puppetlabs/puppet/pull/7105', '2018-09-06T14:44:37.000-0700', '2018-10-02T12:45:19.000-0700', '2018-10-02T12:45:19.000-0700', 'Closed', 'macos;service;type_and_provider', 3, '0', 1, 38, 3, 2, '9a45a6343b50a390d429b6add797a2abd5c52b43'),
('puppet', 58064, 216783258, 7104, 'Puppet stores files forever in state.yaml', 'We noticed the following today on one of our production clusters: https://cloudup.com/cgJm3eD4wu4. Essentially Puppet Agent has been using gradually more CPU and Memory over time and was taking longer and longer to execute. On some nodes its been using 2G during each run.\r\n\r\nDigging in, we discovered why. We have configuration like the following:\r\n\r\n{code}\r\nfile {\r\n	"/var/db/":\r\n		ensure => directory,\r\n		group => "dbuser",\r\n		owner => "dbuser",\r\n		recurse => true;\r\n}\r\n{code}\r\n\r\nIt turns out that the /var/db directory on this machine sometimes includes temporary files, because of the data system using this directory. This means there are a few new files in /var/db every time we run puppet agent.\r\n\r\nWe discovered today that each time puppet sees a file, it writes a line to /var/lib/puppet/state/state.yaml. Since there were always new files each time puppet ran, this file grew and grew. Its about 125MB on some of our machines. With a state.yaml file of that size, puppet agent took this long:\r\n\r\nreal    6m31.792s \r\nuser    5m56.434s \r\nsys     0m33.867s \r\n\r\nAfter deleting /var/lib/puppet/state/state.yaml it dropped to:\r\n\r\nreal    0m25.232s \r\nuser    0m16.073s \r\nsys     0m4.112s  \r\n\r\nWe''ve removed our use of `recurse` for now, which wasn''t really necessary in this case, but we consider this a dangerous situation and a bug in Puppet; it means that we need to be sure Puppet isn''t touching new files over time. Happy to provide more details if its helpful.', 'https://tickets.puppetlabs.com/browse/PUP-3647', 'https://github.com/puppetlabs/puppet/pull/7104', '2014-11-07T15:34:19.000-0800', '2018-10-02T12:45:22.000-0700', '2018-10-02T12:45:22.000-0700', 'Closed', '', 12, '0', 1, 140, 1, 4, 'af4994edf7ba8940264af07a5ed0bd00a369bd51'),
('puppet', 157105, 218413710, 7123, 'Windows agents should be able to apply a ''stopped'' service resource even if the service doesn''t exist ', 'Linux agents don''t seem to have this issue, for example:\r\n\r\n{code:java}\r\n]# puppet apply -e ''service {"notaservice": ensure => "stopped", enable => false,}''\r\nNotice: Compiled catalog for pe-201620-master.example.com in environment production in 0.12 seconds\r\nNotice: Applied catalog in 0.33 seconds\r\n{code}\r\n\r\nHowever, on Windows, an attempt to apply the same resource gives:\r\n\r\n{code:java}\r\nPS C:\Users\Administrator> puppet apply -e ''service {"notaservice": ensure => "stopped", enable => false,}''\r\nNotice: Compiled catalog for windows-agent1 in environment production in 0.03 seconds\r\nError: /Stage[main]/Main/Service[notaservice]: Could not evaluate: Cannot get status of notaservice, error was: The specified service does not exist as an installed service. - OpenService: The specified service does not exist as an installed service.\r\nWrapped exception:\r\nThe specified service does not exist as an installed service. - OpenService: The specified service does not exist as an installed service.\r\nNotice: Applied catalog in 0.14 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6822', 'https://github.com/puppetlabs/puppet/pull/7123', '2016-10-16T09:36:47.000-0700', '2018-10-09T12:18:18.000-0700', '2018-10-09T12:18:18.000-0700', 'Closed', 'service;the-goods;type_and_provider;windows;windows-parity', 8, '0', 4, 64, 57, 6, '0177190a6585da78cf049234a0ac0d14412032e8'),
('puppet', 28406, 164984545, 6570, 'puppet cert clean cannot remove signing requests', 'I have a certificate signing request that I would like to get rid of with "puppet cert". However, I can only list and sign CSRs.\r\n\r\nHere''s my log:\r\n[root@operations ~]# puppet --version\r\n3.4.2\r\n[root@operations ~]# puppet cert  list | grep local\r\n  "localhost.localdomain" (MD5) 12:5E:40:6B:79:84:6F:9C:51:7B:40:81:30:30:8B:F5\r\n[root@operations ~]# puppet cert  clean localhost.localdomain\r\nError: Could not find a serial number for localhost.localdomain\r\n\r\nA thread at puppet-users suggests this worked before, but is now broken:\r\nhttps://groups.google.com/forum/#!topic/puppet-users/gmIFG108aw0 ', 'https://tickets.puppetlabs.com/browse/PUP-1916', 'https://github.com/puppetlabs/puppet/pull/6570', '2014-03-11T06:51:40.000-0700', '2018-10-09T12:54:49.000-0700', '2018-10-09T12:54:49.000-0700', 'Closed', 'cs_pr_review;cspapercuts', 19, '0', 1, 32, 2, 2, '69a4b75743348352b86abcf3abba68deafd1eff6'),
('puppet', 197195, 126806250, 6003, 'puppet resource user may show double groups', 'Systems with complex, and overlapping, user lookups may double list a user''s groups.\r\n\r\nFor example:\r\n\r\n{noformat}\r\n$ puppet resource user riehecky\r\n{noformat}\r\n\r\n{code:puppet}\r\nuser { ''riehecky'':\r\n  ensure           => ''present'',\r\n  comment          => ''Patrick Riehecky'',\r\n  gid              => ''100'',\r\n  groups           => [''wheel'', ''mock'', ''staff'', ''wheel'', ''mock'', ''staff''],\r\n  home             => ''/home/r/riehecky'',\r\n  shell            => ''/bin/bash'',\r\n  uid              => ''10000'',\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7685', 'https://github.com/puppetlabs/puppet/pull/6003', '2017-06-21T09:22:24.000-0700', '2018-10-12T09:05:00.000-0700', '2018-10-12T09:05:00.000-0700', 'Closed', 'community', 6, '0', 1, 6, 1, 1, '22312fd8d4e6d086d82e28ffcfcccf5993fc7cd1'),
('puppet', 275629, 215403148, 7086, 'Scope#function_xxx loaded 3x function will be overwritten by 4x load', 'if a 3.x function is first loaded from within another function (via a {{function_xxx()}} call), it is then reloaded if it is called from the puppet language or via {{Scope#call_function}}\r\n\r\nReported in PE-25136\r\n\r\nThis is a consequence of function loading being changed in 5.5.7 and 6.0.0 to allow any module to call a function in any other.', 'https://tickets.puppetlabs.com/browse/PUP-9137', 'https://github.com/puppetlabs/puppet/pull/7086', '2018-09-13T11:27:58.000-0700', '2018-10-24T06:15:47.000-0700', '2018-10-24T06:15:47.000-0700', 'Closed', '', 1, '0', 2, 48, 10, 2, '392ef7a7adcaa6577ea70c4158848f93a09da5f1'),
('puppet', 278353, 221567025, 7154, 'Puppet should ignore empty init.pp', 'Puppet6 will error if a module contains an empty init.pp. The [module documentation|https://puppet.com/docs/puppet/5.3/modules_fundamentals.html] says, "init.pp: Contains a class definition. The init.pp class, if used, is the main class of the module. This class''s name must match the module''s name."\r\n\r\nSo the init.pp file is optional, but we don''t specify whether the file can exist, but be empty or if it only contains a defined type.\r\n\r\nWe discovered in MODULES-7854 that some people may have empty {{init.pp}} and puppet should be more lenient. For now, we removed the empty init.pp from the rspec-puppet''s module fixtures.\r\n\r\n/cc [~henrik.lindberg], [~kris.bosland], [~ben.ford], [~chuck], [~eric.sorenson]', 'https://tickets.puppetlabs.com/browse/PUP-9190', 'https://github.com/puppetlabs/puppet/pull/7154', '2018-10-01T11:58:00.000-0700', '2018-10-24T10:18:39.000-0700', '2018-10-24T10:18:39.000-0700', 'Closed', '', 5, '0', 2, 14, 10, 2, '6150c2528ea333b01bb17b21495bb8edb7309c3d'),
('puppet', 250923, 219521866, 7130, 'File resource doesn''t seem to parse UTF8 filenames when recursively copying directories', '*Puppet Version:* 5.5.1 (Win x64)\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* Windows 10 - 1803\r\n\r\n*Desired Behavior:*\r\n\r\nGiven a manifest saved as UTF8\r\n\r\n{code}\r\nfile { "c:\\install\\test\\Testing-wordsé":\r\n  ensure  => file,\r\n  content => ''Testing é'',\r\n} ->\r\n\r\nfile { "c:\\install\\test\\Testing-words-copyé":\r\n  ensure => file,\r\n  source => "c:\\install\\test\\Testing-wordsé",\r\n} ->\r\n\r\nfile { "c:\\install\\test2":\r\n  ensure  => directory,\r\n  source  => "c:\\install\\test",\r\n    recurse => remote,\r\n    replace => true,\r\n}\r\n{code}\r\n\r\nIt should create the files in the C:\install\test directory\r\nIt should copy the C:\install\test directory to C:\install\test2\r\n\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet apply errors with;\r\n\r\n{{Could not set ''file'' on ensure: invalid byte sequence in UTF-8}}\r\n\r\n\r\nFull trace dump in comments', 'https://tickets.puppetlabs.com/browse/PUP-8735', 'https://github.com/puppetlabs/puppet/pull/7130', '2018-05-15T21:31:50.000-0700', '2018-10-24T10:18:41.000-0700', '2018-10-24T10:18:41.000-0700', 'Closed', 'customer;customer-escalation;file;i18n;type_and_provider;utf-8;windows', 8, '0', 1, 79, 12, 3, '07505b025a2f81b396f3cc2a5d3e6aa95590afae'),
('puppet', 279128, 221595932, 7155, 'Module paths with common root cause incorrect name location validation errors.', 'When one module path is a substring of another, users can get incorrect name location validation errors.\r\n{code:java}\r\nkris.bosland@kris:puppet % bx puppet apply --modulepath ../tmp/test/modules:../tmp/test/modules.common  -e ''class test { include bash }; include test''                             ±[5.5.6^0]\r\nWarning: Unacceptable location. The name ''bash'' is unacceptable in file ''/Users/kris.bosland/work/tmp/test/modules.common/bash/manifests/init.pp'' (file: /Users/kris.bosland/work/tmp/test/modules.common/bash/manifests/init.pp, line: 1, column: 1)\r\nNotice: Compiled catalog for kris.bosland-c02kf9eafft1 in environment production in 0.57 seconds\r\nError: Mac OS X PKG DMGs must specify a package source.\r\nError: /Stage[main]/Bash/Package[shells/bash]/ensure: change from ''absent'' to ''present'' failed: Mac OS X PKG DMGs must specify a package source.\r\nNotice: Applied catalog in 0.02 seconds\r\nkris.bosland@kris:puppet % cat ../tmp/test/modules.common/bash/manifests/init.pp                                                                                                   ±[5.5.6^0]\r\nclass bash {\r\n    package { "shells/bash":\r\n        ensure => installed,\r\n    }\r\n}\r\nkris.bosland@kris:puppet %{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9211', 'https://github.com/puppetlabs/puppet/pull/7155', '2018-10-05T11:13:43.000-0700', '2018-10-24T10:18:49.000-0700', '2018-10-24T10:18:49.000-0700', 'Closed', '', 3, '0', 1, 14, 2, 2, '89fb979487e54b86523a838b5fa8913cd3e683f5'),
('puppet', 143096, 226246693, 7204, 'Group resource emits misleading change notification with auth_membership => false', 'When Puppet is adding users to an existing group, its change report is misleading.\r\n\r\nTake the following manifest (from French Windows):\r\n\r\n{code}\r\ngroup { ''Administrateurs'': \r\n	ensure => ''present'', \r\n	auth_membership => false, \r\n	members => [''AUTORITE NT\\Utilisateurs authentifiés'']\r\n}\r\n{code}\r\n\r\n\r\nIt emits the following message\r\n\r\n{code}\r\n# $ bundle exec puppet apply utf8.pp\r\n# DL is deprecated, please use Fiddle\r\n# Notice: Compiled catalog for wbsk7zl860xwiqa.delivery.puppetlabs.net in environment production in 0.06 seconds\r\n# Notice: /Stage[main]/Main/Group[Administrateurs]/members: members changed ''WBSK7ZL860XWIQA\Administrateur,WBSK7ZL860XWIQA\tester,WBSK7ZL860XWIQA\Administrator,WBSK7ZL860XWIQA\cyg_server,WBSK7ZL860XWIQA\bla'' to ''AUTORITE NT\Utilisateurs authentifiés''\r\n# Notice: Applied catalog in 0.11 seconds\r\n{code}\r\n\r\nHowever, the message is incorrect, given the actual group membership:\r\n\r\n{code}\r\n$ bundle exec puppet resource group Administrateurs\r\nDL is deprecated, please use Fiddle\r\ngroup { ''Administrateurs'':\r\n  ensure  => ''present'',\r\n  gid     => ''S-1-5-32-544'',\r\n  members => [''Administrateur'', ''tester'', ''Administrator'', ''cyg_server'', ''bla'', ''Utilisateurs authentifiés''],\r\n}\r\n{code}\r\n\r\n\r\nExpected behavior should be like what the user resource does:\r\n\r\n{code}\r\nuser { ''Invité'': \r\n	ensure => ''present'', \r\n	auth_membership => minimum, \r\n	groups => [''BUILTIN\\Administrateurs'']\r\n}\r\n{code}\r\n\r\nEmits the following message:\r\n\r\n{code}\r\nbundle exec puppet apply .\user.pp\r\nDL is deprecated, please use Fiddle\r\nNotice: Compiled catalog for wbsk7zl860xwiqa.delivery.puppetlabs.net in environment production in 0.08 seconds\r\nNotice: /Stage[main]/Main/User[Invité]/groups: groups changed ''BUILTIN\Invités'' to [''BUILTIN\Administrateurs'', ''BUILTIN\Invités'']\r\nNotice: Applied catalog in 0.11 seconds\r\n{code}\r\n\r\nFor resource\r\n\r\n{code}\r\nbundle exec puppet resource user\r\n\r\n<snip/>\r\n\r\nuser { ''Invité'':\r\n  ensure  => ''present'',\r\n  comment => ''Compte d''utilisateur invité'',\r\n  groups  => [''BUILTIN\Invités'', ''BUILTIN\Administrateurs''],\r\n  uid     => ''S-1-5-21-441295449-3808246871-2843121223-501'',\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6542', 'https://github.com/puppetlabs/puppet/pull/7204', '2016-07-22T18:08:32.000-0700', '2018-10-24T11:58:05.000-0700', '2018-10-24T11:58:05.000-0700', 'Closed', 'group;type_and_provider;user;windows', 5, '0', 4, 200, 217, 14, 'da5c2df7e22f92e0bfbadf602930fe6b4c77885f'),
('puppet', 282350, 226246693, 7204, 'group resource: members parameter: array values broken', '*Puppet Version: 5.5.7*\r\n *Puppet Server Version: 5.3.3*\r\n *OS Name/Version: CentOS 7.5*\r\n\r\nStarting with 5.5.7 (5.5.6 works) the members parameter of the group resource does not work with values of type Array anymore due to an evaluation error during catalog application.\r\n\r\n \r\n\r\n/opts/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/group.rb:136f:\r\n{code:java}\r\n# The members property should also accept a comma separated\r\n# list of members (a String parameter) for backwards\r\n# compatibility. Unfortunately, the List property would treat\r\n# our comma separated list of members as a single-element Array.\r\n# This override of should= ensures that a comma separated list of\r\n# members is munged to an array of members, which is what we want.\r\n# Note that we cannot use `munge` because that will pass in each\r\n# array element instead of the entire array if the members property\r\n# is specified as an array of members, which would cause each member\r\n# to be munged into an array for that case. This is undesirable\r\ndef should=(values)\r\n  super(values)  if @should.length == 1 && @should.first.include?(delimiter)\r\n    @should = @should.first.split(delimiter)\r\n  end  @should\r\nend\r\n{code}\r\nThis code was introduced with 5.5.7 and _seems_ to +break arrays completely+ instead of just adding backwards compatibility for strings.\r\n\r\n \r\n\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nHandle arrays as before.\r\n\r\n*Actual Behavior:*\r\n\r\nGroup resources with members parameter values of type Array break puppet runs.\r\n\r\nmodules/module/manifests/init.pp:\r\n{code:java}\r\ngroup { ''foo'':\r\n    ensure => ''present'',\r\n    members => [''bar''],\r\n    auth_membership => true;\r\n}{code}\r\npuppet agent --test:\r\n{code:java}\r\nError: /Stage[main]/module/Group[foo]: Could not evaluate: undefined method `split'' for ["bar"]:Array\r\n{code}\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9265', 'https://github.com/puppetlabs/puppet/pull/7204', '2018-10-25T06:28:18.000-0700', '2018-10-26T11:40:20.000-0700', '2018-10-26T11:40:20.000-0700', 'Closed', '', 9, '0', 4, 200, 217, 14, 'ba6d0698c37a5711206bdb6d076da74b2b1bd71b'),
('puppet', 277981, 220799636, 7150, 'Format Handler logs exceptions at too high a level', 'I made a [change|https://github.com/puppetlabs/puppet/commit/2dc6f510bf2313bbbc0013f08182918f3986355f] in Puppet 6 to log FormatError exceptions that were silently swallowed, but the interface to log at a debug level didn''t work consistently so these are logged as errors even though they can be encountered in normal operation and may not be errors.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9185', 'https://github.com/puppetlabs/puppet/pull/7150', '2018-09-27T13:36:56.000-0700', '2018-10-29T06:51:01.000-0700', '2018-10-29T06:51:01.000-0700', 'Closed', '', 2, '0', 1, 84, 25, 10, 'd12ee4ddc1f25eb1ae954682b028a3e9f91a1382'),
('puppet', 278129, 219504891, 7129, 'Update error messages that still refer to `puppet cert`', 'A recent user report uncovered at least one place in Puppet''s error output where we are still referring to the removed {{puppet cert}} commandL https://github.com/puppetlabs/puppet/blob/edc2d4c0ffb2b60879e61f232f62c7fd6927733d/lib/puppet/ssl/host.rb#L162. We should fix that, and also audit the code base for other bad references.', 'https://tickets.puppetlabs.com/browse/PUP-9187', 'https://github.com/puppetlabs/puppet/pull/7129', '2018-09-28T11:40:45.000-0700', '2018-10-29T06:51:05.000-0700', '2018-10-29T06:51:05.000-0700', 'Closed', '', 1, '0', 1, 12, 24, 4, '1c5724294beb879ec34cd5897ea75c6449ffef14'),
('puppet', 82950, 221227948, 7151, 'Windows User resource managehome doesn''t support custom directories', 'The Windows user resource will allow specifying a custom home directory\r\n\r\n{code}\r\npuppet resource user jenkins managehome=true home=c:\jenkins password=Puppet123!\r\n{code}\r\n\r\nPuppet will claim that this has worked correctly:\r\n\r\n{code}\r\nNotice: /User[jenkins]/ensure: created\r\nuser { ''jenkins'':\r\n  ensure   => ''present'',\r\n  home     => ''c:\jenkins'',\r\n  password => ''Puppet123!'',\r\n}\r\n{code}\r\n\r\nHowever, the home directory will not actually be created and the default directory will be created.', 'https://tickets.puppetlabs.com/browse/PUP-4687', 'https://github.com/puppetlabs/puppet/pull/7151', '2015-06-03T08:44:23.000-0700', '2018-10-29T06:51:05.000-0700', '2018-10-29T06:51:05.000-0700', 'Closed', 'type_and_provider;user;windows;windows-parity', 3, '0', 1, 4, 1, 1, '92ddcaa8afb0153cc97f6001419615d487c48fbf'),
('puppet', 278361, 221254871, 7152, 'Don''t manage CA file/directory permissions', 'Puppet6 no longer reads to or writes from the CA related files, but we weren''t able to move the settings to puppetserver in time for 6. Several of the settings still define an {{owner}}, {{group}}, {{mode}} which means puppet could in theory attempt to manage the permissions on those files. This doesn''t happen in practice, because puppet never calls {{Puppet.settings.use(:ca)}}, but an custom application could. To be sure that never happens, we should remove {{owner}}, {{group}}, {{mode}} from the settings in the {{:ca}} section.\r\n\r\n/cc [~maggie]. [~justin]', 'https://tickets.puppetlabs.com/browse/PUP-9192', 'https://github.com/puppetlabs/puppet/pull/7152', '2018-10-01T12:30:40.000-0700', '2018-10-29T06:51:11.000-0700', '2018-10-29T06:51:11.000-0700', 'Closed', '', 3, '0', 1, 0, 27, 1, 'a4829a6e5568af1970643cc0a5acc3a7b2af9289'),
('puppet', 192213, 223337539, 7170, 'Exec resource exposing Sensitive data', 'Currently the namvar attribute of the exec resource is assigned to the command attribute.\r\nmeaning the name of the resource when printed into resources.txt is the executed parameter.\r\n\r\nThis could be considered a security issue, but also makes it difficult to name resources uniquely.\r\nA request for a name attribute or the ability to use the title as the namevar.\r\n\r\nThis is an issue when running {{puppet agent}} or {{puppet apply --write-catalog-summary}}.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7580', 'https://github.com/puppetlabs/puppet/pull/7170', '2017-05-22T03:00:14.000-0700', '2018-10-31T08:09:01.000-0700', '2018-10-31T08:09:01.000-0700', 'Closed', '', 4, '0', 1, 37, 9, 3, 'a93e2bce909c94da5586591973d938d6ccef4785'),
('puppet', 280889, 223675505, 7173, 'suidmanager test fails on non-Windows when running as root', '*Puppet Version: 6.0.1/6.0.2*\r\n *Puppet Server Version:* *6.0.1/6.0.2***\r\n *OS Name/Version: x86_64-Ubuntu 18.04*\r\n\r\nI have followed the steps mentioned in below file.\r\n\r\n[^X86_steps.sh]\r\n\r\n*Desired Behavior:*\r\nAll test cases should pass\r\n\r\n*Actual Behavior:*\r\n\r\nunit test case is failing with below message.\r\n Failures:\r\n\r\n    1) Puppet::Util::SUIDManager#asuser should not get or set euid/egid on Windows\r\n      Failure/Error: expect(xids).to be_empty\r\n        expected `\{:egid=>42, :euid=>42}.empty?` to return true, got false\r\n       # ./spec/unit/util/suidmanager_spec.rb:129:in `block (3 levels) in <top (required)>''\r\n\r\n  Finished in 11.72 seconds (files took 1.75 seconds to load)\r\n  1222 examples, 1 failure\r\n \r\n\r\nThe same test case is passing for 5.x version, Please check the issue', 'https://tickets.puppetlabs.com/browse/PUP-9244', 'https://github.com/puppetlabs/puppet/pull/7173', '2018-10-17T02:24:28.000-0700', '2018-11-01T17:23:58.000-0700', '2018-11-01T17:23:58.000-0700', 'Closed', '', 3, '0', 1, 1, 3, 1, '958c2574cc2b04172dd4ad0668e2cc69d7644df9'),
('puppet', 282441, 225805240, 7199, 'Only show deprecation of CA setting when it is set in the config file', 'When we fixed PUP-9158, we missed the {{:ca}} setting. Since it was actually removed in Puppet 6, we should keep the deprecation warning, but it should only be issued from a hook called when the setting is set in the file, not any time it is used in code.', 'https://tickets.puppetlabs.com/browse/PUP-9266', 'https://github.com/puppetlabs/puppet/pull/7199', '2018-10-25T10:30:50.000-0700', '2018-11-01T17:24:01.000-0700', '2018-11-01T17:24:01.000-0700', 'Closed', '', 3, '0', 1, 4, 2, 1, '185f0fce7e62ce50bb23b197eadd471fbc85a855'),
('puppet', 282553, 226527087, 7206, '5.5.7 breaks custom function', '*Puppet Version: 5.5.7*\r\n *Puppet Server Version: 5.3.6*\r\n *OS Name/Version: Debian 9*\r\n\r\nAfter upgrading Puppet from 5.5.6 to 5.5.7, certain custom functions do not work anymore. Specifically, camptocamp/accounts has a function strformat which doesn''t work anymore.\r\n\r\nThe client shows:\r\n{code:java}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Resource Statement, Evaluation Error: Error while evaluating a Function Call, undefined method `strformat'' for Scope(Accounts::Authorized_key[stefan-eris-on-root]):Puppet::Parser::Scope (file: /etc/puppetlabs/code/environments/production/modules/accounts/manifests/authorized_key.pp, line: 32, column: 36) (file: /etc/puppetlabs/code/environments/production/modules/accounts/manifests/account.pp, line: 98)\r\n{code}\r\nThe server log shows:\r\n{code:java}\r\nERROR [qtp2035689341-63] [puppetserver] Puppet Evaluation Error: Error while evaluating a Resource Statement, Evaluation Error: Error while evalu\r\nating a Function Call, undefined method `strformat'' for Scope(Accounts::Authorized_key[stefan-eris-on-root]):Puppet::Parser::Scope (file: /etc/puppetlabs/code/environmen\r\nts/production/modules/accounts/manifests/authorized_key.pp, line: 32, column: 36) (file: /etc/puppetlabs/code/environments/production/modules/accounts/manifests/account.\r\npp, line: 98) on node node.example.com\r\norg/jruby/RubyBasicObject.java:1555:in `method_missing''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:1036:in `method_missing''\r\n/etc/puppetlabs/code/environments/production/modules/accounts/lib/puppet/parser/functions/strformat.rb:22:in `real_function_strformat''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/functions.rb:174:in `function_strformat''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/functions.rb:167:in `function_strformat''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions.rb:752:in `call''\r\norg/jruby/RubyKernel.java:1242:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions.rb:749:in `call''\r\n/etc/puppetlabs/code/environments/production/modules/accounts/manifests/authorized_key.pp:32:in `call_function''\r\norg/jruby/RubyKernel.java:1079:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:303:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:964:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:933:in `eval_CallNamedFunctionExpression''\r\n\r\n{code}\r\nThe code in question reads (abbreviated):\r\n{code:java}\r\nPuppet::Parser::Functions.newfunction(:strformat, :type => :rvalue) do |args|\r\n  def strformat(format, arg)\r\n    new = format.gsub(/%\{([^%\[\}]+)([^%\}]*)\}/) { eval("arg[$1]#{$2}") }\r\n    (new =~ /%/) ? strformat(new, arg) : new\r\n  end\r\n\r\n  strformat(args[0], self.to_hash)\r\nend\r\n\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9268', 'https://github.com/puppetlabs/puppet/pull/7206', '2018-10-26T04:21:10.000-0700', '2018-11-06T10:39:53.000-0800', '2018-11-06T10:39:53.000-0800', 'Closed', 'resolved-issue-added', 21, '0', 2, 42, 263, 12, '28c051e6991b6d6d47178b562c1ff2fdd1be7141'),
('puppet', 282580, 226195265, 7203, 'puppet 5.5.7 and 6.0.3 cause a stacktrace with puppetlabs-mysql 5.x series', '*Puppet Version: 5.5.7*\r\n *Puppet Server Version:*\r\n *OS Name/Version: CentOS 7*\r\n\r\nThe puppet-nova unit tests that consume puppetlabs-mysql 5.2.1 are failing with:\r\n\r\n{code}\r\nEvaluation Error: Error while evaluating a Function Call, undefined local variable or method `created'' for Puppet::Pops::Loader::RubyLegacyFunctionInstantiator:Class (file: /home/zuul/workspace/spec/fixtures/modules/mysql/manifests/server.pp, line: 52, column: 14) on node centos-7-rax-ord-0000030381\r\n{code}\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nNo failure from puppet.\r\n\r\n \r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\n \r\n\r\nRunning the unit tests testing with puppetlabs-mysql 5.2.1 causes the following stack trace:\r\n\r\n{code}\r\nhttp://logs.openstack.org/46/613446/1/check/puppet-openstack-unit-5.5-centos-7/40e8913/job-output.txt.gz#_2018-10-26_03_45_55_003975\r\n\r\n2018-10-26 03:45:55.002558 | centos-7 | 1) nova::db::mysql_api on debian-8-x86_64 configures nova::db::mysql_api with only required params should contain Openstacklib::Db::Mysql[nova_api] with user => "nova_api", password_hash => "*AA1420F182E88B9E5F874F6FBE7459291E8F4601", charset => "utf8" and collate => "utf8_general_ci"\r\n2018-10-26 03:45:55.002632 | centos-7 | Failure/Error:\r\n2018-10-26 03:45:55.002790 | centos-7 | it { is_expected.to contain_openstacklib__db__mysql(''nova_api'').with(\r\n2018-10-26 03:45:55.002886 | centos-7 | :user => ''nova_api'',\r\n2018-10-26 03:45:55.003035 | centos-7 | :password_hash => ''*AA1420F182E88B9E5F874F6FBE7459291E8F4601'',\r\n2018-10-26 03:45:55.003125 | centos-7 | :charset => ''utf8'',\r\n2018-10-26 03:45:55.003246 | centos-7 | :collate => ''utf8_general_ci'',\r\n2018-10-26 03:45:55.003316 | centos-7 | )}\r\n2018-10-26 03:45:55.003357 | centos-7 |\r\n2018-10-26 03:45:55.003442 | centos-7 | Puppet::PreformattedError:\r\n2018-10-26 03:45:55.003975 | centos-7 | Evaluation Error: Error while evaluating a Function Call, undefined local variable or method `created'' for Puppet::Pops::Loader::RubyLegacyFunctionInstantiator:Class (file: /home/zuul/workspace/spec/fixtures/modules/mysql/manifests/server.pp, line: 52, column: 14) on node centos-7-rax-ord-0000030381\r\n2018-10-26 03:45:55.004198 | centos-7 | Shared Example Group: "nova::db::mysql_api" called from ./spec/classes/nova_db_mysql_api_spec.rb:81\r\n2018-10-26 03:45:55.004425 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/ruby_legacy_function_instantiator.rb:36:in `create''\r\n2018-10-26 03:45:55.004629 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/module_loaders.rb:263:in `instantiate''\r\n2018-10-26 03:45:55.004818 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/module_loaders.rb:237:in `find''\r\n2018-10-26 03:45:55.005017 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/base_loader.rb:161:in `internal_load''\r\n2018-10-26 03:45:55.005220 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/base_loader.rb:42:in `load_typed''\r\n2018-10-26 03:45:55.005423 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/base_loader.rb:153:in `internal_load''\r\n2018-10-26 03:45:55.005613 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/base_loader.rb:42:in `load_typed''\r\n2018-10-26 03:45:55.005786 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/loader/loader.rb:72:in `load''\r\n2018-10-26 03:45:55.005997 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/runtime3_support.rb:302:in `call_function''\r\n2018-10-26 03:45:55.006234 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:964:in `call_function_with_block''\r\n2018-10-26 03:45:55.006478 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:933:in `eval_CallNamedFunctionExpression''\r\n2018-10-26 03:45:55.006655 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n2018-10-26 03:45:55.006853 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n2018-10-26 03:45:55.007079 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:370:in `eval_AssignmentExpression''\r\n2018-10-26 03:45:55.007274 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n2018-10-26 03:45:55.007510 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n2018-10-26 03:45:55.007792 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `block in eval_BlockExpression''\r\n2018-10-26 03:45:55.007989 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `each''\r\n2018-10-26 03:45:55.008202 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `reduce''\r\n2018-10-26 03:45:55.008425 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `eval_BlockExpression''\r\n2018-10-26 03:45:55.008602 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n2018-10-26 03:45:55.008799 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n2018-10-26 03:45:55.008997 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n2018-10-26 03:45:55.009196 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:32:in `evaluate''\r\n2018-10-26 03:45:55.009419 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:72:in `block (2 levels) in evaluate''\r\n2018-10-26 03:45:55.009617 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:71:in `catch''\r\n2018-10-26 03:45:55.009824 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:71:in `block in evaluate''\r\n2018-10-26 03:45:55.010005 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:70:in `catch''\r\n2018-10-26 03:45:55.010205 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:70:in `evaluate''\r\n2018-10-26 03:45:55.010387 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast.rb:31:in `safeevaluate''\r\n2018-10-26 03:45:55.010571 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/resource/type.rb:136:in `evaluate_code''\r\n2018-10-26 03:45:55.010762 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/resource.rb:79:in `block in evaluate''\r\n2018-10-26 03:45:55.010960 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n2018-10-26 03:45:55.011130 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler.rb:51:in `profile''\r\n2018-10-26 03:45:55.011338 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/resource.rb:71:in `evaluate''\r\n2018-10-26 03:45:55.011517 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:386:in `each''\r\n2018-10-26 03:45:55.011708 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:386:in `evaluate_classes''\r\n2018-10-26 03:45:55.011886 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/functions/include.rb:48:in `include''\r\n2018-10-26 03:45:55.012072 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n2018-10-26 03:45:55.012303 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\n2018-10-26 03:45:55.012502 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/dispatcher.rb:42:in `catch''\r\n2018-10-26 03:45:55.012699 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n2018-10-26 03:45:55.012899 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/function.rb:46:in `block in call''\r\n2018-10-26 03:45:55.013083 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/function.rb:45:in `catch''\r\n2018-10-26 03:45:55.013279 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/functions/function.rb:45:in `call''\r\n2018-10-26 03:45:55.013381 | centos-7 | # :1:in `block in call_function''\r\n2018-10-26 03:45:55.013579 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/runtime3_support.rb:305:in `eval''\r\n2018-10-26 03:45:55.013807 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/runtime3_support.rb:305:in `block in call_function''\r\n2018-10-26 03:45:55.014018 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n2018-10-26 03:45:55.014204 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler.rb:51:in `profile''\r\n2018-10-26 03:45:55.014422 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/runtime3_support.rb:303:in `call_function''\r\n2018-10-26 03:45:55.014654 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:964:in `call_function_with_block''\r\n2018-10-26 03:45:55.014896 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:933:in `eval_CallNamedFunctionExpression''\r\n2018-10-26 03:45:55.015073 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n2018-10-26 03:45:55.015296 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n2018-10-26 03:45:55.015538 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `block in eval_BlockExpression''\r\n2018-10-26 03:45:55.015733 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `each''\r\n2018-10-26 03:45:55.015931 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `reduce''\r\n2018-10-26 03:45:55.016151 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:660:in `eval_BlockExpression''\r\n2018-10-26 03:45:55.016343 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n2018-10-26 03:45:55.016546 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n2018-10-26 03:45:55.016612 | centos-7 | # :in `stack''\r\n2018-10-26 03:45:55.016784 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/puppet_stack.rb:33:in `eval''\r\n2018-10-26 03:45:55.016958 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/puppet_stack.rb:33:in `stack''\r\n2018-10-26 03:45:55.017199 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:737:in `eval_Program''\r\n2018-10-26 03:45:55.017385 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n2018-10-26 03:45:55.017585 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n2018-10-26 03:45:55.017784 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n2018-10-26 03:45:55.017973 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast/pops_bridge.rb:125:in `evaluate''\r\n2018-10-26 03:45:55.018148 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/ast.rb:31:in `safeevaluate''\r\n2018-10-26 03:45:55.018345 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/resource/type.rb:136:in `evaluate_code''\r\n2018-10-26 03:45:55.018540 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/resource.rb:79:in `block in evaluate''\r\n2018-10-26 03:45:55.018743 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n2018-10-26 03:45:55.018917 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler.rb:51:in `profile''\r\n2018-10-26 03:45:55.019093 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/resource.rb:71:in `evaluate''\r\n2018-10-26 03:45:55.019312 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:592:in `evaluate_main''\r\n2018-10-26 03:45:55.019532 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:166:in `block (2 levels) in compile''\r\n2018-10-26 03:45:55.019732 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n2018-10-26 03:45:55.019904 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler.rb:51:in `profile''\r\n2018-10-26 03:45:55.020095 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:166:in `block in compile''\r\n2018-10-26 03:45:55.020281 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/context.rb:65:in `override''\r\n2018-10-26 03:45:55.020440 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet.rb:260:in `override''\r\n2018-10-26 03:45:55.020616 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:155:in `compile''\r\n2018-10-26 03:45:55.020790 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/parser/compiler.rb:35:in `compile''\r\n2018-10-26 03:45:55.021019 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/indirector/catalog/compiler.rb:303:in `block (2 levels) in compile''\r\n2018-10-26 03:45:55.021231 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n2018-10-26 03:45:55.021407 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util/profiler.rb:51:in `profile''\r\n2018-10-26 03:45:55.021619 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/indirector/catalog/compiler.rb:301:in `block in compile''\r\n2018-10-26 03:45:55.021795 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util.rb:232:in `block in benchmark''\r\n2018-10-26 03:45:55.021917 | centos-7 | # /usr/share/ruby/benchmark.rb:296:in `realtime''\r\n2018-10-26 03:45:55.022079 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/util.rb:231:in `benchmark''\r\n2018-10-26 03:45:55.022286 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/indirector/catalog/compiler.rb:299:in `compile''\r\n2018-10-26 03:45:55.022495 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/indirector/catalog/compiler.rb:54:in `block in find''\r\n2018-10-26 03:45:55.022693 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/node/environment.rb:450:in `with_text_domain''\r\n2018-10-26 03:45:55.022885 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/indirector/catalog/compiler.rb:53:in `find''\r\n2018-10-26 03:45:55.023068 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/indirector/indirection.rb:198:in `find''\r\n2018-10-26 03:45:55.023312 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/support.rb:218:in `block in build_catalog_without_cache''\r\n2018-10-26 03:45:55.023480 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet/context.rb:65:in `override''\r\n2018-10-26 03:45:55.023634 | centos-7 | # ./.bundled_gems/gems/puppet-5.5.7/lib/puppet.rb:260:in `override''\r\n2018-10-26 03:45:55.023850 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/support.rb:216:in `build_catalog_without_cache''\r\n2018-10-26 03:45:55.024066 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/support.rb:231:in `block in build_catalog''\r\n2018-10-26 03:45:55.024258 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/cache.rb:17:in `call''\r\n2018-10-26 03:45:55.024435 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/cache.rb:17:in `get''\r\n2018-10-26 03:45:55.024628 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/support.rb:230:in `build_catalog''\r\n2018-10-26 03:45:55.024821 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/support.rb:28:in `load_catalogue''\r\n2018-10-26 03:45:55.025041 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/example/class_example_group.rb:7:in `catalogue''\r\n2018-10-26 03:45:55.025249 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/support.rb:8:in `block in subject''\r\n2018-10-26 03:45:55.025458 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/matchers/create_generic.rb:82:in `call''\r\n2018-10-26 03:45:55.025669 | centos-7 | # ./.bundled_gems/gems/rspec-puppet-2.3.2/lib/rspec-puppet/matchers/create_generic.rb:82:in `matches?''\r\n2018-10-26 03:45:55.025854 | centos-7 | # ./spec/classes/nova_db_mysql_api_spec.rb:19:in `block (4 levels) in <top (required)>''\r\n2018-10-26 03:45:55.025891 | centos-7 |\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9270', 'https://github.com/puppetlabs/puppet/pull/7203', '2018-10-26T10:12:25.000-0700', '2018-11-06T10:45:28.000-0800', '2018-11-06T10:45:28.000-0800', 'Closed', 'resolved_issue_added', 5, '0', 1, 32, 2, 3, '05a971a21c861f8d7d4b522973934c4a61a6e3f8'),
('puppet', 276983, 217745835, 7114, 'Lexer incorrectly identifying list starts inside heredocs', 'Square brackets that are:\r\n * Inside heredocs\r\n * Inside an interpolation\r\n\r\nAre sometimes being incorrectly lexed as TOKEN_LISTSTART.\r\nh3. Simplest example\r\n\r\nCreate test.pp:\r\n{code}$xxxxxxx = @("END")\r\n${facts[''os''][''family'']}\r\nXXXXXXX XXX\r\nEND\r\nnotice($xxxxxxx){code}\r\nPuppet apply it.\r\nh3. What I expect\r\n\r\nSome text to appear showing the OS family.\r\nh3. What I actually see\r\n{code:none}Error: Could not parse for environment production: Syntax error at ''['' (file: /Users/alexharvey/git/home/puppet-test/test.pp, line: 2, column: 14)\r\n{code}\r\nh3. More info\r\n\r\nNote the space inside XXX XX. That space is matching in the lexer on this line [here|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/parser/lexer2.rb#L192], leading to the ''['' being lexed as TOKEN_LISTSTART.', 'https://tickets.puppetlabs.com/browse/PUP-9163', 'https://github.com/puppetlabs/puppet/pull/7114', '2018-09-24T04:05:43.000-0700', '2018-11-07T11:40:57.000-0800', '2018-11-07T11:40:57.000-0800', 'Closed', '', 3, '0', 1, 18, 3, 3, '49b42a55a181f7b68663edcd2e99fc21001f967b'),
('puppet', 173233, 147861663, 6295, 'Puppet fails with inscrutable errors when logging large messages on Windows', 'The Windows event log has limits on the amount of data it will accept when logging a message:\r\n\r\nhttps://msdn.microsoft.com/en-us/library/windows/desktop/aa363679(v=vs.85).aspx\r\n\r\nThese limits can be exceeded by {{exec}} resources which log a large volume of data. For example, a verbose recursive copy of a deep directory tree.\r\n\r\n\r\nh2. Reproduction Case\r\n\r\n  1. Install the Puppet agent on Windows Server 2012 or newer.\r\n\r\n  2. Install the Powershell module:\r\n\r\n{code}\r\npuppet module install puppetlabs/powershell\r\n{code}\r\n\r\n  3. Create a manifest with the following content:\r\n\r\n{code:puppet}\r\n# large_output.pp\r\nexec{''log large output'':\r\n  # Repeat a character 32,000 times. Should trigger the event log limit\r\n  command => ''Write-Output ("x" * 32000)'',\r\n  provider => powershell,\r\n  logoutput => true,\r\n}\r\n{code}\r\n\r\n  4. Apply the manifest and send output to the event log:\r\n\r\n{code}\r\npuppet apply large_output.pp --logdest=eventlog --logdest=console\r\n{code}\r\n\r\nh3. Outcome\r\n\r\nThe command fails with a terse, cryptic message like:\r\n\r\n{noformat}\r\nPS C:\Users\Administrator> puppet apply test.pp --logdest=eventlog --logdest=console\r\nNotice: Compiled catalog for pe-201642-agent-win2012 in environment production in 0.27 seconds\r\nError: The parameter is incorrect. - ReportEvent\r\nError: /Stage[main]/Main/Exec[test log large output]/returns: change from notrun to 0 failed: The parameter is incorrect\r\n. - ReportEvent\r\nNotice: Applied catalog in 2.89 seconds\r\n{noformat}\r\n\r\nOr:\r\n\r\n{noformat}\r\nPS C:\Users\Administrator> puppet apply test.pp --logdest=eventlog --logdest=console\r\nNotice: Compiled catalog for pe-201642-agent-win2012 in environment production in 0.27 seconds\r\nError: The parameter is incorrect. - ReportEvent\r\nError: /Stage[main]/Main/Exec[test log large output]/returns: change from notrun to 0 failed: Too many links. - ReportEvent\r\nNotice: Applied catalog in 2.89 seconds\r\n{noformat}\r\n\r\nDetailed error trace:\r\n\r\n{noformat}\r\nPS C:\Users\Administrator> puppet apply test.pp --logdest=eventlog --logdest=console --trace\r\nNotice: Compiled catalog for pe-201642-agent-win2012 in environment production in 0.28 seconds\r\nError: The parameter is incorrect. - ReportEvent\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/win32-eventlog-0.6.2/lib/win32/eventlog.rb:717:in\r\n`report_event''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log/destinations.rb:241:in `handle''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:176:in `block in newmessage''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:175:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:175:in `newmessage''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:268:in `initialize''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:87:in `new''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:87:in `create''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/logging.rb:12:in `send_log''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/logging.rb:21:in `block (2 levels) in <mod\r\nule:Logging>''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/type/exec.rb:154:in `block in sync''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/type/exec.rb:153:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/type/exec.rb:153:in `sync''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:236:in `sync''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:134:in `sync_if\r\n_needed''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:88:in `block in\r\n perform_changes''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:87:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:87:in `perform_\r\nchanges''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:21:in `evaluate\r\n''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction.rb:224:in `apply''\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction.rb:240:in `eval_resource''\r\n...\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe Puppet Agent should split, truncate or drop large messages and log a better error explaining what happened.', 'https://tickets.puppetlabs.com/browse/PUP-7153', 'https://github.com/puppetlabs/puppet/pull/6295', '2017-02-01T06:28:14.000-0800', '2018-11-13T08:56:00.000-0800', '2018-11-13T08:56:00.000-0800', 'Closed', '', 5, '0', 1, 24, 0, 2, '308862c702dc1ab7d1fb9257dacb55d258ff44f9'),
('puppet', 150344, 128256613, 6028, 'Puppet::Util::Execution.execute ''hostname'' returns nothing as daemon', 'When {{Puppet::Util::Execution.execute ''hostname''}} is invoked by Puppet running as a daemon, no output is written. This seems to be exclusive to {{hostname}}, and may be restricted to certain Linux versions. I''ve tried it on RedHat 7 (64-bit).\r\n\r\nThis can happen in a provider when using {{commands :hostname => ''hostname''}}, and then invoking {{hostname}}. The root appears to be how {{/usr/bin/hostname}} handles file handles.\r\n\r\nIt can be simplified to\r\n{code}\r\nexec { ''/bin/hostname'': logoutput => true }\r\n{code}\r\n\r\nThis is getting into some core Ruby weirdness:\r\n{code}\r\nruby -e "Kernel.fork { \$stdout.reopen(''/tmp/foo'', ''w+''); Kernel.exec ''hostname'' }"\r\n{code}\r\nprints hostname to {{/tmp/foo}} when run from the command-line. When run as a systemd script:\r\n{code:title=/usr/lib/systemd/system/print-hostname.service}\r\n[Unit]\r\nDescription=Print the hostname using Ruby\r\nWants=basic.target\r\nAfter=basic.target network.target\r\n\r\n[Service]\r\nExecStart=/usr/bin/ruby -e "Kernel.fork { $stdout.reopen(''/tmp/foo'', ''w''); Kernel.exec ''hostname'' }"\r\nKillMode=process\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n{code}\r\nsymlinked to {{/etc/systemd/system/multi-user.target.wants/print-hostname.service}} it creates an empty file.\r\n\r\nChanging the ruby script to\r\n{code}\r\nfoo = open(''/tmp/foo'', ''w''); pid = Kernel.fork { $stdout.reopen(foo); Kernel.exec ''hostname'' }; Process.wait pid; foo.close\r\n{code}\r\nto ensure the file is closed doesn''t seem to change the behavior.\r\n\r\nAlso, behavior is consistent with both system Ruby on Redhat 7 (2.0.0) and Ruby with a puppet-agent 1.6.2 build candidate.\r\n\r\nIf I use a simple fork/exec without trying to redirect stdout, it prints correctly as a service and from the command-line. It''s only once I redirect stdout that things get weird. The above is essentially what Puppet::Util::Execution.execute does, which is what the type is calling to. Interestingly, Facter::Core::Execution.execute (with Facter 3) works fine.\r\n\r\nWith {{strace}}, I note that {{hostname}} calls {{write(1, ...)}} then immediately exits. Other examples will close fids 1 and 2 before exiting.', 'https://tickets.puppetlabs.com/browse/PUP-6675', 'https://github.com/puppetlabs/puppet/pull/6028', '2016-09-02T10:22:24.000-0700', '2018-11-19T14:02:32.000-0800', '2018-11-19T14:02:32.000-0800', 'Closed', 'selinux', 12, '0', 1, 376, 96, 4, '8cec657e2d5e5335f2218207d2b2534ac31424ff'),
('puppet', 274372, 215465027, 7088, 'Windows file system ACLs should always write SYSTEM: (F)', 'When creating Windows ACLs when writing file permissions, the current code allows for the SYSTEM ACE to be written as something other than F (Full Control). This can be problematic as it can result in files that cannot have permissions reset, or that may be inaccessible to Puppet itself (which typically runs as SYSTEM).\r\n\r\nIn practical terms, there is no good reason to set SYSTEM permissions to anything other than F and Puppet should disallow that. \r\n\r\nAt one point the Puppet code was modified as part of https://projects.puppetlabs.com/issues/15559 (related to PUP-5480) in https://github.com/puppetlabs/puppet/commit/b578ed48ac9585edb86b296e99f8aeeecc02fb4e#diff-a788175040b15f1e899dae62e4c1b8c6 to re-add a missing SYSTEM if it wasn''t already specified.\r\n\r\nWe never took the additional step of making sure that SYSTEM can only be set to F, which in hindsight, seems like the right approach, given what is now known about permissions management and the work that was done as part of PA-2019 and PUP-5985.\r\n\r\nOne thing to note is that this will technically be a breaking change. This could cause idempotency issues under a few (highly unlikely) circumstances:\r\n\r\n* If SYSTEM is explicitly managed and set to an octal mode other than 7\r\n* If an octal mode is set inconsistently for a file where the user and group are both SYSTEM (this would have already been a problem)\r\n* On older Puppet versions with manage_internal_file_permissions set to true on Windows (this is not a concern now though given work in PUP-5985) where Puppet tried to manage its own files\r\n\r\nGiven the low likelihood of a manifest explicitly specifying SYSTEM other than F, but the Puppet code actually writing F as a result of this fix - this should be corrected.\r\n\r\nIn addition, a {{debug}} message should be emitted that an attempt to set SYSTEM other than F was intercepted and corrected (at the very least, this may help find some internal bugs that should be fixed as well)', 'https://tickets.puppetlabs.com/browse/PUP-9106', 'https://github.com/puppetlabs/puppet/pull/7088', '2018-09-05T10:42:25.000-0700', '2018-12-04T13:09:55.000-0800', '2018-12-04T13:09:55.000-0800', 'Closed', 'acl;ntfs;windows', 15, '0', 1, 30, 13, 3, '6c581df00daacd64d4357cee61b9d9c64ffad478'),
('puppet', 272191, 210103222, 7012, 'Inconsistent undef value received by 4.x API Ruby functions after touched by 3.x Ruby function', 'While trying to use the Stdlib function to_yaml() I believe I have discovered a bug in how Puppet handles data returned from Ruby 3.x API functions versions when passed into 4.x Ruby functions.\r\n\r\nIt is easiest to explain with a reproducer. Give this code, where func3() and func4() are just Ruby API 3.x and 4.x functions respectively that each just return the value they were passed:\r\n{noformat}\r\n$orig_hash = {\r\n  ''mykey''    => undef,\r\n  ''otherkey'' => ''test'',\r\n}\r\n\r\n$func4_hash = func4($orig_hash)\r\nnotice("func4_hash: ${func4_hash}")\r\nnotice("func4_hash_json: ${to_json($func4_hash)}")\r\nnotice("func4_hash_yaml: ${to_yaml($func4_hash)}")\r\n\r\n$func3_hash = func3($orig_hash)\r\nnotice("func3_hash: ${func3_hash}")\r\nnotice("func3_hash_json: ${to_json($func3_hash)}")\r\nnotice("func3_hash_yaml: ${to_yaml($func3_hash)}")\r\n{noformat}\r\nI get this output:\r\n{noformat}\r\n$ puppet apply --modulepath=. test/test.pp \r\nNotice: Scope(Class[main]): func4_hash: {mykey => , otherkey => test}\r\nNotice: Scope(Class[main]): func4_hash_json: {"mykey":null,"otherkey":"test"}\r\nNotice: Scope(Class[main]): func4_hash_yaml: ---\r\nmykey: \r\notherkey: test\r\n\r\nNotice: Scope(Class[main]): func3_hash: {mykey => , otherkey => test}\r\nNotice: Scope(Class[main]): func3_hash_json: {"mykey":"undef","otherkey":"test"}\r\nNotice: Scope(Class[main]): func3_hash_yaml: ---\r\nmykey: :undef\r\notherkey: test\r\n\r\nNotice: Compiled catalog for msp-pumtl31.msp.secure-24.net in environment production in 0.02 seconds\r\nNotice: Applied catalog in 0.01 seconds\r\n{noformat}\r\nNote how the original data structure is correctly passed to the 4.x function with a nil value the first time, but after passing through a 3.x function the 4.x function now receives :undef and not nil.\r\n\r\nThe expected behavior is that a 4.x Ruby function would always receive nil when passed a Puppet undef value, regardless of whether it has passed through a 3.x style function or not.\r\n\r\nThank you.', 'https://tickets.puppetlabs.com/browse/PUP-9077', 'https://github.com/puppetlabs/puppet/pull/7012', '2018-08-21T07:31:40.000-0700', '2018-12-06T02:42:28.000-0800', '2018-12-06T02:42:28.000-0800', 'Closed', '', 7, '0', 1, 64, 7, 5, ''),
('puppet', 288254, 237822469, 7284, 'PUP-9294 fails to load valid 3.x function when it contains call to constant', 'In PUP-9294 new checking for illegal constructs in 3.x functions was introduced. Before release it was found that it crashes if the 3.x function contains a call to a constant. The one that was detected contained the following:\r\n\r\n{code}\r\nFloat(a_string)\r\n{code}\r\n\r\nThe logic added in PUP-9294 was not expecting calls to constants and would produce a "nil" function name thus crashing when validating the loaded 3.x function.', 'https://tickets.puppetlabs.com/browse/PUP-9359', 'https://github.com/puppetlabs/puppet/pull/7284', '2018-12-11T12:42:35.000-0800', '2018-12-12T10:44:57.000-0800', '2018-12-12T10:44:57.000-0800', 'Closed', '', 3, '0', 1, 21, 1, 2, ''),
('puppet', 281124, 223796148, 7175, 'Puppet String _("(<setting>") has a typo ', 'While browsing the translation segments for Puppet Platform on Transifex I came across a text fragment which let me to the following link:\r\n\r\n[https://github.com/puppetlabs/puppet/blame/1707f2ca46867651095e01379bd01dab08076b8b/locales/puppet.pot#L757]\r\n\r\nAnd the source code reference near that line led me to the following line of code.\r\n\r\n> [https://github.com/puppetlabs/puppet/blame/1574c5a773d8d5d3ccd5979e4ab44c9274a2dd90/lib/puppet/face/config.rb#L213]\r\n\r\n \r\n\r\n_("(<setting>") should be\r\n\r\n_("<setting>") ?  ..... removing "(" in the string\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9245', 'https://github.com/puppetlabs/puppet/pull/7175', '2018-10-17T15:18:15.000-0700', '2018-12-17T19:25:12.000-0800', '2018-12-17T19:25:12.000-0800', 'Closed', 'i18n', 3, '0', 1, 1, 1, 1, 'c4dbe9a5f216686c7528204d2a44444b06340fde'),
('puppet', 286146, 234149214, 7253, '''puppet ssl clean'' does not remove the certificate requests', '*..Puppet Version: 6.0.4*\r\n *Puppet Server Version: 6.0.1*\r\n *OS Name/Version: Centos7*\r\n\r\nWhen I get "Error: Could not request certificate: The certificate retrieved from the master does not match the agent''s private key...", I use the "puppet ssl clean" as suggested by the error message:\r\n\r\n \r\n{code:java}# puppet ssl clean\r\nNotice: Removed private key /etc/puppetlabs/puppet/ssl/private_keys/dbslave.example.com.pem\r\nNotice: Removed public key /etc/puppetlabs/puppet/ssl/public_keys/dbslave.example.com.pem\r\nNotice: Removed certificate /etc/puppetlabs/puppet/ssl/certs/dbslave.example.com.pem\r\n{code}\r\n \r\n\r\nBut then I have to clean the certificate request manually, otherwise I get the same error.\r\n{code:java}# rm /etc/puppetlabs/puppet/ssl/certificate_requests/dbslave.example.com.pem{code}\r\n*Desired Behavior:*\r\n\r\nAccording to the feature request ( PUP-9156)  it should be cleaned automatically along with the other files.\r\n\r\nPuppet configs are all default. I have not overridden any of them.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9327', 'https://github.com/puppetlabs/puppet/pull/7253', '2018-11-22T02:32:57.000-0800', '2018-12-19T06:21:51.000-0800', '2018-12-19T06:21:51.000-0800', 'Closed', 'resolved-issue-added', 2, '0', 1, 13, 12, 3, 'b55fc8ec40ae62879673db8a3329fcf5ee8122d0'),
('puppet', 22411, 220751873, 7146, 'Exec provider should support environment variables with empty values', 'The exec provider takes an environment parameter that takes either a string or an array of variables. Each variable is expressed as a pair, like "KEY=value" for example. The problem is that the code that parses this string requires a value whereas this is not strictly necessary, like "KEY=" should be perfectly acceptable. The code in Puppet::Provider::Exec.run looks like this:\r\n\r\n{code:none}\r\nif setting =~ /^(\w+)=((.|\n)+)$/\r\n env_name = $1\r\n value = $2\r\n{code}\r\n\r\nSimply changing the regular expression to use "*" instread of "+" for the value should work just fine:\r\n\r\n{code:none}\r\nirb(main):001:0> setting = ''KEY=''\r\n => "KEY="\r\n irb(main):002:0> setting =~ /^(\w+)=((.|\n)+)$/\r\n => nil\r\n irb(main):003:0> setting =~ /^(\w+)=((.|\n)*)$/\r\n => 0\r\n irb(main):004:0> $1\r\n => "KEY"\r\n irb(main):005:0> $2\r\n => "" \r\n{code}\r\n\r\nSo, the value of empty string is exactly what was requested.', 'https://tickets.puppetlabs.com/browse/PUP-1209', 'https://github.com/puppetlabs/puppet/pull/7146', '2013-12-20T13:10:57.000-0800', '2018-12-19T06:21:53.000-0800', '2018-12-19T06:21:53.000-0800', 'Closed', 'community;redmine;resolved-issue-added', 5, '0', 1, 34, 5, 3, '56ae357e17d247359f74d326ec16dda5522a0e44'),
('puppet', 281310, 225209901, 7194, 'add support for devices to puppet ssl', 'After PUP-9156 ...\r\n\r\nAn SSL error involving a device prompts the user to run the ''puppet ssl clean'' command\r\nwhich cleans agent ssl files instead of the device ssl files,\r\nand prompts the user to run ''puppet agent'' instead of ''puppet device''.', 'https://tickets.puppetlabs.com/browse/PUP-9248', 'https://github.com/puppetlabs/puppet/pull/7194', '2018-10-18T15:20:35.000-0700', '2018-12-19T06:21:53.000-0800', '2018-12-19T06:21:53.000-0800', 'Closed', 'resolved-issue-added', 3, '0', 1, 94, 28, 6, 'da526c5626b9cb4cbb3cce742b9d48d85b376a9e'),
('puppet', 288130, 237642951, 7282, '`puppet device` does not load local plugins for --apply --facts and --resource', 'The changes in PUP-8766 (https://github.com/puppetlabs/puppet/pull/7242) removed plugin loading from a local environment for `puppet device`, even in the cases where local content is supposed to be used.\r\n\r\nThe issue was detected in Resource API acceptance testing yesterday after the merge-up from 5.5.x to 6.0.x. The fix should be trivially mergeable to 6.0.x and beyond.', 'https://tickets.puppetlabs.com/browse/PUP-9356', 'https://github.com/puppetlabs/puppet/pull/7282', '2018-12-11T03:22:09.000-0800', '2018-12-19T06:21:53.000-0800', '2018-12-19T06:21:53.000-0800', 'Closed', '', 6, '0', 1, 2, 2, 1, '7dffb28e2f49ecc7cd00276299a264862911acd7'),
('puppet', 283096, 227089434, 7214, 'use-after-free in windows service utils', 'The windows service utils have a use-after-free failure in the query functions', 'https://tickets.puppetlabs.com/browse/PUP-9292', 'https://github.com/puppetlabs/puppet/pull/7214', '2018-10-30T11:22:26.000-0700', '2018-12-20T07:40:28.000-0800', '2018-12-20T07:40:28.000-0800', 'Closed', '', 3, '0', 1, 105, 98, 1, '3cdf2edf3a1f89e4d5101c61a3fc58e0c88c0a96'),
('puppet', 279612, 227207480, 7216, 'Crontab gets erased after error during agent run', 'This is a duplicate of https://tickets.puppetlabs.com/browse/MODULES-7789. It is filed here so that we can track it in the 5.5.x release stream.', 'https://tickets.puppetlabs.com/browse/PUP-9217', 'https://github.com/puppetlabs/puppet/pull/7216', '2018-10-09T13:51:48.000-0700', '2018-12-20T07:40:29.000-0800', '2018-12-20T07:40:29.000-0800', 'Closed', '', 1, '0', 8, 484, 18, 11, '420049f20622fa7988f80555ca9c7d3c816024f5'),
('puppet', 286192, 236460940, 7274, 'Array conversion to String using ''short-form'' broken', '[https://puppet.com/docs/puppet/5.3/function.html#conversion-to-string]\r\n\r\nand\r\n\r\n[http://puppet-on-the-edge.blogspot.com/2016/05/converting-and-formatting-data-like-pro.html] both have examples of how to get Puppet to format strings when converting from Arrays.\r\n\r\neg.\r\n{code}$str = String([10], "%(a") # produces ''("10")''\r\n{code}\r\n{code}# Formatting with indentation\r\nString([1, [2, 3], 4], "%#a")\r\n# produces:\r\n# [1,\r\n#  [2, 3],\r\n#  4]\r\n{code}\r\nIt appears these examples haven''t worked since puppet 4.8 (they work in 4.7.1).\r\n\r\nThe long form still works.\r\n eg\r\n{code}String([1, [2, 3], 4], Array => { format => "%#a"})\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9329', 'https://github.com/puppetlabs/puppet/pull/7274', '2018-11-22T09:41:43.000-0800', '2018-12-20T07:40:30.000-0800', '2018-12-20T07:40:30.000-0800', 'Closed', 'resolved-issue-added', 2, '0', 1, 31, 2, 2, '379b797801d1e37deee8dd7b6a870c81f2dc23c5'),
('puppet', 284716, 230107946, 7229, 'Timespan and Timestamp types cannot be specified from integer or float', 'The data types Timestamp and Timespan are supposed to support specifying the range of time using integer and float values - but there are bugs in the implementation that raises errors for this.', 'https://tickets.puppetlabs.com/browse/PUP-9310', 'https://github.com/puppetlabs/puppet/pull/7229', '2018-11-12T03:33:32.000-0800', '2018-12-20T07:40:30.000-0800', '2018-12-20T07:40:30.000-0800', 'Closed', 'resolved-issue-added', 0, '0', 3, 43, 2, 3, '53c11eb044b597396f97875d1284ccca693c8aec'),
('puppet', 68161, 232131953, 7245, 'update documentation for generate function to clarify possible return values', 'the generate function returns the total command output of a command including any meta parameters current wording is not explicit enough, suggested update\r\n\r\nhttps://docs.puppetlabs.com/references/latest/function.html#generate\r\n\r\nCalls an external command on the Puppet master and returns the results of the command. Any arguments are passed to the external command as arguments. If the generator does not exit with return code of 0, the generator is considered to have failed and a parse error is thrown. Generators can only have file separators, alphanumerics, dashes, and periods in them. This function will attempt to protect you from malicious generator calls (e.g., those with ‘..’ in them), but it can never be entirely safe. No subshell is used to execute generators, so all shell metacharacters are passed directly to the generator, and all metacharacters are returned by the function, consider cleaning white space from any string generated.', 'https://tickets.puppetlabs.com/browse/PUP-9320', 'https://github.com/puppetlabs/puppet/pull/7245', '2015-02-17T08:54:20.000-0800', '2018-12-20T07:40:30.000-0800', '2018-12-20T07:40:30.000-0800', 'Closed', 'generated-docs', 4, '0', 1, 7, 6, 1, '2d9c854dbc7375c976b6e8af1821c52d2ed91179'),
('puppet', 284721, 230997691, 7234, 'Document auth_membership as being Solaris specific', 'Hi,\r\n\r\nWhen managing a user on a Windows 2016 I''ve used a resource like so:\r\n{noformat} define profiles::windows::account(\r\n  $account_name = $title,\r\n  $password,\r\n  $is_admin,\r\n){\r\n\r\n  if ($is_admin == true){\r\n    $groups = [''Users'',''Administrators'']\r\n  }\r\n  else {\r\n    $groups = [''Users'',''Remote Desktop Users'']\r\n  }\r\n\r\n  user { "${title}":\r\n    ensure          => present,\r\n    name            => $title,\r\n    password        => Sensitive($password),\r\n    managehome      => true,\r\n    groups          => $groups,\r\n    auth_membership => ''inclusive'',\r\n  }\r\n\r\n} \r\n{noformat}\r\nHowever when I create a user with this and then switch is_admin to false puppet adds the remote desktop group but doesn''t remove the administrators group.\r\n\r\nNotice: /Stage[main]/Profiles::Windows::Accounts/Profiles::Windows::Account[test_user]/User[test_user]/groups: groups changed BUILTIN\Administrators,BUILTIN\Users to [''BUILTIN\Administrators'', ''BUILTIN\Users'', ''BUILTIN\Remote Desktop Users'']\r\n\r\nFrom [the docs|https://puppet.com/docs/puppet/5.0/resources_user_group_windows.html] the inclusive auth_membership should remove the user from the group?\r\n\r\nPuppet agent version: 5.5.6\r\n\r\nPuppet server version: 5.3.1 running on CentOs 7.', 'https://tickets.puppetlabs.com/browse/PUP-9311', 'https://github.com/puppetlabs/puppet/pull/7234', '2018-11-12T04:55:14.000-0800', '2018-12-20T10:57:59.000-0800', '2018-12-20T10:57:59.000-0800', 'Closed', '', 7, '0', 1, 1, 1, 1, '5eb9919b5efdaf668ddea0616402a811f5dbee97'),
('puppet', 104823, 50024064, 4423, 'Puppet does not apply inheritable SYSTEM permissions to directories it manages on Windows under certain circumstances', 'To address https://projects.puppetlabs.com/issues/15559,  https://github.com/puppetlabs/puppet/commit/b578ed48ac9585edb86b296e99f8aeeecc02fb4e was added so that in the cases where an owner / group / mode were specified that did not include {{SYSTEM}}, Puppet would re-add {{SYSTEM}} permissions.  Since there is generally no reason to remove {{SYSTEM}} permissions, the previous behavior was problematic as it could prevent services (like Puppet itself) from accessing files and directories.\r\n\r\nThis was handled by setting {{NT AUTHORITY\SYSTEM:(F)}} on files and directories.\r\n\r\nHowever, this approach was subtly flawed, when files or directories are written to a directory that had {{SYSTEM}} permissions re-added by Puppet.  Since inheritance is not set with the re-added permissions, these new children would no longer have an ACE for {{NT AUTHORITY\SYSTEM:(F)}}.  The solution here is to ensure that the {{SYSTEM}} ace is instead set like {{NT AUTHORITY\SYSTEM:(F)(CI)(OI)}}.  This allows the {{SYSTEM}} permission to propagate to any newly created files or directories within the parent managed directory, by turning on container inheritance (for directories) and object inheritance (for files).\r\n\r\nAs it turns out, Puppet itself is affected by this flaw on the first run that it writes an agent''s private key, public key and the ca cert when the agent is not run as {{SYSTEM}} (which is the case during acceptance tests that run as {{cygsrv}} or {{Administrator}}). With debug logging on, the settings catalog, which explicitly sets permissions on these files (via    https://github.com/puppetlabs/puppet/blob/master/lib/puppet/defaults.rb#L709-L759), can be observed making changes to re-add missing {{SYSTEM}} permissions on the next Puppet run like:\r\n\r\n{code}\r\n[Debug: /File[C:/ProgramData/PuppetLabs/puppet/etc/ssl/private_keys/lmugyz1yds193au.delivery.puppetlabs.net.pem]/mode: mode changed ''4000640'' to ''0640''\r\n[Debug: /File[C:/ProgramData/PuppetLabs/puppet/etc/ssl/public_keys/lmugyz1yds193au.delivery.puppetlabs.net.pem]/mode: mode changed ''4000640'' to ''0644''\r\n[Debug: /File[C:/ProgramData/PuppetLabs/puppet/etc/ssl/certs/ca.pem]/mode: mode changed ''4000640'' to ''0644''\r\n{code}\r\n\r\nAnother affected area is the {{cache/client_data/catalog dir}} (client_datadir).  Heavy-handed approaches have been employed like the one at https://github.com/puppetlabs/marionette-collective/blob/master/acceptance/tests/mco_puppet_powershell.rb#L77-L94 that remove the unmanaged directory written by {{cygsrv}} (and lacking {{SYSTEM}} permissions), so that a subsequent service run may recreate directories with appropriate permissions.', 'https://tickets.puppetlabs.com/browse/PUP-5480', 'https://github.com/puppetlabs/puppet/pull/4423', '2015-11-06T16:55:38.000-0800', '2018-12-26T11:27:10.000-0800', '2018-12-26T11:27:10.000-0800', 'Closed', '', 7, '0', 1, 3, 1, 1, '14802e4231a35fa1b67c676d458ba4f036673573'),
('puppet', 283168, 231829427, 7243, 'read_wide_string hides errors if the string is nil', '*Puppet Version:* 5.5.2 (PE 2018.1.2 Master & Agent)\r\n *Puppet Server Version:* N/A\r\n *OS Name/Version:* Windows Server 2012r2\r\n\r\nAs part of [https://puppetlabs.zendesk.com/agent/tickets/32364] it was found that there was a bug in the error handler in the read_wide_string method ([https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/api_types.rb#L56-L63])\r\n\r\nWhere if {{str}} is nil then an error is raised during the debug statement and raises the wrong error. Instead the Puppet.debug statement should never error and raise the real error', 'https://tickets.puppetlabs.com/browse/PUP-9293', 'https://github.com/puppetlabs/puppet/pull/7243', '2018-10-30T15:27:53.000-0700', '2019-01-11T08:34:51.000-0800', '2019-01-11T08:34:51.000-0800', 'Closed', '', 5, '0', 1, 1, 1, 1, '20d28e7fd8c3c5f9abe451b166e641e7b27c6bf7'),
('puppet', 285382, 231490716, 7241, 'Backport PUP-8002 to 5.5.x ("Attempt to redefine entity")', 'In PUP-8002 a fix was provided for a problem where the error "Attempt to redefine entity" is raised in error.\r\n\r\nThis change is wanted for 5.5.x as well. This ticket is for backporting the fix for 6.1.0 to 5.5.x.', 'https://tickets.puppetlabs.com/browse/PUP-9317', 'https://github.com/puppetlabs/puppet/pull/7241', '2018-11-16T02:44:46.000-0800', '2019-01-11T08:35:44.000-0800', '2019-01-11T08:35:44.000-0800', 'Closed', 'resolved-issue-added', 3, '0', 1, 3, 1, 1, 'b6cdb66a3a962e3202dc6025130a4ef98f117401'),
('puppet', 287496, 236286242, 7273, 'Failing spec test in puppet travis testing', 'example job: https://travis-ci.org/puppetlabs/puppet/jobs/463959473\r\n\r\nfailure:\r\n\r\n{code}\r\n  1) Puppet::Indirector::Yaml when searching should return an array of fact instances with one instance for each file when globbing *\r\n     Failure/Error: expect(terminus.search(request)).to eq([one, two])\r\n       expected: [{"name"=>"one", "values"=>{"foo"=>"bar"}}, {"name"=>"two", "values"=>{"foo"=>"baz"}}]\r\n            got: [{"name"=>"two", "values"=>{"foo"=>"baz"}}, {"name"=>"one", "values"=>{"foo"=>"bar"}}]\r\n       (compared using ==)\r\n       Diff:\r\n       @@ -1,3 +1,3 @@\r\n       -[{"name"=>"one", "values"=>{"foo"=>"bar"}},\r\n       - {"name"=>"two", "values"=>{"foo"=>"baz"}}]\r\n       +[{"name"=>"two", "values"=>{"foo"=>"baz"}},\r\n       + {"name"=>"one", "values"=>{"foo"=>"bar"}}]\r\n     # ./spec/unit/indirector/yaml_spec.rb:144:in `block (3 levels) in <top (required)>''\r\n     # util/rspec_runner:44:in `run''\r\n     # util/rspec_runner:59:in `<main>''\r\nFinished in 11.11 seconds (files took 3.28 seconds to load)\r\n{code}\r\n\r\nThe failure is unrelated to any changes in the PR that it was tested against, the test seems pretty fragile.', 'https://tickets.puppetlabs.com/browse/PUP-9340', 'https://github.com/puppetlabs/puppet/pull/7273', '2018-12-05T10:19:56.000-0800', '2019-01-11T08:36:39.000-0800', '2019-01-11T08:36:39.000-0800', 'Closed', '', 1, '0', 1, 1, 1, 1, 'e47e5cf9c3c41f7035c790ddb81f1d4766211158'),
('puppet', 24924, 228085925, 7225, 'Puppet::Util::Log requires a message', 'When trying to add holdable support to the yum package provider under PUP-958, the following error is being thrown when attempting to catch an exception invoking ''provider.hold''. \r\n\r\n{noformat}\r\n$ sudo bundle exec puppet resource package bash ensure=held --trace\r\nError: /Package[bash]: Could not evaluate: Puppet::Util::Log requires a message\r\n/mnt/data/Puppet/lib/puppet/util/log.rb:298:in `message=''\r\n/mnt/data/Puppet/lib/puppet/util/log.rb:247:in `initialize''\r\n/mnt/data/Puppet/lib/puppet/util/log.rb:84:in `new''\r\n/mnt/data/Puppet/lib/puppet/util/log.rb:84:in `create''\r\n/mnt/data/Puppet/lib/puppet/util/logging.rb:8:in `send_log''\r\n/mnt/data/Puppet/lib/puppet/transaction/event.rb:78:in `send_log''\r\n/mnt/data/Puppet/lib/puppet/transaction/resource_harness.rb:154:in `ensure in sync_if_needed''\r\n/mnt/data/Puppet/lib/puppet/transaction/resource_harness.rb:155:in `sync_if_needed''\r\n/mnt/data/Puppet/lib/puppet/transaction/resource_harness.rb:107:in `manage_via_ensure_if_possible''\r\n/mnt/data/Puppet/lib/puppet/transaction/resource_harness.rb:77:in `perform_changes''\r\n/mnt/data/Puppet/lib/puppet/transaction/resource_harness.rb:18:in `evaluate''\r\n/mnt/data/Puppet/lib/puppet/transaction.rb:174:in `apply''\r\n/mnt/data/Puppet/lib/puppet/transaction.rb:187:in `eval_resource''\r\n/mnt/data/Puppet/lib/puppet/transaction.rb:117:in `call''\r\n/mnt/data/Puppet/lib/puppet/transaction.rb:117:in `block (2 levels) in evaluate''\r\n/mnt/data/Puppet/lib/puppet/util.rb:327:in `block in thinmark''\r\n/usr/share/ruby/benchmark.rb:296:in `realtime''\r\n/mnt/data/Puppet/lib/puppet/util.rb:326:in `thinmark''\r\n/mnt/data/Puppet/lib/puppet/transaction.rb:117:in `block in evaluate''\r\n/mnt/data/Puppet/lib/puppet/graph/relationship_graph.rb:118:in `traverse''\r\n/mnt/data/Puppet/lib/puppet/transaction.rb:108:in `evaluate''\r\n/mnt/data/Puppet/lib/puppet/resource/catalog.rb:164:in `block in apply''\r\n/mnt/data/Puppet/lib/puppet/util/log.rb:153:in `with_destination''\r\n/mnt/data/Puppet/lib/puppet/transaction/report.rb:107:in `as_logging_destination''\r\n/mnt/data/Puppet/lib/puppet/resource/catalog.rb:163:in `apply''\r\n/mnt/data/Puppet/lib/puppet/indirector/resource/ral.rb:41:in `save''\r\n/mnt/data/Puppet/lib/puppet/indirector/indirection.rb:283:in `save''\r\n/mnt/data/Puppet/lib/puppet/application/resource.rb:219:in `find_or_save_resources''\r\n/mnt/data/Puppet/lib/puppet/application/resource.rb:143:in `main''\r\n/mnt/data/Puppet/lib/puppet/application.rb:376:in `run_command''\r\n/mnt/data/Puppet/lib/puppet/application.rb:367:in `block (3 levels) in run''\r\n/mnt/data/Puppet/lib/puppet/application.rb:474:in `plugin_hook''\r\n/mnt/data/Puppet/lib/puppet/application.rb:367:in `block (2 levels) in run''\r\n/mnt/data/Puppet/lib/puppet/util.rb:479:in `exit_on_fail''\r\n/mnt/data/Puppet/lib/puppet/application.rb:367:in `block in run''\r\n/mnt/data/Puppet/lib/puppet/context.rb:51:in `override''\r\n/mnt/data/Puppet/lib/puppet.rb:224:in `override''\r\n/mnt/data/Puppet/lib/puppet/application.rb:357:in `run''\r\n/mnt/data/Puppet/lib/puppet/util/command_line.rb:137:in `run''\r\n/mnt/data/Puppet/lib/puppet/util/command_line.rb:91:in `execute''\r\n/mnt/data/Puppet/bin/puppet:4:in `<top (required)>''\r\n/usr/local/share/gems/bin/puppet:23:in `load''\r\n/usr/local/share/gems/bin/puppet:23:in `<main>''\r\npackage { ''bash'':\r\n  ensure => ''4.2.45-1.fc19'',\r\n}\r\n{noformat}\r\n\r\nThis is with the following patch applied:\r\nEdit: Added patch as attachment as formatting was breaking it. ', 'https://tickets.puppetlabs.com/browse/PUP-1542', 'https://github.com/puppetlabs/puppet/pull/7225', '2014-01-29T14:05:59.000-0800', '2019-01-15T12:56:26.000-0800', '2019-01-15T12:56:26.000-0800', 'Closed', 'resolved-issue-added', 8, '0', 1, 21, 1, 2, '98d18fb904e8eebdc91d8155f3e23340e0795449'),
('puppet', 290583, 243172519, 7327, 'Puppet agent 6 ignores srv_domain config', '*Puppet Version: 6.1* \r\n *Puppet Server Version: 6.1*\r\n *OS Name/Version: Debian Stretch*\r\n\r\n*Desired Behavior:* \r\n\r\npuppet agent uses _srv_domain_ to resolve master from the domains srv record\r\n\r\n*Actual Behavior:*\r\n\r\nthe puppet agent ignores the srv_domain config in /etc/puppetlabs/puppet/puppet.conf\r\n\r\nusing the same config file with 5.5.8-1stretch is working fine.\r\n\r\nconfig set via:\r\n{code:java}/opt/puppetlabs/bin/puppet config set use_srv_records true\r\n/opt/puppetlabs/bin/puppet config set srv_domain idling.host{code}\r\nDebug log (puppet 6.1) => full log attached\r\n{code:java}Debug: Finishing transaction 47206392905540\r\nDebug: Runtime environment: puppet_version=6.1.0, ruby_version=2.5.3, run_mode=agent, default_encoding=UTF-8\r\nDebug: Dynamically-bound server lookup failed, falling back to ca_server setting\r\nDebug: Dynamically-bound port lookup failed; falling back to ca_port setting\r\nDebug: Searching for SRV records for domain: ca\r\nDebug: Found 0 SRV records for: _x-puppet._tcp.ca\r\nDebug: No more servers in SRV record, falling back to puppet:8140\r\nDebug: Creating new connection for https://puppet:8140\r\n{code}\r\nDebug log (puppet 5.5) => full log attached \r\n{code:java}Debug: Dynamically-bound server lookup failed, falling back to ca_server setting\r\nDebug: Dynamically-bound port lookup failed; falling back to ca_port setting\r\nDebug: Searching for SRV records for domain: idling.host\r\nDebug: Found 1 SRV records for: _x-puppet-ca._tcp.idling.host\r\nDebug: Yielding next server of master-a.idling.host:8140\r\nDebug: Dynamically-bound server lookup failed, falling back to ca_server setting\r\nDebug: Dynamically-bound port lookup failed; falling back to ca_port setting\r\nDebug: Searching for SRV records for domain: idling.host\r\nDebug: Found 1 SRV records for: _x-puppet-ca._tcp.idling.host\r\nDebug: Yielding next server of master-a.idling.host:8140\r\nDebug: Creating new connection for https://master-a.idling.host:8140\r\n{code}\r\nConfig file:\r\n{code:java}cat /etc/puppetlabs/puppet/puppet.conf \r\n[main]\r\nuse_srv_records = true\r\nsrv_domain = idling.host\r\n[agent]\r\nenvironment = setupscript\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9399', 'https://github.com/puppetlabs/puppet/pull/7327', '2019-01-05T00:20:26.000-0800', '2019-01-15T13:19:06.000-0800', '2019-01-15T13:19:06.000-0800', 'Closed', 'resolved-issue-added', 6, '0', 1, 2, 2, 2, 'd2350b35bcbbf1eea2076f571bea9c676485c442'),
('puppet', 274401, 244915169, 7336, 'Text Fragmentation: Incomplete phrases in string resources', 'Each String Resource should contain a complete phrase so that it can be localized.\r\n\r\nReviewing `puppet.pot` in Transifex (Localization Tool) reveals the following Text Fragmentation:\r\n{noformat}one of %{expected) are{noformat}\r\n{noformat}%{expected} is{noformat}\r\n \r\n\r\n*BAD_SLICE_KEY_TYPE*\r\n\r\n \r\n\r\nContent Source:\r\n * [https://github.com/puppetlabs/puppet/blob/master/locales/puppet.pot#L5096]\r\n * [https://github.com/puppetlabs/puppet/blob/master/locales/puppet.pot#L5100]\r\n\r\nPoint of Usage:\r\n * [https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/issues.rb#L433]\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9392', 'https://github.com/puppetlabs/puppet/pull/7336', '2018-09-05T13:48:54.000-0700', '2019-01-25T08:12:22.000-0800', '2019-01-25T08:12:22.000-0800', 'Closed', 'i18n;l10n', 29, '0', 2, 3, 4, 1, '3d08fa3044aa8b1302d751efb72e0a2f4c4aa90a'),
('puppet', 271574, 208872370, 7005, 'portage package provider does not respect package versions', 'The portage package provider does not respect versioning of packages, so one can''t define specific versions of packages to install via puppet agent.\r\n\r\nAs a result, on every run the puppet agent tries to install a specific version when another not defined version is installed, but effectively does only ensure that the package is installed via \r\n{code:java}\r\nemerge example/package\r\n{code}\r\nDesired should be that the agent installs the defined version via \r\n{code:java}\r\nemerge =example/package-1.2.3-r4{code}', 'https://tickets.puppetlabs.com/browse/PUP-9071', 'https://github.com/puppetlabs/puppet/pull/7005', '2018-08-16T07:05:26.000-0700', '2019-01-25T08:12:23.000-0800', '2019-01-25T08:12:23.000-0800', 'Closed', 'gentoo;linux;package;resolved-issue-added;type_and_provider', 3, '0', 1, 31, 6, 2, '2efbc17236271c012d0c6679d36bf30c130ab418'),
('puppet', 274737, 213896681, 7056, ':undef still shows up in types and providers', '*Puppet Version:* 5.5.6\r\n *Puppet Server Version:* N/A\r\n *OS Name/Version:* Centos 7, same on Windows 10\r\n\r\nPer the discussion in PUP-1467, all Ruby code in Types and Providers is supposed to receive {{undef}} values as {{nil}}. However, in at least some circumstances, I am receiving the Symbol {{:undef}} instead.\r\n\r\nFor example, given the following resource declaration:\r\n\r\n \r\n{code:java}foo { ''bar'':\r\n  baz => {\r\n    quux => undef,\r\n  },\r\n}\r\n{code}\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nInside the provider, {{resource[:baz]}} evaluates to {{\{''quux'' => nil\}}}\r\n\r\n*Actual Behavior:*\r\n\r\nInside the provider, {{resource[:baz]}} evaluates to {{\{''quux'' => :undef\}}}\r\n\r\n*Additional Context*\r\n\r\nBesides behaving contrary to the discussions in PUP-1467 (which is the closest I could find to documentation on {{:undef}} vs {{nil}}, this is also problematic when the provider is constructing JSON, perhaps to communicate with an API; the desired JSON string would be {{\{"quux": null\}}}, but instead you end up with {{\{"quux": "undef"\}}}.', 'https://tickets.puppetlabs.com/browse/PUP-9112', 'https://github.com/puppetlabs/puppet/pull/7056', '2018-09-06T16:16:34.000-0700', '2019-01-29T14:51:07.000-0800', '2019-01-29T14:51:07.000-0800', 'Closed', '', 3, '0', 1, 11, 10, 3, 'c8e945fed47cf5c1ba82074b1178d239bcb757e8'),
('puppet', 289056, 240316207, 7309, 'puppet module install is really slow', '*Puppet Version: 6.0.4*\r\n *Puppet Server Version: -*\r\n *OS Name/Version: Mac OS 10.14.1 (Probably all?)*\r\n\r\nWhen running a lot of beaker tests, i realized that most time is used by `puppet module install ...` commands.\r\n\r\n*Desired Behavior:*\r\n\r\nFast installation of module by using puppet module install ...\r\n\r\n*Actual Behavior:*\r\n{code:java} $ ls -la modules/\r\ntotal 0\r\ndrwxr-xr-x   2 mbaur staff   64 Dec 15 15:37 .\r\ndrwxr-xr-x+ 76 mbaur staff 2432 Dec 15 15:37 ..\r\nmbaur(2018-12-15 15:37:26)  ~\r\n$ time puppet module install puppetlabs-firewall -v 1.14.0 --modulepath $HOME/modules/\r\nNotice: Preparing to install into /Users/mbaur/modules ...\r\nNotice: Downloading from https://forgeapi.puppet.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/Users/mbaur/modules\r\n└─┬ puppetlabs-firewall (v1.14.0)\r\n  └── puppetlabs-stdlib (v5.1.0)real	0m26.044s\r\nuser	0m2.615s\r\nsys	0m1.211s{code}\r\n \r\n\r\nI think the biggest problem is, that the command posted above makes 8 API calls to forgeapi.puppet.com which just take way to long:\r\n\r\n\r\n{code:java}\r\n$ puppet module install puppetlabs-firewall -v 1.14.0 --modulepath $HOME/modules/ --debug | grep forgeapi\r\nNotice: Downloading from https://forgeapi.puppet.com ...\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/releases?module=puppetlabs-firewall&sort_by=version\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/releases?module=puppetlabs-firewall&sort_by=version&limit=20&offset=20\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version&limit=20&offset=20\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version&limit=20&offset=40\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version&limit=20&offset=60\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/files/puppetlabs-firewall-1.14.0.tar.gz\r\nDebug: HTTP GET https://forgeapi.puppet.com/v3/files/puppetlabs-stdlib-5.1.0.tar.gz\r\n{code}\r\nI tried to measure the data which gets transfer:\r\n{code:java}\r\nhttps://forgeapi.puppet.com/v3/releases?module=puppetlabs-firewall&sort_by=version -> 1.4M\r\nhttps://forgeapi.puppet.com/v3/releases?module=puppetlabs-firewall&sort_by=version&limit=20&offset=20 -> 621K\r\nhttps://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version -> 2.4M\r\nhttps://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version&limit=20&offset=20 -> 1.1M\r\nhttps://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version&limit=20&offset=40 -> 496K\r\nhttps://forgeapi.puppet.com/v3/releases?module=puppetlabs-stdlib&sort_by=version&limit=20&offset=60 -> 10K\r\nhttps://forgeapi.puppet.com/v3/files/puppetlabs-firewall-1.14.0.tar.gz -> 121K\r\nhttps://forgeapi.puppet.com/v3/files/puppetlabs-stdlib-5.1.0.tar.gz -> 242K\r\n\r\nComplete: 6.3M\r\n{code}\r\nI think there is just way to much data which we need to retrieve for every module.', 'https://tickets.puppetlabs.com/browse/PUP-9364', 'https://github.com/puppetlabs/puppet/pull/7309', '2018-12-15T06:55:48.000-0800', '2019-02-07T02:42:06.000-0800', '2019-02-07T02:42:06.000-0800', 'Closed', 'resolved-issue-added', 13, '0', 1, 8, 3, 2, '88257748691c8ac7ddc5baba3573be86c1f84b58'),
('puppet', 295084, 250769980, 7383, 'Unable to use call() on custom functions', 'Using custom functions, I''m unable to call them using the call() function.\r\n\r\nTest case:\r\n modules/call_me/functions/pfunction.pp\r\n{code:puppet}function call_me::pfunction(\r\n Optional[String] $args = undef\r\n) {\r\n "returned from pfunction"\r\n}\r\n{code}\r\ntest.pp;\r\n{code:puppet}  $message = call_me::pfunction()\r\n  notify {''direct function call'': message => $message, }\r\n\r\n\r\n  $deferred = Deferred(''call_me::pfunction'')\r\n  $message3 = $deferred.call()\r\n  notify {''deferred, function name hardcoded'': message => $message3, }  \r\n\r\n\r\n  $function_name = ''call_me::pfunction''\r\n  $deferred2 = Deferred($function_name)\r\n  $message4 = $deferred2.call()\r\n  notify {''deferred, function name in variable'': message => $message4, }\r\n{code}\r\noutput:\r\n{code} Info: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for cyberflox.irken.org\r\nInfo: Applying configuration version ''1549449374''\r\nNotice: returned from pfunction\r\nNotice: /Stage[main]/Main/Node[default]/Notify[direct function call]/message: defined ''message'' as ''returned from pfunction''\r\nNotice: returned from pfunction\r\nNotice: /Stage[main]/Main/Node[default]/Notify[deferred, function name hardcoded]/message: defined ''message'' as ''returned from pfunction''\r\nNotice: returned from pfunction\r\nNotice: /Stage[main]/Main/Node[default]/Notify[deferred, function name in variable]/message: defined ''message'' as ''returned from pfunction''\r\nNotice: Applied catalog in 0.02 seconds\r\n{code}\r\n\r\ncode that fails:\r\n\r\n{code}\r\n# THIS BLOCK FAILS\r\n$message2 = call(''call_me::pfunction'')\r\nnotify{''call(call_me::pfunction)'': message => $message2, }\r\n{code}\r\noutput:\r\n{code}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Function Call, Function call(): Unknown function: ''call_me::pfunction'' (file: /etc/puppetlabs/code/environments/production/manifests/site.pp, line: 9, column: 15) on node cyberflox.irken.org\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9477', 'https://github.com/puppetlabs/puppet/pull/7383', '2019-02-06T02:35:45.000-0800', '2019-02-20T11:51:30.000-0800', '2019-02-20T11:51:30.000-0800', 'Closed', 'resolved-issue-added', 4, '0', 2, 7, 1, 2, '2c79b5ae7f0def951d33374288e6ea5e00dab79c'),
('puppet', 278608, 219983095, 7138, 'REGRESSION exec cwd is not respected for unless or onlyif commands in 6.0.1', 'Since 6.0.1 there is a pretty severe regression which makes unless & onlyif of the exec resource not respecting the specified cwd.\r\n\r\nHere is the (shortened output of a run in 6.0.0:\r\n\r\n \r\n{code:java}\r\n$ puppet apply --debug <<EOF\r\nexec{''/usr/bin/pwd'':\r\n  onlyif    => ''/usr/bin/pwd'',\r\n  cwd       => ''/tmp'',\r\n  logoutput => true,\r\n}\r\nEOF\r\nDebug: Runtime environment: puppet_version=6.0.0, ruby_version=2.5.1, run_mode=user, default_encoding=UTF-8\r\n\r\n[...]\r\n\r\nInfo: Applying configuration version ''1538554714''\r\nDebug: Exec[/usr/bin/pwd](provider=posix): Executing check ''/usr/bin/pwd''\r\nDebug: Executing: ''/usr/bin/pwd''\r\nDebug: /Stage[main]/Main/Exec[/usr/bin/pwd]/onlyif: /tmp\r\nDebug: Exec[/usr/bin/pwd](provider=posix): Executing ''/usr/bin/pwd''\r\nDebug: Executing: ''/usr/bin/pwd''\r\nNotice: /Stage[main]/Main/Exec[/usr/bin/pwd]/returns: /tmp\r\nNotice: /Stage[main]/Main/Exec[/usr/bin/pwd]/returns: executed successfully\r\nDebug: /Stage[main]/Main/Exec[/usr/bin/pwd]: The container Class[Main] will propagate my refresh event{code}\r\n \r\n\r\nWhile this is the output from a 6.0.1 run:\r\n{code:java}\r\n\r\n $puppet apply --debug <<EOF\r\n> exec{''/usr/bin/pwd'':\r\n>   onlyif    => ''/usr/bin/pwd'',\r\n>   cwd       => ''/tmp'',\r\n>   logoutput => true,\r\n> }\r\n> EOF\r\nDebug: Runtime environment: puppet_version=6.0.1, ruby_version=2.5.1, run_mode=user, default_encoding=UTF-8\r\n\r\n[...]\r\n\r\nDebug: Exec[/usr/bin/pwd](provider=posix): Executing check ''/usr/bin/pwd''\r\nDebug: Executing: ''/usr/bin/pwd''\r\nDebug: /Stage[main]/Main/Exec[/usr/bin/pwd]/onlyif: /root\r\nDebug: Exec[/usr/bin/pwd](provider=posix): Executing ''/usr/bin/pwd''\r\nDebug: Executing: ''/usr/bin/pwd''\r\nNotice: /Stage[main]/Main/Exec[/usr/bin/pwd]/returns: /tmp\r\nNotice: /Stage[main]/Main/Exec[/usr/bin/pwd]/returns: executed successfully\r\nDebug: /Stage[main]/Main/Exec[/usr/bin/pwd]: The container Class[Main] will propagate my refresh event\r\n{code}\r\n \r\n\r\nThis is a pretty severe Regression as it breaks tons of existing execs, which might even trigger unwanted commands, as the safeguards are not working anymore.', 'https://tickets.puppetlabs.com/browse/PUP-9194', 'https://github.com/puppetlabs/puppet/pull/7138', '2018-10-03T01:24:53.000-0700', '2019-02-22T10:31:55.000-0800', '2019-02-22T10:31:55.000-0800', 'Closed', 'regression', 4, '0', 1, 11, 23, 2, 'c127bcb1f6b3d0a0e7b9122352162528fbb65b6c'),
('puppet', 293659, 249646774, 7379, 'Type validation fails when there is no type - needs human-readable error message', 'A class with an optional parameter with no type that defaults to undef isn''t handled well by /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/types/type_mismatch_describer.rb\r\n\r\nFor example if I have a class:\r\n{code:java}class test::validation (\r\n Optional $whatever = undef\r\n){\r\nnotice($whatever)\r\n \r\n}\r\n{code}\r\nand in hiera:\r\n{noformat}test::validation::whatever: 1234{noformat}\r\nApplying the class to an agent results in the stack trace I''ve attached here.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9467', 'https://github.com/puppetlabs/puppet/pull/7379', '2019-01-28T10:35:47.000-0800', '2019-03-14T06:22:22.000-0700', '2019-03-14T06:22:22.000-0700', 'Closed', 'resolved-issue-added', 6, '0', 2, 10, 1, 2, '08195e9d29d8101e36be506e74f8a698f47ac8bc'),
('puppet', 267161, 250890644, 7384, 'Filebucket resources fail when using server_list', '*Puppet Version:* \r\npuppet --version\r\n5.5.2\r\n\r\nFrom [~vchepkov]:\r\n\r\nIt (PUP-6823) might have fixed filebucket command, but not filebucket resource\r\nwith server setting removed as recommended here in step 4\r\nhttps://puppet.com/docs/pe/2018.1/configure_high_availability.html#enable-a-replica\r\n\r\n{noformat}\r\nError: Could not back up /etc/cron.d/yum-update: Failed to open TCP connection to puppet:8140 (getaddrinfo: Name or service not known)\r\nError: Could not back up /etc/cron.d/yum-update: Failed to open TCP connection to puppet:8140 (getaddrinfo: Name or service not known)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9025', 'https://github.com/puppetlabs/puppet/pull/7384', '2018-07-30T10:33:18.000-0700', '2019-03-26T17:19:11.000-0700', '2019-03-26T17:19:11.000-0700', 'Closed', 'resolved-issue-added', 10, '0', 2, 26, 15, 3, 'cdb9dba68223824d3408cc7edb66374520efc629'),
('puppet', 206346, 258831555, 7420, 'Puppet agent should not fall back to puppet:0 when servers in server_list are unreachable', 'Repro steps:\r\n* Install a puppet master\r\n* Remove ''server'' setting from puppet.conf\r\n* Add ''server_list'' setting to ''puppet.conf'' with the master hostname and a port that is unreachable - {hostname}:6666\r\n* Run puppet agent -t --debug\r\n\r\nResult:\r\n* You see the following in stdout:\r\n\r\n{code:java}\r\nDebug: Creating new connection for https://rjvrvpaz5nkmddc.delivery.puppetlabs.net:6666\r\nDebug: Using cached certificate_revocation_list for ca\r\nDebug: Starting connection for https://rjvrvpaz5nkmddc.delivery.puppetlabs.net:6666\r\nWarning: Could not select a functional puppet master\r\nDebug: Failed to load library ''msgpack'' for feature ''msgpack'': cannot load such file -- msgpack\r\nDebug: Puppet::Network::Format[msgpack]: feature msgpack is missing\r\nDebug: node supports formats: json pson yaml\r\nDebug: Creating new connection for *https://puppet:0*\r\nDebug: Starting connection for *https://puppet:0*\r\n{code}\r\n\r\nTrying to run against https://puppet:0 takes a while to time out due to TCP timeout (since DNS lookup fails).  Also, not sure of the impact but someone could potentially set up a server named puppet on the network and intercept all requests intended for the master in the case where the master is unavailable.\r\n\r\nExpected:\r\nWe should not be falling back to puppet:0', 'https://tickets.puppetlabs.com/browse/PUP-9076', 'https://github.com/puppetlabs/puppet/pull/7420', '2017-08-17T11:57:37.000-0700', '2019-03-26T17:19:11.000-0700', '2019-03-26T17:19:11.000-0700', 'Closed', 'resolved-issue-added', 9, '0', 1, 2, 3, 1, '2e24fb76c84c8604da3606967f69a0a29b85f265'),
('puppet', 291639, 244518722, 7334, 'Windows - Group resource member parameter outputs an array of SID''s instead of Names', '*Puppet Version: 5.5.8 (PE 2018.1.5)*\r\n *Puppet Server Version: 5.3.6*\r\n *OS Name/Version: Windows 2019*\r\n\r\nThis ticket has arisen from a support case where the customer had noticed that a custom fact of theirs that used the group resource parameter member no longer worked after upgrading from PE 2018.1.3 to 2018.1.5.\r\n\r\nAfter a quick repro and speaking with some of the devs, this looks like a regression issue. In 2018.1.3, member outputs names and in 2018.1.5 SID''s were outputted:\r\n\r\n2018.1.3 (Puppet 5.5.3) Group resource:\r\n{code:java}\r\ngroup { ''Users'':\r\n  ensure  => ''present'',\r\n  gid     => ''S-1-5-32-545'',\r\n  members => [''NT AUTHORITY\INTERACTIVE'', ''NT AUTHORITY\Authenticated Users'', ''PL2U24SBREN5JPS\sshd'', ''PL2U24SBREN5JPS\cyg_server''],\r\n{code}\r\n2018.1.5 (Puppet 5.5.8) Group resource:\r\n{code:java}\r\ngroup { ''Users'':\r\n  ensure  => ''present'',\r\n  gid     => ''S-1-5-32-545'',\r\n  members => [''S-1-5-4'', ''S-1-5-11'', ''S-1-5-21-1925060020-2411252292-4197056437-1000'', ''S-1-5-21-1925060020-2411252292-4197056437-1001''],\r\n{code}\r\n*Desired Behavior: Output of the Group Member parameter should be an array of Names and not SIDs.*\r\n\r\n*Actual Behavior: Currently an array of SID''s is outputted*', 'https://tickets.puppetlabs.com/browse/PUP-9435', 'https://github.com/puppetlabs/puppet/pull/7334', '2019-01-11T11:52:30.000-0800', '2019-03-26T17:19:16.000-0700', '2019-03-26T17:19:16.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 1, 23, 3, 3, 'd82634c9427e3cc343b06b00677c7c3b72b1c74d'),
('puppet', 296232, 261052579, 7426, 'Add Puppet::FileSystem#replace_file', 'Puppet''s {{Puppet::Util.replace_file}} predates {{Puppet::FileSystem}}. Now that we have different filesystem implementations (windows, posix, jruby), we should add a {{replace_file}} method and respective implementations. The new version should raise standard Errno exceptions. On Windows specifically, it shouldn''t leak Puppet::Util::Windows::Errors, as it forces the caller to have conditional logic as to which exceptions it may need to catch.', 'https://tickets.puppetlabs.com/browse/PUP-9499', 'https://github.com/puppetlabs/puppet/pull/7426', '2019-02-14T13:39:09.000-0800', '2019-03-26T17:24:34.000-0700', '2019-03-26T17:24:34.000-0700', 'Closed', 'resolved-issue-added', 2, '0', 5, 336, 31, 7, '164d031c166dfebfb02105dab756d154d0870f76'),
('puppet', 32897, 67217606, 4897, 'agent is confused about cert state', 'On my master, I set:\r\n\r\n{code}\r\n[main]\r\n  allow_duplicate_certs = true\r\n{code}\r\n\r\non the master, I regenerate a private key, I get the failure:\r\n\r\n{noformat}\r\nroot@cygnet-2:~# puppet agent -t --ssldir=/tmp/\r\ninfo: Creating a new SSL key for cygnet-2.cygnet.lab\r\nwarning: peer certificate won''t be verified in this SSL session\r\ninfo: Caching certificate for ca\r\nwarning: peer certificate won''t be verified in this SSL session\r\ninfo: Caching certificate for cygnet-2.cygnet.lab\r\nerr: Could not request certificate: The certificate retrieved from the master does not match the agent''s private key.\r\nCertificate fingerprint: B5:FE:4C:B6:D8:75:2C:8D:FD:05:48:53:43:DC:B4:10\r\nTo fix this, remove the certificate from both the master and the agent and then start a puppet run, which will automatically regenerate a certficate.\r\nOn the master:\r\n  puppet cert clean cygnet-2.cygnet.lab\r\nOn the agent:\r\n  rm -f /tmp/certs/cygnet-2.cygnet.lab.pem\r\n  puppet agent -t\r\n{noformat}\r\n\r\nIt appears that the agent does not actually resend its cert req if one already exists, meaning that allow duplicate certs does not work with puppet agent.\r\n\r\nThis issue was observed with Puppet 2.7.12, but I do not believe it is a regression.', 'https://tickets.puppetlabs.com/browse/PUP-2354', 'https://github.com/puppetlabs/puppet/pull/4897', '2014-04-23T12:39:10.000-0700', '2019-03-26T17:24:35.000-0700', '2019-03-26T17:24:35.000-0700', 'Closed', 'redmine;resolved-issue-added', 30, '0', 1, 3, 2, 1, ''),
('puppet', 259243, 193647538, 6873, 'Resource status of "failed_to_restart" is not included in reports for individual resources', 'If, for example, a service resource is notified that it should restart, and fails to do so, we do record this information in the resource status, but only partially expose it in the report.\r\n\r\nA {{failed_to_restart}} count is exposed in the metrics section:\r\n{noformat}\r\nmetrics:\r\n  resources:\r\n    name: resources\r\n    label: Resources\r\n    values:\r\n    - - total\r\n      - Total\r\n      - 10\r\n    - - skipped\r\n      - Skipped\r\n      - 0\r\n    - - failed\r\n      - Failed\r\n      - 0\r\n    - - failed_to_restart\r\n      - Failed to restart\r\n      - 1\r\n    - - restarted\r\n      - Restarted\r\n      - 0\r\n    - - changed\r\n      - Changed\r\n      - 1\r\n    - - out_of_sync\r\n      - Out of sync\r\n      - 1\r\n    - - scheduled\r\n      - Scheduled\r\n      - 0\r\n    - - corrective_change\r\n      - Corrective change\r\n      - 0\r\n{noformat}\r\n\r\nHowever, the individual resource that failed to restart does not have any information to indicate that it was the problem:\r\n{noformat}\r\n  Service[my_service]:\r\n    title: my_service\r\n    file: "/root/service_restart_failure/manifests/init.pp"\r\n    line: 30\r\n    resource: Service[my_service]\r\n    resource_type: Service\r\n    provider_used: init\r\n    containment_path:\r\n    - Stage[main]\r\n    - Service_restart_failure\r\n    - Service[my_service]\r\n    evaluation_time: 0.011004225\r\n    tags:\r\n    - service\r\n    - my_service\r\n    - class\r\n    - service_restart_failure\r\n    time: ''2018-06-05T10:53:57.237817957-07:00''\r\n    failed: false\r\n    changed: false\r\n    out_of_sync: false\r\n    skipped: false\r\n    change_count: 0\r\n    out_of_sync_count: 0\r\n    events: []\r\n    corrective_change: false\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8908', 'https://github.com/puppetlabs/puppet/pull/6873', '2018-06-06T07:51:51.000-0700', '2019-03-28T14:00:06.000-0700', '2019-03-28T14:00:06.000-0700', 'Closed', '', 11, '0', 2, 26, 3, 6, '61a898333cdb5bb6fe4a79147575a4f56f596f6d'),
('puppet', 287384, 236008598, 7270, 'Refreshed resources do not get a status event in the report', 'Refreshed resources, like reboot or some execs, do not create a status event in the report.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9339', 'https://github.com/puppetlabs/puppet/pull/7270', '2018-12-04T15:45:37.000-0800', '2019-03-28T20:14:47.000-0700', '2019-03-28T20:14:47.000-0700', 'Closed', 'resolved-issue-added', 2, '0', 1, 28, 4, 3, '004ddcdde642f899d3c4890b6d986098bf918bcd'),
('puppet', 174784, 120379576, 5866, 'Puppet Server uses facts from the previous run (n-1) after agent switches masters', 'I couldn''t believe that, but I could finally reliably reproduce the problem in minimal sample. I''ve observed that episodically and believe this is a long standing issue - the reason I do not put Critical to this.\r\n\r\nRuby fact plugin:\r\n{code:ruby}\r\nFacter.add(''fact_cache_issue'') do\r\n    setcode do\r\n        begin\r\n            File.read(''/etc/fact_cache_issue'')\r\n        rescue\r\n        end\r\n    end\r\nend\r\n{code}\r\n\r\nPuppet code:\r\n{code:puppet}\r\nclass factcacheissue {\r\n    $value = $::facts[''fact_cache_issue''] ? {\r\n        undef   => generate(''/usr/bin/openssl'', ''rand'', ''-hex'', ''8''),\r\n        default => $::facts[''fact_cache_issue'']\r\n    }\r\n    \r\n    file { ''/etc/fact_cache_issue'':\r\n        content => $value,\r\n    }\r\n}\r\nnode cacheissue.example.com {\r\n    include factcacheissue\r\n    file {''/etc/puppetlabs/puppet/puppet.conf'':\r\n        mode    => ''0644'',\r\n        content => ''\r\n[main]\r\nclient = false\r\ncertname = cacheissue.example.com\r\nserver = puppetback.example.com\r\nca_server = puppet.example.com\r\nenvironment = production\r\nsrv_domain = example.com\r\nuse_srv_records = false\r\n'',\r\n    }\r\n}\r\n{code}\r\n\r\n1. Setup puppet-agent 1.9.0 package\r\n2. Run against CA server puppet.example.com\r\n3. During the first initialization, openssl generator is called and puppet server is changed to secondary master (puppetback.example.com)\r\n4. Second run goes to secondary master. Master stores facts PuppetDB, but Master does not see new facts during catalog compilations => calls openssl generator again.\r\n5. Each next run uses fact set from run #n-1 - *that''s very weird*, and produces resource value switch to previous run.\r\n6. If puppet server is not switched then everything is correct.\r\n\r\n\r\nCommand line output:\r\n{noformat}\r\nSetting up puppet-agent (1.9.0-1jessie) ...\r\n\r\nConfiguration file ''/etc/puppetlabs/puppet/puppet.conf''\r\n ==> File on system created by you or by a script.\r\n ==> File also in package provided by package maintainer.\r\n ==> Using current old file as you requested.\r\nCreated symlink from /etc/systemd/system/multi-user.target.wants/puppet.service to /lib/systemd/system/puppet.service.\r\nCreated symlink from /etc/systemd/system/multi-user.target.wants/mcollective.service to /lib/systemd/system/mcollective.service.\r\nCreated symlink from /etc/systemd/system/multi-user.target.wants/pxp-agent.service to /lib/systemd/system/pxp-agent.service.\r\nRemoved symlink /etc/systemd/system/multi-user.target.wants/pxp-agent.service.\r\n+ PUPPET=/opt/puppetlabs/bin/puppet\r\n+ /opt/puppetlabs/bin/puppet resource service puppet ensure=false enable=false provider=systemd\r\nNotice: /Service[puppet]/enable: enable changed ''true'' to ''false''\r\nservice { ''puppet'':\r\n  ensure => ''stopped'',\r\n  enable => ''false'',\r\n}\r\n+ systemctl mask puppet\r\nCreated symlink from /etc/systemd/system/puppet.service to /dev/null.\r\n+ host maint.example.com\r\n+ /opt/puppetlabs/bin/puppet agent --test --trace\r\nInfo: Creating a new SSL key for cacheissue.example.com\r\nInfo: Caching certificate for ca\r\nInfo: csr_attributes file loading from /etc/puppetlabs/puppet/csr_attributes.yaml\r\nInfo: Creating a new SSL certificate request for cacheissue.example.com\r\nInfo: Certificate Request fingerprint (SHA256): DA:8A:E9:2C:01:A4:2B:B4:DA:28:66:89:8D:91:9B:4F:76:DF:62:4F:EA:A5:28:68:03:0B:20:92:03:01:70:01\r\nInfo: Caching certificate for cacheissue.example.com\r\nInfo: Caching certificate_revocation_list for ca\r\nInfo: Caching certificate for ca\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\n< output removed >\r\nNotice: /File[/opt/puppetlabs/puppet/cache/lib/facter/factcacheissue.rb]/ensure: defined content as ''{md5}7f09896f9c273cf29c2bb4d0cf21df27''\r\n< output removed >\r\nInfo: Loading facts\r\nInfo: Caching catalog for cacheissue.example.com\r\nInfo: Applying configuration version ''1486637068''\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/ensure: defined content as ''{md5}c3623b026f1e4ffaad7bc5f31dce5ddf''\r\nNotice: /Stage[main]/Main/Node[cacheissue.example.com]/File[/etc/puppetlabs/puppet/puppet.conf]/content: \r\n--- /etc/puppetlabs/puppet/puppet.conf  2017-02-09 10:44:08.044000000 +0000\r\n+++ /tmp/puppet-file20170209-954-g8w0cf 2017-02-09 10:44:28.616000000 +0000\r\n@@ -1,6 +1,9 @@\r\n+\r\n [main]\r\n client = false\r\n certname = cacheissue.example.com\r\n-server = puppet.example.com\r\n+server = puppetback.example.com\r\n ca_server = puppet.example.com\r\n environment = production\r\n+srv_domain = example.com\r\n+use_srv_records = false\r\n\r\nInfo: Computing checksum on file /etc/puppetlabs/puppet/puppet.conf\r\nInfo: /Stage[main]/Main/Node[cacheissue.example.com]/File[/etc/puppetlabs/puppet/puppet.conf]: Filebucketed /etc/puppetlabs/puppet/puppet.conf to puppet with sum 3f658fe9074501624c1ec8025cc03016\r\nNotice: /Stage[main]/Main/Node[cacheissue.example.com]/File[/etc/puppetlabs/puppet/puppet.conf]/content: content changed ''{md5}3f658fe9074501624c1ec8025cc03016'' to ''{md5}f48d1f4f1bfcb3d2b2a0678d7433fa04''\r\nNotice: /Stage[main]/Main/Node[cacheissue.example.com]/Service[mcollective]/enable: enable changed ''true'' to ''false''\r\nNotice: Applied catalog in 0.12 seconds\r\n+ echo ''Please go to puppetserver and exec the following command when we wait for key''\r\nPlease go to puppetserver and exec the following command when we wait for key\r\n+ echo ''> puppet cert sign cacheissue.example.com''\r\n> puppet cert sign cacheissue.example.com\r\n+ echo ''Use CTRL+C to stop cycle, if fails due to different reasons''\r\nUse CTRL+C to stop cycle, if fails due to different reasons\r\n+ sleep 5\r\n+ test -n 1\r\n+ exit 0\r\nConnection to 127.0.0.1 closed.\r\n+ echo ''Provisioning DB VMs''\r\nProvisioning DB VMs\r\n++ seq 1 2\r\n+ for i in ''$(seq 1 2)''\r\n+ for h in cacheissue\r\n+ puppet_deploy cacheissue\r\n+ local vm=cacheissue\r\n+ vagrant ssh cacheissue -- sudo /opt/puppetlabs/bin/puppet agent --test --trace\r\nsudo: unable to resolve host cacheissue.example.com\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for cacheissue.example.com\r\nInfo: Applying configuration version ''1486636987''\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: \r\n--- /etc/fact_cache_issue       2017-02-09 10:44:28.612000000 +0000\r\n+++ /tmp/puppet-file20170209-1058-3b631e        2017-02-09 10:44:40.932000000 +0000\r\n@@ -1 +1 @@\r\n-3069036cea991cba\r\n+f4956d526f3ea4b7\r\n\r\nInfo: Computing checksum on file /etc/fact_cache_issue\r\nInfo: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]: Filebucketed /etc/fact_cache_issue to puppet with sum c3623b026f1e4ffaad7bc5f31dce5ddf\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: content changed ''{md5}c3623b026f1e4ffaad7bc5f31dce5ddf'' to ''{md5}965e17e84e855e7355c3145ce89af6aa''\r\nNotice: Applied catalog in 0.10 seconds\r\n+ test 1 = 1\r\n+ for i in ''$(seq 1 2)''\r\n+ for h in cacheissue\r\n+ puppet_deploy cacheissue\r\n+ local vm=cacheissue\r\n+ vagrant ssh cacheissue -- sudo /opt/puppetlabs/bin/puppet agent --test --trace\r\nsudo: unable to resolve host cacheissue.example.com\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for cacheissue.example.com\r\nInfo: Applying configuration version ''1486636987''\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: \r\n--- /etc/fact_cache_issue       2017-02-09 10:44:40.980000000 +0000\r\n+++ /tmp/puppet-file20170209-1138-10kh2da       2017-02-09 10:44:46.904000000 +0000\r\n@@ -1 +1 @@\r\n-f4956d526f3ea4b7\r\n+3069036cea991cba\r\n\r\nInfo: Computing checksum on file /etc/fact_cache_issue\r\nInfo: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]: Filebucketed /etc/fact_cache_issue to puppet with sum 965e17e84e855e7355c3145ce89af6aa\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: content changed ''{md5}965e17e84e855e7355c3145ce89af6aa'' to ''{md5}c3623b026f1e4ffaad7bc5f31dce5ddf''\r\nNotice: Applied catalog in 0.10 seconds\r\n\r\nroot@cacheissue:~# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for cacheissue.example.com\r\nInfo: Applying configuration version ''1486636987''\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: \r\n--- /etc/fact_cache_issue       2017-02-09 10:44:46.948000000 +0000\r\n+++ /tmp/puppet-file20170209-1243-snbll1        2017-02-09 10:45:34.544000000 +0000\r\n@@ -1 +1 @@\r\n-3069036cea991cba\r\n+f4956d526f3ea4b7\r\n\r\nInfo: Computing checksum on file /etc/fact_cache_issue\r\nInfo: FileBucket got a duplicate file {md5}c3623b026f1e4ffaad7bc5f31dce5ddf\r\nInfo: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]: Filebucketed /etc/fact_cache_issue to puppet with sum c3623b026f1e4ffaad7bc5f31dce5ddf\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: content changed ''{md5}c3623b026f1e4ffaad7bc5f31dce5ddf'' to ''{md5}965e17e84e855e7355c3145ce89af6aa''\r\nNotice: Applied catalog in 0.09 seconds\r\nroot@cacheissue:~# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for cacheissue.example.com\r\nInfo: Applying configuration version ''1486636987''\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: \r\n--- /etc/fact_cache_issue       2017-02-09 10:45:34.580000000 +0000\r\n+++ /tmp/puppet-file20170209-1312-20p13j        2017-02-09 10:45:46.756000000 +0000\r\n@@ -1 +1 @@\r\n-f4956d526f3ea4b7\r\n+3069036cea991cba\r\n\r\nInfo: Computing checksum on file /etc/fact_cache_issue\r\nInfo: FileBucket got a duplicate file {md5}965e17e84e855e7355c3145ce89af6aa\r\nInfo: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]: Filebucketed /etc/fact_cache_issue to puppet with sum 965e17e84e855e7355c3145ce89af6aa\r\nNotice: /Stage[main]/Factcacheissue/File[/etc/fact_cache_issue]/content: content changed ''{md5}965e17e84e855e7355c3145ce89af6aa'' to ''{md5}c3623b026f1e4ffaad7bc5f31dce5ddf''\r\nNotice: Applied catalog in 0.09 seconds\r\n\r\n{noformat}\r\n\r\n\r\nPuppetServer log:\r\n{noformat}\r\n2017-02-09 10:43:04,412 INFO  [qtp1584394027-67] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:43:07,118 INFO  [qtp1584394027-64] [puppetserver] Puppet ''replace_facts'' command for cacheissue.example.com submitted to PuppetDB with UUID 319bb70e-ef88-4c9b-82ee-1ed9828b107c\r\n2017-02-09 10:43:07,390 INFO  [qtp1584394027-64] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:43:08,167 INFO  [qtp1584394027-64] [puppetserver] Puppet Compiled catalog for cacheissue.example.com in environment production in 0.74 seconds\r\n2017-02-09 10:43:08,167 INFO  [qtp1584394027-64] [puppetserver] Puppet Caching catalog for cacheissue.example.com\r\n2017-02-09 10:43:08,197 INFO  [qtp1584394027-64] [puppetserver] Puppet ''replace_catalog'' command for cacheissue.example.com submitted to PuppetDB with UUID b4d21d85-04ce-4c73-828c-348fab7869a5\r\n2017-02-09 10:43:08,415 INFO  [qtp1584394027-65] [puppetserver] Puppet ''store_report'' command for cacheissue.example.com submitted to PuppetDB with UUID 6a80a4fc-e692-418a-8564-bbafe5eed76e\r\n2017-02-09 10:44:38,593 INFO  [qtp1584394027-69] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:44:41,399 INFO  [qtp1584394027-66] [puppetserver] Puppet ''replace_facts'' command for cacheissue.example.com submitted to PuppetDB with UUID c412c520-aa29-49f8-b91c-f97382f6ac09\r\n2017-02-09 10:44:41,602 INFO  [qtp1584394027-66] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:44:41,688 WARN  [qtp1584394027-66] [puppetserver] Puppet Class ''settings'' is already defined; cannot redefine at :\r\n2017-02-09 10:44:41,728 WARN  [qtp1584394027-66] [c.p.p.ShellUtils] Executed an external process which logged to STDERR: f4956d526f3ea4b7\r\n\r\n2017-02-09 10:44:41,773 INFO  [qtp1584394027-66] [puppetserver] Puppet Compiled catalog for cacheissue.example.com in environment production in 0.09 seconds\r\n2017-02-09 10:44:41,774 INFO  [qtp1584394027-66] [puppetserver] Puppet Caching catalog for cacheissue.example.com\r\n2017-02-09 10:44:41,856 INFO  [qtp1584394027-66] [puppetserver] Puppet ''replace_catalog'' command for cacheissue.example.com submitted to PuppetDB with UUID 4bbea8ed-b9ed-442e-90a4-289aaf27c991\r\n2017-02-09 10:44:42,087 INFO  [qtp1584394027-67] [puppetserver] Puppet ''store_report'' command for cacheissue.example.com submitted to PuppetDB with UUID 981f4e68-c97a-4c21-8c58-ad629ddf5ad0\r\n2017-02-09 10:44:45,460 INFO  [qtp1584394027-65] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:44:47,539 INFO  [qtp1584394027-68] [puppetserver] Puppet ''replace_facts'' command for cacheissue.example.com submitted to PuppetDB with UUID dd30a8f1-cb79-4a5e-9bad-4b6fbb0286e9\r\n2017-02-09 10:44:47,692 INFO  [qtp1584394027-68] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:44:47,739 WARN  [qtp1584394027-68] [puppetserver] Puppet Class ''settings'' is already defined; cannot redefine at :\r\n2017-02-09 10:44:47,790 INFO  [qtp1584394027-68] [puppetserver] Puppet Compiled catalog for cacheissue.example.com in environment production in 0.05 seconds\r\n2017-02-09 10:44:47,790 INFO  [qtp1584394027-68] [puppetserver] Puppet Caching catalog for cacheissue.example.com\r\n2017-02-09 10:44:47,825 INFO  [qtp1584394027-68] [puppetserver] Puppet ''replace_catalog'' command for cacheissue.example.com submitted to PuppetDB with UUID 29abc7d5-738a-4da2-a452-3f94a39491f2\r\n2017-02-09 10:44:48,717 INFO  [qtp1584394027-69] [puppetserver] Puppet ''store_report'' command for cacheissue.example.com submitted to PuppetDB with UUID 12cfc770-3e6f-47ff-bf19-909687ca0a1e\r\n2017-02-09 10:45:32,811 INFO  [qtp1584394027-67] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:45:35,168 INFO  [qtp1584394027-64] [puppetserver] Puppet ''replace_facts'' command for cacheissue.example.com submitted to PuppetDB with UUID 9b0fbc3f-4c9a-48b3-a9ec-46717c332139\r\n2017-02-09 10:45:35,351 INFO  [qtp1584394027-64] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:45:35,398 WARN  [qtp1584394027-64] [puppetserver] Puppet Class ''settings'' is already defined; cannot redefine at :\r\n2017-02-09 10:45:35,434 INFO  [qtp1584394027-64] [puppetserver] Puppet Compiled catalog for cacheissue.example.com in environment production in 0.04 seconds\r\n2017-02-09 10:45:35,435 INFO  [qtp1584394027-64] [puppetserver] Puppet Caching catalog for cacheissue.example.com\r\n2017-02-09 10:45:35,464 INFO  [qtp1584394027-64] [puppetserver] Puppet ''replace_catalog'' command for cacheissue.example.com submitted to PuppetDB with UUID a73829e8-750a-4d97-ae3a-b4e4f9a6e358\r\n2017-02-09 10:45:35,687 INFO  [qtp1584394027-65] [puppetserver] Puppet ''store_report'' command for cacheissue.example.com submitted to PuppetDB with UUID 45b2d1e3-a077-4f43-8ce0-73f26873f18b\r\n2017-02-09 10:45:45,053 INFO  [qtp1584394027-69] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:45:47,384 INFO  [qtp1584394027-66] [puppetserver] Puppet ''replace_facts'' command for cacheissue.example.com submitted to PuppetDB with UUID 6c60b22b-86df-4850-85c2-555d898833b1\r\n2017-02-09 10:45:47,567 INFO  [qtp1584394027-66] [puppetserver] Puppet Caching node for cacheissue.example.com\r\n2017-02-09 10:45:47,619 WARN  [qtp1584394027-66] [puppetserver] Puppet Class ''settings'' is already defined; cannot redefine at :\r\n2017-02-09 10:45:47,660 INFO  [qtp1584394027-66] [puppetserver] Puppet Compiled catalog for cacheissue.example.com in environment production in 0.04 seconds\r\n2017-02-09 10:45:47,660 INFO  [qtp1584394027-66] [puppetserver] Puppet Caching catalog for cacheissue.example.com\r\n2017-02-09 10:45:47,684 INFO  [qtp1584394027-66] [puppetserver] Puppet ''replace_catalog'' command for cacheissue.example.com submitted to PuppetDB with UUID 35a46c71-b074-421a-99b6-405d1a718f65\r\n2017-02-09 10:45:47,950 INFO  [qtp1584394027-67] [puppetserver] Puppet ''store_report'' command for cacheissue.example.com submitted to PuppetDB with UUID f7c2cb6a-5968-4c97-93bf-85d530cbb5f9\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7198', 'https://github.com/puppetlabs/puppet/pull/5866', '2017-02-09T04:40:49.000-0800', '2019-03-29T15:58:20.000-0700', '2019-03-29T15:58:20.000-0700', 'Closed', 'resolved-issue-added', 26, '0', 9, 334, 239, 10, '95e8f459230bd901779369e50b0759991be4e19a'),
('puppet', 179394, 172335746, 6695, 'Group resource (with auth_membership) fails if local Windows group contains not resolvable Domain accounts', 'After leaving a Domain Windows systems may still contain not resolvable domain accounts inside local groups, i.e. in *Administrators* group: \r\n\r\n!local_administrators_group_with_former_domain_object.png|thumbnail!\r\n\r\nWhen trying to manage this group using *auth_membership => true* (to ensure all not resolvable domain user accounts are tidied to only have the local user *Administrator* inside the local *Administrators* group), Puppet will fail:\r\n\r\n{code:puppet}\r\ngroup {''Administrators'': \r\n    members => [''Administrator''], \r\n    auth_membership => true \r\n}\r\n{code}\r\n\r\nTested with the following Puppet Apply command:\r\n\r\n\r\n{code}\r\npuppet apply -e "group {''Administrators'': members => [''Administrator''], auth_membership => true }\r\n{code}\r\n\r\n\r\n{code:puppet}\r\nError: Could not resolve name: S-1-5-21-776561741-1409082233-725345543-15784\r\nError: /Stage[main]/Main/Group[Administrators]/members: change from TEST-WIN2012\Administrator,S-1-5-21-776561741-1409082233-725345543-15784 to TEST-WIN2012\Administrator failed: Could not resolve name: S-1-5-21-776561741-1409082233-725345543-15784\r\n{code}\r\n\r\n\r\n!puppet_apply_example.png|thumbnail!\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7326', 'https://github.com/puppetlabs/puppet/pull/6695', '2017-03-09T05:57:06.000-0800', '2019-04-04T19:42:52.000-0700', '2019-04-04T19:42:52.000-0700', 'Closed', 'windows', 11, '0', 1, 19, 18, 2, '64209e4b6a5afe0456cb3730e3f019e187bd3a52'),
('puppet', 142380, 78935257, 5147, 'hiera_include() fails when compiling an environment catalog', 'Currently, the hiera_include() function fails if called during environment catalog compilation. Because the suggested way to use hiera_include() is to place it at topscope outside any node/site blocks, it will always be called for environment compilation and will fail when the expected key isn''t found. Since hiera_include() doesn''t actually make sense for the environment catalog and is unlikely to be configured, it will basically _always_ fail. The function ought to noop during environment compilation, so as to allow users to adopt the direct change workflow without having to first modify how they classify their nodes.', 'https://tickets.puppetlabs.com/browse/PUP-6527', 'https://github.com/puppetlabs/puppet/pull/5147', '2016-07-20T09:22:30.000-0700', '2019-04-04T22:10:36.000-0700', '2019-04-04T22:10:36.000-0700', 'Closed', '', 10, '0', 1, 22, 1, 2, '06b283dc52196e6e0b709496e627c935982c324b'),
('puppet', 96722, 44168890, 4216, 'app_management feature switch has no effect when running under puppet-server', 'When running the master under puppet-server, setting {{app_management}} in {{puppet.conf}} has no effect, because {{Puppet::Pops::Parser::Lexer2}} is loaded before {{Puppet[:app_management]}} has been properly initialized. Therefore, the lexer always behaves as if app mgmt was turned off.\r\n\r\nThe proximate cause for this is that puppet-server''s {{puppet/server/master.rb}}, which is loaded as one of the first things when a JRuby container is initialized, loads {{puppet/info_service}} before loading the Puppet config. The {{info_service}} in turn instantiates a compiler, and things go sideways from there.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5197', 'https://github.com/puppetlabs/puppet/pull/4216', '2015-09-03T14:13:09.000-0700', '2019-04-04T22:10:36.000-0700', '2019-04-04T22:10:36.000-0700', 'Closed', '', 3, '0', 1, 37, 28, 6, '65e8b20c3eb06173db83d8cecbb87d3d4e53aecd'),
('puppet', 141339, 79830865, 5166, 'CapabilityFinder says a capability couldn''t be found if there are multiple versions of it', 'If two versions of a capability resource exist and neither corresponds to the code-id being compiled, the CapabilityFinder will fail with an error saying the resource couldn''t be found and might not have been produced yet. This is inaccurate, since it was in fact produced multiple times and the real problem is that it''s not clear which one to use. This message should be updated to better reflect that reality.', 'https://tickets.puppetlabs.com/browse/PUP-6497', 'https://github.com/puppetlabs/puppet/pull/5166', '2016-07-12T16:34:55.000-0700', '2019-04-04T22:10:37.000-0700', '2019-04-04T22:10:37.000-0700', 'Closed', '', 5, '0', 1, 35, 17, 3, 'ccf5377b45ece43360ec8e9ae64f0ca26d8433cc'),
('puppet', 160489, 93197435, 5371, 'variables_refreshed_each_compilation test can fail uptime comparisons', 'The {{variables_refreshed_each_compilation}} acceptance test can fail when the uptime seconds that the test is comparing happen are for strings where the earlier uptime is lexicographically later than the later uptime.  For example, this test failed in the puppetserver pipeline [here|https://jenkins.puppetlabs.com/view/puppetserver/view/all/job/platform_puppetserver_integration-system_no-conditional_full-stable/LAYOUT=ubuntu1604-64ma-32a,LDAP_TYPE=default,label=beaker/263/testReport/junit/(root)/ruby_puppet_acceptance_tests_environment/variables_refreshed_each_compilation_rb/] with the following console output:\r\n\r\n{noformat}\r\n\r\njubzk4qxrpdh8r2.delivery.puppetlabs.net (ubuntu1604-32-2) 03:09:15$ puppet agent -t --server ks6npbjxt60nblz.delivery.puppetlabs.net --environment variables_refreshed_each_compilation_nmjw1l2b\r\n...\r\n        Notice: local_9999_local\r\n\r\njubzk4qxrpdh8r2.delivery.puppetlabs.net (ubuntu1604-32-2) 03:09:19$ puppet agent -t --server ks6npbjxt60nblz.delivery.puppetlabs.net --environment variables_refreshed_each_compilation_nmjw1l2b\r\n...\r\n        Notice: local_10002_local\r\n\r\nWarning: \r\n      uptime did not change\r\n{noformat}\r\n\r\nThe assertions are made from [here|https://github.com/puppetlabs/puppet/blob/52208ac4637f8b81a7e0d895be2cd9805647c70f/acceptance/tests/environment/variables_refreshed_each_compilation.rb#L65-L66].  The values of the variables being compared are strings.  In this case though a string value of "9999" would be lexicographically greater than a string value of "10002", so the test fails.  The test should be changed to do numeric comparisons of the uptimes in order to avoid the problem.', 'https://tickets.puppetlabs.com/browse/PUP-6911', 'https://github.com/puppetlabs/puppet/pull/5371', '2016-11-10T09:35:13.000-0800', '2019-04-04T22:12:15.000-0700', '2019-04-04T22:12:15.000-0700', 'Closed', '', 2, '0', 1, 4, 4, 1, 'b1ded787d5ed1235fdc6e20e5e7c79ac42eb66f4'),
('puppet', 72135, 32256786, 3768, 'add acceptance for hash and array lookup()', 'include the full stack of global hiera, environment, and module data. \r\n\r\nThe hiera_include function is simple, it looks up ''classes'' and then loops over them to include those. If an acceptance test correctly looks up (global, env, module) then hiera_include should work (tested with an integration test). \r\n', 'https://tickets.puppetlabs.com/browse/PUP-4239', 'https://github.com/puppetlabs/puppet/pull/3768', '2015-03-18T10:58:39.000-0700', '2019-04-04T22:12:16.000-0700', '2019-04-04T22:12:16.000-0700', 'Closed', '', 5, '0', 1, 48, 4, 1, '91161fdcf5b5f516cb376515e7fde7bbb4dc3622'),
('puppet', 135615, 75720859, 5073, 'Acceptance: unpin run order for service_enable_linux test', 'Currently, the [service_enable_linux acceptance test|https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/resource/service/service_enable_linux.rb] explicitly define the run order for start and kill scripts. At this point in time, this pinning is causing the test to fail on test instances of sles 11 and 12 running on s390x.\r\n\r\nThe run order should be unpinned in the test to ensure that differences in services on SUTs do not cause the test to fail.\r\n\r\nThis situation is similar to the failure seen on PUP-6228', 'https://tickets.puppetlabs.com/browse/PUP-6390', 'https://github.com/puppetlabs/puppet/pull/5073', '2016-06-06T11:56:42.000-0700', '2019-04-04T22:12:17.000-0700', '2019-04-04T22:12:17.000-0700', 'Closed', '', 2, '0', 1, 5, 32, 1, '77ad642caee9bbef687ac95c846c2ab9d7ea174d'),
('puppet', 69476, 33503482, 3835, 'AIO acceptance tests copies multiple versions of repo configs to the SUT', 'Puppet has an install_repos_on method (separate from beaker) that scp''s repo configs from builds.puppetlabs.lan to the coordinator node, and then scp''s them to the SUT(s). The problem is that it copies more than the SHA being tested. For example, on an agent node:\r\n\r\n{noformat}\r\n# find /root/puppet-agent\r\n.\r\n./puppetlabs-release-el-7.noarch.rpm\r\n./pl-puppet-agent-71aa130dc8e2931d75b218abd1308386e462b24c-el-7-x86_64.repo\r\n./x86_64\r\n./x86_64/puppet-agent-0.3.2.27.g3a63b02-1.el7.x86_64.rpm\r\n./x86_64/puppet-agent-0.3.2.59.g7f9eb57-1.el7.x86_64.rpm\r\n./x86_64/puppet-agent-0.3.2.61.g4c11bc2-1.el7.x86_64.rpm\r\n./x86_64/puppet-agent-0.3.2.63.ge907309-1.el7.x86_64.rpm\r\n./x86_64/puppet-agent-0.3.2.65.gbc00b6e-1.el7.x86_64.rpm\r\n./x86_64/puppet-agent-0.3.2.78.g32bfbf9-1.el7.x86_64.rpm\r\n./x86_64/puppet-agent-0.3.2.89.g71aa130-1.el7.x86_64.rpm\r\n{noformat}\r\n\r\nIdeally, the method should not be transferring repo_configs to the coordinator, e.g. when trying to run acceptance tests over the VPN. If it transferred repo configs directly to the SUT then we wouldn''t have multiple versions of repo configs.\r\n\r\nAt a minimum it should only transfer the repo configs for the SHA that is being tested.\r\n\r\nRisk assessment N/A for test framework\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4044', 'https://github.com/puppetlabs/puppet/pull/3835', '2015-02-25T21:58:27.000-0800', '2019-04-04T22:12:26.000-0700', '2019-04-04T22:12:26.000-0700', 'Closed', 'AIO_TechDebt', 9, '0', 2, 16, 52, 1, 'c26fdc7767cf3be5b9149546eb316fa79a21d80e'),
('puppet', 84364, 37604022, 4029, '"testdir" incorrectly used in ''calling_all_functions'' acceptance test', 'The {{.../parser_functions/calling_all_functions.rb}} test fails when run against the Puppet Server acceptance pipeline:\r\n\r\nhttp://jenkins-enterprise.delivery.puppetlabs.net/view/puppet-server/view/all/job/enterprise_puppet-server_integration-system_no-conditional_full-master/11/LAYOUT=redhat7-64ma-windows2008r2-64a,LDAP_TYPE=default,PLATFORM=default,label=beaker/testReport/junit/(root)/ruby_puppet_acceptance_tests_parser_functions/calling_all_functions_rb/\r\n\r\nHere is a snippet of a failure:\r\n\r\n{noformat}\r\n * Apply manifest containing all function calls\r\n\r\nepylfol3z8f3sp6.delivery.puppetlabs.net (redhat7-64-1) 18:12:51$ mktemp -t apply_manifest.pp.XXXXXX\r\n/tmp/apply_manifest.pp.JjmyR4\r\n\r\nepylfol3z8f3sp6.delivery.puppetlabs.net (redhat7-64-1) executed in 0.01 seconds\r\nlocalhost $ scp /tmp/beaker20150611-5801-2vsc7d redhat7-64-1:/tmp/apply_manifest.pp.JjmyR4 {:ignore => }\r\n\r\nepylfol3z8f3sp6.delivery.puppetlabs.net (redhat7-64-1) 18:12:51$ puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.JjmyR4\r\nNotice: Compiled catalog for epylfol3z8f3sp6.delivery.puppetlabs.net in environment production in 0.43 seconds\r\nError: Parameter path failed on File[C:/cygwin64/tmp/calling_all_functions.bnPlZa]: File paths must be fully qualified, not ''C:/cygwin64/tmp/calling_all_functions.bnPlZa'' at /tmp/apply_manifest.pp.JjmyR4:4\r\n\r\nepylfol3z8f3sp6.delivery.puppetlabs.net (redhat7-64-1) executed in 1.35 seconds\r\nExited: 1\r\n#<Beaker::Host::CommandFailure: Host ''epylfol3z8f3sp6.delivery.puppetlabs.net'' exited with 1 running:\r\n puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.JjmyR4\r\nLast 10 lines of output were:\r\n	Notice: Compiled catalog for epylfol3z8f3sp6.delivery.puppetlabs.net in environment production in 0.43 seconds\r\n	Error: Parameter path failed on File[C:/cygwin64/tmp/calling_all_functions.bnPlZa]: File paths must be fully qualified, not ''C:/cygwin64/tmp/calling_all_functions.bnPlZa'' at /tmp/apply_manifest.pp.JjmyR4:4>\r\n{noformat}\r\n\r\nIn this case, the SUT in which the puppet apply is being run is a redhat7 node but the file path being used in the manifest is for Windows - C:/cygwin64/...  I believe this is due to a problem with how {{testdir}} is defined in the test.  {{testdir}} is redefined as each agent is iterated over:\r\n\r\n{code:ruby}\r\ntestdir   = ''''\r\ngenerator = ''''\r\nagents.each do |agent|\r\n  testdir = agent.tmpdir(''calling_all_functions'')\r\n  if agent["platform"] =~ /win/\r\n    generator = {:args => ''"c:/windows/system32/tasklist.exe"'', :expected => /\nImage Name/}\r\n  else\r\n    generator = {:args => ''"/bin/date"'',                        :expected => /\w\w\w.*?\d\d:\d\d\:\d\d/}\r\n  end\r\nend\r\n{code}\r\n\r\n... and is then referenced in the {{module_manifest}} definition later:\r\n\r\n{code:ruby}\r\nmodule_manifest = <<PP\r\nFile {\r\n  ensure => directory,\r\n}\r\nfile {\r\n  ''#{testdir}'':;\r\n  ''#{testdir}/environments'':;\r\n...\r\n{code}\r\n\r\nThe manifest is then applied during a separate loop over the agents:\r\n\r\n{code:ruby}\r\nagents.each do |agent|\r\n  apply_manifest_on(agent, module_manifest, :catch_failures => true)\r\n...\r\n{code}\r\n\r\nThe {{testdir}} here would seem to no longer have the same value as would be appropriate for each agent under test per OS that may be exercised in the agent list.  It would seem that this test would need to be reworked to only loop over the agents once and use the same value derived for {{testdir}} throughout all of the steps exercised for each agent in turn.', 'https://tickets.puppetlabs.com/browse/PUP-4749', 'https://github.com/puppetlabs/puppet/pull/4029', '2015-06-12T00:29:22.000-0700', '2019-04-04T22:12:28.000-0700', '2019-04-04T22:12:28.000-0700', 'Closed', '', 13, '0', 1, 70, 73, 1, '351c6d76bb7205aa4035d0f5b8d7174cfd569dd9'),
('puppet', 76026, 34215909, 3871, 'Add acceptance test that 3.x forbidden env names work in 4.x', 'In getting rid of setting the modulepath and manifest on our masters and setting up environmentpath, we didn''t get the memo that ''master'' was now a forbidden environment name (as documented here: https://docs.puppetlabs.com/puppet/latest/reference/environments_classic.html#setting-up-environments-on-a-puppet-master ). Figured it out eventually.\r\n\r\nIt would be great if puppet server/master error''d or warn''d when this happens as puppet will now ignore the master environment; but gives no indication that this is happening. In running the server and client with debug and verbose the only clue you get is:\r\n\r\nDebug: Warning: calling Plugins.search with empty module path.\r\n\r\nIt would also be good to error/warn if someone sets ''environment = master'' in the puppet.conf as that is no longer going to work (or at least, won''t work with environmentpath set).\r\n\r\nJust hoping to save someone else the troubleshooting effort.', 'https://tickets.puppetlabs.com/browse/PUP-4413', 'https://github.com/puppetlabs/puppet/pull/3871', '2015-04-14T23:02:55.000-0700', '2019-04-04T22:12:31.000-0700', '2019-04-04T22:12:31.000-0700', 'Closed', '', 11, '0', 1, 66, 0, 1, '606ecdafaee2a363fc42de1a0a569e49edddacc3'),
('puppet', 32379, 26520664, 3438, 'Solaris acceptance tests assume puppet is on the path', 'The solaris acceptance tests assume they can use {{on host, "puppet ..."}}. This fails when the test suite is run against puppet enterprise, since PE is not in the path on solaris. The tests should be updated to use Beaker''s {{puppet()}} helper\r\n\r\n./acceptance/tests/resource/package/ips/basic_tests.rb\r\n./acceptance/tests/resource/package/ips/should_create.rb\r\n./acceptance/tests/resource/package/ips/should_query.rb\r\n./acceptance/tests/resource/service/smf_basic_tests.rb\r\n./acceptance/tests/resource/service/smf_should_query.rb\r\n./acceptance/tests/resource/zfs/should_query.rb\r\n./acceptance/tests/resource/zpool/basic_tests.rb\r\n./acceptance/tests/resource/zpool/should_query.rb\r\n./acceptance/tests/security/cve-2013-1640_facter_string.rb\r\n./acceptance/tests/ticket_3360_allow_duplicate_csr_with_option_set.rb\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2307', 'https://github.com/puppetlabs/puppet/pull/3438', '2014-04-18T15:42:12.000-0700', '2019-04-04T22:12:32.000-0700', '2019-04-04T22:12:32.000-0700', 'Closed', '', 2, '0', 1, 29, 29, 12, 'e02005f830cfb8821fe9aa3297fc7ab304601a35'),
('puppet', 87931, 42199602, 4150, 'user and group acceptance tests fail on OSX', 'Several user and group acceptance tests fail on OSX because the test uses {{getent}} to setup the preconditions for the test. The tests should be updated to work on OSX\r\n\r\nUsing beaker 2.15.0:\r\n\r\n{noformat}\r\n$ be rake ci:test:aio SUITE_VERSION=1.1.1.250.gb9e1783 SHA=b9e178350dd52c75ab98ffd05e9bc739d7609155 CONFIG=config/nodes/osx-1010-x86_64.yaml TESTS=tests/ticket_9862_puppet_runs_without_service_user_or_group_present.rb,tests/resource/group,tests/resource/user\r\n...\r\n  Test Case tests/ticket_9862_puppet_runs_without_service_user_or_group_present.rb reported: #<Beaker::Host::CommandFailure: Host ''sxmv4xxp7it66t6.delivery.puppetlabs.net'' exited with 1 running:\r\n find "/opt/puppetlabs/puppet/cache" -user existinguser\r\nLast 10 lines of output were:\r\n	find: -user: existinguser: no such user>\r\n  Test Case tests/resource/group/should_modify_gid.rb reported: #<Beaker::Host::CommandFailure: Host ''sxmv4xxp7it66t6.delivery.puppetlabs.net'' exited with 127 running:\r\n getent group pl391975\r\nLast 10 lines of output were:\r\n	sh: getent: command not found>\r\n  Test Case tests/resource/user/should_create.rb reported: #<Minitest::Assertion: failed to get group pl588776>\r\n  Test Case tests/resource/user/should_create_with_gid.rb reported: #<Beaker::Host::CommandFailure: Host ''sxmv4xxp7it66t6.delivery.puppetlabs.net'' exited with 127 running:\r\n getent group gp775423 || groupadd gp775423\r\nLast 10 lines of output were:\r\n	sh: getent: command not found\r\n	sh: groupadd: command not found>\r\n  Test Case tests/resource/user/should_modify_gid.rb reported: #<Beaker::Host::CommandFailure: Host ''sxmv4xxp7it66t6.delivery.puppetlabs.net'' exited with 127 running:\r\n getent group pl51979old\r\nLast 10 lines of output were:\r\n	sh: getent: command not found>\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-4824', 'https://github.com/puppetlabs/puppet/pull/4150', '2015-07-07T14:14:47.000-0700', '2019-04-04T22:12:35.000-0700', '2019-04-04T22:12:35.000-0700', 'Closed', '', 3, '0', 1, 8, 8, 2, '7e8231fdd9df2990a98364e723f635a70de82810'),
('puppet', 53098, 22392877, 3167, '''mount'' resource with list of mount options only applies the first option', 'When creating a mount resource with a list of mount option, puppet appears to only add the first option to /etc/fstab.\r\n\r\nUsing the attached manifest and iso file, asking for these options:\r\n{noformat}\r\noptions => [''loop'', ''exec'', ''nouser'']\r\n{noformat}\r\nthe fstab entry looks like this:\r\n{noformat}/tmp/testimage.iso	/tmp/mount_point	iso9660	loop	0	0{noformat}\r\nmissing the second 2 options.\r\n\r\nIf you move ''loop'' into the second position,\r\n{noformat}options => [''exec'', ''loop'', ''nouser'']{noformat}\r\nThe puppet run fails, complaining it wasn''t able to mount the .iso, even suggesting that ''loop'' be added as an option\r\n\r\n{noformat}\r\nExecution of ''/bin/mount /tmp/mount_point'' returned 32: mount: /tmp/testimage.iso is not a block device (maybe try `-o loop''?)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3373', 'https://github.com/puppetlabs/puppet/pull/3167', '2014-09-30T15:37:32.000-0700', '2019-04-04T22:12:38.000-0700', '2019-04-04T22:12:38.000-0700', 'Closed', '', 7, '0', 1, 4, 3, 1, '6afbf3375df4c151c2ec8fa9f96ccc2a8ae7e781'),
('puppet', 46593, 26344319, 3429, 'tests/modules/install/with_version.rb assumes `puppet` is on the path', '{{tests/modules/install/with_version.rb}} assumes that the puppet command is on the default PATH. It is not when we are deploying puppet-enterprise (and would not be when we deploy Windows tests using MSIs)\r\n\r\nThis should use the beaker {{puppet}} helper, even though we probably need to fight with it a little to make it work right in this case', 'https://tickets.puppetlabs.com/browse/PUP-3016', 'https://github.com/puppetlabs/puppet/pull/3429', '2014-08-05T14:24:25.000-0700', '2019-04-04T22:12:40.000-0700', '2019-04-04T22:12:40.000-0700', 'Closed', 'tests;windows', 4, '0', 1, 4, 14, 1, 'e41709e3ecf0a1dc09c30130b9c370567daf69d9'),
('puppet', 70626, 33208252, 3814, 'The environment_scenario-* acceptance tests aren''t asserting their success/failure and are therefore always ''passing''', 'These tests were written to collect results rather than failing early, so that they could be reviewed at once.\r\n\r\nWhen we broke up the stable:acceptance/tests/environment/directory.rb into master:acceptance/tests/environment/environment_scenario-*.rb subtests, we forgot to ensure that the tests make a final assertion that the results are either all passing or all failing.\r\n\r\nThe final assertion call that is missing is an:\r\n\r\nassert_review(results) call at the end of the test (using the lib/puppet/acceptance/environment_utils.rb helper)\r\n\r\nThey are currently failures in these tests that are being masked by this.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4111', 'https://github.com/puppetlabs/puppet/pull/3814', '2015-03-06T14:41:11.000-0800', '2019-04-04T22:12:40.000-0700', '2019-04-04T22:12:40.000-0700', 'Closed', '', 6, '0', 1, 14, 15, 6, 'eeb90b7e6d3cc1b6651a9d3120f29d2c08263914'),
('puppet', 61550, 0, 0, 'resource/service/should_not_change_the_system should only run on agents', '', 'https://tickets.puppetlabs.com/browse/PUP-3769', 'https://github.com/puppetlabs/puppet/commit/d0fefa517b7a9e1fa51acc01f206e25485917bd6', '2014-12-15T16:38:40.000-0800', '2019-04-04T22:12:41.000-0700', '2019-04-04T22:12:41.000-0700', 'Closed', '', 6, '0', 0, 0, 0, 0, 'd0fefa517b7a9e1fa51acc01f206e25485917bd6'),
('puppet', 160026, 92659694, 5364, 'sensitive_data_type test errantly testing beaker log instead of syslog output', 'The sensitive_data_type test attempts to make some assertions that sensitive data is absent from the syslog file but instead makes those assertions agains the beaker log itself.  This causes the assertions to fail when the test matrix includes more than one agent node since the sensitive data is present in the beaker log itself after the first agent run is performed.\r\n\r\nThis is causing the sensitive_data_type test to fail in the puppetserver CI pipeline, where both an agent on the master and an agent in a separate node are run together - see https://jenkins.puppetlabs.com/job/platform_puppetserver_integration-system_no-conditional_full-stable/255/LAYOUT=debian8-64ma-32a,LDAP_TYPE=default,label=beaker/testReport/junit/(root)/ruby_puppet_acceptance_tests_language/sensitive_data_type_rb/.  The test is failing during the "assert no redacted data in syslog" step for the second agent. \r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6898', 'https://github.com/puppetlabs/puppet/pull/5364', '2016-11-07T12:19:32.000-0800', '2019-04-04T22:12:46.000-0700', '2019-04-04T22:12:46.000-0700', 'Closed', '', 2, '0', 2, 44, 7, 1, 'f02cf0809a5c60101c7399c5ae554dfc325a147d'),
('puppet', 73986, 32274611, 3771, 'source_attribute acceptance test failing intermittently', 'The source_attribute test was modified (in PUP-3974) to wait for time to pass\r\nsufficient that touching source files on the master would cause puppet\r\nagent runs to resync the files. However, the test only checked\r\nmtime/ctime on the master - which is unrelated to ctime/mtime of the\r\ntarget files on the agents - and the agent target files are what will be\r\ncompared to the ctime/mtime of the source file to see if they need to be\r\nresynced.\r\n\r\nWe could fix this by iterating over the agents - or assuming they''ll\r\nalways be done in order and only querying the last agent - to check the\r\nctime/mtime stats of the target files using puppet resource file <filename>, but that''s more complicated and unlikely to be\r\nsignificantly less than the 1 second sleep we used to have.\r\n\r\nRevert to the previous behavior of waiting 1 second to touch the files\r\nand try resyncing.', 'https://tickets.puppetlabs.com/browse/PUP-4340', 'https://github.com/puppetlabs/puppet/pull/3771', '2015-03-30T16:28:04.000-0700', '2019-04-04T22:12:48.000-0700', '2019-04-04T22:12:48.000-0700', 'Closed', '', 3, '0', 1, 5, 8, 1, '1f1e935073d8dbf319fe4ff09555797b19886581'),
('puppet', 159952, 92626342, 5363, 'Agents mishandled in pcore_generate and corrective_change tests', 'The "pcore_generate_env_isolation.rb" and "corrective_change_via_puppet.rb" tests both fail when run in a CI matrix which includes two agents - e.g., an agent run on the master and an agent run against the master from a separate node.  In both cases, the failures appear to be due to the tests changing state in the middle of the test causing a second agent to see an unexpected result.\r\n\r\nThis failure was encountered when bumping to the latest Puppet stable commit on the puppetserver CI pipeline: https://jenkins.puppetlabs.com/view/puppetserver/view/all/job/platform_puppetserver_integration-system_no-conditional_full-stable/255/.  Some snippets of the failures for each test are below:\r\n\r\npcore_generate_env_isolation.rb:\r\n\r\n{noformat}\r\n* run agent in environment with type with an extra parameter. try to use this parameter\r\n      \r\n      yet7cniwbcy64sf.delivery.puppetlabs.net (debian8-32-2) 03:11:33$ puppet agent -t --server vjl5yrswgh4uoj9.delivery.puppetlabs.net --environment pcore_generate_env_isolation_to4sbyrx\r\n        Info: Using configured environment ''pcore_generate_env_isolation_to4sbyrx''\r\n        Info: Retrieving pluginfacts\r\n        Info: Retrieving plugin\r\n        Notice: /File[/opt/puppetlabs/puppet/cache/lib/puppet/type/conflicting.rb]/content: \r\n        --- /opt/puppetlabs/puppet/cache/lib/puppet/type/conflicting.rb	2016-11-07 03:11:32.664804843 -0800\r\n        +++ /tmp/puppet-file20161107-23935-3e6p0b	2016-11-07 03:11:35.780896287 -0800\r\n        @@ -1,3 +1,4 @@\r\n             Puppet::Type.newtype(:conflicting) do\r\n               newparam :name, :namevar => true\r\n        +      newparam :other\r\n             end\r\n        Notice: /File[/opt/puppetlabs/puppet/cache/lib/puppet/type/conflicting.rb]/content: content changed ''{md5}a0c85d30454a7c39614e8c798da69769'' to ''{md5}d501df2ec6cba932d67ea737f6880d0b''\r\n        Info: Caching catalog for yet7cniwbcy64sf.delivery.puppetlabs.net\r\n        Info: Applying configuration version ''1478517096''\r\n        Notice: pcore_generate_env_isolation_to4sbyrx\r\n        Notice: /Stage[main]/Main/Notify[pcore_generate_env_isolation_to4sbyrx]/message: defined ''message'' as ''pcore_generate_env_isolation_to4sbyrx''\r\n        Notice: Applied catalog in 0.04 seconds\r\n      \r\n      yet7cniwbcy64sf.delivery.puppetlabs.net (debian8-32-2) executed in 3.08 seconds\r\n      Exited: 2\r\n      Warning: \r\ndid not produce environment isolation issue as expected.\r\nExpected /Error:\ no\ parameter\ named\ ''other''/ to match "\e[0;32mInfo: Using configured environment ''pcore_generate_env_isolation_to4sbyrx''\e[0m\n\e[0;32mInfo: Retrieving pluginfacts\e[0m\n\e[0;32mInfo: Retrieving plugin\e[0m\n\e[mNotice: /File[/opt/puppetlabs/puppet/cache/lib/puppet/type/conflicting.rb]/content: \n--- /opt/puppetlabs/puppet/cache/lib/puppet/type/conflicting.rb\t2016-11-07 03:11:32.664804843 -0800\n+++ /tmp/puppet-file20161107-23935-3e6p0b\t2016-11-07 03:11:35.780896287 -0800\n@@ -1,3 +1,4 @@\n     Puppet::Type.newtype(:conflicting) do\n       newparam :name, :namevar => true\n+      newparam :other\n     end\n\e[0m\n\e[mNotice: /File[/opt/puppetlabs/puppet/cache/lib/puppet/type/conflicting.rb]/content: content changed ''{md5}a0c85d30454a7c39614e8c798da69769'' to ''{md5}d501df2ec6cba932d67ea737f6880d0b''\e[0m\n\e[0;32mInfo: Caching catalog for yet7cniwbcy64sf.delivery.puppetlabs.net\e[0m\n\e[0;32mInfo: Applying configuration version ''1478517096''\e[0m\n\e[mNotice: pcore_generate_env_isolation_to4sbyrx\e[0m\n\e[mNotice: /Stage[main]/Main/Notify[pcore_generate_env_isolation_to4sbyrx]/message: defined ''message'' as ''pcore_generate_env_isolation_to4sbyrx''\e[0m\n\e[mNotice: Applied catalog in 0.04 seconds\e[0m\n".\r\n{noformat}\r\n\r\ncorrective_change_via_puppet.rb:\r\n\r\n{noformat}\r\n* Run agent a 2nd time to change the File resource\r\n            \r\n            u8wdlpr8mrxu3fq.delivery.puppetlabs.net (sles12-64-2) 03:29:08$ puppet agent -t --environment corrective_change_via_puppet_6y5ldjwa --server ititl6tmmhh7999.delivery.puppetlabs.net\r\n              Info: Using configured environment ''corrective_change_via_puppet_6y5ldjwa''\r\n              Info: Retrieving pluginfacts\r\n              Info: Retrieving plugin\r\n              Info: Caching catalog for u8wdlpr8mrxu3fq.delivery.puppetlabs.net\r\n              Info: Applying configuration version ''1478518148''\r\n              Notice: Applied catalog in 0.04 seconds\r\n            \r\n            u8wdlpr8mrxu3fq.delivery.puppetlabs.net (sles12-64-2) executed in 2.26 seconds\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) 03:29:10$ puppet master --configprint config\r\n              /etc/puppetlabs/puppet/puppet.conf\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) executed in 0.77 seconds\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) 03:29:11$ if [ -f ''/tmp/corrective_change_via_puppet.rb.JGkHGE/puppet.conf.bak'' ]; then cat ''/tmp/corrective_change_via_puppet.rb.JGkHGE/puppet.conf.bak'' > ''/etc/puppetlabs/puppet/puppet.conf''; rm -f ''/tmp/corrective_change_via_puppet.rb.JGkHGE/puppet.conf.bak''; fi\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) executed in 0.03 seconds\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) 03:29:11$ puppet resource service puppetserver ensure=stopped\r\n              Notice: /Service[puppetserver]/ensure: ensure changed ''running'' to ''stopped''\r\n              service { ''puppetserver'':\r\n                ensure => ''stopped'',\r\n              }\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) executed in 1.35 seconds\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) 03:29:12$ puppet resource service puppetserver ensure=running\r\n              Notice: /Service[puppetserver]/ensure: ensure changed ''stopped'' to ''running''\r\n              service { ''puppetserver'':\r\n                ensure => ''running'',\r\n              }\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) executed in 33.58 seconds\r\n            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) 03:29:46$ curl -m 1 https://localhost:8140\r\n              Trying command 60 times.\r\n            .            \r\n            ititl6tmmhh7999.delivery.puppetlabs.net (sles12-64-1) 03:29:46$ curl -m 1 https://localhost:8140 ostensibly successful.\r\n            RuntimeError: PuppetAcceptance::DSL::Helpers.with_puppet_running_on failed (check backtrace for location) because: Host ''u8wdlpr8mrxu3fq.delivery.puppetlabs.net'' exited with 0 running:\r\n             puppet agent -t --environment corrective_change_via_puppet_6y5ldjwa --server ititl6tmmhh7999.delivery.puppetlabs.net\r\n            Last 10 lines of output were:\r\n            	Info: Using configured environment ''corrective_change_via_puppet_6y5ldjwa''\r\n            	Info: Retrieving pluginfacts\r\n            	Info: Retrieving plugin\r\n            	Info: Caching catalog for u8wdlpr8mrxu3fq.delivery.puppetlabs.net\r\n            	Info: Applying configuration version ''1478518148''\r\n            	Notice: Applied catalog in 0.04 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-6897', 'https://github.com/puppetlabs/puppet/pull/5363', '2016-11-07T09:16:11.000-0800', '2019-04-04T22:12:54.000-0700', '2019-04-04T22:12:54.000-0700', 'Closed', '', 2, '0', 1, 15, 11, 2, '4b16d3d324e2eb2ca45a96719644c33e3674e829'),
('puppet', 81832, 37193111, 4012, 'environment_scenario test failures when master has agent role', 'When we upgraded the Puppet Server acceptance pipeline to using Puppet 4.1.0 / Puppet Agent 1.1.0, we started encountering some failures with the environment_scenario tests.  I believe these tests are not failing when run on the platform pipeline only because some of the test steps are only run when the agent under test resides on the master.  According to [~josh], the master has not been run with the agent role in the platform AIO pipeline for some time.\r\n\r\nAn example of one failing matrix is here:\r\n\r\nhttps://jenkins.puppetlabs.com/view/Puppet%20Server/view/All/job/platform_puppet-server_integration-system_no-conditional_full-master/64/#showFailuresLink\r\n\r\nNote that the same failures are occurring across all OSes under test.\r\n\r\nHere''s a quick analysis of what it looks to me that may be going on with the failures:\r\n\r\nh4. environment_scenario-bad.rb\r\n\r\nSame pattern like the one below for “puppet_config”, “puppet_apply”, “puppet_module_install”, and “puppet_module_uninstall”:\r\n\r\n{noformat}\r\n-------------------------------------------------------------------------------\r\npuppet_config: *UNEXPECTED FAILURE*\r\n-------------------------------------------------------------------------------\r\nExpected the output:\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/environments.rb:38:in `get!'': Could not find a directory environment named ''testing'' anywhere in the path: /doesnotexist. Does the directory exist? (Puppet::Environments::EnvironmentNotFound)\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application_support.rb:29:in `push_application_context''\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:337:in `run''\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:124:in `run''\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute''\r\n	from /opt/puppetlabs/bin/puppet:5:in `<main>''\r\n\r\nTo match: (?-mix:Could not find a directory environment named ''testing'' anywhere in the path.*\/etc\/puppetlabs\/code)\r\n{noformat} \r\n\r\nThe test sets the “environmentpath” in the “main” section of the puppet.conf file to “/doesnotexist” but the test appears to be failing because it expects the master’s “codedir” setting to appear in the message - “/etc/puppetlabs/code” - rather than the “environmentpath”.  The “environmentpath" actually seems to me like the right value to include in the message here.  I can reproduce this locally by just running “puppet config … —environment testing” (with no master involved).\r\n\r\nh4. environment_scenario-default.rb\r\n\r\nSame pattern like the one below for “puppet_config”, “puppet_module_install”, and “puppet_module_uninstall”.\r\n\r\n{noformat}\r\n-------------------------------------------------------------------------------\r\npuppet_config: *UNEXPECTED FAILURE*\r\n-------------------------------------------------------------------------------\r\nExpected the output:\r\nbasemodulepath = /etc/puppetlabs/code/modules:/opt/puppetlabs/puppet/modules\r\nmodulepath = /etc/puppetlabs/code/environments/production/modules:/etc/puppetlabs/code/modules:/opt/puppetlabs/puppet/modules\r\nmanifest = /etc/puppetlabs/code/environments/production/manifests\r\nconfig_version = \r\n\r\nTo match: (?-mix:manifest.*\/etc\/puppetlabs\/code\/environments\/\/manifests$)\r\nAnd match: (?-mix:modulepath.*\/etc\/puppetlabs\/code\/environments\/\/modules:.+)\r\n{noformat}\r\n\r\nIn each case, it appears that the test is expecting the target directory to not include a directory environment name where the result of the test does - i.e., “production”.  Where directory environments are mandated by default in Puppet v4, I wonder if this is just a case where the default expectation needs to include the “production” directory environment name.\r\n\r\nh4. environment_scenario-master_environmentpath.rb\r\n\r\nFor the “puppet_apply” test, the following output appeared:\r\n\r\n{noformat}\r\n-------------------------------------------------------------------------------\r\npuppet_apply: *UNEXPECTED FAILURE*\r\n-------------------------------------------------------------------------------\r\nExpected the output:\r\nNotice: Compiled catalog for fd7ncmpi1suilmb.delivery.puppetlabs.net in environment testing in 0.33 seconds\r\nNotice: include directory testing environment testing_mod\r\nNotice: /Stage[main]/Testing_mod/Notify[include directory testing environment testing_mod]/message: defined ''message'' as ''include directory testing environment testing_mod''\r\nNotice: Applied catalog in 0.08 seconds\r\n\r\nTo match: (?-mix:include default environment testing_mod)\r\n------\r\n{noformat}\r\n\r\nIt seems like the expectation that the output would use “default environment” is incorrect since the test is actually trying to use the “testing” directory environment.\r\n\r\n—\r\n\r\nFor the “puppet_module_install” test, the following output appeared:\r\n\r\n{noformat}\r\n-------------------------------------------------------------------------------\r\npuppet_module_install: *UNEXPECTED FAILURE*\r\n-------------------------------------------------------------------------------\r\nExpected the output:\r\nNotice: Preparing to install into /etc/puppetlabs/code/environments/testing/modules ...\r\nNotice: Downloading from https://forgeapi.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/etc/puppetlabs/code/environments/testing/modules\r\n└── pmtacceptance-nginx (v0.0.1)\r\n\r\nTo match: (?-mix:Preparing to install into \/etc\/puppetlabs\/code\/modules)\r\n------\r\nNotes: Runs in user mode and doesn''t see the master environmenetpath setting.\r\n{noformat}\r\n\r\nAgain, the expectation that the message does not include “…environments/testing” in the path seems wrong since the test is specifying that the “testing” directory environment be used.\r\n\r\n—\r\n\r\nFor the “puppet_module_uninstall” test, the following output appeared:\r\n\r\n{noformat}\r\n-------------------------------------------------------------------------------\r\npuppet_module_uninstall: *UNEXPECTED FAILURE*\r\n-------------------------------------------------------------------------------\r\nExpected the output:\r\nNotice: Preparing to uninstall ''pmtacceptance-nginx'' ...\r\nRemoved ''pmtacceptance-nginx'' (v0.0.1) from /etc/puppetlabs/code/environments/testing/modules\r\n\r\nTo match: (?-mix:Removed.*pmtacceptance-nginx.*from \/etc\/puppetlabs\/code\/modules)\r\n------\r\n{noformat}\r\n\r\nSame comment as above for the “puppet_module_install” test.\r\n\r\nh4. all tests\r\n\r\nIt appears that across all of these tests that there’s a problem in the test cleanup where the occurrence of a failure is causing the test to abort with a stack trace:\r\n\r\n{noformat}\r\n#<NoMethodError: undefined method `empty?'' for nil:NilClass>\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/ruby/puppet/acceptance/lib/puppet/acceptance/environment_utils.rb:355\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/ruby/puppet/acceptance/lib/puppet/acceptance/environment_utils.rb:354\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/ruby/puppet/acceptance/lib/puppet/acceptance/environment_utils.rb:354\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/ruby/puppet/acceptance/tests/environment/environment_scenario-bad.rb:53\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_case.rb:124\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_case.rb:124\r\n/usr/local/rvm/rubies/ruby-1.9.3-p484/lib/ruby/1.9.1/benchmark.rb:295\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_case.rb:121\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_suite.rb:286\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_suite.rb:283\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_suite.rb:283\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/test_suite.rb:325\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/cli.rb:151\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/lib/beaker/cli.rb:93\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/gems/beaker-2.12.0/bin/beaker:6\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/bin/beaker:23\r\n/var/lib/jenkins/workspace/platform_puppet-server_integration-system_no-conditional_full-master/LAYOUT/redhat6-64ma-64a/LDAP_TYPE/PLATFORM/label/beaker/vendor/bundler/ruby/1.9.1/bin/beaker:23\r\nUnstubbing address forge.puppetlabs.com to IP 10.32.23.69 on machine fd7ncmpi1suilmb.delivery.puppetlabs.net\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-4659', 'https://github.com/puppetlabs/puppet/pull/4012', '2015-05-27T12:22:56.000-0700', '2019-04-04T22:12:54.000-0700', '2019-04-04T22:12:54.000-0700', 'Closed', '', 7, '0', 2, 16, 19, 6, '6c95cc757dee999a6a4f035ff7cbafd773e50648'),
('puppet', 12697, 35359755, 3932, 'Signal traps are broken under ruby 2.0.0', 'Ruby 2.0.0 does not allow Puppet to call some signal handlers as we perform a lot of operations that are unsafe within the context of a signal trap. For example, anything that manipulates a mutex is off limits. This includes sending messages to Logger objects that are using mutexes internally:\n\n  http://www.mikeperham.com/2013/02/23/signal-handling-with-ruby/', 'https://tickets.puppetlabs.com/browse/PUP-202', 'https://github.com/puppetlabs/puppet/pull/3932', '2013-07-31T15:48:39.000-0700', '2019-04-04T22:12:59.000-0700', '2019-04-04T22:12:59.000-0700', 'Closed', 'qa-reviewed', 6, '0', 2, 77, 9, 6, '620757e389a2f47817356f9656e2c7653a958692'),
('puppet', 125599, 82051036, 5223, 'Test can pick random GID that collides with existing GID', 'The test {{acceptance/tests/resource/group/should_modify_gid.rb}} picks two random GIDs when creating a group and changing its GID. If the generated GID already exists, the test will fail to create an new group with the same GID or will fail to change that a group''s GID to a value already in use. To wit (from https://jenkins.puppetlabs.com/job/platform_puppet-server_integration-system_no-conditional_full-master/184/)\r\n{code}\r\nBegin ruby/puppet/acceptance/tests/resource/group/should_modify_gid.rb\r\n\r\nshould modify gid of existing group\r\n\r\n  * ensure that the group exists with gid 675492\r\n\r\nhem94kl8ueb74gd.delivery.puppetlabs.net (debian8-64-1) 07:30:42$ puppet resource group pl975867 ensure=present gid=675492\r\nNotice: /Group[pl975867]/ensure: created\r\ngroup { ''pl975867'':\r\n  ensure => ''present'',\r\n  gid    => ''675492'',\r\n}\r\n\r\nhem94kl8ueb74gd.delivery.puppetlabs.net (debian8-64-1) executed in 1.22 seconds\r\n\r\n  * ensure that we can modify the GID of the group to 34\r\n\r\nhem94kl8ueb74gd.delivery.puppetlabs.net (debian8-64-1) 07:30:44$ puppet resource group pl975867 ensure=present gid=34\r\nError: Could not set gid on group[pl975867]: Execution of ''/usr/sbin/groupmod -g 34 pl975867'' returned 4: groupmod: GID ''34'' already exists\r\nError: /Group[pl975867]/gid: change from 675492 to 34 failed: Could not set gid on group[pl975867]: Execution of ''/usr/sbin/groupmod -g 34 pl975867'' returned 4: groupmod: GID ''34'' already exists\r\ngroup { ''pl975867'':\r\n  ensure => ''present'',\r\n  gid    => ''675492'',\r\n}\r\n\r\nhem94kl8ueb74gd.delivery.puppetlabs.net (debian8-64-1) executed in 1.24 seconds\r\nWarning: \r\nmissing gid notice\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6141', 'https://github.com/puppetlabs/puppet/pull/5223', '2016-04-07T12:17:41.000-0700', '2019-04-04T22:13:00.000-0700', '2019-04-04T22:13:00.000-0700', 'Closed', '', 1, '0', 1, 20, 20, 13, '958c1f60d22350119eee5c812d5e75a53836b775'),
('puppet', 110006, 54032555, 4516, 'Problems with the "allow_duplicate_csr" acceptance test', 'In running Puppet acceptance tests locally with Beaker, I encountered a couple of problems with the {{ticket_3360_allow_duplicate_csr_with_option_set.rb}} test:\r\n\r\n1) {{assert_not_equal}} not found.\r\n\r\nHere''s a snippet of the failed output from one run:\r\n\r\n{noformat}\r\nTest Case ./ruby/puppet/acceptance/tests/ticket_3360_allow_duplicate_csr_with_option_set.rb reported: #<RuntimeError: PuppetAcceptance::DSL::Helpers.with_puppet_running_on failed (check backtrace for location) because: undefined method `assert_not_equal'' for #<Beaker::TestCase:0x007f97945fd218>\r\n./ruby/puppet/acceptance/tests/ticket_3360_allow_duplicate_csr_with_option_set.rb:48:in `block (3 levels) in run_test''\r\n{noformat}\r\n\r\nI don''t see a method called {{assert_not_equal}} in the version of minitest that we''re pulling in from the Gemfile, 5.8.3.  I saw that some other gems alias {{refute_equal}}, which does exist in {{minitest}} to {{assert_not_equal}} - e.g., {{nokogiri}}.  This makes me think that this failure may not occur in full Jenkins CI runs because code that implicitly sources the alias is being run first.  This seems dangerous, though, and that it might be better to just use {{refute_equals}} directly from this test.  AFAICT, no other Puppet acceptance test uses {{assert_not_equal}}.\r\n\r\n2) The test appears to have been written with the expectation that it will iterate through all of the agents setup for the test run, submitting duplicate csrs for each.  It doesn''t appear to take into account the pre-existence of other csrs in the ssldir, however, and could fail when those other csrs don''t change.\r\n\r\n3) The test always skips over the master node.  So if a node is configured with both the master and agent roles, it will skip that node entirely - meaning that the test essentially does nothing for a pipeline configured to do just the master and agent on a single node.\r\n\r\n4) The regex that the test uses to locate certs in the cert list doesn''t seem precise enough, leaving some csrs to be skipped over completely.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5625', 'https://github.com/puppetlabs/puppet/pull/4516', '2015-12-17T12:42:40.000-0800', '2019-04-04T22:13:02.000-0700', '2019-04-04T22:13:02.000-0700', 'Closed', 'qa-task', 0, '0', 1, 17, 8, 1, '544b8d67bd89dcc9506840ba567242ef3fe2805d'),
('puppet', 76858, 50632101, 4445, 'Cannot load ''provider/network_route/routes.rb''', 'I have a Puppet codebase that runs fine with 3.7 + webrick. Under Puppet 4 it gives the following error:\r\n{code}\r\n# /opt/puppetlabs/bin/puppet agent -t --server `hostname` --noop\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Error 400 on SERVER: Evaluation Error: Error while evaluating a Virtual Query, Could not autoload puppet/type/network_route: Could not autoload puppet/provider/network_route/routes: no such file to load -- puppetx/filemapper at /var/puppet/environments/production/modules/dec/manifests/profiles/soe_network.pp:25:43 on node host.domain.com\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run{code}\r\n\r\nThe mentioned code is as follows:\r\n{code}create_resources(network_config, hiera_hash(''network::interfaces'', {}))\r\ncreate_resources(network_route, hiera_hash(''network::routes'', {}))\r\n{code}\r\n\r\nUsing the following Puppet Forge module: https://github.com/puppet-community/puppet-network (which depends on https://forge.puppetlabs.com/adrien/filemapper).\r\n\r\nRunning against `puppetserver foreground --debug` the error (and giant stack trace) appears multiple times in the file, here''s the first occurrence:\r\n{code}2015-04-22 11:21:28,078 ERROR [qtp855067818-27] [puppet-server] Puppet Could not autoload puppet/provider/network_route/routes: no such file to load -- puppetx/filemapper\r\norg/jruby/RubyKernel.java:1071:in `require''\r\n/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/rubygems/core_ext/kernel_require.rb:55:in `require''\r\n/var/puppet/environments/production/modules/network/lib/puppet/provider/network_route/routes.rb:2:in `(root)''\r\norg/jruby/RubyKernel.java:1087:in `load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:1:in `(root)''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:59:in `load_file''\r\norg/jruby/RubyArray.java:1613:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:74:in `loadall''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:72:in `loadall''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:203:in `loadall''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/metatype/manager.rb:116:in `newtype''\r\norg/jruby/RubyKernel.java:1087:in `load''\r\n/var/puppet/environments/production/modules/network/lib/puppet/type/network_route.rb:3:in `(root)''\r\n{code}\r\n\r\nI can post the full log if required.\r\n\r\nCommenting out all references to these types in my .pp files makes the problem go away.', 'https://tickets.puppetlabs.com/browse/PUP-4450', 'https://github.com/puppetlabs/puppet/pull/4445', '2015-04-21T19:00:30.000-0700', '2019-04-04T22:16:48.000-0700', '2019-04-04T22:16:48.000-0700', 'Needs Information', 'needs_decision', 24, '0', 5, 27, 0, 1, ''),
('puppet', 190058, 123926862, 5944, 'data-in-modules: lookup() and automatic class parameter lookup result in different values', 'When using the new "data in modules" feature we see a strange inconsistent behaviour in automatic class parameter lookup. We can not say if it is a bug in lookup() or in the class parameter lookup code. \r\n\r\nTo reproduce I created a simple test case: \r\n\r\n* I created a module "mymodule"\r\n\r\n{noformat}\r\nmymodule/\r\n├── data\r\n│   ├── common.yaml\r\n│   └── role\r\n│       ├── role1.yaml\r\n│       └── role2.yaml\r\n├── enc.sh\r\n├── hiera.yaml\r\n├── lib\r\n│   └── facter\r\n│       └── test.rb\r\n└── manifests\r\n    └── init.pp\r\n\r\n6 directories, 9 files\r\n{noformat}\r\n\r\nContent of the files. \r\n\r\nhiera.yaml:\r\n{noformat}\r\n---\r\nversion: 5\r\ndefaults:\r\n  datadir: data\r\n  data_hash: yaml_data\r\n\r\nhierarchy:\r\n\r\n  - name: "Per-OS defaults"\r\n    path: "os/%{facts.os.family}.yaml"\r\n\r\n  - name: "Role Specific config"\r\n    mapped_paths: [role, tmp, "role/%{tmp}.yaml"]\r\n\r\n  - name: "Role Specific config (ENC)"\r\n    mapped_paths: [enc_role, tmp, "role/%{tmp}.yaml"]\r\n\r\n  - name: "Role Specific config (FACT)"\r\n    mapped_paths: [fact_role, tmp, "role/%{tmp}.yaml"]\r\n\r\n  - name: "Location Specific config"\r\n    mapped_paths: [location, tmp, "location/%{tmp}.yaml"]\r\n\r\n  - name: "Common data"\r\n    path: "common.yaml"\r\n{noformat}\r\n\r\ndata/role/role1.yaml:\r\n{noformat}\r\n---\r\nmymodule::plugins:\r\n  plugin_role1:\r\n    ensure: present\r\n{noformat}\r\n\r\ndata/role/role2.yaml:\r\n{noformat}\r\n---\r\nmymodule::plugins:\r\n  plugin_role2:\r\n    ensure: present\r\n{noformat}\r\n\r\ndata/common.yaml:\r\n{noformat}\r\n---\r\nmymodule::version: ''1.2.3-1''\r\nmymodule::plugins:\r\n  baseplugin1:\r\n    ensure: present\r\n    version: 1.2.3\r\n  baseplugin2:\r\n    ensure: present\r\n    version: 5.4.3\r\n{noformat}\r\n\r\nmanifests/init.pp:\r\n{noformat}\r\nclass mymodule (\r\n  Array $role     = [],\r\n  Array $location = [],\r\n  Hash $plugins   = {},\r\n  String $version = ''installed'',\r\n) {\r\n\r\n  $pattern = "%-30s: %s"\r\n\r\n  notice(sprintf("======= Config =========="))\r\n  notice(sprintf($pattern,"class param ''role''", $role))\r\n  notice(sprintf($pattern,"fact ''fact_role''", $facts[fact_role]))\r\n  notice(sprintf($pattern,"enc ''enc_role''", $enc_role))\r\n  notice(sprintf($pattern,"class param: ''version''", $version))\r\n  notice(sprintf("======= Data =========="))\r\n  notice(sprintf($pattern,"hiera", hiera("mymodule::plugins",{})))\r\n  notice(sprintf($pattern,"hiera_hash", hiera_hash("mymodule::plugins",{})))\r\n  notice(sprintf($pattern,"lookup", lookup("mymodule::plugins",Hash, ''deep'',{})))\r\n  notice(sprintf($pattern,"class param: ''plugins''", $plugins))\r\n}\r\n{noformat}\r\n\r\nlib/facter/test.rb:\r\n{noformat}\r\nFacter.add(:fact_role) do\r\n  setcode do\r\n    distid = Facter.value(:role_txt)\r\n    if distid.nil?\r\n      []\r\n    else\r\n      distid.split(/\s*,\s*/)\r\n    end\r\n  end\r\nend\r\n{noformat}\r\n\r\n* Now I run the class with different setups:\r\n** with direct class parameters (class { mymodule: role => role1 })\r\n** with ENC provided roles\r\n** with facter provided roles\r\n\r\nResult is:\r\n\r\n* lookup() result is always the same\r\n* hiera_*() does not work at all\r\n* class parameter work totally diffent dependent of the way to call, which needs explaining\r\n\r\nNormal Lookup without and variables (looks ok and as expected):\r\n\r\n{noformat}\r\nmymodule # puppet apply --modulepath ../ -e ''include mymodule'' --strict off\r\nNotice: Scope(Class[Mymodule]): ======= Config ==========\r\nNotice: Scope(Class[Mymodule]): class param ''role''            : []\r\nNotice: Scope(Class[Mymodule]): fact ''fact_role''              : []\r\nNotice: Scope(Class[Mymodule]): enc ''enc_role''                :\r\nNotice: Scope(Class[Mymodule]): class param: ''version''        : 1.2.3-1\r\nNotice: Scope(Class[Mymodule]): ======= Data ==========\r\nNotice: Scope(Class[Mymodule]): hiera                         : {}\r\nNotice: Scope(Class[Mymodule]): hiera_hash                    : {}\r\nNotice: Scope(Class[Mymodule]): lookup                        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}}\r\nNotice: Scope(Class[Mymodule]): class param: ''plugins''        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}}\r\n{noformat}\r\n\r\nNow with role selection in code (lookup OK, class parameter NOT):\r\n\r\n{noformat}\r\nmymodule # puppet apply --modulepath ../ -e ''class { mymodule: role => ["role1"] }'' --strict off\r\nNotice: Scope(Class[Mymodule]): ======= Config ==========\r\nNotice: Scope(Class[Mymodule]): class param ''role''            : ["role1"]\r\nNotice: Scope(Class[Mymodule]): fact ''fact_role''              : []\r\nNotice: Scope(Class[Mymodule]): enc ''enc_role''                :\r\nNotice: Scope(Class[Mymodule]): class param: ''version''        : 1.2.3-1\r\nNotice: Scope(Class[Mymodule]): ======= Data ==========\r\nNotice: Scope(Class[Mymodule]): hiera                         : {}\r\nNotice: Scope(Class[Mymodule]): hiera_hash                    : {}\r\nNotice: Scope(Class[Mymodule]): lookup                        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}, "plugin_role1"=>{"ensure"=>"present"}}\r\nNotice: Scope(Class[Mymodule]): class param: ''plugins''        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}}\r\n{noformat}\r\n\r\nNow with two roles in code (lookup OK, class parameter NOT):\r\n\r\n{noformat}\r\nmymodule # puppet apply --modulepath ../ -e ''class { mymodule: role => ["role1", "role2"] }'' --strict off\r\nNotice: Scope(Class[Mymodule]): ======= Config ==========\r\nNotice: Scope(Class[Mymodule]): class param ''role''            : ["role1", "role2"]\r\nNotice: Scope(Class[Mymodule]): fact ''fact_role''              : []\r\nNotice: Scope(Class[Mymodule]): enc ''enc_role''                :\r\nNotice: Scope(Class[Mymodule]): class param: ''version''        : 1.2.3-1\r\nNotice: Scope(Class[Mymodule]): ======= Data ==========\r\nNotice: Scope(Class[Mymodule]): hiera                         : {}\r\nNotice: Scope(Class[Mymodule]): hiera_hash                    : {}\r\nNotice: Scope(Class[Mymodule]): lookup                        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}, "plugin_role2"=>{"ensure"=>"present"}, "plugin_role1"=>{"ensure"=>"present"}}\r\nNotice: Scope(Class[Mymodule]): class param: ''plugins''        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}}\r\n{noformat}\r\n\r\nNow with ENC (lookup ok, class parameter again strange):\r\n\r\n{noformat}\r\nmymodule # ./enc.sh\r\n---\r\nparameters:\r\n  enc_role:\r\n    - role1\r\n    - role2\r\n\r\nshell # puppet apply --node_terminus=exec --external_nodes=$(pwd)/enc.sh --modulepath ../ -e ''include mymodule'' --strict off\r\nNotice: Scope(Class[Mymodule]): ======= Config ==========\r\nNotice: Scope(Class[Mymodule]): class param ''role''            : []\r\nNotice: Scope(Class[Mymodule]): fact ''fact_role''              : []\r\nNotice: Scope(Class[Mymodule]): enc ''enc_role''                : ["role1", "role2"]\r\nNotice: Scope(Class[Mymodule]): class param: ''version''        : 1.2.3-1\r\nNotice: Scope(Class[Mymodule]): ======= Data ==========\r\nNotice: Scope(Class[Mymodule]): hiera                         : {}\r\nNotice: Scope(Class[Mymodule]): hiera_hash                    : {}\r\nNotice: Scope(Class[Mymodule]): lookup                        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}, "plugin_role2"=>{"ensure"=>"present"}, "plugin_role1"=>{"ensure"=>"present"}}\r\nNotice: Scope(Class[Mymodule]): class param: ''plugins''        : {"plugin_role1"=>{"ensure"=>"present"}}\r\n{noformat}\r\n\r\nNow as FACT (lookup OK, class parameter STRANGE):\r\n\r\n{noformat}\r\nmymodule # FACTER_role_txt=role1,role2 puppet apply --modulepath ../ -e ''include mymodule'' --strict off\r\nNotice: Scope(Class[Mymodule]): ======= Config ==========\r\nNotice: Scope(Class[Mymodule]): class param ''role''            : []\r\nNotice: Scope(Class[Mymodule]): fact ''fact_role''              : ["role1", "role2"]\r\nNotice: Scope(Class[Mymodule]): enc ''enc_role''                :\r\nNotice: Scope(Class[Mymodule]): class param: ''version''        : 1.2.3-1\r\nNotice: Scope(Class[Mymodule]): ======= Data ==========\r\nNotice: Scope(Class[Mymodule]): hiera                         : {}\r\nNotice: Scope(Class[Mymodule]): hiera_hash                    : {}\r\nNotice: Scope(Class[Mymodule]): lookup                        : {"baseplugin1"=>{"ensure"=>"present", "version"=>"1.2.3"}, "baseplugin2"=>{"ensure"=>"present", "version"=>"5.4.3"}, "plugin_role2"=>{"ensure"=>"present"}, "plugin_role1"=>{"ensure"=>"present"}}\r\nNotice: Scope(Class[Mymodule]): class param: ''plugins''        : {"plugin_role1"=>{"ensure"=>"present"}}\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7515', 'https://github.com/puppetlabs/puppet/pull/5944', '2017-05-10T03:28:42.000-0700', '2019-04-04T22:17:26.000-0700', '2019-04-04T22:17:26.000-0700', 'Closed', '', 14, '0', 8, 63, 9, 8, 'f4515e82ebfe556f62ebc1b3d1c9a7728f387438'),
('puppet', 103812, 49389481, 4396, 'small improvements to module generator', '', 'https://tickets.puppetlabs.com/browse/PUP-5462', 'https://github.com/puppetlabs/puppet/pull/4396', '2015-11-01T18:29:21.000-0800', '2019-04-04T22:20:13.000-0700', '2019-04-04T22:20:13.000-0700', 'Closed', 'puppethack', 5, '0', 6, 11, 4, 3, '84ba6ae4ec7efa30897e91cebabce56463383e56'),
('puppet', 15954, 34169897, 3869, '(#22699) set value_collection for boolean params', 'I''m not entirely confident that this is the right way to test things, since it involves calling initvars.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-446', 'https://github.com/puppetlabs/puppet/pull/3869', '2013-10-01T12:14:33.000-0700', '2019-04-04T22:20:13.000-0700', '2019-04-04T22:20:13.000-0700', 'Closed', '', 2, '0', 1, 16, 3, 5, 'e0085ff42928edbd4c7fc86ef71bc0a219834077'),
('puppet', 71800, 32693878, 3787, 'File resources with defined content don''t output contents with ensure=>present', 'When creating a file resource with {{ensure=>present}} and specified contents, the specified contents aren''t logged:\r\n{noformat}\r\n[root@puppet-eli file]# rm -f /root/somefile\r\n[root@puppet-eli file]# puppet apply -e ''file { "/root/somefile": ensure=>present, content=>"hello" }''\r\nNotice: Compiled catalog for puppet-eli.localdomain in environment production in 0.12 seconds\r\nNotice: /Stage[main]/Main/File[/root/somefile]/ensure: created\r\nNotice: Finished catalog run in 0.26 seconds\r\n{noformat}\r\nBy contrast, here''s the log with {{ensure=>file}}:\r\n{noformat}\r\n[root@puppet-eli file]# rm -f /root/somefile\r\n[root@puppet-eli file]# puppet apply -e ''file { "/root/somefile": ensure=>file, content=>"hello" }''\r\nNotice: Compiled catalog for puppet-eli.localdomain in environment production in 0.11 seconds\r\nNotice: /Stage[main]/Main/File[/root/somefile]/ensure: defined content as ''{md5}5d41402abc4b2a76b9719d911017c592''\r\nNotice: Finished catalog run in 0.26 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-4231', 'https://github.com/puppetlabs/puppet/pull/3787', '2015-03-16T15:23:28.000-0700', '2019-04-04T22:20:15.000-0700', '2019-04-04T22:20:15.000-0700', 'Closed', '', 11, '0', 3, 68, 1, 1, 'd4be659b5a5a090d5ceefb0cc89e22c2822fdb87'),
('puppet', 35510, 35425843, 3934, 'Puppet::Agent::Locker#lock doesn''t return whether it acquired the lock or not', 'The [Puppet::Agent::Locker#lock|https://github.com/puppetlabs/puppet/blob/3.5.1/lib/puppet/agent/locker.rb] method documentation says {quote}Return true/false depending on whether we get the lock.{quote} But that''s not actually what happens. Instead it returns whatever the yielded block returns. As a result, there''s no way to know if the lock was successfully acquired:\r\n\r\n{code}\r\n  def lock\r\n    if lockfile.lock\r\n      begin\r\n        yield\r\n      ensure\r\n        lockfile.unlock\r\n      end\r\n    end\r\n  end\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2573', 'https://github.com/puppetlabs/puppet/pull/3934', '2014-05-14T13:03:17.000-0700', '2019-04-04T22:20:15.000-0700', '2019-04-04T22:20:15.000-0700', 'Closed', '', 3, '0', 2, 28, 25, 7, 'ce74cd97085c3d3bd7b4888c80bcbf14ebfdfa29'),
('puppet', 59857, 30394426, 3672, 'console format should pretty print nested structures', 'The code for the console format says it should pretty print, but it doesn''t in fact do that.\r\n\r\nQA\r\n--\r\nrisk: medium \r\nprobability: medium\r\nseverity: low\r\ntest layer: unit', 'https://tickets.puppetlabs.com/browse/PUP-3706', 'https://github.com/puppetlabs/puppet/pull/3672', '2014-11-26T07:35:53.000-0800', '2019-04-04T22:20:15.000-0700', '2019-04-04T22:20:15.000-0700', 'Closed', '', 3, '0', 1, 11, 5, 3, '31379951cb61c53d980d8c76f8eaf15c295565db'),
('puppet', 42620, 19327598, 2938, 'FileUtils implementation broke compare_stream', '{{FileUtils.compare_stream}} implementation in ruby 1.9.3 was doing something along the lines of\r\n\r\n{code:ruby}\r\n    a = b = nil\r\n    while something\r\n      a = as.read size\r\n      b = bs.read size\r\n      return false if a != b\r\n    end\r\n{code}\r\n\r\n{{FileUtils.compare_stream}} in 2.0 instead does this:\r\n\r\n{code:ruby}\r\n    a = ""\r\n    b = ""\r\n    while something\r\n      as.read size, a\r\n      bs.read size, b\r\n      return false if a != b\r\n    end\r\n{code}\r\n\r\nwhich is a problem since default encoding for strings is UTF-8 and when {{File#read}} reads into UTF-8 string it remains UTF-8 but when {{StringIO#read}} reads into UTF-8 string it becomes encoding of StringIO source string, which is ASCII for {{FileBucket::File}} contents.\r\n\r\nThis leads to problems with backing up files and under certain conditions gives errors like:\r\n\r\n{{Error: Could not back up /bin/whatever.pyc: Got passed new contents for sum \{md5\}ca60cf7b168557fb8c34be106b8c4ae8}}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2946', 'https://github.com/puppetlabs/puppet/pull/2938', '2014-07-17T07:37:45.000-0700', '2019-04-04T22:20:17.000-0700', '2019-04-04T22:20:17.000-0700', 'Closed', '', 17, '0', 1, 51, 1, 3, 'a31bb3cf558c9e39b94d90fb9a3076e2ce5edebc'),
('puppet', 42759, 18908897, 2912, '"masterlog" setting is dead code', 'http://docs.puppetlabs.com/references/latest/configuration.html#masterlog\r\n\r\n"Where puppet master logs. This is generally not used, since syslog is the default log destination."\r\n\r\nIf you ack the Puppet source, you''ll see that this setting is never referenced by any other area of code. It''s dead, Jim.\r\n\r\n(The similar puppetdlog setting -- http://docs.puppetlabs.com/references/latest/configuration.html#puppetdlog -- is apparently only used on systems that are neither POSIX nor Windows.)', 'https://tickets.puppetlabs.com/browse/PUP-2953', 'https://github.com/puppetlabs/puppet/pull/2912', '2014-07-17T17:20:53.000-0700', '2019-04-04T22:20:18.000-0700', '2019-04-04T22:20:18.000-0700', 'Closed', '', 4, '0', 1, 0, 10, 1, '7a042adaa12b285fa0a0783f417f06465c6ed53a'),
('puppet', 26269, 20910835, 3057, '"incorrect header check" using Ruby 2', 'I haven''t found anything out there so far, so I thought I''d just document it while I''m at it.\r\n\r\nWe ran into some other problem with the changes in net/http Ruby 2.1.0 introduced around the handling of gzip/deflate encoded content. This MIGHT be related.\r\nSo far we haven''t been able to fix it.\r\n\r\n{code}\r\nError: incorrect header check\r\nError: /Stage[main]/Nginx::Nginx/File[nginx-default-50x]/content: change from {md5}d74f9cdd604653c22c6752c46fffd587 to {md5}d45793c5a781c31eca1af96e394bfb84 failed: incorrect header check\r\n{code}\r\n\r\nThe code in question (probably not very relevant):\r\n{code}\r\n  file { "nginx-default-50x":\r\n    require => [ Package["nginx"], Exec["nginx-default-dir"], ],\r\n    path => "/usr/share/nginx/html/50x.html",\r\n    source => "puppet:///modules/nginx/50x-plain.html",\r\n    mode => 444,\r\n  }\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1680', 'https://github.com/puppetlabs/puppet/pull/3057', '2014-02-12T15:48:16.000-0800', '2019-04-04T22:20:20.000-0700', '2019-04-04T22:20:20.000-0700', 'Closed', '', 15, '0', 2, 7, 3, 2, 'f527b2e44daef28b08da182f433b312adcf169ce'),
('puppet', 51116, 20188471, 3004, 'There''s no way the ''bsd'' service provider will work on OpenBSD', 'OpenBSD has it''s own service provider and the ''bsd'' service provider will certainly not work on OpenBSD. Therefore remove ''OpenBSD'' from the ''confine'' list.', 'https://tickets.puppetlabs.com/browse/PUP-3243', 'https://github.com/puppetlabs/puppet/pull/3004', '2014-09-15T01:12:13.000-0700', '2019-04-04T22:20:22.000-0700', '2019-04-04T22:20:22.000-0700', 'Closed', '', 1, '0', 1, 1, 1, 1, 'f75e2bea8188c9eaf2c55cdd7cdd0e55c162d5a7'),
('puppet', 81609, 35090138, 3910, 'filebucket fails when environment is specified', 'Since the {{0.25}} days, the {{filebucket}} client in the form of {{Puppet::FileBucket::Dipper}} has interfaces with the indirector by constructing URLs in the following fashion:\r\n\r\n{code}\r\n@rest_path = "https://#{server}:#{port}/#{environment}/file_bucket_file/"\r\n# then\r\ndest_path = "#{@rest_path}#{file_bucket_file.name}/#{files_original_path}"\r\n{code}\r\n\r\nThe indirector breaks this down into its fields in {{Puppet::Indirector::Request#set_uri_key}}.\r\n\r\n{code}\r\nenv, indirector, @key = URI.unescape(uri.path.sub(/^\//, '''')).split(''/'',3)\r\n@key ||= ''''\r\nself.environment = env unless env == ''''\r\n{code}\r\n\r\nAll of this is quite unecessary because\r\n\r\n 1. the indirection implicitly follows from the indirected class\r\n 2. the environment is not significant for filebucket interactions\r\n\r\n(As an aside, the API does not construct URLs like this anymore, either - the environment is a parameter and not a part of the URI path. This is not important here, though, because these URLs never hit the wire. They are only for the benefit of the {{Indirector::Request}} class.)\r\n\r\nA consequence of this construct is that new indirector uses with URLs in keys will be misinterpreted by the {{Request}} class.\r\n\r\nIt would be beneficial to transform these internally used URLs into a form that\r\n\r\n 1. confers only the necessary information to the indirector\r\n 2. does not clash with other possible URLs\r\n\r\nh3. Summary\r\n\r\nAlthough this sounds like a network change, it''s not. It only changes how the client internally manages the filebucket request, but doesn''t affect how the client sends the request on the wire. It also doesn''t change file manifests, e.g. filebucket resources, etc.', 'https://tickets.puppetlabs.com/browse/PUP-4653', 'https://github.com/puppetlabs/puppet/pull/3910', '2015-05-26T14:03:09.000-0700', '2019-04-04T22:20:23.000-0700', '2019-04-04T22:20:23.000-0700', 'Closed', 'community;indirector', 4, '0', 1, 18, 19, 4, 'a59239d5f9e954cb605bfee48d0280bbe6f6c1aa'),
('puppet', 61116, 26182510, 3416, 'Don''t try to chown log file destination when non-root', 'When puppet is using a log file destination, it will always try to chown owner and group to {{Puppet\[:user\]}} and {{Puppet\[:group\]}}, which will fail when running as non-root:\r\n\r\n{noformat}\r\n$ bundle exec puppet apply --logdest /tmp/log -e "notify { ''hello'': }"\r\n$ less /tmp/log\r\n2014-12-09 23:42:44 -0800 Puppet (err): Unable to set ownership of log file\r\n...\r\n2014-12-09 23:42:45 -0800 Puppet (notice): hello\r\n{noformat}\r\n\r\nSee also https://github.com/puppetlabs/puppet/pull/3023#issuecomment-53752004', 'https://tickets.puppetlabs.com/browse/PUP-3756', 'https://github.com/puppetlabs/puppet/pull/3416', '2014-12-09T23:45:43.000-0800', '2019-04-04T22:20:24.000-0700', '2019-04-04T22:20:24.000-0700', 'Closed', '', 1, '0', 1, 14, 4, 2, '3265561516a1f834de3c95227d7abdf194ef1929'),
('puppet', 54933, 22730184, 3192, 'Puppet::Util::Execution.execute should not switch uid if it already matches the euid', 'we have a provider with the following getter and setter:\r\n\r\n{code}\r\nPuppet::Type.type(:git_config).provide(:git_config) do\r\n\r\n  mk_resource_methods\r\n\r\n  def value\r\n    require ''etc''\r\n    user    = @property_hash[:user]    = @resource[:user]\r\n    key     = @property_hash[:key]     = @resource[:key]\r\n    section = @property_hash[:section] = @resource[:section]\r\n    home    = Etc.getpwnam(user)[:dir]\r\n\r\n    current = Puppet::Util::Execution.execute(\r\n      "git config --global --get #{section}.#{key}",\r\n      :uid => user,\r\n      :failonfail => false,\r\n      :custom_environment => { ''HOME'' => home }\r\n    )\r\n    @property_hash[:value] = current.strip\r\n    @property_hash[:value]\r\n  end\r\n\r\n  def value=(value)\r\n    require ''etc''\r\n    user    = @resource[:user]\r\n    key     = @resource[:key]\r\n    section = @resource[:section]\r\n    home    = Etc.getpwnam(user)[:dir]\r\n\r\n    Puppet::Util::Execution.execute(\r\n      "git config --global #{section}.#{key} ''#{value}''",\r\n      :uid => user,\r\n      :failonfail => true,\r\n      :custom_environment => { ''HOME'' => home }\r\n    )\r\n  end\r\nend\r\n{code}\r\n\r\nduring development, most unintuitively, the getter would "work" (we assumed because of {{:failonfail}}, but the setter wouldn''t.\r\n\r\nit turns out the reason was that we supplied {{:uid}}, and puppet tries set it, even though the user executing puppet was the one provided in {{:uid}}\r\n\r\nso the question: should we try to switch to the provided uid, or should we first check if we aren''t already there?', 'https://tickets.puppetlabs.com/browse/PUP-3457', 'https://github.com/puppetlabs/puppet/pull/3192', '2014-10-14T07:54:46.000-0700', '2019-04-04T22:20:26.000-0700', '2019-04-04T22:20:26.000-0700', 'Closed', '', 8, '0', 1, 31, 5, 2, '9039b21ceda6bc95e4626b6fc2c9d20f03873a8e'),
('puppet', 15963, 48633626, 4375, '(PR) (#22703) Force encoding of comment value to ASCII-8BIT', 'The comment field for user resources can often contain non-ASCII characters. Unfortunately, Puppet retrieves the existing value (current_value) as ASCII-8BIT, but strings containing non-ASCII characters are automatically turned into UTF-8, resulting in a failure to concatenate the strings in change_to_s, with messages such as the following in Puppet 3.2.4 with Ruby 1.9.3:\r\n\r\nError: Could not convert change ''comment'' to string: incompatible character encodings: ASCII-8BIT and UTF-8\r\nError: Could not convert change ''comment'' to string: incompatible character encodings: ASCII-8BIT and UTF-8\r\nError: /User[rpinson]: Could not evaluate: Puppet::Util::Log requires a message\r\nwhich is due to the fact that current_value is encoded in ASCII-8BIT, but newvalue is in UTF-8 and not "softly" convertible when reaching change_to_s in property.rb.\r\n\r\nIn order to allow proper management of non-ASCII characters in the comment field, this PR forces an ASCII-8BIT encoding on the comment property value in the type.\r\n\r\nNote: trying to force the encoding in Puppet code (using e.g. inline_template) doesn''t solve anything, and patching change_to_s to force the encoding results in the resource not being idempotent anymore, since comparison fails (but change_to_s doesn''t crash anymore).', 'https://tickets.puppetlabs.com/browse/PUP-451', 'https://github.com/puppetlabs/puppet/pull/4375', '2013-10-01T12:52:41.000-0700', '2019-04-04T22:20:28.000-0700', '2019-04-04T22:20:28.000-0700', 'Closed', '', 2, '0', 1, 30, 12, 2, '7fee68ca3e11b6338a9a105ccc121d75eebea3c3'),
('puppet', 97225, 53746748, 4503, 'Pip package provider fails to honor HTTP proxy settings', 'Having some trouble getting the pip package provider to work behind a http proxy.\r\n\r\nI know that the {{install_options}} feature for pip hasn''t been backported to puppet 3.8.x, which is unfortunate (will this happen btw?), but I''ve found a reasonable workaround by setting a global proxy option in /etc/pip.conf (on unixy systems) - see [https://pip.pypa.io/en/latest/user_guide.html#config-file]. I can confirm that, once this config file is in place, manually running {{pip install --upgrade $pkg}} works via the proxy, even without environment variables being set. Trying this via puppet''s native pip provider fails with the following error:\r\n\r\n{code}\r\nError: Could not get latest version: Timeout while contacting pypi.python.org: execution expired\r\nError: /Package[$pkg]/ensure: change from 1.0.0 to latest failed: Could not get latest version: Timeout while contacting pypi.python.org: execution expired\r\n{code}\r\n\r\nHave tried a few variations, including:\r\n{code}\r\npuppet resource package $pkg ensure=latest provider=pip\r\npuppet resource --http_proxy_host=proxy.example.com --http_proxy_port=3128 package $pkg ensure=latest provider=pip\r\n{code}\r\n\r\nRuby is still new to me, but I think the problem is on this line: [https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/pip.rb#L63]\r\n\r\nWhich, according to [this reference on the XMLRPC::Client class|http://docs.ruby-lang.org/en/2.0.0/XMLRPC/Client.html#method-c-new2], might need to be modified to pass proxy details?\r\n\r\nIt would be good to get this fixed in 3.8.x - I''d like to avoid dumping the native pip package provider....', 'https://tickets.puppetlabs.com/browse/PUP-5212', 'https://github.com/puppetlabs/puppet/pull/4503', '2015-09-09T02:55:30.000-0700', '2019-04-04T22:20:29.000-0700', '2019-04-04T22:20:29.000-0700', 'Closed', 'package;pip;provider;proxy;puppethack', 9, '0', 3, 56, 14, 3, '4136350124243b04eb003dab5b92fcf622154c68'),
('puppet', 66242, 28975157, 3591, 'Applying catalogs spends an inordinate amount of time checking for failed dependencies.', 'I profiled `puppet agent --test` on one of my servers using stackprof [1] on Ruby 2.1.\r\n\r\nSomething like 30% or more of the time was spent in `Puppet::Graph::SimpleGraph#upstream_from_vertex`, called from `Puppet::Transaction#failed_dependencies?`\r\n\r\nIt turns out that, while evaluating the resource graph, when considering a resource, we look at *the complete set of transitive dependencies* to evaluate whether any of them have failed. This is hugely expensive, and moreover, is completely wasted work in the success case where no resources have failures.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3930', 'https://github.com/puppetlabs/puppet/pull/3591', '2015-01-30T10:36:46.000-0800', '2019-04-04T22:20:34.000-0700', '2019-04-04T22:20:34.000-0700', 'Closed', '', 4, '0', 4, 76, 14, 3, '84be695ddee004d7e358d9256f7929e1a2c400a3'),
('puppet', 62335, 27000534, 3458, 'puppet resource file ''mode'' parameter is 3-digit notation instead of 4-digit', 'Per https://docs.puppetlabs.com/references/latest/type.html#file-attribute-mode, numeric modes should use four-digit octal notation for files. However, the output of "puppet resource file <filename>" shows the mode in three-digit octal notation:\r\n\r\n{noformat}\r\n[rnelson0@build ~]$ puppet apply -e "file {''/home/rnelson0/test'': ensure => file, mode => ''0644''}"\r\nNotice: Compiled catalog for build.nelson.va in environment production in 0.06 seconds\r\nNotice: /Stage[main]/Main/File[/home/rnelson0/test]/ensure: created\r\nNotice: Finished catalog run in 0.02 seconds\r\n[rnelson0@build ~]$ puppet resource file /home/rnelson0/test\r\nfile { ''/home/rnelson0/test'':\r\n  ensure  => ''file'',\r\n  content => ''{md5}d41d8cd98f00b204e9800998ecf8427e'',\r\n  ctime   => ''2014-12-22 18:02:28 +0000'',\r\n  group   => ''501'',\r\n  mode    => ''644'',\r\n  mtime   => ''2014-12-22 18:02:28 +0000'',\r\n  owner   => ''501'',\r\n  type    => ''file'',\r\n}\r\n{noformat}\r\n\r\nThis makes it difficult to use puppet resource to discover and document existing files and preserve best practices for defining those resources. The ''mode'' value should be four-digit octal notation as the documentation describes.', 'https://tickets.puppetlabs.com/browse/PUP-3787', 'https://github.com/puppetlabs/puppet/pull/3458', '2014-12-22T10:04:48.000-0800', '2019-04-04T22:20:34.000-0700', '2019-04-04T22:20:34.000-0700', 'Closed', '', 6, '0', 1, 5, 5, 2, '54f61591023996be90e5a772fc32f55c02119236'),
('puppet', 59914, 147683700, 6293, 'Allow zfs to create a zvol', 'The volsize property must be specified explicity when creating a zvol and can not be passed as a property. Detect this in zfs:create\r\n\r\n{code}\r\n--- puppet/provider/zfs/zfs.rb	2014-06-10 09:08:19.000000000 +1200\r\n+++ puppet/provider/zfs/zfs.rb	2014-11-27 10:39:05.286217988 +1300\r\n@@ -15,7 +15,11 @@\r\n     Puppet::Type.type(:zfs).validproperties.each do |property|\r\n       next if property == :ensure\r\n       if value = @resource[property] and value != ""\r\n-        properties << "-o" << "#{property}=#{value}"\r\n+	if property == :volsize\r\n+	  properties << "-V" << "#{value}"\r\n+	else\r\n+          properties << "-o" << "#{property}=#{value}"\r\n+	end\r\n       end\r\n     end\r\n     properties\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3713', 'https://github.com/puppetlabs/puppet/pull/6293', '2014-11-26T14:23:03.000-0800', '2019-04-04T22:20:35.000-0700', '2019-04-04T22:20:35.000-0700', 'Closed', '', 6, '0', 2, 12, 2, 2, '2a417ef19e55b8e622f739b5391f88c39f4fefba'),
('puppet', 96635, 45348021, 4262, 'undefined method `[]'' for Puppet::Transaction::Event with certain reports', 'When Calling the function {color:#205081}"YAML.load_file(path)"{color} with a yaml file where a {color:#59afe1}resource_statuses: member{color} has {color:#d04437}events:{color} non-empty, we get a {color:#d04437}"undefined method `[]'' for #<Puppet::Transaction::Event:0x0000000341e3f0>{color}" error.\r\n\r\nSee attached files and gist.', 'https://tickets.puppetlabs.com/browse/PUP-5192', 'https://github.com/puppetlabs/puppet/pull/4262', '2015-09-03T06:33:59.000-0700', '2019-04-04T22:20:35.000-0700', '2019-04-04T22:20:35.000-0700', 'Closed', '', 4, '0', 2, 24, 3, 2, 'be80bb53f3fc566b79115f54985f43121b55dfef'),
('puppet', 55414, 27379153, 3478, 'Regex problem with an SELinux context type with a dash', 'I have a file on the system with the following SELinux context \r\n{code}\r\n[root@sut ~]# matchpathcon /etc/my-app/my-config.cfg\r\n/etc/my-app/my-config.cfg    system_u:object_r:my-app_config_t:s0\r\n{code}\r\n\r\nI also have a File\["/etc/my-app/my-config.cfg"\] resource defined in my manifests, which doesn''t call out the seltype attribute, so according [the documentation|https://docs.puppetlabs.com/references/stable/type.html#file-attribute-seltype] , it should get the type from matchpathcon, and set it to "my-app_config_t".\r\n\r\nHowever, it''s setting it to "my" instead.\r\n{code}\r\nOct 16 13:13:43 src@sut puppet-agent[902]: (/File[/etc/my-app/my-config/cfg]/seltype) seltype changed ''etc_t'' to ''my''\r\n{code}\r\n\r\nI think I''ve tracked this down to the regex in parse_selinux_context() in utils/selinux.rb, where the ''type'' section of the regexp stops accepting characters at the dash in the "my-app_config_t"  \r\n\r\nI think it would be better if the regexp were something more lenient , like \r\n{code}\r\n/^([^:]+):([^:]+):([^:]+)(?::([a-zA-Z0-9:,._-]+))?/\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3481', 'https://github.com/puppetlabs/puppet/pull/3478', '2014-10-16T15:27:36.000-0700', '2019-04-04T22:20:37.000-0700', '2019-04-04T22:20:37.000-0700', 'Closed', '', 4, '0', 2, 23, 1, 2, '55408ad7b8de7eedfd82fedf9df74ca1aab17c50'),
('puppet', 30178, 14035774, 2477, 'PR (2477) Multiple values for diff_args causes diff execution failure', 'Inserting multiple switches for diff_args in puppet.conf causes diff execution to fail.  I experienced this in both Windows and Linux.\r\n\r\nExample:\r\ndiff_args     = -u --strip-trailing-cr\r\n\r\nThis commit will fix the problem:\r\nhttps://github.com/mshean/puppet/commit/7972585779f3a12cfe62449df3c5e9d3b96c6136\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2073', 'https://github.com/puppetlabs/puppet/pull/2477', '2014-03-26T16:01:23.000-0700', '2019-04-04T22:20:39.000-0700', '2019-04-04T22:20:39.000-0700', 'Closed', '', 10, '0', 1, 11, 1, 2, '6dab11c95209655a4254ba69529fe1b20c9844ac'),
('puppet', 42741, 18560713, 2886, 'Puppet should only log  facts in debug mode', ' In environments with lots of facts puppet agent can fill the screen and log files with loading fact messages. This is only useful when debugging and should thus be only enabled when in debug mode.\r\n\r\n{code}\r\nrickon:~# puppet agent --test\r\nInfo: Retrieving plugin\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/thunderbird_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/rabbitmq_erlang_cookie.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/is_lxc.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/collectd_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/staging_windir.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/root_home.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/sunray.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/concat_basedir.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/dns_ip_4.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/iptables_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/raidtype.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/staging_http_get.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/kernel_type.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/iptables_persistent_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/dns_ip_6.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/hardware_platform.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/pe_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/ganeti_cluster.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/dept.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/nvidia_graphics_device.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/os_maj_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/ip6tables_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/raid_devices.rb\r\nInfo: Caching catalog for rickon.cat.pdx.edu\r\nInfo: Applying configuration version ''1405637813''\r\nNotice: Finished catalog run in 14.01 seconds\r\n{code}\r\n\r\nWith the patch applied\r\n\r\n{code}\r\nrickon:~# puppet agent -t\r\nInfo: Retrieving plugin\r\nInfo: Caching catalog for rickon.cat.pdx.edu\r\nInfo: Applying configuration version ''1405637813''\r\nNotice: Finished catalog run in 14.01 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2952', 'https://github.com/puppetlabs/puppet/pull/2886', '2014-07-17T16:22:37.000-0700', '2019-04-04T22:20:40.000-0700', '2019-04-04T22:20:40.000-0700', 'Closed', '', 3, '0', 1, 4, 3, 1, 'ef915edf68c8e16441e57777ade1550ba9c70400'),
('puppet', 18815, 112542087, 5763, 'Status unchanged when "Could not apply complete catalog"', 'When puppet agent report:\r\n\r\n{noformat}\r\nCould not apply complete catalog: Found 1 dependency cycle: ... Try the ''--graph'' option and opening the resulting ''.dot'' file in OmniGraffle or GraphViz\r\n{noformat}\r\nthere is no failed nodes.\r\n\r\nRisk Assessment: Medium\r\nProbability: Medium\r\nImpact: Low\r\nTest Layer: acceptance', 'https://tickets.puppetlabs.com/browse/PUP-735', 'https://github.com/puppetlabs/puppet/pull/5763', '2013-11-13T10:00:30.000-0800', '2019-04-04T22:20:41.000-0700', '2019-04-04T22:20:41.000-0700', 'Closed', 'redmine', 11, '0', 1, 3, 7, 1, '3ca9e74bf9a4a62736d30f6c2b9a85947a58258b'),
('puppet', 25461, 12355174, 2342, 'PR (2342) cron resources with target specified generate duplicate entries', 'The following resource results in duplicate cron entry added with each puppet run: \r\n{noformat}    cron { ''bacula_vacuumdb'':\r\n      ensure   => present,\r\n      minute   => ''00'',\r\n      hour     => ''12'',\r\n      command  => ''vacuumdb --analyze -U postgres bacula'',\r\n      target   => ''postgres'',\r\n    }{noformat}\r\n\r\nExample of Cron: \r\n{noformat}~# crontab -l -u postgres \r\n# HEADER: This file was autogenerated at 2014-02-04 16:30:20 -0700 by puppet.\r\n# HEADER: While it can still be managed manually, it is definitely not recommended.\r\n# HEADER: Note particularly that the comments starting with ''Puppet Name'' should\r\n# HEADER: not be deleted, as doing so could cause duplicate cron jobs.\r\n# Puppet Name: bacula_vacuumdb\r\n0 12 * * * vacuumdb --analyze -U postgres bacula\r\n# Puppet Name: bacula_vacuumdb\r\n0 12 * * * vacuumdb --analyze -U postgres bacula{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1585', 'https://github.com/puppetlabs/puppet/pull/2342', '2014-02-04T15:55:08.000-0800', '2019-04-04T22:20:42.000-0700', '2019-04-04T22:20:42.000-0700', 'Closed', 'provider_crontab', 15, '0', 4, 29, 8, 5, 'b3d10deadaeb62404e0670ae0d069828ff6edff8'),
('puppet', 79701, 35214923, 3918, '''bsd'' service provider non-functional', 'The generic ''bsd'' service provider was still using @model instead of @resource, therefore it was not working at all. There are currently no spec tests (or users?) for this provider which is probably why it went unnoticed for so long.\r\n\r\nCould that be backported to the 3.8 stable branches too?', 'https://tickets.puppetlabs.com/browse/PUP-4562', 'https://github.com/puppetlabs/puppet/pull/3918', '2015-05-12T03:58:22.000-0700', '2019-04-04T22:20:43.000-0700', '2019-04-04T22:20:43.000-0700', 'Closed', '', 3, '0', 1, 137, 7, 2, '9038bc54eef6eba78d7abc970e7430c24613c2bc'),
('puppet', 35998, 20260735, 3013, 'expiry parameter definition in user resource documentation needs update', 'When running through the "Resource" quest and reading expiry parameter portion from the output of ''puppet describe user'' one sees:\r\n<snipped>\r\n- **expiry**\r\n    The expiry date for this user. Must be provided in\r\n    a zero-padded YYYY-MM-DD format --- e.g. 2010-02-19.\r\n    If you want to make sure the user account does never\r\n    expire, you can pass the special value `absent`.\r\n    Valid values are `absent`. Values can match `/^\d{4}-\d{2}-\d{2}$/`.\r\n    Requires features manages_expiry.\r\n\r\nIt would be clearer if phrased as, "If you want to ensure the user account never expires, you can ..."', 'https://tickets.puppetlabs.com/browse/PUP-3137', 'https://github.com/puppetlabs/puppet/pull/3013', '2014-05-17T22:08:23.000-0700', '2019-04-04T22:20:43.000-0700', '2019-04-04T22:20:43.000-0700', 'Closed', '', 3, '0', 1, 2, 2, 1, '2c40c5ec610e0bd15a663de13fc16e1f92e6933b'),
('puppet', 62698, 27540541, 3492, 'HP-UX User Provider not resetting password expiration after changing password hash.', 'A previous update I made to the 2.7.3 code to handle changing passwords for HP-UX Trusted Computing was found to set the password change date, but not send the required additional command to force the Trusted Computing setup to reset the password age to 0. \r\n\r\nI have already modified the password provider code to address this issue and I am creating a ticket to have the code reviewed for modification into the existing puppet code base. ', 'https://tickets.puppetlabs.com/browse/PUP-3801', 'https://github.com/puppetlabs/puppet/pull/3492', '2014-12-31T09:06:29.000-0800', '2019-04-04T22:20:44.000-0700', '2019-04-04T22:20:44.000-0700', 'Closed', 'puppet-agent', 6, '0', 1, 52, 2, 2, '2f1af35a3e42019e46951b57d8913532c06b6676'),
('puppet', 53148, 26271497, 3424, 'False positives in Puppet acceptance testing - should_not_change_the_system.rb', 'When running the Puppet acceptance suite, we''re seeing some flakiness in {{acceptance/tests/resource/service/should_not_change_the_system.rb}}. This doesn''t appear to be a problem with Puppet, but rather a problem with the test.\r\n\r\nThe test runs {{puppet resource service}} twice and compares the output. On Fedora 19, we''re seeing the NetworkManager service changes state in between. It is not immediately apparent what causes this service''s state to change.\r\n\r\nIdeally, we need to modify this test to be less fragile, and more directly test {{puppet resource service}}.', 'https://tickets.puppetlabs.com/browse/PUP-3378', 'https://github.com/puppetlabs/puppet/pull/3424', '2014-10-01T08:46:11.000-0700', '2019-04-04T22:20:44.000-0700', '2019-04-04T22:20:44.000-0700', 'Closed', '', 6, '0', 1, 11, 13, 1, '5f9e28b57bdcc24d56fd723c885e90c6de0ce360'),
('puppet', 52664, 21823892, 3124, 'curl allows --insecure SSL connections ', 'The {{appdmg}} and {{pkgdmg}} providers were calling {{curl}} with {{\-k}} (alias for {{--insecure}}) which allows curl''ing over insecure HTTPS connections. I can''t see why this would ever be desired, and many connections will often fail when attempting establish a connection.\r\n\r\nI have a PR removing the insecure option: https://github.com/puppetlabs/puppet/pull/3124', 'https://tickets.puppetlabs.com/browse/PUP-3346', 'https://github.com/puppetlabs/puppet/pull/3124', '2014-09-25T18:26:00.000-0700', '2019-04-04T22:20:45.000-0700', '2019-04-04T22:20:45.000-0700', 'Closed', '', 8, '0', 1, 2, 2, 2, '4ab1180d9b7071cf21a7a20f0e695cdc05527a73'),
('puppet', 71399, 31049919, 3708, 'Custom gem provider does not issue the right command to uninstall gem', 'Calling the uninstall method on a custom gem provider where a custom command has been defined, results in the wrong command being issued.\r\n\r\nFor example, sensu-puppet uses the sensu_gem provider in order to uninstall gems from the sensu embedded version of ruby.\r\n\r\nhttps://github.com/sensu/sensu-puppet/blob/master/lib/puppet/provider/package/sensu_gem.rb\r\n\r\nWhen ''ensure => absent'' a given gem, ''/usr/bin/gem uninstall [gem_name]'' is executed rather than ''/opt/sensu/embedded/bin/gem uninstall [gem_name]''.\r\n\r\nThe custom provider sensu_gem doesn''t contain logic to overwrite the puppet gem provider behaviour, except from the :gemcmd to be issued.\r\n\r\n''ensure => present'' a given gem results in the correct command to be issued.', 'https://tickets.puppetlabs.com/browse/PUP-4191', 'https://github.com/puppetlabs/puppet/pull/3708', '2015-03-12T07:43:30.000-0700', '2019-04-04T22:20:45.000-0700', '2019-04-04T22:20:45.000-0700', 'Closed', '', 3, '0', 6, 217, 142, 2, 'd42649c834e19b5ef9739db00dc533e0df8c0cfa'),
('puppet', 103309, 49055152, 4385, 'Crontab environment variable space parsing ', 'Crontab parsing when there is a space between the variable name and the ''='' causes a very obscure error of the form:\r\n\r\nError: Failed to apply catalog: Could not parse line "VARIABLENAME = value" at username:4\r\n\r\nThis appears to be due to unfortunate error propagation in the parsedfile utility class and is currently beyond the time I have to spend. \r\n\r\nHowever, it''d be nice to fix the immediate bug : Environment variables in crontab don''t follow shell strictures and can have a space between the variable name and the value.', 'https://tickets.puppetlabs.com/browse/PUP-5452', 'https://github.com/puppetlabs/puppet/pull/4385', '2015-10-28T12:22:57.000-0700', '2019-04-04T22:20:46.000-0700', '2019-04-04T22:20:46.000-0700', 'Closed', '', 1, '0', 1, 2, 1, 2, 'e4b1e0c3f3f6ec3aab042432c42d2c3a079b2dbb'),
('puppet', 90338, 40674952, 4100, 'static compiler always sets ensure parameter to ''file'' if a source is declared', 'The static_compiler catalog terminus always sets ensure to ''file'' on file resources as long as the resource has a source parameter declared.\r\nIt does this even if the ensure parameter is explicitly declared.\r\n\r\nApplying a catalog, with the following file resource, compiled with static compiler, will create the file anyway.\r\n\r\n{code}\r\nfile { ''/tmp/statically_compiled.txt'':\r\n  ensure => absent,\r\n  mode   => 0755,\r\n  owner  => ''root'',\r\n  group  => ''root'',\r\n  source => ''puppet:///modules/foo/statically_compiled.txt'',\r\n}\r\n{code}\r\n\r\n...\r\nNotice: /Stage[main]/Main/File[/tmp/statically_compiled.txt]/ensure: defined content as ''{md5}8fea78c7e5ed0f5b3bd13565589a6f7c''\r\n...\r\n\r\n\r\nThe catalog confirms ensure is being set to "file" :\r\n\r\nirb(main):001:0> require ''json''\r\n=> true\r\nirb(main):002:0> JSON.load(File.read(''foo.json''))[''data''][''resources''].find { |res| res[''title''] == ''/tmp/statically_compiled.txt'' }\r\n=> {"type"=>"File", "title"=>"/tmp/statically_compiled.txt", "tags"=>["file", "class"], "file"=>"/etc/puppet/environments/tdevelioglu/puppet/manifests/site.pp", "line"=>7, "exported"=>false, "parameters"=>{"ensure"=>"file", "mode"=>"0755", "owner"=>"root", "group"=>"root", "ignore"=>[".svn", "CVS", ".git"], "content"=>"{md5}8fea78c7e5ed0f5b3bd13565589a6f7c", "checksum"=>"md5"}}\r\n\r\nThis is inconsistent with the behavior of the normal compiler, where a file''s ensure parameter is enforced regardless of the value of the source parameter.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4919', 'https://github.com/puppetlabs/puppet/pull/4100', '2015-07-23T05:19:23.000-0700', '2019-04-04T22:20:47.000-0700', '2019-04-04T22:20:47.000-0700', 'Closed', '', 0, '0', 1, 2, 0, 1, '3807217f8de626a3e1d63d2a29cf2e14903931d8'),
('puppet', 62461, 26584875, 3441, 'Exec resource''s user validation should not block catalog compilation', 'Catalog compilation fails as non root user when using an exec resource with another user : `exec { ''foo'': user => ''bar'' }`. \r\nIssue alread reported here : https://github.com/puppetlabs/puppetlabs-postgresql/pull/394\r\n\r\nThis is quite annoying because unit tests are usually run as non root user and thus `it {should compile}` fails in that case. We could use fakeroot to workaround this issue, but this tool is not available on every platform : https://github.com/puppetlabs/modulesync_configs/pull/8', 'https://tickets.puppetlabs.com/browse/PUP-3793', 'https://github.com/puppetlabs/puppet/pull/3441', '2014-12-26T01:25:41.000-0800', '2019-04-04T22:20:47.000-0700', '2019-04-04T22:20:47.000-0700', 'Closed', '', 1, '0', 2, 4, 9, 2, ''),
('puppet', 58793, 28404479, 3543, 'Invalid module name .DS_Store error running puppet apply', 'Running master at 3.7.3-619-g3c8fb24 I''m getting the following surprise when running a basic puppet apply -v foo.pp from a provider module I''m developing:\r\n\r\n{code}\r\n$ bundle exec puppet apply -v foo2.pp\r\nError: Invalid module name .DS_Store; module names must be alphanumeric (plus ''-''), not ''.DS_Store''\r\nError: Invalid module name .DS_Store; module names must be alphanumeric (plus ''-''), not ''.DS_Store''\r\nInfo: Loading facts\r\nNotice: Compiled catalog for mccune.corp.puppetlabs.net in environment production in 0.04 seconds\r\nInfo: Applying configuration version ''1416266353''\r\nNotice: Applied catalog in 0.49 seconds\r\n{code}\r\n\r\nDoing a bisect traced the change to https://github.com/puppetlabs/puppet/commit/e86b3ab11adf0dce8f07373ce5aaa19ad410166c\r\n\r\n{code}\r\ncommit e86b3ab11adf0dce8f07373ce5aaa19ad410166c\r\nAuthor: Jim Radford <radford@blackbean.org>\r\nDate:   Fri Nov 7 16:31:18 2014 -0800\r\n\r\n    (maint) Log invalid modules\r\n\r\n    Give notice when a module on the modulepath is invalid, explaining why.\r\n    To do this cleanly, we stop trying to add "." and ".." as modules since\r\n    these are always invalid.\r\n\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3678', 'https://github.com/puppetlabs/puppet/pull/3543', '2014-11-17T15:19:31.000-0800', '2019-04-04T22:20:48.000-0700', '2019-04-04T22:20:48.000-0700', 'Closed', '', 4, '0', 1, 86, 6, 4, '6d499bde4ca11571a1878c7cc917e490c00e8823'),
('puppet', 99429, 46011767, 4291, 'Allow local of install of a gem on windows', 'Attempts to install a gem from a local source on windows using the package type fail because the provider eventually passes the path as a source argument:\r\n\r\n{code:title=puppet|borderStyle=solid}\r\npackage { ''diplomercy'':\r\n   ensure => ''1.0.0'',\r\n   source => ''c:/diplomercy-1.0.0.gem'',\r\n   provider => ''gem'',\r\n   install_options => [''--local'',''--no-ri'',''--no-rdoc''],\r\n}\r\n\r\nNotice: Compiled catalog for windowsmeupscotty in environment production in 1.10 seconds\r\nError: Could not update: Execution of ''c:/Program Files/Puppet Labs/Puppet/sys/ruby/bin/gem.bat install -v 1.0.0 --source c:/diplomercy-1.0.0.gem diplomercy --local --no-ri --no-rdoc'' returned 1: ERROR:  While executing gem ... (OptionParser::InvalidArgument)\r\n    invalid argument: --source c:/diplomercy-1.0.0.gem\r\nWrapped exception:\r\nExecution of ''c:/Program Files/Puppet Labs/Puppet/sys/ruby/bin/gem.bat install -v 1.0.0 --source c:/diplomercy-1.0.0.gem diplomercy --local --no-ri --no-rdoc'' returned 1: ERROR:  While executing gem ... (OptionParser::InvalidArgument)\r\n    invalid argument: --source c:/diplomercy-1.0.0.gem\r\nError: /Stage[main]/Main/Package[diplomercy]/ensure: change from absent to 1.0.0 failed: Could not update: Execution of ''c:/Program Files/Puppet Labs/Puppet/sys/ruby/bin/gem.bat install -v 1.0.0 --source c:/diplomercy-1.0.0.gem diplomercy --local --no-ri --no-rdoc'' returned 1: ERROR:  While executing gem ... (OptionParser::InvalidArgument)\r\n    invalid argument: --source c:/diplomercy-1.0.0.gem\r\nNotice: Finished catalog run in 3.19 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5282', 'https://github.com/puppetlabs/puppet/pull/4291', '2015-09-25T06:27:50.000-0700', '2019-04-04T22:20:49.000-0700', '2019-04-04T22:20:49.000-0700', 'Closed', '', 2, '0', 1, 14, 2, 2, 'c41918d8cfae0e16fa3eb709743fbe64bbbf4efa'),
('puppet', 32519, 14988646, 2563, 'OpenBSD uninstall broken when multiple uninstall_options given', 'As I found out while working on :upgradeable today, the way we pass arguments to pkg_add/pkg_delete is slightly off.\r\n\r\nCurrently we pass it a single string, which confuses pkg_* as it sees "-r -z" (without quotes) as a single argument, the same applies to the #uninstall method in case multiple uninstall_options were passed.', 'https://tickets.puppetlabs.com/browse/PUP-2311', 'https://github.com/puppetlabs/puppet/pull/2563', '2014-04-21T15:43:41.000-0700', '2019-04-04T22:20:49.000-0700', '2019-04-04T22:20:49.000-0700', 'Closed', '', 2, '0', 1, 20, 4, 2, 'e59b8a725e1b6324c9c4db81d0017f76b924eb88'),
('puppet', 82297, 36556326, 3984, 'Pip installs from behind proxy can''t ensure=>latest', 'The pip package provider can ensure => version but can''t ensure latest when using a proxy. \r\n\r\nhttps://github.com/puppetlabs/puppet/pull/3984\r\n\r\n(venv)krum@ftctstories01g:~$ env| grep proxy\r\nhttp_proxy=http://web-proxy.houston.hp.com:8080\r\nHTTPS_PROXY=http://web-proxy.houston.hp.com:8080\r\nhttps_proxy=http://web-proxy.houston.hp.com:8080\r\nHTTP_PROXY=http://web-proxy.houston.hp.com:8080\r\n\r\n\r\n(venv)krum@ftctstories01g:~$ puppet --version\r\n3.7.4\r\n(venv)krum@ftctstories01g:~$ ruby --version\r\nruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]\r\n(venv)krum@ftctstories01g:~$ gem --version\r\n1.8.15\r\n\r\n$ puppet resource package gear provider=pip ensure=latest --debug --trace                       \r\nDebug: Runtime environment: ruby_version=1.8.7, run_mode=user, puppet_version=3.7.4\r\nDebug: Puppet::Type::Package::ProviderNim: file /usr/bin/lslpp does not exist\r\nDebug: Puppet::Type::Package::ProviderSunfreeware: file pkg-get does not exist\r\nDebug: Puppet::Type::Package::ProviderPortage: file /usr/bin/emerge does not exist\r\nDebug: Puppet::Type::Package::ProviderSun: file /usr/bin/pkginfo does not exist\r\nDebug: Puppet::Type::Package::ProviderOpenbsd: file pkg_info does not exist\r\nDebug: Puppet::Type::Package::ProviderPacman: file /usr/bin/pacman does not exist\r\nDebug: Puppet::Type::Package::ProviderZypper: file /usr/bin/zypper does not exist\r\nDebug: Puppet::Type::Package::ProviderRpm: file rpm does not exist\r\nDebug: Puppet::Type::Package::ProviderUrpmi: file rpm does not exist\r\nDebug: Puppet::Type::Package::ProviderHpux: file /usr/sbin/swinstall does not exist\r\nDebug: Puppet::Type::Package::ProviderOpkg: file opkg does not exist\r\nDebug: Puppet::Type::Package::ProviderPorts: file /usr/local/sbin/pkg_deinstall does not exist\r\nDebug: Puppet::Type::Package::ProviderYum: file rpm does not exist\r\nDebug: Puppet::Type::Package::ProviderUp2date: file /usr/sbin/up2date-nox does not exist\r\nDebug: Puppet::Type::Package::ProviderFreebsd: file /usr/sbin/pkg_info does not exist\r\nDebug: Puppet::Type::Package::ProviderFink: file /sw/bin/fink does not exist\r\nDebug: Puppet::Type::Package::ProviderRug: file /usr/bin/rug does not exist\r\nDebug: Puppet::Type::Package::ProviderPkgin: file pkgin does not exist\r\nDebug: Puppet::Type::Package::ProviderPortupgrade: file /usr/local/sbin/pkg_deinstall does not exist\r\nDebug: Puppet::Type::Package::ProviderPkg: file /usr/bin/pkg does not exist\r\nDebug: Puppet::Type::Package::ProviderAix: file /usr/bin/lslpp does not exist\r\nDebug: Puppet::Type::Package::ProviderAptrpm: file rpm does not exist\r\nDebug: /Package[gear]: Provider pip does not support features virtual_packages; not managing attribute allow_virtual\r\nDebug: Loaded state in 0.00 seconds\r\nDebug: Failed to load library ''selinux'' for feature ''selinux''\r\nDebug: Prefetching pip resources for package\r\nDebug: Executing ''/home/krum/venv/bin/pip freeze''\r\nError: Could not get latest version: Timeout while contacting pypi.python.org: execution expired\r\n/usr/lib/ruby/1.8/timeout.rb:64:in `open''\r\n/usr/lib/ruby/1.8/net/http.rb:560:in `connect''\r\n/usr/lib/ruby/1.8/net/http.rb:560:in `connect''\r\n/usr/lib/ruby/1.8/net/http.rb:553:in `do_start''\r\n/usr/lib/ruby/1.8/net/http.rb:548:in `start''\r\n/usr/lib/ruby/1.8/xmlrpc/client.rb:535:in `do_rpc''\r\n/usr/lib/ruby/1.8/xmlrpc/client.rb:420:in `call2''\r\n/usr/lib/ruby/1.8/xmlrpc/client.rb:410:in `call''\r\n/usr/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:63:in `latest''\r\n/usr/lib/ruby/vendor_ruby/puppet/type/package.rb:145:in `insync?''\r\n/usr/lib/ruby/vendor_ruby/puppet/type/package.rb:132:in `each''\r\n/usr/lib/ruby/vendor_ruby/puppet/type/package.rb:132:in `insync?''\r\n/usr/lib/ruby/vendor_ruby/puppet/property.rb:314:in `safe_insync?''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:117:in `sync_if_needed''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:81:in `perform_changes''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:20:in `evaluate''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:204:in `apply''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:217:in `eval_resource''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:147:in `call''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:147:in `evaluate''\r\n/usr/lib/ruby/vendor_ruby/puppet/util.rb:327:in `thinmark''\r\n/usr/lib/ruby/1.8/benchmark.rb:308:in `realtime''\r\n/usr/lib/ruby/vendor_ruby/puppet/util.rb:326:in `thinmark''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:147:in `evaluate''\r\n/usr/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:118:in `traverse''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:138:in `evaluate''\r\n/usr/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:169:in `apply''\r\n/usr/lib/ruby/vendor_ruby/puppet/util/log.rb:153:in `with_destination''\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction/report.rb:112:in `as_logging_destination''\r\n/usr/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:168:in `apply''\r\n/usr/lib/ruby/vendor_ruby/puppet/indirector/resource/ral.rb:41:in `save''\r\n/usr/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:283:in `save''\r\n/usr/lib/ruby/vendor_ruby/puppet/application/resource.rb:218:in `find_or_save_resources''\r\n/usr/lib/ruby/vendor_ruby/puppet/application/resource.rb:142:in `main''\r\n/usr/lib/ruby/vendor_ruby/puppet/application.rb:389:in `run_command''\r\n/usr/lib/ruby/vendor_ruby/puppet/application.rb:381:in `run''\r\n/usr/lib/ruby/vendor_ruby/puppet/application.rb:507:in `plugin_hook''\r\n/usr/lib/ruby/vendor_ruby/puppet/application.rb:381:in `run''\r\n/usr/lib/ruby/vendor_ruby/puppet/util.rb:488:in `exit_on_fail''\r\n/usr/lib/ruby/vendor_ruby/puppet/application.rb:381:in `run''\r\n/usr/lib/ruby/vendor_ruby/puppet/util/command_line.rb:146:in `run''\r\n/usr/lib/ruby/vendor_ruby/puppet/util/command_line.rb:92:in `execute''\r\n/usr/bin/puppet:8\r\nError: /Package[gear]/ensure: change from 0.5.7 to latest failed: Could not get latest version: Timeout while contacting pypi.python.org: execution expired\r\nDebug: Finishing transaction 70036871426860\r\nDebug: Storing state\r\nDebug: Stored state in 0.01 seconds\r\npackage { ''gear'':\r\n  ensure => ''0.5.7'',\r\n}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4673', 'https://github.com/puppetlabs/puppet/pull/3984', '2015-05-29T18:15:11.000-0700', '2019-04-04T22:20:50.000-0700', '2019-04-04T22:20:50.000-0700', 'Resolved', 'puppethack', 2, '0', 1, 3, 7, 2, ''),
('puppet', 52824, 22320462, 3164, 'Unexpected error with multiple SSH keys without comments', 'Steps to reproduce:\r\n\r\n# Enter multple SSH authorized keys for a user without comments (just a key line by line, see example below).\r\n# Manage the user with Puppet with the {{purge_ssh_keys}} parameter set to true.\r\n# Have Puppet agent 3.7.0+\r\n# Puppet agent run fails completely with an error. (full denial of service of the agent effectively)\r\n\r\nExpected behaviour: Purging all other SSH keys, with or without comments and a successful Puppet agent run.\r\n\r\nNote: Because of an unprivileged user being able to block Puppet agent runs I consider this more than just a corner case.\r\n\r\nMore details:\r\n\r\nSince 3.7.0 (not with 3.6.2), I''m getting an unexpected error on the Puppet agent runs managing the {{user}}''s SSH authorized keys with {{purge_ssh_keys}} enabled. Some users enter multiple keys without comments in the files, e.g.:\r\n\r\n{noformat}\r\necdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI/HHDwh6ccmX4BT5rpCEt7Z647v3WwmVCamWfxgUMCegYJliI7BjfAMX0HPdlaCfPd67oWQJaKg9qSNEuHBbKM= \r\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDYUv24oLUvh8Vr3g0XxocU2AYkc3RTunnrR8ChkWgjru9d3o5O1mdg7dzkQDyiQflHa3XGSbvly9LAxKOQhJtZEHJ6+Sn8iAo5edJR2yE6uX2O9DcYOgaoZO0Rg3PG5JsP3JdrS5lb3jwvsGfPFU+bC5egEypWDnIakLQksvkcldwMuzDVeExm11LakMd2MPig4gaje7HVoP++LVLxqxYUZQTiEGOZwTnysO/CywhGvD5V2n59T+1Hqhz9cgx+l2fdJxuJPXq9a7V+crxxLW22w/LIj70KvdDPh7jyfAzMk+k8tYg/6FbTz6sft2uQ043fCBso8iy2iTIAj8xqBKab\r\n{noformat}\r\n\r\nThis results in the following error in 3.7.0+:\r\n\r\n{noformat}\r\nError: Could not apply complete catalog: Duplicate declaration: Ssh_authorized_key[] is already declared; cannot redeclare\r\n{noformat}\r\n\r\nWith the agent downgraded to 3.6.2, it runs, but it does not remove the existing keys properly.\r\n{noformat}\r\nNotice: /Stage[main]/Localusers/Ssh_authorized_key[key0]/ensure: current_value absent, should be present (noop)\r\nNotice: /Stage[main]/Localusers/Ssh_authorized_key[key1]/ensure: current_value absent, should be present (noop)\r\nNotice: /Stage[main]/Localusers/Ssh_authorized_key[key2]/ensure: current_value absent, should be present (noop)\r\n{noformat}\r\n\r\nBack on 3.7.1, it works fine again after editing the user''s {{authorized_keys}} file and add some comments:\r\n\r\n{noformat}\r\necdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBI/HHDwh6ccmX4BT5rpCEt7Z647v3WwmVCamWfxgUMCegYJliI7BjfAMX0HPdlaCfPd67oWQJaKg9qSNEuHBbKM= key0\r\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDYUv24oLUvh8Vr3g0XxocU2AYkc3RTunnrR8ChkWgjru9d3o5O1mdg7dzkQDyiQflHa3XGSbvly9LAxKOQhJtZEHJ6+Sn8iAo5edJR2yE6uX2O9DcYOgaoZO0Rg3PG5JsP3JdrS5lb3jwvsGfPFU+bC5egEypWDnIakLQksvkcldwMuzDVeExm11LakMd2MPig4gaje7HVoP++LVLxqxYUZQTiEGOZwTnysO/CywhGvD5V2n59T+1Hqhz9cgx+l2fdJxuJPXq9a7V+crxxLW22w/LIj70KvdDPh7jyfAzMk+k8tYg/6FbTz6sft2uQ043fCBso8iy2iTIAj8xqBKab key1\r\n{noformat}\r\n\r\n{noformat}\r\nNotice: /Stage[main]/Localusers/Ssh_authorized_key[key0]/ensure: current_value present, should be absent (noop)\r\nNotice: /Stage[main]/Localusers/Ssh_authorized_key[key1]/ensure: current_value present, should be absent (noop)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3357', 'https://github.com/puppetlabs/puppet/pull/3164', '2014-09-28T04:27:17.000-0700', '2019-04-04T22:20:51.000-0700', '2019-04-04T22:20:51.000-0700', 'Closed', 'ssh_authorized_key', 16, '0', 3, 70, 2, 6, 'fb430c0756632fe78f60a08c7843423ad199e2ce'),
('puppet', 49739, 36035131, 3962, 'Debian service provider on docker with insserv (dep boot sequencing)', 'I am trying to test a puppet module in docker. Starting /sbin/init as suggested ...\r\n\r\nEach run triggers "reenabling" the defined service, because invoke-rc.d returns 101 (not allowed). In this case puppet should check for the links in /etc/rc*.d manually, as it does for exit code 105.\r\n\r\nI attempted to fix this:\r\nhttps://github.com/puppetlabs/puppet/pull/3038', 'https://tickets.puppetlabs.com/browse/PUP-3166', 'https://github.com/puppetlabs/puppet/pull/3962', '2014-09-01T06:52:06.000-0700', '2019-04-04T22:20:51.000-0700', '2019-04-04T22:20:51.000-0700', 'Closed', 'AIO', 13, '0', 1, 13, 4, 2, '1e096fd5537cbfcd66a21833bdd538e279aa2e95'),
('puppet', 22525, 21067065, 3078, 'Yum provider using "version-release" to validate installation.', 'When using yum provider Puppet complains(error output) when using only the version(string) of the package to install or installed at the time of verification.\r\n\r\n{code}\r\n    $snmp_version = "5.3.2.2"\r\n    package { "net-snmp": ensure => "${snmp_version}"; }\r\n\r\nClient output:\r\n\r\ndebug: //Node[client.example.com]/snmp::base/Package[net-snmp]: Changing ensure\r\ndebug: //Node[client.example.com]/snmp::base/Package[net-snmp]: 1 change(s)\r\ndebug: Package[net-snmp](provider=yum): Ensuring => 5.3.2.2\r\n**(1)** debug: Puppet::Type::Package::ProviderYum: Executing ''/usr/bin/yum -d 0 -e 0 -y install net-snmp-5.3.2.2''\r\n**(2)** debug: Puppet::Type::Package::ProviderYum: Executing ''/bin/rpm -q net-snmp --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\r\n''\r\nerr: //Node[client.example.com]/snmp::base/Package[net-snmp]/ensure: change from 5.3.2.2-7.el5_4.2 to 5.3.2.2 failed: Could not update: Failed to update to version 5.3.2.2, got version 5.3.2.2-7.el5_4.2 instead at /opt/git/development/modules/snmp/manifests/init.pp:26\r\nnotice: //Node[client.example.com]/snmp::base/File[/etc/snmp/snmpd.conf]: Dependency package[net-snmp] has 1 failures\r\nwarning: //Node[labtest40-v3.ea-colo.ea.com]/snmp::base/File[/etc/snmp/snmpd.conf]: Skipping because of failed dependencies\r\n{code}\r\n\r\nThe package is installed **(1)** but the error is still shown at the time of validation **(2)**, same situation if package is already installed.\r\n\r\nin .../provider/package/yum.rb:\r\n\r\n{code}\r\ndef install\r\n    ---- chop lines ---\r\n    is = self.query\r\n    unless is\r\n        raise Puppet::Error, "Could not find package %s" % self.name\r\n    end\r\n    # FIXME: Should we raise an exception even if should == :latest\r\n    # and yum updated us to a version other than @param_hash[:ensure] ?\r\n    if should && should != is[:ensure]\r\n        raise Puppet::Error, "Failed to update to version #{should}, got version #{is[:ensure]} instead"\r\n    end\r\n{code}\r\n\r\nThe error arises as **should** is not equal to **is[:ensure]**\r\n\r\nin .../provider/package/rpm.rb the query define comment says it will provide the **"version-release"**\r\n\r\n{code}\r\n# Find the fully versioned package name and the version alone. Returns\r\n# a hash with entries :instance => fully versioned package name, and\r\n# :ensure => version-release\r\ndef query\r\n{code}\r\n\r\nThe validation is made in the ensure attribute($snmp_version) string against "version-release" installed.  It makes sense when somebody defines something like ensure => "${snmp_version}-${snmp-release}", but not in this use case.\r\n\r\nTested in 0.24.8 but reported also on 0.25.4.\r\n\r\nrpm.rb and yum.rb are not behaving in the same way as yum cli behaves.', 'https://tickets.puppetlabs.com/browse/PUP-1244', 'https://github.com/puppetlabs/puppet/pull/3078', '2013-12-26T03:08:16.000-0800', '2019-04-04T22:20:53.000-0700', '2019-04-04T22:20:53.000-0700', 'Closed', 'customer;redmine;yum', 17, '0', 1, 400, 4, 4, '970b7b3317d35cd21871cca3b188ce0d7cded509'),
('puppet', 94520, 43033340, 4185, 'static compiler fails to remove existing resources from children.', 'The static compiler fails to remove child resources that already exist in the catalog.\r\n\r\n{code}\r\n  file { ''/tmp/statically_compiled'':\r\n    ensure  => directory,\r\n    owner   => ''root'',\r\n    group   => ''root'',\r\n    recurse => true,\r\n    source  => ''puppet:///modules/role/statically_compiled'',\r\n  }\r\n\r\n  file { ''/tmp/statically_compiled/test.txt'':\r\n    ensure  => file,\r\n    owner   => ''root'',\r\n    source  => ''puppet:///modules/role/statically_compiled/test.txt'',\r\n  }\r\n{code}\r\n\r\nroot@traveler:/usr/lib/ruby/vendor_ruby/puppet/indirector/file_metadata# service puppetmaster restart; puppet agent -t\r\n * Restarting puppet master                                                                                     [ OK ] \r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Error 400 on SERVER: Duplicate declaration: File[/tmp/statically_compiled/test.txt] is already declared in file /etc/puppet/environments/production/modules/role/manifests/traveler.pp:27; cannot redeclare\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n\r\nthe culprit is remove_existing_resources\r\n{code}\r\n...\r\n  # Remove any file resources in the catalog that will be duplicated by the\r\n  # given file resources.\r\n  #\r\n  # @param children [Array<Puppet::Resource>]\r\n  # @param catalog [Puppet::Resource::Catalog]\r\n  def remove_existing_resources(children, catalog)\r\n    existing_names = catalog.resources.collect { |r| r.to_s }\r\n    both = (existing_names & children.keys).inject({}) { |hash, name| hash[name] = true; hash }\r\n    both.each { |name| children.delete(name) }\r\n  end\r\n...\r\n{code}\r\n\r\nThe intersection between existing_names and children.keys never matches anything because existing_names are stringified resource objects (e.g. File[''/tmp/statically_compiled/test.txt'']) and children.keys are relative path strings (e.g. ''test.txt.).\r\n\r\nThe result is that the ''both'' list (hash actually, but that injection looks pretty unnecessary to me) is always empty.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5062', 'https://github.com/puppetlabs/puppet/pull/4185', '2015-08-21T04:22:02.000-0700', '2019-04-04T22:20:53.000-0700', '2019-04-04T22:20:53.000-0700', 'Closed', '', 0, '0', 1, 14, 9, 1, 'c757e9dd719bf805b7522e39707ccbf2c1529db2'),
('puppet', 86073, 38444106, 4052, 'filemode retrieved by static_compiler should be stringified', 'When a file resource is declared without an explicit mode, the mode retrieved from the metadata by the static_compiler catalog terminus is not stringified, resulting in file resources with integer file modes in the resultant catalog and a depreciation warning such as:\r\n\r\nWarning: Non-string values for the file mode property are deprecated. It must be a string, either a symbolic mode like ''o+w,a+r'' or an octal representation like ''0644'' or ''755''.\r\n   (at /usr/lib/ruby/vendor_ruby/puppet/type/file/mode.rb:69:in `block (2 levels) in <module:Puppet>'')\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4781', 'https://github.com/puppetlabs/puppet/pull/4052', '2015-06-24T06:49:57.000-0700', '2019-04-04T22:20:56.000-0700', '2019-04-04T22:20:56.000-0700', 'Closed', '', 2, '0', 1, 3, 2, 1, 'ee3c4bf4b707399659553d0354e417feecc10437'),
('puppet', 34523, 0, 0, 'puppet resource service on Solaris needs -H flag', 'On Solaris 11.2, the following behavior happens when ''puppet resource service'' runs:\r\n\r\n{noformat}\r\nroot@solaris:~# puppet resource service \r\nservice { ''FMRI'': \r\n  ensure => ''stopped'', \r\n  enable => ''false'', \r\n} \r\nservice { ''PRESERVE'': \r\n  ensure => ''stopped'', \r\n} \r\n<...>\r\n{noformat}\r\n\r\nThose entries are due to the header output of /usr/bin/svcs:\r\n\r\n{noformat}\r\n$ /usr/bin/svcs | head -5\r\nSTATE          STIME    FMRI\r\nlegacy_run      8:33:43 lrc:/etc/rc2_d/S47pppd\r\nlegacy_run      8:33:44 lrc:/etc/rc2_d/S81dodatadm_udaplt\r\nlegacy_run      8:33:44 lrc:/etc/rc2_d/S89PRESERVE\r\ndisabled        8:33:05 svc:/platform/i86pc/acpihpd:default\r\n{noformat}\r\n\r\nA possible fix is to update puppet/provider/service/smf.rb like so:\r\n\r\n{code:ruby}\r\n--- a/puppet/provider/service/smf.rb   2014-05-07 09:46:19.159462784 -0600\r\n+++ b/puppet/provider/service/smf.rb  2014-05-07 09:45:28.532934391 -0600\r\n@@ -32,7 +32,7 @@\r\n   end\r\n \r\n   def self.instances\r\n-   svcs.split("\n").select{|l| l !~ /^legacy_run/ }.collect do |line|\r\n+   svcs("-H").split("\n").select{|l| l !~ /^legacy_run/ }.collect do |line|\r\n      state,stime,fmri = line.split(/\s+/)\r\n      status =  case state\r\n                when /online/; :running\r\n{code}\r\n\r\nTo remove the headers from the output before processing each line.\r\n\r\nh3. Summary\r\nAs a result of this change, puppet will no longer report that {{FMRI}} is an installed service.', 'https://tickets.puppetlabs.com/browse/PUP-2509', 'https://github.com/puppetlabs/puppet/commit/0f5897788c661b040904abcd6080329fad666c63', '2014-05-07T08:49:46.000-0700', '2019-04-04T22:20:57.000-0700', '2019-04-04T22:20:57.000-0700', 'Closed', '', 8, '0', 0, 0, 0, 0, '0f5897788c661b040904abcd6080329fad666c63'),
('puppet', 32143, 40731662, 4101, 'Puppet will purge the /etc/hosts if it have some invalid lines', 'normally, i use puppet resource host puppet ip=xxx.xxx.xxx.xxx can add/set a domain name resolution into /etc/hosts. like this:\r\n{code:none}\r\n[root@puppet ~]# cat /etc/hosts\r\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4\r\n::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\r\n[root@puppet ~]# puppet resource host puppet ip=172.16.94.128\r\nNotice: /Host[puppet]/ensure: created\r\nhost { ''puppet'':\r\n  ensure => ''present'',\r\n  ip     => ''172.16.94.128'',\r\n  target => ''/etc/hosts'',\r\n}\r\n[root@puppet ~]# cat /etc/hosts\r\n# HEADER: This file was autogenerated at Wed Apr 16 17:57:19 +0800 2014\r\n# HEADER: by puppet.  While it can still be managed manually, it\r\n# HEADER: is definitely not recommended.\r\n127.0.0.1	localhost	localhost.localdomain localhost4 localhost4.localdomain4\r\n::1	localhost	localhost.localdomain localhost6 localhost6.localdomain6\r\n172.16.94.128	puppet\r\n{code}\r\n\r\nbut if there have some invalid text in /etc/hosts, link ''='' or '', ,'', puppet will purge that file and create a new one.\r\n\r\n{code:none}\r\n[root@puppet ~]# cat /etc/hosts\r\n# HEADER: This file was autogenerated at Wed Apr 16 17:57:19 +0800 2014\r\n# HEADER: by puppet.  While it can still be managed manually, it\r\n# HEADER: is definitely not recommended.\r\n127.0.0.1	localhost	localhost.localdomain localhost4 localhost4.localdomain4\r\n::1	localhost	localhost.localdomain localhost6 localhost6.localdomain6\r\n==\r\n[root@puppet ~]# puppet resource host puppet ip=172.16.94.128\r\nError: Could not prefetch host provider ''parsed'': Could not parse line "==" at /etc/hosts:4\r\nNotice: /Host[puppet]/ensure: created\r\nhost { ''puppet'':\r\n  ensure => ''present'',\r\n  ip     => ''172.16.94.128'',\r\n  target => ''/etc/hosts'',\r\n}\r\n[root@puppet ~]# cat /etc/hosts\r\n# HEADER: This file was autogenerated at Wed Apr 16 18:00:59 +0800 2014\r\n# HEADER: by puppet.  While it can still be managed manually, it\r\n# HEADER: is definitely not recommended.\r\n172.16.94.128	puppet\r\n{code}\r\n\r\ni checked the source code, it have three rules to check if the lines in /etc/hosts invalid.\r\n{code:none}\r\n/^#/\r\n/^\s*$/\r\n/^(\S+)\s+(\S+)\s*(.*?)?(?:\s*#\s*(.*))?$/\r\n{code}\r\nbut i think if puppet checked out there is some invalid lines, it should report error and exit, not keep going and purge my hosts file', 'https://tickets.puppetlabs.com/browse/PUP-2289', 'https://github.com/puppetlabs/puppet/pull/4101', '2014-04-16T19:38:31.000-0700', '2019-04-04T22:20:59.000-0700', '2019-04-04T22:20:59.000-0700', 'Closed', '', 9, '0', 1, 25, 0, 1, 'a2351b97c44695a0b5604ff61ba3748435bcea7f'),
('puppet', 83227, 43918928, 4205, 'Puppet service provider for SuSE should default to systemd except for version 11', 'This is based on an issue report in the openSUSE bugzilla : [Puppet is unable to manage services since it does not use systemd for Tumbleweed|https://bugzilla.novell.com/show_bug.cgi?id=931703].\r\n\r\nWhen trying to enable a service on openSUSE Tumbleweed I get an error\r\n\r\n{code}$ sudo puppet apply -e ''service {"apache2" : enable => "true" }''\r\n/usr/lib64/ruby/gems/2.2.0/gems/puppet-3.7.5/lib/puppet/defaults.rb:488: warning: duplicated key at line 489 ignored: :queue_type\r\nNotice: Compiled catalog for bla.bla in environment production in 0.26 seconds\r\nError: Could not enable apache2: Execution of ''/sbin/chkconfig --add apache2'' returned 1: apache2: unknown service\r\n\r\nNote: This output shows SysV services only and does not include native\r\nsystemd services. SysV configuration data might be overridden by native\r\nsystemd configuration.\r\n\r\nIf you want to list systemd services use ''systemctl list-unit-files''.\r\nTo see services enabled on particular target use\r\n''systemctl list-dependencies [target]''.\r\nError: /Stage[main]/Main/Service[apache2]/enable: change from false to true failed: Could not enable apache2: Execution of ''/sbin/chkconfig --add apache2'' returned 1: apache2: unknown service\r\n\r\nNote: This output shows SysV services only and does not include native\r\nsystemd services. SysV configuration data might be overridden by native\r\nsystemd configuration.\r\n\r\nIf you want to list systemd services use ''systemctl list-unit-files''.\r\nTo see services enabled on particular target use\r\n''systemctl list-dependencies [target]''.\r\nNotice: Finished catalog run in 0.26 seconds\r\n{code}\r\n\r\nHowever, the service is already enabled for me\r\n{code}$ systemctl is-enabled apache2.service\r\nenabled{code}\r\n\r\nLooking at the code at in [service/systemd.rb|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/service/systemd.rb#L13], systemd is only enabled for suse when operatingsystemmajrelease is 12 or 13. But on openSUSE Tumbleweed the version is way off by design.\r\n\r\n{code}$ facter operatingsystemmajrelease\r\n20150518{code}\r\n\r\nThe only actively supported version of (open)SuSE old enough to not have systemd is SLE 11, so my suggestion is to make systemd the default for all versions except 11.', 'https://tickets.puppetlabs.com/browse/PUP-4697', 'https://github.com/puppetlabs/puppet/pull/4205', '2015-06-04T14:19:51.000-0700', '2019-04-04T22:20:59.000-0700', '2019-04-04T22:20:59.000-0700', 'Closed', '', 8, '0', 1, 46, 32, 4, '2532e38589fc0b3b6c02e72071d5cc8b1e92558d'),
('puppet', 52270, 25396847, 3373, 'Puppet is inconsistent about :libdir setting when multiple paths provided', 'When attempting to rspec-puppet test one of my profiles modules, that has multiple module dependencies, an issue was identified whereby it wasn''t auto-loading module fixture lib dirs. \r\n\r\nExample error that was seeing was: \r\n{code}\r\nError: Could not autoload puppet/provider/domain/asadmin: cannot load such file -- puppet/provider/asadmin\r\nError: Could not autoload puppet/type/domain: Could not autoload puppet/provider/domain/asadmin: cannot load such file -- puppet/provider/asadmin\r\nError: Could not autoload puppet/type/domain: Could not autoload puppet/provider/domain/asadmin: cannot load such file -- puppet/provider/asadmin on node scratch.dt0388.test\r\n{code}\r\n\r\nThanks to _rc on IRC, was able to track the issue down to the Ruby LOAD_PATH not being set correctly: \r\n{code}\r\n/home/vagrant/.rvm/rubies/ruby-1.9.3-p547/lib/ruby/1.9.1/x86_64-linux\r\n/home/vagrant/.rvm/gems/ruby-1.9.3-p547@depend-test/gems/puppet-3.7.1/lib/puppet/vendor/safe_yaml/lib\r\n/home/vagrant/.rvm/gems/ruby-1.9.3-p547@depend-test/gems/puppet-3.7.1/lib/puppet/vendor/rgen/lib\r\n/home/vagrant/.rvm/gems/ruby-1.9.3-p547@depend-test/gems/puppet-3.7.1/lib/puppet/vendor/semantic/lib\r\n/home/vagrant/.rvm/gems/ruby-1.9.3-p547@depend-test/gems/puppet-3.7.1/lib/puppet/vendor/pathspec/lib\r\n/home/vagrant/puppet-modules/rspec-deptest/spec/fixtures/modules/glassfish/lib:/home/vagrant/puppet-modules/rspec-deptest/spec/fixtures/modules/stdlib/lib\r\n{code}\r\n\r\nThe last line above is being set by rspec-puppet in: https://github.com/rodjek/rspec-puppet/blob/master/lib/rspec-puppet/support.rb#L140, using `File::PATH_SEPARATOR` to convert the array into a string to set as :libdir. \r\n\r\nThis then lead to: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/defaults.rb#L223-L237, which is setting the LOAD_PATH to the value passed in as :libdir, without checking if the value should be split back into an array based on `File::PATH_SEPARATOR`. \r\n\r\nHowever elsewhere in the Puppet code, the libdir value is correctly being split: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/autoload.rb#L145-L153\r\n\r\nA rather hacky work-around was to modify my *spec_helper.rb*, and add: \r\n{code}\r\ndiff --git a/spec/spec_helper.rb b/spec/spec_helper.rb\r\nindex 8b91323..be8e080 100644\r\n--- a/spec/spec_helper.rb\r\n+++ b/spec/spec_helper.rb\r\n@@ -3,6 +3,8 @@ require ''puppetlabs_spec_helper/module_spec_helper''\r\n require ''hiera''\r\n require ''rspec-puppet''\r\n \r\n+$: << "spec/fixtures/modules/glassfish/lib"\r\n+\r\n RSpec.configure do |c|\r\n   c.hiera_config = ''spec/fixtures/hiera/hiera.yaml''\r\n   c.manifest_dir = ''spec/fixtures/manifests''\r\n{code}\r\n\r\nThat results in the LOAD_PATH including the glassfish/lib folder, and Ruby being able to load `puppet/provider/asadmin`. ', 'https://tickets.puppetlabs.com/browse/PUP-3336', 'https://github.com/puppetlabs/puppet/pull/3373', '2014-09-24T08:17:41.000-0700', '2019-04-04T22:21:01.000-0700', '2019-04-04T22:21:01.000-0700', 'Closed', 'docs_reviewed', 9, '0', 1, 10, 4, 3, '2139618113c7609bb5c4ee6bdd0cc626c9f39e31'),
('puppet', 107055, 69108855, 4946, 'Use rubocop in module generator', 'This is meant to enforce consistent style with ruby code and spec tests. Rubocop itself requires ruby >= 1.9.3. We still want to support ruby 1.8.7 and Puppet 3 and this code takes that into consideration.', 'https://tickets.puppetlabs.com/browse/PUP-5545', 'https://github.com/puppetlabs/puppet/pull/4946', '2015-11-24T11:06:34.000-0800', '2019-04-04T22:21:05.000-0700', '2019-04-04T22:21:05.000-0700', 'Closed', 'puppethack', 4, '0', 1, 1, 1, 1, 'f3226b4a000637704ff46d9e3a35dfa724f1a684'),
('puppet', 79276, 34991267, 3905, 'pkgin output incorrectly parsed', 'The pkgin tool adjusts it''s output when run from an interactive or non-interactive terminal by replacing spaces with semicolons. The provider was not adjusted for this and thus exhibited odd behaviour such as ''puppet resource package virt-what'' resulting in:\r\n\r\npackage { ''virt-what'':\r\n  ensure => ''1.15;Detect'',\r\n}\r\n\r\nThe PR associated with the ticket switches the ''search'' and ''list'' commands to explicitly use ''-p'' (for parsable format) eventhough it''s implied for non-interactive, and adjusts the regex accordingly.', 'https://tickets.puppetlabs.com/browse/PUP-4546', 'https://github.com/puppetlabs/puppet/pull/3905', '2015-05-08T01:59:22.000-0700', '2019-04-04T22:21:06.000-0700', '2019-04-04T22:21:06.000-0700', 'Closed', '', 2, '0', 1, 26, 16, 2, '5174c8c1944a5f2bd3c2e47a65388674fd546d1e'),
('puppet', 37791, 16578878, 2715, 'Regression with external facts pluginsync not preserving executable bit', 'As per the subject, the external facts feature in puppet 3.6.1 is partially broken.\r\n\r\nI''ve tried to add a script into the <module>/facts.d path and given it executable permissions too.\r\n\r\nOnce the agent runs, it successfully syncs the plugin across in the external facts directory (/var/lib/puppet/facts.d). However, the script lacks the original permissions.', 'https://tickets.puppetlabs.com/browse/PUP-2705', 'https://github.com/puppetlabs/puppet/pull/2715', '2014-06-01T10:43:42.000-0700', '2019-04-04T22:21:06.000-0700', '2019-04-04T22:21:06.000-0700', 'Closed', '', 12, '0', 2, 6, 5, 3, '21edcd67be35288c721cc1973b588617382db01f'),
('puppet', 56964, 23735749, 3267, 'Puppet doesn''t remove users from groups on OpenBSD', 'The -G flag of the OpenBSD usermod command doesn''t behave like most elsewhere. Instead of setting the groups, it appends the specified groups to the existing list of groups for a user. The analogue flag for Linux'' -G flag is -S on OpenBSD.', 'https://tickets.puppetlabs.com/browse/PUP-3605', 'https://github.com/puppetlabs/puppet/pull/3267', '2014-11-02T12:09:21.000-0800', '2019-04-04T22:21:06.000-0700', '2019-04-04T22:21:06.000-0700', 'Closed', '', 2, '0', 1, 112, 0, 3, '986281e1d2e45ca2f6a2a902c508c9d66e66da50'),
('puppet', 18893, 160817321, 6486, 'PR (2067): Zypper provider install options - darix', 'h2. Zypper provider install options\n\n * Author:  <>\n * Company: \n * Github ID: [darix|https://github.com/darix]\n * [Pull Request 2067 Discussion|https://github.com/puppetlabs/puppet/pull/2067]\n * [Pull Request 2067 File Diff|https://github.com/puppetlabs/puppet/pull/2067/files]\n\nh2. Pull Request Description\n----\n\nThe old code would convert\r\ninstall_options => { ''--from'' => ''foobar'' }\r\n\r\ninto a zypper call\r\n\r\nzypper install "--from ''foobar''"\r\n\r\nwhich doesnt work.\r\n\r\nnew code does\r\nzypper install --from=foobar\n\n----\n(webhooks-id: 9b0820d92f1e00eb8bf680777c22419b)\n', 'https://tickets.puppetlabs.com/browse/PUP-748', 'https://github.com/puppetlabs/puppet/pull/6486', '2013-11-14T08:08:33.000-0800', '2019-04-04T22:21:08.000-0700', '2019-04-04T22:21:08.000-0700', 'Closed', 'github', 9, '0', 2, 51, 6, 2, '5f0cb76fc3dd09aca5dd5d6441d99e64fd521bb8'),
('puppet', 71367, 30996553, 3706, 'CLONE - Puppet device displays credentials in plain text when run manually', 'The device.conf format may only contain section headers (containing the certname as the section title) and type, url, and debug configuration entries (as per https://github.com/puppetlabs/puppet/blob/3.7.4/lib/puppet/util/network_device/config.rb#L62) which means that authentication credentials are and have always been added to the {{url}} setting.\r\n\r\nWhen running the puppet device command with verbose as {{puppet device -v}} the output prints {{Info: starting applying configuration to <device> at https://<username>:<password>@<address>}} because of https://github.com/puppetlabs/puppet/blob/3.7.4/lib/puppet/application/device.rb#L172\r\n\r\nThus the output shows the full login URL from the device.conf including the password in plain text with no way to suppress this output.', 'https://tickets.puppetlabs.com/browse/PUP-4190', 'https://github.com/puppetlabs/puppet/pull/3706', '2015-03-11T16:41:59.000-0700', '2019-04-04T22:21:10.000-0700', '2019-04-04T22:21:10.000-0700', 'Closed', 'product-security', 1, '0', 1, 24, 4, 4, '45b28fbe38d79fbfe056d7450ba401b59952411c'),
('puppet', 25933, 12355174, 2342, 'PR (2342) Cron handles crontab''s equality of target and user strangely', 'When managing the target property of a cronjob, the user property uses its default instead (which is the user running puppet). To the crontab provider, these are basically the same, and there is code to handle them equally. Through the mixtures of defaults and actual supplied values, though, bizarre behaviors come up:\r\n\r\n{code}\r\n# HEADER: This file was autogenerated at 2014-02-09 20:31:59 +0100 by puppet.\r\n# HEADER: While it can still be managed manually, it is definitely not recommended.\r\n# HEADER: Note particularly that the comments starting with ''Puppet Name'' should\r\n# HEADER: not be deleted, as doing so could cause duplicate cron jobs.\r\n# Puppet Name: bacula_vacuumdb\r\n0 12 * * * vacuumdb --analyze -U postgres bacula\r\n{code}\r\n\r\nRunning this manifest should not cause a sync:\r\n{code}\r\ncron { ''bacula_vacuumdb'':\r\nensure => present,\r\nminute => ''00'',\r\nhour => ''12'',\r\ncommand => ''vacuumdb --analyze -U postgres bacula'',\r\ntarget => ''ffrank'',\r\n}\r\n{code}\r\n\r\nBut this happens:\r\n{code}\r\n# RUBYLIB=lib puppet apply /tmp/target.pp \r\n/Stage[main]//Cron[bacula_vacuumdb]/user: user changed ''ffrank'' to ''root''\r\nFinished catalog run in 0.39 seconds\r\n{code}\r\n\r\nNote that this bug is currently masked by PUP-1585, which introduces an even worse misbehavior. Both will need to be fixed in unison.', 'https://tickets.puppetlabs.com/browse/PUP-1624', 'https://github.com/puppetlabs/puppet/pull/2342', '2014-02-09T12:27:43.000-0800', '2019-04-04T22:21:12.000-0700', '2019-04-04T22:21:12.000-0700', 'Closed', 'type_cron', 5, '0', 4, 29, 8, 5, 'b0df220a8d9e5320d433fe672ce1f408b3889063'),
('puppet', 38425, 16890035, 2753, 'user purge_ssh_keys cannot remove keys with spaces in the comment', 'Given the following:\r\n\r\n{noformat}\r\n# /root/.ssh/authorized_keys\r\n# HEADER: This file was autogenerated at Fri Jun 06 16:59:39 +0000 2014\r\n# HEADER: by puppet.  While it can still be managed manually, it\r\n# HEADER: is definitely not recommended.\r\nssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key\r\n{noformat}\r\n\r\n{code}\r\nuser { ''root'':\r\n  purge_ssh_keys => true,\r\n  home => ''/root''\r\n}\r\n{code}\r\n\r\n{noformat}\r\n[root@default puppet]# bundle exec puppet apply ~/purge-ssh.pp --noop --debug\r\nWarning: Could not retrieve fact fqdn\r\nDebug: Failed to load library ''shadow'' for feature ''libshadow''\r\nNotice: Compiled catalog for default in environment production in 0.13 seconds\r\n[snip]\r\nDebug: Finishing transaction -610461438\r\nDebug: Loaded state in 0.00 seconds\r\nDebug: Loaded state in 0.00 seconds\r\nInfo: Applying configuration version ''1402075867''\r\nDebug: Prefetching parsed resources for ssh_authorized_key\r\nDebug: /Stage[main]/Main/Ssh_authorized_key[key]: Nothing to manage: no ensure and the resource doesn''t exist\r\nDebug: Finishing transaction -611010748\r\nDebug: Storing state\r\nDebug: Stored state in 0.01 seconds\r\nNotice: Finished catalog run in 0.08 seconds\r\n{code}\r\n\r\nThe title for the vagrant insecure public key is not fetched correctly and thus cannot be removed.', 'https://tickets.puppetlabs.com/browse/PUP-2737', 'https://github.com/puppetlabs/puppet/pull/2753', '2014-06-06T10:33:37.000-0700', '2019-04-04T22:21:13.000-0700', '2019-04-04T22:21:13.000-0700', 'Closed', '', 5, '0', 3, 18, 7, 6, '94e56be286fab28464de87c9a33c48f770e6ce40'),
('puppet', 74061, 33085218, 3807, 'Default service type and package provider not set on Cumulus Linux', 'The default package and service provider are set by the operatingsystem fact. Cumulus Linux uses "CumulusLinux" as this fact (it is derived from Debian Linux) and is not correctly detected.  \r\n\r\nA patch/pull request is forthcoming later today. ', 'https://tickets.puppetlabs.com/browse/PUP-4351', 'https://github.com/puppetlabs/puppet/pull/3807', '2015-03-31T11:28:20.000-0700', '2019-04-04T22:21:17.000-0700', '2019-04-04T22:21:17.000-0700', 'Closed', '', 4, '0', 1, 13, 0, 2, 'a5d9b0860b7ab77ce2520599de6ddcdb9f5b969e'),
('puppet', 56230, 23396867, 3239, 'Debian init script status and stop actions are unsafe', 'Calling {{/etc/init.d/puppet stop}} does not guarantee that the process being stopped is actually puppet agent process. {{start-stop-daemon}} will kill any process which PID happens to be the same as the one stored in {{/var/run/puppet/agent.pid}}.\r\n\r\nThe same applies to {{/etc/init.d/puppet status}}. It calls {{status_of_proc}} internally, but that does not verify if processes'' exe is actually puppet. So if there is any other process with the same PID as in {{/var/run/puppet/agent.pid}} then {{/etc/init.d/puppet status}} will return true.\r\n\r\nAttached is a proposed patch to check in start-stop-daemon the exe name and to remove pid file after stopping the agent.', 'https://tickets.puppetlabs.com/browse/PUP-3549', 'https://github.com/puppetlabs/puppet/pull/3239', '2014-10-27T05:28:10.000-0700', '2019-04-04T22:21:18.000-0700', '2019-04-04T22:21:18.000-0700', 'Closed', 'puppet-agent', 3, '0', 1, 4, 2, 1, 'a95b487600c270313b77b3501133f008fa79bad7'),
('puppet', 265184, 204550139, 6950, 'puppet-agent-5.5.4-1.el6.x86_64 on Scientfic Linux 6 fails to use upstart', 'When running our Upstart Application ''gatekeeper'' (or any other application). 5.5.4 claims '' Provider upstart is not functional on this host'':\r\n{code:java}\r\n/opt/puppetlabs/puppet/bin/puppet apply --config /etc/puppetlabs/puppet/puppet.conf --execute "service {''gatekeeper'': ensure => ''running'', provider => ''upstart''}"\r\nNotice: Compiled catalog for zymevault.dev.zymeworks.com in environment production in 0.21 seconds\r\nError: /Stage[main]/Main/Service[gatekeeper]: Provider upstart is not functional on this host\r\nNotice: Applied catalog in 0.07 second{code}\r\nDowngrading to 5.5.3 fixes:\r\n\r\n\r\n\r\n \r\n{code:java}\r\nyum -y downgrade puppet-agent\r\nLoaded plugins: security, versionlock\r\nSetting up Downgrade Process\r\nResolving Dependencies\r\n--> Running transaction check\r\n---> Package puppet-agent.x86_64 0:5.5.3-1.el6 will be a downgrade\r\n---> Package puppet-agent.x86_64 0:5.5.4-1.el6 will be erased\r\n--> Finished Dependency Resolution\r\nDependencies Resolved\r\n===================================================================================================================================================================================================================================\r\n Package Arch Version Repository Size\r\n===================================================================================================================================================================================================================================\r\nDowngrading:\r\n puppet-agent x86_64 5.5.3-1.el6 puppet5 21 M\r\nTransaction Summary\r\n===================================================================================================================================================================================================================================\r\nDowngrade 1 Package(s)\r\nTotal download size: 21 M\r\nDownloading Packages:\r\npuppet-agent-5.5.3-1.el6.x86_64.rpm | 21 MB 00:02\r\nRunning rpm_check_debug\r\nRunning Transaction Test\r\nTransaction Test Succeeded\r\nRunning Transaction\r\n Installing : puppet-agent-5.5.3-1.el6.x86_64 1/2\r\n Cleanup : puppet-agent-5.5.4-1.el6.x86_64 2/2\r\n Verifying : puppet-agent-5.5.3-1.el6.x86_64 1/2\r\n Verifying : puppet-agent-5.5.4-1.el6.x86_64 2/2\r\nRemoved:\r\n puppet-agent.x86_64 0:5.5.4-1.el6\r\nInstalled:\r\n puppet-agent.x86_64 0:5.5.3-1.el6\r\nComplete!\r\n[root@zymevault ~]# /opt/puppetlabs/puppet/bin/puppet apply --config /etc/puppetlabs/puppet/puppet.conf --execute "service {''gatekeeper'': ensure => ''running'', provider => ''upstart''}"\r\nNotice: Compiled catalog for zymevault.dev.zymeworks.com in environment production in 0.21 seconds\r\nNotice: Applied catalog in 0.08 seconds\r\n \r\n{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9008', 'https://github.com/puppetlabs/puppet/pull/6950', '2018-07-17T15:10:55.000-0700', '2019-04-04T22:21:18.000-0700', '2019-04-04T22:21:18.000-0700', 'Closed', 'docs_reviewed;linux;redhat;regression;service;upstart', 10, '0', 1, 47, 2, 2, 'c6ee7ddcb80f2ec4be03edcafade20d1853a4aee'),
('puppet', 22527, 11096959, 2185, 'Hiding error details in fileserver.conf parser  when this config is wrong', 'When I try to apply simple manifest  _test.pp_ which is just tries to copy file from puppet master using *puppet://* schema, I receive following error at client node:\r\n{code}\r\nError: /Stage[main]//File[/tmp/example-file.txt]: Could not evaluate: Error 403 on SERVER: Forbidden request: mel4102.melesta.local(10.32.32.111) access to /file_metadata/custom_files/example-file.txt [find] at :129 Could not retrieve file metadata for puppet://puppet/custom_files/example-file.txt: Error 403 on SERVER: Forbidden request: mel4102.melesta.local(10.32.32.111) access to /file_metadata/custom_files/example-file.txt [find] at :129\r\n{code}\r\n\r\n\r\nAt puppet master logs, when I run it in foreground with this command line\r\n{code}\r\nsudo puppet master --debug --no-daemonize\r\n{code}\r\n\r\nI''ve found following error:\r\n{code}\r\nError parsing fileserver configuration: wrong number of arguments (3 for 1); using old configuration\r\n{code}\r\n\r\nI''ve spend half of my working day for debugging this issue and I''ve discovered than this it happens when there is some invalid line in */etc/puppet/fileserver.conf*. In my case it was some strange symbols ''\xc2\xa0\xc2\xa0'' occured in this file, probably after copy-pasting from my browser window into *fileserver.conf*. \r\n\r\nMy next step was to look into *fileserver.conf* parser and I''ve found the bug  in *lib/puppet/file_serving/configuration/parser.rb*. Because of invalid raising an *ArgumentError* exception, actual useful information about mistakes in *fileserver.conf* is lost. \r\nI think this behaviour is wrong and should be fixed.\r\n\r\nHere is the simple patch with fixing of this mistake + 2 test-cases. \r\nI''ll create a pull request after filling this bug ASAP.', 'https://tickets.puppetlabs.com/browse/PUP-1246', 'https://github.com/puppetlabs/puppet/pull/2185', '2013-12-26T06:33:16.000-0800', '2019-04-04T22:21:20.000-0700', '2019-04-04T22:21:20.000-0700', 'Closed', 'puppet-fileserver', 3, '0', 1, 14, 2, 2, '81242661c28f5b62f92ac83f8b127047392c1cd3'),
('puppet', 60562, 25552167, 3387, 'Puppet acceptance requires the master to have the agent role', 'Currently windows acceptance tests use a windows agent and a rhel master, and historically the rhel master also has the agent role. This roughly increases the test time x2 because most of the tests need to be tested against the windows and rhel agents. Since we test rhel agents as part of linux acceptance, including the case where the agent+master roles are on the same host, we don''t need to duplicate that effort during windows acceptance.\r\n\r\nHowever, puppet acceptance setup currently fails if the agent role is removed from the master trying to backup /etc/puppet/puppet.conf which doesn''t exist:\r\n\r\n{noformat}\r\n  * Grab version for puppetlabs-puppet\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) 21:21:45$  cd /opt/puppet-git-repos/puppetlabs-puppet && git describe || true\r\n3.7.3-804-g00b38df\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) executed in 0.14 seconds\r\n\r\n  * Agents: create basic puppet.conf\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) 21:21:45$  echo ''[agent]'' > `cygpath -smF 35`/PuppetLabs/puppet/etc/puppet.conf && echo server=tf333gqn5ykgux7.delivery.puppetlabs.net >> `cygpath -smF 35`/PuppetLabs/puppet/etc/puppet.conf\r\ncygwin warning:\r\n  MS-DOS style path detected: C:/PROGRA~3/PuppetLabs/puppet/etc/puppet.conf\r\n  Preferred POSIX equivalent is: /cygdrive/c/PROGRA~3/PuppetLabs/puppet/etc/puppet.conf\r\n  CYGWIN environment variable option "nodosfilewarning" turns off this warning.\r\n  Consult the user''s guide for more details about POSIX paths:\r\n    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) executed in 0.10 seconds\r\nsetup/git/pre-suite/010_TestSetup.rb passed in 62.29 seconds\r\nBegin setup/git/pre-suite/020_PuppetUserAndGroup.rb\r\n\r\nPuppet User and Group\r\n\r\n  * ensure puppet user and group added to all nodes because this is what the packages do\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:45$  env PATH="/usr/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" RUBYLIB="/opt/puppet-git-repos/hiera/lib:/opt/puppet-git-repos/hiera-puppet/lib:${RUBYLIB}" puppet resource user puppet ensure=present\r\nNotice: /User[puppet]/ensure: created\r\nuser { ''puppet'':\r\n  ensure => ''present'',\r\n}\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.90 seconds\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:46$  env PATH="/usr/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" RUBYLIB="/opt/puppet-git-repos/hiera/lib:/opt/puppet-git-repos/hiera-puppet/lib:${RUBYLIB}" puppet resource group puppet ensure=present\r\ngroup { ''puppet'':\r\n  ensure => ''present'',\r\n}\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.59 seconds\r\n\r\n  * ensure puppet user and group added to all nodes because this is what the packages do\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) 21:21:46$  env PATH="$( [ -d "/cygdrive/c/Program Files (x86)/Puppet Labs/Puppet/bin" ] && echo "/cygdrive/c/Program Files (x86)" || echo "/cygdrive/c/Program Files" )/Puppet Labs/Puppet/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" RUBYLIB="`cygpath -w /opt/puppet-git-repos/hiera/lib`;`cygpath -w /opt/puppet-git-repos/hiera-puppet/lib`;${RUBYLIB}" cmd.exe /c puppet resource user puppet ensure=present\r\nNotice: /User[puppet]/ensure: created\r\nuser { ''puppet'':\r\n  ensure => ''present'',\r\n}\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) executed in 1.73 seconds\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) 21:21:48$  env PATH="$( [ -d "/cygdrive/c/Program Files (x86)/Puppet Labs/Puppet/bin" ] && echo "/cygdrive/c/Program Files (x86)" || echo "/cygdrive/c/Program Files" )/Puppet Labs/Puppet/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" RUBYLIB="`cygpath -w /opt/puppet-git-repos/hiera/lib`;`cygpath -w /opt/puppet-git-repos/hiera-puppet/lib`;${RUBYLIB}" cmd.exe /c puppet resource group puppet ensure=present\r\nError: Cannot create group if user ''puppet'' exists.\r\nError: /Group[puppet]/ensure: change from absent to present failed: Cannot create group if user ''puppet'' exists.\r\ngroup { ''puppet'':\r\n  ensure => ''absent'',\r\n}\r\n\r\nmai9vmv1ujj75p2.delivery.puppetlabs.net (agent-2008r2-x86_64-rubyx86) executed in 1.21 seconds\r\nsetup/git/pre-suite/020_PuppetUserAndGroup.rb passed in 4.42 seconds\r\nBegin setup/common/pre-suite/025_StopFirewall.rb\r\n\r\nStop firewall\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:49$  env PATH="/usr/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" RUBYLIB="/opt/puppet-git-repos/hiera/lib:/opt/puppet-git-repos/hiera-puppet/lib:${RUBYLIB}" puppet resource  service firewalld ensure=stopped\r\nservice { ''firewalld'':\r\n  ensure => ''stopped'',\r\n}\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.63 seconds\r\nNot sure how to clear firewall on windows-2008r2-64\r\nsetup/common/pre-suite/025_StopFirewall.rb passed in 0.63 seconds\r\nBegin setup/git/pre-suite/030_PuppetMasterSanity.rb\r\n\r\nPuppet Master sanity checks: PID file and SSL dir creation\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:50$  facter hostname\r\ntf333gqn5ykgux7\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.13 seconds\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:50$  facter fqdn\r\ntf333gqn5ykgux7.delivery.puppetlabs.net\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.13 seconds\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:50$  mktemp -dt 030_PuppetMasterSanity.rb.XXXXXX\r\n/tmp/030_PuppetMasterSanity.rb.YI6UB2\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.05 seconds\r\nSetting curl retries to 30\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:50$  test -e /etc/puppet/puppet.conf\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.05 seconds\r\nExited: 1\r\nWarning: Could not backup file ''/etc/puppet/puppet.conf'': no such file\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) 21:21:50$  cat /etc/puppet/puppet.conf\r\ncat: /etc/puppet/puppet.conf: No such file or directory\r\n\r\ntf333gqn5ykgux7.delivery.puppetlabs.net (master) executed in 0.05 seconds\r\nExited: 1\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3739', 'https://github.com/puppetlabs/puppet/pull/3387', '2014-12-04T10:04:56.000-0800', '2019-04-04T22:21:23.000-0700', '2019-04-04T22:21:23.000-0700', 'Closed', '', 2, '0', 1, 16, 18, 3, '302292298e3e1431d26e17551b7e52c104c93fb0'),
('puppet', 122085, 63335702, 4797, 'Wrong selinux type for files in symlinked directories', 'matchpathcon does only act on the passed string and not resolve the real path problematic if puppet manages /etc/init.d/script on RHEL which symlinks /etc/init.d to /etc/rc.d/init.d. matchpathcon will return the wrong label.\r\n\r\nThis mimics restorecon behaviour.\r\n\r\nh3. Example restorecon vs. matchpathcon\r\n{noformat}\r\n[root@el6 util]# matchpathcon /etc/init.d/sshd\r\n/etc/init.d/sshd        system_u:object_r:initrc_exec_t:s0\r\n[root@el6 util]# matchpathcon /etc/rc.d/init.d/sshd\r\n/etc/rc.d/init.d/sshd   system_u:object_r:sshd_initrc_exec_t:s0\r\n\r\n[root@el6 util]# ls -lZ /etc/init.d/sshd\r\n-rwxr-xr-x. root root system_u:object_r:initrc_exec_t:s0 /etc/init.d/sshd\r\n[root@el6 util]# restorecon -v /etc/init.d/sshd\r\nrestorecon reset /etc/rc.d/init.d/sshd context system_u:object_r:initrc_exec_t:s0->system_u:object_r:sshd_initrc_exec_t:s0\r\n{noformat}\r\n\r\n\r\nh3. Possible problems fixing this\r\nusers maybe have added wrong selinux fcontext rules. If puppet now applies the new "correct" type it''s maybe not wrongly configured one', 'https://tickets.puppetlabs.com/browse/PUP-6071', 'https://github.com/puppetlabs/puppet/pull/4797', '2016-03-18T00:04:59.000-0700', '2019-04-04T22:21:24.000-0700', '2019-04-04T22:21:24.000-0700', 'Closed', '', 3, '0', 1, 19, 2, 1, ''),
('puppet', 14946, 33594139, 3846, 'Backslashify windows paths when appropriate', 'When installing an MSI, the windows package provider passes the package source parameter to msiexec.exe. Unfortunately, it <b>must</b> use backslashes, otherwise, msiexec thinks it''s a command line argument and will fail with a cryptic error: <pre>Failed to install: Fail on INT 24.</pre>\r\nThe windows package provider should automatically convert the source to backslashes so that it just works.', 'https://tickets.puppetlabs.com/browse/PUP-398', 'https://github.com/puppetlabs/puppet/pull/3846', '2013-09-19T00:21:29.000-0700', '2019-04-04T22:21:24.000-0700', '2019-04-04T22:21:24.000-0700', 'Closed', 'windows', 6, '0', 2, 18, 22, 1, '20e0dcdb4c4a316f060b9e6a3ca5a468f96b33a0'),
('puppet', 79934, 35356297, 3931, '''bsd'' service provider doesn''t work with rcng', 'Enabling services with rcng (NetBSD''s rc system) doesn''t work with the ''bsd'' service provider. It writes ''foo_enable="YES"'' but that returns an error with rcng.\r\n\r\nA new provider subclassing the ''bsd'' provider should be added to fix this.', 'https://tickets.puppetlabs.com/browse/PUP-4602', 'https://github.com/puppetlabs/puppet/pull/3931', '2015-05-13T03:48:20.000-0700', '2019-04-04T22:21:24.000-0700', '2019-04-04T22:21:24.000-0700', 'Closed', '', 1, '0', 1, 93, 1, 3, 'e0decb8d690823652144aa17bf7fd1bccac844dd'),
('puppet', 92572, 0, 0, 'Some of the user attributes in Aix could be UPPERCASE', 'Aix user attributes should maintain the original casing. \r\n\r\nWe where experiencing a strange behavior with some users configured with Kerberos authentication.\r\n\r\nHaving Krb configured for a user implies setting its "SYSTEM" attribute to a value of "KRB5Afiles".\r\n\r\nIn hiera this was the (redacted) definition of one such users:\r\n{noformat}\r\n  xxxxx:\r\n    ensure: present\r\n    comment: XXXXXX\r\n    gid: ''xxxxx''\r\n    groups:\r\n    - ssh_grp\r\n    managehome: ''true''\r\n    attributes:\r\n    - SYSTEM=KRB5Afiles\r\n    - registry=KRB5Afiles\r\n    - auth_domain=DOMAIN.AD\r\n    home: "%{::default_home}/xxxxx"\r\n    shell: "%{::default_shell}"\r\n    uid: ''xxxxx''\r\n{noformat}\r\n\r\nAnd this is the (redacted) output from "lsuser -c xxxxx":\r\n{noformat}\r\n#name:id:pgrp:groups:home:shell:gecos:login:su:rlogin:daemon:admin:sugroups:tpath:ttys:expires:auth1:auth2:umask:registry:SYSTEM:loginretries:pwdwarntime:account_locked:minage:maxage:maxexpired:minalpha:minother:mindiff:maxrepeats:minlen:histexpire:histsize:auth_domain:fsize:cpu:data:stack:core:rss:nofiles:stack_hard:time_last_login:tty_last_login:host_last_login:unsuccessful_login_count\r\nxxxxx:xxxxx:adm_nix:adm_nix,ssh_grp:/home/xxxxx:/usr/bin/bash:XXXXX:true:true:true:true:false:ALL:nosak:ALL:0:SYSTEM:NONE:22:KRB5Afiles:KRB5Afiles:0:0:false:0:0:-1:0:0:0:8:0:0:0:DOMAIN.AD:-1:-1:-1:-1:-1:-1:-1:-1:1435654795:/dev/pts/4:10.X.X.X:0\r\n{noformat}\r\n\r\nRunning puppet resulted in the users always been updated, at every run, because the "SYSTEM" (UPCASE string) field from _lsuser_ command was converted to a ":system"  (downcase symbol) property. This caused a mismatch between the expected attribute keys and what was parsed from _lsuser_ output, causing the provider to think the user was missing one of the managed attributes at each run.', 'https://tickets.puppetlabs.com/browse/PUP-5015', 'https://github.com/puppetlabs/puppet/commit/f7a8d42a1bde66c7be1a9b835ec8a3dacc4bb031', '2015-08-10T05:07:33.000-0700', '2019-04-04T22:21:26.000-0700', '2019-04-04T22:21:26.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, 'f7a8d42a1bde66c7be1a9b835ec8a3dacc4bb031'),
('puppet', 56645, 23557435, 3256, 'module skeleton should not require rubygems ', 'As per [~andy], we should not require rubygems. Currently this is added to all Rakefile''s when generating modules.', 'https://tickets.puppetlabs.com/browse/PUP-3569', 'https://github.com/puppetlabs/puppet/pull/3256', '2014-10-29T12:22:36.000-0700', '2019-04-04T22:21:27.000-0700', '2019-04-04T22:21:27.000-0700', 'Closed', '', 3, '0', 1, 0, 1, 1, '04193daf4b80f6b4e7cdaa2d065d69175397c508'),
('puppet', 51210, 23434653, 3246, 'Win32::TaskScheduler#trigger_string doesn''t work', 'Our vendored `Win32::TaskScheduler#trigger_string` method doesn''t define the `trigger` variable, so the reference to `trigger` on line 576 will cause the `#trigger` method to be invoked with 0 arguments, and that fails with:\r\n\r\n{noformat}\r\nin `trigger'': wrong number of arguments (0 for 1) (ArgumentError)\r\n{noformat}\r\n\r\nThis code path doesn''t occur in Puppet, just when using puppet as a library.', 'https://tickets.puppetlabs.com/browse/PUP-3247', 'https://github.com/puppetlabs/puppet/pull/3246', '2014-09-15T10:43:01.000-0700', '2019-04-04T22:21:28.000-0700', '2019-04-04T22:21:28.000-0700', 'Closed', 'windows', 5, '0', 1, 0, 21, 1, 'f9811623352976284a75efef5db833ee89476587'),
('puppet', 63530, 27153941, 3468, 'pip package provider is broken on EL (where osfamily is RedHat)', 'https://groups.google.com/forum/#!topic/puppet-users/2wOLKZ2SokQ\r\n\r\nTo duplicate, on an EL system (I used EL7) install `python-pip` then run `puppet apply -d pip.pp` with the code below in pip.pp\r\n\r\n{code}\r\npackage { ''s3cmd'':\r\n  ensure   => present,\r\n  provider => pip,\r\n{code}\r\n\r\nError\r\n{code}\r\nError: Could not set ''present'' on ensure: Could not locate the pip command.\r\n{code}\r\n\r\nFix:\r\nThe code is looking for `python-pip` as the binary when osfamily is ''RedHat'' which is incorrect. Confirmed by symlinking /usr/bin/python-pip -> /usr/bin/pip and then it worked.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3829', 'https://github.com/puppetlabs/puppet/pull/3468', '2015-01-10T12:06:30.000-0800', '2019-04-04T22:21:29.000-0700', '2019-04-04T22:21:29.000-0700', 'Resolved', '', 34, '0', 1, 4, 9, 2, '6ee0339675e7460073483ebc74d4136b27687ae9'),
('puppet', 15942, 33555570, 3841, '(PR) (22617) In Augeas onlyif, compare number strings numerically', 'Without this patch applied, onlyif comparitors <, >, <=, and >= always\r\ndo string comparisions, even when the strings are numbers. This\r\nmakes it impossible to enforce relative policy, such as:\r\n\r\nonlyif => ''get PASS_MAX_DAYS > 90'',\r\nin login.defs, for example. If PASS_MAX_DAYS had the value 120, the\r\nonlyif would evaluate false (not need-to-run). See ticket for more details.\r\n\r\nWithout this patch, onlyif uses string comparison, such that 120 < 90.\r\n\r\nThis patch converts strings to integers and uses numeric comparison\r\nwhen both operands of the relative comparitor are valid numbers.\r\n\r\nThis patch also fixes another bug that isn''t reported in a ticket, namely\r\nthat the parser erroneously converts ">=" to ">" and "<=" to "<".', 'https://tickets.puppetlabs.com/browse/PUP-442', 'https://github.com/puppetlabs/puppet/pull/3841', '2013-10-01T11:31:43.000-0700', '2019-04-04T22:21:29.000-0700', '2019-04-04T22:21:29.000-0700', 'Closed', '', 1, '0', 1, 2, 2, 2, 'd3013094fda59d595bc097c9d33605f49f344bd9'),
('puppet', 92571, 42013178, 4145, 'Base class for JSON/msgpack indirection termini calls log_exception() wrong', 'In Puppet::Indirector::JSON, Puppet.log_exception() is called without the required exception as the first argument value, instead the message is passed.\r\n\r\n{code}\r\nPuppet.log_exception "Could not save #{self.name} #{request.key}: #{detail}"\r\n{code}\r\nWhile it should really be:\r\n{code}\r\nPuppet.log_exception(detail, "Could not save #{self.name} #{request.key}: #{detail}")\r\n{code}\r\n\r\nThis breaks further along in format_exception() as it attempts to get the exception message attribute but finds a string:\r\n\r\nError: Could not retrieve catalog from remote server: undefined method `message'' for #<String:0x00000003efda28>\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/util/logging.rb:70:in `format_exception''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/util/logging.rb:45:in `log_exception''\r\n/var/lib/puppet/lib/puppet/indirector/catalog/json_timestamped.rb:18:in `rescue in save''\r\n/var/lib/puppet/lib/puppet/indirector/catalog/json_timestamped.rb:13:in `save''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/indirector/indirection.rb:206:in `find''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/configurer.rb:294:in `block in retrieve_new_catalog''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/util.rb:335:in `block in thinmark''\r\n/opt/ruby2.0/lib/2.0.0/benchmark.rb:296:in `realtime''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/util.rb:334:in `thinmark''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/configurer.rb:293:in `retrieve_new_catalog''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/configurer.rb:61:in `retrieve_catalog''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/configurer.rb:106:in `prepare_and_retrieve_catalog''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/configurer.rb:202:in `run_internal''\r\n/opt/ruby2.0/lib/vendor_ruby/2.0.0/puppet/configurer.rb:134:in `block in run''\r\n...\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5014', 'https://github.com/puppetlabs/puppet/pull/4145', '2015-08-10T05:02:40.000-0700', '2019-04-04T22:21:30.000-0700', '2019-04-04T22:21:30.000-0700', 'Closed', '', 3, '0', 1, 2, 2, 2, '9d2e0edd69f50d47ad9faa2aaa32296cf91660ad'),
('puppet', 15962, 35359755, 3932, '(PR) (#22665) mounts should autorequire parent mounts', 'Given two mount points:\r\n\r\nmount { "/var/log":\r\n  # ...\r\n}\r\n\r\nmount { "/var":\r\n  # ...\r\n}\r\nThe mount ''/var/log'' should autorequire ''/var'' so that the child mount\r\nis not masked by the parent mount.', 'https://tickets.puppetlabs.com/browse/PUP-450', 'https://github.com/puppetlabs/puppet/pull/3932', '2013-10-01T12:48:41.000-0700', '2019-04-04T22:21:31.000-0700', '2019-04-04T22:21:31.000-0700', 'Closed', '', 3, '0', 2, 77, 9, 6, '2edafd50c2d5a34ca8b51bad38e6845e6098dd96'),
('puppet', 114855, 58024443, 4616, 'Yum provider incorrectly computes epoch for RPM package versions', 'There is a bug in the `yum_parse_evr` code that the yum package provider uses to parse version strings into epoch, version, release hashes:\r\n\r\n {code:ruby}\r\n def yum_parse_evr(s)\r\n    ei = s.index('':'')\r\n    if ei\r\n      e = s[0,ei]\r\n      s = s[ei+1,s.length]\r\n    else\r\n      e = nil\r\n    end\r\n    e = String(Bignum(e)) rescue ''0''\r\n   # ...\r\n{code}\r\n\r\n{{Bignum()}} is not a function. This causes all epochs to throw an error and be coerced into ''0''.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5802', 'https://github.com/puppetlabs/puppet/pull/4616', '2016-02-02T09:46:36.000-0800', '2019-04-04T22:21:33.000-0700', '2019-04-04T22:21:33.000-0700', 'Closed', '', 7, '0', 1, 14, 2, 2, 'f147025d3d99e8589ca4d7a2f13caea7b3a1cfe8'),
('puppet', 109792, 53864442, 4508, 'agent stalls when connection with master is dropped', 'I noticed some agents stopped reporting suddenly. I logged in to one of the nodes and run "ps", and I noticed the agent process was in "sleep" state since several days, just doing nothing.\r\n\r\nHere''s what I figured out: when the network socket opened with the master is dropped without getting properly closed (network issue, master died, etc) the agent waits for a response forever, which prevents further agent runs because of /opt/puppetlabs/puppet/cache/state/agent_catalog_run.lock.\r\n\r\nThe issue lies in ruby''s net/http library, which doesn''t set the keepalive bit on the socket it creates by default: https://github.com/ruby/ruby/blob/ruby_2_2/lib/net/http.rb#L881\r\n\r\nHere is what a connection from the agent to the master looks like, notice the "off" and all the timers set to 0:\r\n{code}\r\n$ netstat -nto | grep 8140\r\ntcp        0      0 10.27.70.16:45865       1.2.3.4:8140      ESTABLISHED off (0.00/0/0)\r\n{code}\r\nCompare this to an elasticsearch cluster connection for example:\r\n{code}\r\ntcp6       0      0 10.27.70.16:9300        10.27.70.132:54637      ESTABLISHED keepalive (1880.31/0/0)\r\n{code}\r\n\r\nstrace show well what misses:\r\n{code}\r\nstrace -fe setsockopt /opt/puppetlabs/bin/puppet agent -t --noop\r\n[...]\r\n23566 setsockopt(8, SOL_TCP, TCP_NODELAY, [1], 4) = 0\r\n[...]\r\n{code}\r\ncompare this with curl''s default settings:\r\n{code}\r\nstrace -fe setsockopt /usr/bin/curl -k https://1.2.3.4:8140\r\nsetsockopt(3, SOL_SOCKET, SO_KEEPALIVE, [1], 4) = 0\r\nsetsockopt(3, SOL_TCP, TCP_KEEPIDLE, [60], 4) = 0\r\nsetsockopt(3, SOL_TCP, TCP_KEEPINTVL, [60], 4) = 0\r\n{code}\r\n\r\nI have a patch for this I''ll submit to github in a moment. I''ll also deploy it to our fleet and report back here in a couple of days.', 'https://tickets.puppetlabs.com/browse/PUP-5617', 'https://github.com/puppetlabs/puppet/pull/4508', '2015-12-16T08:14:49.000-0800', '2019-04-04T22:21:35.000-0700', '2019-04-04T22:21:35.000-0700', 'Closed', '', 5, '0', 3, 42, 0, 3, '358e37e8423066087ae82b0ead3ffe50c10a209c'),
('puppet', 27094, 13711282, 2447, 'PR (2383): Suse chkconfig --check boot.<service> always returns 1 whether the service is enabled/disabled. - m4ce', 'h2. Suse chkconfig --check boot.<service> always returns 1 whether the service is enabled/disabled.\n\n * Author: Matteo <>\n * Company: \n * Github ID: [m4ce|https://github.com/m4ce]\n * [Pull Request 2383 Discussion|https://github.com/puppetlabs/puppet/pull/2383]\n * [Pull Request 2383 File Diff|https://github.com/puppetlabs/puppet/pull/2383/files]\n\nh2. Pull Request Description\n----\n\nThe following changes fix this by checking the output of chkconfig boot.<service>. If it ends with off, the service is disabled.\r\n\r\nMind that chkconfig --check works as expected with all the other services that don''t start with boot.\n\n----\n(webhooks-id: ae418bab39b72aeac5eb15a9c5cf9836)\n', 'https://tickets.puppetlabs.com/browse/PUP-1751', 'https://github.com/puppetlabs/puppet/pull/2447', '2014-02-23T11:47:41.000-0800', '2019-04-04T22:21:36.000-0700', '2019-04-04T22:21:36.000-0700', 'Closed', 'github', 5, '0', 2, 24, 7, 2, 'e62a2f3cf6a5d389398aeeb2c8636d16e56ac31a'),
('puppet', 25991, 28862170, 3586, '"current thread not owner" after Puppet Agent receives USR1 signal', 'We''re running the Puppet Agent daemonised, with {{splay}} enabled. We use the {{USR1}} signal to trigger an immediate reload and catalog run, bypassing the splay setting.\r\n\r\nThis works fine in our other Ruby environment (1.9.3, various patch levels), but when testing under Ruby 2.0.0 and 2.1.0, we noticed that the signal would cause the catalog run to fail due to the following errors:\r\n\r\n{quote}\r\nFailed to apply catalog: Could not autoload puppet/feature/external_facts: current thread not owner\r\nCould not autoload puppet/feature/external_facts: current thread not owner\r\nCould not autoload puppet/indirector/node/rest: current thread not owner\r\n{quote}\r\n\r\nA restart of the daemon is required to recover from this.', 'https://tickets.puppetlabs.com/browse/PUP-1635', 'https://github.com/puppetlabs/puppet/pull/3586', '2014-02-10T12:38:52.000-0800', '2019-04-04T22:21:36.000-0700', '2019-04-04T22:21:36.000-0700', 'Closed', 'ruby2.0.0;ruby2.1.0', 22, '0', 1, 13, 6, 2, '4f8fd24f5ae60c04684cef593a64efd65adc1841'),
('puppet', 48391, 19992037, 2992, 'Error in puppet module skeleton', 'The puppet module skeleton specifies a Gemfile with the following line:\r\n\r\n{noformat}\r\npuppetversion = ENV.key?(''PUPPET_VERSION'') ? "= #{ENV[''PUPPET_VERSION'']}" : [''>= 3.3'']\r\n{noformat}\r\n\r\nif you define an env var as PUPPET_VERSION="~> 3.6.0" as most people do when testing with travis, bundler will complain stating it cannot meet the requirements.\r\n\r\nChanging the line to:\r\n{noformat}\r\npuppetversion = ENV.key?(''PUPPET_VERSION'') ? "#{ENV[''PUPPET_VERSION'']}" : [''>= 3.3'']\r\n{noformat}\r\n\r\nFixes the issue.', 'https://tickets.puppetlabs.com/browse/PUP-3082', 'https://github.com/puppetlabs/puppet/pull/2992', '2014-08-19T09:24:40.000-0700', '2019-04-04T22:21:40.000-0700', '2019-04-04T22:21:40.000-0700', 'Closed', 'moduletool', 6, '0', 1, 1, 1, 1, 'd68f859be0777e1714a340ed470f2a1386f99286'),
('puppet', 80697, 35744738, 3952, 'Augeas onlyif does not work when using arrays to match against', 'According to the type reference, you should be able to use the ''onlyif'' metaparameter of the augeas type to check if the results from an augeas path equal an array. The augeas type does not return values, however, so it can never match the values in your array. Instead it returns an array of augeas paths.', 'https://tickets.puppetlabs.com/browse/PUP-4629', 'https://github.com/puppetlabs/puppet/pull/3952', '2015-05-19T08:40:50.000-0700', '2019-04-04T22:21:41.000-0700', '2019-04-04T22:21:41.000-0700', 'Closed', 'augeas', 2, '0', 1, 108, 0, 3, 'f8ddf888979d8e09581f14ce5884680fbc8e6eca'),
('puppet', 21684, 9913317, 2061, 'PR (2061) Augeas provider warns on parse errors in other files handled by same lens', 'Greetings,\r\n\r\nwe are evaluating Puppet 3.0. At the moment we are getting errors from the augeas provider:\r\nWarning: Augeas[xxxxxx](provider=augeas): Loading failed for one or more files, see debug for /augeas//error output\r\n\r\n$ rpm -qa|grep puppet\r\npuppet-server-3.0.1-1.el6.noarch\r\npuppet-3.0.1-1.el6.noarch\r\npuppetdb-terminus-1.0.2-1.el6.noarch\r\npuppet-dashboard-1.2.12-1.el6.noarch\r\n$ rpm -qa|grep augeas\r\naugeas-libs-0.9.0-1.el6.x86_64\r\naugeas-0.9.0-1.el6.x86_64\r\naugeas-devel-0.9.0-1.el6.x86_64\r\nruby-augeas-0.4.1-1.el6.x86_64\r\n\r\nThe file manipulation of the files via augtool and the provider works fine but we always get the warning.\r\n\r\nSame modules works fine with puppet 2.7 without any warnings\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1158', 'https://github.com/puppetlabs/puppet/pull/2061', '2013-12-18T00:26:10.000-0800', '2019-04-04T22:21:42.000-0700', '2019-04-04T22:21:42.000-0700', 'Closed', 'redmine', 4, '0', 2, 28, 17, 4, 'c35ae4ffa447c4370fb4620e7a10f2c322cc6593'),
('puppet', 22667, 54190691, 4525, 'service status is ignored ( puppet 3.2 + upstart provider )', '<pre>\r\ncat > test.pp &lt;&lt;EOF\r\nnotice("os = $::operatingsystem, puppetversion = $::puppetversion")\r\nexec { ''run'':\r\n  command => "/sbin/status network-interface INTERFACE=eth0",\r\n  logoutput => true,\r\n}\r\n->\r\nservice { ''network-interface'':\r\n  ensure   => running,\r\n  status   => ''/sbin/status network-interface INTERFACE=eth0'',\r\n}\r\nEOF\r\npuppet apply test.pp\r\n</pre>\r\nwill output the following\r\n<pre>\r\nNotice: Scope(Class[main]): os = Ubuntu, puppetversion = 3.2.4\r\nNotice: /Stage[main]//Exec[run]/returns: network-interface (eth0) start/running\r\nNotice: /Stage[main]//Exec[run]/returns: executed successfully\r\nError: /Stage[main]//Service[network-interface]: Could not evaluate: Execution of ''/sbin/status network-interface'' returned 1: status: Unknown parameter: INTERFACE\r\nNotice: Finished catalog run in 0.27 seconds\r\n</pre>\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1293', 'https://github.com/puppetlabs/puppet/pull/4525', '2013-12-30T10:50:22.000-0800', '2019-04-04T22:21:42.000-0700', '2019-04-04T22:21:42.000-0700', 'Closed', 'redmine', 3, '0', 1, 62, 1, 2, '3f10d6f9db75a294f52dd440e6baae8ea87da865'),
('puppet', 94406, 42940269, 4184, 'parent attributes are set from metadata too early in static_compiler', 'in get_child_resources() we are assigning mode, owner and group attributes to the parent too early.\r\n\r\n{code}\r\n   ...\r\n    total.each do |meta|\r\n      # This is the top-level parent directory\r\n      if meta.relative_path == "."\r\n        replace_metadata(request, resource, meta)\r\n        next\r\n      end\r\n      children[meta.relative_path] ||= Puppet::Resource.new(:file, File.join(file[:path], meta.relative_path))\r\n\r\n      # I think this is safe since it''s a URL, not an actual file\r\n      children[meta.relative_path][:source] = source + "/" + meta.relative_path\r\n      resource.each do |param, value|\r\n        # These should never be passed to our children.\r\n        unless [:parent, :ensure, :recurse, :recurselimit, :target, :alias, :source].include? param\r\n          children[meta.relative_path][param] = value\r\n        end\r\n      end\r\n      replace_metadata(request, children[meta.relative_path], meta)\r\n    end\r\n\r\n    children\r\n  end\r\n  ...\r\n{code}\r\n\r\nThis sets the parent''s owner, group and mode attributes from metadata, subsequently causing all child resources to inherit the same values when its their turn in the loop.\r\n\r\nChild resources should only inherit attribute values if they are explicitly set on the parent resource.\r\n\r\nIn other cases *source_permissions* should probably determine how the child attributes are set:\r\n\r\n*use*\r\n  Set owner, group, and mode from metadata, as done in calls to replace_metadata().\r\n*ignore*\r\n  Don''t set them\r\n*use_when_creating*\r\n  We can''t really tell if a file already exists while compiling a catalog remotely, so idk what to do here.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5055', 'https://github.com/puppetlabs/puppet/pull/4184', '2015-08-20T06:40:13.000-0700', '2019-04-04T22:21:44.000-0700', '2019-04-04T22:21:44.000-0700', 'Closed', '', 1, '0', 1, 3, 3, 1, '0a3d63df1ef68b501005d0c36ee2193741dfe12b'),
('puppet', 41617, 28850184, 3585, 'yumrepo fails to honour custom reposdir', 'With yum.conf containing reposdir=/etc/yum.repos.d/custom all was well with 3.4.3 and puppet managed the repo files correctly.  \r\n\r\nSince the 3.5 changes to yumrepo, it no longer uses the custom repodir, so writes the repo files to the wrong directory (/etc/yum.repos.d).  But then yum  isn''t reading them from this directory, so none of them are picked up by yum.', 'https://tickets.puppetlabs.com/browse/PUP-2916', 'https://github.com/puppetlabs/puppet/pull/3585', '2014-07-09T02:53:24.000-0700', '2019-04-04T22:21:47.000-0700', '2019-04-04T22:21:47.000-0700', 'Closed', '', 8, '0', 2, 5, 1, 2, '0bc8cbf2ad1b43ba072d64b19d1a5f7c1c6a2adf'),
('puppet', 36224, 16622324, 2721, 'Exit code 0 on wrong command', 'Running {code}puppet garbarge ; echo $?{code} generates\r\n{noformat}\r\nError: Unknown Puppet subcommand ''garbarge''\r\nSee ''puppet help'' for help on available puppet subcommands\r\n0\r\n{noformat}\r\nThe exit code should not be 0. In my case I run {code}puppet --detailed-exitcodes apply ... {code} in automated way and the failure was not detected because of exit code 0\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2622', 'https://github.com/puppetlabs/puppet/pull/2721', '2014-05-20T06:28:40.000-0700', '2019-04-04T22:21:48.000-0700', '2019-04-04T22:21:48.000-0700', 'Closed', '', 2, '0', 1, 72, 40, 3, 'da4cef916fa7b616c10d9982872f8fecb220c384'),
('puppet', 27900, 15773672, 2639, '3.4.0 broke compatibility with plugins using the hiera indirector terminus', 'The hiera indirector terminus was removed in 3.4.0, this was a public API and used in for example https://github.com/dalen/puppet-hiera-node\r\n\r\nI think it makes sense to keep as it is easier to use than the DataBinding one (you just need to pass a hash instead of a scope object).\r\n\r\nBut either way it should have been marked as deprecated and possibly removed in 4.0 instead of in the middle of a series.', 'https://tickets.puppetlabs.com/browse/PUP-1843', 'https://github.com/puppetlabs/puppet/pull/2639', '2014-03-04T09:20:55.000-0800', '2019-04-04T22:21:49.000-0700', '2019-04-04T22:21:49.000-0700', 'Closed', '', 4, '0', 1, 167, 0, 4, 'f59091d9cc1e5052e24eab70ec552678a29dbcfc'),
('puppet', 22627, 25545757, 3385, '''pkg'' package provider does not understand IPS package versions properly', 'It would seem the ''pkg'' provider (for illumos/Solaris/OpenSolaris IPS) does not\r\ndo the right thing with IPS package versions. We''re running OmniOS and seeing\r\nthis:\r\n\r\n{noformat}\r\n    kekkonen ~ % pfexec puppet apply -e ''package {"mdb": ensure => latest }''\r\n    Notice: Compiled catalog for kekkonen.niksula.hut.fi in environment production in 1.17 seconds\r\n    Notice: Finished catalog run in 6.39 seconds\r\n    kekkonen ~ % pfexec pkg update -nv mdb                                                  \r\n                Packages to update:        1\r\n         Estimated space available: 14.11 TB\r\n    Estimated space to be consumed: 24.61 MB\r\n           Create boot environment:       No\r\n    Create backup boot environment:      Yes\r\n              Rebuild boot archive:       No\r\n\r\n    Changed packages:\r\n    omnios\r\n      developer/debug/mdb\r\n        0.5.11,5.11-0.151006:20130731T194820Z -> 0.5.11,5.11-0.151006:20131019T183740Z\r\n{noformat}\r\n\r\nSo puppet thinks there are no updates, but pkg correctly notices that an update\r\nis available (only the timestamp has changed, not the version, build release,\r\nor branch numbers).\r\n\r\npuppet resource provides some insight into this:\r\n\r\n{noformat}\r\n    kekkonen ~ % puppet resource package mdb\r\n    package { ''mdb'':\r\n      ensure => ''0.5.11-0.151006'',\r\n    }\r\n{noformat}\r\n\r\nThis version number is not correct, it''s missing the build release (5.11) and\r\ntimestamp.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1270', 'https://github.com/puppetlabs/puppet/pull/3385', '2013-12-30T02:37:03.000-0800', '2019-04-04T22:21:52.000-0700', '2019-04-04T22:21:52.000-0700', 'Closed', 'redmine;solaris', 11, '0', 1, 5, 5, 2, 'b18ddc3eb6b164b2208adf65eadb1068a682743d'),
('puppet', 22230, 16899964, 2756, 'sshkey creates /etc/ssh/ssh_known_hosts with mode 600', 'Using the sshkey type /etc/ssh/ssh_known_hosts is created with mode 600 by default.  This seems undesirable in most situations.  I think the default should be 644.  I didn''t see anything obvious in the sshkey code that set it strictly on purpose.  Does puppet default to 600 somewhere?  And is there a simple way to tweak a type to use a different mode?  This seems like a similar issue to #1538.  Of course, it''s not an inifile, so the fix will be different.', 'https://tickets.puppetlabs.com/browse/PUP-1177', 'https://github.com/puppetlabs/puppet/pull/2756', '2013-12-18T20:27:28.000-0800', '2019-04-04T22:21:53.000-0700', '2019-04-04T22:21:53.000-0700', 'Closed', 'redmine', 5, '0', 5, 64, 15, 7, '19bc6919a83eda869edcb17d7980fb7313593cfc'),
('puppet', 92575, 42027957, 4146, 'SysV init script managed by ''init'' provider instead of ''debian'' provider on Debian8', 'Enable a service managed with a SysV init script instead of a systemd service file on Debian 8 does not work anymore since https://github.com/puppetlabs/puppet/commit/7fe6164 as it fallback to ''init'' provider which does not support ''enable'' feature instead of ''debian'' provider.', 'https://tickets.puppetlabs.com/browse/PUP-5016', 'https://github.com/puppetlabs/puppet/pull/4146', '2015-08-10T07:44:32.000-0700', '2019-04-04T22:21:55.000-0700', '2019-04-04T22:21:55.000-0700', 'Closed', '', 5, '0', 1, 2, 6, 2, '9071052aee9f9289897b6e2069ca1b78ebf07016'),
('puppet', 33049, 15131748, 2575, 'Yumrepo type allows invalid values', 'The regexps that validate the values are not restricting the whole line, allowing values like "whateverTrueIwant" inside yumrepo boolean options.', 'https://tickets.puppetlabs.com/browse/PUP-2360', 'https://github.com/puppetlabs/puppet/pull/2575', '2014-04-24T10:18:18.000-0700', '2019-04-04T22:21:56.000-0700', '2019-04-04T22:21:56.000-0700', 'Closed', '', 3, '0', 1, 68, 6, 2, 'd68598de212881bd4cde9db3fa8736e48e1a738d'),
('puppet', 70711, 37225536, 4017, 'Gem version specifiers are not idempotent', '*Original*\r\n\r\nIt would be useful to support Gem version requirements in package resources, such as:\r\n\r\n{code:puppet}\r\n    package { ''hiera-eyaml-gpg'':\r\n      ensure   => ''>= 0.5.rc1'',\r\n      provider => gem,\r\n    }\r\n{code}\r\n\r\nor\r\n\r\n{code:puppet}\r\n    package { ''ruby_gpg'':\r\n      ensure   => ''~> 0.3'',\r\n      provider => gem,\r\n    }\r\n{code}\r\n\r\n*Updated*\r\n\r\nPreviously, if the manifest specified a gem version as a constraint, e.g. {{~> 0.3}}, as opposed to an explicit version {{1.2.3}} or {{latest}}, then the gem provider was not idempotent, and would attempt to reinstall the gem each time. With this fix, the gem provider is idempotent when using a gem version constraint.', 'https://tickets.puppetlabs.com/browse/PUP-4131', 'https://github.com/puppetlabs/puppet/pull/4017', '2015-03-09T03:18:40.000-0700', '2019-04-04T22:21:57.000-0700', '2019-04-04T22:21:57.000-0700', 'Closed', '', 6, '0', 1, 1, 1, 1, '3441445302bbcd32e65653b10f21c5a93b52d30e'),
('puppet', 24032, 18208031, 2859, 'Puppet Agent windows services accidentally comes of out Paused state', 'The Windows Puppet Agent service will not stay in a paused stated, instead it will go back into a running state after a short period of time.\r\n\r\nThis is an issue in the Win32-Service ruby code.  Raised bug https://github.com/djberg96/win32-service/issues/11 and is fixed in version 0.8.3.\r\n\r\nBecause the Pause feature is so rarely used, there is no point in creating a workaround until puppet uses 0.8.3.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1471', 'https://github.com/puppetlabs/puppet/pull/2859', '2014-01-19T17:30:43.000-0800', '2019-04-04T22:21:59.000-0700', '2019-04-04T22:21:59.000-0700', 'Closed', '', 10, '0', 1, 1, 4, 1, '6f21ccf8af21559dc4a84d3a5181a441981c85a4'),
('puppet', 21359, 414038443, 8137, 'PR (2385) naginator not parsing blank parameters', 'Even though it wrote it, and is valid nagios syntax, The Naginator can not parse this:\r\n\r\n{code}\r\n    define host {\r\n            host_name                      gib-proxytest\r\n            parents\r\n            hostgroups                     gib\r\n            use                            linux-server\r\n            address                        10.3.100.72\r\n            alias                          proxytest\r\n    }\r\n{code}\r\n\r\nWhere the parents value is blank. It borks with:\r\n\r\n{code}\r\n    err: Could not prefetch nagios_host provider ''naginator'': Could not parse configuration for nagios_host: line 62: syntax error at ''\r\n    '' in /etc/nagios/nagios_host.cfg\r\n{code}\r\n\r\nAnd then rebuilds the file from scratch every time.', 'https://tickets.puppetlabs.com/browse/PUP-1041', 'https://github.com/puppetlabs/puppet/pull/8137', '2013-12-16T03:01:23.000-0800', '2019-04-04T22:22:01.000-0700', '2019-04-04T22:22:01.000-0700', 'Closed', 'nagios;redmine', 13, '0', 1, 80, 10, 5, '5e0b340cd200824d76e2315658f94590d9760b5d'),
('puppet', 85569, 38183211, 4041, 'Static compiler only looks for file content in production environment', 'When using environments other than production with the static_compiler terminus, content for new files is retrieved from production instead of the request environment.\r\n\r\nSteps to reproduce:\r\n1. catalog_terminus = static_compiler\r\n2. create test environment with file that doesn''t exist in production\r\n3. run puppet\r\n\r\nI picked 3.7.4 as affected version because that''s when we switched to static_compiler, but as far as I can tell this has always been a bug and all versions of Puppet are affected.\r\n\r\nI''m submitting a patch that we''ve been using in production for a few months to fix this issue.', 'https://tickets.puppetlabs.com/browse/PUP-4771', 'https://github.com/puppetlabs/puppet/pull/4041', '2015-06-21T04:57:01.000-0700', '2019-04-04T22:22:02.000-0700', '2019-04-04T22:22:02.000-0700', 'Closed', '', 2, '0', 2, 19, 18, 1, '3f50dbfaffcf58195468ab051b9a05117d843f17'),
('puppet', 27406, 16073599, 2670, 'yumhelper.py: Not respecting the yum lock leads to RPM database corruption', 'We''re recently seeing frequent rpm database corruption on our systems and have narrowed it down to yumhelper.py not respecting Yum''s lock. Not doing so means that a concurrently running yum, or any other application using the yum library,  will make yumhelper.py corrupt the rpm database.\r\n\r\nIn our case an ossec module which uses the yum library and does proper locking started taking longer and now there are frequent clashes between it and a puppet run. This doesn''t always cause corruption, but we''ve been seeing it quite a bit. Making yumhelper.py respect Yum''s lock fixed the corruption problem for us.\r\n\r\nA patch for this can be found on https://github.com/puppetlabs/puppet/pull/2387', 'https://tickets.puppetlabs.com/browse/PUP-1775', 'https://github.com/puppetlabs/puppet/pull/2670', '2014-02-26T12:07:54.000-0800', '2019-04-04T22:22:03.000-0700', '2019-04-04T22:22:03.000-0700', 'Closed', '', 7, '0', 1, 155, 249, 3, '101d1deb1168bd7955cf701262f5e44f37eb66c4'),
('puppet', 173025, 120701186, 5873, 'Puppet  ensure=>latest doesn''t work in case of dots in package name', 'On Amazon linux  I tried to \r\n{noformat}\r\nclass test {\r\n  package { ''java'':\r\n    ensure          => ''latest'',\r\n    name            => ''java-1.8.0-openjdk'',\r\n  }\r\n}\r\n\r\nclass {"test":}\r\n{noformat}\r\nAnd nothing is installed.\r\n{noformat}\r\n/opt/puppetlabs/puppet/bin/puppet apply ./test.pp --test\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nNotice: Compiled catalog for host.test in environment production in 0.08 seconds\r\nInfo: Applying configuration version ''1485878170''\r\nNotice: Applied catalog in 0.86 seconds\r\n\r\n{noformat}\r\n\r\nMeanwhile:\r\n{noformat}\r\n# /opt/puppetlabs/puppet/bin/puppet resource package java\r\npackage { ''java'':\r\n  ensure => ''1:1.7.0.121-2.6.8.1.69.amzn1'',\r\n}\r\n\r\n# /opt/puppetlabs/puppet/bin/puppet resource package java-1.8.0-openjdk\r\npackage { ''java-1.8.0-openjdk'':\r\n  ensure => ''1:1.8.0.111-1.b15.25.amzn1'',\r\n}\r\n\r\n # yum check-updates\r\nLoaded plugins: priorities, s3, update-motd, upgrade-helper\r\namzn-main/latest                                                                                                                                                                      | 2.1 kB     00:00     \r\namzn-updates/latest                                                                                                                                                                   | 2.3 kB     00:00     \r\n13 packages excluded due to repository priority protections\r\n\r\njava-1.8.0-openjdk.x86_64                                                                        1:1.8.0.121-0.b13.29.amzn1                                                               amzn-updates       \r\njava-1.8.0-openjdk-headless.x86_64                                                               1:1.8.0.121-0.b13.29.amzn1                                                               amzn-updates       \r\npuppet-bootstrap-test.noarch                                                                       1.0-29                                                                                   bootstrap-artifacts\r\nSecurity: kernel-4.4.41-36.55.amzn1.x86_64 is an installed security update\r\nSecurity: kernel-4.4.35-33.55.amzn1.x86_64 is the currently running version\r\n\r\n{noformat}\r\n\r\nTraced problem to:\r\nhttps://github.com/puppetlabs/puppet/blame/master/lib/puppet/provider/package/yum.rb#L109\r\n\r\n\r\nHere is a my  copy/paste of code for IRB:\r\n\r\ndataset for testing:\r\n{noformat}\r\na=''''''Loaded plugins: priorities, s3, update-motd, upgrade-helper\r\namzn-main/latest                                                                                                                                                                      | 2.1 kB     00:00     \r\namzn-main/latest/group                                                                                                                                                                |  35 kB     00:00     \r\namzn-main/latest/primary_db                                                                                                                                                           | 3.5 MB     00:00     \r\namzn-updates/latest                                                                                                                                                                   | 2.3 kB     00:00     \r\namzn-updates/latest/group                                                                                                                                                             |  35 kB     00:00     \r\namzn-updates/latest/updateinfo                                                                                                                                                        | 362 kB     00:00     \r\namzn-updates/latest/primary_db                                                                                                                                                        | 498 kB     00:00     \r\n13 packages excluded due to repository priority protections\r\n\r\njava-1.8.0-openjdk.x86_64                                                                        1:1.8.0.121-0.b13.29.amzn1                                                               amzn-updates       \r\njava-1.8.0-openjdk-headless.x86_64                                                               1:1.8.0.121-0.b13.29.amzn1                                                               amzn-updates       \r\npuppet-bootstrap-mq.noarch                                                                       1.0-29                                                                                   bootstrap-artifacts\r\nSecurity: kernel-4.4.41-36.55.amzn1.x86_64 is an installed security update\r\nSecurity: kernel-4.4.35-33.55.amzn1.x86_64 is the currently running version\r\n\r\n''''''\r\n{noformat}\r\n\r\nparse_update method as func\r\n{noformat}\r\ndef parse_updates(str)\r\n    # Strip off all content before the first blank line\r\n    body = str.partition(/^\s*\n/m).last\r\n\r\n    updates = Hash.new { |h, k| h[k] = [] }\r\n    body.split.each_slice(3) do |tuple|\r\n      break if tuple[0] =~ /^(Obsoleting|Security:|Update)/\r\n      hash = update_to_hash(*tuple[0..1])\r\n      # Create entries for both the package name without a version and a\r\n      # version since yum considers those as mostly interchangeable.\r\n      short_name = hash[:name]\r\n      long_name  = "#{hash[:name]}.#{hash[:arch]}"\r\n\r\n      updates[short_name] << hash\r\n      updates[long_name] << hash\r\n    end\r\n\r\n    puts updates\r\nend\r\n{noformat}\r\n\r\n\r\nAdded some output for update_to_hash\r\n{noformat}\r\ndef update_to_hash(pkgname, pkgversion)\r\n    puts :pkgname\r\n    puts pkgname, pkgversion\r\n    name, arch = pkgname.split(''.'')\r\npkgname\r\n    match = pkgversion.match(/^(?:(\d+):)?(\S+)-(\S+)$/)\r\n    epoch = match[1] || ''0''\r\n    version = match[2]\r\n    release = match[3]\r\n    puts name, epoch,  version, release,arch    \r\n\r\n    {\r\n      :name => name,\r\n      :epoch => epoch,\r\n      :version => version,\r\n      :release => release,\r\n      :arch    => arch,\r\n    }\r\n  end\r\n{noformat}\r\n\r\nResult:\r\n{noformat}\r\nirb(main):367:0> parse_updates(a)\r\npkgname\r\njava-1.8.0-openjdk.x86_64\r\n1:1.8.0.121-0.b13.29.amzn1\r\njava-1\r\n1\r\n1.8.0.121\r\n0.b13.29.amzn1\r\n8\r\npkgname\r\njava-1.8.0-openjdk-headless.x86_64\r\n1:1.8.0.121-0.b13.29.amzn1\r\njava-1\r\n1\r\n1.8.0.121\r\n0.b13.29.amzn1\r\n8\r\npkgname\r\npuppet-bootstrap-mq.noarch\r\n1.0-29\r\npuppet-bootstrap-mq\r\n0\r\n1.0\r\n29\r\nnoarch\r\n{"java-1"=>[{:name=>"java-1", :epoch=>"1", :version=>"1.8.0.121", :release=>"0.b13.29.amzn1", :arch=>"8"}, {:name=>"java-1", :epoch=>"1", :version=>"1.8.0.121", :release=>"0.b13.29.amzn1", :arch=>"8"}], "java-1.8"=>[{:name=>"java-1", :epoch=>"1", :version=>"1.8.0.121", :release=>"0.b13.29.amzn1", :arch=>"8"}, {:name=>"java-1", :epoch=>"1", :version=>"1.8.0.121", :release=>"0.b13.29.amzn1", :arch=>"8"}], "puppet-bootstrap-mq"=>[{:name=>"puppet-bootstrap-mq", :epoch=>"0", :version=>"1.0", :release=>"29", :arch=>"noarch"}], "puppet-bootstrap-mq.noarch"=>[{:name=>"puppet-bootstrap-mq", :epoch=>"0", :version=>"1.0", :release=>"29", :arch=>"noarch"}]}\r\n\r\n{noformat}\r\n\r\nAs you can see "java-1.8.0-openjdk.x86_64" became an "java-1" in https://github.com/puppetlabs/puppet/blame/master/lib/puppet/provider/package/yum.rb#L109\r\n\r\nA bit more \r\n{noformat}\r\nirb(main):372:0> pkgname="java-1.8.0-openjdk.x86_64"\r\n=> "java-1.8.0-openjdk.x86_64"\r\nirb(main):373:0> name, arch = pkgname.split(''.'')\r\n=> ["java-1", "8", "0-openjdk", "x86_64"]\r\n\r\nirb(main):375:0> name\r\n=> "java-1"\r\nirb(main):376:0> arch\r\n=> "8"\r\n\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7145', 'https://github.com/puppetlabs/puppet/pull/5873', '2017-01-31T08:10:28.000-0800', '2019-04-04T22:22:04.000-0700', '2019-04-04T22:22:04.000-0700', 'Closed', '', 4, '0', 3, 18, 1, 3, '4428199a055810819ed63c3f165466b14882721e'),
('puppet', 22740, 0, 0, 'PR (2060) owner of files created by nagios resource types', 'Currently the files are created with the permission 600 and are owned by root\r\n\r\nit will be nice to have the possibility to change the owner and/or the permissions of those resources\r\n\r\nexample : \r\n<pre>\r\nnagios_host{ "korin": \r\nensure          => "present",\r\nuse             => "linux-server",\r\nalias           => "korin",\r\naddress         =>  "192.168.109.84",\r\nhostgroups      => "linux-servers",\r\ntarget          => "/etc/nagios/host_korin.cfg",\r\n**owner           => "nagios"**;\r\n}    \r\n</pre>', 'https://tickets.puppetlabs.com/browse/PUP-1327', 'https://github.com/puppetlabs/puppet/commit/39f20154d4f0104d9ec00312505a57d865787ce6', '2013-12-31T08:50:02.000-0800', '2019-04-04T22:22:04.000-0700', '2019-04-04T22:22:04.000-0700', 'Closed', 'nagios;redmine', 7, '0', 0, 0, 0, 0, '39f20154d4f0104d9ec00312505a57d865787ce6'),
('puppet', 66684, 47071760, 4324, 'Puppet resource doesn''t properly escape single quotes.', 'How to reproduce:\r\n\r\nklynton@plmbp:~ → puppet -V\r\n3.6.2\r\n\r\nI have also tested on Puppet 3.7.2.\r\n\r\nklynton@plmbp:~ → cat file.pp \r\nfile { "/Users/klynton/o''brien":\r\n  ensure => file,\r\n}\r\nklynton@plmbp:~ → puppet apply file.pp \r\n\r\nOR\r\n\r\nklynton@plmbp:~ → touch o\''brien\r\n\r\nNotice: Compiled catalog for plmbp.corp.puppetlabs.net in environment production in 0.41 seconds\r\nNotice: Finished catalog run in 0.05 seconds\r\nklynton@plmbp:~ → puppet resource file "/Users/klynton/o''brien"\r\nfile { ''/Users/klynton/o''brien'':\r\n  ensure  => ''file'',\r\n  content => ''{md5}d41d8cd98f00b204e9800998ecf8427e'',\r\n  ctime   => ''2015-02-03 14:41:25 -0800'',\r\n  group   => ''20'',\r\n  mode    => ''644'',\r\n  mtime   => ''2015-02-03 14:41:25 -0800'',\r\n  owner   => ''503'',\r\n  type    => ''file'',\r\n}\r\nklynton@plmbp:~ → ', 'https://tickets.puppetlabs.com/browse/PUP-3953', 'https://github.com/puppetlabs/puppet/pull/4324', '2015-02-03T15:24:00.000-0800', '2019-04-04T22:22:06.000-0700', '2019-04-04T22:22:06.000-0700', 'Closed', '', 2, '0', 1, 16, 1, 2, '8de55e50ddb3a1b1cc38730cf1f047895b48a15a'),
('puppet', 60525, 25513891, 3378, 'Can''t Install Puppet Gem on Windows64 Bit Ruby 1.9.3 and 2.0', 'Get the following dependency errors on windows\r\n\r\nD:\Wng.IAC\Modules\wn-facts>gem install puppet\r\nERROR:  While executing gem ... (Gem::DependencyError)\r\n    Unable to resolve dependencies: puppet requires ffi (= 1.9.3); win32-service requires ffi (>= 0); win32-process requires ffi (>= 1.0.0); win32-eventlog requires ffi (>= 0); facter requires ffi (~> 1.9.5); win32-security requires ffi (>= 0); win32-dir requires ffi (>= 1.0.0)\r\n\r\nD:\Wng.IAC\Modules\wn-facts>gem install puppet -v 3.7.2\r\nERROR:  While executing gem ... (Gem::DependencyError)\r\n    Unable to resolve dependencies: puppet requires ffi (= 1.9.3); win32-service requires ffi (>= 0); win32-process requires ffi (>= 1.0.0); win32-eventlog requires ffi (>= 0); facter requires ffi (~> 1.9.5); win32-security requires ffi (>= 0); win32-dir requires ffi (>= 1.0.0)', 'https://tickets.puppetlabs.com/browse/PUP-3737', 'https://github.com/puppetlabs/puppet/pull/3378', '2014-12-04T01:40:52.000-0800', '2019-04-04T22:22:06.000-0700', '2019-04-04T22:22:06.000-0700', 'Closed', 'windows', 6, '0', 1, 2, 2, 1, 'b9a50e5cdea8d2f7e511dce974a361d63fef28d4'),
('puppet', 56603, 23526418, 3254, 'pkg provider latest gives empty warnings', '{noformat}\r\n% pfexec puppet apply --verbose -e ''package {"puppet": ensure => latest }'' \r\nInfo: Loading facts\r\nNotice: Compiled catalog for kekkonen.niksula.hut.fi in environment production in 0.74 seconds\r\nInfo: Applying configuration version ''1414585322''\r\nWarning: pkg warning: []\r\nNotice: Finished catalog run in 2.26 seconds\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3564', 'https://github.com/puppetlabs/puppet/pull/3254', '2014-10-29T05:23:54.000-0700', '2019-04-04T22:22:07.000-0700', '2019-04-04T22:22:07.000-0700', 'Closed', '', 2, '0', 1, 1, 1, 1, '49c5dab679b514cb90b22425da5233bfcdc5e590'),
('puppet', 99705, 46265866, 4304, 'puppet device fails during SSH session closure', 'There is a widely reported problem with SSH sessions failing. Looking into this, closing the session causes the IO handles to error out\r\n\r\n* https://ask.puppetlabs.com/question/1389/puppet-device-fails-halfway-through-fact-discovery-on-cisco-catalyst-2960/\r\n* http://gadgetsytecnologia.com/56775b756283c83d7/could-not-retrieve-local-facts-closed-stream.html\r\n\r\n{code}\r\n$ puppet device switch01.example.com --verbose\r\nInfo: starting applying configuration to switch01.example.com at ssh://switch01.example.com/\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nError: Could not retrieve local facts: closed stream\r\nError: Failed to apply catalog: Could not retrieve local facts: closed stream\r\n{code}\r\n\r\nPoking around in the author''s own code, he''s trapping IOError when closing things. This makes perfect sense, as the SSH transport has open IO handles when it closes the session.', 'https://tickets.puppetlabs.com/browse/PUP-5291', 'https://github.com/puppetlabs/puppet/pull/4304', '2015-09-29T04:30:37.000-0700', '2019-04-04T22:22:08.000-0700', '2019-04-04T22:22:08.000-0700', 'Closed', 'puppethack', 1, '0', 2, 7, 3, 1, 'a5aac52b5c7fe680148ebbc27a63daf69db142ff'),
('puppet', 66361, 30250518, 3663, 'Update OpenBSD service provider to support new syntax of rcctl', 'The rcctl service command recently changed its interface. For example, the "enable" argument has been replaced with "set,", the "status" argument has been replaced with "get", etc. So update the OpenBSD service provider to reflect these changes.', 'https://tickets.puppetlabs.com/browse/PUP-3939', 'https://github.com/puppetlabs/puppet/pull/3663', '2015-02-02T10:14:43.000-0800', '2019-04-04T22:22:09.000-0700', '2019-04-04T22:22:09.000-0700', 'Closed', '', 3, '0', 1, 29, 28, 3, '55ef06ea1baff10ab518c93e3649f5f27c365055'),
('puppet', 35617, 16674548, 2734, 'ssh_authorized_key does not handle options with escaped double quotes', 'With the following declaration:\r\n{code}\r\nssh_authorized_key { ''title'':\r\n    user    => ''root'',\r\n    ensure  => ''present'',\r\n    name    => ''mykey'',\r\n    options => [ ''command="/usr/local/bin/mybin \"$SSH_ORIGINAL_COMMAND\""'' ],\r\n    type    => ''ssh-rsa'',\r\n    key     => ''xxx'',\r\n}\r\n{code}\r\n\r\nIt creates the following entry:\r\n{code}command="/usr/local/bin/mybin \"$SSH_ORIGINAL_COMMAND\"" ssh-rsa xxx mykey{code}\r\n\r\nIt''s OK.\r\n\r\nBut at each run, puppet agent logs:\r\n{code}Notice: /Stage[main]/Module/Ssh_authorized_key[title]/options: options changed ''command="/usr/local/bin/mybin \"'' to ''command="/usr/local/bin/mybin \"$SSH_ORIGINAL_COMMAND\""''{code}\r\n\r\n\r\nThe attached patch solves that issue. It fixes the regexp by checking that there is no backslash before the closing double quote.', 'https://tickets.puppetlabs.com/browse/PUP-2579', 'https://github.com/puppetlabs/puppet/pull/2734', '2014-05-15T02:14:47.000-0700', '2019-04-04T22:22:11.000-0700', '2019-04-04T22:22:11.000-0700', 'Closed', 'ssh_authorized_key', 6, '0', 1, 1, 1, 1, '4b5f00c293006186480a8c5acf70312e307c854b'),
('puppet', 286297, 236737157, 7279, 'Unable to enfource SELinux attributes for files in /dev/shm', 'Hi!\r\n\r\n \r\n\r\nCurrently on Puppet 5.5.1, I''ve created the following resource:\r\n\r\n{code}\r\n    file { ''/dev/shm/ns-slapd-database-cache/'':\r\n      ensure => ''directory'',\r\n      owner  => ''dirsrv'',\r\n      group  => ''dirsrv'',\r\n      mode   => ''0770'',\r\n      seltype => dirsrv_var_lib_t''\r\n    }\r\n{code}\r\n\r\nHowever, Puppet never configures the {{seltype}} for this directory, in the Puppet Agent debug logs we see:\r\n{code}\r\nDebug: /Stage[main]/Pt_freeipa::Server::Config::Limits/File[/dev/shm/ns-slapd-database-cache/]/seltype: SELinux not available for this filesystem. Ignoring parameter.\r\n{code}\r\n\r\nI''ve tracked this down to the following:\r\n* https://github.com/puppetlabs/puppet/blob/5.5.1/lib/puppet/type/file/selcontext.rb#L26-L82 - this is all of the logic used to determine if selinux things should be enforced, comparing the state, and setting things\r\n* Within that we have https://github.com/puppetlabs/puppet/blob/5.5.1/lib/puppet/type/file/selcontext.rb#L58-L60 which checks to see if the filesystem type supports selinux\r\n* that is here: https://github.com/puppetlabs/puppet/blob/5.5.1/lib/puppet/util/selinux.rb#L186-L195 - notice that tmpfs is not in that list\r\n* https://github.com/puppetlabs/puppet/blob/5.5.1/lib/puppet/util/selinux.rb#L234-L253 is how it determines the filesystem type for a given directory, basically, take directory, grab all of the mounts from /proc/mounts walk up the directory hierarchy until we find a matching mount, grab that type.\r\n\r\nI''m going to open a pull request to propose adding {{tmpfs}} to https://github.com/puppetlabs/puppet/blob/5.5.1/lib/puppet/util/selinux.rb#L193 and as per the contributor guidelines, also opening this issue to track this change as well. ', 'https://tickets.puppetlabs.com/browse/PUP-9330', 'https://github.com/puppetlabs/puppet/pull/7279', '2018-11-26T09:38:28.000-0800', '2019-04-04T22:22:13.000-0700', '2019-04-04T22:22:13.000-0700', 'Closed', 'SELinux;resolved-issue-added', 4, '0', 1, 5, 1, 2, '0f194d0b0f35c766aaf146bdf2d914c68e834dbc'),
('puppet', 49947, 20666794, 3046, 'Puppet 2.7.x still signs CSR with MD5', 'By default, Puppet 2.7 signs all CSR''s with MD5. \r\n\r\nThis causes issues with newer puppetmasters who have a version of SSL that will not sign such a CSR (such as on RHEL 7 or Fedora 20)\r\n\r\n    # puppet cert sign <redacted hostname>\r\n    Error: unknown message digest algorithm', 'https://tickets.puppetlabs.com/browse/PUP-3176', 'https://github.com/puppetlabs/puppet/pull/3046', '2014-09-03T02:47:53.000-0700', '2019-04-04T22:22:14.000-0700', '2019-04-04T22:22:14.000-0700', 'Closed', '', 4, '0', 1, 26, 3, 2, ''),
('puppet', 74216, 32240872, 3765, 'Portage package provider does not list all installed packages', 'Running {{puppet resource package}} on Gentoo/Portage, currently only lists packages that were installed by puppet, but not those installed by hand.\r\n\r\nThis was introduced in https://github.com/puppetlabs/puppet/commit/9e7bf07580d79e5b68d28cc594162959cf2a8d7d.\r\nOld line 79 contains a ''\n''.\r\nBut, new line 123 does not.\r\n\r\nSo now, the result of eix is only a one liner, no matter how many packages are installed. Since further on, the provider reads eix output line by line, no "by hand"-installed package will be found.\r\n\r\nI already opened a PR for this issue.\r\nhttps://github.com/puppetlabs/puppet/pull/3765\r\n\r\nrisk: low\r\nprobability: low (gentoo)\r\nseverity: high', 'https://tickets.puppetlabs.com/browse/PUP-4362', 'https://github.com/puppetlabs/puppet/pull/3765', '2015-04-01T01:30:14.000-0700', '2019-04-04T22:22:15.000-0700', '2019-04-04T22:22:15.000-0700', 'Closed', '', 1, '0', 1, 1, 1, 1, '9bf11d4d6a50aee7be2bb13e848c2050548dd994'),
('puppet', 23310, 11359530, 2238, 'PR (2238): puppet CA generates CRL that does not conform to RFC5280', 'according to http://tools.ietf.org/html/rfc5280#section-5.2.1 a conforming CA MUST provide the authorityKeyIdentifier extension in the CRL to identify the issuer of the CRL.\r\nI have a patch that adds that functionality and will submit a pull request.', 'https://tickets.puppetlabs.com/browse/PUP-1407', 'https://github.com/puppetlabs/puppet/pull/2238', '2014-01-09T03:36:15.000-0800', '2019-04-04T22:22:15.000-0700', '2019-04-04T22:22:15.000-0700', 'Closed', '', 5, '0', 2, 28, 40, 2, '29dffc48070ed78f6ebe99c383ed009fb5eb121f'),
('puppet', 28796, 13740452, 2449, 'purge_ssh_keys causes stack trace when creating new users on redhat', 'The user is successfully created, but a stack trace is generated. This issue was not reproducible in Ubuntu 12.04.\r\n\r\n{code}\r\n[root@pe-rhel6 ~]# puppet resource user testuser ensure=present managehome=true password=''$6$salt$IxDD3jeSOb5eB1CX5LBsqZFVkJdido3OUILO5Ifz5iwMuTS4XMS130MTSuDDl3aCI6WouIL9AjRbLCelDCy.g.'' --trace\r\nError: /User[testuser]: Failed to generate additional resources using ''eval_generate'': undefined method `empty?'' for nil:NilClass\r\n/usr/lib/ruby/site_ruby/1.8/puppet/type/user.rb:573:in `eval_generate''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/transaction/additional_resource_generator.rb:38:in `eval_generate''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/transaction.rb:72:in `evaluate''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/graph/relationship_graph.rb:116:in `call''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/graph/relationship_graph.rb:116:in `traverse''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/transaction.rb:108:in `evaluate''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/resource/catalog.rb:164:in `apply''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/util/log.rb:153:in `with_destination''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/transaction/report.rb:112:in `as_logging_destination''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/resource/catalog.rb:163:in `apply''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/indirector/resource/ral.rb:41:in `save''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/indirector/indirection.rb:283:in `save''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application/resource.rb:219:in `find_or_save_resources''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application/resource.rb:143:in `main''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application.rb:381:in `run_command''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application.rb:372:in `run''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application.rb:479:in `plugin_hook''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application.rb:372:in `run''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/util.rb:479:in `exit_on_fail''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application.rb:372:in `run''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/context.rb:51:in `override''\r\n/usr/lib/ruby/site_ruby/1.8/puppet.rb:224:in `override''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/application.rb:362:in `run''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/util/command_line.rb:137:in `run''\r\n/usr/lib/ruby/site_ruby/1.8/puppet/util/command_line.rb:91:in `execute''\r\n/usr/bin/puppet:4\r\nNotice: /User[testuser]/ensure: created\r\nuser { ''testuser'':\r\n  ensure   => ''present'',\r\n  password => ''$6$salt$IxDD3jeSOb5eB1CX5LBsqZFVkJdido3OUILO5Ifz5iwMuTS4XMS130MTSuDDl3aCI6WouIL9AjRbLCelDCy.g.'',\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1955', 'https://github.com/puppetlabs/puppet/pull/2449', '2014-03-14T15:18:31.000-0700', '2019-04-04T22:22:19.000-0700', '2019-04-04T22:22:19.000-0700', 'Closed', '', 5, '0', 2, 30, 17, 2, 'cefd13e32311ace392ed03f69b89221b8ecfb183'),
('puppet', 31229, 17972513, 2840, 'PR (2494) Insecure shipped Cipher settings in Passenger example config ', 'https://github.com/puppetlabs/puppet/pull/2494', 'https://tickets.puppetlabs.com/browse/PUP-2177', 'https://github.com/puppetlabs/puppet/pull/2840', '2014-04-08T08:37:55.000-0700', '2019-04-04T22:22:21.000-0700', '2019-04-04T22:22:21.000-0700', 'Closed', 'github', 10, '0', 1, 2, 2, 1, '204b2974bf7d10a41b10532c7565de36e993276a'),
('puppet', 57690, 23876331, 3276, 'Include pkgng provider for FreeBSD', 'Rather than require a module to implement this functionality, Puppet should ship with the new provider and update existing ones to deprecate functionality where no longer required.\r\n\r\nrisk: low', 'https://tickets.puppetlabs.com/browse/PUP-3618', 'https://github.com/puppetlabs/puppet/pull/3276', '2014-11-04T16:36:46.000-0800', '2019-04-04T22:22:22.000-0700', '2019-04-04T22:22:22.000-0700', 'Closed', '', 4, '0', 2, 318, 3, 7, '77e7f9a98c7bb6f98de7c66ea7b6cb3b9373eef6'),
('puppet', 64921, 28043572, 3519, 'Default license for module metadata does not match an identifier provided by SPDX', 'When using the puppet module tool to generate a module the default license string is not a valid identifier provided by [SPDX|http://spdx.org/licenses/].\r\n\r\nThe current default value is ''Apache 2.0''. This should be ''Apache-2.0''.\r\n\r\nThe current puppetlabs documentation already has the correct value\r\nhttps://docs.puppetlabs.com/puppet/latest/reference/modules_publishing.html#write-a-metadatajson-file\r\n\r\nCurrently anyone using default value for license when creating a module will fail metadata linting and be marked down by forge''s scoring.', 'https://tickets.puppetlabs.com/browse/PUP-3894', 'https://github.com/puppetlabs/puppet/pull/3519', '2015-01-22T01:38:12.000-0800', '2019-04-04T22:22:23.000-0700', '2019-04-04T22:22:23.000-0700', 'Closed', '', 6, '0', 1, 2, 2, 1, 'cdc4eb527ecbd3b71e2da18468623e2257ec9819'),
('puppet', 33051, 15131764, 2576, 'Shellquote function includes words of 0 length', 'Given the following code in a puppet manifest:\r\n\r\n$foo = ''--foo''\r\n$bar = ''''"\r\n$baz ="--baz"\r\n\r\n$command = shellquote(''asdf'',$foo,$bar,$baz)\r\n\r\nIt produces this value for $command:\r\n\r\nasdf --foo \"\" --baz\r\n\r\nWhereas I think it should produce:\r\n\r\nasdf --foo --baz\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2361', 'https://github.com/puppetlabs/puppet/pull/2576', '2014-04-24T10:30:35.000-0700', '2019-04-04T22:22:23.000-0700', '2019-04-04T22:22:23.000-0700', 'Closed', '', 2, '0', 1, 13, 1, 2, ''),
('puppet', 57867, 25380545, 3367, 'Running with --test should run with at least info level', 'The change for PUP-2998 means if you have log_level=debug in your puppet.conf, then puppet agent --test will reduce the log level to info, because --test implies --verbose.\r\n\r\nPer [puppet-dev discussion|https://groups.google.com/d/topic/puppet-dev/oa8zGx8mAgg/discussion] the consensus is that \--test/\--verbose should use *at least* info level.', 'https://tickets.puppetlabs.com/browse/PUP-3624', 'https://github.com/puppetlabs/puppet/pull/3367', '2014-11-05T15:23:00.000-0800', '2019-04-04T22:22:24.000-0700', '2019-04-04T22:22:24.000-0700', 'Closed', '', 3, '0', 1, 27, 7, 4, 'b99772f31aacb5aede10e6df72987643e707a689'),
('puppet', 24740, 19255772, 2933, 'After upgrade from 3.3.2-1 to 3.4.2-1 naginator fails to create config from exported resources taken from hiera', 'gtAfter upgrade from 3.3.2-1 to 3.4.2-1 naginator fails to create config from exported resources, data taken from hiera.\r\n\r\nWhen hiera has the following data:\r\n         "check_apt_security" : {\r\n             "check_command" : "check_nrpe_1arg!check_apt_security",\r\n             "contact_groups" : "sladmins",\r\n             "normal_check_interval" : 10,\r\n             "retry_check_interval"  : 30,\r\n             "max_check_attempts"    : 3, \r\n             "notification_interval" : 1440,\r\n             "notifications_enabled" : 1\r\n         }\r\n\r\nError: /Stage[main]/Nagios::Base/Nagios_service[xxxx]: Could not evaluate: private method `sub'' called for 1:Fixnum\r\nWhich clearly indicates that variable is not a string.\r\n\r\nWhen I quote integers in the hiera json file everything works fine, not sure if this is hiera or puppet naginator problem.', 'https://tickets.puppetlabs.com/browse/PUP-1527', 'https://github.com/puppetlabs/puppet/pull/2933', '2014-01-28T04:29:19.000-0800', '2019-04-04T22:22:24.000-0700', '2019-04-04T22:22:24.000-0700', 'Closed', 'core;hiera;naginator', 13, '0', 1, 10, 1, 2, '3edb29f7b829f3922db4fd5ce0f03bb6ea91da0e'),
('puppet', 50896, 20417317, 3027, 'User group membership duplication when group list created from multiple sources', 'n a Puppet node that has multiple group directories (e.g. /etc/group and LDAP) puppet may end up with groups listed multiple times in a user''s group list. This leads to a state of constant change where puppet detects the muliple entries and tries to remove them (when nothing is wrong).\r\n\r\nThis change ensures that a user''s group list only contains unique entries and no duplicates.\r\n\r\n(We have local groups as a fail-over when LDAP is unavailable as we use groups for sudo authentication)\r\n\r\nSolution provided with PR on GitHub: https://github.com/puppetlabs/puppet/pull/3027', 'https://tickets.puppetlabs.com/browse/PUP-3232', 'https://github.com/puppetlabs/puppet/pull/3027', '2014-09-10T18:52:52.000-0700', '2019-04-04T22:22:25.000-0700', '2019-04-04T22:22:25.000-0700', 'Closed', 'ldap;needs_decision;puppet;type_and_provider;user', 9, '0', 1, 10, 3, 3, ''),
('puppet', 35540, 44960196, 4246, 'OS X group resource triggers spurious notice of a change', 'If I create a simple group resource on OS X:\r\n{code:puppet}\r\ngroup { "admin": members => ["root", "clay", "localadmin"] }\r\n{code}\r\n\r\nand apply it multiple times, each time it triggers a "notice" that the membership has changed, even though the group provider did not make any changes.\r\n\r\n{noformat}\r\n# puppet -d\r\ngroup { "admin": members => ["root", "clay", "localadmin"] }\r\ninfo: Loading facts in antivirus\r\ninfo: Loading facts in cached_ldap_data\r\ninfo: Loading facts in certname\r\ninfo: Loading facts in corp_in_searchpath\r\ninfo: Loading facts in debconf\r\ninfo: Loading facts in en0_macaddress\r\ninfo: Loading facts in encryption\r\ninfo: Loading facts in environment\r\ninfo: Loading facts in fstab_uuid\r\ninfo: Loading facts in goobuntu_sshconfig_version\r\ninfo: Loading facts in google_distro\r\ninfo: Loading facts in hardware\r\ninfo: Loading facts in in_china\r\ninfo: Loading facts in installing\r\ninfo: Loading facts in lobby\r\ninfo: Loading facts in locale\r\ninfo: Loading facts in macadmin_hash_path\r\ninfo: Loading facts in machine_customizations\r\ninfo: Loading facts in machine_in_ldap\r\ninfo: Loading facts in machine_type\r\ninfo: Loading facts in macos_info\r\ninfo: Loading facts in oel_info\r\ninfo: Loading facts in ops_owner\r\ninfo: Loading facts in primary_user\r\ninfo: Loading facts in region\r\ninfo: Loading facts in remote_access\r\ninfo: Loading facts in servicedb\r\ninfo: Loading facts in sh_node\r\ninfo: Loading facts in solaris_info\r\ninfo: Loading facts in ssh_disabled\r\ninfo: Loading facts in zone\r\ndebug: Puppet::Type::Group::ProviderPw: file /usr/sbin/pw does not exist\r\ndebug: Puppet::Type::Group::ProviderGroupadd: file groupdel does not exist\r\ndebug: Puppet::Type::Group::ProviderLdap: true value when expecting false\r\ndebug: Creating default schedules\r\ndebug: Failed to load library ''shadow'' for feature ''libshadow''\r\ndebug: Puppet::Type::User::ProviderUseradd: file userdel does not exist\r\ndebug: Puppet::Type::User::ProviderPw: file pw does not exist\r\ndebug: Puppet::Type::User::ProviderUser_role_add: file roledel does not exist\r\ndebug: Puppet::Type::User::ProviderLdap: true value when expecting false\r\ndebug: Puppet::Type::User::ProviderDirectoryservice: Executing ''/usr/bin/dscl -plist . -list /Users''\r\ndebug: Puppet::Type::User::ProviderDirectoryservice: Executing ''/usr/bin/dscl -plist . -read /Users/root''\r\ndebug: Failed to load library ''selinux'' for feature ''selinux''\r\ndebug: Puppet::Type::File::ProviderMicrosoft_windows: feature microsoft_windows is missing\r\ndebug: /File[/etc/puppet/ssl]: Autorequiring File[/etc/puppet]\r\ndebug: /File[/var/puppet/state/classes.txt]: Autorequiring File[/var/puppet/state]\r\ndebug: /File[/var/puppet/state]: Autorequiring File[/var/puppet]\r\ndebug: /File[/etc/puppet/ssl/certs]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/var/puppet/facts]: Autorequiring File[/var/puppet]\r\ndebug: /File[/etc/puppet/ssl/certs/ca.pem]: Autorequiring File[/etc/puppet/ssl/certs]\r\ndebug: /File[/etc/puppet/ssl/crl.pem]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/etc/puppet/ssl/public_keys]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/etc/puppet/ssl/public_keys/c37b1476-214e-4897-824e-2dcd24c60543.pem]: Autorequiring File[/etc/puppet/ssl/public_keys]\r\ndebug: /File[/var/puppet/client_yaml]: Autorequiring File[/var/puppet]\r\ndebug: /File[/var/puppet/lib]: Autorequiring File[/var/puppet]\r\ndebug: /File[/var/puppet/run]: Autorequiring File[/var/puppet]\r\ndebug: /File[/etc/puppet/ssl/private_keys]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/etc/puppet/ssl/certificate_requests]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/var/puppet/client_data]: Autorequiring File[/var/puppet]\r\ndebug: /File[/var/puppet/log]: Autorequiring File[/var/puppet]\r\ndebug: /File[/var/puppet/state/state.yaml]: Autorequiring File[/var/puppet/state]\r\ndebug: /File[/etc/puppet/ssl/private_keys/c37b1476-214e-4897-824e-2dcd24c60543.pem]: Autorequiring File[/etc/puppet/ssl/private_keys]\r\ndebug: /File[/var/puppet/state/graphs]: Autorequiring File[/var/puppet/state]\r\ndebug: /File[/etc/puppet/ssl/certs/c37b1476-214e-4897-824e-2dcd24c60543.pem]: Autorequiring File[/etc/puppet/ssl/certs]\r\ndebug: /File[/var/puppet/clientbucket]: Autorequiring File[/var/puppet]\r\ndebug: /File[/etc/puppet/ssl/private]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: Finishing transaction 2164043380\r\ndebug: Loaded state in 1.40 seconds\r\ninfo: Applying configuration version ''1285271264''\r\ndebug: Puppet::Type::Group::ProviderDirectoryservice: Executing ''/usr/bin/dscl -plist . -list /Groups''\r\ndebug: Puppet::Type::Group::ProviderDirectoryservice: Executing ''/usr/bin/dscl -plist . -read /Groups/admin''\r\nnotice: /Stage[main]//Group[admin]/members: members changed ''clay,root,localadmin'' to ''root,clay,localadmin''\r\ndebug: Finishing transaction 2189862280\r\ndebug: Storing state\r\ndebug: Stored state in 6.98 seconds\r\n{noformat}\r\n\r\nI''m running puppet 2.6.1 on OS X 10.6.4 with the stock ruby (1.8.7) installed.', 'https://tickets.puppetlabs.com/browse/PUP-2575', 'https://github.com/puppetlabs/puppet/pull/4246', '2014-05-14T13:32:44.000-0700', '2019-04-04T22:22:26.000-0700', '2019-04-04T22:22:26.000-0700', 'Closed', 'redmine', 3, '0', 2, 43, 0, 2, '1931e9ae777abb48813f01a892ce10e1d814fbbf'),
('puppet', 90336, 148460781, 6301, 'Logrotate and init scripts permission and signal issues', 'This patch updates logrotate script and aligns it what is defined in\r\ndefaults.rb, specifically:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/defaults.rb#L1036-L1046\r\n\r\nand\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/defaults.rb#L1258-L1274\r\n\r\nBecause of logrotate and puppet during restart were both "fighting" for correct\r\nfile permissions, this was causing issues with SELinux. Also fixed paths which\r\nhas been incorrect for Fedora/RHEL systems (/var/log/puppetlabs vs\r\n/var/log/puppet). It contains both now which seems to work just fine.\r\n\r\nI am not adding logrotate scriplet for master tho as I don''t know if it\r\nsupports signals. When running master under webrick one should not expect fully\r\nworking log rotation tho. Open for discussion.\r\n\r\nAs part of this patch, I am also updating Red Hat startup scripts:\r\n\r\nRHEL6 traditional UNIX-like "reload" command was actually sending HUP signal and therefore restarting daemon instead correct USR1\r\nRHEL7 systemd unit was extended with "reload" command using USR1 signal\r\n\r\nhttps://github.com/puppetlabs/puppet/pull/4097', 'https://tickets.puppetlabs.com/browse/PUP-4918', 'https://github.com/puppetlabs/puppet/pull/6301', '2015-07-23T01:45:14.000-0700', '2019-04-04T22:22:27.000-0700', '2019-04-04T22:22:27.000-0700', 'Closed', '', 4, '0', 1, 1, 1, 1, '793d713503d27600b4c64e4e0c331d6d7365e3c4'),
('puppet', 60342, 25519645, 3380, 'Cron type uses incorrect month when month name is provided', '{code:puppet} cron { ''demo cron job'':\r\n    command  => ''echo test'',\r\n    user     => ''root'',\r\n    hour     => ''1'',\r\n    minute   => ''0'',\r\n    month    => ''December'',\r\n    monthday => [''3-15''],\r\n} {code}\r\n\r\nThis should create a cronjob like this:\r\n{{0 1 3-15 12 * echo test}}\r\nInstead it creates a cronjob like this:\r\n{{0 1 3-15 11 * echo test}}\r\n\r\nNote that this creates a cronjob for the 11th month, November, rather than the 12th. Cron counts months from 1-12, rather than 0-11.\r\n\r\nPuppet appears to create cronjobs with a month 1 fewer than it should.\r\n\r\nIf you give it "January" as a month, you get an invalid cron entry which cannot be created.', 'https://tickets.puppetlabs.com/browse/PUP-3728', 'https://github.com/puppetlabs/puppet/pull/3380', '2014-12-03T04:59:30.000-0800', '2019-04-04T22:22:28.000-0700', '2019-04-04T22:22:28.000-0700', 'Closed', '', 6, '0', 1, 29, 25, 2, '8d685a2b76f2c123a8e6f2f513a2e8d144030dc8'),
('puppet', 21353, 415935946, 8147, 'Default setting for pluginsource problematic for deployments using SRV records', 'The current default for the `pluginsource` setting is `puppet://$server/plugins`.  This works well with a `server` set, but in deployments that utilize 3.0''s SRV record feature, the `server` setting is likely not utilized at all for communication with a master, and will often be unset.\r\n\r\nIf SRV records are in use the `pluginsource` still gets filled in with the contents of the `server` setting - and if it''s unset, then the default is `puppet`.  This causes failure of the pluginsync process, which is a non-fatal error for the agent run:\r\n    \r\n    Error: /File[/var/lib/puppet/lib]: Failed to generate additional resources using ''eval_generate: getaddrinfo: Name or service not known\r\n    Error: /File[/var/lib/puppet/lib]: Could not evaluate: getaddrinfo: Name or service not known Could not retrieve file metadata for puppet://puppet/plugins: getaddrinfo: Name or service not known\r\n\r\nI believe that changing the default setting for `pluginsource` from `puppet://$server/plugins` to `puppet:///plugins` is functionally equivalent for ''normal'' deployments not running `use_srv_records`, while it will cause the pluginsync process to find a working master in cases where `use_srv_records` is utilized.\r\n\r\nSimply setting `pluginsource = puppet:///plugins` is an effective workaround for SRV record deployments in the interim.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1035', 'https://github.com/puppetlabs/puppet/pull/8147', '2013-12-16T03:00:32.000-0800', '2019-04-04T22:22:28.000-0700', '2019-04-04T22:22:28.000-0700', 'Closed', 'redmine', 16, '0', 1, 2, 14, 1, '82f2a5f61caf537e334a8c5d5bebcc098d2776d8'),
('puppet', 53580, 24201490, 3299, 'Issue Creating Multiple Mirrors in Zpool Resource', 'Bug in the mirror property under zpool resource\r\n\r\nhttps://docs.puppetlabs.com/references/latest/type.html#zpool-attribute-mirror\r\n\r\nmirror => ["disk1 disk2", "disk3 disk4"],\r\n\r\nIn the Previous version It took that string value as a single array and tried to find a drive named "disk1 disk2" and also wouldn''t attach the word mirror to "disk3 disk4"', 'https://tickets.puppetlabs.com/browse/PUP-3388', 'https://github.com/puppetlabs/puppet/pull/3299', '2014-10-03T13:02:29.000-0700', '2019-04-04T22:24:13.000-0700', '2019-04-04T22:24:13.000-0700', 'Closed', '', 12, '0', 2, 54, 12, 2, '83649041921df5a44d9d2f611763b5c6ef561f43'),
('puppet', 84363, 60228565, 4694, 'Allow resources to be purged even when they have dependency relationships', 'Please see PUP-1963 for the original problem report and some detailed breakdown of these two issues. The fix for PUP-1963 will be the first part (of two) of the fix for the problem report, and this ticket will be the second part.', 'https://tickets.puppetlabs.com/browse/PUP-4748', 'https://github.com/puppetlabs/puppet/pull/4694', '2015-06-11T19:57:36.000-0700', '2019-04-04T22:24:14.000-0700', '2019-04-04T22:24:14.000-0700', 'Closed', '', 3, '0', 1, 0, 72, 2, '8590141c4bc358338ebf770aba121b352bcbad1e'),
('puppet', 60034, 26477232, 3434, 'Group resource non-authoritative by default (Breaking change)', 'The {{auth_membership}} group parameter controls whether puppet ensures the group contains *exactly* the members specified, and no more, or contains *at least* the members specified. By default, the group parameter defaults to the former, which is opposite to the {{auth_membership}} user parameter. This makes the group parameter difficult to use in practice, because you need to know what the complete set of group members should be. For example, on Windows the local {{Administrators}} group may contain a combination of local and domain user/group accounts, and that may vary across different types of machines.\r\n\r\nWe should change the {{auth_membership}} group parameter to default to false so that it is consistent with the user parameter.', 'https://tickets.puppetlabs.com/browse/PUP-3719', 'https://github.com/puppetlabs/puppet/pull/3434', '2014-12-01T11:22:31.000-0800', '2019-04-04T22:24:15.000-0700', '2019-04-04T22:24:15.000-0700', 'Closed', 'docs_reviewed', 2, '0', 1, 33, 10, 3, '9db23cedbb330ae79f7814c041858317ad101e23'),
('puppet', 58302, 26343270, 3428, 'Prefetch eats most exceptions (those derived from StandardError), there is no way to fail out.', 'https://github.com/puppetlabs/puppet/blob/master/lib/puppet/transaction.rb#L306-L310\r\n\r\nThis bug still exists in the master branch as of today and was introduced in 2.7.8 with this commit:\r\n\r\nhttps://github.com/puppetlabs/puppet/commit/000a2d811c740f4179a0cd4ced38e886858cf01f\r\n\r\nThe rescue condition means that any exception raised by providers during prefetch gets logged but then swallowed by Puppet. As a result of this, any provider which relies *only* on prefetch to find all instances will end up running the resource creation regardless of whether the resource exists or not.\r\n\r\nIn order to negate this behaviour, provider authors would need to create checks for instance existence which run during the creation phase as well, which defeats the point of having prefetch in the first place.\r\n\r\n---\r\nNote to docs: module authors who use the {{prefetch}} method may want to be aware of the changes in this fix. Two things to consider:\r\n# previously, the prefetch method could throw *any* exception and puppet would carry on. As discussed above this is the wrong behavior in general, however some module authors may have stumbled across this, allowed/encouraged prefetch to throw exceptions, and let puppet runs succeed. So modules should be examined for this assumption.\r\n# the only two legitimate causes for prefetch to throw an exception now are {{LoadError}} and (added in this puppet 4.0) {{Puppet::MissingCommand}}\r\n\r\nThis is a breaking change in 4.0. ', 'https://tickets.puppetlabs.com/browse/PUP-3656', 'https://github.com/puppetlabs/puppet/pull/3428', '2014-11-11T08:38:27.000-0800', '2019-04-04T22:24:16.000-0700', '2019-04-04T22:24:16.000-0700', 'Closed', 'breaking;docs_reviewed', 13, '0', 2, 9, 2, 4, 'c4262d4d72aebbcd722a4c326038b63dea59ccf2'),
('puppet', 154592, 0, 0, 'Interpolation within Data Provider should respect strict variables setting', 'followup to this comment thread: https://github.com/Yelp/puppet/commit/087312f99e1e45733bec09f5a61f9fa7f1b70874#commitcomment-19242530', 'https://tickets.puppetlabs.com/browse/PUP-6767', 'https://github.com/puppetlabs/puppet/commit/b539fe581f372514e28f4c7e095d81dc8b0f500c', '2016-09-30T23:48:44.000-0700', '2019-04-04T22:24:17.000-0700', '2019-04-04T22:24:17.000-0700', 'Accepted', '', 2, '0', 0, 0, 0, 0, 'b539fe581f372514e28f4c7e095d81dc8b0f500c'),
('puppet', 32071, 124522772, 5956, 'If a resource is triggered by a refresh, and it fails, puppet doesn''t treat it as a failure', 'This may be a dupe of #9237.\r\n\r\nI have a module (puppetlabs/postgresql) that has some resources that are only triggered via a refresh notification.  In my case the resource is a custom ruby type, but I stole some of its ''refreshonly'' implementation from the Exec type, so this may be simply a problem with the exec type rather than a more general puppet problem.  Here''s an example that shows the problem using exec:\r\n\r\n{noformat}\r\n    cprice@localhost ~/work/scratch $ puppet --version\r\n    3.0.2-rc2\r\n\r\n    cprice@localhost ~/work/scratch $ cat foo.pp \r\n    notify { "hi": } ~>\r\n    exec { "/bin/this_command_does_not_exist":\r\n       refreshonly => true,\r\n    }\r\n\r\n    cprice@localhost ~/work/scratch $ puppet apply ./foo.pp\r\n    No LSB modules are available.\r\n    No LSB modules are available.\r\n    Notice: hi\r\n    Notice: /Stage[main]//Notify[hi]/message: defined ''message'' as ''hi''\r\n    Error: /Stage[main]//Exec[/bin/this_command_does_not_exist]: Failed to call refresh: Could not find command ''/bin/this_command_does_not_exist''                                          \r\n    Error: /Stage[main]//Exec[/bin/this_command_does_not_exist]: Could not find command ''/bin/this_command_does_not_exist''                                                                  \r\n    Notice: Finished catalog run in 0.18 seconds\r\n    cprice@localhost ~/work/scratch $ echo $?\r\n    0\r\n    cprice@localhost ~/work/scratch $\r\n{noformat}\r\n\r\nThis has apparently been masking a legitimate bug in my module for several months now.', 'https://tickets.puppetlabs.com/browse/PUP-2280', 'https://github.com/puppetlabs/puppet/pull/5956', '2014-04-16T13:12:37.000-0700', '2019-04-04T22:24:17.000-0700', '2019-04-04T22:24:17.000-0700', 'Closed', 'customer;exec;redmine;resolved-issue-added', 15, '0', 1, 27, 7, 5, '40b3a4f86f67fb7c84aed833c05aa242338a6b3e'),
('puppet', 82075, 36465151, 3976, 'cannot create a define named something that starts with ''class''', '{code}\r\n[master /etc/puppetlabs/puppet/modules/classroom]# cat manifests/boo.pp\r\ndefine classroom::boo {\r\n  notify { $name: }\r\n}\r\n\r\n[master /etc/puppetlabs/puppet/modules/classroom]# cat tests/wtf.pp\r\nclassroom::boo { ''what the'': }\r\n\r\nnotify { ''test'':\r\n  require => Classroom::Boo[''what the''],\r\n}\r\n\r\n[master /etc/puppetlabs/puppet/modules/classroom]# puppet apply tests/wtf.pp\r\nNotice: Compiled catalog for master.puppetlabs.vm in environment production in 0.47 seconds\r\nError: Could not find dependency Class[What the] for Notify[test] at /etc/puppetlabs/puppet/modules/classroom/tests/wtf.pp:3\r\n{code}\r\n\r\nWORD AROUND EXISTS\r\n---\r\nThis can be worked around by giving the reference as a string instead of as a type:\r\n{code:puppet}\r\n  require "Classroom[what the]"\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4668', 'https://github.com/puppetlabs/puppet/pull/3976', '2015-05-28T16:20:24.000-0700', '2019-04-04T22:24:18.000-0700', '2019-04-04T22:24:18.000-0700', 'Closed', 'future-parser', 8, '0', 1, 20, 1, 2, 'a924b6301e8bb3571bea13dca745eccf1df22007'),
('puppet', 178644, 109500851, 5695, 'puppet generate types for environment isolation generates invalid code', 'Ticket created based on comment from [~henrik.lindberg] ([SERVER-94?focusedCommentId=385558|https://tickets.puppetlabs.com/browse/SERVER-94?focusedCommentId=385558&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-385558]) and [~eric.sorenson] ([SERVER-94?focusedCommentId=388535|https://tickets.puppetlabs.com/browse/SERVER-94?focusedCommentId=388535&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-388535])\r\n\r\nI encountered the following problem with the https://github.com/theforeman/puppet-foreman module:\r\n{code}\r\npuppet parser validate /tmp/.resource_types/foreman_smartproxy.pp\r\n\r\nError: Could not parse for environment production: Syntax error at ''/'' at /tmp/.resource_types/foreman_smartproxy.pp:34:37\r\n{code}\r\nI attached the generated file to this ticket.\r\nWhat I can gather is that the ruby internal URI.regexp pattern from the foreman module (https://github.com/theforeman/puppet-foreman/blob/master/lib/puppet/type/foreman_smartproxy.rb#L33) does create a pattern which the Puppetserver then refuses to accept.\r\n\r\nNow I''m not sure if\r\n(a) the puppet generate did something wrong with the URI.regexp or\r\n(b) the guys from the foreman-puppet module should change something.\r\n\r\nGithub issue link to the puppet-foreman project: https://github.com/theforeman/puppet-foreman/issues/512\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7306', 'https://github.com/puppetlabs/puppet/pull/5695', '2017-03-06T04:48:42.000-0800', '2019-04-04T22:25:14.000-0700', '2019-04-04T22:25:14.000-0700', 'Closed', '', 6, '0', 1, 9, 1, 2, '7bf37e8c4c6f9d90beaf857189842d1e4bdd1461'),
('puppet', 56547, 29298348, 3607, 'Add support for properly signed trusted facts', 'Once trusted facts are properly signed as per SERVER-119 we will need to update the Ruby Puppet code to recognize the properly encoded trusted facts, as well as the older improperly encoded trusted facts. It may also be a good idea to `update the way Ruby Puppet signs trusted facts, and the Netscape Comment extension to match the RFC-5280 spec.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3560', 'https://github.com/puppetlabs/puppet/pull/3607', '2014-10-28T16:51:00.000-0700', '2019-04-04T22:28:47.000-0700', '2019-04-04T22:28:47.000-0700', 'Closed', '', 10, '0', 1, 15, 169, 9, 'eb4671f20e6298551dea5dc0e0c95a8722885d2c'),
('puppet', 64259, 27960741, 3515, 'auth.conf no longer restricting based on environment', 'Our documentation (https://docs.puppetlabs.com/guides/rest_auth_conf.html#environment) states that in auth.conf you can specify an environment or a list of environments allowed for an ACL.\r\n\r\nWith the move of environment from the first path fragment to a query parameter, this seems to no longer work.\r\n\r\nTest (on stable):\r\n Change auth.conf to have the following block, replacing the default block for {{path ~ ^/node/([^/]+)$}}\r\n\r\n{code}\r\npath ~ ^/node/([^/]+)$\r\nmethod find\r\nenvironment production\r\nauth any\r\nallow *\r\n{code}\r\n\r\nStart the puppet master. Make a request against the node endpoint with environment production:\r\n{code}\r\n$ curl -k https://localhost:8140/production/node/foo\r\n{"document_type":"Node","data":{"name":"foo","environment":"production"}}\r\n{code}\r\n\r\nThe request with environment production is authorized and returns information.\r\n\r\nCreate a {{test}} directory in the environmentpath.\r\n\r\nMake a request with the {{test}} environment. It will fail because the environment is not authorized.\r\n\r\n{code}\r\n$ curl -k https://localhost:8140/test/node/foo\r\nForbidden request: localhost(127.0.0.1) access to /node/foo [find] at :125\r\n{code}\r\n\r\nTrying this on master, with the following equivalent ACL (with prefix and version added)\r\n{code}\r\npath ~ ^/puppet/v3/node/([^/]+)$\r\nmethod find\r\nenvironment production\r\nauth any\r\nallow *\r\n{code}\r\n\r\nwhich should allow a request with environment=production. However, instead I get:\r\n{code}\r\n$ curl -k https://localhost:8140/puppet/v3/node/foo?environment=production\r\nForbidden request: localhost(127.0.0.1) access to /puppet/v3/node/foo [find] at :129\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3855', 'https://github.com/puppetlabs/puppet/pull/3515', '2015-01-15T13:32:50.000-0800', '2019-04-04T22:28:49.000-0700', '2019-04-04T22:28:49.000-0700', 'Closed', '', 4, '0', 2, 28, 5, 2, 'd654c1d08f9ef6550f2da7c23660a340396dcfdf'),
('puppet', 51204, 24331059, 3302, 'puppet incorrectly swallows some errors', 'puppet has a lot of places that do {{rescue Exception}} and then swallow the exception.  In some cases, the exception is not even logged.\r\n\r\nAt least, this code should be changed to handle {{StandardError}} instead, and the errors should always be logged.\r\n\r\nThis can be particularly problematic for certain errors - say, an {{OutOfMemoryError}} when running on JRuby, which ends up operating as a subclass of ruby''s {{Exception}}.  (although we''ve now solved this particular issue in packaging)', 'https://tickets.puppetlabs.com/browse/PUP-3521', 'https://github.com/puppetlabs/puppet/pull/3302', '2014-09-15T10:06:12.000-0700', '2019-04-04T22:28:53.000-0700', '2019-04-04T22:28:53.000-0700', 'Closed', '', 1, '0', 1, 17, 34, 12, 'eccd3b427e9463277c890966978ea5bdcd7eacba'),
('puppet', 82453, 38527823, 4056, 'org.jruby.exceptions.RaiseException: (SystemStackError) stack level too deep', 'Release Note\r\n----\r\nSerialization of {{node}} objects could produce giant serializations than when later loaded would cause ''stack level too deep'' errors. This was caused\r\nby logic missing in the node implementation that should have prevented serialization of the entire runtime state of the environment.\r\n\r\nSummary\r\n----\r\nSerialization/Deseerialization of Puppet::Node objects using yaml causes the entire environment associated with the node to be serialized in full - this is everything loaded and evaluated in the environment, and it goes very deep. As noted in comments, it is possible to work around the issue of hitting a stack overflow by increasing the stack and making more memory available.\r\n\r\nThe root cause is that objects (such as Puppet::Node) which requires asymmetric serialization (it only wants a serialization of the environment''s name, and looks up the environment on deserialization) must include a module:\r\n\r\n{code:ruby}\r\ninclude Puppet::Util::PsychSupport\r\n{code}\r\n\r\nto get the expected behavior of using to/from datahash methods.\r\n\r\n\r\nORIGINAL\r\n---\r\nAfter running for a while Puppet agent runs start to fail due to server errors, the exception appears to indicate an issue with yaml encoding. This error was happening with 2.0.0 and I have also tried the latest package available in the nightly repo which is exhibiting the same behaviour.\r\n\r\n{noformat}\r\n2015-05-31 15:50:41,651 ERROR [p.p.ringutils] Exception while handling HTTP request\r\norg.jruby.exceptions.RaiseException: (SystemStackError) stack level too deep\r\n	at org.jruby.RubyArray.each(org/jruby/RubyArray.java:1613) ~[puppet-server-release.jar:na]\r\n\r\n<repeated part omitted>\r\n\r\n	at RUBY.accept(/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/psych/visitors/yaml_tree.rb:128) ~[na:na]\r\n	at RUBY.dump_ivars(/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/psych/visitors/yaml_tree.rb:480) ~[na:na]\r\n	at org.jruby.RubyArray.each(org/jruby/RubyArray.java:1613) ~[puppet-server-release.jar:na]\r\n	at RUBY.dump_ivars(/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/psych/visitors/yaml_tree.rb:478) ~[na:na]\r\n	at RUBY.visit_Object(/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/psych/visitors/yaml_tree.rb:150) ~[na:na]\r\n	at RUBY.accept(/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/psych/visitors/yaml_tree.rb:128) ~[na:na]\r\n	at RUBY.visit_Array(/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/shared/psych/visitors/yaml_tree.rb:344) ~[na:na]\r\n	at org.jruby.RubyArray.each(org/jruby/RubyArray.java:1613) ~[puppet-server-release.jar:na]\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-4775', 'https://github.com/puppetlabs/puppet/pull/4056', '2015-06-01T11:46:59.000-0700', '2019-04-04T22:28:55.000-0700', '2019-04-04T22:28:55.000-0700', 'Closed', '', 35, '0', 1, 26, 3, 2, 'edee9ebe1b5e63b2b80264c662fc5117535df6f3'),
('puppet', 69052, 65667867, 4847, 'Puppet Server 1.0.2 Could not find file file_metadata and file_bucket md5/<hash>', 'Hello,\r\n\r\nI''ve just switched from apache/passenger to puppet server 1.0.2 in our sandbox (after switching from hiera-gpg to hiera-eyaml).\r\nDoing some test runs shows the following in the pupppetserver.log file;\r\n\r\n015-02-23 20:32:55,505 INFO  [puppet-server] Puppet Not Found: Could not find file_metadata modules/mondo/3/tb/make_mondoarchive.sh..<hostname>\r\n2015-02-23 20:42:50,916 INFO  [puppet-server] Puppet Not Found: Could not find file_metadata modules/mondo/3/tb/make_mondoarchive.sh.<hostname>\r\n2015-02-23 20:43:07,700 INFO  [puppet-server] Puppet Not Found: Could not find file_metadata modules/mondo/3/tb/make_mondoarchive.sh..<hostname>\r\n2015-02-23 20:43:13,963 INFO  [puppet-server] Puppet Not Found: Could not find file_bucket_file md5/85b75b6e41c467513f4625947c84f1cc//etc/puppet/scripts/monthly_run.sh\r\n2015-02-23 20:43:18,173 INFO  [puppet-server] Puppet Not Found: Could not find file_metadata modules/mondo/3/tb/make_mondoarchive.sh.<hostname>\r\n2015-02-23 20:43:36,080 INFO  [puppet-server] Puppet Not Found: Could not find file_metadata modules/mondo/3/tb/make_mondoarchive.sh.<hostname>\r\n2015-02-23 20:48:16,747 INFO  [puppet-server] Puppet Not Found: Could not find file_metadata modules/mondo/3/tb/make_mondoarchive.sh.<hostname>\r\n2015-02-23 20:51:34,403 INFO  [puppet-server] Puppet Not Found: Could not find file_bucket_file md5/f4f7e01332717f3f591868a3dcd909ab//etc/sudoers\r\n\r\nThe file_metadata seems to happen on all resources with a sourceselect in the manifest.\r\nmake_mondoarchive.sh is done by a sourceselect (first) in the manifest like;\r\n  file { ''/tb/jobs/system/make_mondoarchive.sh'':\r\n    ensure       => present,\r\n    owner        => ''root'',\r\n    group        => ''root'',\r\n    mode         => ''0700'',\r\n    source       => [ "puppet:///modules/mondo/${mondo::params::mondo_version}/tb/make_mondoarchive.sh.${::hostname}",\r\n                      "puppet:///modules/mondo/${mondo::params::mondo_version}/tb/make_mondoarchive.sh.${mondo::params::mondo_nfs_version}",\r\n                      "puppet:///modules/mondo/${mondo::params::mondo_version}/tb/make_mondoarchive.sh"],\r\n    sourceselect => first,\r\n    require      => Class[''mondo::install''],\r\n  }\r\n\r\nThat it cannot find those files is correct, as they don''t exist on the filesystem.\r\n\r\nWith the apache/passenger setup we never had these messages, so we don''t expect them with puppet server, correct?\r\n\r\nElse there will be a *load* of these message when we use puppet server in out production environment.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6139', 'https://github.com/puppetlabs/puppet/pull/4847', '2015-02-23T12:31:31.000-0800', '2019-04-04T22:28:56.000-0700', '2019-04-04T22:28:56.000-0700', 'Closed', '', 25, '0', 1, 1, 1, 1, ''),
('puppet', 122071, 63353218, 4798, 'Serious regression with exception in reduce() & others after change from Enumerable to Iterable', 'The behavior is not stable. +There is no exception with `puppet apply` & Ruby+, the exception is triggered only on JRuby when invoked through Puppet Server.\r\n\r\nIt may be one of already solved JRuby bugs => bundled JRuby update may be required.\r\n\r\nThe same data with small modifications work without issues, I tried to reduce example as possible until the exception is still triggered. *In the example below try to remove "keyname4" entry and no exception is triggered.*\r\n\r\nThis has worked on Puppet 4.3.2 and started to fail with upgrade to 4.4.0.\r\n\r\nAs with previous Hiera issue, I can expect that some third-party module may have polluted Puppet type system, but see no evidence so far.\r\n\r\nHere''s example data in Puppet code:\r\n{code}\r\n$data = [\r\n{\r\n"certname"=>"xxxxxxxxx.some.domain",\r\n"parameters"=>{\r\n    "admin_auth_keys"=>{\r\n        "keyname1"=>{\r\n            "key"=>"ABCDEF",\r\n            "options"=>["from=\"10.0.0.0/8\""]\r\n        },\r\n        "keyname2"=>{\r\n            "key"=>"ABCDEF",\r\n        },\r\n        "keyname3"=>{\r\n            "key"=>"ABCDEF",\r\n            "options"=>["from=\"10.0.0.0/8\""],\r\n            "type"=>"ssh-xxx"\r\n        },\r\n        "keyname4"=>{\r\n            "key"=>"ABCDEF",\r\n            "options"=>["from=\"10.0.0.0/8\""]\r\n        }\r\n    },\r\n    "admin_user"=>"ertxa",\r\n    "admin_hosts"=>["1.2.3.4",\r\n        "1.2.3.4",\r\n        "1.2.3.4"],\r\n    "admin_password"=>"ABCDEF",\r\n    "sshd_ports"=>[22,\r\n        22, 24],\r\n    "sudo_no_password_all"=>false,\r\n    "sudo_no_password_commands"=>[],\r\n    "sshd_config_template"=>"cfauth/sshd_config.epp",\r\n    "sudo_env_keep"=>[]\r\n},\r\n"exported"=>false},\r\n]\r\n\r\n$data_reduced = $data.reduce({}) |$m, $r|{\r\n    $cn = $r[''certname'']\r\n    merge($m, { $cn => $r[''parameters''] })\r\n}\r\nfail($data_reduced)\r\n{code}\r\n\r\nException thrown:\r\n{noformat}\r\nError while evaluating a Method call, bignum too big to convert into `long''\r\n{noformat}\r\n\r\nTip of backtrace on exception:\r\n{noformat}\r\norg/jruby/RubyArray.java:689:in `hash''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/types/types.rb:1230:in `hash''\r\norg/jruby/RubyArray.java:3241:in `uniq''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/types/types.rb:1796:in `initialize''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/types/iterable.rb:57:in `on''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/types/iterable.rb:23:in `asserted_iterable''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/reduce.rb:118:in `reduce_with_memo''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:45:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:35:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:44:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:272:in `call_function''\r\n...\r\n{noformat}\r\n\r\nString dump of "types" argument to PVariantType::initialize()\r\n\r\n{noformat}\r\n[#<Puppet::Pops::Types::PStructType:0x413f087e @elements=[#<Puppet::Pops::Types::PStructElement:0x362c9f1b @key_type=#<Puppet::Pops::Types::PStringType:0x2b81c166 @values=["certname"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x6bf5362a @values=["xxxxxxxxx.some.domain"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x256cd7fc @to=21, @from=21>>>, #<Puppet::Pops::Types::PStructElement:0xcd7f496 @key_type=#<Puppet::Pops::Types::PStringType:0x35faaa70 @values=["exported"], @size_type=nil>, @value_type=Boolean>, #<Puppet::Pops::Types::PStructElement:0x1c5180ae @key_type=#<Puppet::Pops::Types::PStringType:0x2ad72e08 @values=["parameters"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStructType:0x1552bec4 @elements=[#<Puppet::Pops::Types::PStructElement:0xcc40685 @key_type=#<Puppet::Pops::Types::PStringType:0x19880c4f @values=["admin_auth_keys"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStructType:0x1943391f @elements=[#<Puppet::Pops::Types::PStructElement:0x36767b58 @key_type=#<Puppet::Pops::Types::PStringType:0x1c9bea57 @values=["keyname1"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStructType:0x1a5cb10a @elements=[#<Puppet::Pops::Types::PStructElement:0x7332a3a6 @key_type=#<Puppet::Pops::Types::PStringType:0x1962260 @values=["key"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x3e958868 @values=["ABCDEF"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x5ad869c6 @to=6, @from=6>>>, #<Puppet::Pops::Types::PStructElement:0x360874c2 @key_type=#<Puppet::Pops::Types::PStringType:0x65298844 @values=["options"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PTupleType:0x5b1f3111 @size_type=nil, @types=[#<Puppet::Pops::Types::PStringType:0x79ad733e @values=["from=\"10.0.0.0/8\""], @size_type=#<Puppet::Pops::Types::PIntegerType:0x1e3addca @to=17, @from=17>>]>>]>>, #<Puppet::Pops::Types::PStructElement:0x2ab70847 @key_type=#<Puppet::Pops::Types::PStringType:0x56808339 @values=["keyname2"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStructType:0x59bd49c0 @elements=[#<Puppet::Pops::Types::PStructElement:0x1035c8c2 @key_type=#<Puppet::Pops::Types::PStringType:0x3b0f40de @values=["key"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x2f671dcc @values=["ABCDEF"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x2b977eff @to=6, @from=6>>>]>>, #<Puppet::Pops::Types::PStructElement:0x6712adb4 @key_type=#<Puppet::Pops::Types::PStringType:0x7b4a3949 @values=["keyname3"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStructType:0x651817bf @elements=[#<Puppet::Pops::Types::PStructElement:0x7805d69b @key_type=#<Puppet::Pops::Types::PStringType:0x474c97ac @values=["key"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0xca0a8c4 @values=["ABCDEF"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x1efc8007 @to=6, @from=6>>>, #<Puppet::Pops::Types::PStructElement:0x53395b75 @key_type=#<Puppet::Pops::Types::PStringType:0x5aa38902 @values=["options"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PTupleType:0x14969328 @size_type=nil, @types=[#<Puppet::Pops::Types::PStringType:0x53ce046 @values=["from=\"10.0.0.0/8\""], @size_type=#<Puppet::Pops::Types::PIntegerType:0x14535e1f @to=17, @from=17>>]>>, #<Puppet::Pops::Types::PStructElement:0x6d484fa5 @key_type=#<Puppet::Pops::Types::PStringType:0x266511b0 @values=["type"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x59546b8d @values=["ssh-xxx"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x7c754174 @to=7, @from=7>>>]>>, #<Puppet::Pops::Types::PStructElement:0x761c6681 @key_type=#<Puppet::Pops::Types::PStringType:0x428ddbbb @values=["keyname4"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStructType:0x32675853 @elements=[#<Puppet::Pops::Types::PStructElement:0x69503b2a @key_type=#<Puppet::Pops::Types::PStringType:0x125c786a @values=["key"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x75ba9e5 @values=["ABCDEF"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x82e9875 @to=6, @from=6>>>, #<Puppet::Pops::Types::PStructElement:0x2b1b2d85 @key_type=#<Puppet::Pops::Types::PStringType:0x5498cdf @values=["options"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PTupleType:0x57442ef1 @size_type=nil, @types=[#<Puppet::Pops::Types::PStringType:0x72c35eec @values=["from=\"10.0.0.0/8\""], @size_type=#<Puppet::Pops::Types::PIntegerType:0x75ce5384 @to=17, @from=17>>]>>]>>]>>, #<Puppet::Pops::Types::PStructElement:0x3ccd3b88 @key_type=#<Puppet::Pops::Types::PStringType:0x45ff7ce7 @values=["admin_hosts"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PTupleType:0x2a200274 @size_type=nil, @types=[#<Puppet::Pops::Types::PStringType:0x3b33186c @values=["1.2.3.4"], @size_type=#<Puppet::Pops::Types::PIntegerType:0xb3ed69 @to=7, @from=7>>, #<Puppet::Pops::Types::PStringType:0x24a788db @values=["1.2.3.4"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x129dbe40 @to=7, @from=7>>, #<Puppet::Pops::Types::PStringType:0x3235654c @values=["1.2.3.4"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x515a4999 @to=7, @from=7>>]>>, #<Puppet::Pops::Types::PStructElement:0x7e960588 @key_type=#<Puppet::Pops::Types::PStringType:0x2b4564a5 @values=["admin_password"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x6cc039da @values=["ABCDEF"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x789be4e9 @to=6, @from=6>>>, #<Puppet::Pops::Types::PStructElement:0x42d1badb @key_type=#<Puppet::Pops::Types::PStringType:0x5742a222 @values=["admin_user"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x725cb5db @values=["ertxa"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x6e97cf8f @to=5, @from=5>>>, #<Puppet::Pops::Types::PStructElement:0x30bbee02 @key_type=#<Puppet::Pops::Types::PStringType:0x206de4d @values=["sshd_config_template"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PStringType:0x1b76f8b1 @values=["cfauth/sshd_config.epp"], @size_type=#<Puppet::Pops::Types::PIntegerType:0x46eb0f44 @to=22, @from=22>>>, #<Puppet::Pops::Types::PStructElement:0x72375dbb @key_type=#<Puppet::Pops::Types::PStringType:0x10eada92 @values=["sshd_ports"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PTupleType:0x7ae28333 @size_type=nil, @types=[#<Puppet::Pops::Types::PIntegerType:0x6dc30cb2 @to=22, @from=22>, #<Puppet::Pops::Types::PIntegerType:0x2076b26a @to=22, @from=22>, #<Puppet::Pops::Types::PIntegerType:0x50bb5dcc @to=24, @from=24>]>>, #<Puppet::Pops::Types::PStructElement:0x3d0b257c @key_type=#<Puppet::Pops::Types::PStringType:0x26ca0f33 @values=["sudo_env_keep"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PArrayType:0x2784d73d @element_type=Unit, @size_type=#<Puppet::Pops::Types::PIntegerType:0x24efa10 @to=0, @from=0>>>, #<Puppet::Pops::Types::PStructElement:0x35660a97 @key_type=#<Puppet::Pops::Types::PStringType:0x3e415ae4 @values=["sudo_no_password_all"], @size_type=nil>, @value_type=Boolean>, #<Puppet::Pops::Types::PStructElement:0x2ce695ef @key_type=#<Puppet::Pops::Types::PStringType:0x567d94f0 @values=["sudo_no_password_commands"], @size_type=nil>, @value_type=#<Puppet::Pops::Types::PArrayType:0x2784d73d @element_type=Unit, @size_type=#<Puppet::Pops::Types::PIntegerType:0x24efa10 @to=0, @from=0>>>]>>]>]\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6070', 'https://github.com/puppetlabs/puppet/pull/4798', '2016-03-17T17:08:52.000-0700', '2019-04-04T22:29:00.000-0700', '2019-04-04T22:29:00.000-0700', 'Closed', 'burnside-ss', 12, '0', 1, 14, 16, 2, 'cad0a162c177b722b6872f16ea4512bce4f39f02'),
('puppet', 295805, 0, 0, 'node.rb ruby error: class or module required for rescue clause', 'Hi,\r\n\r\nI am running Puppet 5 with Foreman and I the following ruby error when I want to run the ENC node.rb occurs:\r\n{code:shell}[root@foreman /]# /etc/puppetlabs/puppet/node.rb randy-camren.domain.tld\r\nclass or module required for rescue clause{code}\r\nTherefore my Puppet provisioning with foreman does not work.\r\n\r\nI have already searched the web, but didn''t anything useful in Puppet context.\r\n\r\nCan you help me what the problem is?\r\n\r\nThe Foreman configuration for Puppet via the Foreman GUI should be correctly set up.\r\n\r\nThanks in advance.\r\n\r\nBest regards,\r\n Ronny', 'https://tickets.puppetlabs.com/browse/PUP-9493', 'https://github.com/puppetlabs/puppet/commit/17c25c6011d8e22de9f36d1b8cefaf0badaeb35a', '2019-02-11T11:40:18.000-0800', '2019-04-04T22:29:01.000-0700', '2019-04-04T22:29:01.000-0700', 'Closed', 'Puppet;foreman;ruby', 1, '0', 0, 0, 0, 0, '17c25c6011d8e22de9f36d1b8cefaf0badaeb35a'),
('puppet', 31300, 14554401, 2522, 'The CRL can get corrupted if two workers revoke certs at same time', 'The CRL file (and many other SSL related files) are missing locking, so concurrent access can lead to corruptions.\r\n\r\n*In Scope*\r\n* -Confirm that PE in the Cloud etc will be leveraging puppet cert command line tools (as opposed to modifying CRL directly or revoking certs via server http api)- confirmed\r\n* Investigate filesystem-based locking of CRL file in ruby puppet on update\r\n* Limited to updates to CRL via the puppet cert CLI\r\n\r\n*Out of Scope*\r\n* Changes to puppet server CRL handling / API  - PUP-7991', 'https://tickets.puppetlabs.com/browse/PUP-2189', 'https://github.com/puppetlabs/puppet/pull/2522', '2014-04-09T07:33:49.000-0700', '2019-04-04T22:29:03.000-0700', '2019-04-04T22:29:03.000-0700', 'Closed', 'AWS1', 14, '0', 1, 2, 2, 1, ''),
('puppet', 133119, 71030747, 4984, 'Hiera Data in Module give bad results when environment_timeout is unlimited', '1) Set environment_timeout to unlimited  (this does not occur if set to 0)\r\n2) Setup hiera data in a module that use a FACT to determine what it should do.\r\n3) Set the fact differently on two or more clients\r\n4) Run puppet from each of the clients at the same time\r\n\r\nAfter a few puppet runs they will stop getting the correct hiera data in module values from the PuppetServer.\r\n\r\neg.  server1 could see the server2 value   or server2 could see the server1 value.\r\n\r\nSAMPLE module:\r\n{code:java}\r\n./test_module\r\n./test_module/hieradata\r\n./test_module/hieradata/common.yaml\r\n./test_module/hieradata/server1.yaml\r\n./test_module/hieradata/server2.yaml\r\n./test_module/manifests\r\n./test_module/manifests/init.pp\r\n./test_module/metadata.json\r\n./test_module/hiera.yaml\r\n{code}\r\n\r\n*init.pp*\r\n{code:java}\r\nclass test_module (\r\n  $my_var = ''not from hiera'',\r\n){\r\n  notify{"The variable is $my_var":}\r\n}\r\n{code}\r\n\r\nhiera.yaml\r\n\r\n{code:java}\r\n---\r\nversion: 4\r\ndatadir: hieradata\r\nhierarchy:\r\n  - name: "%{my_fact}"\r\n    backend: yaml\r\n\r\n  - name: "common"\r\n    backend: yaml\r\n{code}\r\n\r\n./test_module/hieradata/common.yaml\r\n{code:java}\r\n---\r\ntest_module::my_var: ''In common.yaml''\r\n{code}\r\n\r\n./test_module/hieradata/server1.yaml\r\n{code:java}\r\n---\r\ntest_module::my_var: ''server1''\r\n{code}\r\n\r\n\r\n./test_module/hieradata/server2.yaml\r\n{code:java}\r\n---\r\ntest_module::my_var: ''server2''\r\n{code}\r\n\r\nSERVER1\r\n/etc/puppetlabs/facter/facts.d/my_fact.txt \r\nmy_fact=server1\r\n\r\nSERVER2\r\n/etc/puppetlabs/facter/facts.d/my_fact.txt \r\nmy_fact=server2\r\n\r\nError seen in Puppetserver logs\r\n{code:java}\r\n[puppetserver] Puppet Caching node for server1.mydomain\r\n[puppetserver] Puppet Class ''settings'' is already defined; cannot redefine at :\r\n[puppetserver] Puppet Compiled catalog for server1.mydomain in environment production in 0.04 seconds\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6339', 'https://github.com/puppetlabs/puppet/pull/4984', '2016-05-21T18:28:30.000-0700', '2019-04-04T22:29:04.000-0700', '2019-04-04T22:29:04.000-0700', 'Closed', '', 29, '0', 1, 49, 17, 7, '0b2de4024bd5c5c2b1279a341d84fcb313b04a0b'),
('puppet', 152415, 88744239, 5324, 'referencing non-existant variable in custom function crashes puppetserver', 'h2. Overview\r\nUsing a function that references an undefined variable (ie by typo) in a function crashes puppetserver with an out of memory error\r\n\r\nh2. Expected result\r\nPuppet should warn the user if an undefined variable is encountered.  Ideally in the output of {{puppet agent -t}} \r\n\r\nh2. Actual result\r\nPuppet runs take a long time and then fail with one of the following messages:\r\n{noformat}\r\nError: Could not retrieve catalog from remote server: end of file reached\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\nError: Could not send report: Connection refused - connect(2) for "puppet.demo.internal" port 8140\r\n{noformat}\r\n\r\n_or_\r\n\r\n{noformat}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: <html>\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1"/>\r\n<title>Error 500 </title>\r\n</head>\r\n<body>\r\n<h2>HTTP ERROR: 500</h2>\r\n<p>Problem accessing /puppet/v3/catalog/pe-puppet.localdomain. Reason:\r\n<pre>    Java heap space</pre></p>\r\n<hr /><i><small>Powered by Jetty://</small></i>\r\n</body>\r\n</html>\r\n\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{noformat}\r\n\r\n_Also, please see attached puppetserver.log_\r\n\r\nh2. Steps to reproduce\r\nh3.  Testcase module\r\n+/etc/puppetlabs/code/environments/production/modules/testcase/lib/puppet/functions/testfunc.rb+\r\n{noformat}\r\nPuppet::Functions.create_function(:testfunc) do\r\n  def testfunc\r\n    nothere\r\n  end\r\nend\r\n{noformat}\r\n\r\nh3. Reference the function\r\n+/etc/puppetlabs/code/environments/production/manifests/site.pp+\r\n{noformat}\r\n$uhoh=testfunc()\r\n{noformat}\r\n\r\nh3.  Run puppet\r\n{noformat}\r\npuppet agent -t\r\n{noformat}\r\n\r\nh2. Workaround\r\nMake sure you don''t reference any undeclared variables(!)\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6807', 'https://github.com/puppetlabs/puppet/pull/5324', '2016-09-19T04:57:12.000-0700', '2019-04-04T22:29:06.000-0700', '2019-04-04T22:29:06.000-0700', 'Closed', 'maintenance', 14, '0', 1, 29, 0, 2, '1af9e1eb2936e74d2a93ce145dbabff002fb6e8f'),
('puppet', 126042, 72952951, 5010, 'Don''t include IP address in returned error messages', 'This is set in https://github.com/puppetlabs/puppet/blob/master/lib/puppet/network/rights.rb#L56-L58\r\n\r\nReturning the requestor IP address could include the internal IP address for a proxy server.\r\n\r\nThis information can be logged server-side but should not be returned to clients.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6150', 'https://github.com/puppetlabs/puppet/pull/5010', '2016-04-11T11:56:13.000-0700', '2019-04-04T22:29:09.000-0700', '2019-04-04T22:29:09.000-0700', 'Closed', '', 3, '0', 1, 2, 12, 2, '1a62c6636adac8225ad177b077695f9d65d3f0d0'),
('puppet', 116706, 59376525, 4672, 'Empty hiera data in modules causes whole lookup to fail', 'Situation:\r\n1. Module has "data_provider: ''hiera''" in metadata.json\r\n2. Module has simple hiera.yaml version 4 pointing to ''data/common.yaml''\r\n2. Module''s data/common.yaml is empty with only three dashes:\r\n{code:yaml}\r\n---\r\n\r\n{code}\r\n4. "puppet lookup" or "puppet agent -t" leads to error below.\r\n5. The error is easily fixed by changing common.yaml content to:\r\n{code:yaml}\r\n---\r\n{}\r\n{code}\r\n\r\n{code}\r\nrror: Could not retrieve catalog from remote server: Error 400 on SERVER: Evaluation Error: Error while evaluating a Function Call, undefined method `[]'' for nil:NilClass at /etc/puppetlabs/code/environments/production/modules/cffirehol/manifests/init.pp:12:5 on node ...\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:207:in `is_http_200?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:105:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:299:in `block in retrieve_new_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:292:in `block in thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:291:in `thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:298:in `retrieve_new_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:59:in `retrieve_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:104:in `prepare_and_retrieve_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:206:in `run_internal''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:134:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:240:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:133:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:45:in `block (4 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:21:in `lock''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:45:in `block (3 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:98:in `with_client''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:42:in `block (2 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:65:in `run_in_fork''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:41:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:39:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:353:in `onetime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:331:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:446:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:128:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5899', 'https://github.com/puppetlabs/puppet/pull/4672', '2016-02-14T16:04:09.000-0800', '2019-04-04T22:29:12.000-0700', '2019-04-04T22:29:12.000-0700', 'Closed', '', 4, '0', 1, 48, 0, 10, 'c5a3b515154df575c98af0493e1492bdfd6d8b41'),
('puppet', 93418, 42445757, 4157, 'RedHat puppetmaster service status report is invalid when it''s stopped and client is running', 'I initially ran into this issue on Amazon Linux.\r\n\r\nWhen {{puppetmaster}} service is stopped and {{puppet}} service is running, {{service puppetserver status}} returns false info, "puppet dead but subsys locked" to be exact.\r\n\r\n{code}\r\n[vagrant@localhost ~]$ cat /etc/issue\r\nCentOS release 6.5 (Final)\r\nKernel \r on an \m\r\n\r\n[vagrant@localhost ~]$ sudo service puppetmaster status\r\npuppet is stopped\r\n[vagrant@localhost ~]$ sudo service puppet status\r\npuppet is stopped\r\n[vagrant@localhost ~]$ sudo service puppet start\r\nStarting puppet agent:                                     [  OK  ]\r\n[vagrant@localhost ~]$ sudo service puppetmaster status\r\npuppet dead but subsys locked\r\n{code}\r\n\r\nWhat I expected was "puppet is stopped".', 'https://tickets.puppetlabs.com/browse/PUP-5037', 'https://github.com/puppetlabs/puppet/pull/4157', '2015-08-14T04:10:46.000-0700', '2019-04-04T22:29:13.000-0700', '2019-04-04T22:29:13.000-0700', 'Closed', '', 2, '0', 1, 1, 1, 1, 'cdce15e6902064a3e30c404cdd26792842529a68'),
('puppet', 265513, 202635222, 6932, 'Puppetserver fails to compile catalog when disable_i18n = true', '*Puppet Version: 5.5.3*\r\n*Puppet Server Version: 5.3.3, 5.3.4*\r\n*OS Name/Version: Ubuntu 16.04.4 LTS (Xenial Xerus)*\r\n\r\nIt seems that there is a regression in https://github.com/puppetlabs/puppet/commit/52ddd9cc1943b796b58665589dd38ecce1541ae1, as with *disable_i18n = true* in main section in *puppet.conf*, catalog fails to compile with following error:\r\n- on agent side:\r\n{noformat}\r\nError: Could not retrieve catalog from remote server: Find /puppet/v3/catalog/<fqdn>?environment=production&facts_format=application%2Fjson&... resulted in 404 with the message: {"message":"Not Found: Could not find catalog <fqdn>","issue_kind":"RESOURCE_NOT_FOUND"}\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{noformat}\r\n\r\n- on server side:\r\n{noformat}\r\n2018-07-19 06:31:07,746 INFO  [qtp2083050975-76] [puppetserver] Puppet Not Found: Could not find catalog <fqdn>\r\n{noformat}\r\n\r\n\r\n*Desired Behavior:*\r\nCatalog should compile and be served to agent.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9010', 'https://github.com/puppetlabs/puppet/pull/6932', '2018-07-19T00:14:44.000-0700', '2019-04-04T22:29:15.000-0700', '2019-04-04T22:29:15.000-0700', 'Closed', 'docs_reviewed', 7, '0', 1, 38, 19, 3, '6cbbeee59d985a51e174592c9044d6ba5d7d7845'),
('puppet', 35666, 15967255, 2661, 'Interpolated variables with leading underscore regression', '\r\n{code}\r\nroot@puppetmaster:~# cat test.pp \r\n$_foo = "1"\r\nnotify { "${_foo}": }\r\n\r\n# With current parser\r\n\r\nroot@puppetmaster:~# puppet apply --parser=current test.pp \r\nWarning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations\r\n   (at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1071:in `each'')\r\nNotice: Compiled catalog for puppetmaster.local in environment production in 0.04 seconds\r\nNotice: 1\r\nNotice: /Stage[main]/Main/Notify[1]/message: defined ''message'' as ''1''\r\nNotice: Finished catalog run in 0.04 seconds\r\n\r\n# With future parser\r\n\r\nroot@puppetmaster:~# puppet apply --parser=future test.pp \r\nWarning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations\r\n   (at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1071:in `each'')\r\nError: Could not parse for environment production: Syntax error at ''_'' at /root/test.pp:5:13 on node puppetmaster.local\r\nError: Could not parse for environment production: Syntax error at ''_'' at /root/test.pp:5:13 on node puppetmaster.local\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2581', 'https://github.com/puppetlabs/puppet/pull/2661', '2014-05-15T12:08:48.000-0700', '2019-04-04T22:29:55.000-0700', '2019-04-04T22:29:55.000-0700', 'Closed', '', 7, '0', 1, 1136, 1090, 6, 'c1d9cce436d6b9512d5580e641bdb275bf34440c'),
('puppet', 34765, 0, 0, 'Settings catalog should create the default environment if environmentpath set.', 'Ensure that settings catalog creates the default  production environment if an environmentpath has been set.  This will help ensure that once PUP-2252 is done, we don''t fail in new installations where no production environment directory has been created yet.\r\n\r\nIf environmentpath is set, we should manage "$environmentpath.first/$environment.default".\r\n\r\nWe are not managing the directory if environment was explicitly set.', 'https://tickets.puppetlabs.com/browse/PUP-2519', 'https://github.com/puppetlabs/puppet/commit/766545d6763047fd0241a248650ec16d9805b980', '2014-05-08T12:24:39.000-0700', '2019-04-04T22:29:55.000-0700', '2019-04-04T22:29:55.000-0700', 'Closed', '', 11, '0', 0, 0, 0, 0, '766545d6763047fd0241a248650ec16d9805b980'),
('puppet', 31542, 14935026, 2554, 'The environmentpath setting is ignored by puppet faces unless set in [main]', '[~nick.fagerlund] noticed:\r\n\r\n1) with environmentpath set in [main], \r\n\r\n{code}\r\npuppet config print manifest modulepath --environment doesnotexist\r\nmanifest = no_manifest\r\nmodulepath =\r\n{code}\r\n\r\nis picking up the default configured environment I believe.\r\n\r\n2) with environmentpath set in [master]\r\n\r\n{code}\r\npuppet config print manifest modulepath --environment doesnotexist\r\nmanifest = /etc/puppet/manifests/site.pp\r\nmodulepath = /etc/puppet/modules:/usr/share/puppet/modules\r\n{code}\r\n\r\nenvironmentpath seems to be ignored and you get the default settings.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2213', 'https://github.com/puppetlabs/puppet/pull/2554', '2014-04-10T17:48:56.000-0700', '2019-04-04T22:29:56.000-0700', '2019-04-04T22:29:56.000-0700', 'Closed', '', 11, '0', 1, 206, 19, 6, '016f5f0b67c43970c9cf9601b029a3399999badb'),
('puppet', 51126, 22664558, 3187, 'ENC returned environment ignored when using directory environments', 'Where a puppet agent is configured to use the default environment (production) and one relies on an ENC to assign the environment correctly (puppet 3.x where the ENC should win), when using directory environments to match an environment that doesn''t exist, the default configured environment wins and the node is given a catalog from ''production'' rather than failing (which is the behaviour I think I am expecting).\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3244', 'https://github.com/puppetlabs/puppet/pull/3187', '2014-09-15T08:04:39.000-0700', '2019-04-04T22:29:57.000-0700', '2019-04-04T22:29:57.000-0700', 'Closed', '', 19, '0', 2, 45, 22, 2, '8b5ffc854f1f47bbbe073847de5579de4dfc5532'),
('puppet', 11594, 0, 0, 'Provide validated node name and clientcert/certname variables', 'Currently, the only piece of node identity available to the compiler is the special $clientcert variable, which is untrustworthy and is inserted into the facts by the agent node. \n\nThe puppet master has access to both the real certname (the name in the certificate''s Subject CN) and the node name (the name of the catalog being requested, as expressed in the key in the HTTP /catalog/name call, the indirector, etc.) -- it should publish these to the compiler as trusted variables, so they can be used in manifests.', 'https://tickets.puppetlabs.com/browse/PUP-122', 'https://github.com/puppetlabs/puppet/commit/c54a95d74162a5fa4b756b6fc8479eaab5ff0318', '2013-07-01T18:01:01.000-0700', '2019-04-04T22:29:58.000-0700', '2019-04-04T22:29:58.000-0700', 'Closed', '', 10, '0', 0, 0, 0, 0, 'c54a95d74162a5fa4b756b6fc8479eaab5ff0318'),
('puppet', 32141, 15207567, 2588, 'Lambda with default valued parameter cannot be overridden', 'If a default value is given for a lambdas parameter it will not be overridden by a given value.\n\nThe logic in evaluator_impl L 209-217\n{code}\n      given_argument = m[1]\n      argument_name = m[0].name\n      default_expression = m[0].value\n\n      value = if default_expression\n        evaluate(default_expression, scope)\n      else\n        given_argument\n      end\n{code}\n\nis where it goes wrong.\n\nIt should check if a value was given, and if that value is nil or undef, or no value given before using the default expression. m.size == 2 indicates that value was given.\n\nThe impact of this is minimal since all current functions that use lambdas would typically not use default values. Once lambdas spread beyond the current handful of function this will naturally bite people badly.\n\nSuggest fixing this for 3.6.', 'https://tickets.puppetlabs.com/browse/PUP-2287', 'https://github.com/puppetlabs/puppet/pull/2588', '2014-04-16T19:12:10.000-0700', '2019-04-04T22:30:00.000-0700', '2019-04-04T22:30:00.000-0700', 'Closed', 'docs_reviewed', 5, '0', 3, 67, 9, 4, 'c8b9962a848c651a148fd55fea0bf6481defc401'),
('puppet', 10949, 916746043, 8905, '(6112) Puppet cert generate clashes with autosigning', 'When using `puppet cert generate`, Puppet first [generates a certificate request](https://github.com/puppetlabs/puppet/blob/3.1.1/lib/puppet/ssl/certificate_authority.rb#L139) and then [signs it](https://github.com/puppetlabs/puppet/blob/3.1.1/lib/puppet/ssl/certificate_authority.rb#L140). During the generation step, the save method of the CertificateRequest class is called which [triggers autosigning](https://github.com/puppetlabs/puppet/blob/3.1.1/lib/puppet/ssl/certificate_request.rb#L12-L19).\n\nTo summarize:\n\n  * Certificate generation should take auto signing into account.\n\n  * It appears autosigning doesn''t consult the dns_alt_names parameter.\n\n  * We should probably log an info or debug message whenever a cert is autosigned so this behavior is easier to detect in the future.\n\n_NOTE: the code `host = Puppet::SSL::Host.new(name)` also appears twice in the generate method of ssl/certificate\_authority.rb. Hopefully this is an accidental duplicate._\n\n[6112]: https://projects.puppetlabs.com/issues/6112', 'https://tickets.puppetlabs.com/browse/PUP-11', 'https://github.com/puppetlabs/puppet/pull/8905', '2013-06-17T17:19:14.000-0700', '2019-04-04T22:30:00.000-0700', '2019-04-04T22:30:00.000-0700', 'Resolved', 'redmine', 2, '0', 2, 199, 8, 3, 'c35ae4ffa447c4370fb4620e7a10f2c322cc6593'),
('puppet', 28832, 14418783, 2505, 'realizing an empty array of resources fails in future evaluator', 'The following code runs fine without deprecation warning in old evaluator but fails in 3.5-rc1:\r\n\r\n{code}\r\nrealize(File[[]])\r\n{code}\r\n\r\n{noformat}\r\nError: Evaluation Error: File[] accepts 1 argument. Got 0 on node test.dalen.cloud.spotify.net\r\nError: Evaluation Error: File[] accepts 1 argument. Got 0 on node test.dalen.cloud.spotify.net\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-1960', 'https://github.com/puppetlabs/puppet/pull/2505', '2014-03-17T07:03:51.000-0700', '2019-04-04T22:30:01.000-0700', '2019-04-04T22:30:01.000-0700', 'Closed', '', 17, '0', 2, 94, 19, 5, 'a196833c26f10c15fc3cdcb7a3073272992260f7'),
('puppet', 52965, 22047446, 3142, 'consider not doing deep undef to empty string map in 3x function API', 'With the future parser in 3.7, all arguments to 3x functions are deeply mapped to translate undef to empty strings. This is different than how the 3x runtime does this, where only the surface undefs are mapped (not if they are in arrays or hashes).\r\n\r\nThis causes problems in existing functions such as {{ensure_resource}}.\r\n\r\nWhile we should move functions to the new function API (for other reasons), we cannot do this for all functions out in the wild. We should therefore consider not doing deep mapping of undef to empty string to preserve the semantics of the 3x function API (even if it is sad).', 'https://tickets.puppetlabs.com/browse/PUP-3365', 'https://github.com/puppetlabs/puppet/pull/3142', '2014-09-29T16:43:08.000-0700', '2019-04-04T22:30:03.000-0700', '2019-04-04T22:30:03.000-0700', 'Closed', '', 4, '0', 1, 53, 2, 2, 'd0a5668e6cdc2e9280039ededec8f588cd98c8e6'),
('puppet', 11377, 669964150, 8634, '(PR puppet/1710) (#21252) Fix problems with false/nil args and returns in lambda', '\n * Author: **Henrik Lindberg** <>\n * Company: Cloudsmith Inc.\n * Github ID: [hlindberg](https://github.com/hlindberg)\n * [Pull Request 1710 Discussion](https://github.com/puppetlabs/puppet/pull/1710)\n * [File Diff](https://github.com/puppetlabs/puppet/pull/1710/files)\n\nPull Request\n====\nThe issue 21252 was triggered by a documentation error but should\nhave produced a different result than the error that was presented.\n\nThis was caused by a series of problems. It was not possible to\npass `false` as a parameter value as this was taken as missing parameter\nvalue.\n\nAlso, it was not possible to return the value `false` as this was\ntranslated to `nil` due to defective work around for missing initialized\nvariable on return.\n\nThe fix changes the handling of making sure that the variable that is\nreturned exists (by setting value explicelty to `nil` before the start\nof the exception handling block.\n\nThis commit also modifies how a lambda call matches arguments to\nparameters and checks what is missing (now with `false` as a valid value\nin mind).\n\nA test is added to `collect` that checks that a value of `false` can\nboth be passed and returned.', 'https://tickets.puppetlabs.com/browse/PUP-93', 'https://github.com/puppetlabs/puppet/pull/8634', '2013-06-24T23:29:40.000-0700', '2019-04-04T22:30:04.000-0700', '2019-04-04T22:30:04.000-0700', 'Closed', 'future-parser', 1, '0', 1, 13, 0, 2, 'bca628dc1cf651e5af2f4770231cfd812dedba22'),
('puppet', 48489, 24854758, 3327, 'heredoc should trim left margin before joining lines', 'This:\r\n{code}\r\nnotice  @(END/L)     \r\n      I am a very long line of text that is difficult to work\\r\n      with. The escaped end of line joins the long line into one.\r\n     | - END\r\n{code}\r\nshould produce output without 6 spaces between the words {{work}} and\r\n{{with}}.', 'https://tickets.puppetlabs.com/browse/PUP-3091', 'https://github.com/puppetlabs/puppet/pull/3327', '2014-08-19T15:52:10.000-0700', '2019-04-04T22:30:05.000-0700', '2019-04-04T22:30:05.000-0700', 'Closed', 'future', 11, '0', 1, 30, 0, 1, '5e1aeab4379942bbba701cb5a5478ef3442eb691'),
('puppet', 52963, 22177499, 3154, 'future parser give weird error in trailing comma after assignment', 'If an assignment is made with a trailing comma, and there is an expression following the comma, the result is surprisingly a literal array followed by an expression. This in turn leads to an error of "This Array Expression" is not productive.\r\n\r\n{code}\r\n$a = "hello",\r\nnotice $a\r\n{code}\r\n\r\nMarked as major as this means that there are conditions where the problem will not be caught (when the array constructed in error is last in a block).', 'https://tickets.puppetlabs.com/browse/PUP-3363', 'https://github.com/puppetlabs/puppet/pull/3154', '2014-09-29T16:29:31.000-0700', '2019-04-04T22:30:05.000-0700', '2019-04-04T22:30:05.000-0700', 'Closed', '', 3, '0', 1, 57, 9, 5, 'a0fbc519192c3e0d48e72d2545f901943c8edbe5'),
('puppet', 47693, 19868467, 2981, 'Class inheritance behaving incorrectly in the future parser', '[~dalen] commented on PUP-121 with a problem that he uncovered. It looks like class inheritance is encountering problems in the future parser.\r\n\r\n{quote}\r\nWhen I''m testing master atm with future parser:\r\n{noformat}\r\nclass bar { notice("This is class $name") }\r\nclass foo::bar { notice("This is class $name") }\r\nclass foo inherits bar { notice("This is class $name") }\r\n\r\ninclude foo\r\n\r\n$ puppet apply --parser=future test.pp\r\nNotice: Scope(Class[Foo::Bar]): This is class foo::bar\r\nNotice: Scope(Class[Foo]): This is class foo\r\nError: Could not find class foo on node valentina.local\r\nError: Could not find class foo on node valentina.local\r\n{noformat}\r\nSo, you get both two of the three classes and then it complains it couldn''t find a third class (that it already included) \r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-3054', 'https://github.com/puppetlabs/puppet/pull/2981', '2014-08-13T11:42:51.000-0700', '2019-04-04T22:30:05.000-0700', '2019-04-04T22:30:05.000-0700', 'Closed', '', 3, '0', 6, 238, 165, 14, '74fccad8b2ec84cadff453732f380ca6ee158631'),
('puppet', 17328, 204945415, 6956, ':rvalue functions require argument handling', 'What I mean by this is that the function has to handle the args parameter, even it doesn''t do anything with it. This is not true for :statement functions.\r\n\r\nThis function blows up\r\n\r\n{code}\r\n# mastername.rb\r\nrequire ''socket''\r\n\r\nPuppet::Parser::Functions.newfunction(:mastername, :type => :rvalue ) do\r\n  Socket.gethostname.chomp\r\nend\r\n{code}\r\n\r\nOutput:\r\n\r\n{code}\r\n[root@classroom test]# puppet apply -e ''notice(mastername())''\r\nError: wrong number of arguments (1 for 0) at line 1 on node classroom.puppetlabs.vm\r\nWrapped exception:\r\nwrong number of arguments (1 for 0)\r\nError: wrong number of arguments (1 for 0) at line 1 on node classroom.puppetlabs.vm\r\n{code}\r\n\r\nWhile this one works:\r\n\r\n{code}\r\n# mastername.rb\r\nrequire ''socket''\r\n\r\nPuppet::Parser::Functions.newfunction(:mastername, :type => :rvalue ) do |args|\r\n  Socket.gethostname.chomp\r\nend\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-592', 'https://github.com/puppetlabs/puppet/pull/6956', '2013-10-28T14:46:47.000-0700', '2019-04-04T22:30:07.000-0700', '2019-04-04T22:30:07.000-0700', 'Closed', '', 4, '0', 1, 39, 5, 4, 'c94c83c53890ea0cd6d4349d20614560116c3db0'),
('puppet', 56764, 0, 0, 'Puppet does not plugin sync with the proper environment after agent attempts to resolve environment', 'In the event where the agent is requesting a catalog from the master and the agent is in the wrong environment the master we grab new facts on the requesting node and send the new facts over however when the master attempts to do a plugin sync the files from the old environment are sent instead of the new environment.\r\n\r\nThis would never make sense as an enc but we are using it to force\r\nthe behavior to happen.\r\nOn the first run the agent on the node will request a catalog for the "production" environment but the enc will respond saying that the node should be in the "test" environment causing the node to attempt to resolve the environment.\r\n{panel:title=enc}\r\n{noformat}\r\n#!/bin/bash\r\nif [ -e ''./enc.lock'' ]; then\r\ncat << ENC\r\nenvironment: production\r\nENC\r\nelse\r\ncat << ENC\r\nenvironment: test\r\nENC\r\ntouch ./enc.lock > /dev/null\r\nfi\r\n{noformat}\r\n{panel}\r\n\r\nSetup two environments\r\n\r\n{panel:title=environments}\r\n{noformat}\r\n$ tree ~/test/environments\r\n/Users/britt/test/environments\r\n├── production\r\n│   └── modules\r\n│       └── test\r\n│           ├── lib\r\n│           │   └── puppet\r\n│           │       └── production_env.rb\r\n│           └── manifests\r\n│               └── site.pp\r\n└── test\r\n    └── modules\r\n        └── test\r\n            ├── lib\r\n            │   └── puppet\r\n            │       └── test_env.rb\r\n            └── manifests\r\n                └── site.pp\r\n\r\n12 directories, 4 files\r\n{noformat}\r\n{panel}\r\n\r\nStart a master with the specified enc and environment path\r\n{noformat}\r\n$ ./util/dev-puppet-master test --node_terminus=exec --external_nodes=~/projects/ruby/pe-puppet/enc --environmentpath=~/test/environments\r\n{noformat}\r\n\r\nRun puppet agent\r\n{noformat}\r\n$ be puppet agent -t --server=puppetmaster\r\nWarning: Local environment: "production" doesn''t match server specified node environment "test", switching agent to "test".\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nNotice: /File[/Users/britt/.puppet/var/lib/puppet/test_env.rb]/ensure: defined content as ''{md5}d41d8cd98f00b204e9800998ecf8427e''\r\nInfo: Caching catalog for brittmac.delivery.puppetlabs.net\r\nWarning: Local environment: "test" doesn''t match server specified environment "production", restarting agent run with environment "production"\r\nInfo: Caching catalog for brittmac.delivery.puppetlabs.net\r\nInfo: Applying configuration version ''1414690262''\r\nInfo: Creating state file /Users/britt/.puppet/var/state/state.yaml\r\nNotice: Finished catalog run in 0.01 seconds\r\n{noformat}\r\n\r\nYou can see that instead of the production_env.rb being in the var directory instead the test_env.rb file was synced before the environment was resolved.', 'https://tickets.puppetlabs.com/browse/PUP-3591', 'https://github.com/puppetlabs/puppet/commit/b8573ea6d2fcb39288b9fb9040e5f348bb92905f', '2014-10-30T10:33:57.000-0700', '2019-04-04T22:30:08.000-0700', '2019-04-04T22:30:08.000-0700', 'Closed', '', 10, '0', 0, 0, 0, 0, 'b8573ea6d2fcb39288b9fb9040e5f348bb92905f'),
('puppet', 14862, 24582676, 3319, 'Merge redmine 22593 - } interpolation', 'The redmine issue #22593 makes it difficult to do more advanced interpolation in data.\n(The bug is about lexer doing the wrong thing with right brace and keywords).\n\nOnly affects future parser.', 'https://tickets.puppetlabs.com/browse/PUP-352', 'https://github.com/puppetlabs/puppet/pull/3319', '2013-09-18T10:01:49.000-0700', '2019-04-04T22:30:10.000-0700', '2019-04-04T22:30:10.000-0700', 'Closed', '', 4, '0', 1, 30, 2, 11, 'eccd3b427e9463277c890966978ea5bdcd7eacba'),
('puppet', 29372, 13838919, 2459, 'TupleType applies size constraint to last element only', 'The TupleType allows a size constraint to be made. This was implemented as constraining the last type in the tuple (with the idea that this would be the most common use-case). In practice however, it is far more valuable to let the size constraint apply to the given types as this gives the opportunity to make types in the tuple optional (i.e. not present as opposed to being undef).\r\n\r\nProposed change will make these three matches true:\r\n\r\n{code}\r\n$t = Tuple[Integer, Integer, String, 1,3]\r\n[1, 2, hello]  =~ $t\r\n[1, 2]         =~ $t\r\n[1]            =~ $t\r\n{code}\r\n\r\nThis is currently not possible to express since the size only applies to the last entry (the String in the example above).\r\n\r\nThis is important to get into 3.5.0 since it changes the semantics of the Tuple type.', 'https://tickets.puppetlabs.com/browse/PUP-2017', 'https://github.com/puppetlabs/puppet/pull/2459', '2014-03-21T07:37:23.000-0700', '2019-04-04T22:30:11.000-0700', '2019-04-04T22:30:11.000-0700', 'Closed', '', 1, '0', 1, 59, 47, 3, '9c8e51539e2fc25f7d2f1330c57f6c5f0403e872'),
('puppet', 37399, 16553152, 2714, 'Puppet master passenger processes keep growing', '[~jhoblitt] reported on IRC in #puppet-dev that after upgrading from 3.6.0 to 3.6.1 his master processes started growing to 1.5GB.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2692', 'https://github.com/puppetlabs/puppet/pull/2714', '2014-05-28T11:35:49.000-0700', '2019-04-04T22:30:13.000-0700', '2019-04-04T22:30:13.000-0700', 'Closed', '', 27, '0', 2, 65, 17, 4, '6201482da5b2a9fd48455a79fe3b693723a1b25a'),
('puppet', 35460, 15958243, 2656, 'Cannot use class references with upper cased strings', 'The future parser accepts {{Class[Apache::Foo]}} as a reference but will reject {{Class[''Apache::Foo'']}} and {{$a = ''Apache::Foo''; Class[$a]}} (a string or an expression that results in a string.\r\n\r\nAll of these variations should continue to work.', 'https://tickets.puppetlabs.com/browse/PUP-2568', 'https://github.com/puppetlabs/puppet/pull/2656', '2014-05-14T09:20:45.000-0700', '2019-04-04T22:30:13.000-0700', '2019-04-04T22:30:13.000-0700', 'Closed', '', 4, '0', 3, 47, 35, 2, 'ab1ced75d22474b710c446e13fa4d79ed48ed32f'),
('puppet', 108193, 54155296, 4524, 'Missing API docs for /puppet/v3/environment endpoint', 'As part of the application management work, a new endpoint (/puppet/v3/environment) was added to the /puppet/v3 API without documentation. We need an API document (similar to existing ones) added to the puppet/api/doc directory, and a JSON schema for the endpoint''s responses added to the puppet/api/schemas directory.', 'https://tickets.puppetlabs.com/browse/PUP-5571', 'https://github.com/puppetlabs/puppet/pull/4524', '2015-12-02T18:13:15.000-0800', '2019-04-04T22:30:14.000-0700', '2019-04-04T22:30:14.000-0700', 'Closed', '', 10, '0', 2, 83, 6, 2, 'f7c348cd9c9b7a3476670d71c4642d175aa00f06'),
('puppet', 16291, 45709797, 4275, 'Validate collect expressions (future parser)', 'Future parsers 3x validator does not check its LHS operand which leads to error messages about internal types not being found as resource types.', 'https://tickets.puppetlabs.com/browse/PUP-527', 'https://github.com/puppetlabs/puppet/pull/4275', '2013-10-04T17:40:21.000-0700', '2019-04-04T22:30:15.000-0700', '2019-04-04T22:30:15.000-0700', 'Closed', '', 1, '0', 1, 2, 2, 1, '5641afdcea9c48c7855979187604d3be65ac38aa'),
('puppet', 33031, 15176023, 2583, 'Validation missing for meaningless sequences', 'There is currently no validation of the future parser''s result wrt. evaluation of meaningless sequences. If user enters:\r\n{code}\r\n1 2 3 hello goodbye\r\n{code}\r\nThe evaluator will just "do what it is told", and produce a 1, then a 2, etc.\r\nThe only place were a "side effect free" expression may appear is as the last expression in a sequence / block as this is the produced value of an expression.\r\n\r\nThe importance of this validation has increased since the future parser (since 3.6) handles calls without parentheses as reserved for a handful of built in "calls" (i.e. ''include'', ''require'', etc.). Thus, if users have code where calls without parentheses are used they are not informed about this issue - i.e. their code turned into a "side effect free sequence" that is just silently evaluated.', 'https://tickets.puppetlabs.com/browse/PUP-2357', 'https://github.com/puppetlabs/puppet/pull/2583', '2014-04-24T07:38:13.000-0700', '2019-04-04T22:30:15.000-0700', '2019-04-04T22:30:15.000-0700', 'Closed', '', 7, '0', 3, 228, 4, 5, 'a04e1fdd2277f701d5144db98eea541b9d32ddda'),
('puppet', 53894, 22753161, 3195, 'Type system does not handle Pattern correctly', 'The Pattern type has similar problems to the Enum type + it is not implemented correctly. \r\n\r\n{code}\r\nPattern < Pattern[/.*/]   # false\r\nPattern > Pattern[/.*/]    # false\r\nPattern == Pattern[/.*/]  # false\r\n{code}\r\n\r\nThat is not correct and neither complies with the spec, nor the the "law of least surprise"\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3401', 'https://github.com/puppetlabs/puppet/pull/3195', '2014-10-07T17:50:39.000-0700', '2019-04-04T22:30:17.000-0700', '2019-04-04T22:30:17.000-0700', 'Closed', '', 8, '0', 1, 35, 3, 2, '72d4edbe1a6d0b397228bfe43b81273306001693'),
('puppet', 35482, 16505578, 2704, '"puppet cert revoke <name>" doesn''t always revoke what you expect', 'When revoking a certificate by name and there is not certificate by that name present (for instance if the certificates were deleted) the "puppet cert" command falls back to the {{inventory.txt}} file to find the serial number. When it does this it ends up only revoking the first serial number recorded in the file. This leaves the most recent certificate (and possibly others) unrevoked.\r\n\r\n{code:title=Revoking the wrong certificate}\r\n> be puppet cert clean testing\r\nNotice: Revoked certificate with serial 2\r\nNotice: Removing file Puppet::SSL::Certificate testing at ''/Users/andy/.puppet/ssl/ca/signed/testing.pem''\r\nNotice: Removing file Puppet::SSL::Certificate testing at ''/Users/andy/.puppet/ssl/certs/testing.pem''\r\nNotice: Removing file Puppet::SSL::Key testing at ''/Users/andy/.puppet/ssl/private_keys/testing.pem''\r\n\r\n> be puppet cert generate testing\r\nNotice: testing has a waiting certificate request\r\nNotice: Signed certificate request for testing\r\nNotice: Removing file Puppet::SSL::CertificateRequest testing at ''/Users/andy/.puppet/ssl/ca/requests/testing.pem''\r\nNotice: Removing file Puppet::SSL::CertificateRequest testing at ''/Users/andy/.puppet/ssl/certificate_requests/testing.pem''\r\n\r\n> rm ~/.puppet/ssl/ca/signed/testing.pem\r\n> rm ~/.puppet/ssl/certs/testing.pem\r\n> rm ~/.puppet/ssl/private_keys/testing.pem\r\n\r\n> be puppet cert revoke testing\r\nNotice: Revoked certificate with serial 2\r\n{code}\r\n\r\nOn the last revoke it should have revoked serial 3 instead of serial 2.', 'https://tickets.puppetlabs.com/browse/PUP-2569', 'https://github.com/puppetlabs/puppet/pull/2704', '2014-05-14T11:06:55.000-0700', '2019-04-04T22:30:20.000-0700', '2019-04-04T22:30:20.000-0700', 'Closed', '', 8, '0', 1, 79, 9, 5, '22a62c5df25513185605a8a439b71bcb3c5ee8e5'),
('puppet', 27203, 13137439, 2407, 'puppet apply --modulepath not respected when /etc/puppet/environments/production exists', 'This appears to be a strange condition since the new directory environments work went in.  When /etc/puppet/environments/production exists, puppet apply stops obeying --modulepath and instead attempts to look up the module in /etc only.  For example:\r\n\r\n{noformat}\r\n# mkdir /etc/puppet/environments/production\r\n# puppet module install -i /tmp/test saz/ntp\r\nNotice: Preparing to install into /tmp/test ...\r\nNotice: Created target directory /tmp/test\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/tmp/test\r\n└── saz-ntp (v2.2.0)\r\n# puppet apply --modulepath /tmp/test -e ''include ntp'' --noop\r\nError: Could not find class ntp for foreman-el6.example.com on node foreman-el6.example.com\r\nError: Could not find class ntp for foreman-el6.example.com on node foreman-el6.example.com\r\n# cp -a /tmp/test/ntp /etc/puppet/environments/production/modules/\r\n# puppet apply --modulepath /tmp/test -e ''include ntp'' --noop\r\nWarning: Config file /etc/puppet/hiera.yaml not found, using Hiera defaults\r\nNotice: Compiled catalog for foreman-el6.example.com in environment production in 0.53 seconds\r\nNotice: /Stage[main]/Ntp/Package[ntp]/ensure: current_value absent, should be present (noop)\r\n^CExiting\r\n{noformat}\r\n\r\nBut if I remove that directory:\r\n\r\n{noformat}\r\n# rm -rf /etc/puppet/environments/production/\r\n# ll /etc/puppet/environments\r\ntotal 0\r\n# puppet apply --modulepath /tmp/test -e ''include ntp'' --noop\r\nWarning: Config file /etc/puppet/hiera.yaml not found, using Hiera defaults\r\nNotice: Compiled catalog for foreman-el6.example.com in environment production in 0.53 seconds\r\nNotice: /Stage[main]/Ntp/Package[ntp]/ensure: current_value absent, should be present (noop)\r\n^CExiting\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-1765', 'https://github.com/puppetlabs/puppet/pull/2407', '2014-02-25T05:41:47.000-0800', '2019-04-04T22:30:21.000-0700', '2019-04-04T22:30:21.000-0700', 'Closed', '', 4, '0', 1, 322, 13, 9, '9088d347dfa98625ca9f87b611ecadbeb2f6143f'),
('puppet', 41094, 18355928, 2868, 'epp does not handle empty template', 'When epp is told to evaluate an empty template, the result is a complaint that the end of input is reached. epp should produce an empty string in this situation and not complain.\r\n\r\nTo reproduce:\r\n{code}\r\nnotice inline_epp(@(END), {x => world})\r\n  <%-| $x| %>\r\n  |- END\r\n{code}\r\nThis template has a parameter, but no other content in the template.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2883', 'https://github.com/puppetlabs/puppet/pull/2868', '2014-07-02T13:43:24.000-0700', '2019-04-04T22:30:24.000-0700', '2019-04-04T22:30:24.000-0700', 'Closed', '', 3, '0', 1, 352, 321, 4, 'f25feac2f4ab4b2ffed55fa6da4b6045a2eaa6aa'),
('puppet', 19934, 215389644, 7085, 'An empty csr_attributes.yaml file fails with undefined method', '[~josh] found that an empty csr_attributes.yaml file raised:\r\n\r\nError: Could not request certificate: undefined method `delete'' for false:FalseClass\r\n\r\nwhen the agent tries to create a keypair.  He found this on a windows agent, but the problem is likely general.\r\n\r\n{noformat}\r\n0 ~/work/puppet (master)  $ rm -rf ~/.puppet\r\n0 ~/work/puppet (master)  $ mkdir ~/.puppet\r\n0 ~/work/puppet (master)  $ touch ~/.puppet/csr_attributes.yaml\r\n0 ~/work/puppet (master)  $ bundle exec puppet agent -td --server puppetmaster.solar.lan\r\n...\r\nInfo: Creating a new SSL key for arcturus.local\r\nInfo: Caching certificate for ca\r\nInfo: csr_attributes file loading from /Users/josh/.puppet/csr_attributes.yaml\r\nError: Could not request certificate: undefined method `delete'' for false:FalseClass\r\n{noformat}\r\n\r\nwhere the stacktrace is:\r\n\r\n{noformat}\r\nError: Could not request certificate: undefined method `delete'' for false:FalseClass\r\n/Users/josh/work/puppet/lib/puppet/ssl/certificate_request_attributes.rb:25:in `load''\r\n/Users/josh/work/puppet/lib/puppet/ssl/host.rb:178:in `generate_certificate_request''\r\n/Users/josh/work/puppet/lib/puppet/ssl/host.rb:229:in `generate''\r\n/Users/josh/work/puppet/lib/puppet/ssl/host.rb:36:in `localhost''\r\n/Users/josh/work/puppet/lib/puppet/ssl/validator/default_validator.rb:26:in `initialize''\r\n/Users/josh/work/puppet/lib/puppet/ssl/validator.rb:27:in `new''\r\n/Users/josh/work/puppet/lib/puppet/ssl/validator.rb:27:in `default_validator''\r\n/Users/josh/work/puppet/lib/puppet/network/http_pool.rb:27:in `http_instance''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:58:in `network''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:83:in `http_request''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:63:in `http_get''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:97:in `block in find''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:178:in `block in do_request''\r\n/Users/josh/work/puppet/lib/puppet/indirector/request.rb:261:in `do_request''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:178:in `do_request''\r\n/Users/josh/work/puppet/lib/puppet/indirector/rest.rb:91:in `find''\r\n/Users/josh/work/puppet/lib/puppet/indirector/certificate/rest.rb:12:in `find''\r\n/Users/josh/work/puppet/lib/puppet/indirector/indirection.rb:201:in `find''\r\n/Users/josh/work/puppet/lib/puppet/ssl/host.rb:202:in `certificate''\r\n/Users/josh/work/puppet/lib/puppet/ssl/host.rb:324:in `wait_for_cert''\r\n/Users/josh/work/puppet/lib/puppet/application/agent.rb:477:in `wait_for_certificates''\r\n/Users/josh/work/puppet/lib/puppet/application/agent.rb:318:in `run_command''\r\n{noformat}\r\n\r\nOnce in this state, you need to delete the csr_attributes.yaml file from the confdir\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-913', 'https://github.com/puppetlabs/puppet/pull/7085', '2013-12-02T16:11:47.000-0800', '2019-04-04T22:30:26.000-0700', '2019-04-04T22:30:26.000-0700', 'Closed', '', 3, '0', 1, 12, 2, 1, '02951a3d059a98f1d02ba6b11e834639549bb397'),
('puppet', 30672, 14477785, 2518, 'Evaluation Error: Error while evaluating a Virtual Query, undefined local variable or method `slurpfunc'' for #<Puppet::Pops::Parser::Lexer2:> ', 'Error: Could not retrieve catalog from remote server: Error 400 on SERVER: Evaluation Error: Error while evaluating a Virtual Query, undefined local variable or method `slurpfunc'' for #<Puppet::Pops::Parser::Lexer2:0x000000031a3cb0> at /etc/puppet/external/modules/python/manifests/config.pp:20:31 on node ....\r\n\r\nThe module where this is happening can be found at https://github.com/quizlet/puppet-python', 'https://tickets.puppetlabs.com/browse/PUP-2129', 'https://github.com/puppetlabs/puppet/pull/2518', '2014-03-31T17:07:32.000-0700', '2019-04-04T22:30:29.000-0700', '2019-04-04T22:30:29.000-0700', 'Closed', 'future-parser', 11, '0', 1, 34, 5, 3, '3e2098145d8f0b28bbaf1a37d1ea01d5d0df272f'),
('puppet', 50277, 21050153, 3075, 'Puppetmaster removes /etc/puppet/environments/production if it''s a link rather than a directory', 'We use puppet environments, and symlink the puppet folder of one of our git repos to /etc/puppet/environment.\r\n\r\nThis is how it looks like:\r\n#:/etc/puppet/environments$ ls -l\r\ntotal 4\r\nlrwxrwxrwx 1 root root   47 Jul  4 10:05 user1 -> /var/lib/ops-automation.user1/puppet\r\nlrwxrwxrwx 1 root root   49 Jul  4 10:05 user2 -> /var/lib/ops-automation.user2/puppet\r\nlrwxrwxrwx 1 root root   49 Jul  4 10:05 production -> /var/lib/ops-automation.production/puppet\r\n\r\nAfter we upgraded to puppet 3.7.0 this morning, Puppet would remove the symlink /etc/puppet/environment/production and replace it with an empty folder. Reverting to 3.6.2 fixed the issue for us.\r\n\r\nI suspect it *might* be linked to this patch: \r\nhttps://github.com/puppetlabs/puppet/pull/2646/files#diff-13\r\n\r\nIt seems to ensure the environment folder is a directory and manage it if this, among other things, is true:\r\nPuppet::FileSystem.exist?(envdir)\r\n\r\nThough in our case, the file exists but isn''t a directory. If I''m right with this assumption, testing if the filepath is a directory rather than checking if the filepath exists could fix it...\r\n\r\nThanks!', 'https://tickets.puppetlabs.com/browse/PUP-3186', 'https://github.com/puppetlabs/puppet/pull/3075', '2014-09-05T04:49:48.000-0700', '2019-04-04T22:30:29.000-0700', '2019-04-04T22:30:29.000-0700', 'Closed', '', 8, '0', 1, 14, 5, 2, 'f2190c24f43d8284647c5bc41b25919da41e68df'),
('puppet', 37370, 16546670, 2712, 'A node can''t always collect its own exported resources', 'Depending on how tags are applied, a node does not collect its own resources.\r\n\r\nSetting the  {{tag}} metaparameter in a resource default results in none of the test nodes collecting this resource.\r\n\r\nWhen the {{tag}} function is used, then each node collects the other nodes resources, but not it''s own.\r\n\r\nWhen the resource has a {{tag =>}} metaparameter applied directly, then all resources are collected.\r\n\r\nHowever, even when the tag is given as a string rather than an array, the resource is collected ( at least on some resource types, {{notify}}, setting the {{tag}} as a string did not fully work for a {{concat}} resource )\r\n\r\nFor code samples that will reproduce the behavior, please refer to:\r\n\r\nhttps://gist.github.com/llowder/209fece500c1823c229b\r\nhttps://gist.github.com/llowder/a455dd2e8d7ceddf9abc\r\n\r\nI''ve also created a table that summarizes the notify resource test results, it is attached to the ticket.', 'https://tickets.puppetlabs.com/browse/PUP-2689', 'https://github.com/puppetlabs/puppet/pull/2712', '2014-05-28T07:29:56.000-0700', '2019-04-04T22:30:30.000-0700', '2019-04-04T22:30:30.000-0700', 'Closed', 'support', 17, '0', 2, 82, 32, 8, '0436eb1e0997a6f19ea734923a1b82625a4034f8'),
('puppet', 56620, 25591836, 3390, 'Remove current_environment check in Puppet::Indirector::Request#environment=', 'Currently we have the environment setter in lib/puppet/indirector/request.rb set to allow the environment to be set to an environment when it is what is in `Puppet.lookup(:current_environment)`. We should only allow environments that puppet knows about in Puppet.lookup(:environments)\r\n\r\nThe following lines should be removed:\r\n{noformat}\r\nelsif (current_environment = Puppet.lookup(:current_environment)).name == env\r\n  current_environment\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3567', 'https://github.com/puppetlabs/puppet/pull/3390', '2014-10-29T10:26:13.000-0700', '2019-04-04T22:30:30.000-0700', '2019-04-04T22:30:30.000-0700', 'Closed', '', 7, '0', 1, 0, 2, 1, '16f66fcb3ab608e2f3d81c2b217906fa1c84df79'),
('puppet', 32104, 0, 0, 'Deprecation warnings issued with different messages from the same line are suppressed.', 'For example, if you have a line which issues a deprecation warning for different settings (and interpolates the name of the setting into the message), the current deprecation_warning method will only issue a warning about the first setting.\r\n\r\nFor a concrete example:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/settings.rb#L111\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2282', 'https://github.com/puppetlabs/puppet/commit/dbe49a58e1ac2bafd6a57bfb854e9232de7437bf', '2014-04-16T14:22:43.000-0700', '2019-04-04T22:30:31.000-0700', '2019-04-04T22:30:31.000-0700', 'Closed', '', 3, '0', 0, 0, 0, 0, 'dbe49a58e1ac2bafd6a57bfb854e9232de7437bf'),
('puppet', 20600, 318279357, 7726, 'future parser fails to recognize hash as parameter in un-parenthesized calls', 'If an attempt is made to evaluate this\r\n{code}\r\nnotice {a => 10}\r\n{code}\r\n\r\nThe result is the error message: "ll resource specifications require names"\r\n\r\nThis is because it was once allowed to have resource initialization without a name, and the parser issues a deprecation error for this.\r\n\r\nThis is somewhat tricky to work around as the grammar does not know if a name represents a function name, or a type name (nor can it, because that would require it to know every function/type up-front when parsing).\r\n\r\nIt may be possible to specialize the grammar; now it accepts an Expression followed by Body or Bodies that may or may not have titles depending on what the LHS Expression is. This may solve the problem but requires experimentation.\r\n\r\nAnother option, since the case of a no-title resource body is specific is to simply generate a name, followed by a hash if the body is only using ''=>'' as attribute operator. If ''+>'' it would be an error in any case.\r\n\r\nYet another option is to perform lexical look ahead (but this is both expensive and difficult since the '':'' which signals that what otherwise looks like a hash is a title is on the right of what may be a complex expression.\r\n\r\nGoing to far solving this creates another problem; functions and types end up being in the same name space, and needs to be resolved at runtime.\r\n\r\nMeanwhile, use () around the arguments in the function call.\r\n\r\nThis work relates to the work to refactor the errors raised from within the grammar itself.\r\n\r\nFinally. It may be an acceptable restriction and that the specification states that it is not possible to call a function without using parentheses when the argument is a literal hash.\r\n\r\nA decision is needed if it is worth trying to fix this.\r\n\r\nStory point wise, this is hard to assess as a working solution can only be found by experimenting, it may take a day, or a week, or we may end up with a different anomaly. Ended up setting 2 as a cap on exploratory work.', 'https://tickets.puppetlabs.com/browse/PUP-979', 'https://github.com/puppetlabs/puppet/pull/7726', '2013-12-09T18:33:37.000-0800', '2019-04-04T22:30:34.000-0700', '2019-04-04T22:30:34.000-0700', 'Closed', '', 8, '0', 1, 8, 0, 2, '8a4d1b3c0ab7cd4b6afb51b531527fb6ef8ab262'),
('puppet', 19262, 488992438, 8334, 'Structured CSR attributes cannot be displayed by OpenSSL', 'When using `openssl req` to inspect a CSR with custom attributes, the attribute value cannot be displayed. Given the following `csr_attributes.yaml`:\r\n\r\n<pre>\r\n---\r\ncustom_attributes:\r\n  1.3.6.1.4.1.34380.2.1: "string data"\r\n  1.3.6.1.4.1.34380.2.2: [''structured'', ''data'']\r\n\r\nextension_requests:\r\n  pp_uuid: ''6036aec5-b5a2-4919-9194-8bf8a81d92b9''\r\n</pre>\r\n\r\nInspecting the CSR with `openssl req -in ~/.puppet/csr.pem -noout -text` yields the following:\r\n\r\n<pre>\r\n[...]\r\n        Attributes:\r\n            1.3.6.1.4.1.34380.2.1    :unable to print attribute\r\n            1.3.6.1.4.1.34380.2.2    :unable to print attribute\r\n        Requested Extensions:\r\n            1.3.6.1.4.1.34380.1.1.1: \r\n                6036aec5-b5a2-4919-9194-8bf8a81d92b9\r\n[...]\r\n</pre>\r\n\r\nThis is because the OpenSSL code expects attributes to either be the extReq attribute, or a custom attribute with a type of `T61String`, `IA5String`, or `PrintableString`:\r\n\r\n(openssl 1.0.1e crypto/asn1/t_req.c lines 206-216)\r\n<pre>\r\n				if (	(type == V_ASN1_PRINTABLESTRING) ||\r\n					(type == V_ASN1_T61STRING) ||\r\n					(type == V_ASN1_IA5STRING))\r\n					{\r\n					if (BIO_write(bp,(char *)bs->data,bs->length)\r\n						!= bs->length)\r\n						goto err;\r\n					BIO_puts(bp,"\n");\r\n					}\r\n				else\r\n					{\r\n					BIO_puts(bp,"unable to print attribute\n");\r\n					}\r\n</pre>\r\n\r\nThe specification of CSRs indicates that attributes may be arbitrarily structured, but the openssl command line is one of the main methods that people will be interacting with CSRs with custom attributes. Changing the CSR attribute structure to only use string values simplifies the code and interacts better with openssl, and if structured data is needed then a data can be serialized as JSON/YAML/XML/JSONx and deserialized by the consumer of the CSR if needed.', 'https://tickets.puppetlabs.com/browse/PUP-801', 'https://github.com/puppetlabs/puppet/pull/8334', '2013-11-20T10:30:10.000-0800', '2019-04-04T22:30:35.000-0700', '2019-04-04T22:30:35.000-0700', 'Resolved', 'redmine', 2, '0', 6, 202, 67, 5, '0fcb8d10c407e8dfa1fef8578c1712ee3cb1c860'),
('puppet', 28207, 13328692, 2419, 'File type ignore can''t convert Fixnum into String', 'The following worked in Puppet 3.1 but throws errors in Puppet 3.4.x\r\n{noformat}\r\n    file { $::epiphany::cluster_dir:\r\n      ensure  => directory,\r\n      mode    => $::epiphany::config_file_mode,\r\n      owner   => $::epiphany::config_file_owner,\r\n      group   => $::epiphany::config_file_group,\r\n      require => Exec["${::epiphany::cluster_dir}/registry/db"],\r\n      source  => ''puppet:///modules/epiphany/cluster'',\r\n      recurse => true,\r\n      ignore  => [''.snapshot'', ''0'', ''k'', ''z''],\r\n    }\r\n{noformat}\r\nError thrown by Puppet:\r\n{noformat}puppet-agent[29514]: (/Stage[main]/Epiphany::Install/File[/srv/epiphany/cluster]) Failed to generate additional resources using ''eval_generate'': Error 400 on SERVER: can''t convert Fixnum into String{noformat}\r\nWhen removing {{''0''}} from the array, no errors are thrown.', 'https://tickets.puppetlabs.com/browse/PUP-1885', 'https://github.com/puppetlabs/puppet/pull/2419', '2014-03-07T00:38:10.000-0800', '2019-04-04T22:30:36.000-0700', '2019-04-04T22:30:36.000-0700', 'Closed', '', 4, '0', 2, 23, 6, 2, '73c53bb72603000600b54a6dc9ee8364ce0bda0b'),
('puppet', 237478, 175465624, 6745, 'Incorrect handling of white space surrounding comments in EPP', 'An EPP comment preceded by any number of spaces or tabs will not produce those spaces or tabs on output:\r\n{code:puppet}\r\ninline_epp("some   \t\t   <%#%>text")) # returns ''sometext''\r\ninline_epp("some<%#%> text")) # returns ''some text''\r\n{code}\r\nI can''t find anything in the documentation that supports this. The code contains [this comment and a regexp|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/parser/epp_support.rb#L244-L245]. It would make sense if the regexp was anchored at the beginning of line (and if the behavior was documented) but it isn''t.', 'https://tickets.puppetlabs.com/browse/PUP-8476', 'https://github.com/puppetlabs/puppet/pull/6745', '2018-02-20T07:49:35.000-0800', '2019-04-04T22:30:37.000-0700', '2019-04-04T22:30:37.000-0700', 'Closed', '', 5, '0', 1, 65, 20, 2, '5d8dd66ab44a786c27f66e6b39de0228b2c7fd46'),
('puppet', 56227, 27782091, 3503, '4x function API''s call_function cannot call a 3x function', 'The 4x API exposes a method called "call_function" that a 4x function can use to call other functions. \r\n\r\nThis is however currently restricted to only work for 4x functions as the function is loaded using the loaders subsystem, and this subsystem is not used to load 3x functions. \r\n\r\nWe can either change the use of the loaders for 3x functions, or add handling in the call_function to perform lookup of a 3x function the "old way" if it is not found in the new loaders subsystem.', 'https://tickets.puppetlabs.com/browse/PUP-3548', 'https://github.com/puppetlabs/puppet/pull/3503', '2014-10-26T16:51:29.000-0700', '2019-04-04T22:30:37.000-0700', '2019-04-04T22:30:37.000-0700', 'Closed', '', 18, '0', 1, 139, 313, 13, 'f158248fc6e9fa71fa10071fc2f66c34baa3bc63'),
('puppet', 37404, 16892789, 2755, 'LiteralString class parameters get parsed with positioning information that includes a negative length', 'When using the future parser, any class parameter with a LiteralString value receive positioning information with a negative length:\r\n\r\n{code}\r\n# param_test.rb\r\nrequire ''puppet''\r\nrequire ''puppet/pops''\r\n\r\nparser = Puppet::Pops::Parser::Parser.new\r\n\r\nresult = parser.parse_string <<-EOM\r\nclass test::class (\r\n  $param_one = undef,\r\n  $param_two = ''some string'',\r\n  $param_three = true,\r\n  $param_four = ''another string'',\r\n  $param_five = $some::varaible::somewhere, \r\n) {}\r\nEOM\r\n\r\nresult.current.definitions.each do |d|\r\n  d.parameters.each do |p|\r\n    puts "#{p.name}: #{p.value.length}"\r\n  end\r\nend\r\n{code}\r\n\r\n{noformat}\r\n# ruby param_test.rb\r\nparam_one: 5\r\nparam_two: -13\r\nparam_three: 4\r\nparam_four: -16\r\nparam_five: 26\r\n{noformat}\r\n\r\nThis prevents SourcePosAdapters attached to these object from being fully functional.', 'https://tickets.puppetlabs.com/browse/PUP-2693', 'https://github.com/puppetlabs/puppet/pull/2755', '2014-05-28T12:12:06.000-0700', '2019-04-04T22:30:38.000-0700', '2019-04-04T22:30:38.000-0700', 'Closed', 'future-parser', 2, '0', 1, 11, 1, 2, '244652788a7320fa0ac7c14b1fe9eb513f4d3a88'),
('puppet', 55972, 23239056, 3229, 'Future parser handling undef''s incorrectly', 'Trying to run the future parser with PE I ran in to the following error\r\nhttps://github.com/puppetlabs/puppetlabs-pe_staging/blob/3.2.x/manifests/file.pp#L18\r\nThe manifest above is failing because the future parser is overriding the variable $environment with the top-level puppet variable ($environment) set to ''production'' in our case.\r\n\r\nThe error I got was\r\nError: Failed to apply catalog: Parameter environment failed on Exec[/opt/staging/pe_repo/puppet-enterprise-3.4.0-rc1-1641-g71eeb3f-debian-7-amd64-agent.tar.gz]: Invalid environment setting ''production'' at /opt/puppet/share/puppet/modules/pe_staging/manifests/file.pp:95\r\nWrapped exception:\r\nInvalid environment setting ''production''\r\nWrapped exception:\r\nInvalid environment setting ''production''\r\n\r\nReproduction steps in PE:\r\nInstall pe\r\nSet parser = future in puppet.conf\r\nRestart puppetserver\r\nWait 30 sec\r\nrun the agent with -tdv', 'https://tickets.puppetlabs.com/browse/PUP-3505', 'https://github.com/puppetlabs/puppet/pull/3229', '2014-10-22T13:50:59.000-0700', '2019-04-04T22:30:40.000-0700', '2019-04-04T22:30:40.000-0700', 'Closed', '', 14, '0', 1, 15, 2, 2, '912efca9b0e4fff54feb7d38ae496cea3ad083f7'),
('puppet', 51200, 21245952, 3098, 'Function calls no longer showing up in profile data', 'When the {{profile}} setting is enabled, the catalog compilation tracks course grained profiling information. One piece of information tracked is how long it takes it to make function calls.\r\n\r\n{noformat}\r\nDebug: PROFILE [apply] 2.3.1 Called notice: took 0.0001 seconds\r\n{noformat}\r\n\r\nHowever, this information is missing when the future parser is in effect. Without this, there is a large gap in accounting for where time is spent when producing a catalog.', 'https://tickets.puppetlabs.com/browse/PUP-3245', 'https://github.com/puppetlabs/puppet/pull/3098', '2014-09-15T09:49:00.000-0700', '2019-04-04T22:30:40.000-0700', '2019-04-04T22:30:40.000-0700', 'Closed', '', 2, '0', 1, 18, 16, 1, '8b218da30f4fb249b84670c1106b62c127a0b702'),
('puppet', 35826, 16015462, 2663, 'Spurious warnings when using multiple file sources', 'When a file resource uses multiple sources puppet issues a warning like (the example manifest and the warning are not intended to match in file names):\r\n{code}\r\nWarning: Find /production/file_metadata/modules/slurm/c12-8.ymir.cse.ucdavis.edu/slurm.sh?links=manage&source_permissions=use resulted in 404 with the message: Not Found: Could not find file_metadata modules/slurm/c12-8.ymir.cse.ucdavis.edu/slurm.sh\r\n{code}\r\n\r\nThis causes the puppet run, although successful, to look like it has done a number of things wrong.', 'https://tickets.puppetlabs.com/browse/PUP-2584', 'https://github.com/puppetlabs/puppet/pull/2663', '2014-05-15T17:54:46.000-0700', '2019-04-04T22:30:40.000-0700', '2019-04-04T22:30:40.000-0700', 'Closed', '', 27, '0', 1, 32, 16, 5, '5d6cdcb416526f85e62f642289ab3f26c8ce64a7'),
('puppet', 32707, 15074190, 2568, 'Functions unable to call functions in different modules', 'With two modules, a and b, and one function in each module, a::func1 and b::func2, it doesn''t seem possible for a::func1 to make a call to b::func2.\r\n\r\nIt needs to be possible with the new function API and the new loader system for function calls between modules to take place. The new loaders try to limit the visibility of modules so that they can more strictly control their dependencies, but it seems to be too strict right now.\r\n\r\nThe rules should be:\r\n  1. If there is *no* metadata for the module, everything is visible to it.\r\n  2. If there is metadata, only those modules listed in the dependencies are visible to it.', 'https://tickets.puppetlabs.com/browse/PUP-2344', 'https://github.com/puppetlabs/puppet/pull/2568', '2014-04-22T14:11:47.000-0700', '2019-04-04T22:30:41.000-0700', '2019-04-04T22:30:41.000-0700', 'Closed', '', 1, '0', 1, 225, 104, 11, '625d14e9c5a0d2cda1578e46609399ec40084afd'),
('puppet', 25329, 12294062, 2334, 'Using new directory environments with puppet apply prevents evaluation of the manifest requested on the commandline.', 'Assuming you are working with master past the inclusion of PUP-1118 (3c4669d) and you have directory environments available:\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ tree ~/.puppet/environments/\r\n/home/jpartlow/.puppet/environments/\r\n└── myenv\r\n\r\n1 directory, 0 files\r\n{code}\r\n\r\nThen given a manifest ./local.pp\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ cat local.pp \r\nnotice(''in local.pp'')\r\n{code}\r\n\r\nYou will see the following behavior depending on whether you puppet apply with a directory environment:\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ be puppet apply local.pp                                                                                                        \r\n/dev/mem: Permission denied\r\nNotice: Scope(Class[main]): in local.pp\r\nNotice: Compiled catalog for percival.corp.puppetlabs.net in environment production in 0.01 seconds\r\nNotice: Finished catalog run in 0.05 seconds\r\n{code}\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ be puppet apply local.pp --environment myenv\r\n/dev/mem: Permission denied\r\nNotice: Compiled catalog for percival.corp.puppetlabs.net in environment myenv in 0.02 seconds\r\nNotice: Finished catalog run in 0.07 seconds\r\njpartlow@percival:~/work/puppet$ \r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1574', 'https://github.com/puppetlabs/puppet/pull/2334', '2014-02-03T15:06:00.000-0800', '2019-04-04T22:30:41.000-0700', '2019-04-04T22:30:41.000-0700', 'Closed', '', 5, '0', 1, 150, 78, 7, 'c65745ce30920917467ba787f25c335440321410'),
('puppet', 37739, 16548298, 2713, 'tag should be a statement function in future parser', 'The {{tag}} function should (just like include, require, contain, and\r\nthe logging functions), be considered a statement function by the future parser. Now, it is required to use parentheses around its arguments.', 'https://tickets.puppetlabs.com/browse/PUP-2703', 'https://github.com/puppetlabs/puppet/pull/2713', '2014-05-30T11:21:33.000-0700', '2019-04-04T22:30:42.000-0700', '2019-04-04T22:30:42.000-0700', 'Closed', 'future-parser', 6, '0', 1, 2, 1, 2, 'c1354b55b55ccfc8725071dceae0f7b74a7da931'),
('puppet', 28974, 13695792, 2444, 'Environment & transaction_uuid is not passed to facts indirector during compilation', 'The class Puppet::Indirector::Catalog::Compiler contains a method ''extract_facts_from_request'' which extracts facts from the request to be stored in a cache indirector.\r\n\r\nThis call is used in the flow for the PuppetDB terminus to save facts.\r\n\r\nThe problem however, is that the environment is not passed through to the indirector, which means we cannot preserve facts with the environment they were created from so we can complete PDB-453.\r\n\r\nI have a patch that remedies this, and it is forthcoming.\r\n\r\n[~eric.sorenson], [~andy] ... I''m not sure if this is strictly a bug or non-feature, what do you think? I simply ask because I''m not sure what branch/fix version to target this for.', 'https://tickets.puppetlabs.com/browse/PUP-1975', 'https://github.com/puppetlabs/puppet/pull/2444', '2014-03-18T10:07:45.000-0700', '2019-04-04T22:30:44.000-0700', '2019-04-04T22:30:44.000-0700', 'Closed', '', 7, '0', 2, 13, 2, 2, 'ea1a04bef489bd193e3f3cfaeb5d0e6fdd142682'),
('puppet', 20598, 290322996, 7588, 'multiple literal default entries in case should raise warning or error under control by --strict', 'Multiple ''default'' entries should result in a parse error. It creates an ambiguity. Consider the following examples:\r\n\r\n{code}\r\ncase 10 {\r\n  default : { notice ''nbr1'' }\r\n  default : { notice ''nbr2'' }\r\n}\r\n# => notices nbr 2\r\n\r\ncase default {\r\n  default : { notice ''nbr1 }\r\n  default : { notice ''nbr2'' }\r\n}\r\n# => notices nbr1\r\n{code}\r\n\r\nThe solution is to validate that only one option among all propositions is a literal default.\r\n\r\nUPDATE\r\n----\r\nThe check for this can only detect literal (i.e. static) duplication. This because it is possible to use any expression as a case option and we cannot evaluate all options as the language is specified to evaluate them sequentially until there is a match. Here is an illustration:\r\n{code:puppet}\r\n$a = default\r\ncase 10 {\r\n  $a : { notice yay }\r\n  default : { notice nay }\r\n}\r\n{code}\r\nThis will notice {{yay}}.\r\n\r\nIt is not only duplication of literal {{default}} that can cause problems - a check could check for any static duplication since the option with a second identical value would never be reached. Such a check is however more expensive than only checking duplication of literal {{default}} since option values can be arbitrarily complex.', 'https://tickets.puppetlabs.com/browse/PUP-978', 'https://github.com/puppetlabs/puppet/pull/7588', '2013-12-09T17:42:03.000-0800', '2019-04-04T22:30:44.000-0700', '2019-04-04T22:30:44.000-0700', 'Closed', '', 6, '0', 1, 2, 2, 1, '95b3be4c15fecb3eafecc512104265a8b1d4d392'),
('puppet', 38762, 0, 0, 'Fix faulty acceptance test for future parser', 'This test:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/acceptance/tests/apply/conditionals/should_evaluate_undef.rb\r\n\r\nIs faulty for future parser since undef is no longer equal to an empty string.\r\n\r\nThis blocks getting a clean acceptance test run.', 'https://tickets.puppetlabs.com/browse/PUP-2756', 'https://github.com/puppetlabs/puppet/commit/e0e58184eb31f69e13f2120acaafb836c78291f4', '2014-06-11T09:25:58.000-0700', '2019-04-04T22:30:45.000-0700', '2019-04-04T22:30:45.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, 'e0e58184eb31f69e13f2120acaafb836c78291f4'),
('puppet', 37891, 16866710, 2749, 'Future parser returns nil when parsing a source that contains no statements', 'Consider the following example:\r\n\r\n{code}\r\nrequire ''puppet''\r\nrequire ''puppet/pops''\r\n\r\nparser = Puppet::Pops::Parser::Parser.new\r\n\r\nresult = parser.parse_string(''# This is a comment'')\r\n\r\nputs "Result: #{result.inspect}"\r\n\r\nresult = parser.parse_string <<-EOM\r\n# This is a comment\r\n$foo = 1\r\nEOM\r\n\r\nputs "Result: #{result.inspect}"\r\n{code}\r\n\r\nThe result is:\r\n\r\n{noformat}\r\n# ruby parser_tst.rp \r\nResult: nil\r\nResult: #<Puppet::Pops::Model::Factory:0x7ffe0c270dc8 @current=Puppet::Pops::Model::AssignmentExpression>\r\n{noformat}\r\n\r\nIn the first case, a nil is returned because there are no Puppet statements in the input. We should consider returning some {{Pops::Model}} object, such as {{Nop}}, instead of nil.\r\n\r\nOr, document nil as a valid return type for the future parser.', 'https://tickets.puppetlabs.com/browse/PUP-2714', 'https://github.com/puppetlabs/puppet/pull/2749', '2014-06-02T14:16:28.000-0700', '2019-04-04T22:30:48.000-0700', '2019-04-04T22:30:48.000-0700', 'Closed', 'future-parser', 3, '0', 2, 853, 816, 5, '31b42181e0f91fcae77dc14b52756d58ff63bb49'),
('puppet', 21371, 426525865, 8183, 'Resource defaults and automatic tags are applied after collectors are evaluated', 'Resources (and virtual resources) are not having their classes declared tags correctly applied. ("Add the specified tags to the containing class or definition. All contained objects will then acquire that tag, also." ref: http://docs.puppetlabs.com/references/latest/function.html#tag)\r\n\r\n{code}\r\nclass foo {\r\n    tag ''notworking''\r\n    notify { "I''m untagged": }\r\n    notify { "I''m tagged": tag => "notworking" }\r\n}\r\ninclude foo\r\nNotify <| tag == "notworking" |> { message => "I am though" }\r\n{code}\r\n\r\nResults in:\r\n\r\n{code}\r\nmauve /home/jbooth > puppet tagmagic.pp\r\nnotice: I am though\r\nnotice: //foo/Notify[I''m tagged]/message: defined ''message'' as ''I am though''\r\nnotice: I''m untagged\r\nnotice: //foo/Notify[I''m untagged]/message: defined ''message'' as ''I''m untagged''\r\n{code}\r\n\r\nYou can change the ''tag == "foo"'' and life doesn''t get any better. The neither notify gets the message changed.\r\n\r\n{code}\r\nmauve /home/jbooth > tail -1 tagmagic.pp \r\nNotify <| tag == "foo" |> { message => "I am though" }\r\nmauve /home/jbooth > puppet tagmagic.pp\r\nnotice: I''m untagged\r\nnotice: //foo/Notify[I''m untagged]/message: defined ''message'' as ''I''m untagged''\r\nnotice: I''m tagged\r\nnotice: //foo/Notify[I''m tagged]/message: defined ''message'' as ''I''m tagged''\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1053', 'https://github.com/puppetlabs/puppet/pull/8183', '2013-12-16T05:36:09.000-0800', '2019-04-04T22:30:48.000-0700', '2019-04-04T22:30:48.000-0700', 'Closed', 'customer;redmine', 5, '0', 1, 20, 19, 4, 'd84b38898527d2c94c1112402a085729c81a6236'),
('puppet', 197414, 127094813, 6007, 'puppet epp render fails on valid templates ', 'puppet apply is able to parse/render template data where puppet epp render fails.\r\n\r\n{noformat}\r\npuppet apply /tmp/foo.pp -v\r\nInfo: Applying configuration version ''1498149368''\r\nNotice: /Stage[main]/Main/File[/tmp/epp_file.txt]/ensure: defined content as ''{md5}b5648129ac61afe0f9ffdaac69db3b75''\r\nNotice: /Stage[main]/Main/File[/tmp/epp_inline.txt]/ensure: defined content as ''{md5}b5648129ac61afe0f9ffdaac69db3b75''\r\nNotice: Applied catalog in 0.01 seconds\r\n{noformat}\r\n\r\n{noformat}\r\npuppet epp render /tmp/foo.epp --trace\r\nError: Evaluation Error: Error while evaluating a Method call, each(): Wrong number of arguments given (1 for minimum 2) at /tmp/foo.epp:2:9\r\nError: error while rendering epp\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/face/epp.rb:345:in `block (3 levels) in <top (required)>''\r\n/usr/local/opt/rbenv/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/interface/action.rb+eval[wrapper]:242:in `render''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/application/face_base.rb:252:in `main''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/application.rb:366:in `run_command''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/application.rb:358:in `block in run''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/util.rb:542:in `exit_on_fail''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/application.rb:358:in `run''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/util/command_line.rb:132:in `run''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/lib/puppet/util/command_line.rb:72:in `execute''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/gems/puppet-4.10.4/bin/puppet:5:in `<top (required)>''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/bin/puppet:23:in `load''\r\n/usr/local/Cellar/rbenv/1.1.0/versions/2.3.1/gemsets/solaris_providers/bin/puppet:23:in `<main>''\r\nError: Try ''puppet help epp render'' for usage\r\n{noformat}\r\n\r\n\r\n\r\n\r\nThe following manifest will create the test condition.\r\nAfter application puppet epp render /tmp/foo.epp fails\r\n\r\n{code:java}\r\n$foo_epp=@(END)\r\n<% $data = ["routers", "servers", "workstations"] -%>\r\n<% $data.each |$value| { %>\r\n  <%= $value %>\r\n<% } -%>\r\nEND\r\n\r\n# Can''t actually create the template here the catalog compilation fails\r\n# file { "/tmp/foo.epp":\r\n#   ensure   => file,\r\n#   content  => $foo_epp,\r\n# }\r\n\r\nfile { "/tmp/epp_file.txt":\r\n ensure    => file,\r\n content   => epp(''/tmp/foo.epp'')\r\n}\r\n\r\nfile { "/tmp/epp_inline.txt":\r\n  ensure   => file,\r\n  content  => inline_epp($foo_epp)\r\n}\r\n\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7691', 'https://github.com/puppetlabs/puppet/pull/6007', '2017-06-22T09:26:58.000-0700', '2019-04-04T22:30:49.000-0700', '2019-04-04T22:30:49.000-0700', 'Closed', '', 2, '0', 3, 63, 48, 27, '9b7de5fc5350f8f10444b4943f0e3a0ff8ede073'),
('puppet', 12668, 13863437, 2464, 'A hiera-1 hiera.yaml should be ignored in $confdir', 'The default bootstrap of the bindings looks at hiera.yaml in $confdir. If this is a hiera-1 yaml, it should silently be ignored. Currently there is no logic in place for this (it should be in the ConfdirHieraSchemeHandler).', 'https://tickets.puppetlabs.com/browse/PUP-200', 'https://github.com/puppetlabs/puppet/pull/2464', '2013-07-31T10:07:15.000-0700', '2019-04-04T22:30:50.000-0700', '2019-04-04T22:30:50.000-0700', 'Resolved', '', 0, '0', 1, 130, 0, 1, 'e56d2df073e52c8fb778bd56ca943af92e3570f3'),
('puppet', 20950, 308121454, 7676, 'Make relationship with empty set in the middle work as expected', 'If a relationship is formed with an empty set of references,, there will be no relationships created. In practice this becomes a problem when a set is empty as in the following example:\r\n{code}\r\nFile[a] -> [] -> File[b]\r\n{code}\r\n\r\nWhich results in the same as:\r\n{code}\r\nFile[a] -> []\r\n[] -> File[b]\r\n{code}\r\nThis case is not a problem as the intent here must be interpreted as forming optional relationships and there is nothing wrong. Naturally it is surprising if that was not the intention.\r\n\r\nRight now this is silently just a no-op. \r\n\r\nA thorny problem exists when a collector is used to form the relationship. Is that supposed to be optional or not. Arguably, if a collector is used in the middle and returns empty, it should work as if the collector was not there. The main problem with collectors is that they are lazily evaluated at the end of the compilation, and they must be given enough information to be able to close the gap if it is in the middle of a relationship expression. The evaluator must give it this, since it is evaluating the relationship expressions.\r\n\r\nWe should:\r\n* Make the empty set in the middle case work by acting if it was not there, and instead typing the LLHS, to the RRHS.\r\n* When doing this, and the relationship type differs, the RRHS operator should be used (as that defines what the RRHS side expects)\r\n* Accept all other cases silently\r\n* Log with level debug when a relationship is formed with an empty set', 'https://tickets.puppetlabs.com/browse/PUP-996', 'https://github.com/puppetlabs/puppet/pull/7676', '2013-12-11T14:12:47.000-0800', '2019-04-04T22:30:53.000-0700', '2019-04-04T22:30:53.000-0700', 'Closed', '', 4, '0', 3, 92, 0, 1, '48a59a1ce924973a864a6c0dfa1791a4a78f47c8'),
('puppet', 51827, 22805799, 3198, 'Puppet resource broken when directory environments enabled', 'When running puppet resource, the command fails for want of a ''none'' environment\r\n\r\n{quote} puppet resource file /usr/share/puppet-dashboard-mirror ensure=directory source=/usr/share/puppet-dashboard recurse=true ignore=''*log*''\r\nError: /File[/usr/share/puppet-dashboard-mirror]: Failed to generate additional resources using ''eval_generate'': Could not find a directory environment named ''none'' anywhere in the path: /platform/puppet/environment. Does the directory exist?\r\nError: /File[/usr/share/puppet-dashboard-mirror]: Could not evaluate: Could not retrieve file metadata for file:/usr/share/puppet-dashboard: Could not find a directory environment named ''none'' anywhere in the path: /platform/puppet/environment. Does the directory exist?\r\nWrapped exception:\r\nCould not find a directory environment named ''none'' anywhere in the path: /platform/puppet/environment. Does the directory exist?\r\nError: Could not run: Could not retrieve file metadata for file:/usr/share/puppet-dashboard: Could not find a directory environment named ''none'' anywhere in the path: /platform/puppet/environment. Does the directory exist?\r\nWrapped exception:\r\nCould not find a directory environment named ''none'' anywhere in the path: /platform/puppet/environment. Does the directory exist?\r\n{quote}\r\n\r\nNote also - when a large number of directory environments exist, the valid_directories routine in /usr/lib/ruby/site_ruby/1.8/puppet/environments.rb takes a lot of time to stat the environment directory and work out whether all the directories are valid (I currently have 224 environments and the delay between e.g. a puppet agent -t --debug and the command even starting to display debug output is something like 10s (ymmv depending on IO etc)', 'https://tickets.puppetlabs.com/browse/PUP-3302', 'https://github.com/puppetlabs/puppet/pull/3198', '2014-09-18T06:15:51.000-0700', '2019-04-04T22:30:53.000-0700', '2019-04-04T22:30:53.000-0700', 'Closed', '', 4, '0', 6, 31, 32, 8, 'cba213c7cbf2d2c8e22df1d9fbf697d8b5cb1347'),
('puppet', 20923, 301401729, 7640, 'Relationship expression artificially denies arrays as operands', 'The future evaluator artificially denies the use of arrays as operands in a relationship expression (this because they are not supported in 3x).\r\n\r\nAll it takes to support this is to add three lines to the RelationshipOperator:\r\n{code}\r\ndef transformArray(o)\r\n  o.map{|x| transform(x) }\r\nend\r\n{code}\r\n\r\nThis because the multiplication is handled by the new implementation and there are no restrictions in the grammar wrt. the LHS and RHS operands.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-992', 'https://github.com/puppetlabs/puppet/pull/7640', '2013-12-11T13:22:43.000-0800', '2019-04-04T22:30:54.000-0700', '2019-04-04T22:30:54.000-0700', 'Closed', '', 1, '0', 1, 3, 71, 4, 'f6b77cc25c0998c10cedf54f24baefd3ce69db76'),
('puppet', 25804, 12310702, 2336, 'Module tool cache directory isn''t multi-process safe', 'When running two "puppet module install" processes in parallel as the same user, you can get intermittent errors as the working/cache directory is shared across both processes.\r\n\r\nWe see this on our Jenkins instance when using librarian-puppet in concurrent jobs (which are much preferred due to the speed).  e.g.\r\n\r\n{noformat}\r\nError: No such file or directory - /home/jenkins/.puppet/var/puppet-module/cache/tmp-unpacker-caddf5336d687def271badc2321a49b23e7dbd56[0m\r\nError: Try ''puppet help module install'' for usage[0m\r\n{noformat}\r\n\r\nIt''s exacerbated if your storage device is slow.  To reproduce, add a {{sleep rand(3)}} into the middle of the "extract_module_to_install_dir" method in lib/puppet/module_tool/applications/unpacker.rb and run:\r\n\r\n{noformat}\r\n$ rm -rf /tmp/test{1,2}; puppet module install -i /tmp/test2 puppetlabs/apache --ignore-dependencies & puppet module install -i /tmp/test1 puppetlabs/apache --ignore-dependencies\r\n[1] 20513\r\nNotice: Preparing to install into /tmp/test2 ...\r\nNotice: Created target directory /tmp/test2\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Preparing to install into /tmp/test1 ...\r\nNotice: Created target directory /tmp/test1\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\nNotice: Installing -- do not interrupt ...\r\n/tmp/test2\r\n└── puppetlabs-apache (v0.11.0)\r\nError: No such file or directory @ unlink_internal - /home/dcleal/.puppet/var/puppet-module/cache/tmp-unpacker-95dbd7679d60ec112592f6f481c974f40194f30e\r\nError: Try ''puppet help module install'' for usage\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-1609', 'https://github.com/puppetlabs/puppet/pull/2336', '2014-02-07T04:50:26.000-0800', '2019-04-04T22:30:55.000-0700', '2019-04-04T22:30:55.000-0700', 'Closed', '', 1, '0', 1, 1, 1, 1, ''),
('puppet', 16099, 41295376, 4117, 'Remove partially implemented support for ''import''', 'In --parser future, ''import''s are handled as if they are function calls, but when transforming to 3x AST these expressions are handled the same way as in 3x; they go off and parse the referenced file.\r\n\r\nSince the decision for 3.5 is to deprecate import and instead provide a directory containing manifests to auto-run. That implementation for 3x will also work\r\nfor future parser/evaluator. That work is covered by PUP-865 and PUP-866. There is however unused support/transformations of import calls in the future code base. Those transformations should be removed:\r\n\r\n* The import instruction model object should be removed:\r\n* methods in supporting classes; transformer, tree dumper, factory removed\r\n* The special handling of transforming an import function to an import model object) should be removed\r\n\r\ni.e. future parser/evaluator will not issue deprecation, and will instead interpret import as if it is a function call (leading to unknown function error since\r\nthere is no such function).', 'https://tickets.puppetlabs.com/browse/PUP-490', 'https://github.com/puppetlabs/puppet/pull/4117', '2013-10-02T10:42:01.000-0700', '2019-04-04T22:30:55.000-0700', '2019-04-04T22:30:55.000-0700', 'Closed', '', 4, '0', 2, 55, 12, 3, 'b766960260ca5d1585d45469a10e4a82661f59b5'),
('puppet', 70587, 31387842, 3727, 'Default environment_timeout should be 0, not infinity.', 'We''ve gone back and forth on this a few times ([PUP-2702], [PUP-2639]) but after running into issues from PS engagements to training to [this puppet-dev thread|https://groups.google.com/d/topic/puppet-dev/lnbXyHlviT0/discussion], it seems the best option is actually to default the environment_timeout to 0 (do not cache) and let people tune upwards if they need to.\r\n\r\nPlease set the default to 0 for Puppet 3.7.x and beyond and let''s update the docs to describe the rationale there.', 'https://tickets.puppetlabs.com/browse/PUP-4094', 'https://github.com/puppetlabs/puppet/pull/3727', '2015-03-06T11:36:25.000-0800', '2019-04-04T22:30:56.000-0700', '2019-04-04T22:30:56.000-0700', 'Closed', '', 26, '0', 1, 26, 3, 1, '8f107d3c6d6eafffb29218c2d880f0bd99f39b88'),
('puppet', 32538, 16182591, 2685, 'assert_type function should handle lambda', 'The assert_type function was written before lambda support was added to the new function API. If called like this:\r\n\r\n{code}\r\nassert_type(Callable[Optional[Object]]) |$x| { }\r\n{code}\r\nIt fails because it does not support an optional lambda being passed.\r\n\r\n(The error message is also hard to understand - this is a separate issue).\r\n\r\nThis is easily fixed by adding support for an optional lambda in the function, and then either check the given value, or the given lambda, and error if both are given.\r\n\r\nThe assert_type will probably also fail if called with only a type argument since it will dispatch to a method that requires two arguments. (The method should have a default value assigned).', 'https://tickets.puppetlabs.com/browse/PUP-2314', 'https://github.com/puppetlabs/puppet/pull/2685', '2014-04-21T17:58:05.000-0700', '2019-04-04T22:30:58.000-0700', '2019-04-04T22:30:58.000-0700', 'Closed', '', 6, '0', 2, 48, 14, 4, '0203eebe0ca0c65cd3067e2774a752373e16a3fd'),
('puppet', 21453, 606554542, 8556, 'create_resources auto importing a manifest with a syntax error produce a bad error message', 'Given a module with this structure:\r\n\r\n{noformat}\r\nx\r\n└── manifests\r\n    ├── init.pp\r\n    └── y.pp\r\n{noformat}\r\n\r\ninit.pp:\r\n{noformat}\r\nclass x {\r\n    $r = {"one" => {"foo" => "bar"}}\r\n\r\n    create_resources("x::y", $r)\r\n}\r\n{noformat}\r\n\r\nand y.pp which has an obvious syntax error:\r\n\r\n{code}\r\ndefine x::y {\r\n    obvious error should be obvious\r\n}\r\n{code}\r\n\r\nI get the following error:\r\n\r\n{noformat}\r\n% puppet apply --modulepath=`pwd` -e ''include x''\r\nError: exception object expected at /home/rip/temp/x/manifests/init.pp:4 on node devco.net\r\nWrapped exception:\r\nexception object expected\r\nError: exception object expected at /home/rip/temp/x/manifests/init.pp:4 on node devco.net\r\n{noformat}\r\n\r\nWhat''s happening here is the y.pp only gets imported during the processing of create_resources and inside create_resources the parse error is incorrectly handled. \r\n\r\nIn this case the following code:\r\n\r\n{code}\r\n  begin\r\n    resource.safeevaluate(self)\r\n  rescue Puppet::ParseError => internal_error\r\n    raise internal_error.original\r\n  end\r\n{code}\r\n\r\nhas a nil for original in the internal_error object and so it fails.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1100', 'https://github.com/puppetlabs/puppet/pull/8556', '2013-12-16T11:45:44.000-0800', '2019-04-04T22:30:58.000-0700', '2019-04-04T22:30:58.000-0700', 'Closed', 'redmine', 2, '0', 1, 192, 0, 2, 'ae82e0ea669ea3156fc84ad43cd6fadf79c338ec'),
('puppet', 54842, 22681566, 3190, 'Puppet::Node::Facts allows a fact named ''trusted'' that collides with the reserved top scope puppet variable name ''trusted''.', 'There is a top scope variable named ''trusted'' which is reserved by the compiler for the trusted data that the server gathers from the request''s certificate.  A node''s facts are also made available as top scope variables during puppet execution, and if the node has a ''trusted'' fact, either created by the user, or retrieved from a node terminus like PuppetDB which stores the trusted data collected by the master for that node as ''trusted'', then an "Attempt to assign to a reserved variable name" error is raised by the compiler: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/parser/scope.rb#L629\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3449', 'https://github.com/puppetlabs/puppet/pull/3190', '2014-10-13T10:36:43.000-0700', '2019-04-04T22:31:00.000-0700', '2019-04-04T22:31:00.000-0700', 'Closed', '', 2, '0', 1, 49, 1, 2, ''),
('puppet', 52249, 22804905, 3197, 'Changes to environment.conf are not being picked up, even when environment timeout is set to 0.', 'I haven''t tracked down all the details here, but [~adrien] noticed that changes to a directory environment''s environment.conf are not being reloaded, even when environment_timeout is 0.', 'https://tickets.puppetlabs.com/browse/PUP-3334', 'https://github.com/puppetlabs/puppet/pull/3197', '2014-09-23T17:39:33.000-0700', '2019-04-04T22:31:00.000-0700', '2019-04-04T22:31:00.000-0700', 'Closed', '', 3, '0', 2, 71, 3, 3, '920b127cb93d88c787f081fa6c56bc04ccb87bbf'),
('puppet', 50365, 20920344, 3058, '"each" no longer supported in Puppet 3.7.0', 'After upgrading to Puppet 3.7.0, the puppetmaster no longer\r\nrecognizes the "each" keyword.  It prints this in the log:\r\n\r\n{noformat}\r\nSep  5 19:22:56 minicfg2 puppet-master[11897]: each() is only available when parser/evaluator future is in effect on node buildhost1.lysator.liu.se\r\n{noformat}\r\n\r\nThe /etc/puppet/puppet.conf on the puppetmaster host looks like this:\r\n\r\n{noformat}\r\n[main]\r\n  logdir = /var/log/puppet\r\n  vardir = /var/lib/puppet\r\n  ssldir = /var/lib/puppet/ssl\r\n  rundir = /var/run/puppet\r\n  factpath = $vardir/lib/facter\r\n  templatedir = $confdir/templates\r\n  server = minicfg2.lysator.liu.se\r\n  environment = production\r\n\r\n[agent]\r\n  report = true\r\n\r\n[master]\r\n  modulepath=/etc/puppet/environs/$environment/modules:/etc/puppet/environs/$environment/services:/etc/puppet/environ\r\ns/$environment/forge\r\n  manifest=/etc/puppet/environs/$environment/manifests/\r\n  storeconfigs = true\r\n  storeconfigs_backend = puppetdb\r\n  reports = store,rrdgraph,nagiosupdate\r\n  rrddir = /var/www/puppet-rrd\r\n  parser = future\r\n\r\n  # These are needed when the puppetmaster is run by passenger\r\n  # and can safely be removed if webrick is used.\r\n  ssl_client_header = SSL_CLIENT_S_DN\r\n  ssl_client_verify_header = SSL_CLIENT_VERIFY\r\n{noformat}\r\n\r\n(I have changed the hostnames.)\r\n\r\nOn the clients, the file looks like:\r\n\r\n{noformat}\r\n[main]\r\n  logdir = /var/log/puppet\r\n  vardir = /var/lib/puppet\r\n  ssldir = /var/lib/puppet/ssl\r\n  rundir = /var/run/puppet\r\n  factpath = $vardir/lib/facter\r\n  templatedir = $confdir/templates\r\n  server = minicfg2.lysator.liu.se\r\n  environment = production\r\n\r\n[agent]\r\n  report = true\r\n{noformat}\r\n\r\nThis setup worked fine with Puppet 3.5 and 3.6.\r\n\r\nI have looked at https://docs.puppetlabs.com/puppet/latest/reference/experiments_future.html#enabling-the-future-parser to check if I need to do more nowadays to enable both the future parser and evaluator, but as far as I can tell it should still be enough to specify "parser = future" in the master section of puppet.conf.\r\n\r\n(I am aware that I''m using deprecated configuration-based environments, but they should still work until Puppet 4, right?)', 'https://tickets.puppetlabs.com/browse/PUP-3190', 'https://github.com/puppetlabs/puppet/pull/3058', '2014-09-05T12:32:51.000-0700', '2019-04-04T22:31:02.000-0700', '2019-04-04T22:31:02.000-0700', 'Closed', 'future-parser', 12, '0', 1, 76, 0, 1, '0447ea0271966703c246e945a5d9e1d6c6d7e5b0'),
('puppet', 19872, 316272624, 7709, '3x functions do not know how to handle new data types', 'In the 4x evaluator there are new data types that logic written for 3x does not know how to handle; these are the types in the type system, and regular expressions.\r\n\r\nThe evaluator currently converts these to 3x representations when assigning such values to resources but they are passed around otherwise (assigned to variables in scope), sent to functions etc.\r\n\r\nThe main issue is when functions are called with the new types of values. Primarily resource references such as File[''foo''], or a Class[bar]. \r\n\r\nOne solution is to mark functions that are aware of 4x and convert the arguments to 3x compatible types for all other. Alternatively, ignore the issue as existing code typically do not pass resource references around, nor regular expressions (since they cannot be created by the 3x parser).\r\n\r\nThe downside of doing value conversion is that Numeric data may have to be converted to String (it is currently passed through to resources). (It is a bummer that type/resource references have to be strings - this is something to solve later with proper data types in resource types).', 'https://tickets.puppetlabs.com/browse/PUP-910', 'https://github.com/puppetlabs/puppet/pull/7709', '2013-12-01T17:43:15.000-0800', '2019-04-04T22:31:02.000-0700', '2019-04-04T22:31:02.000-0700', 'Closed', '', 2, '0', 2, 19, 3, 2, 'bc4d7b9a70ade7397c0f77c0c2df682d57ce171c'),
('puppet', 13488, 25519212, 3379, 'create_resources ignores exec type''s command attribute', '', 'https://tickets.puppetlabs.com/browse/PUP-256', 'https://github.com/puppetlabs/puppet/pull/3379', '2013-08-19T17:38:00.000-0700', '2019-04-04T22:31:02.000-0700', '2019-04-04T22:31:02.000-0700', 'Resolved', '', 1, '0', 1, 10, 2, 2, '02ba25fbb9410f884f0409e7fd51318cb8ebd363'),
('puppet', 14924, 27472412, 3484, 'Users reporting b64_zlib_yaml errors with 3.3.0', 'Per this puppet-users topic https://groups.google.com/forum/#!topic/puppet-users/ujRKmWtfHUA\n\nSome users are reporting errors retrieving catalogs. The log snippets seem to indicate one too many or one too few levels of urlencoding.\n\n\n\n', 'https://tickets.puppetlabs.com/browse/PUP-384', 'https://github.com/puppetlabs/puppet/pull/3484', '2013-09-18T16:01:43.000-0700', '2019-04-04T22:31:03.000-0700', '2019-04-04T22:31:03.000-0700', 'Closed', '', 1, '0', 1, 3, 0, 1, 'b1ff7cb148307495fbb726ec2ed809653cabc5c4'),
('puppet', 50616, 22895347, 3210, 'Validation thinks that an Undef instance is of type Runtime', 'Create a define like this:\r\n{noformat}\r\ndefine hey(String $x) { notice $x }\r\n{noformat}\r\nCall it like this:\r\n{noformat}\r\nhey{''heyer'': x => undef }\r\n{noformat}\r\nGet the somewhat unexpected error:\r\n{noformat}\r\nExpected parameter ''x'' of ''Hey[heyer]'' to have type String, got Runtime[ruby, Symbol]\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3201', 'https://github.com/puppetlabs/puppet/pull/3210', '2014-09-08T23:01:10.000-0700', '2019-04-04T22:31:03.000-0700', '2019-04-04T22:31:03.000-0700', 'Closed', '', 17, '0', 2, 64, 56, 9, '277f406293efa64ecb56196d7db127e830d55181'),
('puppet', 41275, 18067625, 2845, 'creating a resource override for a Class fails (future parser)', '{code}\r\nClass[a] { x => ''the default'' }\r\n{code}\r\nResults in the error:\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Resource Override, undefined method `type_name'' for Puppet::Pops::Types::PHostClassType:Puppet::Pops::Types::PHostClassType at /Users/henrik/git/puppet/bar.pp:4:1 on node henriks-macbook-pro.local\r\n/Users/henrik/git/puppet/lib/puppet/pops/evaluator/runtime3_support.rb:331:in `block in create_resource_overrides''\r\n{code}\r\n\r\nThe method in question should detect that a PHostClassType is given and use the type_name "class".\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2891', 'https://github.com/puppetlabs/puppet/pull/2845', '2014-07-03T14:54:01.000-0700', '2019-04-04T22:31:04.000-0700', '2019-04-04T22:31:04.000-0700', 'Closed', '', 6, '0', 1, 15, 0, 3, 'f45433637391f5067561f585dfd0507020d2c27e'),
('puppet', 11590, 11304766, 2229, 'Remove relative namespacing', 'This is the issue where `include apache` actually means “try to declare class `<current namespace>::apache`, class `<parent of current namespace>::apache`, and so on, eventually declaring `apache` as a last resort." \r\n\r\nThis bites people in the wild frequently, and seem to be getting a steady stream of customer complaints about it. \r\n\r\nWe seem to have nearly universal agreement that this isn''t how Puppet should work, but fixing it will break code in the wild. In redmine #2053, I suggested a deprecation plan:\r\n\r\n* In a mid-stream 3.x release, we start logging warnings when relative namespacing finds a class that doesn''t match the provided name, and provide a setting to turn on a "strict mode" that kills relative namespacing completely.\r\n* In 4.0, we make the strict mode the only mode.', 'https://tickets.puppetlabs.com/browse/PUP-121', 'https://github.com/puppetlabs/puppet/pull/2229', '2013-07-01T17:55:44.000-0700', '2019-04-04T22:31:04.000-0700', '2019-04-04T22:31:04.000-0700', 'Closed', '', 17, '0', 1, 89, 1, 2, 'fff10ad9b27cb532139f178378b1469641a83506'),
('puppet', 32545, 15098457, 2573, 'Future parser does not error on import statements', 'Puppet 3.5.1 with Future parser enabled does not fail on import statements. When parser is set to current it correctly warns the user that import is deprecated.', 'https://tickets.puppetlabs.com/browse/PUP-2317', 'https://github.com/puppetlabs/puppet/pull/2573', '2014-04-22T00:10:09.000-0700', '2019-04-04T22:31:05.000-0700', '2019-04-04T22:31:05.000-0700', 'Closed', '', 10, '0', 1, 50, 0, 7, 'fbacbb01916bb590e88524d829da94f980715194'),
('puppet', 21207, 403234563, 8095, 'filter function should accept two parameters', 'The filter function should accept two keys for all LHS types; key/value, or index/value to make it consistent with each and map.', 'https://tickets.puppetlabs.com/browse/PUP-1029', 'https://github.com/puppetlabs/puppet/pull/8095', '2013-12-15T17:55:40.000-0800', '2019-04-04T22:31:05.000-0700', '2019-04-04T22:31:05.000-0700', 'Closed', '', 12, '0', 2, 212, 0, 12, 'df159e243d09f3e92a4793c44ea53affe78104ed'),
('puppet', 13719, 16546670, 2712, 'ENC can''t declare any classes that are declared by Puppet', 'If an ENC uses the class parameter format to return its results, Puppet will declare *all* those classes as resources (even if none of them actually have parameters). This means that if the ENC declares a class which is declared elsewhere in Puppet (even if it''s just included), compilation will fail. Because the Console now always uses the class parameter format, classifying a node in Console with any class which is already included either in site.pp or by some other class will fail.', 'https://tickets.puppetlabs.com/browse/PUP-268', 'https://github.com/puppetlabs/puppet/pull/2712', '2013-08-27T17:08:35.000-0700', '2019-04-04T22:31:07.000-0700', '2019-04-04T22:31:07.000-0700', 'Closed', '', 1, '0', 2, 82, 32, 8, 'c32b757acaf94e42564161c663b4f881498c0b70'),
('puppet', 48757, 22168483, 3152, 'Puppet module generate - dependency problem', 'Puppet will generate module, which reports dependency problem when listed.\r\n\r\nGenerate module:\r\npuppet module generate bla-bla\r\n\r\nBuild module:\r\npuppet module build bla-bla\r\n\r\nInstall module (It will correctly install stdlib dependency):\r\npuppet module install /root/bla-bla/pkg/bla-bla-0.1.0.tar.gz\r\n\r\nList modules (It will report missing dependency):\r\n[root@puppet7 ~]$ puppet module list\r\nWarning: Missing dependency ''puppetlabs-stdlib'':\r\n  ''bla-bla'' (v0.1.0) requires ''puppetlabs-stdlib'' (>= 0.0.0)\r\n/etc/puppet/modules\r\n├── bla-bla (v0.1.0)\r\n└── puppetlabs-stdlib (v4.3.2)\r\n/usr/share/puppet/modules (no modules installed)\r\n\r\nPossible fix is to  replace ''-'' with ''/'' in dependency part of module metadata:\r\nsed -i -e ''s|puppetlabs-stdlib|puppetlabs/stdlib|'' bla-bla/metadata.json\r\n\r\nThen It doesn''t report anything after rebuilding and reinstalling the module. \r\n', 'https://tickets.puppetlabs.com/browse/PUP-3121', 'https://github.com/puppetlabs/puppet/pull/3152', '2014-08-21T02:14:57.000-0700', '2019-04-04T22:31:08.000-0700', '2019-04-04T22:31:08.000-0700', 'Closed', '', 7, '0', 1, 2, 2, 1, '372da25acf7bbec994b97baa07a9d0c501ac737e'),
('puppet', 51343, 22083365, 3144, 'puppet apply + ENC + 3.7.x: does not read the .pp file', 'Running ''puppet apply'' with an ENC and a .pp file on the command line (full example supplied): at 3.6.1, the ''notice''s in the .pp file are executed; at 3.7.x, they are not.  ''puppet agent'' 3.7.x does the right thing (same as 3.6.1).\r\n\r\nSee the README file in the attached .tar.gz (a complete example).  I ran ''./vapply --noop'' (it needed sudo in my case; maybe not for you).\r\n\r\nI have no idea on the possible cause; maybe I missed something.', 'https://tickets.puppetlabs.com/browse/PUP-3258', 'https://github.com/puppetlabs/puppet/pull/3144', '2014-09-16T09:01:48.000-0700', '2019-04-04T22:31:08.000-0700', '2019-04-04T22:31:08.000-0700', 'Closed', '', 12, '0', 2, 32, 7, 2, 'bd292a6ec58d4827e12afa74b480c235ce8eccbc'),
('puppet', 28871, 14432122, 2509, 'Using undefined variable as class parameter default fails in future evaluator', 'The following manifest fails in the future evaluator:\r\n\r\n{code}\r\nclass a ($b=$x) {notify{$b:}}\r\ninclude a\r\n{code}\r\n\r\nI get the following output (also not the lack of line numbers):\r\n\r\n{noformat}\r\nError: Evaluation Error: Error while evaluating a Function Call, Received incomplete information - no value provided for parameter b on node test.dalen.cloud.spotify.net\r\nError: Evaluation Error: Error while evaluating a Function Call, Received incomplete information - no value provided for parameter b on node test.dalen.cloud.spotify.net\r\n{noformat}\r\n\r\nIn the 3.x evaluator this prints undef as expected:\r\n\r\n{noformat}\r\nNotice: Compiled catalog for test.dalen.cloud.spotify.net in environment production in 0.06 seconds\r\nNotice: undef\r\nNotice: /Stage[main]/A/Notify[undef]/message: defined ''message'' as ''undef''\r\nNotice: Finished catalog run in 0.02 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-1964', 'https://github.com/puppetlabs/puppet/pull/2509', '2014-03-17T11:39:21.000-0700', '2019-04-04T22:31:10.000-0700', '2019-04-04T22:31:10.000-0700', 'Closed', '', 3, '0', 2, 37, 5, 5, '345790c873afa4cdc1a766296b2130dc6cf5012f'),
('puppet', 56034, 23275959, 3233, 'Future parser not showing line/column for error', 'We had a manifest that contains this:\r\n\r\n{code}\r\nFile [''/etc/pam.d/sshd''] {\r\n{code}\r\n\r\nObviously the space there is a mistake but the future parser gave me this back:\r\n\r\n{noformat}\r\nError: Could not parse for environment production: Expression is not valid as a resource, resource-default, or resource-override at (slice () ''file''):(slice () ''line''):(slice ([] ''/etc/pam.d/sshd'') ''pos'')\r\n{noformat}\r\n\r\nI''m missing file, line and the message isn''t particularly helpful.', 'https://tickets.puppetlabs.com/browse/PUP-3514', 'https://github.com/puppetlabs/puppet/pull/3233', '2014-10-23T06:05:41.000-0700', '2019-04-04T22:31:12.000-0700', '2019-04-04T22:31:12.000-0700', 'Closed', '', 6, '0', 2, 34, 9, 2, '140889b3815e8e7b5d2ed992507b4c5efb2496de'),
('puppet', 34062, 15445600, 2612, 'module skeleton is using deprecated way to configure spec_helper', '[~josh] states that we are using a deprecated method for configuring rspec', 'https://tickets.puppetlabs.com/browse/PUP-2432', 'https://github.com/puppetlabs/puppet/pull/2612', '2014-05-02T11:57:34.000-0700', '2019-04-04T22:31:13.000-0700', '2019-04-04T22:31:13.000-0700', 'Closed', '', 6, '0', 1, 15, 17, 3, 'dffeadf0463e43262c42157a41e6e92815fdd59b'),
('puppet', 40284, 17561685, 2803, 'All concrete types do not inherit PAnyType', 'All concrete types in the type system should inherit from the PAnyType. Now, some types still inherit from the abstract PAbstractType.\r\n\r\nFor some reason this manages to work even if it is wrong. It should be corrected.', 'https://tickets.puppetlabs.com/browse/PUP-2833', 'https://github.com/puppetlabs/puppet/pull/2803', '2014-06-24T14:48:51.000-0700', '2019-04-04T22:31:13.000-0700', '2019-04-04T22:31:13.000-0700', 'Closed', '', 1, '0', 1, 20, 10, 2, '8a24706289daba9995314ecd018c9c3af695dd96'),
('puppet', 43511, 19631320, 2958, 'Implementation of +=/-= is potentially confusing', 'It seems to me that += and -= are more confusing than useful, and I would argue that they simply shouldn''t exist.\r\n\r\nRight now (with "--parser future"), these operators implicitly create a new variable that may shadow one from an outer scope, appending/removing the RHS to the outer scope variable if it exists. If the variable has already been defined in the current scope, the operation fails.\r\n\r\nIn practice, this works like a kind of temporary mutation, or else it''s just regular assignment, or else causes a failure. The alternative, using +/- with =, is more intuitive, less ambiguous, and sacrifices little if anything in terms of expressiveness.\r\n\r\nI apologize in advance if there''s something major that I''m missing here, but I''d like to reopen the discussion on whether it''s better to just remove these operators from the language.', 'https://tickets.puppetlabs.com/browse/PUP-2972', 'https://github.com/puppetlabs/puppet/pull/2958', '2014-07-24T15:58:45.000-0700', '2019-04-04T22:31:15.000-0700', '2019-04-04T22:31:15.000-0700', 'Closed', 'future-parser', 10, '0', 2, 52, 258, 7, '178bbf7ad943da13ae92f797445b94f3d8c86028'),
('puppet', 32342, 14983587, 2559, 'Puppet::Util::Execution.execute no longer returns a String', 'Commit 732d450 ( https://github.com/puppetlabs/puppet/commit/732d450 ) changed the return type of {{Puppet::Util::Execution.execute}} from a String, to a new string subclass {{Puppet::ProcessOutput}}.\r\n\r\nThis is not a fully backwards compatible change, and causes problems where things do strict type checking - for example, the {{chomp()}} function in stdlib.', 'https://tickets.puppetlabs.com/browse/PUP-2306', 'https://github.com/puppetlabs/puppet/pull/2559', '2014-04-18T12:52:30.000-0700', '2019-04-04T22:31:15.000-0700', '2019-04-04T22:31:15.000-0700', 'Closed', '', 3, '0', 1, 5, 1, 2, 'cf1537c2b93785b0c9877a1a0ac53b89d288579e'),
('puppet', 52592, 22669890, 3188, 'Puppet Master Memory Leak', 'Starting with 3.7, the Puppet master process will allocate more and more memory until it is killed by the OOM process.  This occurs in about 24 hours in our environment.\r\n\r\nThe behaviour occurs in both Rack and WEBRick configurations.  In the Rack configuration the four Rack processes will grow until killed.   In WEBRick configuration the one puppet master process will grow.', 'https://tickets.puppetlabs.com/browse/PUP-3345', 'https://github.com/puppetlabs/puppet/pull/3188', '2014-09-25T11:08:54.000-0700', '2019-04-04T22:31:15.000-0700', '2019-04-04T22:31:15.000-0700', 'Closed', '', 43, '0', 5, 322, 8, 6, '946cbd977d3d967cb1abe408ed4099b3fac4a366'),
('puppet', 36952, 0, 0, 'Puppet stops working with error ''Attempted to pop, but already at root of the context stack.''', 'After upgrading puppet to version 3.6.1, the following error occurs:\r\n\r\n{noformat}\r\nAttempted to pop, but already at root of the context stack.\r\n{noformat}\r\n\r\nAnd afterwards log is flooded with following message:\r\n\r\n{noformat}\r\nno ''environments'' in {:root_environment=>#<Puppet::Node::Environment:0x7fe1930f5a38 @manifest="/", @modulepath=[], @name=:"*root*", @watching=true, @config_version=nil>, :current_environment=>#<Puppet::Node::Environment:0x7fe1930f5a38 @manifest="/", @modulepath=[], @name=:"*root*", @watching=true, @config_version=nil>} at top of [[0, nil, nil]]\r\n{noformat}\r\n\r\nThis was not an issue in 3.6.0. Unfortunately this happens at seemingly random times, soon after starting the puppetmaster service.', 'https://tickets.puppetlabs.com/browse/PUP-2659', 'https://github.com/puppetlabs/puppet/commit/4744a7f9deb514302333cd81a30cd662a3453c96', '2014-05-24T10:14:36.000-0700', '2019-04-04T22:31:16.000-0700', '2019-04-04T22:31:16.000-0700', 'Closed', '', 50, '0', 0, 0, 0, 0, '4744a7f9deb514302333cd81a30cd662a3453c96'),
('puppet', 28242, 125940275, 5991, 'URI.unescape mangles UTF-8 paths producing invalid ASCII strings', 'Hi, \r\n\r\nI am running a puppet server under Ubuntu 12.04 (Puppet 2.7.11) and a puppet client under Ubuntu 14.04 (Puppet 3.4.2). \r\n\r\nI am distributing a directory of ttf fonts from the server to the clients, the rule is\r\n\r\n      file{"/usr/local/share/fonts/FreeFonts":\r\n        ensure  => directory,\r\n        mode    => 0444,\r\n        recurse => true,\r\n        purge   => true,\r\n        source  => "puppet:///modules/hadmut/soft/Daten/Fonts/Installation/FreeFonts",\r\n      }\r\n\r\n\r\nThis works with a great number of font files, but fails with one particular font:\r\n\r\nError: Could not set ''file'' on ensure: invalid byte sequence in US-ASCII\r\nError: Could not set ''file'' on ensure: invalid byte sequence in US-ASCII\r\nWrapped exception:\r\ninvalid byte sequence in US-ASCII\r\nError: /Stage[main]/Hadmut::Application::X11_common/File[/usr/local/share/fonts/FreeFonts/Momоt___.ttf]/ensure: change from absent to file failed: Could not set ''file'' on ensure: invalid byte sequence in US-ASCII\r\n\r\n\r\nFor some reason Puppet assumes that this is an US-ASCII text file, but it should treat this as a binary. \r\n\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1890', 'https://github.com/puppetlabs/puppet/pull/5991', '2014-03-07T12:53:04.000-0800', '2019-04-04T22:31:17.000-0700', '2019-04-04T22:31:17.000-0700', 'Closed', 'customer;encoding;i18n;resolved-issue-added;support;utf-8', 21, '0', 3, 655, 48, 24, '89c035b0e1c68e16b9e0d19340ab347c91a8fdb5'),
('puppet', 36788, 16545737, 2710, 'Increase environment_timeout default.', 'Current environment_timeout defaults to 5s, which is too quick for typically production catalog build.  It is essential that the timeout be longer than the typical catalog build time, and we want a default that will work reasonable well for general production cases.  Three minutes seems reasonable.\r\n\r\nThis fix should be cherry picked (or merged down if all stable is being merged) back to pe-puppet/3.3.x.', 'https://tickets.puppetlabs.com/browse/PUP-2639', 'https://github.com/puppetlabs/puppet/pull/2710', '2014-05-22T13:43:51.000-0700', '2019-04-04T22:31:20.000-0700', '2019-04-04T22:31:20.000-0700', 'Closed', '', 4, '0', 1, 1, 1, 1, '1e3e7f39b172e648c93dcfed48d71a294bfb3250'),
('puppet', 31321, 14718678, 2534, 'Accessing resource metaparameters fails in future evaluator', 'Accessing regular parameters works fine, and when accessing unknown ones you get a decent error message. But when trying to access metaparameters you get a bad internal error\r\n\r\n{code}\r\nnotify{foo:}\r\nnotify{Notify[foo][tag]:}\r\n{code}\r\n\r\nGives:\r\n\r\n{noformat}\r\nError: Evaluation Error: Error while evaluating a ''[]'' expression, undefined method `value'' for nil:NilClass at line 1:33 on node 10.48.20.37.office.spotify.net\r\nError: Evaluation Error: Error while evaluating a ''[]'' expression, undefined method `value'' for nil:NilClass at line 1:33 on node 10.48.20.37.office.spotify.net\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-2190', 'https://github.com/puppetlabs/puppet/pull/2534', '2014-04-09T09:05:19.000-0700', '2019-04-04T22:31:22.000-0700', '2019-04-04T22:31:22.000-0700', 'Closed', 'future-parser', 6, '0', 1, 14, 2, 3, 'f8e41e0b303f460e6b69e1f8033adf66fb4eec7d'),
('puppet', 19735, 300878715, 7633, 'Too easy to hit "CRL not yet valid for <host>" (and not very informative)', 'Currently we set the CRL time range to start at 1 second in the past:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/a8311df5438601a3394d38e37f671626969d50db/lib/puppet/ssl/certificate_revocation_list.rb#L85\r\n\r\nHowever, this creates a window where an agent with a small amount of clock skew can hit the `CRL not yet valid for <host>` message.  This affects both acceptance tests, which sometimes hit [this condition|https://jenkins.puppetlabs.com/job/Puppet-Package-Acceptance-stable/127/label=acc-coord,platform=precise/consoleText] and [end-users|http://www.jethrocarr.com/2013/10/20/puppet-crl-time-errors/].\r\n\r\nWe should do something about this.  Suggestion here is to: a) bump the 1 second to 1 minute, and b) catch this error message out of OpenSSL and wordsmith it a bit to hint at addressing clock skew.', 'https://tickets.puppetlabs.com/browse/PUP-894', 'https://github.com/puppetlabs/puppet/pull/7633', '2013-11-26T13:54:59.000-0800', '2019-04-04T22:31:22.000-0700', '2019-04-04T22:31:22.000-0700', 'Closed', '', 9, '0', 3, 70, 5, 3, '591bf862ed21ba0cf7339c473f9e6782f106e326'),
('puppet', 20304, 349994741, 7872, 'add support for enumerable type(s) in all iterative functions', 'Currently, only the each function supports iterating over an enumerable type (currently only Integer). Add this support to filter, map, and select as well.', 'https://tickets.puppetlabs.com/browse/PUP-939', 'https://github.com/puppetlabs/puppet/pull/7872', '2013-12-05T10:52:19.000-0800', '2019-04-04T22:31:22.000-0700', '2019-04-04T22:31:22.000-0700', 'Closed', '', 2, '0', 1, 3, 3, 2, '08e490a428acba8f10d81b5f3e09067b8bf0d7cf'),
('puppet', 53661, 25550273, 3386, 'Significant delay in puppet runs with growing numbers of directory environments', 'When using directory environments there appears to be significant lag at the start of a puppet *agent* run whilst the agent startup explores the environment path.\r\n\r\nWith 576 directory environments, each is statted 1159 times during puppet agent startup (one of the stats is opening the environment.conf) - having straced the puppet run:\r\n\r\n{{# grep -c cda_core_0_4_70 puppet.txt}}\r\n{{1160}}\r\n\r\nThis causes significant delay in run startup - circa 20s.\r\n\r\nThe agent also attempts to open an environment.conf in each environment whilst doing this (and I''m not sure this is necessary either) though this only happens 1162 times', 'https://tickets.puppetlabs.com/browse/PUP-3389', 'https://github.com/puppetlabs/puppet/pull/3386', '2014-10-06T07:38:07.000-0700', '2019-04-04T22:31:23.000-0700', '2019-04-04T22:31:23.000-0700', 'Closed', '', 11, '0', 1, 71, 20, 4, 'c19ec229bc73f5c652342c565f691962b037cf9e'),
('puppet', 63031, 28838351, 3582, 'Modify file_bucket_file API to use "application/octet-stream" instead of "text/plain" for Content-Type', 'The Puppet file_bucket_file API -- https://docs.puppetlabs.com/guides/rest_api.html#file-bucket -- requires a PUT request for a file to include a Content-Type of "text/plain".  Puppet agent and file_bucket_file requests through the puppet filebucket CLI face also do not include a charset along with the Content-Type.  Per various industry specifications -- see https://tools.ietf.org/html/rfc6657 in particular -- the default charset that a receiver should assume for this case would be either US-ASCII or ISO-8859-1.  Puppet agent and filebucket CLI face requests, however, currently format the request body as raw "binary data".  This is incompatible with the US-ASCII and ISO-8859-1 formats.\r\n\r\nIn order to make the client''s intentions about the request body encoding more clear, it would be better for clients to include a Content-Type of "application/octet-stream".\r\n\r\n[~josh] suggested that we could create a new format called ":binary", map that to "application/octet-stream", and change file_bucket/file to use it.  Here are some relevant locations in the code where this could be done:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/network/formats.rb#L65\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/file_bucket/file.rb#L16-L27\r\n\r\nDepending upon how we would do this, it may need to be done on a major version boundary.  If the master were upgraded to accept "application/octet-stream" while still treating "text/plain" as "binary" initially, backward compatibility would be preserved.  At some point, though, it may make sense to just break compatibility for "text/plain" on file_bucket/file altogether as the current implementation is ambiguous and not in alignment with industry standards.\r\n\r\nh3.QA:\r\nRisk Assessment: Low?  Issue didn''t reproduce after all.', 'https://tickets.puppetlabs.com/browse/PUP-3812', 'https://github.com/puppetlabs/puppet/pull/3582', '2015-01-06T08:32:19.000-0800', '2019-04-04T22:31:24.000-0700', '2019-04-04T22:31:24.000-0700', 'Resolved', '', 19, '0', 1, 7, 7, 2, 'aea32eae4ed61d8ef900e056ab8061422ef07f75'),
('puppet', 49950, 20839408, 3055, 'Resource titles ending with square brackets fail', 'Hi,\r\n\r\nWe''re trying to install a package but the title has got square brackets which seems to make Puppet blow up, for example:\r\n\r\n  package { "Windows Server AppFabric v1.1 CU4 [KB 2800726]":\r\n    ensure          => installed,\r\n    source          => $fullInstallerPath,\r\n    install_options => $install_options,\r\n  }  \r\n\r\nTrying to run this results in error "invalid tag".  We''ve tried escaping the brackets but that doesn''t work either.\r\n\r\nEven running puppet resource form the command prompt gives an error:\r\n\r\nC:\Program Files (x86)\Puppet Labs\Puppet\bin>puppet resource package\r\nError: Could not run: Invalid tag "microsoft sql server 2005 compact edition "\r\n\r\nThe actual title in control panel for is "microsoft sql server 2005 compact edition [ENU]".  It would seem resource titles with square brackets cause issues.\r\n\r\nIs this is a bug in Puppet?  Can anyone suggest a work around as this kind of renders Puppet not very useful for us without being able to install products.\r\n\r\nPuppet agent 3.4.3\r\n\r\nThanks\r\n\r\nDan\r\n\r\nhttps://groups.google.com/forum/#!searchin/puppet-users/gibbons/puppet-users/Lv61sE-rdQU/r8XTRHU9mgAJ', 'https://tickets.puppetlabs.com/browse/PUP-3177', 'https://github.com/puppetlabs/puppet/pull/3055', '2014-09-03T04:55:50.000-0700', '2019-04-04T22:31:25.000-0700', '2019-04-04T22:31:25.000-0700', 'Closed', 'windows', 8, '0', 1, 12, 4, 2, '6563a6040877469cac3c7902b0220463d2bcf2f6'),
('puppet', 50836, 41180966, 4111, '"{}" in systemd service files cause services to fail to start', 'This prevents systemd from failing to interpret values correctly.  Variables enclosed as "${}" are interpreted by systemd literally.\r\n\r\nexamples\r\n---\r\n"${PUPPETMASTER_EXTRA_OPTS}":\r\n[root@c7 vagrant]# systemctl status puppetmaster\r\npuppetmaster.service - Puppet master\r\n   Loaded: loaded (/usr/lib/systemd/system/puppetmaster.service; disabled)\r\n   Active: failed (Result: exit-code) since Mon 2014-08-25 20:25:02 UTC; 40s ago\r\n  Process: 17658 ExecStart=/usr/bin/puppet master ${PUPPETMASTER_EXTRA_OPTS} --no-daemonize (code=exited, status=1/FAILURE)\r\n Main PID: 17658 (code=exited, status=1/FAILURE)\r\n\r\nAug 25 20:25:02 c7.hubspot.local systemd[1]: Started Puppet master.\r\nAug 25 20:25:02 c7.hubspot.local puppet[17658]: Error: Could not parse application options: invalid option: --config /etc/puppetmaster/puppet-vagrant.conf --logdest /var/log/puppetmaster.log\r\nAug 25 20:25:02 c7.hubspot.local systemd[1]: puppetmaster.service: main process exited, code=exited, status=1/FAILURE\r\nAug 25 20:25:02 c7.hubspot.local systemd[1]: Unit puppetmaster.service entered failed state.\r\n\r\n---\r\n"$PUPPETMASTER_EXTRA_OPTS"\r\n[root@c7 vagrant]# systemctl status puppetmaster\r\npuppetmaster.service - Puppet master\r\n   Loaded: loaded (/usr/lib/systemd/system/puppetmaster.service; disabled)\r\n   Active: active (running) since Mon 2014-08-25 20:26:47 UTC; 4s ago\r\n Main PID: 17873 (puppet)\r\n   CGroup: /system.slice/puppetmaster.service\r\n           └─17873 /usr/bin/ruby /usr/bin/puppet master --config /etc/puppetmaster/puppet-vagrant.conf --logdest /var/log/puppetmaster.log --no-daemonize\r\n\r\nAug 25 20:26:47 c7.hubspot.local systemd[1]: Started Puppet master.', 'https://tickets.puppetlabs.com/browse/PUP-3228', 'https://github.com/puppetlabs/puppet/pull/4111', '2014-09-10T11:50:47.000-0700', '2019-04-04T22:31:26.000-0700', '2019-04-04T22:31:26.000-0700', 'Closed', '', 2, '0', 1, 2, 2, 2, '57f0b8220078f5bea3ba12ccc3c83baed0ddf991'),
('puppet', 283437, 231401585, 7240, 'Text Fragmentation in Exception Message', 'In our localization tool (Transifex), I encountered the following text:\r\n\r\n"Failed to send the %\{control_signal} signal to the service. Its current state is %\{current_state}. Failed with"\r\n\r\n*A localizable string should be a complete phrase.*\r\n\r\nI found the string in puppet.pot and then tracked it to this file:\r\n\r\n[https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/service.rb#L719]\r\n\r\nFrom looking at the code, this text is an exception message.\r\n\r\n--- \r\n\r\nHere are two possible resolutions:\r\n\r\n1) Add placeholder to string "\r\n\r\n"Failed to send the %\{control_signal} signal to the service. Its current state is %\{current_state}. Failed with %\{more_info}"\r\n\r\n2) Remove "Failed with" from the string\r\n\r\n"Failed to send the %\{control_signal} signal to the service. Its current state is %\{current_state}. "\r\n\r\n—\r\n\r\nIf we go with resolution #1, 1 string resource will have to be changed and code will have to be changed (minor).\r\n\r\nIf we go with resolution #2, 2 string resources will have to be changed.\r\n\r\nCan you point me where the exception catcher code is?\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9300', 'https://github.com/puppetlabs/puppet/pull/7240', '2018-11-01T16:24:03.000-0700', '2019-04-04T22:31:26.000-0700', '2019-04-04T22:31:26.000-0700', 'Closed', 'L10n;i18n', 7, '0', 1, 1, 1, 1, 'd061855ebc9a8a07a11e67099cc952175aee2fdc'),
('puppet', 11447, 305637810, 7664, 'Remove the need for the anchor pattern', 'This is basically a duplicate of redmine issue #[8040][1].\n\nPinterest estimated that they spend about 75% of their puppet-related development time trying to work around ordering issues and determinism.  They attribute the majority of that to the "anchor pattern", which is also discussed [here][2].\n\nSite notes detailing Pinterest''s feedback around this and other related issues can be found [here][3] and [here][4].\n\nIf this has already been captured in JIRA, please feel free to mark this as a dupe.\n\n  [1]: http://projects.puppetlabs.com/issues/8040\n  [2]: http://projects.puppetlabs.com/projects/puppet/wiki/Anchor_Pattern\n  [3]: https://sites.google.com/a/puppetlabs.com/main/home/trip-reports/luke-kanies/meetingwithpinterestautoscalingandordering\n  [4]: https://sites.google.com/a/puppetlabs.com/main/home/trip-reports/engineering/20130620pinterest', 'https://tickets.puppetlabs.com/browse/PUP-99', 'https://github.com/puppetlabs/puppet/pull/7664', '2013-06-25T21:52:25.000-0700', '2019-04-04T22:31:26.000-0700', '2019-04-04T22:31:26.000-0700', 'Closed', '', 8, '0', 1, 2, 22, 3, 'f6b77cc25c0998c10cedf54f24baefd3ce69db76'),
('puppet', 25016, 12063789, 2315, 'V2.0 API shows the message body in the Reason-Phrase', 'The v2.0 api is responding to error conditions with the reason phrase in the response (the section after the reason code) containing the full body of the response. The reason phrase is not required to be the standard reason phrase text (such as Not Found for a 404 response), but putting the full body in there is definitely not right.\r\n\r\nI think the correct fix is to just use the standard reason phrases. See http://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html#sec6', 'https://tickets.puppetlabs.com/browse/PUP-1549', 'https://github.com/puppetlabs/puppet/pull/2315', '2014-01-30T11:21:17.000-0800', '2019-04-04T22:31:27.000-0700', '2019-04-04T22:31:27.000-0700', 'Closed', '', 1, '0', 2, 35, 37, 10, '181d56cb8cc15a126b470d0f919b0c9b8ca31eac'),
('puppet', 18209, 25247249, 3359, 'Qualified variable lookups are very slow under Puppet 2.7+ unless prefixed with ::', 'This ticket concerns a performance regression that occurs when variable lookups are qualified as suggested by the [language documentation|http://docs.puppetlabs.com/puppet/3/reference/lang_variables.html#naming]:\r\n\r\n{quote}\r\nQualified variable names are prefixed with the name of their scope and the `::` (double colon) namespace separator. (For example, the `$vhostdir` variable from the `apache::params` class would be `$apache::params::vhostdir`.)\r\n{quote}\r\n\r\nThe regression affects the 3.x and 2.7.x branches of Puppet.\r\n\r\nConsider the following node definitions in `site.pp`:\r\n\r\n{code}\r\nnode badnode {\r\n  include ''tst_lookup::badclass''\r\n}\r\n\r\nnode goodnode {\r\n  include ''tst_lookup::goodclass''\r\n}\r\n{code}\r\n\r\nThese definitions reference a `tst_lookup` module with the following `params` class:\r\n\r\n{code}\r\nclass tst_lookup::params {\r\n  $basedir = ''/tmp/type_collection_tst''\r\n  $user = ''tstusr''\r\n  $ugroup = ''tstugroup''\r\n}\r\n{code}\r\n\r\n`tst_lookup::goodclass` and `tst_lookup::badclass` are defined by ERB templates that generate 1000 file resources each referencing variables in `tst_lookup::params`. `badclass` references the variables in the manner suggested by the docs linked above. `goodclass` adds a leading `::` to the variable references.\r\n\r\n{code}\r\n# badclass.pp.erb\r\nclass tst_lookup::badclass {\r\n  include tst_lookup::params\r\n\r\n  group { "${tst_lookup::params::ugroup}":\r\n    ensure => present,\r\n  }\r\n\r\n  user { "${tst_lookup::params::user}":\r\n    ensure => present,\r\n    gid    => $tst_lookup::params::ugroup,\r\n  }\r\n\r\n  file { "${tst_lookup::params::basedir}":\r\n    ensure  => directory,\r\n    owner   => $tst_lookup::params::user,\r\n    group   => $tst_lookup::params::ugroup,\r\n  }\r\n\r\n<% (1..1000).to_a.each do |i| %>\r\n  file{ "${tst_lookup::params::basedir}/file_<%= i %>":\r\n    ensure  => file,\r\n    content => "This is a test file.\n",\r\n    owner   => $tst_lookup::params::user,\r\n    group   => $tst_lookup::params::ugroup,\r\n    require => File["${tst_lookup::params::basedir}"],\r\n  }\r\n\r\n<% end %>\r\n}\r\n{code}\r\n\r\n{code}\r\n# goodclass.pp.erb\r\nclass tst_lookup::goodclass {\r\n  include tst_lookup::params\r\n\r\n  group { "${::tst_lookup::params::ugroup}":\r\n    ensure => present,\r\n  }\r\n\r\n  user { "${::tst_lookup::params::user}":\r\n    ensure => present,\r\n    gid    => $::tst_lookup::params::ugroup,\r\n  }\r\n\r\n  file { "${::tst_lookup::params::basedir}":\r\n    ensure  => directory,\r\n    owner   => $::tst_lookup::params::user,\r\n    group   => $::tst_lookup::params::ugroup,\r\n  }\r\n\r\n<% (1..1000).to_a.each do |i| %>\r\n  file{ "${::tst_lookup::params::basedir}/file_<%= i %>":\r\n    ensure  => file,\r\n    content => "This is a test file.\n",\r\n    owner   => $::tst_lookup::params::user,\r\n    group   => $::tst_lookup::params::ugroup,\r\n    require => File["${::tst_lookup::params::basedir}"],\r\n  }\r\n\r\n<% end %>\r\n}\r\n{code}\r\n\r\nThese templates can be turned into an actual Puppet manifests via:\r\n\r\n{code}\r\nerb badclass.pp.erb > badclass.pp\r\nerb goodclass.pp.erb > goodclass.pp\r\n{code}\r\n\r\n(A pre-built module is also attached to this ticket.)\r\n\r\n\r\nThe performance characteristics of each class can be observed using the `puppet master --compile` command.\r\n\r\n## 3.x\r\n\r\n{code}\r\n# puppet --version\r\n3.3.1\r\n\r\n# time puppet master --compile badnode 2>&1 | grep ''Compiled catalog for''                                                                     \r\nNotice: Compiled catalog for badnode in environment production in 19.65 seconds\r\n\r\n# puppet master --compile goodnode 2>&1 | grep ''Compiled catalog for''                                                                         \r\nNotice: Compiled catalog for goodnode in environment production in 3.64 seconds\r\n{code}\r\n\r\n## 2.7.x\r\n\r\n{code}\r\n# puppet --version\r\n2.7.23\r\n\r\n# puppet master --compile badnode 2>&1 | grep ''Compiled catalog for''\r\nnotice: Compiled catalog for badnode in environment production in 67.04 seconds\r\n\r\n# puppet master --compile goodnode 2>&1 | grep ''Compiled catalog for''\r\nnotice: Compiled catalog for goodnode in environment production in 4.89 seconds\r\n{code}\r\n\r\n## 2.6.x\r\n\r\n{code}\r\n# puppet --version\r\n2.6.18\r\n\r\n# puppet master --compile badnode 2>&1 | grep ''Compiled catalog for''                                                                          \r\nnotice: Compiled catalog for badnode in environment production in 3.49 seconds\r\n\r\n# puppet master --compile goodnode 2>&1 | grep ''Compiled catalog for''                                                                         \r\nnotice: Compiled catalog for goodnode in environment production in 3.45 seconds\r\n{code}\r\n\r\nThe performance regression appears to be due to the [resolve_namespaces method in typeloader.rb|https://github.com/puppetlabs/puppet/blob/3.3.1/lib/puppet/resource/type_collection.rb#L164-L197]. This method constructs a list of namespaces to search, starting with the local scope and proceeds to add namespace components until it reaches global scope. This method was added in [6b1dd81|https://github.com/puppetlabs/puppet/commit/6b1dd81799a44288287d9ab0cdf46afa3aaf090a] to address #4472 and #4483 --- but the behavior implemented is probably obsolete given the retirement of dynamic scope.\r\n\r\nSome examples of the behavior of `resolve_namespaces` under 3.3.x:\r\n\r\nSearching for {{$::tst_lookup::params}} in {{class tst_lookup::goodclass}} searches {{["tst_lookup::params"]}} and takes ~3 seconds for 4006 variable lookups.\r\n\r\nSearching for {{$tst_lookup::params}} in {{class tst_lookup::badclass}} searches {{["tst_lookup::badclass::tst_lookup::params","tst_lookup::tst_lookup::params","tst_lookup::params"]}} and takes ~20 seconds for 4006 variable lookups.\r\n\r\nSearching for `$tst_lookup::params` in `class tst_lookup::foo::worseclass` searches {{["tst_lookup::foo::worseclass::tst_lookup::params","tst_lookup::foo::tst_lookup::params","tst_lookup::tst_lookup::params","tst_lookup::params"]}} and takes ~33 seconds for 4006 variable lookups.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-659', 'https://github.com/puppetlabs/puppet/pull/3359', '2013-11-04T19:31:29.000-0800', '2019-04-04T22:31:27.000-0700', '2019-04-04T22:31:27.000-0700', 'Closed', 'qa-reviewed;redmine', 20, '0', 8, 152, 284, 25, '16677d5c19fc1777f5d4097b27001d9b3a5eff26'),
('puppet', 225194, 0, 0, 'An "environment" fact will overwrite values from the ENC in Puppet 5', 'Puppet 5 fixed an issue where stale facts were used for catalog requests if a master had a cold cache (PUP-3438 and PUP-7198). The fix was to merge facts submitted by the agent back into the node object instead of pulling facts from the cache. However, the merge is overwriting the environment returned by the ENC, which causes nodes to behave incorrectly if an {{environment}} fact is present.\r\n\r\nh2. Reproduction Case\r\n\r\n - Install PE 2017.3.2.\r\n\r\n - Log into the PE console and verify that the classifier sets the master node environment to {{production}} via the "Production environment" Environment Group.\r\n\r\n - Copy the production environment to a new directory environment called {{facter_env}}:\r\n\r\n{code:bash}\r\ncp -r /etc/puppetlabs/code/environments/production /etc/puppetlabs/code/environments/facter_env\r\nchown -R pe-puppet /etc/puppetlabs/code/\r\n{code}\r\n\r\n - Set {{environment}} and as an external fact:\r\n\r\n{code:bash}\r\nmkdir -p /etc/facter/facts.d\r\n\r\ncat << ''EOF'' > /etc/facter/facts.d/facter_facts.txt\r\nenvironment=facter_env\r\nEOF\r\n{code}\r\n\r\n  - Run {{puppet agent -t}}\r\n\r\nh3. Outcome\r\n\r\nThe agent switches to {{facter_env}} despite the ENC setting:\r\n\r\n{noformat}\r\n[root@pe-201732-master production]# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201732-master.puppetdebug.vlan\r\n\r\nNotice: Local environment: ''production'' doesn''t match server specified environment ''facter_env'', restarting agent run with environment ''facter_env''\r\n\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201732-master.puppetdebug.vlan\r\nInfo: Applying configuration version ''1512410109''\r\nNotice: Applied catalog in 13.11 seconds\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe agent should stay in production:\r\n\r\n{noformat}\r\n[root@pe-201732-master production]# puppet agent -t\r\n\r\nInfo: Using configured environment ''production''\r\n\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201732-master.puppetdebug.vlan\r\nInfo: Applying configuration version ''1512409900''\r\nNotice: Applied catalog in 12.26 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8225', 'https://github.com/puppetlabs/puppet/commit/389953fe6dbc385fbaf7f27c054306bce3f0de75', '2017-12-04T12:14:25.000-0800', '2019-04-04T22:31:28.000-0700', '2019-04-04T22:31:28.000-0700', 'Closed', '', 9, '0', 0, 0, 0, 0, '389953fe6dbc385fbaf7f27c054306bce3f0de75'),
('puppet', 16414, 47686587, 4341, 'NetApp network device failing with Puppet >3.2.1 - "Could not intern..."', '', 'https://tickets.puppetlabs.com/browse/PUP-534', 'https://github.com/puppetlabs/puppet/pull/4341', '2013-10-08T11:20:27.000-0700', '2019-04-04T22:31:28.000-0700', '2019-04-04T22:31:28.000-0700', 'Resolved', '', 0, '0', 3, 35, 9, 3, '85bfe5f8d5e4b0c694c70157be42acb51367d12d'),
('puppet', 119222, 61206212, 4737, 'Systemd  service provider do not support custom status command', 'When use puppet on systems that use systemd to manage services, it''s not able to customize the status checking command. The systemd provider can only use systemctl is-active to check the service status. We need to support the ability to customize status command.\r\n\r\n\r\nFor example, I use puppet to manage ceph service on CentOS7, and I need to use command like `service ceph status mon` to check the service status of ceph monitor. But puppet only use `systemctl is-active mon` to check the service status regardless of the status parameter of service resource in my puppet code:\r\n\r\n\r\n{code:java}\r\nservice {"ceph-mon":\r\n  ensure  => running,\r\n  start   => "service ceph start mon",\r\n  stop    => "service ceph stop mon",\r\n  status  => "service ceph status mon",\r\n}\r\n{code}\r\n\r\nThe status parameter above never work correctly cause systemd provider only use `systemctl is-active` command.\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5992', 'https://github.com/puppetlabs/puppet/pull/4737', '2016-02-29T21:02:14.000-0800', '2019-04-04T22:31:29.000-0700', '2019-04-04T22:31:29.000-0700', 'Closed', '', 1, '0', 1, 20, 15, 2, '848e305b225932f54631786af84386b831fae818'),
('puppet', 49755, 28223068, 3533, 'Fix all file permissions on puppet module install', 'If module with broken file permissions is installed, only directory permissions are fixed. File permissions are just slightly modified. E.g.:\r\n\r\n{noformat}\r\n# puppet module install ceritsc-psacct\r\n{noformat}\r\n\r\nEnds up with fixed mode 755 on directories, but follows 400 (resp. 600) from module archive.\r\n\r\n{noformat}\r\n# ls -la /etc/puppet/modules/psacct/\r\ntotal 36\r\ndrwxr-xr-x. 4 root root 4096 Sep  2 11:20 .\r\ndrwxr-xr-x. 4 root root 4096 Sep  2 13:58 ..\r\n-r--------. 1 root root  296 Sep  2 11:16 CHANGELOG.md\r\n-r--------. 1 root root  571 Sep  2 11:20 checksums.json\r\n-r--------. 1 root root 1115 Jul  9 14:02 LICENSE\r\ndrwxr-xr-x. 2 root root 4096 Nov 12  2013 manifests\r\n-r--------. 1 root root 1152 Sep  2 11:20 metadata.json\r\n-r--------. 1 root root  820 Sep  2 11:20 README.md\r\ndrwxr-xr-x. 2 root root 4096 Jul 15  2013 tests\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3168', 'https://github.com/puppetlabs/puppet/pull/3533', '2014-09-02T05:02:02.000-0700', '2019-04-04T22:31:29.000-0700', '2019-04-04T22:31:29.000-0700', 'Closed', '', 7, '0', 1, 2, 2, 2, '517c3bd249a84afac8b83d91ec748ca4a5ffc635'),
('puppet', 19253, 222612111, 7162, 'Complete implementation of Location handling', 'Location handling is implemented differently in the new parser / evaluator. It does not currently pass this information correctly at the boundary new/3x. \r\n\r\nAlso look at PP-799 that suggests additional improvements to the Location handling. (A performance enhancement as well as support for serialization with preserved location information).\r\n\r\nThe current implementation fakes file/line/position information in certain transitions; look at PopsBridge, and 3x runtime support class.\r\n\r\nThere are very few complete location tests.', 'https://tickets.puppetlabs.com/browse/PUP-800', 'https://github.com/puppetlabs/puppet/pull/7162', '2013-11-20T09:01:06.000-0800', '2019-04-04T22:31:30.000-0700', '2019-04-04T22:31:30.000-0700', 'Closed', '', 2, '0', 1, 3, 1, 1, 'ca3adc4df890f8ec142e785c2a2955ead33dc324'),
('puppet', 78954, 35341698, 3928, 'FreeBSD specific Service provider fix', 'The Service provider for FreeBSD parses the output of ''service foo rcvar'' to work out what the service name is.   However for some services -- only a very few -- the output contains an optional ''description'' field, leading to output like this:\r\n{code}\r\n% service local_unbound rcvar\r\n# local_unbound : local caching forwarding resolver\r\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n#\r\nlocal_unbound_enable="YES"\r\n#   (default: "")\r\n\r\n{code}\r\nleading to the creation of a file whose name has embedded spaces and other syntactically significant stuff which prevents it being loaded by the rc.conf system:\r\n{code}\r\n% ls -1 /etc/rc.conf.d/ \r\nlocal_unbound : local caching forwarding resolver\r\nsnmpd\r\n{code}\r\n\r\nA simple fix is to take just the leading string of non-whitespace characters\r\nfrom the first line of the rcvar output as the service name:\r\n{code}\r\n% diff -u puppet-3.7.5/lib/puppet/provider/service/freebsd.rb{.orig,}\r\n--- puppet-3.7.5/lib/puppet/provider/service/freebsd.rb.orig    2015-03-25 16:32:47.000000000 +0000\r\n+++ puppet-3.7.5/lib/puppet/provider/service/freebsd.rb 2015-05-06 12:33:59.043029246 +0100\r\n@@ -39,7 +39,7 @@\r\n \r\n   # Extract service name\r\n   def service_name\r\n-    extract_value_name(''service'', 0, /# (.*)/, ''\1'')\r\n+    extract_value_name(''service'', 0, /# (\S*).*/, ''\1'')\r\n   end\r\n \r\n   # Extract rcvar name\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-4530', 'https://github.com/puppetlabs/puppet/pull/3928', '2015-05-06T04:38:02.000-0700', '2019-04-04T22:31:30.000-0700', '2019-04-04T22:31:30.000-0700', 'Closed', '', 3, '0', 2, 17, 1, 2, '46647362e57664ea5f5e8f65a3315f4f61602e44'),
('puppet', 76302, 35700968, 3951, 'Service with ''hasstatus => false'' fails', 'The resource:\r\n{code}\r\nservice { ''nullmailer'':\r\n    ensure     => running,\r\n    enable     => true,\r\n    hasstatus  => false,\r\n    hasrestart => true,\r\n    require    => Class[''nullmailer::config''],\r\n  }\r\n{code}\r\n\r\nfails with the following error message:\r\n{code}\r\nError: /Stage[main]/Nullmailer::Service/Service[nullmailer]: Could not evaluate: private method `getpid'' called for #<Puppet::Type::Service::ProviderDebian:0x00000004c74f58>\r\n{code}\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4431', 'https://github.com/puppetlabs/puppet/pull/3951', '2015-04-17T03:42:04.000-0700', '2019-04-04T22:31:30.000-0700', '2019-04-04T22:31:30.000-0700', 'Closed', '', 8, '0', 1, 3, 2, 1, '695d9bbfbbf48e37ed9bdf25c78376ea8e7bc1ed'),
('puppet', 59663, 41285316, 4116, 'puppet cert fingerprint invalidhost returns zero instead of non-zero', '# puppet cert fingerprint notfound; echo $?\r\nError: Could not find certificate for notfound\r\n0\r\n\r\nThis should return 1 or another non-zero exist code since it does not exist.', 'https://tickets.puppetlabs.com/browse/PUP-3694', 'https://github.com/puppetlabs/puppet/pull/4116', '2014-11-24T15:32:21.000-0800', '2019-04-04T22:31:31.000-0700', '2019-04-04T22:31:31.000-0700', 'Closed', '', 2, '0', 1, 6, 5, 2, 'cdff496d2d0e8f5afb5812bcbbcc548922d90160'),
('puppet', 76182, 34510196, 3883, 'Executable external facts broken in 4.0.0: not executable on agent', 'While investigating 3.x->4.x compatibility for SERVER-526 I tried to use an executable external fact, but this did not work in 4.0.0 (it worked in 3.7.5). The file is no longer executable on the agent side, so the agent run spits out a warning saying the fact file was parsed but returned an empty data set.\r\n\r\nWhen looking at the HTTP traffic for my executable external fact file, I see the file_metadata response does in fact specify a different mode between 3.7.5 and 4.0.0.\r\n\r\nBelow you''ll find the request+response for the external fact - notice the {{mode}} is different in the responses.\r\n\r\n{code:title=3.7.5}\r\nREQUEST\r\nGET /production/file_metadatas/pluginfacts?links=manage&recurse=true&ignore=.svn&ignore=CVS&ignore=.git&checksum_type=md5 HTTP/1.1\r\nAccept: pson, msgpack, yaml, b64_zlib_yaml, raw\r\nAccept-Encoding: identity\r\nUser-Agent: Ruby\r\nHost: localhost:8666\r\n\r\nRESPONSE\r\nHTTP/1.1 200 OK \r\nX-Puppet-Version: 3.7.5\r\nContent-Type: text/pson\r\nServer: WEBrick/1.3.1 (Ruby/1.9.3/2014-11-13) OpenSSL/0.9.8za\r\nDate: Tue, 14 Apr 2015 23:49:29 GMT\r\nContent-Length: 696\r\nConnection: Keep-Alive\r\n\r\n[\r\n    {\r\n        "document_type": "FileMetadata",\r\n        "data": {\r\n            "path": "\/Users\/nwolfe\/workspace\/puppetlabs\/conf\/master\/v3\/conf\/modules\/tmpfiles\/facts.d",\r\n            "relative_path": ".",\r\n            "links": "manage",\r\n            "owner": 501,\r\n            "group": 20,\r\n            "mode": 493,\r\n            "checksum": {\r\n                "type": "ctime",\r\n                "value": "{ctime}2015-04-14 16:31:21 -0700"\r\n            },\r\n            "type": "directory",\r\n            "destination": null\r\n        },\r\n        "metadata": {\r\n            "api_version": 1\r\n        }\r\n    },\r\n    {\r\n        "document_type": "FileMetadata",\r\n        "data": {\r\n            "path": "\/Users\/nwolfe\/workspace\/puppetlabs\/conf\/master\/v3\/conf\/modules\/tmpfiles\/facts.d",\r\n            "relative_path": "external_fact_date",\r\n            "links": "manage",\r\n            "owner": 501,\r\n            "group": 20,\r\n            "mode": 493,\r\n            "checksum": {\r\n                "type": "md5",\r\n                "value": "{md5}abec184c543c4dadfa4bf4e70c0b3000"\r\n            },\r\n            "type": "file",\r\n            "destination": null\r\n        },\r\n        "metadata": {\r\n            "api_version": 1\r\n        }\r\n    }\r\n]\r\n{code}\r\n\r\n{code:title=4.0.0}\r\nREQUEST\r\nGET /puppet/v3/file_metadatas/pluginfacts?environment=production&links=follow&recurse=true&ignore=.svn&ignore=CVS&ignore=.git&checksum_type=md5 HTTP/1.1\r\nAccept: pson, msgpack, yaml, binary\r\nX-Puppet-Version: 4.0.0\r\nAccept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\r\nUser-Agent: Ruby\r\nHost: localhost:8666\r\n\r\nRESPONSE\r\nHTTP/1.1 200 OK \r\nX-Puppet-Version: 4.0.0\r\nContent-Type: text/pson\r\nServer: WEBrick/1.3.1 (Ruby/1.9.3/2014-11-13) OpenSSL/0.9.8za\r\nDate: Tue, 14 Apr 2015 23:56:14 GMT\r\nContent-Length: 606\r\nConnection: Keep-Alive\r\n\r\n[\r\n    {\r\n        "path": "\/Users\/nwolfe\/workspace\/puppetlabs\/conf\/master\/v4\/code\/environments\/production\/modules\/tmpfiles\/facts.d",\r\n        "relative_path": ".",\r\n        "links": "follow",\r\n        "owner": 501,\r\n        "group": 20,\r\n        "mode": 420,\r\n        "checksum": {\r\n            "type": "ctime",\r\n            "value": "{ctime}2015-04-14 16:31:21 -0700"\r\n        },\r\n        "type": "directory",\r\n        "destination": null\r\n    },\r\n    {\r\n        "path": "\/Users\/nwolfe\/workspace\/puppetlabs\/conf\/master\/v4\/code\/environments\/production\/modules\/tmpfiles\/facts.d",\r\n        "relative_path": "external_fact_date",\r\n        "links": "follow",\r\n        "owner": 501,\r\n        "group": 20,\r\n        "mode": 420,\r\n        "checksum": {\r\n            "type": "md5",\r\n            "value": "{md5}abec184c543c4dadfa4bf4e70c0b3000"\r\n        },\r\n        "type": "file",\r\n        "destination": null\r\n    }\r\n]\r\n{code}\r\n\r\nI came across some tickets that may be related:\r\n* PUP-3935\r\n* PUP-2705\r\n\r\nI verified this behavior in our newly-released 4.0.0 packages (PC1).\r\n\r\nh3. QA\r\n----\r\nrisk: high (regression)\r\nseverity: high\r\nprobability: high \r\ntest layer: acceptance', 'https://tickets.puppetlabs.com/browse/PUP-4420', 'https://github.com/puppetlabs/puppet/pull/3883', '2015-04-15T18:11:30.000-0700', '2019-04-04T22:31:31.000-0700', '2019-04-04T22:31:31.000-0700', 'Closed', '', 6, '0', 2, 139, 20, 6, '1b9417a8833d9376f1bfe4f98ff42d4df4b28ea0'),
('puppet', 48934, 20201070, 3006, 'Deprecate hidden _timestamp fact', '', 'https://tickets.puppetlabs.com/browse/PUP-3129', 'https://github.com/puppetlabs/puppet/pull/3006', '2014-08-22T13:47:09.000-0700', '2019-04-04T22:31:32.000-0700', '2019-04-04T22:31:32.000-0700', 'Closed', '', 7, '0', 1, 4, 0, 1, '6aece3f75a8b5f9cc1a26b55bc2dba826cb3927a'),
('puppet', 40449, 17729000, 2815, 'Move epp() and inline_epp() to 4x function API', 'The {{epp()}} and {{inline_epp()}} functions must be moved to the 4x function API in order to work correctly. The 3x function API requires transformation of all undef/nils to empty string, and that catalog entry types are transformed to Resource references. This does not work well when these values again emerge in Puppet logic.\r\n\r\nThis also blocks the wanted "call by name" semantics as it is impossible to differentiate between missing values and empty strings.', 'https://tickets.puppetlabs.com/browse/PUP-2845', 'https://github.com/puppetlabs/puppet/pull/2815', '2014-06-26T07:23:30.000-0700', '2019-04-04T22:31:32.000-0700', '2019-04-04T22:31:32.000-0700', 'Closed', '', 4, '0', 7, 205, 29, 11, '0e906c71714c78975788789368e8897910f3839f'),
('puppet', 71488, 31632007, 3742, 'Puppet''s logdir permissions prevent puppetserver service start', 'When a user runs {{puppet apply -e ''notice foo''}} immediately after installing {{puppet-agent}} and before installing {{puppetserver}} the permissions on {{/var/log/puppetlabs}} are silently changed from {{root:root 0755}} to {{root:root 0750}}.\r\n\r\nThis is a problem because once {{puppetserver}} is installed, it cannot start the service because it cannot traverse through {{/var/log/puppetlabs}} into {{/var/log/puppetlabs/puppetserver}}.\r\n\r\nOther information:\r\n\r\n{{:rundir}} is 0755 in defaults.rb which is why we don''t see this here.\r\n\r\nWe also don''t see this in our testing because we don''t run puppet in the space between installing puppet-agent and puppetserver.\r\n\r\nrisk: medium\r\nprobability: medium (only local logfile)\r\nseverity: medium (error, with work-around)\r\ntest layer: acceptance, (package creates file/sets permissions)', 'https://tickets.puppetlabs.com/browse/PUP-4194', 'https://github.com/puppetlabs/puppet/pull/3742', '2015-03-12T16:09:57.000-0700', '2019-04-04T22:31:32.000-0700', '2019-04-04T22:31:32.000-0700', 'Closed', 'AIO', 11, '0', 1, 7, 7, 5, 'f90dfc0706a88a6c9cbbd7768bb08d14bb1542dc'),
('puppet', 14598, 22311276, 3163, ' Functions that require the future parser should be concretely identifiable', '\n\nTake a look at the function reference:\n\nhttp://docs.puppetlabs.com/references/3.latest/function.html\n\nThere are a bunch of functions in there that will just plain explode on a stock Puppet 3.x install. (each, collect, etc.) This is because there’s no indication in these functions'' code that they require the future parser.\n\nWe need an indication of this built into the function API, not only for the sake of documentation but also to improve error handling, etc.\n', 'https://tickets.puppetlabs.com/browse/PUP-335', 'https://github.com/puppetlabs/puppet/pull/3163', '2013-09-12T18:00:05.000-0700', '2019-04-04T22:31:32.000-0700', '2019-04-04T22:31:32.000-0700', 'Closed', '', 8, '0', 4, 26, 60, 9, '7007b6f96ef953dffbf14851b37fdbd388fdc2d7'),
('puppet', 41488, 25306203, 3360, 'Make string/symbol use consistent in new function API', 'The new function API has inconsistent use of string/symbol when parameters are named in the dispatch declaration. We should be using symbols for the parameter names.', 'https://tickets.puppetlabs.com/browse/PUP-2904', 'https://github.com/puppetlabs/puppet/pull/3360', '2014-07-08T04:09:23.000-0700', '2019-04-04T22:31:33.000-0700', '2019-04-04T22:31:33.000-0700', 'Closed', '', 2, '0', 2, 79, 65, 11, '29ff0d2c9153877e1f469b0696230d877d3a31d3'),
('puppet', 10963, 124522772, 5956, 'Resource defaults and automatic tags are applied after collectors are evaluated', 'Automatic tags and resource defaults are applied by the compiler during the [finish stage|https://github.com/puppetlabs/puppet/blob/3.2.0/lib/puppet/parser/compiler.rb#L105] which is executed after the [evaluate_generators stage|https://github.com/puppetlabs/puppet/blob/3.2.0/lib/puppet/parser/compiler.rb#L103] where collectors are evaluated. Additionally, [the step that adds automatic_tags|https://github.com/puppetlabs/puppet/blob/3.2.0/lib/puppet/parser/resource.rb#L246-L250] from parent scopes is not selective at all---it performs a wholesale copy of all tags. Therefore, a notify resource defined inside a class ends up tagged as both a class resource and a notify resource which is probably not the intended behavior as this makes it difficult to use tags to filter by resource type.', 'https://tickets.puppetlabs.com/browse/PUP-22', 'https://github.com/puppetlabs/puppet/pull/5956', '2013-06-17T17:36:39.000-0700', '2019-04-04T22:31:35.000-0700', '2019-04-04T22:31:35.000-0700', 'Closed', 'redmine', 2, '0', 1, 27, 7, 5, 'cd4e69f5dafac33740b6c1d711451f8da169cae3'),
('puppet', 66272, 30894792, 3700, 'Upgrading Puppet package within Puppet agent run on EL7 results in bad package state', 'Under CentOS 7, having the puppet package upgrade under the daemonized instance of the puppet agent results in a broken package state.\r\n\r\nInstallation via manual {{yum update}} or a one-off puppet run (not the daemonized agent) works fine, but when the update operation occurs within the daemonized puppet run, systemd seems to squash the running agent along with its {{yum}} process - the update never fully cleans up the old package, both are left showing as installed, and puppet keeps unsuccessfully trying to upgrade the old package.\r\n\r\nManual:\r\n{code}\r\n[root@test ~]# rpm -qa | grep puppet\r\npuppet-3.7.3-1.el7.noarch\r\n[root@test ~]# yum update puppet-3.7.4\r\n...\r\nResolving Dependencies\r\n--> Running transaction check\r\n---> Package puppet.noarch 0:3.7.3-1.el7 will be updated\r\n---> Package puppet.noarch 0:3.7.4-1.el7 will be an update\r\n...\r\nRunning transaction\r\n  Updating   : puppet-3.7.4-1.el7.noarch                                                                                                                             1/2\r\n  Cleanup    : puppet-3.7.3-1.el7.noarch                                                                                                                             2/2\r\n  Verifying  : puppet-3.7.4-1.el7.noarch                                                                                                                             1/2\r\n  Verifying  : puppet-3.7.3-1.el7.noarch                                                                                                                             2/2\r\n\r\nUpdated:\r\n  puppet.noarch 0:3.7.4-1.el7\r\n\r\nComplete!\r\n[root@test ~]# rpm -qa | grep puppet\r\npuppet-3.7.4-1.el7.noarch\r\n{code}\r\n\r\nOne-off:\r\n{code}\r\n[root@test ~]# rpm -qa | grep puppet\r\npuppet-3.7.3-1.el7.noarch\r\n[root@test ~]# puppet apply -e "package { "puppet": ensure => latest }"\r\n...\r\n[root@test ~]# rpm -qa | grep puppet\r\npuppet-3.7.4-1.el7.noarch\r\n{code}\r\n\r\nWithin daemonized agent (syslog):\r\n{code}\r\nJan 30 20:04:29 test systemd: Starting Puppet agent...\r\nJan 30 20:04:29 test systemd: Started Puppet agent.\r\nJan 30 20:04:31 test puppet-agent[3016]: Starting Puppet client version 3.7.3\r\nJan 30 20:04:34 test puppet-agent[3023]: The package type''s allow_virtual parameter will be changing its default value from false to true in a future release. If you do not want to allow virtual packages, please explicitly set allow_virtual to false.\r\nJan 30 20:04:34 test puppet-agent[3023]: (at /usr/share/ruby/vendor_ruby/puppet/type/package.rb:430:in `block (3 levels) in <module:Puppet>'')\r\nJan 30 20:04:51 test systemd: Reloading.\r\nJan 30 20:04:51 test yum[3442]: Updated: puppet-3.7.4-1.el7.noarch\r\nJan 30 20:04:51 test systemd: Stopping Puppet agent...\r\nJan 30 20:04:51 test puppet-agent[3023]: Caught TERM; calling stop\r\nJan 30 20:04:51 test puppet-agent[3016]: Caught TERM; calling stop\r\nJan 30 20:04:51 test systemd: Starting Puppet agent...\r\nJan 30 20:04:51 test systemd: Started Puppet agent.\r\nJan 30 20:04:53 test puppet-agent[3517]: Starting Puppet client version 3.7.4\r\nJan 30 20:04:56 test puppet-agent[3527]: The package type''s allow_virtual parameter will be changing its default value from false to true in a future release. If you do not want to allow virtual packages, please explicitly set allow_virtual to false.\r\nJan 30 20:04:56 test puppet-agent[3527]: (at /usr/share/ruby/vendor_ruby/puppet/type/package.rb:430:in `block (3 levels) in <module:Puppet>'')\r\nJan 30 20:05:12 test puppet-agent[3527]: Could not update: Execution of ''/usr/bin/yum -d 0 -e 0 -y install puppet-3.7.4-1.el7'' returned 1: There are unfinished transactions remaining. You might consider running yum-complete-transaction, or "yum-complete-transaction --cleanup-only" and "yum history redo last", first to finish them. If those don''t work you''ll have to try removing/installing packages by hand (maybe package-cleanup can help).\r\nJan 30 20:05:12 test puppet-agent[3527]:\r\nJan 30 20:05:12 test puppet-agent[3527]:\r\nJan 30 20:05:12 test puppet-agent[3527]: Transaction check error:\r\nJan 30 20:05:12 test puppet-agent[3527]: package puppet-3.7.4-1.el7.noarch is already installed\r\nJan 30 20:05:12 test puppet-agent[3527]:\r\nJan 30 20:05:12 test puppet-agent[3527]: Error Summary\r\nJan 30 20:05:12 test puppet-agent[3527]: -------------\r\nJan 30 20:05:12 test puppet-agent[3527]: Wrapped exception:\r\nJan 30 20:05:12 test puppet-agent[3527]: Execution of ''/usr/bin/yum -d 0 -e 0 -y install puppet-3.7.4-1.el7'' returned 1: There are unfinished transactions remaining. You might consider running yum-complete-transaction, or "yum-complete-transaction --cleanup-only" and "yum history redo last", first to finish them. If those don''t work you''ll have to try removing/installing packages by hand (maybe package-cleanup can help).\r\nJan 30 20:05:12 test puppet-agent[3527]:\r\nJan 30 20:05:12 test puppet-agent[3527]:\r\nJan 30 20:05:12 test puppet-agent[3527]: Transaction check error:\r\nJan 30 20:05:12 test puppet-agent[3527]: package puppet-3.7.4-1.el7.noarch is already installed\r\nJan 30 20:05:12 test puppet-agent[3527]:\r\nJan 30 20:05:12 test puppet-agent[3527]: Error Summary\r\nJan 30 20:05:12 test puppet-agent[3527]: -------------\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure) change from 3.7.3-1.el7 to 3.7.4-1.el7 failed: Could not update: Execution of ''/usr/bin/yum -d 0 -e 0 -y install puppet-3.7.4-1.el7'' returned 1: There are unfinished transactions remaining. You might consider running yum-complete-transaction, or "yum-complete-transaction --cleanup-only" and "yum history redo last", first to finish them. If those don''t work you''ll have to try removing/installing packages by hand (maybe package-cleanup can help).\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure)\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure)\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure) Transaction check error:\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure)   package puppet-3.7.4-1.el7.noarch is already installed\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure)\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure) Error Summary\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Install/Package[puppet]/ensure) -------------\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Service/Service[puppet]) Dependency Package[puppet] has failures: true\r\nJan 30 20:05:12 test puppet-agent[3527]: (/Stage[main]/Puppet_client::Service/Service[puppet]) Skipping because of failed dependencies\r\nJan 30 20:05:13 test puppet-agent[3527]: Finished catalog run in 11.66 seconds\r\n\r\n[root@test ~]# rpm -qa | grep puppet\r\npuppet-3.7.4-1.el7.noarch\r\npuppet-3.7.3-1.el7.noarch\r\n{code}\r\n\r\nI think the behavior under the old init scripts was to TERM just PID 3016 above and not also 3023, which seems to be what''s causing the problem.', 'https://tickets.puppetlabs.com/browse/PUP-3931', 'https://github.com/puppetlabs/puppet/pull/3700', '2015-01-30T12:41:45.000-0800', '2019-04-04T22:31:35.000-0700', '2019-04-04T22:31:35.000-0700', 'Closed', '', 9, '0', 1, 1, 0, 1, '6609c9a65ffbe94e5e3b5f184da1092d95a54eb9'),
('puppet', 22435, 0, 0, 'dynamic variable lookup works in templates', 'Summary: \r\n\r\nFrom within templates, dynamic lookup of variables seems to work. I can declare a variable in the init.pp file. It shows up as undefined in the configuration.pp file. But then it will work fine within the templates created by configuration.pp. \r\n\r\nSteps to Reproduce: \r\n\r\nI''ve created a github repo with a simple module that shows off the issue. Basically its just creating a dynamic lookup variable in a template though, nothing special. \r\nhttps://github.com/rbirnie/puppet_scope_bug\r\n\r\nExpected Results:\r\n\r\nThe variable should return undef which is what the manifests return.\r\n\r\nActual Results:\r\n\r\nThe variable returns the value that is assigned.\r\n\r\nNotes:\r\nBoth agent and master are puppet 3.2.2', 'https://tickets.puppetlabs.com/browse/PUP-1220', 'https://github.com/puppetlabs/puppet/commit/c54a95d74162a5fa4b756b6fc8479eaab5ff0318', '2013-12-21T16:18:05.000-0800', '2019-04-04T22:31:36.000-0700', '2019-04-04T22:31:36.000-0700', 'Closed', 'redmine', 6, '0', 0, 0, 0, 0, 'c54a95d74162a5fa4b756b6fc8479eaab5ff0318'),
('puppet', 34608, 16271284, 2689, 'Remove support to search for Type in String', 'The idea to support search for Type in String with the rationale that if String is an array of characters, then any slice of that string is also a String, and thus searching for a substring with matching types should be allowed.\r\n\r\nThe implementation does this now, but not in a comprehensive way, and does not support string length, pattern, variant etc.\r\n\r\nInstead of trying to add support for this support for searching for types in String should be removed.', 'https://tickets.puppetlabs.com/browse/PUP-2514', 'https://github.com/puppetlabs/puppet/pull/2689', '2014-05-07T13:16:06.000-0700', '2019-04-04T22:31:36.000-0700', '2019-04-04T22:31:36.000-0700', 'Closed', '', 3, '0', 1, 2, 9, 2, 'ba826de9d56af5913e0eb3d29626faa21f944dd6'),
('puppet', 57763, 24249655, 3300, 'Environments::Cached#get! bypasses the environment cache.', 'Cached subclasses Combined and calls Combind#get! which implements in terms of its loaders get calls, bypassing Cached#get entirely.  Just need to implement Cached#get! as Cached#get or raise EnvironmentNotFound.', 'https://tickets.puppetlabs.com/browse/PUP-3621', 'https://github.com/puppetlabs/puppet/pull/3300', '2014-11-05T09:45:31.000-0800', '2019-04-04T22:31:37.000-0700', '2019-04-04T22:31:37.000-0700', 'Closed', '', 5, '0', 1, 136, 3, 3, 'ec6b48d7ac856b8efed6e074beb5ea75d8d95ef5'),
('puppet', 28273, 0, 0, 'EPP - Error when trying to report argument error in inline_epp', 'If the {{inline_epp}} function is passed an incorrect type in the first position it errors with an "undefined local variable or method":\r\n{noformat}\r\n> be puppet apply -e "notice(inline_epp(1))" --parser future\r\nError: Evaluation Error: Error while evaluating a Function Call, undefined local variable or method `file'' for Puppet::Pops::Evaluator::EppEvaluator:Class at line 1:8 on node aparker.corp.puppetlabs.net\r\nError: Evaluation Error: Error while evaluating a Function Call, undefined local variable or method `file'' for Puppet::Pops::Evaluator::EppEvaluator:Class at line 1:8 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nIf it is given a parameter of the wrong type in the second position it gives an error about an undefined constant:\r\n{noformat}\r\n> be puppet apply -e "notice(inline_epp(''<%= 1 %>'', 1))" --parser future\r\nError: Evaluation Error: Error while evaluating a Function Call, uninitialized constant Puppet::Pops::Evaluator::EppEvaluator::ArgumentException at line 1:8 on node aparker.corp.puppetlabs.net\r\nError: Evaluation Error: Error while evaluating a Function Call, uninitialized constant Puppet::Pops::Evaluator::EppEvaluator::ArgumentException at line 1:8 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nIn both cases I would expect an error specifically calling out the incorrect type.', 'https://tickets.puppetlabs.com/browse/PUP-1898', 'https://github.com/puppetlabs/puppet/commit/12849b5c21809f87d5779aab2929f3b580e6510b', '2014-03-07T16:49:58.000-0800', '2019-04-04T22:31:38.000-0700', '2019-04-04T22:31:38.000-0700', 'Closed', '', 4, '0', 0, 0, 0, 0, '12849b5c21809f87d5779aab2929f3b580e6510b'),
('puppet', 38210, 16858783, 2748, 'Reserved keywords conflict with resource type parameters', 'The words "function", "type", and "attr" are now reserved and produce warnings in the current parser and errors in the future parser. However, "type" conflicts with the "type" parameter on the ssh_authorized_key resource type. This means that under the future parser you can''t fully use that type, or any others that happen to have a "type", "function", or "attr" parameters.\r\n\r\nThis isn''t consistent with other keywords in the language such as "class". You can create a class that has a parameter named "class" and use it.\r\n\r\nI think the new keywords should be handled in the same way and not limit the allowed parameter names.', 'https://tickets.puppetlabs.com/browse/PUP-2727', 'https://github.com/puppetlabs/puppet/pull/2748', '2014-06-04T11:41:02.000-0700', '2019-04-04T22:31:41.000-0700', '2019-04-04T22:31:41.000-0700', 'Closed', '', 4, '0', 1, 619, 577, 3, '4646e50b42c0938b644f56b121b042bcf8587aab'),
('puppet', 28298, 13363329, 2426, 'Multiple paths in --modulepath command line option not parsed', 'In Puppet 3.4 and earlier, multiple paths could be supplied with the --modulepath option, but as of PUP-1765, there has been a regression and they no longer work.\r\n\r\n{noformat}\r\n$ git co 3.4.3\r\nNote: checking out ''3.4.3''.\r\n$ bin/puppet apply --modulepath /tmp:/tmp/test/ --noop -e ''include ntp''\r\nNotice: Compiled catalog for cobalt.redhat.com in environment production in 0.76 seconds\r\nNotice: /Stage[main]/Ntp/Package[ntp]/ensure: current_value absent, should be present (noop)\r\nNotice: /Stage[main]/Ntp/File[/etc/ntp.conf]/ensure: current_value absent, should be present (noop)\r\nNotice: /Stage[main]/Ntp/File[/etc/sysconfig/ntpd]/ensure: current_value absent, should be present (noop)\r\nNotice: /Stage[main]/Ntp/Service[ntpd]/ensure: current_value stopped, should be running (noop)\r\nNotice: Class[Ntp]: Would have triggered ''refresh'' from 4 events\r\nNotice: Stage[main]: Would have triggered ''refresh'' from 1 events\r\nNotice: Finished catalog run in 0.99 seconds\r\n{noformat}\r\n\r\n{noformat}\r\n$ git co master\r\nPrevious HEAD position was bbe30e0... (packaging) Update PUPPETVERSION to 3.4.3\r\nSwitched to branch ''master''\r\n$ bin/puppet apply --modulepath /tmp:/tmp/test/ --noop -e ''include ntp''\r\nError: Could not find class ntp for cobalt.redhat.com on node cobalt.redhat.com\r\nError: Could not find class ntp for cobalt.redhat.com on node cobalt.redhat.com\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1905', 'https://github.com/puppetlabs/puppet/pull/2426', '2014-03-10T02:03:26.000-0700', '2019-04-04T22:31:42.000-0700', '2019-04-04T22:31:42.000-0700', 'Closed', '', 2, '0', 1, 10, 1, 2, '0a09175f4dab9e733cf25fecdcbc3346e048ba8c'),
('puppet', 36534, 19812208, 2971, 'Running the puppet agent against a nonexistent environment produces an overly verbose error message.', 'When the puppet agent is run against a Puppet master using a nonexistent environment, the agent fails and prints an error message with the associated URL from the REST terminus. When the URL contains POST parameters, the resulting error is extremely verbose and produces about 50 or more lines of output. This is harmful from a user perspective because it produces a large amount of output that doesn''t contribute to the explanation of the error. This was introduced as part of PUP-2214.\r\n\r\nSteps to reproduce:\r\n\r\nSet up a master with this puppet.conf:\r\n\r\n{code}\r\n[master]\r\nenvironmentpath = $confdir/environments\r\n{code}\r\n\r\nRun an agent against a garbage environment name, and step well back.', 'https://tickets.puppetlabs.com/browse/PUP-2631', 'https://github.com/puppetlabs/puppet/pull/2971', '2014-05-21T09:54:32.000-0700', '2019-04-04T22:31:43.000-0700', '2019-04-04T22:31:43.000-0700', 'Closed', '', 4, '0', 1, 39, 7, 2, 'baebf7bf588db1636d52970401dfa01442eb31f1'),
('puppet', 25343, 13013889, 2393, 'New Parser does not handle hyphenated barewords', 'The current parser/evaluator handles hyphenated bare words such as {{hi-there}}. The new parser and evaluator chokes on these, and tries to interpret them as numeric expressions of subtraction.\r\n\r\nWorks on current parser:\r\n{noformat}\r\n[16:08:41][Ruby(ruby-1.9.3-p448)][Git(pr/2320)] andy:puppet\r\n> be puppet apply -e ''notify { hi-there: }''\r\nNotice: Compiled catalog for aparker.corp.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: hi-there\r\nNotice: /Stage[main]/Main/Notify[hi-there]/message: defined ''message'' as ''hi-there''\r\nNotice: Finished catalog run in 0.03 seconds\r\n{noformat}\r\n\r\nNew evaluator shows that it is checking that the left and right operands of the {{-}} operator are numeric:\r\n{noformat}\r\n[16:08:05][Ruby(ruby-1.9.3-p448)][Git(pr/2320)] andy:puppet\r\n> be puppet apply -e ''notify { hi-there: }'' --parser future\r\nError: Evaluation Error: The value ''hi'' cannot be converted to Numeric. at line 1:10 on node aparker.corp.puppetlabs.net\r\nError: Evaluation Error: The value ''hi'' cannot be converted to Numeric. at line 1:10 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nThe current evaluator is passed it as a numeric expression as well.\r\n{noformat}\r\n[16:08:13][Ruby(ruby-1.9.3-p448)][Git(pr/2320)] andy:puppet\r\n> be puppet apply -e ''notify { hi-there: }'' --parser future --evaluator current\r\nError: left operand of - is not a number at line 1 on node aparker.corp.puppetlabs.net\r\nWrapped exception:\r\nleft operand of - is not a number\r\nError: left operand of - is not a number at line 1 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nIt appears that the new parser is tokenizing the hyphenated bare word as something like {{IDENTIFIER, SUBTRACT, IDENTIFIER}} where the old parser is seeing it as simply {{IDENTIFIER}}. ', 'https://tickets.puppetlabs.com/browse/PUP-1576', 'https://github.com/puppetlabs/puppet/pull/2393', '2014-02-03T16:19:34.000-0800', '2019-04-04T22:31:45.000-0700', '2019-04-04T22:31:45.000-0700', 'Closed', '', 4, '0', 1, 31, 4, 2, '6fc7d2509dd54b215d3e8583c685c2ccd5530d07'),
('puppet', 15157, 37225536, 4017, 'File ignore and pluginsync pluginignore not being respected.', 'Details are in Redmine #22652.  This is filed against 3.3.1-rc1.  Kylo and I have tried to reproduce without success, and have accessed for and received some more information.', 'https://tickets.puppetlabs.com/browse/PUP-413', 'https://github.com/puppetlabs/puppet/pull/4017', '2013-09-24T20:17:20.000-0700', '2019-04-04T22:31:45.000-0700', '2019-04-04T22:31:45.000-0700', 'Resolved', '', 1, '0', 1, 1, 1, 1, 'ebf4a2e221e7ad7c634e190945b88d02ba044e29'),
('puppet', 50181, 74738566, 5047, 'puppet catalog download fails', '1) Install master and agent\r\n2) Execute {{puppet catalog download}}\r\n3) Get inscrutable failure\r\n\r\n{code}\r\ntesthost 08:58:48$  env PATH="/opt/puppet/bin:${PATH}" RUBYLIB="${RUBYLIB}" puppet catalog download    \r\nError: Could not call ''save'' on ''catalog'': Instance name "testhost.us-west-2.compute.internal" does not match requested key {}\r\nError: Could not call ''save'' on ''catalog'': Instance name "testhost.us-west-2.compute.internal" does not match requested key {}\r\nError: Try ''puppet help catalog download'' for usage\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3182', 'https://github.com/puppetlabs/puppet/pull/5047', '2014-09-04T09:04:19.000-0700', '2019-04-04T22:31:45.000-0700', '2019-04-04T22:31:45.000-0700', 'Closed', '', 8, '0', 1, 17, 4, 3, '8ab50eb0a64a628bcd69418e216c7f1af94d007f'),
('puppet', 24554, 28278093, 3539, 'When compiling a catalog, providers should be loaded from specified environment', 'When compiling a catalog, types and providers are validated, but while Puppet will load types from the agent''s environment, it only loads providers from the compiling master''s default environment (production). \r\n\r\nThis is a problem because the method that creates the {{provider}} parameter is sometimes called due to code in the *provider,* not the type. If a custom resource type only exists in a non-default environment, and you declare a resource that specifies a value for the {{provider}} attribute, this can cause an {{invalid parameter provider}} error.\r\n\r\nThe expected behavior is that Puppet will autoload types and providers from the agent''s environment.\r\n\r\n----\r\n\r\noriginal description:\r\nIn Puppet 3 I am getting an error on all definitions for custom types.  It says "Error 400 on SERVER: Invalid parameter provider...".  Provider should be a given parameter for custom types because otherwise there is no way to specify which provider should be used with it.  This is potentially a very major bug.  Please let me know how I can help so you''re able to reproduce and fix the issue.\r\n\r\n----\r\n\r\nFinal resolution: When validating resources during catalog compilation, Puppet will load types and providers from the environment that the catalog is being compiled for. (Modulo that other bug that causes cross-environment contamination.)', 'https://tickets.puppetlabs.com/browse/PUP-1515', 'https://github.com/puppetlabs/puppet/pull/3539', '2014-01-24T14:29:11.000-0800', '2019-04-04T22:31:46.000-0700', '2019-04-04T22:31:46.000-0700', 'Closed', 'redmine', 49, '0', 1, 8, 8, 2, 'f50880a14bebb1313a0565d5391e0069ec02fbb3'),
('puppet', 21598, 863889278, 8886, 'No longer allows variables with leading underscores', 'It appears that puppet 3.4 has changed the rules for allowed variable names. A variable with a leading underscore (e.g. {{$_last}}), now results in an error.\r\n\r\nhttps://github.com/puppetlabs/puppetlabs-apache/pull/540', 'https://tickets.puppetlabs.com/browse/PUP-1144', 'https://github.com/puppetlabs/puppet/pull/8886', '2013-12-17T10:26:36.000-0800', '2019-04-04T22:31:47.000-0700', '2019-04-04T22:31:47.000-0700', 'Closed', '', 10, '0', 1, 40, 5, 2, 'c2446db0605038fa390a46f09c882e3e8a47a42c'),
('puppet', 20482, 0, 0, 'Correct Type System Flaws', 'The Pattern type is not correctly specified and implemented. Halfway through the implementation its semantics were changed from having\r\nAND semantics for each given pattern to OR. (It is far more useful to use the type as a pattern-based enum type that to have it be a combination of\r\nmultiple patterns). The type calculator does the right thing when combining two Pattern types (i.e. it performs an | operation of the patterns as sets), but\r\nthe assignable implementation checks all? patterns against all`values, it should be all? values against any? pattern match.\r\n\r\nAlso, Pattern currently only accepts String and Literal Regexp, but should also for the sake of completeness support Regex Type, and Pattern.\r\n\r\nPattern should also be assignable by an Enum, if all? of the enum strings match any? of the patterns. \r\n\r\nThe implementation of {code}instance?(o){code} is also too simplistic as it is based on inference of generic types. This makes it impossible to answer more\r\ndetailed questions about type. Something like {code}[1,a] =~ Array[Variant[Integer, String]]{code} does not work as expected since the type of the array\r\nelement is reduced by combination of String / Integer into Literal. This in itself is not wrong, only inconvenient when using types for input data checking. \r\n', 'https://tickets.puppetlabs.com/browse/PUP-954', 'https://github.com/puppetlabs/puppet/commit/07abcba280b4edc19d304dbdeeabbe1525716755', '2013-12-06T17:41:33.000-0800', '2019-04-04T22:31:49.000-0700', '2019-04-04T22:31:49.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, '07abcba280b4edc19d304dbdeeabbe1525716755'),
('puppet', 47029, 19524764, 2952, 'Typemanager wastes CPU cycles with global scope defined types', 'Defined type defined in a global scope will make MetaType::Manager go through all known code locations (modules, gems, loadpaths, etc) looking for that_type.rb\r\n\r\nThat combined with a fact that code locations are not cached makes puppet slow when working with large repositories.\r\n\r\nI''m preparing 2 PRs related to this issue.', 'https://tickets.puppetlabs.com/browse/PUP-3038', 'https://github.com/puppetlabs/puppet/pull/2952', '2014-08-08T05:32:30.000-0700', '2019-04-04T22:31:50.000-0700', '2019-04-04T22:31:50.000-0700', 'Closed', '', 14, '0', 1, 18, 4, 2, ''),
('puppet', 52391, 69104039, 4945, 'Puppet apply breaks when an ENC returns an environment', 'Given the following ENC script (/tmp/enc)\r\n{code}\r\n#!/bin/sh\r\necho ''classes: []''\r\necho ''environment: production''\r\n{code}\r\nand two manifests\r\n 1. a manifest to apply (/tmp/manifest.pp)\r\n {code}\r\nnotify { ''it works'': }\r\n {code}\r\n 2. a pseudo site-manifest (/tmp/site.pp)\r\n {code}\r\nnotify { ''FAIL'': }\r\n {code}\r\n\r\nInvoking {{puppet apply}} in the following fashion should print "itworks", but does not.\r\n{noformat}\r\n$ bundle exec puppet apply /tmp/manifest.pp --node_terminus exec --external_nodes /tmp/enc --manifest /tmp/site.pp \r\n...\r\nNotice: FAIL\r\n{noformat}\r\n\r\n--\r\nSummary\r\n\r\nPreviously, if the master was configured to use an ENC, and the ENC returned an environment for a node, then {{puppet apply manifest.pp}} would apply the catalog from that environment instead of the manifest specified on the command line.\r\n\r\nNow, {{puppet apply manifest.pp}} will use the specified manifest from the command line, even if the ENC returns an environment.\r\n----\r\nh3. QA Risk Analysis\r\n|Risk Level|High (a broken apply can break production)|\r\n|Probability|High (it seems highly likely an ENC will return an envrionment)|\r\n|Severity|Medium ({{puppet apply}} should work)|\r\n|Test Level|Acceptance (crosses component boundaries)|', 'https://tickets.puppetlabs.com/browse/PUP-3341', 'https://github.com/puppetlabs/puppet/pull/4945', '2014-09-24T16:51:41.000-0700', '2019-04-04T22:31:50.000-0700', '2019-04-04T22:31:50.000-0700', 'Closed', 'commandline', 25, '0', 1, 87, 35, 2, '39bdac0dca6d75fa091f248830a4ab9e1f14ebcc'),
('puppet', 39455, 0, 0, 'Incorrect EPP syntax in epp() function documentation', 'The current docs for {{epp()}} show the parameter declaration syntax as {{<%\-( parameters )\-%>}}. The real syntax uses pipes ({{|}}) instead of parentheses ({{(}}).', 'https://tickets.puppetlabs.com/browse/PUP-2791', 'https://github.com/puppetlabs/puppet/commit/d87faf13c39ca6c51a4283e0317e11dfb3dfe856', '2014-06-17T10:13:31.000-0700', '2019-04-04T22:31:50.000-0700', '2019-04-04T22:31:50.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, 'd87faf13c39ca6c51a4283e0317e11dfb3dfe856'),
('puppet', 22325, 41308485, 4118, 'Custom reports not working (Class is already defined in Puppet::Reports)', 'I''ve got a client experiencing this with the boundary report from https://github.com/puppetlabs/puppetlabs-boundary\r\n\r\nAlso someone in #puppet said they get it with the datadog report in Puppet 3.0.\r\n\r\nHere''s the full message we get at the end of the run:\r\n\r\nerr: Could not send report: Error 400 on SERVER: Could not autoload boundary: Class Boundary is already defined in Puppet::Reports', 'https://tickets.puppetlabs.com/browse/PUP-1189', 'https://github.com/puppetlabs/puppet/pull/4118', '2013-12-19T09:22:46.000-0800', '2019-04-04T22:31:52.000-0700', '2019-04-04T22:31:52.000-0700', 'Closed', 'redmine;reports', 8, '0', 1, 10, 1, 2, '38db3609945c3c189b4c5ff77c9cdc077267fddf'),
('puppet', 21355, 402508540, 8091, 'Puppet lacks a proper "undefined" value', '    $y = undef\r\n    notice($y == "")  # true\r\n    notice($x == $y)  # true\r\n    notice($x == "")  # true\r\n\r\nRecent changes in the Puppet DSL made equality commutative (good!), but in doing so broke work-arounds for actually testing for the difference between an undefined and "empty" value.  The most logical fix would be to equate Puppet''s `undef` with Ruby''s `nil`.', 'https://tickets.puppetlabs.com/browse/PUP-1037', 'https://github.com/puppetlabs/puppet/pull/8091', '2013-12-16T03:00:41.000-0800', '2019-04-04T22:31:53.000-0700', '2019-04-04T22:31:53.000-0700', 'Closed', 'redmine', 1, '0', 2, 55, 44, 4, 'c57ee591df99829c41396cc15bfafa4f2a910ed4'),
('puppet', 46000, 19534856, 2953, 'puppet parser validate shouldn''t puke on exported resources', '{code}\r\n[root@master /etc/puppetlabs/puppet/modules/hosts]# puppet parser validate manifests/init.pp\r\nWarning: You cannot collect exported resources without storeconfigs being set; the collection will be ignored on line 25 in file /etc/puppetlabs/puppet/modules/hosts/manifests/init.pp\r\n{code}\r\n\r\nThis kinda makes {{puppet parser validate}} really non user friendly.', 'https://tickets.puppetlabs.com/browse/PUP-2994', 'https://github.com/puppetlabs/puppet/pull/2953', '2014-07-30T16:46:24.000-0700', '2019-04-04T22:31:55.000-0700', '2019-04-04T22:31:55.000-0700', 'Closed', 'future-parser', 12, '0', 1, 11, 5, 3, '20f32b5be6743e076861a4a62bda5569fe1d1ffe'),
('puppet', 37212, 16391093, 2699, 'Trailing commas should be allowed in node definitions', 'Trailing commas are allowed on parametrized classes, node definitions should have the same behaviour.\r\n\r\nA comma after c should be allowed.\r\n\r\n{code}\r\nnode a, b, c, { }\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-2682', 'https://github.com/puppetlabs/puppet/pull/2699', '2014-05-27T12:02:45.000-0700', '2019-04-04T22:31:56.000-0700', '2019-04-04T22:31:56.000-0700', 'Closed', 'future-parser', 6, '0', 1, 566, 559, 3, '7f8bce19a7da3f39b714110058b2a226246c7b6a'),
('puppet', 19250, 144251419, 6251, 'New Evaluator does not cache parse results', 'The new evaluator does not cache parse result; everything is reparsed on every request.\r\n\r\nIn the previous version the "future parser" also used an instance of the "old parser" to perform imports and to handle caching of parse results.\r\n\r\nThis was obviously inefficient and was removed. The support for caching should be added. It should however not be implemented in the actual parser - the new e4 parser adapter is probably the right place.\r\n\r\nThe problem is worse. Since the layer above assume that once it has parsed a file, it only needs to be checked if it is in the cache of "watched files". ', 'https://tickets.puppetlabs.com/browse/PUP-798', 'https://github.com/puppetlabs/puppet/pull/6251', '2013-11-20T08:31:41.000-0800', '2019-04-04T22:31:57.000-0700', '2019-04-04T22:31:57.000-0700', 'Closed', '', 2, '0', 1, 1, 0, 1, '6b5b08bd1b3f555519704f192b1c3198b99d5ecd'),
('puppet', 21532, 0, 0, 'Deprecate environment configuration in puppet.conf', 'There''s a confusing overload between the config stanzas in puppet.conf, some of which are used for run-mode-specific configuration and others for environments. ', 'https://tickets.puppetlabs.com/browse/PUP-1114', 'https://github.com/puppetlabs/puppet/commit/02e00ae5dc775e4a6b8d104f3947c1a54701b645', '2013-12-16T17:25:58.000-0800', '2019-04-04T22:31:58.000-0700', '2019-04-04T22:31:58.000-0700', 'Closed', 'redmine', 6, '0', 0, 0, 0, 0, '02e00ae5dc775e4a6b8d104f3947c1a54701b645'),
('puppet', 41114, 18129749, 2853, 'Periodic timeouts when reading from master', 'Periodically, there are failures where the agent performs a pluginsync, a number of files are downloaded from the master, and eventually one of the files hangs, timeouts, and causes the pluginsync to abort.', 'https://tickets.puppetlabs.com/browse/PUP-2885', 'https://github.com/puppetlabs/puppet/pull/2853', '2014-07-02T15:02:45.000-0700', '2019-04-04T22:31:59.000-0700', '2019-04-04T22:31:59.000-0700', 'Closed', '', 11, '0', 2, 8, 32, 2, 'e21a7b9022f6ac9ffe8182e42cbc12f9be521581'),
('puppet', 25361, 12172618, 2326, 'Rename Literal Type to Scalar', 'The type named "Literal" should be renamed to "Scalar" since it is not limited to literal data entered in source, but also to created "non literal" results.', 'https://tickets.puppetlabs.com/browse/PUP-1579', 'https://github.com/puppetlabs/puppet/pull/2326', '2014-02-04T02:01:49.000-0800', '2019-04-04T22:31:59.000-0700', '2019-04-04T22:31:59.000-0700', 'Closed', '', 1, '0', 1, 97, 97, 10, '424ce15ece1eca7acb87038d838290111d151577'),
('puppet', 32312, 15080979, 2570, 'New evaluator does not properly handle resource defaults', 'Resource defaults in the new evaluator appear to not be working for defined resource types.\r\n\r\n{code:title=Testing manifest}\r\ndefine testing::thing($msg = ''param default'') {\r\n  notify { ''name'': message => $msg }\r\n}\r\n\r\nTesting::Thing  {\r\n    msg => ''resource default''\r\n}\r\n\r\ntesting::thing { ''name'': }\r\n{code}\r\n\r\nIf the above code is run with the new evaluator, then it will output {{param default}} rather than the expected {{resource default}}.\r\n{code:title=Incorrect message when using new evaluator}\r\n> be puppet apply t.pp --parser future --evaluator future\r\nWarning: Could not retrieve fact fqdn\r\nNotice: Compiled catalog for aparker in environment production in 0.41 seconds\r\nNotice: param default\r\nNotice: /Stage[main]/Main/Testing::Thing[name]/Notify[name]/message: defined ''message'' as ''param default''\r\nNotice: Finished catalog run in 0.04 seconds\r\n{code}\r\n\r\nSimply changing to use the old evaluator gets the expected output.\r\n{code:title=Correct message when using old evaluator}\r\n> be puppet apply t.pp --parser future --evaluator current\r\nWarning: Could not retrieve fact fqdn\r\nNotice: Compiled catalog for aparker in environment production in 0.41 seconds\r\nNotice: resource default\r\nNotice: /Stage[main]/Main/Testing::Thing[name]/Notify[name]/message: defined ''message'' as ''resource default''\r\nNotice: Finished catalog run in 0.05 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-2302', 'https://github.com/puppetlabs/puppet/pull/2570', '2014-04-18T09:57:31.000-0700', '2019-04-04T22:32:04.000-0700', '2019-04-04T22:32:04.000-0700', 'Closed', '', 4, '0', 1, 22, 2, 2, '7fb506f79dc4505d528a61db9579bb5de182661b'),
('puppet', 39711, 17481149, 2792, '4x logging functions does not include container', 'The logging functions (notice, error, etc) were modified in future evaluator to use the new function API and the new loaders. In the new implementation, it was missed that the old (i.e. current) functions also output the name of the calling container (i.e. the "resource" owning the scope).\r\n\r\nFirst - do we want it to continue working the same way? (And if so, is it always the point in the call chain that is contained in a class / define that should be displayed?)', 'https://tickets.puppetlabs.com/browse/PUP-2807', 'https://github.com/puppetlabs/puppet/pull/2792', '2014-06-18T16:17:09.000-0700', '2019-04-04T22:32:05.000-0700', '2019-04-04T22:32:05.000-0700', 'Closed', '', 3, '0', 1, 17, 1, 2, '9f6d97a1f03fc54fa4c0ce43efb41a5983e0b37d'),
('puppet', 25206, 12109372, 2322, 'PR (2322) Module tool rechecks for conflicts for each installed module', 'resolve_install_conflicts causes a very long (edited from "endless") recursion because the recursion loop is inside the modules_by_path iterator causing each module and dependency to be checked for conflict once for each module that is installed. With a tree of dependencies and mearly dozens of previously installed modules, this walk can take hours.\r\n\r\nSince I can''t see any reason for the same module to be checked against the same list of installed modules as many times as there are modules installed, I believe the recursion call should be moved outside of the modules_by_path iterator loop.', 'https://tickets.puppetlabs.com/browse/PUP-1563', 'https://github.com/puppetlabs/puppet/pull/2322', '2014-01-31T15:59:53.000-0800', '2019-04-04T22:32:05.000-0700', '2019-04-04T22:32:05.000-0700', 'Closed', '', 3, '0', 1, 1, 2, 1, '218e0f1cab521763168f0e7a65b04c6759ec4b62'),
('puppet', 28857, 0, 0, 'Relationships with Classes in future parser broken', 'With future parser the following fails:\r\n\r\n{code}\r\nClass[foo] -> Class[bar]\r\n{code}\r\n\r\ndue to an unknown variable.\r\n\r\nThe problem is fixed on master: a3bf8f1 (PR-2438), and should be cherry picked to stable.', 'https://tickets.puppetlabs.com/browse/PUP-1962', 'https://github.com/puppetlabs/puppet/commit/1ea83842d3cb8c801b07de1d0f6336df69067e2c', '2014-03-17T10:15:53.000-0700', '2019-04-04T22:32:07.000-0700', '2019-04-04T22:32:07.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, '1ea83842d3cb8c801b07de1d0f6336df69067e2c'),
('puppet', 49895, 20838249, 3054, 'After enabling directory environments the manifestdir setting is still required to be valid', 'PE gives a stack trace if the manifestdir does not exist.  When setting up directory environments we recommend moving the $confdir/manifest folder into your environment which is guaranteed to break your install.  \r\n\r\nhttps://docs.puppetlabs.com/puppet/latest/reference/environments.html\r\n\r\nSteps to reproduce:\r\n\r\n1. Install PE3.3 on your platform of choice ( customer had Ubuntu 12.04, I tried centos 6.4) \r\n2. Edit {{puppet.conf}}\r\n - add {{environmentpath = /etc/puppetlabs/puppet/environments}}\r\n\r\n3. {{mkdir -p /etc/puppetlabs/puppet/environments/production}}\r\n4. {{service pe-httpd restart}}\r\n5. Complete a successful {{puppet agent -t}} run\r\n6. {{mv /etc/puppetlabs/puppet/manifests/ /etc/puppetlabs/puppet/environments/production/}}\r\n7. {{service pe-httpd restart}}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3174', 'https://github.com/puppetlabs/puppet/pull/3054', '2014-09-02T15:57:51.000-0700', '2019-04-04T22:32:08.000-0700', '2019-04-04T22:32:08.000-0700', 'Closed', 'customer;support', 6, '0', 1, 16, 1, 2, '7a0a93701b42ce200baa5e5124bdbca506d38e23'),
('puppet', 25410, 0, 0, 'Puppet module tool should work with new directory environments', 'Given two environments, a legacy environment ''legacyenv'' defined in puppet.conf and a ''direnv'' directory in the established $environmentdir, `puppet module install --environment <env>` will respect the legacy environment but not the directory environment.  This probably needs to be fixed for all the module functions, but I haven''t tested everything yet.', 'https://tickets.puppetlabs.com/browse/PUP-1584', 'https://github.com/puppetlabs/puppet/commit/6a5600f8c0906331f64a93ea407938ab2498e2ca', '2014-02-04T10:52:59.000-0800', '2019-04-04T22:32:08.000-0700', '2019-04-04T22:32:08.000-0700', 'Closed', '', 10, '0', 0, 0, 0, 0, '6a5600f8c0906331f64a93ea407938ab2498e2ca'),
('puppet', 46667, 62616762, 4786, 'Puppet doesn''t like to evaluate ''require => [ [], [] ],''', 'Sometimes you might want to programmatically decide upon a resources requries, viz:\r\n\r\n{code}\r\nsomeresource {''mynam'':\r\n   require => $flag ? { true => Another_resource[''name''], false => []},\r\n}\r\n{code}\r\n\r\nThis works ok until you have lists on the RHS of the require line.\r\n\r\nThis works ok:\r\n\r\n{code}\r\nsomeresource {''mynam'':\r\n   require => [$flag_a ? { true => Resource_a[''name_a''], false => []},],\r\n}\r\n{code}\r\n\r\nBut this does not:\r\n\r\n{code}\r\nsomeresource {''mynam'':\r\n   require => [\r\n              $flag_a ? { true => Resource_a[''name_a''], false => []},\r\n              $flag_b ? { true => Resource_b[''name_b''], false => []},\r\n              ],\r\n}\r\n{code}\r\n\r\nWhy? When {{$flag_a}} AND {{$flag_b}} are both false this reduces to:\r\n\r\n{code}\r\nsomeresource {''mynam'':\r\n   require => [ [], [] ],\r\n}\r\n{code}\r\n\r\nAnd puppet does not like this.\r\n\r\nTo recap: require => [[]], is fine but require => [[],[]], is not.\r\n\r\nAlso: {{require => [ [] , SomeResource[''name''] ]}}, is OK too. As is : {{require => [ [] , SomeResource[''name''], [] ],}}, this is OK.\r\n\r\nConfused yet?\r\n\r\nYou might think that the rule is "don''t have [],[] in a require". but you''d be wrong this stanza works fine:\r\n\r\n{code}\r\nrequire => [ [] , SomeResource[''name''], [], [] ],\r\n{code}\r\n\r\nThe error messages puppet client creates is :\r\n\r\n{noformat}\r\nError: Failed to apply catalog: Parameter require failed on Exec[xxxxxx]: No title provided and [] is not a valid resource reference at /etc/puppet/......:##\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3018', 'https://github.com/puppetlabs/puppet/pull/4786', '2014-08-06T01:34:04.000-0700', '2019-04-04T22:32:10.000-0700', '2019-04-04T22:32:10.000-0700', 'Closed', '', 9, '0', 3, 36, 8, 3, '91759f7c4484e6dcf535d92c17569c5a40063464'),
('puppet', 26253, 12683422, 2369, 'Puppet config print respects legacy but not directory environments', 'Puppet config print and --configprint respect only legacy environments if specified.\r\n\r\nFor example:\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ cat ~/.puppet/puppet.conf \r\n[legacy]\r\nmodulepath=/home/jpartlow/work/tmp/envs/legacy\r\n\r\njpartlow@percival:~/work/puppet$ tree ~/.puppet/environments/\r\n/home/jpartlow/.puppet/environments/\r\n└── direnv\r\n    └── modules\r\n\r\n2 directories, 0 files\r\n{code}\r\n\r\nthen\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ be puppet agent --configprint modulepath\r\n/home/jpartlow/.puppet/modules:/usr/share/puppet/modules\r\njpartlow@percival:~/work/puppet$ be puppet agent --configprint modulepath --environment legacy\r\n/home/jpartlow/work/tmp/envs/legacy\r\n{code}\r\n\r\nbut\r\n\r\n{code}\r\njpartlow@percival:~/work/puppet$ be puppet agent --configprint modulepath --environment direnv\r\n/home/jpartlow/.puppet/modules:/usr/share/puppet/modules\r\n{code}\r\n\r\nbecause in https://github.com/puppetlabs/puppet/blob/master/lib/puppet/settings.rb#L1049-L1070 expects to find environment settings in a legacy puppet.conf section as provided by searchpath(environment).\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1676', 'https://github.com/puppetlabs/puppet/pull/2369', '2014-02-12T13:51:24.000-0800', '2019-04-04T22:32:12.000-0700', '2019-04-04T22:32:12.000-0700', 'Closed', '', 3, '0', 1, 102, 6, 5, '5d7ff323279e5c33b4c2715c99076c2e0c28fdd5'),
('puppet', 25029, 13646210, 2439, 'V2.0 API reports Not Authorized as a "RUNTIME_ERROR"', 'When requesting a path from the v2.0 api, which the client does not have permission, the {{issue_kind}} shows as a {{RUNTIME_ERROR}}. It doesn''t seem like that should be classified in that way. I would expect {{RUNTIME_ERROR}} to be reserved for unexpected situations.', 'https://tickets.puppetlabs.com/browse/PUP-1552', 'https://github.com/puppetlabs/puppet/pull/2439', '2014-01-30T12:17:07.000-0800', '2019-04-04T22:32:12.000-0700', '2019-04-04T22:32:12.000-0700', 'Closed', '', 4, '0', 1, 5, 2, 2, '2e5aa02160f6d74b34a131ba2904c716ca45c528'),
('puppet', 36577, 16182591, 2685, 'Type type is not an Object', 'It seemed to be a good idea to make the Type type not be an Object, but this creates difficulties when a type is needed for "anything" as it has to be written as Optional[Variant[Type, Object]], which is a horrible construct to begin with, and it will be shown in error messages for all untyped since it has to be the default for accepting anything.\r\n\r\nThe simple fix is to make Type a subtype of Object.', 'https://tickets.puppetlabs.com/browse/PUP-2632', 'https://github.com/puppetlabs/puppet/pull/2685', '2014-05-21T11:53:26.000-0700', '2019-04-04T22:32:14.000-0700', '2019-04-04T22:32:14.000-0700', 'Closed', '', 5, '0', 2, 48, 14, 4, 'd78ea2f11ba9ace812b0c90d45fb1086866e0fb3'),
('puppet', 22729, 11159452, 2206, 'ruby_manifest_spec does not test everything properly', 'Steps to reproduce:\r\n\r\n1. Modify spec/integration/parser/ruby_manifest_spec.rb, test "should be properly reloaded when stale", so that Puppet[:filetimeout] would be set to a high value (e.g. 1000) instead of current -1.\r\n2. Run spec tests\r\n3. Check the result\r\n\r\nExpected result: The test fails as the file should be cached and obsolete notice should be present in the output.\r\n\r\nActual result: The test succeeds.\r\n\r\nIt means that the test as it stands today is useless, not actually checking the expected functionality.', 'https://tickets.puppetlabs.com/browse/PUP-1321', 'https://github.com/puppetlabs/puppet/pull/2206', '2013-12-31T05:22:49.000-0800', '2019-04-04T22:32:15.000-0700', '2019-04-04T22:32:15.000-0700', 'Closed', '', 4, '0', 1, 11, 15, 1, ''),
('puppet', 34992, 18048592, 2844, 'parameter lookup produces screwy result for default values', 'When the future parser "lookup resource parameter" evaluates and there is no parameter value set by the evaluated manifest logic at that point, the evaluator then looks up the default value for that parameter.\r\n\r\nThis unfortunately looks up the default value as seen from the perspective of the "lookup resource parameter" scope/context, and not the context in which the resource was defined. Thus, the evaluator will produce a "lie" in every other context except the one where the resource was defined.\r\n\r\nThis is unacceptable.\r\n\r\nThere are different ways to solve this:\r\n\r\n*  Do not ever lookup default (rationale: we don''t know what the value ending up in the catalog will be until it is actually computed *at the end of the compilation* when no more user logic will be evaluated).\r\n* Do the same kind of lookup as the compiler does (rationale: provides the best knowledge about what the value probably will end up being if nothing else is evaluated that affects the outcome, which by the way is the best the parameter lookup can achieve at any point throughout the evaluation).\r\n\r\nThe ''do not provide defaults'' may seem harsh, but it is far better than producing erroneous/misleading results. \r\n\r\nStory points of 2 reflects attempting to do the more difficult option (lookup in correct scope). Suggest attempting that, but if that does not work out with a cap on time, then skip looking up default.', 'https://tickets.puppetlabs.com/browse/PUP-2532', 'https://github.com/puppetlabs/puppet/pull/2844', '2014-05-12T09:40:33.000-0700', '2019-04-04T22:32:15.000-0700', '2019-04-04T22:32:15.000-0700', 'Closed', '', 10, '0', 1, 24, 1, 2, '9ecde51d1d536bd8c2a49d3f5e4047bac53a5502'),
('puppet', 28981, 13718261, 2448, 'future parser doesn''t accept empty array as title', 'When passed an empty array the future parser ends up giving an unhelpful error message {{Error: Evaluation Error: Group[] accepts 1 argument. Got 0 on node super-secret-foo}}\r\n\r\n{noformat}\r\n/usr/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:19:in `fail''\r\n/usr/lib/ruby/vendor_ruby/puppet/pops/evaluator/access_operator.rb:443:in `access_PResourceType''\r\n/usr/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:74:in `visit_this_2''\r\n/usr/lib/ruby/vendor_ruby/puppet/pops/evaluator/access_operator.rb:25:in `access''\r\n/usr/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:484:in `eval_AccessExpression''\r\n/usr/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:64:in `visit_this_1''\r\n{noformat}\r\n\r\nThe current parser accepts an empty array as an argument to Group (I have no idea what it does with it though, probably ignores it).', 'https://tickets.puppetlabs.com/browse/PUP-1978', 'https://github.com/puppetlabs/puppet/pull/2448', '2014-03-18T10:41:42.000-0700', '2019-04-04T22:32:16.000-0700', '2019-04-04T22:32:16.000-0700', 'Closed', '', 4, '0', 1, 28, 9, 3, '92ae79c1c798887be858c5445b44eceba7cf25bd'),
('puppet', 31005, 14456147, 2512, 'Directory Environments breaks many classic Config File Environments', 'If you use the script in the classic blog post http://puppetlabs.com/blog/git-workflow-and-puppet-environments you have Config File Environments located at /etc/puppet/environments.  Unfortunately, Puppet 3.5.0 will treat them as Directory Environments.  If you have a modulepath such as this:\r\n\r\n{noformat}\r\n  modulepath=/etc/puppet/environments/$environment/modules:/etc/puppet/environmentss/$environment/services:/etc/puppet/environments/$environment/forge\r\n{noformat}\r\n\r\nit will not be used.  You have to move your environments someplace else.\r\n\r\nIt is a pity that Puppet 3.5.0 reused the proposed location from that blog post.  The transition would have been less painful if another location had been used.\r\n\r\nFailing that, it would have been less painful if the resolution order had been Config File Enviroment -> DIrectory Environment -> global environment.\r\n\r\nAt the very least, this should be mentioned in the release note and on http://docs.puppetlabs.com/puppet/3.5/reference/environments.html.  It was a bit hard to find the resultion order deep down in http://docs.puppetlabs.com/puppet/3.5/reference/environments_classic.html#interaction-with-directory-environments.', 'https://tickets.puppetlabs.com/browse/PUP-2158', 'https://github.com/puppetlabs/puppet/pull/2512', '2014-04-04T06:02:28.000-0700', '2019-04-04T22:32:16.000-0700', '2019-04-04T22:32:16.000-0700', 'Closed', '', 12, '0', 3, 131, 109, 42, 'eb640cb6d654ffe0df02b6c4e7b839647d4cd488');
