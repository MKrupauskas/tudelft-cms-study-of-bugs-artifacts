INSERT INTO `bugs_fixes_filtered` (`system`, `issue_id`, `pull_request_id`, `number`, `title`, `body`, `issue_url`, `pull_request_url`, `created_at`, `closed_at`, `updated_at`, `state`, `labels`, `comments`, `comments_url`, `commits`, `additions`, `deletions`, `changed_files`, `commits_data`) VALUES
('puppet', 25687, 28346908, 3542, 'functions accepting regexp string should also accept Regexp', 'Functions (e.g. split) that accepts a regular expression in string form\r\nshould also accept an already created regular expression, or the PRegexpType from which a regular expression can be obtained.', 'https://tickets.puppetlabs.com/browse/PUP-1601', 'https://github.com/puppetlabs/puppet/pull/3542', '2014-02-06T09:47:07.000-0800', '2019-04-04T22:32:16.000-0700', '2019-04-04T22:32:16.000-0700', 'Closed', 'docs_reviewed', 5, '0', 1, 279, 274, 8, '65a6806a6db3c7797b1a5981d64e99c66fdcd904'),
('puppet', 36865, 17623050, 2810, 'label provider for class/define should capitalize all segments', 'When the label provider produces a label for a define/class etc. all segments of the name should be capitalized. The label is shown in error messages.\r\n\r\nReproduce with:\r\n{code}\r\nnotice Type[Foo::Bar::Fee]\r\n{code}\r\n\r\nWhich displays:\r\n{code}\r\nType[Foo::bar::fee]\r\n{code}\r\nwhen it should have been\r\n{code}\r\nType[Foo::Bar::Fee]\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-2654', 'https://github.com/puppetlabs/puppet/pull/2810', '2014-05-23T09:13:08.000-0700', '2019-04-04T22:32:17.000-0700', '2019-04-04T22:32:17.000-0700', 'Closed', '', 3, '0', 1, 10, 2, 2, 'dc8bb1230379411221b7e586151b1745be0336c7'),
('puppet', 38806, 18410280, 2873, 'Apply parses everything twice', 'When the runtime creates {{Puppet::Resource}} instances, an attempt is made to lookup its type. This means that code will attempt to lookup the type in {{known_resource_types}}. If {{known_resource_type}} is nil, the runtime will issue a call to {{initial_import}} which is the starting point of parsing and evaluating code.\r\n\r\nThe {{Puppet::Resource#envronment}} method attempts to figure out which environment to use (since that hold on to {{known_resource_type}} by looking at the resource instance''s catalog''s environment. The problem is when resource instances are created for the purpose of acting as a reference to a resource (rather than the instance itself), since such references are never contained in a Catalog per se. The {{environment}} method used a synthetic environment called {{NONE}} internally, and when {{NONE}} is not initialized the {{initial_import}} ill be called to again perform parsing.\r\n\r\nThis is fixed in this commit: https://github.com/hlindberg/puppet/commit/3ab10bc6ffe724a204e0fd2d1df0e651c9d93d66\r\n\r\nas part of PUP-2714, where this problem was detected.\r\n\r\nCurrently, the fix is is part of https://github.com/puppetlabs/puppet/pull/2749\r\n\r\nBut the issue is serious enough to warrant this ticket. There is a strong suspicion that the behavior also can cause leakage into the NONE environment (one env leaking into another). It is also probably worse for directory based environments since there is no file watching, and thus parsing never skips files when asked to parse them.\r\n\r\nNot sure what the right action here is except simply correcting the faulty behavior as per the PR-2749. Longer term, the notion of resource references requiring access to their type is something we want to get rid off.', 'https://tickets.puppetlabs.com/browse/PUP-2757', 'https://github.com/puppetlabs/puppet/pull/2873', '2014-06-11T13:27:41.000-0700', '2019-04-04T22:32:18.000-0700', '2019-04-04T22:32:18.000-0700', 'Closed', '', 10, '0', 2, 15, 7, 4, '886fa035d861063ba4de07b1b4d06d8af48c1a6c'),
('puppet', 15957, 305409874, 7663, '(PR) (#4506) Don''t serialize transient vars in Puppet::Resource', 'When serializing Ruby objects to YAML, Procs may be serialized that\r\ncannot be deserialized. Given the following example:\r\n\r\nYAML.load(YAML.dump lambda { "hi" })\r\nA TypeError is raised with the message "allocator undefined for Proc".\r\n\r\nCommit e161cbc introduced a new instance variable to Puppet::Resource,\r\n@rstype, which was the serialized resource_type for the given object.\r\nWhen a Puppet::Resource object was round tripped from YAML the\r\ndeserialization would fail with the above TypeError. Using Puppet''s\r\nbuilt in deserialization (EG Puppet::Resource.convert_from(''yaml'', serialized_data))\r\nwould work, but directly parsing the YAML would fail.\r\n\r\nTo resolve this an explicit list of instance variables is specified for\r\nserialization, so instead of trying to serialize everything we only\r\nserialize the things we need.\r\n\r\nThis supersedes GH-1868.', 'https://tickets.puppetlabs.com/browse/PUP-447', 'https://github.com/puppetlabs/puppet/pull/7663', '2013-10-01T12:25:47.000-0700', '2019-04-04T22:32:20.000-0700', '2019-04-04T22:32:20.000-0700', 'Closed', '', 3, '0', 1, 15, 11, 2, 'f6f9c6d5d7378e0cd9e84657168a6fd3a7d389e6'),
('puppet', 10959, 192775358, 6866, 'File bucket and Puppet File resource: fails with "regexp buffer overflow" when backing up binary file', 'File contents are transferred to and from filebuckets as raw un-encoded bytes in a one element JSON hash. Aside from being inefficient for large files, transmitting unencoded binary in this fashion will croak the JSON parser.\n\n_NOTE:_ There is a trivial fix for this issue, which is to base-64 encode filebucket contents during transfer. However this change will break compatibility between agents and masters.', 'https://tickets.puppetlabs.com/browse/PUP-19', 'https://github.com/puppetlabs/puppet/pull/6866', '2013-06-17T17:30:26.000-0700', '2019-04-04T22:32:21.000-0700', '2019-04-04T22:32:21.000-0700', 'Closed', 'redmine', 1, '0', 24, 337, 378, 71, '0a09175f4dab9e733cf25fecdcbc3346e048ba8c'),
('puppet', 35977, 16015614, 2664, 'Rack masters lose track of environment loaders', 'When a puppet master is running under rack the first few seconds of running will cause it to use the wrong modules if the {{[main]}} section has a different {{modulepath}} (or {{environmentpath}}) from the {{[master]}} section.\r\n\r\nReproduction:\r\n\r\nGiven a rack master with the following puppet.conf:\r\n{code}\r\n[main]\r\nmodulepath = /tmp/main-modules\r\n[master]\r\nmodulepath = /tmp/master-modules\r\n{code}\r\n\r\nInstall {{puppetlabs-stdlib}} into the {{/tmp/main-modules}} directory:\r\n{code}\r\n> puppet module install puppetlabs-stdlib\r\n{code}\r\n\r\nRestart the apache master (this is the command if you installed the puppetmaster-passenger package for debian):\r\n{code}\r\n> service apache2 restart\r\n{code}\r\n\r\nRun the agent:\r\n{code}\r\n> puppet agent -t\r\n{code}\r\n\r\nActual outcome:\r\n\r\nThe agent will run and start to download the stdlib functions as part of pluginsync. Part way through downloading it will start failing to fetch files with the reason that the files don''t exist.\r\n\r\nExpected outcome:\r\n\r\nThe agent shouldn''t pluginsync anything because the master''s modulepath doesn''t include any modules.', 'https://tickets.puppetlabs.com/browse/PUP-2610', 'https://github.com/puppetlabs/puppet/pull/2664', '2014-05-16T16:32:51.000-0700', '2019-04-04T22:32:21.000-0700', '2019-04-04T22:32:21.000-0700', 'Closed', '', 4, '0', 1, 113, 24, 5, '6cd1969598463f73fc26cf400d40cb3943a708b8'),
('puppet', 12630, 13718261, 2448, 'optional bindings does not work for autoloaded bindings', 'The binding schemes that makes use of the autoloader does not correctly handle optionality as they need to know if something will be loaded or not.\r\n\r\nThis could either be implemented by:\r\n\r\n - querying the autoloader if it will be able to load something (without actually loading), \r\n - performing early loading, stashing the result until it is being used (it may be excluded later so this is wasteful.\r\n - make the optionality carry through to the resolution phase (now optionality is checked when URIs are expanded and the effective set of included - excluded is processed.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-197', 'https://github.com/puppetlabs/puppet/pull/2448', '2013-07-30T09:28:44.000-0700', '2019-04-04T22:32:22.000-0700', '2019-04-04T22:32:22.000-0700', 'Closed', 'needs_decision', 4, '0', 1, 28, 9, 3, 'ea1a04bef489bd193e3f3cfaeb5d0e6fdd142682'),
('puppet', 55003, 27508186, 3491, 'Blocks validate parameters incorrectly', 'h1. Problem\r\nThe following validation fails:\r\n\r\n{code}\r\nwith({ 1 => a, 2 => b }) |Hash[Integer, String] $x| { $x }\r\n{code}\r\n\r\nand produces the error:\r\n\r\n{noformat}\r\nError: Evaluation Error: Error while evaluating a Function Call, lambda called with mis-matched arguments\r\nexpected:\r\n  lambda(Hash[Integer, String] x) - arg count {1}\r\nactual:\r\n  lambda(Hash[Variant[Integer, Integer], Variant[String, String]]) - arg count {1} at /Users/andy/work/puppet/t.pp:7:1 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nHowever, an analogous type declaration for a {{define}} works:\r\n\r\n{code}\r\ndefine a(Hash[Integer, String] $x) {\r\n}\r\n\r\na { testing: x => { 1 => a, 2 => b } }\r\n{code}\r\n\r\nh2. Expected\r\n\r\nBoth of these cases should work in the same way. Either that has *is* a {{Hash[Integer, String]}} or it isn''t.\r\n\r\nh1. Analysis\r\n\r\nUpon investigation, it turns out that the way EPP and blocks have parameters validated are different. {{define}} and {{class}} validation is done by calling {{Puppet::Pops::Types::TypeCalculator.instance?}} whereas the block validation is done by constructing a {{Callable}} of the given values, having a {{Callable}} of the declared types, and using {{Puppet::Pops::Types::TypeCalculator.callable?}}. The {{callable?}} method then delegates to {{Puppet::Pops::Types::TypeCalculator.assignable?}}.\r\n\r\nThe {{assignable?}} and {{instance?}} implementations are completely separate. They appear to have several places where the answers can diverge.  The above example is just one case.', 'https://tickets.puppetlabs.com/browse/PUP-3461', 'https://github.com/puppetlabs/puppet/pull/3491', '2014-10-14T12:29:35.000-0700', '2019-04-04T22:32:24.000-0700', '2019-04-04T22:32:24.000-0700', 'Closed', '', 15, '0', 1, 37, 8, 2, 'cc90b5436c80a1a9f87de7931066d23a14d9a5f4'),
('puppet', 27626, 0, 0, 'Deprecate referencing classes with an initial capital letter', 'Classes that are referenced with {{Class[Foo]}} creates an ambiguity in the grammar because {{Foo}} is a reference to a type {{foo}}. This prevents properly handling the class references as expressions. We need to deprecate this and only allow {{Class[foo]}} as a reference to the class named {{foo}}.', 'https://tickets.puppetlabs.com/browse/PUP-1810', 'https://github.com/puppetlabs/puppet/commit/ab1ced75d22474b710c446e13fa4d79ed48ed32f', '2014-02-27T17:53:28.000-0800', '2019-04-04T22:32:24.000-0700', '2019-04-04T22:32:24.000-0700', 'Resolved', '', 3, '0', 0, 0, 0, 0, 'ab1ced75d22474b710c446e13fa4d79ed48ed32f'),
('puppet', 52964, 22035517, 3136, 'Attempt to use Numeric as title in a Resource type causes internal error', 'When an attempt is made to reference a resource and using a numeric title, the error messages that is emitted is "Cannot use Fixnum where String is expected" - which is technically correct, but it could be much more informative.\r\n\r\nThis is the result of doing something like:\r\n{code}\r\nFile[3]\r\nResource[sometype, 42]\r\n{code}\r\n\r\nA more specific error message should be used "A Resource title cannot be numeric" and with a proper reference to the source location.', 'https://tickets.puppetlabs.com/browse/PUP-3364', 'https://github.com/puppetlabs/puppet/pull/3136', '2014-09-29T16:35:06.000-0700', '2019-04-04T22:32:25.000-0700', '2019-04-04T22:32:25.000-0700', 'Closed', '', 3, '0', 2, 9, 16, 3, '13faa18fc5b774c540f5a368dc4ed165d061827d'),
('puppet', 37482, 60993158, 4729, 'deprecate that defining a class twice "merges" their behaviors', 'A new hire ([~erin]) is working through exercises and inadvertently defined a class twice in a file with surprising results.\r\n\r\n{code}\r\nclass test {\r\n  notice(''testing'')\r\n  notify { ''first'': }\r\n}\r\n\r\nclass test {\r\n  notice(''again'')\r\n  notify { ''surprise!'': }\r\n}\r\n\r\ninclude test\r\n{code}\r\n\r\n{code}\r\n[root@student ~]# puppet apply test.pp\r\nNotice: Scope(Class[Test]): testing\r\nNotice: Scope(Class[Test]): again\r\nNotice: Compiled catalog for student.puppetlabs.vm in environment production in 0.04 seconds\r\nNotice: surprise!\r\nNotice: /Stage[main]/Test/Notify[surprise!]/message: defined ''message'' as ''surprise!''\r\nNotice: first\r\nNotice: /Stage[main]/Test/Notify[first]/message: defined ''message'' as ''first''\r\nNotice: Finished catalog run in 0.18 seconds\r\n{code}\r\n\r\nShouldn''t the parser error out on this? If not that, shouldn''t the second definition replace the first? I would never expect this combining effect.\r\n\r\nThis should be controlled by the new {{\--strict}} flag (PUP-5889). When it is set to warning or error output should be produced to indicate the problem.', 'https://tickets.puppetlabs.com/browse/PUP-2695', 'https://github.com/puppetlabs/puppet/pull/4729', '2014-05-28T14:57:25.000-0700', '2019-04-04T22:32:25.000-0700', '2019-04-04T22:32:25.000-0700', 'Closed', '', 9, '0', 2, 31, 9, 2, '69276f876a5ae88a505e2aed9bc90741d46bb648'),
('puppet', 27644, 13073187, 2400, 'Double backslashes in single quote strings should be interpreted as single', 'Double backslashes in single quoted strings should be interpreted as single backslashes but aren''t.\r\n\r\nThe following manifest:\r\n{code}\r\n    notice(''foo\\bar'')\r\n{code}\r\nGives:\r\n{code}\r\n    notice: Scope(Class[main]): foo\\bar\r\n{code}\r\nThis is not the behavior described at [http://docs.puppetlabs.com/guides/language_guide.html#quoting](http://docs.puppetlabs.com/guides/language_guide.html#quoting)', 'https://tickets.puppetlabs.com/browse/PUP-1814', 'https://github.com/puppetlabs/puppet/pull/2400', '2014-02-28T06:44:09.000-0800', '2019-04-04T22:32:26.000-0700', '2019-04-04T22:32:26.000-0700', 'Closed', 'DSL;redmine', 9, '0', 1, 9, 2, 2, '95a3a096f0a36f32541551bdd3186f99576b4f64'),
('puppet', 20926, 305637810, 7664, 'Future evaluator should unique relationship operands', 'If a relationship operands contains the same reference more than once, the future evaluator will create duplicate relationships. The compiler handles this gracefully, but it is far better to ensure such requests are not made in the first place.\r\n\r\nThis is achieved with a simple call to {code}uniq{code} after they have been transformed and flattened.', 'https://tickets.puppetlabs.com/browse/PUP-994', 'https://github.com/puppetlabs/puppet/pull/7664', '2013-12-11T13:41:28.000-0800', '2019-04-04T22:32:26.000-0700', '2019-04-04T22:32:26.000-0700', 'Closed', '', 1, '0', 1, 2, 22, 3, '26da689bedeb600c580fbd4bc53cfe2597b03fe2'),
('puppet', 49754, 28972490, 3590, 'node namespaces override class namespaces if they happen to match', 'if a node happens to match the name of a class, it will override its namespace with the node''s namespace (which I didn''t even know existed). I marked this as major b/c it potentially breaks any modules that rely on fully qualified namespace lookup (like apache)\r\n\r\nThe issue is probably better articulated with the following simple example:\r\n{code}\r\nclass foo {\r\n  $bar = ''one''\r\n}\r\n\r\nnode /foo/ {\r\n  $bar = ''two''\r\n  include foo\r\n  notice("${::foo::bar}")\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3167', 'https://github.com/puppetlabs/puppet/pull/3590', '2014-09-02T03:33:19.000-0700', '2019-04-04T22:32:27.000-0700', '2019-04-04T22:32:27.000-0700', 'Closed', '', 14, '0', 1, 33, 7, 3, '551be026b323eadba85fe6abfd2a342155ca2b03'),
('puppet', 21785, 11182354, 2209, 'Add feature switch for evaluator', 'Add a feature switch --evaluator that can be set to future or current.\r\nThis should toggle the use of the future evaluator.\r\n\r\nWe can later decide if it should be current or future by default.', 'https://tickets.puppetlabs.com/browse/PUP-1176', 'https://github.com/puppetlabs/puppet/pull/2209', '2013-12-18T13:54:12.000-0800', '2019-04-04T22:32:27.000-0700', '2019-04-04T22:32:27.000-0700', 'Closed', '', 2, '0', 3, 38, 3, 3, '6fcceceaf48e3c1329052ce017cb3afd10b14f1d'),
('puppet', 40269, 17559533, 2802, 'Puppet does not work with RGen 0.7.0', 'As discovered in PUP-2755, strange things happen when using RGen 0.7.0 with puppet.', 'https://tickets.puppetlabs.com/browse/PUP-2831', 'https://github.com/puppetlabs/puppet/pull/2802', '2014-06-24T12:05:54.000-0700', '2019-04-04T22:32:27.000-0700', '2019-04-04T22:32:27.000-0700', 'Closed', '', 9, '0', 2, 12, 8, 3, 'ed5d7342458424d2e6d87a63c3bcb6898a510ba8'),
('puppet', 49019, 21125078, 3083, 'Intermittent acceptance failure in resource/service/ticket_14297_handle_upstart.rb', 'Just recently there have been a few intermittent failures in resource/service/ticket_14297_handle_upstart.rb. (Btw note that this test is confined to Ubuntu.) Three examples:\r\n\r\nhttps://jenkins.puppetlabs.com/job/Puppet-Package-Acceptance-4.0/label=acc-coord,platform=precise/212/consoleFull\r\n\r\nhttps://jenkins.puppetlabs.com/view/Puppet%20FOSS/view/Master/job/Puppet-Package-Acceptance-master/787/label=acc-coord,platform=lucid/consoleText\r\n\r\nhttps://jenkins.puppetlabs.com/view/Puppet%20FOSS/view/Master/job/Puppet-Package-Acceptance-master/786/label=acc-coord,platform=precise_and_lucid/consoleText\r\n\r\nIn all 3 of these cases the test fails trying to manage the apache service on the master.', 'https://tickets.puppetlabs.com/browse/PUP-3136', 'https://github.com/puppetlabs/puppet/pull/3083', '2014-08-25T07:53:12.000-0700', '2019-04-04T22:32:29.000-0700', '2019-04-04T22:32:29.000-0700', 'Closed', '', 28, '0', 1, 19, 7, 1, 'd9a1fb0f5adf61540c0af5acf9922e6bdc064f27'),
('puppet', 11261, 308842675, 7678, 'Stack level too deep after updating from 3.1.1 to 3.2.2', '', 'https://tickets.puppetlabs.com/browse/PUP-51', 'https://github.com/puppetlabs/puppet/pull/7678', '2013-06-20T21:20:26.000-0700', '2019-04-04T22:32:29.000-0700', '2019-04-04T22:32:29.000-0700', 'Resolved', '', 0, '0', 1, 31, 4, 2, '5ce0ab5d0f7ab3b66629b7a18f2ebd7eebf8a6c7'),
('puppet', 31543, 15710563, 2631, 'Many puppet commands fail when using a configured or requested directory environment that doesn''t exist.', 'This original description is documenting the difference between an agent making a request for an environment that does not exist, and an agent making a request for an environment that does not exist which also happens to be the configured environment on the master.\r\n\r\nOn rhel6 vms, with a master puppet.conf of:\r\n\r\n{code}\r\n[main]\r\n    # The Puppet log directory.\r\n    # The default value is ''$vardir/log''.\r\n    logdir = /var/log/puppet\r\n\r\n    # Where Puppet PID files are kept.\r\n    # The default value is ''$vardir/run''.\r\n    rundir = /var/run/puppet\r\n\r\n    # Where SSL certificates are kept.\r\n    # The default value is ''$confdir/ssl''.\r\n    ssldir = $vardir/ssl\r\n\r\n    environmentpath = $confdir/environments\r\n\r\n[agent]\r\n    # The file in which puppetd stores a list of the classes\r\n    # associated with the retrieved configuratiion.  Can be loaded in\r\n    # the separate ``puppet`` executable using the ``--loadclasses``\r\n    # option.\r\n    # The default value is ''$confdir/classes.txt''.\r\n    classfile = $vardir/classes.txt\r\n\r\n    # Where puppetd caches the local configuration.  An\r\n    # extension indicating the cache format is added automatically.\r\n    # The default value is ''$confdir/localconfig''.\r\n    localconfig = $vardir/localconfig\r\n    server = k2jv2z7f3vrqsoj.delivery.puppetlabs.net\r\n{code}\r\n\r\nand environments:\r\n\r\n{code}\r\n[root@k2jv2z7f3vrqsoj puppet]# tree /etc/puppet/environments/\r\n/etc/puppet/environments/\r\n└── foo\r\n\r\n1 directory, 0 files\r\n{code}\r\n\r\nThis agent call produces:\r\n\r\n{code}\r\n[root@ueu8qnql450gx07 ~]# puppet agent -t --environment doesnotexist\r\nInfo: Retrieving pluginfacts\r\nError: /File[/var/lib/puppet/facts.d]: Could not evaluate: Could not retrieve information from environment doesnotexist source(s) puppet://k2jv2z7f3vrqsoj.delivery.puppetlabs.net/pluginfacts\r\nInfo: Retrieving plugin\r\nError: /File[/var/lib/puppet/lib]: Could not evaluate: Could not retrieve information from environment doesnotexist source(s) puppet://k2jv2z7f3vrqsoj.delivery.puppetlabs.net/plugins\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{code}\r\n\r\nAnd this one:\r\n{code}\r\n[root@ueu8qnql450gx07 ~]# puppet agent -t --environment production\r\nInfo: Retrieving pluginfacts\r\nError: /File[/var/lib/puppet/facts.d]: Could not evaluate: Could not retrieve information from environment production source(s) puppet://k2jv2z7f3vrqsoj.delivery.puppetlabs.net/pluginfacts\r\nInfo: Retrieving plugin\r\nError: /File[/var/lib/puppet/lib]: Could not evaluate: Could not retrieve information from environment production source(s) puppet://k2jv2z7f3vrqsoj.delivery.puppetlabs.net/plugins\r\nInfo: Caching catalog for ueu8qnql450gx07.delivery.puppetlabs.net\r\nInfo: Applying configuration version ''1397175258''\r\nNotice: Finished catalog run in 0.03 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2214', 'https://github.com/puppetlabs/puppet/pull/2631', '2014-04-10T17:58:02.000-0700', '2019-04-04T22:32:30.000-0700', '2019-04-04T22:32:30.000-0700', 'Closed', '', 20, '0', 14, 84, 43, 18, '1a50b2bd66b617fbbedf483707b28abbd25f9531'),
('puppet', 56422, 23495068, 3250, 'Future parser, square brackets in references cause syntax errors related to non-ASCII characters', 'After upgrading our puppet master to 3.7.2 we started to get syntax errors in our site.pp file. After some binary search/deletions we ended up with the attached example which does not seem to allow further deletions or the syntax error will disappear.\r\n\r\nThe error always happens on the open square bracket of the reference in the resource parameter. It occurs even if the parameter is turned into an array (additional square brackets). The names are intentionally minimized, originally it was a file resource but the resource type does not seem to matter (and I would not expect it to for a syntax error).\r\n\r\nNamespaces (double colons at the start or inside the name) or lack thereof in the referenced name don''t seem to matter.\r\n\r\nStrangely enough deleting any additional characters from the referenced resource title makes the error disappear though it was originally two characters longer. If the title is completely removed, including quotes, the syntax error suddenly shows correctly on the closing square bracket instead of the opening one.\r\n\r\nIf any of the umlaut characters on the first line are removed the error disappears too. The context they appear in (comment, string,...) does not seem to matter, originally they were part of some strings and some comments inside our site.pp. Spacing does not seem to matter here either.\r\n\r\nThe syntax error disappears if the reference is not in the context of a parameter. Not all references in parameters trigger it. Originally the line was on line ~5000 of our site.pp, when commented out the next occurrence was on ~7500 where several of them appeared in a row when commenting the current error out.\r\n\r\nI set the priority to major because it completely prevents use of Puppet 3.7.2 as a puppet master as the bug does not seem to behave in a very predictable fashion.', 'https://tickets.puppetlabs.com/browse/PUP-3558', 'https://github.com/puppetlabs/puppet/pull/3250', '2014-10-28T09:06:04.000-0700', '2019-04-04T22:32:31.000-0700', '2019-04-04T22:32:31.000-0700', 'Closed', '', 14, '0', 1, 27, 11, 2, 'a9517f3c6998de89da5025f2781aa3db5cf7be54'),
('puppet', 41450, 18075124, 2847, 'collection of classes should raise a meaningful error', 'If an attempt is made to collect classes\r\n{code}\r\nClass <| |>\r\n{code}\r\nThe 3x runtime issues an error that says:\r\n{code}\r\nError: Resource type class doesn''t exist\r\n{code}\r\nWhich is misleading.\r\n\r\nThe 4x runtime fails with this message: (essentially the same).\r\n{code}\r\nError while evaluating a Virtual Query, Resource type class doesn''t exist\r\n{code}\r\n\r\nThe message should say that it is invalid/not allowed to collect classes.\r\nThe logic should not even attempt to collect.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2902', 'https://github.com/puppetlabs/puppet/pull/2847', '2014-07-07T14:53:19.000-0700', '2019-04-04T22:32:32.000-0700', '2019-04-04T22:32:32.000-0700', 'Closed', '', 2, '0', 1, 5, 1, 2, '418341ca1cf83314ccd4c308e557cb125635cad7'),
('puppet', 22414, 0, 0, 'runtime errors in future evaluator has uninformative backtrace', 'Runtime errors (that are caught by EvaluatorImpl.evaluate) raise a\r\nParseError, and pass the original exception. When this reaches the top level and is reported to the user, it is always the location of the raised (wrapping)\r\nParseError that is shown (which is quite useless to everyone, except possibly that it was caught there).\r\n\r\nInvestigate how to best make the cause be shown and implement it.', 'https://tickets.puppetlabs.com/browse/PUP-1212', 'https://github.com/puppetlabs/puppet/commit/d5849777b894edf5a1ff010f2c205eb308548aae', '2013-12-20T13:39:32.000-0800', '2019-04-04T22:32:33.000-0700', '2019-04-04T22:32:33.000-0700', 'Closed', '', 5, '0', 0, 0, 0, 0, 'd5849777b894edf5a1ff010f2c205eb308548aae'),
('puppet', 28262, 16050255, 2667, 'Cannot render EPP templates from a module', 'According to the [module guide section about templates|http://docs.puppetlabs.com/puppet/latest/reference/modules_fundamentals.html#templates] a template is found in a module''s template directory by joining the module name with the template name. However the {{epp}} function doesn''t seem to be able to do this. It also does not find the template if the module name is left off.\r\n\r\nh2. Example\r\n\r\n{noformat}\r\n> tree ~/.puppet/environments/foo/modules/\r\n/Users/andy/.puppet/environments/foo/modules/\r\n└── foo\r\n    ├── manifests\r\n    │   └── init.pp\r\n    └── templates\r\n        ├── template.epp\r\n        └── template.erb\r\n> cat ~/.puppet/environments/foo/modules/foo/templates/template.epp\r\n<%= $x %>\r\n> cat ~/.puppet/environments/foo/modules/foo/templates/template.erb\r\n<%= @value %>\r\n> cat ~/.puppet/environments/foo/modules/foo/manifests/init.pp\r\nclass foo($value) {\r\n  notice(epp("foo/template.epp", { x => $value }))\r\n  notice(template("foo/template.erb"))\r\n}\r\n> be puppet apply -e "class { foo: value => 3 }" --parser future --environment foo\r\nError: Evaluation Error: Error while evaluating a Function Call, undefined method `module'' for "foo":String at /Users/andy/.puppet/environments/foo/modules/foo/manifests/init.pp:2:10 on node aparker.corp.puppetlabs.net\r\nError: Evaluation Error: Error while evaluating a Function Call, undefined method `module'' for "foo":String at /Users/andy/.puppet/environments/foo/modules/foo/manifests/init.pp:2:10 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nUncommenting the epp line shows that the erb line works.', 'https://tickets.puppetlabs.com/browse/PUP-1894', 'https://github.com/puppetlabs/puppet/pull/2667', '2014-03-07T14:37:26.000-0800', '2019-04-04T22:32:33.000-0700', '2019-04-04T22:32:33.000-0700', 'Closed', '', 4, '0', 1, 16, 1, 2, '77e294a559c944c725cd7888cc4f80dd5c19a0ea'),
('puppet', 22690, 17430136, 2791, 'Deprecate and eliminate magic parameter array handling', 'Puppet''s parser will automatically de-arrayify single element arrays for parameters (and properties). See `lib/puppet/parser/resource.rb`\r\n\r\n{code}\r\nresult[p] = if v.is_a?(Array) and v.length == 1\r\n                    v[0]\r\n                  else\r\n                    v\r\n                  end\r\n{code}\r\n\r\nAs a result when writing a custom type, the parameter''s validate and munge methods may receive an array or string depending on what values were specified in the manifest. This leads to idioms such as:\r\n\r\n{code}\r\nmunge do |value|\r\n  # I don''t really know how this is happening.\r\n  value = value.shift if value.is_a?(Array)\r\n{code}\r\n\r\nand\r\n\r\n{code}\r\nmunge do |value|\r\n  value = [value] unless value.is_a?(Array)\r\n{code}\r\n\r\nHowever, the magic only happens when parsing a manifest, not when writing tests that create resources. For example:\r\n\r\n{code}\r\n$ puppet apply -e "exec { ''/bin/true'': environment => [ ''foo=bar'']}"\r\nvalues = [values] unless values.is_a? Array\r\n(rdb:1) values\r\n"foo=bar"\r\n{code}\r\n\r\nBut:\r\n\r\n{code}\r\n$ irb\r\n>> require ''puppet''\r\n>> Puppet::Type.type(:exec).new(:command => ''/bin/true'', :environment => [''foo=bar''])\r\nvalues = [values] unless values.is_a? Array\r\n(rdb:1) values\r\n["foo=bar"]\r\n{code}\r\n\r\nIf a parameter only accepts a single argument, then the DSL should support this easily, e.g. `newparam(:timeout, :array => false)`\r\n\r\nSee also [#6746|http://projects.puppetlabs.com/issues/6746] and https://github.com/puppetlabs/puppet/commit/46252b5bb858a1f2b87cc8646f3a59f935c58061', 'https://tickets.puppetlabs.com/browse/PUP-1299', 'https://github.com/puppetlabs/puppet/pull/2791', '2013-12-30T15:09:01.000-0800', '2019-04-04T22:32:34.000-0700', '2019-04-04T22:32:34.000-0700', 'Closed', 'future-parser;redmine', 7, '0', 1, 27, 10, 2, '423bd5f5277e469976a482d9768448f868ffb215'),
('puppet', 33977, 16948348, 2757, 'Puppet''s v2 environment listing does not display config_version and environment_timeout as well.', 'We added config_version and environment_timeout settings to directory environment environment.conf.  Puppet''s v2 environments listing needs to show these environment parameters as well.  (lib/puppet/network/http/api/v2/environments.rb)\r\n\r\nWill also need to update the API docs for v2.0/environments', 'https://tickets.puppetlabs.com/browse/PUP-2426', 'https://github.com/puppetlabs/puppet/pull/2757', '2014-05-01T15:47:33.000-0700', '2019-04-04T22:32:35.000-0700', '2019-04-04T22:32:35.000-0700', 'Closed', 'docs_reviewed', 12, '0', 1, 63, 6, 3, 'fb278d2996fc71f7c01cba69a6d5fda1c90e747a'),
('puppet', 16838, 719279749, 8745, '(#22891) Use the most preferred supported format', '', 'https://tickets.puppetlabs.com/browse/PUP-570', 'https://github.com/puppetlabs/puppet/pull/8745', '2013-10-16T13:21:30.000-0700', '2019-04-04T22:32:36.000-0700', '2019-04-04T22:32:36.000-0700', 'Closed', '', 0, '0', 1, 9, 1, 1, 'f6f1e2460c73650658ecbd9c6824ce28d5f77f5e'),
('puppet', 16292, 234835020, 7263, 'Line number information missing from 3x AST transformer errors', 'The AST transformer raises errors that do not contain any line information. These errors are for things that were not caught by the validator (most should).\n\nNot sure if it is ok with just a general wrapper around transformation (polymorphic calls) and using the line information of the semantic object. This may be good enough as the transformer will eventually not be used.\n\nThere is an implementation with a general catch, and all transformation that is actually used in future parser/evaluator is safe guarded by this.\n\nIt is probably mostly a matter of doing a functional review.', 'https://tickets.puppetlabs.com/browse/PUP-528', 'https://github.com/puppetlabs/puppet/pull/7263', '2013-10-04T17:47:14.000-0700', '2019-04-04T22:32:36.000-0700', '2019-04-04T22:32:36.000-0700', 'Closed', '', 2, '0', 1, 38, 4, 2, 'c41918d8cfae0e16fa3eb709743fbe64bbbf4efa'),
('puppet', 40864, 0, 0, 'puppet master --compile right now unconditionally spews logs to standard output', '', 'https://tickets.puppetlabs.com/browse/PUP-2873', 'https://github.com/puppetlabs/puppet/commit/a1dba4477afd25ee2763e989fe75ee365e65008d', '2014-07-01T04:07:15.000-0700', '2019-04-04T22:32:36.000-0700', '2019-04-04T22:32:36.000-0700', 'Closed', '', 15, '0', 0, 0, 0, 0, 'a1dba4477afd25ee2763e989fe75ee365e65008d'),
('puppet', 28272, 13348015, 2424, 'EPP ignores code after parameter declaration', 'If the parameter declaration for a single parameter in an EPP template is in a {{<%= ... %>}} snippet along with other code, the parameter declaration seems to be evaluated but all of the following code is ignored. If multiple parameters are specified then it ends up being a syntax error.\r\n\r\nExample\r\n{noformat}\r\n> be puppet apply -e "notice(inline_epp(''<%= (\$x) \$x + 1 %>'', { x => 2 }))" --parser future\r\nNotice: Scope(Class[main]): 2\r\nNotice: Compiled catalog for aparker.corp.puppetlabs.net in environment production in 0.39 seconds\r\nNotice: Finished catalog run in 0.03 seconds\r\n{noformat}\r\n\r\nExample of the error when there are multiple parameters\r\n{noformat}\r\n> be puppet apply -e "notice(inline_epp(''<%= (\$x, \$y) \$x + 1 %>'', { x => 2, y => 4 }))" --parser future\r\nError: Evaluation Error: Error while evaluating a Function Call, inline_epp(): Invalid EPP: Syntax error at '','' at inlined-epp-text:1:8 at line 1:8 on node aparker.corp.puppetlabs.net\r\nError: Evaluation Error: Error while evaluating a Function Call, inline_epp(): Invalid EPP: Syntax error at '','' at inlined-epp-text:1:8 at line 1:8 on node aparker.corp.puppetlabs.net\r\n{noformat}\r\n\r\nI would expect either a syntax error or the parameter declaration to be interpreted as such and the body evaluated.', 'https://tickets.puppetlabs.com/browse/PUP-1897', 'https://github.com/puppetlabs/puppet/pull/2424', '2014-03-07T16:39:44.000-0800', '2019-04-04T22:32:37.000-0700', '2019-04-04T22:32:37.000-0700', 'Closed', '', 10, '0', 3, 832, 781, 5, 'edd3e8ea5e1ce0d95c3d7eb25a53259b41e1e975'),
('puppet', 10977, 194967868, 6884, 'Deprecate YAML over the network', 'Deprecate using YAML over the network in Puppet. This may require the implementation of pson support in some places where it doesn''t currently exist.', 'https://tickets.puppetlabs.com/browse/PUP-31', 'https://github.com/puppetlabs/puppet/pull/6884', '2013-06-17T17:51:57.000-0700', '2019-04-04T22:32:37.000-0700', '2019-04-04T22:32:37.000-0700', 'Resolved', '', 3, '0', 2, 151, 24, 3, '6aece3f75a8b5f9cc1a26b55bc2dba826cb3927a'),
('puppet', 34334, 15568758, 2619, '`puppet module build` should provide deprecated functionality with warning until Puppet v4', 'With the recent changes in the PMT tool, if you have both a Modulefile and metadata.json file, the Modulefile will be completely ignored, breaking current functionality. The ultimate goal is to get to this behavior of using the metadata.json file only but needs to be deprecated in a manner that still provides the current functionality with a warning and then removed in Puppet v4.\r\n\r\nThat deprecated functionality is outlined below.\r\n\r\nFrom [~hunter] (paraphrased from PUP-1976):\r\n\r\n{quote}\r\n[The changes with PMT Build have a] backwards-incompatible nature [that] will currently break the packaging of all of our modules.\r\nExample:: We only declare dependencies in the Modulefile but not metadata.json. We also don''t synchronize the versions in Modulefile and metadata.json because pmt prefers the Modulefile version over metadata.json invisibly.\r\n\r\nSuggestion: The pmt should merge Modulefile and metadata.json entries, preferring the entries in Modulefile for conflicts. It should warn that support for Modulefile is deprecated and it will only use metadata.json in the future. It would also be helpful if it warned about every entry that exists in Modulefile but is different or non-existent in the metadata.json\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-2484', 'https://github.com/puppetlabs/puppet/pull/2619', '2014-05-06T07:54:35.000-0700', '2019-04-04T22:32:39.000-0700', '2019-04-04T22:32:39.000-0700', 'Closed', '', 7, '0', 2, 17, 15, 3, 'b56776ca38c98b008c7708214568f06e469bdbfd'),
('puppet', 20494, 682008022, 8672, 'Case and Selector expressions using Regexp type does not set match vars', 'Since =~ operator treats the Regexp type as if it were a regular expression and sets the match variables, so should the other conditional expressions that invoke pattern matching (case and selector).\r\n\r\nThis is missing in the new evaluator implementation. (Matching is still done, but without the side effect of setting the match variables).', 'https://tickets.puppetlabs.com/browse/PUP-957', 'https://github.com/puppetlabs/puppet/pull/8672', '2013-12-07T19:52:39.000-0800', '2019-04-04T22:32:41.000-0700', '2019-04-04T22:32:41.000-0700', 'Closed', '', 4, '0', 5, 143, 3, 11, '1d5737354e960e107bcd178b613a1a881cf6287c'),
('puppet', 11362, 373486415, 7977, 'Data bindings don''t set calling_module / calling_class variables during lookups', 'According to [the Hiera documentation](http://docs.puppetlabs.com/hiera/1/puppet.html#special-pseudo-variables) these variables are available "when doing any Hiera lookup, with both automatic parameter lookup and the Hiera functions".\n\nHowever:\n\n> The automatic parameter lookup uses a different scope (Puppet::DataBinding) than the explicit lookup with the hiera function (Hiera::Scope). The calling_module and calling_class variables are generated in Hiera::Scope and therefore are not available when automatic parameter lookup is used. This breaks hiera configurations that make use of those variables for lookups. \n\nThe classes `Hiera::Scope` and `Puppet::DataBinding::Variables` are nearly duplicates of each other. These classes should possibly be re-factored into a single interface so there is no drift in capability if someone forgets to create duplicate code for both classes when a common feature is added.', 'https://tickets.puppetlabs.com/browse/PUP-83', 'https://github.com/puppetlabs/puppet/pull/7977', '2013-06-24T22:54:43.000-0700', '2019-04-04T22:32:41.000-0700', '2019-04-04T22:32:41.000-0700', 'Closed', 'redmine', 3, '0', 3, 42, 20, 2, '5d82c55c73f554735ea7fd2dfcb76b2cbc160edd'),
('puppet', 48695, 20654645, 3044, 'Puppet needs to use default keylength 2048 on FIPS enabled systems', 'FIPS 140-2 does not allow for the use of 4096 bit keys. Therefore, the initial certificate generation of a key using a key length > 2048 bits will fail.\r\n\r\nAny system that is FIPS enabled, should use a 2048 bit key when generating the initial CA and server certificates.', 'https://tickets.puppetlabs.com/browse/PUP-3114', 'https://github.com/puppetlabs/puppet/pull/3044', '2014-08-20T12:53:56.000-0700', '2019-04-04T22:32:45.000-0700', '2019-04-04T22:32:45.000-0700', 'Closed', 'DOCS', 21, '0', 1, 11, 3, 2, ''),
('puppet', 30219, 18128449, 2852, 'Puppet module install --force does not re-install dependencies', 'Installing a module from forge on the commandline with --force does not (re)install its dependencies.\r\n\r\ninstalling normally\r\n{code}\r\n$ puppet module install puppetlabs-ntp\r\nNotice: Preparing to install into /etc/puppet/modules ...\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/etc/puppet/modules\r\n└─┬ puppetlabs-ntp (v3.0.3)\r\n  └── puppetlabs-stdlib (v4.1.0)\r\n{code}\r\n\r\nNow with --force:\r\n{code}\r\n$ puppet module install --force puppetlabs-ntp\r\nNotice: Preparing to install into /etc/puppet/modules ...\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/etc/puppet/modules\r\n└── puppetlabs-ntp (v3.0.3)\r\n{code}\r\n\r\nThe description of --force is: "Force overwrite of existing module, if any."\r\nAnd there is also an --ignore-dependencies flag "Do not attempt to install dependencies".\r\n\r\nApparently --force also implies --ignore-dependencies which is not expected behaviour. If the user would want to ignore dependencies he would just use the --ignore-dependencies flag.\r\n\r\nPresently it is not possible to reinstall puppet modules without completely wiping all /etc/puppet/modules.', 'https://tickets.puppetlabs.com/browse/PUP-2078', 'https://github.com/puppetlabs/puppet/pull/2852', '2014-03-27T08:09:01.000-0700', '2019-04-04T22:32:45.000-0700', '2019-04-04T22:32:45.000-0700', 'Closed', '', 4, '0', 1, 8, 6, 2, 'f22843100c9294f9aa0ef9ca559ce85cd15be737'),
('puppet', 52976, 22029364, 3134, 'type system does not handle Enum/String compare correctly', '{code}\r\nEnum[blue] < String\r\n{code}\r\nshould be true, but it isn''t.\r\n{code}\r\nEnum < String\r\n{code}\r\nshould be true but fails with a comparison of fixnum vs. integer in the type calculator.\r\n\r\nWhile any enum is in fact the same as any string, it should still be considered more specific (they are not equal as types at least).', 'https://tickets.puppetlabs.com/browse/PUP-3366', 'https://github.com/puppetlabs/puppet/pull/3134', '2014-09-29T19:25:00.000-0700', '2019-04-04T22:32:46.000-0700', '2019-04-04T22:32:46.000-0700', 'Closed', '', 6, '0', 2, 39, 7, 2, '7b4f1bc25ef5e442e587a00de3f19d75fc7ed6c6'),
('puppet', 16561, 0, 0, 'Puppet backend swallows exceptions', 'See redmine issue', 'https://tickets.puppetlabs.com/browse/PUP-549', 'https://github.com/puppetlabs/puppet/commit/4dfd0813a1d9aceba750625b9f245b322ed00b8f', '2013-10-10T11:56:47.000-0700', '2019-04-04T22:32:47.000-0700', '2019-04-04T22:32:47.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, '4dfd0813a1d9aceba750625b9f245b322ed00b8f'),
('puppet', 40170, 17566864, 2804, 'Make $title and $name Reserved Words', 'If one creates a class with {{$name}} or {{$title}} in it and assigns them default values, if a user later tries to instantiate this class using the default values, Puppet will generate an error.\r\n\r\nConsider the following:\r\nThe setup:\r\n{code}\r\n# manifests/init.pp\r\nclass pup514 {\r\n  define bark(String $name = ''No Name'', Integer $phone = 0) {\r\n    notice "Name: ''$name'', Number: ''$phone''"\r\n  }\r\n}  \r\n\r\n# tests/init.pp\r\npup514::bark { ''obj1'': name => ''Jenny'', phone => 8675309, }\r\npup514::bark { ''obj2'': name => ''Pennsylvania'', phone => 65000, }\r\npup514::bark { ''obj3'': name => ''Rhonda'', }\r\npup514::bark { ''obj4'': phone => 42, }\r\npup514::bark { ''obj5'': }\r\n{code}\r\n\r\nThe output from this manifest is not quite what I expected. Specifically, for {{obj4}} and {{obj5}}, I was expecting the default values to be used where the parameters are missing.\r\n{code}\r\n$ be puppet apply krw-pup514/tests/init.pp\r\nNotice: Name: ''Jenny'', Number: ''8675309''\r\nNotice: Name: ''Pennsylvania'', Number: ''65000''\r\nNotice: Name: ''Rhonda'', Number: ''0''\r\nError: Cannot reassign variable name on node ubuntu.localdomain\r\nError: Cannot reassign variable name on node ubuntu.localdomain\r\n{code}\r\nI expected:\r\n{code}\r\nNotice: Name: ''Jenny'', Number: ''8675309''\r\nNotice: Name: ''Pennsylvania'', Number: ''65000''\r\nNotice: Name: ''Rhonda'', Number: ''0''\r\nNotice: Name: ''No Name'', Number: ''42''\r\nNotice: Name: ''No Name'', Number: ''0''\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-2824', 'https://github.com/puppetlabs/puppet/pull/2804', '2014-06-23T16:24:43.000-0700', '2019-04-04T22:32:49.000-0700', '2019-04-04T22:32:49.000-0700', 'Closed', '', 5, '0', 2, 35, 1, 3, '304a9418bc26c8c91850a6bc71b7c927826dc47b'),
('puppet', 25669, 15623280, 2625, '"contain" cannot contain a fully qualified class', 'nested contains don''t appeare to work. I''m hitting this issue when trying to {{contain}} puppetlabs/mysql::client, but the issue can be reproduced quite simply:\r\n\r\n{code}\r\n#\r\nclass mybug::client (\r\n  $package_ensure  = ''present'',\r\n  $package_name    = ''mysql'',\r\n){\r\n  package { ''mybug_client'':\r\n    ensure => $mybug::client::package_ensure,\r\n    name   => $mybug::client::package_name,\r\n  }\r\n}\r\n{code}\r\n{code}\r\nclass profile::mybug {\r\n  contain ::mybug::client\r\n}\r\n{code}\r\n\r\nNow, if we call {{puppet apply --debug -e ''include ::profile::mybug''}}, we get:\r\n{code}\r\nWARNING: Nokogiri was built against LibXML version 2.9.0, but has dynamically loaded 2.9.1\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/root_home.rb\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/pe_version.rb\r\nWarning: Could not retrieve fact fqdn\r\nDebug: importing ''/etc/puppet/modules/profile/manifests/mybug.pp'' in environment production\r\nDebug: Automatically imported profile::mybug from profile/mybug into production\r\nDebug: importing ''/etc/puppet/modules/mybug/manifests/init.pp'' in environment production\r\nDebug: importing ''/etc/puppet/modules/mybug/manifests/client.pp'' in environment production\r\nDebug: Automatically imported mybug::client from mybug/client into production\r\nDebug: hiera(): Hiera YAML backend starting\r\nDebug: hiera(): Looking up mybug::client::package_ensure in YAML backend\r\nDebug: hiera(): Looking for data source production\r\nDebug: hiera(): Cannot find datafile /var/lib/hiera/production.yaml, skipping\r\nDebug: hiera(): Looking for data source global\r\nDebug: hiera(): Looking up mybug::client::package_name in YAML backend\r\nDebug: hiera(): Looking for data source production\r\nDebug: hiera(): Cannot find datafile /var/lib/hiera/production.yaml, skipping\r\nDebug: hiera(): Looking for data source global\r\nError: undefined method `ref'' for nil:NilClass on node levix\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:527:in `block in to_catalog''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:515:in `each''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:515:in `to_catalog''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:402:in `to_resource''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:24:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:116:in `block (2 levels) in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler/none.rb:6:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler.rb:31:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:114:in `block in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:161:in `block in benchmark''\r\n/usr/lib/ruby/1.9.1/benchmark.rb:295:in `realtime''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:160:in `benchmark''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:113:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:46:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/indirection.rb:201:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:204:in `main''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:146:in `run_command''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block (2 levels) in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:470:in `plugin_hook''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:478:in `exit_on_fail''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:137:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:91:in `execute''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/bin/puppet:4:in `<top (required)>''\r\n/usr/local/bin/puppet:23:in `load''\r\n/usr/local/bin/puppet:23:in `<main>''\r\nError: undefined method `ref'' for nil:NilClass on node levix\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:527:in `block in to_catalog''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:515:in `each''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:515:in `to_catalog''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/resource/catalog.rb:402:in `to_resource''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:24:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:116:in `block (2 levels) in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler/none.rb:6:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler.rb:31:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:114:in `block in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:161:in `block in benchmark''\r\n/usr/lib/ruby/1.9.1/benchmark.rb:295:in `realtime''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:160:in `benchmark''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:113:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:46:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/indirection.rb:201:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:204:in `main''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:146:in `run_command''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block (2 levels) in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:470:in `plugin_hook''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:478:in `exit_on_fail''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:137:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:91:in `execute''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/bin/puppet:4:in `<top (required)>''\r\n/usr/local/bin/puppet:23:in `load''\r\n/usr/local/bin/puppet:23:in `<main>''\r\n{code}\r\n\r\nAlternatively, if we call {{sudo puppet apply --debug -e ''contain ::mybug::client''}}, we get\r\n{code}\r\nWARNING: Nokogiri was built against LibXML version 2.9.0, but has dynamically loaded 2.9.1\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/root_home.rb\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /etc/puppet/modules/stdlib/lib/facter/pe_version.rb\r\nWarning: Could not retrieve fact fqdn\r\nDebug: importing ''/etc/puppet/modules/mybug/manifests/init.pp'' in environment production\r\nDebug: importing ''/etc/puppet/modules/mybug/manifests/client.pp'' in environment production\r\nDebug: Automatically imported mybug::client from mybug/client into production\r\nDebug: hiera(): Hiera YAML backend starting\r\nDebug: hiera(): Looking up mybug::client::package_ensure in YAML backend\r\nDebug: hiera(): Looking for data source production\r\nDebug: hiera(): Cannot find datafile /var/lib/hiera/production.yaml, skipping\r\nDebug: hiera(): Looking for data source global\r\nDebug: hiera(): Looking up mybug::client::package_name in YAML backend\r\nDebug: hiera(): Looking for data source production\r\nDebug: hiera(): Cannot find datafile /var/lib/hiera/production.yaml, skipping\r\nDebug: hiera(): Looking for data source globalError: undefined method `tag'' for nil:NilClass on node levix\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:443:in `block in add_resource_metaparams''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/graph/simple_graph.rb:355:in `block in walk''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/graph/simple_graph.rb:354:in `each''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/graph/simple_graph.rb:354:in `walk''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:432:in `add_resource_metaparams''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:419:in `finish''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:119:in `block in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler/none.rb:6:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler.rb:31:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:119:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:24:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:116:in `block (2 levels) in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler/none.rb:6:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler.rb:31:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:114:in `block in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:161:in `block in benchmark''\r\n/usr/lib/ruby/1.9.1/benchmark.rb:295:in `realtime''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:160:in `benchmark''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:113:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:46:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/indirection.rb:201:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:204:in `main''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:146:in `run_command''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block (2 levels) in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:470:in `plugin_hook''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:478:in `exit_on_fail''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:137:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:91:in `execute''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/bin/puppet:4:in `<top (required)>''\r\n/usr/local/bin/puppet:23:in `load''\r\n/usr/local/bin/puppet:23:in `<main>''\r\nError: undefined method `tag'' for nil:NilClass on node levix\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:443:in `block in add_resource_metaparams''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/graph/simple_graph.rb:355:in `block in walk''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/graph/simple_graph.rb:354:in `each''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/graph/simple_graph.rb:354:in `walk''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:432:in `add_resource_metaparams''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:419:in `finish''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:119:in `block in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler/none.rb:6:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler.rb:31:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:119:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/parser/compiler.rb:24:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:116:in `block (2 levels) in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler/none.rb:6:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/profiler.rb:31:in `profile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:114:in `block in compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:161:in `block in benchmark''\r\n/usr/lib/ruby/1.9.1/benchmark.rb:295:in `realtime''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:160:in `benchmark''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:113:in `compile''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/catalog/compiler.rb:46:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/indirector/indirection.rb:201:in `find''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:204:in `main''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application/apply.rb:146:in `run_command''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block (2 levels) in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:470:in `plugin_hook''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `block in run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util.rb:478:in `exit_on_fail''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/application.rb:364:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:137:in `run''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/lib/puppet/util/command_line.rb:91:in `execute''\r\n/var/lib/gems/1.9.1/gems/puppet-3.4.2/bin/puppet:4:in `<top (required)>''\r\n/usr/local/bin/puppet:23:in `load''\r\n/usr/local/bin/puppet:23:in `<main>''\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1597', 'https://github.com/puppetlabs/puppet/pull/2625', '2014-02-06T04:41:03.000-0800', '2019-04-04T22:32:49.000-0700', '2019-04-04T22:32:49.000-0700', 'Closed', '', 9, '0', 1, 19, 1, 2, '748564d0ff94336b57e713d01ac3c98dec790c95'),
('puppet', 32147, 15321325, 2597, 'ca_server and directory based environments don''t play nice together', 'When a Puppet Master is stared and is a CA but does not have any environments in {{/etc/puppet/environments}} even though it is configured for directory based environments it stops accepting CSR''s.\r\n\r\nWe have a Puppet Master that is CA-only and therefor don''t deploy the environments to it. The fix was to simply remove the {{environmentpath}} setting from {{puppet.conf}} but I don''t think that using directory based environments should brick certificate signing.', 'https://tickets.puppetlabs.com/browse/PUP-2290', 'https://github.com/puppetlabs/puppet/pull/2597', '2014-04-17T02:48:47.000-0700', '2019-04-04T22:32:51.000-0700', '2019-04-04T22:32:51.000-0700', 'Closed', '', 13, '0', 3, 27, 1, 3, '5cbda139f768ce064df7cf30f6a09ef8bf75f7da'),
('puppet', 36802, 16252566, 2687, 'selector expression default should be matched last', 'The future evaluator treats a default in a selector expression just like any other value (historically puppet regular did this too - although I may be wrong). It should instead defer matching against a default until no other entry matched (just like the case expression does).\r\n\r\nThis will bite all users that have not followed the advice to place the default entry last in the selector.', 'https://tickets.puppetlabs.com/browse/PUP-2642', 'https://github.com/puppetlabs/puppet/pull/2687', '2014-05-22T14:49:36.000-0700', '2019-04-04T22:32:52.000-0700', '2019-04-04T22:32:52.000-0700', 'Closed', '', 14, '0', 1, 18, 4, 3, 'fa796c9f8961298870c9a94b3e25f1869affd5e5'),
('puppet', 34383, 15962738, 2659, 'REST API regression in DELETE request handling', 'Hi,\r\n\r\n[Note that I have to remove hostnames, so i replaced them with fake\r\n ones. In the logs they are shown correctly and as expected]\r\n\r\nUsing puppet on Debian with the packages from puppetlabs, puppet is 3.5.1-1puppetlabs1. Following added to auth.conf on the master:\r\n\r\n-----------\r\n# allow nodes to touch their own cert and installcert to touch all certs\r\npath ~ /certificate_status/([^/]+)$\r\nauth yes\r\nallow $1\r\nallow installcert\r\n-----------\r\n\r\nNow, following http://docs.puppetlabs.com/guides/rest_api.html#certificate-status that documentation, a request like\r\n\r\ncurl --cert ./installcert.crt --key ./installcert.key -k -X DELETE -H "Accept: pson" https://puppetserver:8140/production/certificate_status/machine.example.com\r\n\r\nought to delete the certificate.\r\nNote that a revocation request with PUT works fine.\r\n\r\nThe puppetmaster log for a revocation:\r\n-----------\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Handling request: PUT /production/certificate_status/machine.example.com\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Routes Registered:\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Route /^\/v2\.0/\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Route /.*/\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Evaluating match for Route /^\/v2\.0/\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Did not match path ("/production/certificate_status/machine.example.com")\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Evaluating match for Route /.*/\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: certificate_status supports formats: pson msgpack yaml b64_zlib_yaml raw\r\nMay  6 20:35:44 puppetserver puppet-master[264631]: Revoked certificate with serial 7\r\n-----------\r\n\r\nSo thats fine, and works as designed.\r\nNow, revocation isn''t enough, the cert should go away. Running the\r\nabove mentioned command to DELETE it ends up with the following lines\r\nin the log:\r\n-----------\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Handling request: DELETE /production/certificate_status/machine.example.com\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Routes Registered:\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Route /^\/v2\.0/\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Route /.*/\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Evaluating match for Route /^\/v2\.0/\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Did not match path ("/production/certificate_status/machine.example.com")\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Evaluating match for Route /.*/\r\nMay  6 20:41:03 puppetserver puppet-master[264631]: Server Error: undefined method `each'' for nil:NilClass\r\n-----------\r\n\r\nAnd a load of output back to the shell from curl:\r\n-----------\r\n{"message":"Server Error: undefined method `each'' for nil:NilClass","issue_kind":"RUNTIME_ERROR","stacktrace":["/usr/lib/ruby/vendor_ruby/puppet/network/http/route.rb:72:in `process''","/usr/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:63:in `block in process''","/usr/lib/ruby/vendor_ruby/puppet/util/profiler/none.rb:6:in `profile''","/usr/lib/ruby/vendor_ruby/puppet/util/profiler.rb:43:in `profile''","/usr/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:61:in `process''","/usr/lib/ruby/vendor_ruby/puppet/network/http/rack.rb:21:in `call''","/usr/lib/ruby/vendor_ruby/phusion_passenger/rack/request_handler.rb:96:in `process_request''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_request_handler.rb:516:in `accept_and_process_next_request''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_request_handler.rb:274:in `main_loop''","/usr/lib/ruby/vendor_ruby/phusion_passenger/rack/application_spawner.rb:206:in `start_request_handler''","/usr/lib/ruby/vendor_ruby/phusion_passenger/rack/application_spawner.rb:171:in `block in handle_spawn_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/utils.rb:479:in `safe_fork''","/usr/lib/ruby/vendor_ruby/phusion_passenger/rack/application_spawner.rb:166:in `handle_spawn_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server.rb:357:in `server_main_loop''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server.rb:206:in `start_synchronously''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server.rb:180:in `start''","/usr/lib/ruby/vendor_ruby/phusion_passenger/rack/application_spawner.rb:129:in `start''","/usr/lib/ruby/vendor_ruby/phusion_passenger/spawn_manager.rb:253:in `block (2 levels) in spawn_rack_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add''","/usr/lib/ruby/vendor_ruby/phusion_passenger/spawn_manager.rb:246:in `block in spawn_rack_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server_collection.rb:82:in `block in synchronize''","<internal:prelude>:10:in `synchronize''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server_collection.rb:79:in `synchronize''","/usr/lib/ruby/vendor_ruby/phusion_passenger/spawn_manager.rb:244:in `spawn_rack_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/spawn_manager.rb:137:in `spawn_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server.rb:357:in `server_main_loop''","/usr/lib/ruby/vendor_ruby/phusion_passenger/abstract_server.rb:206:in `start_synchronously''","/usr/share/phusion-passenger/helper-scripts/passenger-spawn-server:99:in `<main>''"]}\r\n-----------\r\n\r\nI don''t think it should do this, I would have expected it to delete\r\nthat cert... :)\r\n\r\n--\r\nbye Joerg\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2505', 'https://github.com/puppetlabs/puppet/pull/2659', '2014-05-06T11:45:36.000-0700', '2019-04-04T22:32:52.000-0700', '2019-04-04T22:32:52.000-0700', 'Closed', '', 8, '0', 4, 31, 6, 2, 'c69941360526235f5cc7a0bd687842eb50d5f2e2'),
('puppet', 41156, 18014388, 2842, 'future parser should validate class/resource names that are types', 'The validator should issue an error if a type name is used as the name of a class or define.\r\n\r\n{code}\r\ndefine integer { }\r\nclass data {}\r\n{code}\r\n\r\nThe names should be allowed when used in some context e.g. {{MyVeryOwn::Integer}} - this, although most names are computer science like, the type Data may be something that people want to use.\r\n\r\nThere is no deprecation, and if not validated, references to those classes/defines will not work as expected, with strange effects, or errors elsewhere.', 'https://tickets.puppetlabs.com/browse/PUP-2886', 'https://github.com/puppetlabs/puppet/pull/2842', '2014-07-02T18:11:20.000-0700', '2019-04-04T22:32:52.000-0700', '2019-04-04T22:32:52.000-0700', 'Closed', '', 3, '0', 1, 66, 0, 3, '4ccac8deb454ba378b66e164e40dc8f572a84f92'),
('puppet', 38323, 24027306, 3286, 'Puppet squats on the PuppetX::Puppetlabs and PuppetX::Puppet namespaces', 'The implementation of the heredoc syntax validators added logic into the PuppetX module, took the names PuppetX::Puppetlabs and PuppetX::Puppet and added an implementation into PuppetX::Puppetlabs for json syntax validation and some interfaces into PuppetX::Puppet.\r\n\r\nThe PuppetX module needs to remain as a convention for code *external* to puppet to have for any implementations outside of the implementation of the extension itself (e.g. Puppet::Type::X) to use. By adding logic to the PuppetX ruby module, we have begun interfering with extensions.\r\n\r\nThe use of PuppetX::Puppet is a little less of a problem, but seems to be very strange that puppet is extending itself. Puppet code should be contained within Puppet, not PuppetX.\r\n\r\nI would expect that Puppet would have no meaningful contact with PuppetX other than, maybe, creating the PuppetX ruby module in {{puppetx.rb}}.', 'https://tickets.puppetlabs.com/browse/PUP-2733', 'https://github.com/puppetlabs/puppet/pull/3286', '2014-06-05T12:51:51.000-0700', '2019-04-04T22:32:53.000-0700', '2019-04-04T22:32:53.000-0700', 'Closed', '', 7, '0', 3, 131, 105, 16, 'bc7beff2806481a042f292f496c48fb3202fb3c0'),
('puppet', 41338, 18941052, 2914, 'Long form Resource Type reference fools "future parser" this is an override', 'When setting defaults for a resource type R, the short form works:\r\n{code}\r\nR { attr => value }\r\n{code}\r\nbut not the long form:\r\n{code}\r\nResource[R] { attr => value }\r\nResource[''r''] { attr => value }\r\n{code}\r\n\r\nThis problem is due to the static transformation of a resource expression\r\nsince the two forms (override and default) have different rules than a regular resource expression.\r\n\r\nIdeally I would like to only have one form and require that defaults have a title of literal default, and that overrides specify the title of the resource that is being overridden. This would alleviate much grammar pain.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2898', 'https://github.com/puppetlabs/puppet/pull/2914', '2014-07-07T06:35:53.000-0700', '2019-04-04T22:32:56.000-0700', '2019-04-04T22:32:56.000-0700', 'Closed', '', 6, '0', 23, 2539, 2224, 32, '93a3e21a63a5f7f7cdce3d96bfd7859f6bc82b9c'),
('puppet', 12405, 164984545, 6570, 'Puppet agents with agent cert but no CA cert perform infinite recursion', 'When the Puppet Agent has a SSL cert, but no CA cert with which to validate its credentials, it will request the CA cert from the master. During the request, the expiration dates of all certs are checked so that the user can be warned if anything is nearing expiration. Checking the expiration date causes the agent cert to be validated, which triggeres a request to the master for the CA cert, which causes the expiration dates of all certs to be checked...\n\nThis recursion continues until the agent experiences a stack overflow or misses a thread lock. A side effect of this recursion is that the agent will flood the master with CA requests.\n\nTo re-produce this issue:\n\n  - Spin up a master-agent pair.\n\n  - Allow the agent to check in with the master and obtain a cert.\n\n  - Move `/var/lib/puppet/ssl/certs/ca.pem` to a temporary location.\n\n  - `puppet agent -t` should now fail with a stack overflow or thread synchronization error.\n\nThe main use case triggering this issue is using `puppet cert generate` to pre-seed an agent with keys.', 'https://tickets.puppetlabs.com/browse/PUP-191', 'https://github.com/puppetlabs/puppet/pull/6570', '2013-07-23T09:12:39.000-0700', '2019-04-04T22:32:57.000-0700', '2019-04-04T22:32:57.000-0700', 'Closed', 'redmine', 6, '0', 1, 32, 2, 2, '69a4b75743348352b86abcf3abba68deafd1eff6'),
('puppet', 28953, 13697246, 2445, 'future parser doesn''t bind variables from inherited scope', 'If you run the puppetlabs-ntp module with parser=future on 3.5.0-rc1 it will break complaining that it can''t call {{flatten}} on {{nil:NilClass}} in the ntp.conf template.\r\n\r\nThis happens because for some reason {{@restrict}} and every other variable in the template isn''t bound, ergo nil.\r\n\r\nIf I explicitly add a {{$restricted = $::ntp::restricted}} to config.pp it works.', 'https://tickets.puppetlabs.com/browse/PUP-1973', 'https://github.com/puppetlabs/puppet/pull/2445', '2014-03-18T07:37:23.000-0700', '2019-04-04T22:32:58.000-0700', '2019-04-04T22:32:58.000-0700', 'Closed', '', 4, '0', 1, 44, 0, 2, '6b7640b829c42167cf94bf96186db65b91384872'),
('puppet', 206988, 158677715, 6457, 'beaker instructions at ./acceptance/readme seem to be wrong', 'Instructions for running beaker locally in the file {{acceptance/README.md}} seem to be broken in master.\r\n\r\nI''ve been running using:\r\n{noformat}\r\nCONFIG=config/nodes/centos6-local.yaml SHA=#{test-commit-sha} GIT_SERVER=''192.168.80.1'' FORK=''puppet'' bundle exec rake --trace ci:test:git\r\n{noformat}\r\n\r\nAs suggested by the instructions, I encountered 2x failures:\r\n\r\n*Errored build: Unable to yum install rubygem-json*\r\nFix was to use a centos7 vagrant box which already has "Development Tools" metapackage installed\r\n\r\n*Errored build:  Unable to checkout puppet from git*\r\n{noformat}\r\n...SNIP\r\n    Don''t run Bundler as root. Bundler can ask for sudo if it is needed, and\r\n    installing your bundle as root will break this application for all non-root\r\n    users on this machine.\r\n    Fetching https://github.com/puppet/puppet.git\r\n    fatal: Needed a single revision\r\n    Revision 15ffe6b31 does not exist in the repository\r\n    https://github.com/puppet/puppet.git. Maybe you misspelled it?\r\n  \r\n  all-in-one executed in 226.35 seconds\r\n  Exited: 11\r\n  Beaker::Host::CommandFailure: Host ''all-in-one'' exited with 11 running:\r\n...SNIP\r\n{noformat}\r\n\r\nThis turns out to be the build system not using the GIT_SERVER environment variable.  I had a quick scan through the code and couldn''t see it being used anywhere.  I came up with a hacky workaround by editing {{acceptance/setup/git/pre-suite/010_TestSetup.rb}} around line 35 to just hardcode to the git server I setup (git daemon, as per instructions):\r\n\r\n{noformat}\r\n        gemfile_contents = <<END\r\nsource ''#{ENV["GEM_SOURCE"] || "https://rubygems.org"}''\r\ngem ''#{repository[:name]}'', :git => ''git://192.168.0.1/puppetlabs-puppet.git'', :ref => ''#{ENV[''SHA'']}''\r\n# gem ''#{repository[:name]}'', :git => ''#{repository[:path]}'', :ref => ''#{ENV[''SHA'']}''\r\nEND\r\n{noformat}\r\n\r\nAfter making these two changes, it looks like the beaker tests are mostly working, but it would be great to get the instructions updated/helpers fixed to make life easier for those contributing patches', 'https://tickets.puppetlabs.com/browse/PUP-7861', 'https://github.com/puppetlabs/puppet/pull/6457', '2017-08-22T22:25:30.000-0700', '2019-04-04T22:34:07.000-0700', '2019-04-04T22:34:07.000-0700', 'Closed', '', 3, '0', 1, 6, 6, 1, 'd4d2b653ad3c9848f92ba02313e574e910d13a1c'),
('puppet', 190355, 131117668, 6079, 'Puppet Acceptance Test Failure in Imaging Acceptance Tests', 'The new Packer/Imaging acceptance tests are consistently failing with the following test failures:\r\n* tests/reports/corrective_change_new_resource.rb\r\n* tests/reports/corrective_change_outside_puppet.rb\r\n* tests/reports/corrective_change_via_puppet.rb\r\n* tests/resource/file/ticket_6448_file_with_utf8_source.rb\r\n\r\nThese tests are a copy of the existing Puppet Acceptance Tests from the Puppet Agent Suite remodelled to run on the Jenkins Imaging Server as part the {{vmpooler}} image creation pipeline.\r\n\r\nAn example of a failing test is available at: https://jenkins-imaging.delivery.puppetlabs.net/view/Windows/job/imaging_windows-2012r2-wmf5_x86_64_vmware_vsphere.cygwin_acceptance_packer/5/consoleFull\r\n\r\nAll of these tests show the following common error pattern:\r\n{noformat}\r\n05:10:32           \r\n05:10:32           duaytgmfihwjgou (redhat7-64-1) 05:10:32$ service puppetserver reload\r\n05:10:32             Redirecting to /bin/systemctl reload  puppetserver.service\r\n05:10:35           \r\n05:10:35           duaytgmfihwjgou (redhat7-64-1) executed in 3.15 seconds\r\n05:10:35           RuntimeError: PuppetAcceptance::DSL::Helpers.with_puppet_running_on failed (check backtrace for location) because: Host ''iel4i3wbexk81wn'' exited with 1 running:\r\n05:10:35            cmd.exe /c puppet agent -t --environment corrective_change_new_resource_vh8jbk1t --server duaytgmfihwjgou\r\n05:10:35           Last 10 lines of output were:\r\n05:10:35           	Info: Using configured environment ''corrective_change_new_resource_vh8jbk1t''\r\n05:10:35           	Info: Retrieving pluginfacts\r\n05:10:35           	Info: Retrieving plugin\r\n05:10:35           	Error: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: No matching entry for selector parameter with value ''iel4i3wbexk81wn.delivery.puppetlabs.net'' at /etc/puppetlabs/code/environments/corrective_change_new_resource_vh8jbk1t/manifests/site.pp:2:14 on node iel4i3wbexk81wn.delivery.puppetlabs.net\r\n05:10:35           	Warning: Not using cache on failed catalog\r\n05:10:35           	Error: Could not retrieve catalog; skipping run\r\n05:10:35           /var/lib/jenkins/workspace/imaging_windows-2012r2-wmf5_x86_64_vmware_vsphere.cygwin_acceptance_packer/acceptance/puppet/acceptance/vendor/bundle/gems/beaker-3.14.0/lib/beaker/host.rb:373:in `exec''\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7521', 'https://github.com/puppetlabs/puppet/pull/6079', '2017-05-11T10:02:53.000-0700', '2019-04-04T22:34:08.000-0700', '2019-04-04T22:34:08.000-0700', 'Closed', '', 8, '0', 1, 11, 8, 1, 'fe05219b9988a3f69d65cd64319deda54e8b91c1'),
('puppet', 91271, 130202154, 6063, 'One test failure on IBM z Systems', 'We have performed the test suite on IBM z platform. The one z platform specific failure is\r\n\r\n"rspec ./spec/unit/indirector/file_bucket_file/file_spec.rb:43 # Puppet::FileBucketFile::File non-stubbing tests when servicing a save request fails if the contents collide with existing contents"\r\n\r\nThis is due to the difference of endianness, since z systems use big endianness. This test is used to test contents collision, where an MD5 collision is constructed in the test. However, in the test, the MD5 digest is represent in a little endian UINT type. So when ported to z systems, such MD5 collision is not valid. This caused the failure of this particular test. \r\n\r\nA quick workaround is to reconstruct the MD5 collision by converting the little endian to big endian expression in the test file: " ./spec/unit/indirector/file_bucket_file/file_spec.rb".\r\n\r\nOriginal code:\r\n"\r\nfirst_contents = [0x6165300e,0x87a79a55,0xf7c60bd0,0x34febd0b,\r\n                          0x6503cf04,0x854f709e,0xfb0fc034,0x874c9c65,\r\n                          0x2f94cc40,0x15a12deb,0x5c15f4a3,0x490786bb,\r\n                          0x6d658673,0xa4341f7d,0x8fd75920,0xefd18d5a].pack("I" * 16)\r\n\r\n        collision_contents = [0x6165300e,0x87a79a55,0xf7c60bd0,0x34febd0b,\r\n                              0x6503cf04,0x854f749e,0xfb0fc034,0x874c9c65,\r\n                              0x2f94cc40,0x15a12deb,0xdc15f4a3,0x490786bb,\r\n                              0x6d658673,0xa4341f7d,0x8fd75920,0xefd18d5a].pack("I" * 16)\r\n"\r\nchange to:\r\n"\r\n        first_contents_s390x = [0x0e306561,0x559aa787,0xd00bc6f7,0x0bbdfe34,0x04cf0365,0x9e704f85,0x34c00ffb,\r\n0x659c4c87,0x40cc942f,0xeb2da115,0xa3f4155c,0xbb860749,0x7386656d,0x7d1f34a4,\r\n0x2059d78f,0x5a8dd1ef].pack("I" * 16)\r\n\r\n        collision_contents_s390x = [0x0e306561,0x559aa787,0xd00bc6f7,0x0bbdfe34,0x04cf0365,0x9e744f85,0x34c00ffb,\r\n0x659c4c87,0x40cc942f,0xeb2da115,0xa3f415dc,0xbb860749,0x7386656d,0x7d1f34a4,\r\n0x2059d78f,0x5a8dd1ef].pack("I" * 16)\r\n"', 'https://tickets.puppetlabs.com/browse/PUP-4962', 'https://github.com/puppetlabs/puppet/pull/6063', '2015-07-30T10:56:23.000-0700', '2019-04-04T22:34:09.000-0700', '2019-04-04T22:34:09.000-0700', 'Closed', '', 8, '0', 1, 3, 3, 1, '2280cde831d6b6c0b10929462aa28be7906549cb'),
('puppet', 63833, 27456160, 3481, 'Use internal gem mirror for acceptance host setup', 'When using our internal gem mirror for acceptance tests, setup of the hosts still uses the default (rubygems.org). This can lead to acceptance failures due to network failures.\r\n\r\nWhen using the internal mirror for bundler, we should also use it to setup the hosts, to avoid network-related failures.', 'https://tickets.puppetlabs.com/browse/PUP-3839', 'https://github.com/puppetlabs/puppet/pull/3481', '2015-01-13T16:17:36.000-0800', '2019-04-04T22:34:10.000-0700', '2019-04-04T22:34:10.000-0700', 'Resolved', '', 4, '0', 1, 17, 4, 2, 'bfef1276296dae4a8aa6d2df2c9b011285141865'),
('puppet', 14849, 23051084, 3215, 'Windows-Vagrant: Build.sh helper and up.sh helper broken on Ubuntu / CentOS', 'Helper scripts are confirmed working on OSX, but not quite on Ubuntu due to shell / tooling variations.\r\n\r\n* `build.sh`, though it does error and skips tooling checks, does at least kick off the `packer build`\r\n* `up.sh` dies in a ball of fire, and does not start the VM (this partly has to do with the output of the `hash` command which isn''t really necessary to use as it turns out)', 'https://tickets.puppetlabs.com/browse/PUP-346', 'https://github.com/puppetlabs/puppet/pull/3215', '2013-09-18T07:24:08.000-0700', '2019-04-04T22:34:11.000-0700', '2019-04-04T22:34:11.000-0700', 'Resolved', '', 4, '0', 3, 52, 11, 4, 'cb6bc786db52c604f112141e29b8d7b1427bfafa'),
('puppet', 15345, 33085218, 3807, 'Don''t let smallwall go to sleep', '', 'https://tickets.puppetlabs.com/browse/PUP-435', 'https://github.com/puppetlabs/puppet/pull/3807', '2013-09-26T22:57:55.000-0700', '2019-04-04T22:34:12.000-0700', '2019-04-04T22:34:12.000-0700', 'Resolved', '', 1, '0', 1, 13, 0, 2, 'fccd76a6c39eaf5eed13f1d8cd7919812138a3a8'),
('puppet', 16862, 62157440, 4764, 'Add a fedora19 host to the platforms we are testing in ci.', 'We are not currently testing on fedora19 because of two test failures we haven''t had time to resolve.  I believe fedora19 is the only platform currently available in our dynamic vcloud templates running Ruby 2.0, so it would be good to get this in.\r\n\r\nThe two failures are:\r\n\r\n1) helpful_error_message_when_hostname_not_match_server_certificate.rb\r\n2) store_configs/enc_provides_node_when_storeconfigs_enabled.rb\r\n\r\nIt''s possible that #1 is a bug in our logging output.  The output is, in fact, different between fedora18 and fedora19.  I haven''t had time to track down why yet.\r\n\r\nfedora18 (and our other platforms, I believe):\r\n\r\n{code}\r\npu2huc8q6leizk3 (master) $ env RUBYLIB="/opt/puppet-git-repos/hiera/lib:/opt/puppet-git-repos/hiera-puppet/lib:${RUBYLIB}" PATH="/usr/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" puppet agent  --test --server pu2huc8q6leizk3\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: Server hostname ''pu2huc8q6leizk3'' did not match server certificate; expected one of foobar_not_my_hostname, DNS:blue_cert, DNS:foobar_not_my_hostname, DNS:one_cert, DNS:red_cert, DNS:two_cert\r\nInfo: Retrieving plugin\r\nError: /File[/var/lib/puppet/lib]: Failed to generate additional resources using ''eval_generate'': Server hostname ''pu2huc8q6leizk3'' did not match server certificate; expected one of foobar_not_my_hostname, DNS:blue_cert, DNS:foobar_not_my_hostname, DNS:one_cert, DNS:red_cert, DNS:two_cert\r\nError: /File[/var/lib/puppet/lib]: Could not evaluate: Server hostname ''pu2huc8q6leizk3'' did not match server certificate; expected one of foobar_not_my_hostname, DNS:blue_cert, DNS:foobar_not_my_hostname, DNS:one_cert, DNS:red_cert, DNS:two_cert Could not retrieve file metadata for puppet://pu2huc8q6leizk3/plugins: Server hostname ''pu2huc8q6leizk3'' did not match server certificate; expected one of foobar_not_my_hostname, DNS:blue_cert, DNS:foobar_not_my_hostname, DNS:one_cert, DNS:red_cert, DNS:two_cert\r\nError: Could not retrieve catalog from remote server: Server hostname ''pu2huc8q6leizk3'' did not match server certificate; expected one of foobar_not_my_hostname, DNS:blue_cert, DNS:foobar_not_my_hostname, DNS:one_cert, DNS:red_cert, DNS:two_cert\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\nError: Could not send report: Server hostname ''pu2huc8q6leizk3'' did not match server certificate; expected one of foobar_not_my_hostname, DNS:blue_cert, DNS:foobar_not_my_hostname, DNS:one_cert, DNS:red_cert, DNS:two_cert\r\nExited: 1\r\n{code}\r\n\r\nfedora19:\r\n{code}\r\nsvwqk4sikgo5sw7 (master) $ env RUBYLIB="/opt/puppet-git-repos/hiera/lib:/opt/puppet-git-repos/hiera-puppet/lib:${RUBYLIB}" PATH="/usr/bin:/opt/puppet-git-repos/hiera/bin:${PATH}" puppet agent  --test --server svwqk4sikgo5sw7\r\nError: Failed to apply catalog: hostname "svwqk4sikgo5sw7" does not match the server certificate\r\nError: Could not send report: hostname "svwqk4sikgo5sw7" does not match the server certificate\r\nExited: 1\r\n{code}\r\n\r\nThis is with a master running who''s config has been changed to include:\r\n\r\n{code}\r\n[master]\r\ncertname = foobar_not_my_hostname\r\ndns_alt_names = one_cert,two_cert,red_cert,blue_cert\r\n{code}\r\n\r\nRuby 2.0 issue?\r\n\r\nThe second failure is also a problem on rhel6, but we confine it there.  I do not know yet if it''s the same problem (difficulty with the sqlite packages).\r\n\r\nA configuration with a RHEL6 master and RHEL5 agent is also blocked on the store_configs test...because it''s confined RHEL6, but not RHEL5, but that leaves the test with no master to execute against...', 'https://tickets.puppetlabs.com/browse/PUP-576', 'https://github.com/puppetlabs/puppet/pull/4764', '2013-10-16T18:11:18.000-0700', '2019-04-04T22:34:14.000-0700', '2019-04-04T22:34:14.000-0700', 'Closed', '', 8, '0', 5, 332, 96, 15, 'f4b6cc2c2ceef7b1402a76b624e872dae3b98857'),
('puppet', 21566, 803304044, 8842, 'Windows generates test failures when %ALLUSERSPROFILE%\PuppetLabs\puppet doesn''t exist', 'If %ALLUSERSPROFILE%\PuppetLabs\puppet (C:\ProgramData\PuppetLabs\puppet on Win2008 R2) does not exist, a number of failures are generated.\r\n\r\nOn cursory examination, manually creating `C:\ProgramData\PuppetLabs` is not sufficient to remove the errors.\r\n\r\nOne work-around that *does* work is to run the Windows MSI package, allow it to create `C:\ProgramData\PuppetLabs` and the underlying directory hierarchy... in this case, I ran the installer, then uninstalled Puppet to leave the directory structure behind.\r\n\r\nThe failures that crop up are:\r\n\r\n<pre>\r\nFailures:\r\n\r\n  1) agent logging for ["--onetime", "--verbose", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  2) agent logging for ["--onetime", "--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  3) agent logging for ["--onetime", "--verbose", "--logdest=console"] it should behave like an\r\n agent when evoked with ["--onetime", "--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  4) agent logging for ["--onetime", "--verbose"] it should behave like an agent when evoked with ["--onetime", "--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  5) agent logging for ["--onetime", "--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--debug", "--logdest=/dev/null/foo"], logs to #<Set:\r\n {:console, "/dev/null/foo"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  6) agent logging for ["--onetime", "--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  7) agent logging for ["--onetime", "--debug", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  8) agent logging for ["--onetime", "--debug"] it should behave like an agent when evoked with\r\n ["--onetime", "--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  9) agent logging for ["--onetime", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at\r\n level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  10) agent logging for ["--onetime", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  11) agent logging for ["--onetime", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--logdest=console"], logs to #<Set: {"console"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  12) agent logging for ["--onetime"] it should behave like an agent when evoked with ["--onetime"], logs to #<Set: {:eventlog}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  13) agent logging for ["--onetime", "--no-daemonize", "--verbose", "--logdest=/dev/null/foo"]\r\n it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  14) agent logging for ["--onetime", "--no-daemonize", "--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  15) agent logging for ["--onetime", "--no-daemonize", "--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  16) agent logging for ["--onetime", "--no-daemonize", "--verbose"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  17) agent logging for ["--onetime", "--no-daemonize", "--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  18) agent logging for ["--onetime", "--no-daemonize", "--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  19) agent logging for ["--onetime", "--no-daemonize", "--debug", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  20) agent logging for ["--onetime", "--no-daemonize", "--debug"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  21) agent logging for ["--onetime", "--no-daemonize", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--logdest=/dev/null/foo"],\r\n logs to #<Set: {"/dev/null/foo"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  22) agent logging for ["--onetime", "--no-daemonize", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  23) agent logging for ["--onetime", "--no-daemonize", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--logdest=console"], logs to #<Set: {"console"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  24) agent logging for ["--onetime", "--no-daemonize"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize"], logs to #<Set: {:eventlog}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  25) agent logging for ["--no-daemonize", "--verbose", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose", "--logdest=/dev/null/foo"],\r\n logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  26) agent logging for ["--no-daemonize", "--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  27) agent logging for ["--no-daemonize", "--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  28) agent logging for ["--no-daemonize", "--verbose"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  29) agent logging for ["--no-daemonize", "--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--no-daemonize", "--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  30) agent logging for ["--no-daemonize", "--debug", "--logdest=syslog"] it should behave like\r\n an agent when evoked with ["--no-daemonize", "--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  31) agent logging for ["--no-daemonize", "--debug", "--logdest=console"] it should behave like an agent when evoked with ["--no-daemonize", "--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  32) agent logging for ["--no-daemonize", "--debug"] it should behave like an agent when evoked with ["--no-daemonize", "--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  33) agent logging for ["--no-daemonize", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--no-daemonize", "--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  34) agent logging for ["--no-daemonize", "--logdest=syslog"] it should behave like an agent when evoked with ["--no-daemonize", "--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  35) agent logging for ["--no-daemonize", "--logdest=console"] it should behave like an agent when evoked with ["--no-daemonize", "--logdest=console"], logs to #<Set: {"console"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  36) agent logging for ["--no-daemonize"] it should behave like an agent when evoked with ["--no-daemonize"], logs to #<Set: {:eventlog}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  37) agent logging for ["--verbose", "--logdest=/dev/null/foo"] it should behave like an agent\r\n when evoked with ["--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  38) agent logging for ["--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  39) agent logging for ["--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  40) agent logging for ["--verbose"] it should behave like an agent when evoked with ["--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  41) agent logging for ["--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  42) agent logging for ["--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  43) agent logging for ["--debug", "--logdest=console"] it should behave like an agent when evoked with ["--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  44) agent logging for ["--debug"] it should behave like an agent when evoked with ["--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  45) agent logging for ["--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  46) agent logging for ["--logdest=syslog"] it should behave like an agent when evoked with ["--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  47) agent logging for ["--logdest=console"] it should behave like an agent when evoked with ["--logdest=console"], logs to #<Set: {"console"}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  48) agent logging for [] it should behave like an agent when evoked with [], logs to #<Set: {:eventlog}> at level notice\r\n     Failure/Error: command_line.execute\r\n     SystemExit:\r\n       exit\r\n     Shared Example Group: "an agent" called from ./spec/integration/agent/logging_spec.rb:173\r\n     # ./lib/puppet/util.rb:498:in `exit''\r\n     # ./lib/puppet/util.rb:498:in `rescue in exit_on_fail''\r\n     # ./lib/puppet/util.rb:484:in `exit_on_fail''\r\n     # ./lib/puppet/application.rb:362:in `run''\r\n     # ./lib/puppet/util/command_line.rb:137:in `run''\r\n     # ./lib/puppet/util/command_line.rb:91:in `execute''\r\n     # ./spec/integration/agent/logging_spec.rb:79:in `double_of_bin_puppet_agent_call''\r\n     # ./spec/integration/agent/logging_spec.rb:101:in `block (3 levels) in <top (required)>''\r\n\r\n  49) Puppet::Application::Agent during setup has an application default :catalog_cache_terminus setting of ''json''\r\n     Failure/Error: @puppetd.setup\r\n     RuntimeError:\r\n       Got 0 failure(s) while initializing:\r\n     # ./lib/puppet/settings.rb:946:in `block in use''\r\n     # ./lib/puppet/resource/catalog.rb:176:in `apply''\r\n     # ./lib/puppet/settings.rb:942:in `use''\r\n     # ./lib/puppet/application/agent.rb:403:in `setup''\r\n     # ./spec/unit/application/agent_spec.rb:338:in `block (3 levels) in <top (required)>''\r\n\r\n  50) Puppet::Application::Agent during setup should tell the catalog cache class based on the :catalog_cache_terminus setting\r\n     Failure/Error: @puppetd.setup\r\n     RuntimeError:\r\n       Got 0 failure(s) while initializing:\r\n     # ./lib/puppet/settings.rb:946:in `block in use''\r\n     # ./lib/puppet/resource/catalog.rb:176:in `apply''\r\n     # ./lib/puppet/settings.rb:942:in `use''\r\n     # ./lib/puppet/application/agent.rb:403:in `setup''\r\n     # ./spec/unit/application/agent_spec.rb:346:in `block (3 levels) in <top (required)>''\r\n\r\n  51) Puppet::Application::Agent during setup should not set catalog cache class if :catalog_cache_terminus is explicitly nil\r\n     Failure/Error: @puppetd.setup\r\n     RuntimeError:\r\n       Got 0 failure(s) while initializing:\r\n     # ./lib/puppet/settings.rb:946:in `block in use''\r\n     # ./lib/puppet/resource/catalog.rb:176:in `apply''\r\n     # ./lib/puppet/settings.rb:942:in `use''\r\n     # ./lib/puppet/application/agent.rb:403:in `setup''\r\n     # ./spec/unit/application/agent_spec.rb:354:in `block (3 levels) in <top (required)>''\r\n\r\n  52) Puppet::Application::Device during setup has an application default :catalog_cache_terminus setting of ''json''\r\n     Failure/Error: @device.setup\r\n     RuntimeError:\r\n       Got 0 failure(s) while initializing:\r\n     # ./lib/puppet/settings.rb:946:in `block in use''\r\n     # ./lib/puppet/resource/catalog.rb:176:in `apply''\r\n     # ./lib/puppet/settings.rb:942:in `use''\r\n     # ./lib/puppet/application/device.rb:222:in `setup''\r\n     # ./spec/unit/application/device_spec.rb:226:in `block (3 levels) in <top (required)>''\r\n\r\n  53) Puppet::Application::Device during setup should tell the catalog cache class based on the\r\n :catalog_cache_terminus setting\r\n     Failure/Error: @device.setup\r\n     RuntimeError:\r\n       Got 0 failure(s) while initializing:\r\n     # ./lib/puppet/settings.rb:946:in `block in use''\r\n     # ./lib/puppet/resource/catalog.rb:176:in `apply''\r\n     # ./lib/puppet/settings.rb:942:in `use''\r\n     # ./lib/puppet/application/device.rb:222:in `setup''\r\n     # ./spec/unit/application/device_spec.rb:234:in `block (3 levels) in <top (required)>''\r\n\r\n  54) Puppet::Application::Device during setup should not set catalog cache class if :catalog_cache_terminus is explicitly nil\r\n     Failure/Error: @device.setup\r\n     RuntimeError:\r\n       Got 0 failure(s) while initializing:\r\n     # ./lib/puppet/settings.rb:946:in `block in use''\r\n     # ./lib/puppet/resource/catalog.rb:176:in `apply''\r\n     # ./lib/puppet/settings.rb:942:in `use''\r\n     # ./lib/puppet/application/device.rb:222:in `setup''\r\n     # ./spec/unit/application/device_spec.rb:242:in `block (3 levels) in <top (required)>''\r\n\r\nFinished in 5 minutes 58.91 seconds\r\n18673 examples, 54 failures, 74 pending\r\n\r\nFailed examples:\r\n\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--verbose", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info rspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--verbose"] it should behave like an agent when evoked with ["--onetime", "--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--debug", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--debug"] it should behave like an agent when evoked with ["--onetime", "--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--logdest=console"], logs to #<Set: {"console"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime"] it should behave like an agent when evoked with ["--onetime"], logs to #<Set: {:eventlog}> at level notice\r\n\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--verbose", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}>\r\n at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--verbose"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--debug", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--debug"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--onetime",\r\n "--no-daemonize", "--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--logdest=syslog"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize", "--logdest=console"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize", "--logdest=console"], logs to #<Set: {"console"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--onetime", "--no-daemonize"] it should behave like an agent when evoked with ["--onetime", "--no-daemonize"], logs to\r\n #<Set: {:eventlog}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--verbose", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--verbose"] it should behave like an agent when evoked with ["--no-daemonize", "--verbose"], logs to\r\n #<Set: {:console, :eventlog}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--no-daemonize", "--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level\r\n debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--no-daemonize", "--debug", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--debug", "--logdest=console"] it should behave like an agent when evoked with ["--no-daemonize", "--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--debug"] it should behave like an agent when evoked with ["--no-daemonize", "--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--no-daemonize", "--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--logdest=syslog"] it should behave like an agent when evoked with ["--no-daemonize", "--logdest=syslog"], logs to #<Set: {"syslog"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize", "--logdest=console"] it should behave like an agent when evoked with ["--no-daemonize", "--logdest=console"], logs to #<Set: {"console"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--no-daemonize"] it should behave like an agent when evoked with ["--no-daemonize"], logs to #<Set: {:eventlog}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--verbose", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--verbose", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--verbose", "--logdest=syslog"] it should behave like an agent when evoked with ["--verbose", "--logdest=syslog"], logs to #<Set: {:console, "syslog"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--verbose", "--logdest=console"] it should behave like an agent when evoked with ["--verbose", "--logdest=console"], logs to #<Set: {:console, "console"}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--verbose"] it should behave like an agent when evoked with ["--verbose"], logs to #<Set: {:console, :eventlog}> at level info\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--debug", "--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--debug", "--logdest=/dev/null/foo"], logs to #<Set: {:console, "/dev/null/foo"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--debug", "--logdest=syslog"] it should behave like an agent when evoked with ["--debug", "--logdest=syslog"], logs to\r\n #<Set: {:console, "syslog"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--debug", "--logdest=console"] it should behave like an agent when evoked with ["--debug", "--logdest=console"], logs to #<Set: {:console, "console"}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--debug"] it should behave like an agent when evoked with ["--debug"], logs to #<Set: {:console, :eventlog}> at level debug\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--logdest=/dev/null/foo"] it should behave like an agent when evoked with ["--logdest=/dev/null/foo"], logs to #<Set: {"/dev/null/foo"}> at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--logdest=syslog"] it should behave like an agent when evoked with ["--logdest=syslog"], logs to #<Set: {"syslog"}> at\r\n level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for ["--logdest=console"] it should behave like an agent when evoked with ["--logdest=console"], logs to #<Set: {"console"}>\r\n at level notice\r\nrspec ./spec/integration/agent/logging_spec.rb:90 # agent logging for [] it should behave like an agent when evoked with [], logs to #<Set: {:eventlog}> at level notice\r\nrspec ./spec/unit/application/agent_spec.rb:334 # Puppet::Application::Agent during setup has an application default :catalog_cache_terminus setting of ''json''\r\nrspec ./spec/unit/application/agent_spec.rb:341 # Puppet::Application::Agent during setup should tell the catalog cache class based on the :catalog_cache_terminus setting\r\nrspec ./spec/unit/application/agent_spec.rb:349 # Puppet::Application::Agent during setup should not set catalog cache class if :catalog_cache_terminus is explicitly nil\r\nrspec ./spec/unit/application/device_spec.rb:222 # Puppet::Application::Device during setup has\r\n an application default :catalog_cache_terminus setting of ''json''\r\nrspec ./spec/unit/application/device_spec.rb:229 # Puppet::Application::Device during setup should tell the catalog cache class based on the :catalog_cache_terminus setting\r\nrspec ./spec/unit/application/device_spec.rb:237 # Puppet::Application::Device during setup should not set catalog cache class if :catalog_cache_terminus is explicitly nil\r\n</pre>', 'https://tickets.puppetlabs.com/browse/PUP-1133', 'https://github.com/puppetlabs/puppet/pull/8842', '2013-12-17T06:22:53.000-0800', '2019-04-04T22:34:16.000-0700', '2019-04-04T22:34:16.000-0700', 'Closed', '', 2, '0', 1, 8, 12, 3, 'ba09bfe99d9ac8679b74259e55c7b31947d05d1b'),
('puppet', 54797, 22095305, 3150, 'CertificateError when running tests with OpenSSL >= 1.0.1i', 'The :minimal_certificate stub in Puppet::Network::HTTP::RackREST does everything necessary to produce a valid test certificate except sign it. An unsigned certificate has empty signing algorithm fields, which is invalid ASN.1, although OpenSSL versions prior to 1.0.1i would accept this ASN.1 anyway.\r\n\r\nWhen these tests are run on OpenSSL 1.0.1i or newer, an OpenSSL::X509::CertificateError is raised with the message "nested asn1 error". I have confirmed that the resultant ASN.1 is invalid using the dumpasn1 utility, ruling out a bug in OpenSSL reading the certificate.\r\n\r\nTo reproduce the problem, simply run (on any system with OpenSSL 1.0.1i or newer):\r\n\r\n    bundle exec rspec spec/unit/network/http/rack/rest_spec.rb\r\n\r\nThis code was introduced in a706fa30ae6be5dd5fcc3f539f31aa26cbccf42b, which is why I have selected all versions from 3.5.0 onwards as affected.\r\n\r\nI have a simple, tested patch which fixes this problem by self-signing the test certificate, which I intend to submit as a pull request on GitHub shortly.', 'https://tickets.puppetlabs.com/browse/PUP-3446', 'https://github.com/puppetlabs/puppet/pull/3150', '2014-10-12T20:31:06.000-0700', '2019-04-04T22:34:20.000-0700', '2019-04-04T22:34:20.000-0700', 'Closed', '', 5, '0', 1, 11, 8, 1, '2aa91fbc0509fe7da2fc3b83bcd7f5d8be8911f0'),
('puppet', 157127, 156554087, 6418, 'Puppet filebucket command does not pick up proper server address from server_list config property', 'I have following problem. When I changed *server* config option to *server_list* to increase redundancy, I met following problem (useless stuff omitted):\r\n{noformat}\r\nroot@localhost: puppet filebucket backup foo\r\nDebug: Runtime environment: puppet_version=4.7.0, ruby_version=2.1.9, run_mode=user, default_encoding=UTF-8\r\nInfo: Computing checksum on file foo\r\nDebug: Dynamically-bound server lookup failed; using first entry\r\nDebug: Dynamically-bound port lookup failed; using first entry\r\nDebug: Applying settings catalog for sections main, ssl\r\nDebug: /User[puppet]: Provider useradd does not support features libuser; not managing attribute forcelocal\r\nDebug: Puppet::Type::Group::ProviderDirectoryservice: file /usr/bin/dscl does not exist\r\nDebug: Puppet::Type::Group::ProviderPw: file pw does not exist\r\nDebug: Puppet::Type::Group::ProviderLdap: feature ldap is missing\r\nDebug: /Group[puppet]: Provider groupadd does not support features libuser; not managing attribute forcelocal\r\nDebug: Finishing transaction 29004960\r\nDebug: Creating new connection for https://puppet:8140\r\nError: Could not back up foo: getaddrinfo: Name or service not known\r\nError: Could not run: Could not back up foo: getaddrinfo: Name or service not known\r\n{noformat}\r\n\r\n*puppet.conf* file:\r\n{noformat}\r\n[main]\r\nserver_list=foo:8140,bar:8140,baz:8140\r\nfactpath=$vardir/lib/facter\r\nca_server=foo\r\npreferred_serialization_format=msgpack\r\n{noformat}\r\n\r\nWhen I specify both *server* and *server_list* in puppet.conf file it''s working, but I''m getting this warning:\r\n{noformat}\r\nWarning: Attempted to set both server and server_list. Server setting will not be used.\r\n   (at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/defaults.rb:1411:in `block in <module:Puppet>'')\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-6823', 'https://github.com/puppetlabs/puppet/pull/6418', '2016-10-17T05:32:09.000-0700', '2019-04-04T22:34:59.000-0700', '2019-04-04T22:34:59.000-0700', 'Closed', '', 7, '0', 1, 25, 4, 2, '976fd00aeb49457319acd5e00ba17cbe4ada6de8'),
('puppet', 96995, 156551164, 6417, 'Puppet filebucket --local uses $bucketdir instead of $clientbucketdir', 'As I''ve noticed we are finally fixing {{filebucket}} I''d love to see the following long-standing bug fixed.\r\n\r\n{code}\r\n# cat /opt/puppetlabs/puppet/cache/clientbucket/2/c/1/5/a/e/7/2/2c15ae72acdbd8878a6550275bc15fef/paths \r\n/etc/puppetlabs/puppet/puppet.conf\r\n\r\n# puppet filebucket get --local 2c15ae72acdbd8878a6550275bc15fef\r\nError: Could not run: File not found\r\n{code}\r\n\r\nThe thing is, you can find the file just fine if you manually specify the clientbucket.\r\n\r\n{code}\r\n[root@client puppet]# puppet filebucket get -b /opt/puppetlabs/puppet/cache/clientbucket 2c15ae72acdbd8878a6550275bc15fef\r\nInfo: FileBucket read 2c15ae72acdbd8878a6550275bc15fef\r\n# This file can be used to override the default puppet settings.\r\n# See the following links for more details on what settings are available:\r\n{code}\r\n\r\nLooking at the code with strace, it is trying to read the {{$bucketdir}} instead of the {{$clientbucketdir}}, which makes no sense when using the --{{local}} option.\r\n\r\nIf there is some use for --{{local}} that somehow makes sense, change this to a feature request for --{{client}} or some such option?', 'https://tickets.puppetlabs.com/browse/PUP-5206', 'https://github.com/puppetlabs/puppet/pull/6417', '2015-09-07T02:53:18.000-0700', '2019-04-04T22:35:01.000-0700', '2019-04-04T22:35:01.000-0700', 'Closed', 'puppethack', 35, '0', 2, 9, 9, 3, '173b5780f16a162401ec81420d6d880c87f2569f'),
('puppet', 22785, 110195873, 5704, 'Empty clientbucket files produce errors', 'I''m not sure how it happened, but I ended up with an empty clientbucket entry for one of my files. The ''contents'' and ''paths'' files were both present and empty. It caused this error:\r\n\r\n{code}\r\nerr: /Stage[main]/Os::Ubuntu/File[/etc/motd]/content: change from {md5}82cdaef7f3ba52467fb4e65491369889 to {md5}cd657ddfb4ff1e73910088a1d1c669ff failed: Could not back up /etc/motd: Got passed new contents for sum {md5}82cdaef7f3ba52467fb4e65491369889\r\n{code}\r\n\r\nFunky. Investigating, I see this:\r\n\r\n{code}\r\nroot@solr00-2:/var/lib/puppet/clientbucket/8/2/c/d/a/e/f/7# ls -l 82cdaef7f3ba52467fb4e65491369889/\r\ntotal 0\r\n-r--r----- 1 root root 0 2010-10-20 03:20 contents\r\n-rw-r--r-- 1 root root 0 2010-10-20 03:20 paths\r\n{code}\r\n\r\nThis could have been caused (theoretically) by me killing puppet mid-run with a reboot or something similar, so I''m not convinced this the original problem is a bug in puppet.\r\n\r\nMy request specifically is this: I think puppet should handle this case better. If the filebucket files are empty, it''s might safe to discard them - especially if ''paths'' is empty.\r\n\r\nFeel free to close this as "not a bug" if you feel such; it was a strange-enough behavior I felt it was worth sharing :)', 'https://tickets.puppetlabs.com/browse/PUP-1334', 'https://github.com/puppetlabs/puppet/pull/5704', '2014-01-01T23:04:01.000-0800', '2019-04-04T22:35:03.000-0700', '2019-04-04T22:35:03.000-0700', 'Closed', 'redmine;resolved-issue-added', 15, '0', 1, 102, 24, 2, '87f58171bb643e9291dcc436f3355ba84f421d9e'),
('puppet', 240614, 174439529, 6730, 'Hiera lookup must hard fail on invalid YAML', 'PuppetServer/Hiera just ignores broken YAML files instead of hard failing on them.\r\n\r\nThe consequences can be as serious as compromised system and/or lost network access to host. I would consider that *critical* based on experience with the problem.\r\n\r\nBelow is broken sample from hierarchy for tests:\r\n\r\n{code:yaml}\r\n---\r\n#classes:\r\n - cls1\r\n - cls2\r\n\r\nsomevar: 1\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8541', 'https://github.com/puppetlabs/puppet/pull/6730', '2018-03-11T11:13:38.000-0700', '2019-04-04T22:35:27.000-0700', '2019-04-04T22:35:27.000-0700', 'Closed', '', 14, '0', 1, 62, 2, 3, 'fc5ef05416c97e9a63e8b5afb2e06561361e6ed1'),
('puppet', 108636, 55150760, 4550, 'Cached catalogs are loaded using the agent''s string locale which can result in corrupted data', 'If a cached catalog is applied, which contains a file resource that used the {{content}} parameter, and that content begins with a byte-order mark, the character will be rendered as garbage text when that cached catalog is applied on Windows.\r\n\r\nThis does not occur during normal master-agent puppet runs, only when applying a cached catalog, and only on Windows.\r\n\r\nReproduction:\r\n\r\nDownload the attached ERB file. If you view it with {{vim -b chocolatey.confg}} you will see {{<feff>}} at the beginning, indicating the byte-order mark.\r\n\r\nUse the template with a file resource, and deploy it to a Windows System, in any location.\r\n\r\nView the file and it will appear normally.\r\n\r\nNow, apply the cached catalog, either by disabling the puppet master and performing a puppet run (note that {{--test}} disables the use of  cached catalogs), or via {{puppet apply C:\ProgramData\PuppetLabs\puppet\var\client_data\catalog\<certname>.json}} replacing {{<certname>}} with the test node''s actual certname.\r\n\r\nOpen the file on disk, and it will look like so: \r\n!Screenshot 2015-12-07 15.23.05.png|thumbnail!\r\n\r\nNote the junk characters at the beginning.\r\n\r\nTested with a CentOS 6.6 master running PE 3.8.3 (Puppet 3.8.4) and a Windows Server 2012 agent running PE 3.8.3. I also tested with both the 64 and 32 bit clients.\r\nAlso tested with the same setup, running PE 2015.2.3 (Puppet 4.2.3) on the master and Windows agent.\r\n\r\nThe current workaround would be to disable cached catalogs. I''m also working on an additional workaround that would not require this, using concat to retrieve the first part of the file via the source parameter, to avoid storing the BOM in the catalog.\r\n\r\nNote: This is *not* a PE bug. I did my testing with PE, but this is not a PE-specific bug, as far as I can tell. It deals with generic Puppet functionality only. E.g. cached catalogs on Windows.', 'https://tickets.puppetlabs.com/browse/PUP-5584', 'https://github.com/puppetlabs/puppet/pull/4550', '2015-12-07T15:26:08.000-0800', '2019-04-04T22:35:31.000-0700', '2019-04-04T22:35:31.000-0700', 'Closed', 'support', 5, '0', 1, 3, 3, 2, '78e31363a7d95e26ce80ac1fa45fead58f1859d6'),
('puppet', 108954, 54746944, 4534, 'undefined local variable or method `data'' for Puppet::Provider::Package::Windows::Package:Class', 'On a Windows 2012 R2 node, the command: "puppet resource package --trace"\r\n\r\ngenerates the following error:\r\n\r\nDebug: Puppet::Type::Package::ProviderZypper: file /usr/bin/zypper does not exist[0m\r\n[1;31mError: Could not run: undefined local variable or method `data'' for Puppet::Provider::Package::Windows::Package:Class\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/registry.rb:216:in `block in read''\r\n\r\n\r\nLine 216 in puppet/util/windows/registry.rb is this:\r\nresult = [ type, data.read_bytes(0, byte_length) ]\r\n\r\n\r\nThat line uses "data.read_bytes", but all the other lines in that case statement use "data_ptr.read_bytes". This appears to be an oversight.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5591', 'https://github.com/puppetlabs/puppet/pull/4534', '2015-12-09T13:45:00.000-0800', '2019-04-04T22:35:31.000-0700', '2019-04-04T22:35:31.000-0700', 'Closed', 'windows', 9, '0', 1, 112, 15, 2, '649df148ab1f348000f41a7f941bbfd39066321f'),
('puppet', 76212, 49490363, 4399, 'Backport PUP-4386 - group resource doesn''t work on Windows when members is an array and noop is used', 'The following resource fails: \r\n{code}\r\ngroup { ''administrators'': \r\n  ensure => present, \r\n  members => [''TESTLA\aaa02364''], \r\n}\r\n{code}\r\nWhen applied: \r\n{noformat}\r\nE:\mgmt\Puppet Labs\Puppet Enterprise\bin>puppet apply group.pp --noop \r\nNotice: Compiled catalog for p0wvaplz0013_1249_1251 in environment production in \r\n0.22 seconds \r\nError: undefined method `split'' for #<Array:0x00000006201e70> \r\nError: /Group[administrators]: Could not evaluate: Puppet::Util::Log requires a \r\nmessage \r\nNotice: Finished catalog run in 0.41 seconds\r\n{noformat}\r\n\r\nThe problem is group.rb is_to_s does not handle array.\r\n\r\n{noformat}\r\nE:\mgmt\Puppet Labs\Puppet Enterprise\bin>puppet apply group.pp --noop --trace \r\nNotice: Compiled catalog for p0wvaplz0013_1249_1251 in environment production in \r\n0.22 seconds \r\nError: undefined method `split'' for #<Array:0x000000063bd200> \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/type/group.rb:102:in `is \r\n_to_s'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction/resource_har \r\nness.rb:199:in `noop'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction/resource_har \r\nness.rb:126:in `sync_if_needed'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction/resource_har \r\nness.rb:89:in `block in perform_changes'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction/resource_har \r\nness.rb:88:in `each'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction/resource_har \r\nness.rb:88:in `perform_changes'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction/resource_har \r\nness.rb:20:in `evaluate'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction.rb:204:in `a \r\npply'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction.rb:217:in `e \r\nval_resource'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction.rb:147:in `c \r\nall'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/transaction.rb:147:in `b \r\nlock (2 levels) in evaluate'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/puppet/lib/puppet/util.rb:327:in `block in \r\nthinmark'' \r\nE:/MGMT/Puppet Labs/Puppet Enterprise/sys/ruby/lib/ruby/2.0.0/benchmark.rb:296:i \r\nn `realtime''\r\n{noformat}\r\n\r\nThis patches is_to_s method, but getting array value back for currentvalue is not expected:\r\n{code}\r\ndef is_to_s(currentvalue) \r\n  if provider.respond_to?(:members_to_s) \r\n    currentvalue = '''' if currentvalue.nil? \r\n    if currentvalue.is_a? ::Array \r\n      v = currentvalue \r\n    else \r\n    v = currentvalue.split('','') \r\n   end \r\n  return provider.members_to_s(v) \r\n  end\r\n  super(currentvalue) \r\nend\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-4426', 'https://github.com/puppetlabs/puppet/pull/4399', '2015-04-16T09:55:04.000-0700', '2019-04-04T22:35:33.000-0700', '2019-04-04T22:35:33.000-0700', 'Closed', 'customer;support;windows', 6, '0', 1, 23, 1, 3, ''),
('puppet', 98941, 47466537, 4336, 'Windows user resource should not manage password unless specified', 'Attempts to have puppet create Windows users without passwords fail with result "OLE error code:800708C5 in Active Directory. The password does not meet the password policy requirements. Check the minimum password length, password complexity and password history requirements."\r\n\r\n-`This occurs regardless of password security policy.- This only occurs when password security policy has been applied for complexity and/or minimum length.\r\n\r\nh3. Reproduction:\r\n\r\nCreate following users:\r\n\r\n{noformat}\r\nuser {''bob'': \r\n  ensure      => present,  \r\n}\r\n\r\nuser {''bob_pwd'': \r\n  ensure      => present,  \r\n  password    => ''@#SAFSawasf123'',\r\n}\r\n\r\nuser {''bob_managehome'': \r\n  ensure      => present, \r\n  managehome  => true, \r\n}\r\n\r\nuser {''bob_managehome_pwd'': \r\n  ensure      => present,  \r\n  managehome  => true,\r\n  password    => ''@#SAFSawasf123'',\r\n}\r\n\r\nuser {''bob_groups'': \r\n  ensure      => present, \r\n  groups      => ''Users'', \r\n}\r\n\r\nuser {''bob_everything'': \r\n  ensure      => present, \r\n  managehome  => true,\r\n  groups      => ''Users'', \r\n}\r\n\r\nuser {''bob_everything_pwd'': \r\n  ensure      => present, \r\n  password    => ''@#SAFSawasf123'',\r\n  managehome  => true,\r\n  groups      => ''Users'', \r\n}\r\n{noformat}\r\n\r\nRun puppet agent, then:\r\n\r\n{noformat}\r\nC:\Users\Administrator>puppet resource user\r\nuser { ''bob_everything_pwd'':\r\n  ensure => ''present'',\r\n  groups => [''Users''],\r\n  uid    => ''S-1-5-21-1953236517-242735908-2433092285-1042'',\r\n}\r\nuser { ''bob_managehome_pwd'':\r\n  ensure => ''present'',\r\n  uid    => ''S-1-5-21-1953236517-242735908-2433092285-1045'',\r\n}\r\nuser { ''bob_pwd'':\r\n  ensure => ''present'',\r\n  uid    => ''S-1-5-21-1953236517-242735908-2433092285-1041'',\r\n}\r\n{noformat}\r\n\r\nh3. Fixed by:\r\n\r\nEditing puppet/lib/puppet/util/windows/adsi.rb to force verification that password is not nil. Any attempts to use {{managehome => true}} without specifying a password should validly fail. It is not possible to logon a user (to ensure the home directories are set) without a password that is set. This also cannot address when "Minimum password length" is greater than 0, as that is a validation built-in to Windows that requires a password for all new accounts.', 'https://tickets.puppetlabs.com/browse/PUP-5271', 'https://github.com/puppetlabs/puppet/pull/4336', '2015-09-21T14:00:18.000-0700', '2019-04-04T22:35:33.000-0700', '2019-04-04T22:35:33.000-0700', 'Closed', 'windows', 16, '0', 1, 20, 3, 3, '8ea43ac195179ef01a25de2d64e218a22817b848'),
('puppet', 62782, 32276152, 3772, 'User resource cannot add DOMAIN\User style accounts (through Active Directory) and should emit error message', 'Try to create a domain style account with a manifest like:\r\n\r\n{code}\r\nuser { "domain\\bud":\r\n  ensure => present,\r\n  groups => ''Administrator''\r\n}\r\n{code}\r\n\r\nPuppet will error with {{8007089A}}\r\n\r\n{code}\r\nError: User update failed: (in OLE method `SetInfo'': )\r\n    OLE error code:8007089A in Active Directory\r\n      The specified username is invalid.\r\n\r\n    HRESULT error code:0x80020009\r\n      Exception occurred.\r\nWrapped exception:\r\n(in OLE method `SetInfo'': )\r\n    OLE error code:8007089A in Active Directory\r\n      The specified username is invalid.\r\n\r\n    HRESULT error code:0x80020009\r\n      Exception occurred.\r\nError: /Stage[main]/Main/User[domain\bud]/ensure: change from absent to present failed: User update failed: (in OLE method `SetInfo'': )\r\n    OLE error code:8007089A in Active Directory\r\n      The specified username is invalid.\r\n\r\n    HRESULT error code:0x80020009\r\n      Exception occurred.\r\n{code}\r\n\r\nThere should be some discussion around Puppets intended behavior in this case, as there are multiple potential outcomes here, given the domain user creation is usually only available to Domain Administrators.  Puppet has traditionally understood only local accounts, and has allowed the manipulation of local groups to include domain accounts.\r\n\r\nWith that said, for a {{User}} resource that references a domain account:\r\n\r\n- Puppet should try to resolve the account name to a SID as it does normally (which currently should work OK)\r\n    - When the account doesn''t exist, Puppet should trap {{8007089A}}, and expose an error to the user about the domain account not existing / state that Puppet doesn''t perform that functionality\r\n\r\n- Puppet should add the domain user to local groups where appropriate\r\n\r\n\r\nBased on a user report, Puppet may also emit {{80070562}} when trying to add the domain user to a local group.  For instance, \r\n\r\n{code}\r\nNotice: /Stage[main]/Profiles::Scd::Users/User[cppib\svc_scd_dev]/groups: groups changed ''Proofpoint Archive User Membership,Domain Users,wf1_ibimr-role_AnalyticalUser,wf1_ibimr-grp_managementre,wf1_ibimr-grp_herbiportal'' to ''Administrators,Domain Users,Proofpoint Archive User Membership,wf1_ibimr-grp_herbiportal,wf1_ibimr-grp_managementre,wf1_ibimr-role_AnalyticalUser''\r\n\r\nError: /User[cppib\svc_scd_dev]: Could not evaluate: User update failed: (in OLE method `SetInfo'': )\r\n    OLE error code:80070005 in Active Directory\r\n      Access is denied.\r\n\r\n    HRESULT error code:0x80020009\r\n      Exception occurred.\r\nWrapped exception:\r\n(in OLE method `SetInfo'': )\r\n    OLE error code:80070005 in Active Directory\r\n      Access is denied.\r\n\r\n    HRESULT error code:0x80020009\r\n      Exception occurred.\r\n\r\nNotice: Finished catalog run in 18.38 seconds\r\n{code}\r\n\r\nOn the second run:\r\n\r\n{code}\r\nError: (in OLE method `Add'': )\r\n    OLE error code:80070562 in Active Directory\r\n      The specified account name is already a member of the group.\r\n\r\n    HRESULT error code:0x80020009\r\n      Exception occurred.\r\n\r\nError: /Stage[main]/Profiles::Scd::Users/User[cppib\svc_scd_dev]/groups: change from Proofpoint Archive User Membership,Domain Users,wf1_ibimr-role_AnalyticalUser,wf1_ibimr-grp_managementre,wf1_ibimr-grp_herbiportal to Administrators,Domain Users,Proofpoint Archive User Membership,wf1_ibimrgrp_herbiportal,wf1_ibimr-grp_managementre,wf1_ibimr-role_AnalyticalUser failed: (in OLE method `Add'': )\r\n    OLE error code:80070562 in Active Directory\r\n      The specified account name is already a member of the group.\r\n\r\n    HRESULT error code:0x80020009\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3804', 'https://github.com/puppetlabs/puppet/pull/3772', '2015-01-02T15:28:30.000-0800', '2019-04-04T22:35:35.000-0700', '2019-04-04T22:35:35.000-0700', 'Closed', 'windows', 6, '0', 1, 41, 2, 3, 'a1ecf56b67f8ad595d8b4e405b8107324ce8f9a8'),
('puppet', 36490, 31982023, 3753, 'Ability to add a member to a group, instead of specifying the complete list', 'On Windows, if you try to add a (domain) member to the local ''Administrators'' group, you have to specify the complete list of members. Otherwise, puppet will remove current members that are not desired.\r\nThe `auth_membership` group parameter is designed to control whether the list of members is inclusive or explicit, like the `auth_membership` user parameter. However, the windows group provider does not take the `auth_membership` group parameter into account.', 'https://tickets.puppetlabs.com/browse/PUP-2628', 'https://github.com/puppetlabs/puppet/pull/3753', '2014-05-20T16:58:01.000-0700', '2019-04-04T22:35:36.000-0700', '2019-04-04T22:35:36.000-0700', 'Closed', 'docs_reviewed;windows', 13, '0', 1, 46, 6, 4, '146c4723f08f1df96331cf1cb96026566b15de15'),
('puppet', 36783, 36862940, 3996, 'Puppet apply fails to write the graph if puppet agent has never run', 'Via ENTERPRISE-181:\r\nThis is a general puppet platform issue. It can occur (on any platform) when all of the following are true:\r\n\r\n# The `$vardir/state/graphs` directory doesn''t exist\r\n# The `graph` setting is true\r\n# The agent has never run before\r\n\r\nExecuting `puppet apply` will fail to write the catalog.\r\n\r\nOn Windows (PE only), we set `graph` to true: https://github.com/puppetlabs/puppet_for_the_win/blob/master/wix/puppet.wxs#L302-L306.\r\n\r\nOn *nix (PE only), we set `graph` to true: https://github.com/puppetlabs/enterprise-dist/blob/3.3.x/ext/erb/puppet.conf.erb#L52\r\n\r\n{noformat}\r\n$ bundle exec puppet apply -e "notice ''foo''" --graphNotice: Scope(Class[main]): foo\r\nNotice: Compiled catalog for arcturus.luna.lan in environment production in 0.01 seconds\r\nError: No such file or directory - /Users/josh/.puppet/var/state/graphs/resources.dot\r\n{noformat}\r\n\r\nOn Windows:\r\n\r\n{noformat}\r\nC:\work\puppet [stable +1 ~0 -0 !]> bundle exec puppet apply -e "notice ''foo''" --graph --trace\r\nNotice: Scope(Class[main]): foo\r\nNotice: Compiled catalog for win-qp47voha2p4.solar.lan in environment production in 0.05 seconds\r\nError: No such file or directory - C:/ProgramData/PuppetLabs/puppet/var/state/graphs/resources.dot\r\nC:/work/puppet/lib/puppet/graph/simple_graph.rb:474:in `initialize''\r\nC:/work/puppet/lib/puppet/graph/simple_graph.rb:474:in `open''\r\nC:/work/puppet/lib/puppet/graph/simple_graph.rb:474:in `write_graph''\r\nC:/work/puppet/lib/puppet/resource/catalog.rb:448:in `write_graph''\r\nC:/work/puppet/lib/puppet/resource/catalog.rb:231:in `finalize''\r\nC:/work/puppet/lib/puppet/application/apply.rb:219:in `block in main''\r\nC:/work/puppet/lib/puppet/context.rb:56:in `override''\r\nC:/work/puppet/lib/puppet.rb:234:in `override''\r\nC:/work/puppet/lib/puppet/application/apply.rb:190:in `main''\r\nC:/work/puppet/lib/puppet/application/apply.rb:151:in `run_command''\r\nC:/work/puppet/lib/puppet/application.rb:371:in `block (4 levels) in run''\r\nC:/work/puppet/lib/puppet/application.rb:479:in `plugin_hook''\r\nC:/work/puppet/lib/puppet/application.rb:371:in `block (3 levels) in run''\r\nC:/work/puppet/lib/puppet/util.rb:479:in `exit_on_fail''\r\nC:/work/puppet/lib/puppet/application.rb:371:in `block (2 levels) in run''\r\nC:/work/puppet/lib/puppet/context.rb:56:in `override''\r\nC:/work/puppet/lib/puppet.rb:234:in `override''\r\nC:/work/puppet/lib/puppet/application.rb:361:in `block in run''\r\nC:/work/puppet/lib/puppet/context.rb:56:in `override''\r\nC:/work/puppet/lib/puppet.rb:234:in `override''\r\nC:/work/puppet/lib/puppet/application.rb:356:in `run''\r\nC:/work/puppet/lib/puppet/util/command_line.rb:137:in `run''\r\nC:/work/puppet/lib/puppet/util/command_line.rb:91:in `execute''\r\nC:/work/puppet/bin/puppet:4:in `<top (required)>''\r\nC:/work/puppet/.bundle/gems/ruby/1.9.1/bin/puppet:23:in `load''\r\nC:/work/puppet/.bundle/gems/ruby/1.9.1/bin/puppet:23:in `<main>''\r\n{noformat}\r\n\r\nThe problem is that the code that writes the graph, {{Catalog.write_graph}}, executes before the code that creates the necessary directories, {{Puppet.settings.use(:agent)}}.', 'https://tickets.puppetlabs.com/browse/PUP-2638', 'https://github.com/puppetlabs/puppet/pull/3996', '2014-05-22T13:11:30.000-0700', '2019-04-04T22:35:36.000-0700', '2019-04-04T22:35:36.000-0700', 'Closed', '', 6, '0', 1, 26, 2, 5, 'f3f1702b490a9ae0291bd4335916d9b05cf0f957'),
('puppet', 55159, 0, 0, 'Windows Puppet x86 Installer Expands Environment Variables in Path', 'h2. Puppet installer expands path variables and it should not\r\nWhen installing Puppet Agent X86 installer on a Windows machine, any environment variables in PATH are expanded afterwards.\r\n\r\nFor example, before Puppet installation:\r\nPATH=%SystemRoot%\system32;%SystemRoot%;\r\n\r\nAfter:\r\nPATH=c:\windows\system32;c:\windows;c:\Program Files\Puppet Labs\Puppet\bin;\r\n\r\nThis is bad, the puppet installer should not expand environment variables in PATH.\r\n\r\n\r\nh2. Original Issue\r\nWhen installing Puppet Agent on a x64 Windows distribution, we noticed that the PATH environment variable is corrupted afterwards.\r\n\r\nIn fact, it seems that Puppet removes all %SystemRoot% references in the PATH variable in both 64 and 32 bit environments\r\n\r\nFor example, before Puppet installation we had:\r\nPATH=%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Progra~2\WINDOWS RESOURCE KITS\TOOLS\\r\n\r\nAfter:\r\nPATH=C:\Progra~2\WINDOWS RESOURCE KITS\TOOLS\;C:\Progra~1\PUPPET LABS\PUPPET\BIN\r\n\r\nAll %SystemRoot% based variable are gone.\r\nThis is major issue because it basically corrupt the entire machine as we don''t have access to standard Windows command anymore:\r\nC:\Users\bhebert>hostname\r\n''hostname'' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n\r\nBeside, the facter command cannot function well\r\n\r\nTo install Puppet Agent, we run the following command:\r\ncmd /c msiexec /qn /i C:\puppet-x86-3.7.1.msi PUPPET_AGENT_STARTUP_MODE=Manual\r\n\r\nWe don''t have the issue if we use the x64 Puppet Installer., but some modules are not ready yet as they are using the C:\Windows\Sysnative path which doesn''t exist in a 64 bit context.\r\n\r\nCan you please have a look ?\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3471', 'https://github.com/puppetlabs/puppet/commit/8274947c49b30b7301bc87808c1dd872a342cffe', '2014-10-15T04:19:06.000-0700', '2019-04-04T22:35:37.000-0700', '2019-04-04T22:35:37.000-0700', 'Closed', 'installation;windows', 28, '0', 0, 0, 0, 0, '8274947c49b30b7301bc87808c1dd872a342cffe'),
('puppet', 58185, 32555805, 3786, 'Unable to create/force empty Windows groups', 'In Windows, many groups are built-in and cannot be removed, therefore {{ensure => absent}} is useless.  Another approach would be to define the group as present with no members.  For example:\r\n\r\n{noformat}\r\ngroup { ''Guests'':\r\n  ensure  => ''present'',\r\n  members => [],\r\n}\r\n{noformat}\r\n\r\nUnfortunately, this will not remove any members of the built-in Guests group, but instead leave any members existing.\r\n\r\nThe underlying goal is to ensure that all unnecessary groups are empty.\r\n\r\nh3. Update for Puppet 4\r\nIn PUP 4.x+, because groups are not authoritative by default, you need the add {{auth_membership => true}} to the mix to force an existing group to empty.\r\n\r\n{noformat}\r\ngroup { ''Guests'':\r\n  ensure  => ''present'',\r\n  members => [],\r\n  auth_membership => true,\r\n}\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3653', 'https://github.com/puppetlabs/puppet/pull/3786', '2014-11-10T12:41:49.000-0800', '2019-04-04T22:35:37.000-0700', '2019-04-04T22:35:37.000-0700', 'Closed', 'puppet-agent;windows', 11, '0', 1, 133, 35, 4, '5c3ee97d1cb38ded41183719350d6e233fe14664'),
('puppet', 11206, 37225536, 4017, 'Puppet returns different result non-existent services on EL and Debian', 'EL and Debian have different results for service resources that don''t exist.\n\nOn EL, `puppet resource service abcdefg` will return\n\n    service { ''abcdefg'':\n      ensure => ''stopped'',\n      enable => ''false'',\n    }\n\nOn Debian, this will return\n\n    Error: Could not run: Could not find init script for ''abcdefg''\n\nWhile what is returned by puppet on EL is technically true, it isn''t particularly useful. Puppet on EL doesn''t seem to have a notion of a purged service.\n\nThis causes issues for Live Management in PE 3, since we are adding service as a browsable resource type (appears in the list of resources under ''Browse Resources'') - see PE-714.', 'https://tickets.puppetlabs.com/browse/PUP-41', 'https://github.com/puppetlabs/puppet/pull/4017', '2013-06-19T02:52:48.000-0700', '2019-04-04T22:35:38.000-0700', '2019-04-04T22:35:38.000-0700', 'Closed', 'manage-service', 10, '0', 1, 1, 1, 1, '3105b2e392b7980ae5e0c4b9e46135a0ad498056'),
('puppet', 13162, 15710563, 2631, 'Puppet agent cannot read facts.d on Windows', 'Links to PE-1237\n\nNeeded for 3.0.1', 'https://tickets.puppetlabs.com/browse/PUP-221', 'https://github.com/puppetlabs/puppet/pull/2631', '2013-08-09T11:38:23.000-0700', '2019-04-04T22:35:43.000-0700', '2019-04-04T22:35:43.000-0700', 'Resolved', '', 1, '0', 14, 84, 43, 18, 'cd4e69f5dafac33740b6c1d711451f8da169cae3'),
('puppet', 13837, 17325949, 2780, 'Empty string element in containment path array', 'Now that we are storing resource containment paths in PuppetDB, we''ve noticed that many of the paths that puppet passes around contain an empty element.\n\nFor example, if you watch the log messages on an agent run, you may see a resource path logged like this:\n\n    /Stage[main]//Foo/Notify[''bar'']\n\nNote the double slash after Stage.  When we receive the containment path in the report processor, it''s represented as an array of strings, and in a case like the one above, the array would look like this:\n\n    ["Stage[main]", "", "Foo", "Notify[''bar'']"]\n\nI''m questioning whether or not that empty string at index 1 is intentional or not.  It seems like it''s probably not, and that we should probably tweak puppet to get rid of it...\n\nI''m also debating whether or not the PuppetDB report terminus should filter this out.  If it''s not meaningful and is just going to confuse end users, then we probably should; if we''re going to get rid of it in Puppet, then it probably makes sense to add a filter for it in the PuppetDB terminus so that the data looks consistent between older versions of puppet and new ones.\n\nHowever, at this point, I''m mostly just trying to determine whether or not this behavior is intentional, and decide what to do about it.\n\nNOTE: I do not consider this to be a blocker for the upcoming PE release, just want to get a conversation started.\n\n', 'https://tickets.puppetlabs.com/browse/PUP-278', 'https://github.com/puppetlabs/puppet/pull/2780', '2013-08-29T09:02:52.000-0700', '2019-04-04T22:35:43.000-0700', '2019-04-04T22:35:43.000-0700', 'Closed', '', 9, '0', 1, 115, 114, 32, 'aa71b463c4687066f9b5759e0ba92f17b0e72657'),
('puppet', 13528, 44960196, 4246, 'Recursive file resources (and probably all implicit resources) have no containment path', 'This is a duplicate of Redmine #22229; bringing it in to Jira because [~wagner] has indicated that this is a blocker for Burgundy release.\n\n------------------------------------------------------------------------------------\n\nWhen a directory is being managed recursively, the file resources created within the directory do not have any class containment.\nFor example:\n\n    file { ''/tmp/example'':\n      source  => ''puppet:///modules/example/example'',\n      recurse => true,\n    }\n\nWill result in:\n\n    Notice: **/Stage[main]/Example**/File[/tmp/example]/ensure: created\n    Notice: /File[/tmp/example/example_directory]/ensure: created\n    Notice: /File[/tmp/example/example_directory/example_file3]/ensure: defined content as ''{md5}d41d8cd98f00b204e9800998ecf8427e''\n    Notice: /File[/tmp/example/example_file2]/ensure: defined content as ''{md5}d41d8cd98f00b204e9800998ecf8427e''\n    Notice: /File[/tmp/example/example_file1]/ensure: defined content as ''{md5}d41d8cd98f00b204e9800998ecf8427e''\n\nNotice how the explicit resource shows its containment path as starting from `Stage[main]`, and includes the class that contains the resource; however, all of the implicit resources appear to be top-level resources.  This has a big impact on the usefulness of the Burgundy UI.', 'https://tickets.puppetlabs.com/browse/PUP-257', 'https://github.com/puppetlabs/puppet/pull/4246', '2013-08-20T15:58:15.000-0700', '2019-04-04T22:35:44.000-0700', '2019-04-04T22:35:44.000-0700', 'Resolved', '', 1, '0', 2, 43, 0, 2, 'f7c912042d76253ab590022c63c2d83875782d6d'),
('puppet', 13337, 124522772, 5956, 'Filebucket corrupts files', 'I am escalating the following issue as a priority 3. \n\nhttps://support.puppetlabs.com/tickets/2682\n\nEssentially the customer has given me a set of manifests and files that will always cause an error backing up files to the file bucket.  \n\nThe issue with the filebucket can be resolved by deleting corresponding files from the bucket folder on the master, however, that isn''t scalable when he''s trying to deploy this to new nodes on a regular basis.  \n\nI''ve attached the files to recreate the issue and an example puppet run output as the most recent comment on the ticket.  I''m hoping someone can let us know why the issue is occurring and hopefully provide a patch or a workaround.  ', 'https://tickets.puppetlabs.com/browse/PUP-228', 'https://github.com/puppetlabs/puppet/pull/5956', '2013-08-14T14:59:06.000-0700', '2019-04-04T22:35:46.000-0700', '2019-04-04T22:35:46.000-0700', 'Resolved', '', 6, '0', 1, 27, 7, 5, '41c88a2732b546f570414ff06279b3be1393e7e2'),
('puppet', 13775, 36338125, 3966, 'Versionable Windows Package Provider', 'See PE-1269', 'https://tickets.puppetlabs.com/browse/PUP-272', 'https://github.com/puppetlabs/puppet/pull/3966', '2013-08-28T12:19:18.000-0700', '2019-04-04T22:35:46.000-0700', '2019-04-04T22:35:46.000-0700', 'Resolved', 'windows', 1, '0', 2, 1, 1, 2, '4646e50b42c0938b644f56b121b042bcf8587aab'),
('puppet', 13795, 17807513, 2825, 'Too many new clients can cause CA to get confused', 'If too many new clients try to check in to the CA at the same time, the CA gets confused. Errors on the client say Cannot find certificate request for $HOSTNAME. The problem is that $HOSTNAME does not actually match the hostname of the client returning the error. I have since been using a ssh loop to avoid having them all check in at the same time and have not encountered this again, but I saw it with as little as 5 servers checking in for the first time at the same time.\n', 'https://tickets.puppetlabs.com/browse/PUP-277', 'https://github.com/puppetlabs/puppet/pull/2825', '2013-08-28T14:50:24.000-0700', '2019-04-04T22:35:47.000-0700', '2019-04-04T22:35:47.000-0700', 'Closed', '', 7, '0', 1, 1, 1, 1, 'f6eb2afe292902d1fccaeadb71425da9ee6d12be'),
('puppet', 13908, 366177063, 7940, 'Accept processor should handle ''Accept: */*''', 'Puppet dashboard makes cert requests using an Accept of `*/*`, which is not accepted by a puppet master.\n\n** cd /opt/puppet/share/puppet-dashboard; /opt/puppet/bin/bundle exec /opt/puppet/bin/rake -s -f /opt/puppet/share/puppet-dashboard/Rakefile cert:request RAILS_ENV=production\nrake aborted!\n406 "Not Acceptable"\nThe master log has the following entry: Aug 30 11:35:52 localhost puppet-master[26755]: Not Acceptable: No supported formats are acceptable (Accept: */*)', 'https://tickets.puppetlabs.com/browse/PUP-282', 'https://github.com/puppetlabs/puppet/pull/7940', '2013-08-30T11:54:36.000-0700', '2019-04-04T22:35:47.000-0700', '2019-04-04T22:35:47.000-0700', 'Resolved', '', 1, '0', 1, 2, 2, 1, '06457685caaf24285f5ff0de6a4c61248752daee'),
('puppet', 14613, 144486500, 6258, 'Reports nolonger work for clients older than 3.3.0 when using a 3.3.0 puppet master', '', 'https://tickets.puppetlabs.com/browse/PUP-336', 'https://github.com/puppetlabs/puppet/pull/6258', '2013-09-13T09:48:35.000-0700', '2019-04-04T22:35:48.000-0700', '2019-04-04T22:35:48.000-0700', 'Resolved', '', 2, '0', 1, 23, 3, 3, '7b4f1bc25ef5e442e587a00de3f19d75fc7ed6c6'),
('puppet', 13477, 0, 0, 'Reports are inconsistent in the way they expose failures; or, bug in the `init` provider for `service`', 'We encountered an issue today (PE-1300) where a failure occurred during a puppet run, but did not show up as a failure event in PuppetDB.  This can be reproduced with the following manifest snippet:\n\n    package {"does_not_exist":\n        ensure => present\n    }\n    \n    service { "does_not_exist":\n        provider => init,\n        ensure => running\n    }\n\nIf you then put a breakpoint in any report processor and examine the `resource_statuses` array, you''ll see that for the `package` resource, there is an event object inside of its `events` array describing the failure.  However, in the `service` resource status, although it is marked as `failed=true`, there are no objects in the `events` array.\n\nUp until now, the PuppetDB report processor had been written with the assumption that any resource failure would show up in the report as an event in the `events` array of the appropriate resource status.  Thus, we were missing the failure for this `service` resource and not storing anything about it in PuppetDB.  We''ll change the PuppetDB report processor to at least fabricate a failure event for this case, so that we''re storing *something*... but without puppet generating an event object, we don''t have access to the `property`, `old_value`, `new_value`, or `message` data which the user needs in order to understand the failure.\n\nSo... long story short... it is my contention that puppet should never generate a report that contains a resource status that is flagged as `failed` unless puppet also provides an object in the `events` array.  I think that we should put an explicit check for this into the puppet code.\n\nBeyond that, this seems like a bug in the `init` provider for the `service` type, which should also be fixed.\n\nNOTE: we''ve tested this same scenario with the `launchd` provider for `service`, and it correctly generates the event as expected.', 'https://tickets.puppetlabs.com/browse/PUP-254', 'https://github.com/puppetlabs/puppet/commit/e1687b9beb0fef9c4ea053b2f721748eeb7a920b', '2013-08-19T15:28:06.000-0700', '2019-04-04T22:35:48.000-0700', '2019-04-04T22:35:48.000-0700', 'Closed', '', 4, '0', 0, 0, 0, 0, 'e1687b9beb0fef9c4ea053b2f721748eeb7a920b'),
('puppet', 14322, 36876456, 4000, 'Puppet doesn''t gracefully handle invalid state.yaml when using Psych parser', 'state.yaml can be invalid for a number of reasons, and when it cannot be correctly loaded Puppet tries to rescue the error. This works in Syck (default in ruby 1.8), but fails in ruby 1.9 with Psych because the loaderror is raised as a Psych::SyntaxError which is a subclass of SyntaxError. A blind rescue won''t catch a SyntaxError, so Puppet needs to also rescue Psych::SyntaxError to gracefully handle an invalid state.yaml file.\n\nA puppet apply run after deliberately invalidating state.yaml:\n\n<pre>\n[root@el5-64 ~]# puppet apply --exec ''notify {"hello":}''\nNotice: Compiled catalog for el5-64.localdomain in environment production in 0.04 seconds\nError: Could not run: (<unknown>): could not find expected '':'' while scanning a simple key at line 4 column 3\n</pre>\n\nWe use the following bit of code in lib/puppet/indirector/yaml.rb that would help alleviate this problem.\n\n<pre>\n  4 class Puppet::Indirector::Yaml < Puppet::Indirector::Terminus\n  5   if defined?(::Psych::SyntaxError)\n  6     YamlLoadExceptions = [::StandardError, ::ArgumentError, ::Psych::SyntaxError]\n  7   else\n  8     YamlLoadExceptions = [::StandardError, ::ArgumentError]\n  9   end\n</pre>', 'https://tickets.puppetlabs.com/browse/PUP-308', 'https://github.com/puppetlabs/puppet/pull/4000', '2013-09-09T16:15:12.000-0700', '2019-04-04T22:35:49.000-0700', '2019-04-04T22:35:49.000-0700', 'Resolved', '', 1, '0', 1, 58, 14, 3, 'fbf42c143c6217916dbe423c3a7457ed238e716c'),
('puppet', 14434, 20993301, 3066, 'Excessive logging from files not found in file resources', '', 'https://tickets.puppetlabs.com/browse/PUP-315', 'https://github.com/puppetlabs/puppet/pull/3066', '2013-09-11T10:15:37.000-0700', '2019-04-04T22:35:49.000-0700', '2019-04-04T22:35:49.000-0700', 'Resolved', '', 1, '0', 1, 32, 5, 1, 'b9412463e3a72826c1c3ca332d2cbc402f0e8e0a'),
('puppet', 15323, 32174951, 3763, 'Reboot module has temp description', 'There''s a fake description for the reboot module. See attached screenshot. It looks amateurish. We should either give it a real description or remove the description altogether.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-433', 'https://github.com/puppetlabs/puppet/pull/3763', '2013-09-26T12:23:19.000-0700', '2019-04-04T22:35:51.000-0700', '2019-04-04T22:35:51.000-0700', 'Resolved', 'windows', 2, '0', 1, 9, 2, 3, 'e5211fdee9d73424af8ac72dca7826d28384b8b1'),
('puppet', 15910, 33400119, 3824, 'Puppet times out when receiving large reports', 'Running `puppet agent -t` on a node containing a manifest with 10,000 file resources times out trying to submit the report.\r\n\r\nIn 2.8.2 the error is\r\nnotice: Finished catalog run in 118.16 seconds\r\nerr: Could not run Puppet configuration client: execution expired\r\n\r\nIn 3.1.0 the error is\r\nrror: Could not retrieve catalog from remote server: Timeout::Error\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run', 'https://tickets.puppetlabs.com/browse/PUP-439', 'https://github.com/puppetlabs/puppet/pull/3824', '2013-10-01T09:06:59.000-0700', '2019-04-04T22:35:52.000-0700', '2019-04-04T22:35:52.000-0700', 'Closed', 'qa-reviewed;scalability', 7, '0', 1, 19, 3, 2, '365616e6d4e1bd020aad68e2c2a1391115693e62'),
('puppet', 16199, 308842675, 7678, 'Puppet cannot store empty files into filebucket', 'Steps to reproduce:\r\n\r\n1. Configure a master and an agent (can be on a single machine)\r\n2. Create an empty file\r\n3. Try to backup the file\r\n\r\nExpected behaviour: The file is stored in the filebucket\r\nActual behaviour: Error 400 is raised\r\n\r\n{code}\r\nroot@petest:/tmp# >tstfile\r\nroot@petest:/tmp# puppet filebucket backup /tmp/tstfile        \r\nError: Could not back up /tmp/tstfile: Error 400 on SERVER: No data to save\r\nError: Could not run: Could not back up /tmp/tstfile: Error 400 on SERVER: No data to save\r\n{code}\r\n\r\nWhen run with a local filebucket everything looks good:\r\n\r\n{code}\r\nroot@petest:/tmp# puppet filebucket backup /tmp/tstfile --local\r\n/tmp/tstfile: d41d8cd98f00b204e9800998ecf8427e\r\n{code}\r\n\r\nWhen there''s content in the file it looks good as well:\r\n\r\n{code}\r\nroot@petest:/tmp# echo Hello >tstfile\r\nroot@petest:/tmp# puppet filebucket backup /tmp/tstfile\r\n/tmp/tstfile: 09f7e02f1290be211da707a266f153b3\r\n{code}\r\n\r\nThis happens in the following version (not sure what is the first affected version):\r\n{code}\r\nroot@petest:/tmp# puppet --version\r\n3.3.1 (Puppet Enterprise 3.1.0-rc1-3-geacb9a8)\r\n{code}\r\n\r\nThis looks like a major bug since any content change on a file that''s empty prevents the catalog from successful applying.\r\n\r\nNote: The same operation works fine with PE 2.8.1\r\n', 'https://tickets.puppetlabs.com/browse/PUP-510', 'https://github.com/puppetlabs/puppet/pull/7678', '2013-10-03T08:15:29.000-0700', '2019-04-04T22:35:52.000-0700', '2019-04-04T22:35:52.000-0700', 'Resolved', '', 1, '0', 1, 31, 4, 2, 'cb2dfe2647f0d7c911492590fd5106cd13ecbd29'),
('puppet', 16552, 50906049, 4453, 'Puppet should not use --include-dependencies with gem provider', 'This is a customer request for a backport of c07f0a9 (#19663) to PE 2.8.x. Ruby Gems 2.0 and newer outright reject the --include-dependencies flag which prevents Puppet from managing gems on newer Ruby installations.', 'https://tickets.puppetlabs.com/browse/PUP-544', 'https://github.com/puppetlabs/puppet/pull/4453', '2013-10-10T10:52:07.000-0700', '2019-04-04T22:35:53.000-0700', '2019-04-04T22:35:53.000-0700', 'Resolved', 'customer;redmine;support', 9, '0', 1, 10, 7, 1, '7e719dbe8285b56c5a28bb1d696c92bb972565de'),
('puppet', 16482, 49043123, 4383, 'Race condition in filebucket', 'The file bucket writes files in an unsafe way. First it tests for the existence of the file, and then it attempts to write to the file if it doesn''t exist. Since file contents are written with 440 permissions, this raises a permission denied error and causes an agent failure.', 'https://tickets.puppetlabs.com/browse/PUP-538', 'https://github.com/puppetlabs/puppet/pull/4383', '2013-10-09T10:48:28.000-0700', '2019-04-04T22:35:53.000-0700', '2019-04-04T22:35:53.000-0700', 'Closed', 'qa-reviewed', 10, '0', 1, 30, 35, 3, 'd9c3dac72a0b43711e6f4d8a3c6f9c425778d5f0'),
('puppet', 16810, 58085139, 4620, 'Puppet events from Debian show in event inspector as "unclassified"', 'This issue is being reported against Event Inspector but may have an underlying cause in Puppet or PuppetDB.\r\n\r\nEvents from Debian-based systems are not correctly associated with a class when viewed in Event Inspector. This means that "Classes with Failures" can be zero, while "Nodes with Failures" can show _n_ Debian nodes where _n_ is not zero.\r\n\r\nTake the following class for example.\r\n\r\n{code}\r\nclass profile::localusers {\r\n\r\n  # The guy driving the demo\r\n  user { ''reid'':\r\n    ensure => present,\r\n    uid    => ''1500'',\r\n  }\r\n\r\n  # User Experience design team\r\n  user { ''joe'':\r\n    ensure => present,\r\n    uid    => ''1501'',\r\n  }\r\n\r\n  # Puppet Enterprise product owner\r\n  user { ''lindsey'':\r\n    ensure => present,\r\n    uid    => ''1502'',\r\n  }\r\n\r\n  # A system user\r\n  user { ''git'':\r\n    ensure => present,\r\n    uid    => ''501'',\r\n  }\r\n\r\n  # A system user also. Does the same thing as the git user so\r\n  # best practices aside I want it to have the same uid as git.\r\n  user { ''svn'':\r\n    ensure => present,\r\n    uid    => ''501'',\r\n  }\r\n\r\n}\r\n{code}\r\n\r\nApplying to five nodes, three CentOS, a Debian and an Ubuntu, we get the following results.\r\n\r\n!Screen Shot 2013-10-15 at 12.14.57 PM.png|width="700"!\r\n\r\n!Screen Shot 2013-10-15 at 12.27.10 PM.png|width="700"!\r\n\r\n!Screen Shot 2013-10-15 at 12.15.08 PM.png|width="700"!\r\n\r\n!Screen Shot 2013-10-15 at 12.15.14 PM.png|width="700"!\r\n\r\n!Screen Shot 2013-10-15 at 12.15.18 PM.png|width="700"!\r\n\r\nNote the failed resources in the Debian nodes, marked "unclassified''.\r\n\r\n(The images don''t show up in the preview, hopefully it works after the issue is created)', 'https://tickets.puppetlabs.com/browse/PUP-565', 'https://github.com/puppetlabs/puppet/pull/4620', '2013-10-16T09:17:18.000-0700', '2019-04-04T22:35:54.000-0700', '2019-04-04T22:35:54.000-0700', 'Closed', '', 7, '0', 2, 37, 5, 2, 'cd6f35e9e5d1580067ed2d22b92272ebbbbb08ce'),
('puppet', 17099, 783926189, 8824, 'Cached catalogs no longer work in PE 3.0.0 and above', 'From Redmine:\r\n\r\nCached catalogs no longer work in PE 3.0.0 and above.\r\n\r\nNote: I’ve truncated the output where it made sense to do so.\r\n\r\nPE 2.8.3:\r\n\r\n{code}\r\n[root@pe-28-master ~]# puppet --version\r\n2.7.23 (Puppet Enterprise 2.8.3)\r\n\r\n[root@pe-28-master ~]# cat /etc/puppetlabs/puppet/manifests/site.pp\r\nnode default {\r\n  # This is where you can declare classes for all nodes.\r\n  # Example:\r\n  #   class { ''my_class'': }\r\n}\r\n\r\nnotify { ''BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD'':}\r\n\r\n[root@pe-28-master ~]# puppet agent --onetime --no-daemonize --verbose\r\ninfo: Caching catalog for pe-28-master.puppetdebug.vlan\r\ninfo: Applying configuration version ''1382386729''\r\nnotice: BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD\r\nnotice: /Stage[main]//Notify[BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD]/message: defined ''message'' as ''BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD''\r\nnotice: Finished catalog run in 0.05 seconds\r\n\r\n[root@pe-28-master ~]# /etc/init.d/pe-httpd stop\r\nStopping pe-httpd:                                         [  OK  ]\r\n[root@pe-28-master ~]# puppet agent --onetime --no-daemonize --verbose\r\ninfo: Retrieving plugin\r\nerr: /File[/var/opt/lib/pe-puppet/lib]: Failed to generate additional resources using ''eval_generate: Connection refused - connect(2)\r\nerr: /File[/var/opt/lib/pe-puppet/lib]: Could not evaluate: Connection refused - connect(2) Could not retrieve file metadata for puppet://pe-28-master.puppetdebug.vlan/plugins: Connection refused - connect(2)\r\ninfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/pe_version.rb\r\ninfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/facter_dot_d.rb\r\ninfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/puppet_vardir.rb\r\ninfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/root_home.rb\r\ninfo: Loading facts in /opt/puppet/share/puppet/modules/auth_conf/lib/facter/custom_auth_conf.rb\r\ninfo: Loading facts in /opt/puppet/share/puppet/modules/concat/lib/facter/concat_basedir.rb\r\ninfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/pe_version.rb\r\ninfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/custom_auth_conf.rb\r\ninfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/concat_basedir.rb\r\ninfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/facter_dot_d.rb\r\ninfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/puppet_vardir.rb\r\ninfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/root_home.rb\r\nerr: Could not retrieve catalog from remote server: Connection refused - connect(2)\r\nnotice: Using cached catalog\r\ninfo: Applying configuration version ''1382386729''\r\nnotice: BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD\r\nnotice: /Stage[main]//Notify[BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD]/message: defined ''message'' as ''BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD''\r\nnotice: Finished catalog run in 0.04 seconds\r\nerr: Could not send report: Connection refused - connect(2)\r\n{code}\r\n\r\nGreat, behaves as we expect.\r\n\r\nPE 3.1.0\r\n\r\n{code}\r\n[root@pe-310-master manifests]# puppet --version\r\n3.3.1 (Puppet Enterprise 3.1.0)\r\n\r\n[root@pe-310-master manifests]# cat /etc/puppetlabs/puppet/manifests/site.pp\r\nnode default {W\r\n  # This is where you can declare classes for all nodes.\r\n  # Example:\r\n  #   class { ''my_class'': }\r\n}\r\n\r\nnotify { ''BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD'': }\r\n\r\n[root@pe-310-master manifests]# puppet agent --test\r\nInfo: Applying configuration version ''1382387428''\r\nNotice: BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD\r\nNotice: /Stage[main]//Notify[BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD]/message: defined ''message'' as ''BU BU BU BIRD BIRD BIRD, BIRD IS THE WORD''\r\n\r\n[root@pe-310-master manifests]# puppet agent --onetime --verbose --no-daemonize\r\nError: Failed to apply catalog: Connection refused - connect(2)\r\nError: Could not send report: Connection refused - connect(2)\r\n{code}\r\n\r\nThe run is not attempted with a cached catalog.\r\n\r\nSame result with puppet agent --onetime --verbose --no-daemonize --debug --use_cached_catalog.\r\nSame result with 3.0.x series.', 'https://tickets.puppetlabs.com/browse/PUP-580', 'https://github.com/puppetlabs/puppet/pull/8824', '2013-10-23T07:48:25.000-0700', '2019-04-04T22:35:54.000-0700', '2019-04-04T22:35:54.000-0700', 'Closed', 'redmine', 5, '0', 2, 8, 2, 2, 'f147025d3d99e8589ca4d7a2f13caea7b3a1cfe8'),
('puppet', 17790, 124736906, 5962, 'If insync? on a property causes a failure then you get a failed event on the resource, rather than on the property', 'If you try to change the owner or group of a file to an owner/group that doesn''t exist, you end up with a failure event for the whole resource, with no property listed in the event. We know what property failed, so the event should happen for that property, rather than for the whole resource/without a property.', 'https://tickets.puppetlabs.com/browse/PUP-639', 'https://github.com/puppetlabs/puppet/pull/5962', '2013-10-30T11:53:19.000-0700', '2019-04-04T22:35:56.000-0700', '2019-04-04T22:35:56.000-0700', 'Resolved', '', 4, '0', 1, 6, 6, 3, 'ef342d4ced9bf7aa0489005119bf80a298d094f2'),
('puppet', 17619, 82571093, 5230, 'CLONE - Resource display differs when resource is first enforced vs. when later changed', 'As noted in PE-1772, multiple parameter changes on a resource on the same node during the same Puppet run show up as apparent "duplicates" in the resource detail list.\r\n\r\nHowever, for some resource types, when that resource is first enforced, only one entry shows in the resource list.  For example, "file" resources, when the file is first created, will show only one line in the resource list regardless of how many additional parameters (owner, group, permissions, etc.) are enforced at the same time as the file is created.  Subsequent changes enforced by Puppet on a file that is already present on the file system will show as individual events; for example, simultaneous changes to mode and content as in the screenshots attached to PE-1772. \r\n\r\nThis behavior is possibly confusing to the end user since for many resources there is no clear binary distinction between the first-time initialization of a resource and subsequent updates to it.  For example, what does it mean to "create" an "exec" resource? Under what conditions should events resulting from a single enforcement of an "exec" resource be collapsed into one event, and under what conditions should they be split up as in PE-1772?  ', 'https://tickets.puppetlabs.com/browse/PUP-633', 'https://github.com/puppetlabs/puppet/pull/5230', '2013-10-29T16:00:29.000-0700', '2019-04-04T22:35:56.000-0700', '2019-04-04T22:35:56.000-0700', 'Closed', 'docs_reviewed;qa-reviewed', 10, '0', 7, 446, 230, 13, '1be272fa33de7601d93776dd7fc2b025c1fba3e2'),
('puppet', 18844, 120942937, 5877, 'CLONE - Puppet windows spec tests get permission denied error during file server test', 'I don''t know if this is a legitimate failure or an infra bug. I''d like some eyes from the platform team on it to confirm expected behavior here and file appropriate tickets if there is an issue.\r\n\r\n{noformat}\r\nFailures:\r\n\r\n  1) Puppet::Indirector::DirectFileServer  when interacting with FileServing::Fileset and the model should return instances capable of returning their content\r\n     Failure/Error: when /one/; instance.content.should == "one content"\r\n     Errno::EACCES:\r\n       Permission denied - C:/Users/ADMINI~1/AppData/Local/Temp/rspecrun20131108-2556-9nu7l6/direct_file_server_testing20131108-2556-1w8ones\r\n     # ./lib/puppet/file_serving/content.rb:37:in `binread''\r\n     # ./lib/puppet/file_serving/content.rb:37:in `content''\r\n     # ./spec/integration/indirector/direct_file_server_spec.rb:61:in `block (3 levels) in <top (required)>''\r\n     # ./spec/integration/indirector/direct_file_server_spec.rb:59:in `each''\r\n     # ./spec/integration/indirector/direct_file_server_spec.rb:59:in `block (2 levels) in <top (required)>''\r\n\r\nFinished in 9 minutes 10.99 seconds\r\n18436 examples, 1 failure, 80 pending\r\n{noformat}\r\n\r\nhttp://jenkins-enterprise.delivery.puppetlabs.net/view/Component%20Specs/job/Puppet%20Specs%20(Windows)/95/', 'https://tickets.puppetlabs.com/browse/PUP-738', 'https://github.com/puppetlabs/puppet/pull/5877', '2013-11-13T13:22:21.000-0800', '2019-04-04T22:35:57.000-0700', '2019-04-04T22:35:57.000-0700', 'Closed', 'windows', 2, '0', 1, 3, 1, 1, '838c8c8d2b0bb017fa0c7063fd2522e98be63e0e'),
('puppet', 18742, 119122053, 5845, 'Cannot add aliases without a catalog', 'During PE installation, Puppet fails with the following new error:\r\n\r\n{code}\r\n[root@centos6 ~]# /opt/puppet/bin/puppet apply --no-report --modulepath /opt/puppet/share/puppet/modules -v --exec "class { pe_postgresql: version => ''9.2'', config_hash => { listen_addresses => ''localhost'', ip_mask_allow_all_users => ''0.0.0.0/0'' } }" --trace\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/auth_conf/lib/facter/custom_auth_conf.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/pe_puppetdb/lib/facter/puppetdb_server_status.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/root_home.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/pe_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/pe_common/lib/facter/windows.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/postgresql/lib/facter/postgres_default_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/concat/lib/facter/concat_basedir.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/firewall/lib/facter/iptables_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/firewall/lib/facter/ip6tables_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/firewall/lib/facter/iptables_persistent_version.rb\r\nNotice: Compiled catalog for centos6 in environment production in 2.25 seconds\r\nError: Parameter alias failed on File[/opt/puppet/var/lib/pgsql/9.2/data/pg_hba.conf]: Munging failed for value "concat_/opt/puppet/var/lib/pgsql/9.2/data/pg_hba.conf" in class alias: Cannot add aliases without a catalog at /opt/puppet/share/puppet/modules/concat/manifests/init.pp:228\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type.rb:1347:in `block (2 levels) in <class:Type>''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/parameter.rb:432:in `munge''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/parameter.rb:502:in `value=''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type.rb:653:in `[]=''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type.rb:2267:in `block in set_parameters''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type.rb:2261:in `each''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type.rb:2261:in `set_parameters''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type.rb:2217:in `initialize''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/type/file.rb:402:in `initialize''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/resource.rb:307:in `new''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/resource.rb:307:in `to_ral''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/resource/catalog.rb:502:in `block in to_catalog''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/resource/catalog.rb:495:in `each''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/resource/catalog.rb:495:in `to_catalog''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/resource/catalog.rb:397:in `to_ral''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application/apply.rb:207:in `main''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application/apply.rb:146:in `run_command''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:364:in `block (2 levels) in run''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:470:in `plugin_hook''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:364:in `block in run''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:485:in `exit_on_fail''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:364:in `run''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run''\r\n/opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute''\r\n/opt/puppet/bin/puppet:4:in `<main>''\r\n{code}\r\n\r\nObviously during puppet apply there should be a catalog, so this isn''t a problem with the module. This appears to be related to work done for PP-565.', 'https://tickets.puppetlabs.com/browse/PUP-726', 'https://github.com/puppetlabs/puppet/pull/5845', '2013-11-12T15:20:21.000-0800', '2019-04-04T22:35:57.000-0700', '2019-04-04T22:35:57.000-0700', 'Closed', '', 4, '0', 12, 283, 106, 12, '4d2589f35ba0a6284c376dfd06b73707c6356f06'),
('puppet', 19327, 166917845, 6602, 'Puppet::Util::SUIDManager.run_and_capture is missing from current puppet', 'The method `run_and_capture` is used by the puppetlabs-postgresql module in its `postgresql_sql` type.\r\n\r\nThis method was removed in commit 026b2f7ea996bb3ab5acbc0214919f3d5bc0754f.\r\n\r\nShipping with that code removed will break all deployments of the puppetdb module currently in the wild.', 'https://tickets.puppetlabs.com/browse/PUP-841', 'https://github.com/puppetlabs/puppet/pull/6602', '2013-11-20T14:06:46.000-0800', '2019-04-04T22:35:58.000-0700', '2019-04-04T22:35:58.000-0700', 'Closed', '', 6, '0', 1, 4, 1005, 25, '13332c2e06b54c533244961e1bc407aadb9ce871'),
('puppet', 22413, 11304766, 2229, 'Puppet Resource Package fails', 'Trying to get all windows package resources i get the following error\r\n\r\n{code}\r\nruby 1.9.3p448 (2013-06-27) [i386-mingw32]\r\n\r\nC:\Windows\system32>puppet resource package\r\nError: Could not run: invalid byte sequence in US-ASCII\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1211', 'https://github.com/puppetlabs/puppet/pull/2229', '2013-12-20T13:21:02.000-0800', '2019-04-04T22:36:01.000-0700', '2019-04-04T22:36:01.000-0700', 'Resolved', 'i18n;support;windows', 17, '0', 1, 89, 1, 2, '45824997360d12b3931064ee6d6da5dc312941fd'),
('puppet', 22730, 11142494, 2201, 'Puppet REST API always fails if there''s at least one broken manifest', 'Steps to reproduce:\r\n\r\n1. Install several puppet modules\r\n2. Make a syntax error in one or more installed manifests\r\n3. Query <host>/production/resource_types/*?kind=class\r\n4. Query the same url again\r\n\r\nExpected result: Step #3 and #4 returns the same result, containing parseable all classes *)\r\n\r\nActual result: Step #3 fails with an error reporting the first problem it encounters, step #4 fails with "Import loop detected"\r\n\r\n*) The question is how errors should be reported - this is a matter of design/discussion. Perhaps it would be good if a list of errors would be exposed in the json structure along with the successfully parsed classes.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1322', 'https://github.com/puppetlabs/puppet/pull/2201', '2013-12-31T05:30:28.000-0800', '2019-04-04T22:36:02.000-0700', '2019-04-04T22:36:02.000-0700', 'Closed', '', 7, '0', 1, 27, 5, 2, 'd56347ad5d9d452295fc0ce804756fc3d90786ed'),
('puppet', 24106, 11786546, 2291, 'test agent/fallback_to_cached_catalog.rb assumes no master is running by default', 'When running the puppet tests against pe, the master is running even outside of a with_puppet_running_on block.\r\n\r\nDo we need a "without_puppet_running_on" block in beaker?', 'https://tickets.puppetlabs.com/browse/PUP-1485', 'https://github.com/puppetlabs/puppet/pull/2291', '2014-01-21T11:52:42.000-0800', '2019-04-04T22:36:04.000-0700', '2019-04-04T22:36:04.000-0700', 'Closed', '', 4, '0', 1, 3, 1, 1, 'f17aba14a743c00d1ace662a4d2659f7b0d9299e'),
('puppet', 24794, 0, 0, 'Usability Regression caused by PUP-1322', 'With the change made for PUP-1322, "syntax errors" from loading of includes are squelched and the only error that surfaces is typically a "class not found" (not the real cause).\r\n\r\nThis problem comes from the catching and logging a debug message in type_loader (lines 100-105).\r\n\r\nThe suggested fix is to add a handler of this case to the context and then letting all contexts (except the use case for PUP-1322) define a handler that raises the exception (with patched stacktrace). The PUP-1322 use case gets to the same logic via the code path for puppet/indirector/resource_type/parser which then needs to modify the context and supply a logging handler instead of the default.\r\n\r\nThis fix is possible in 3.5 since the context has been introduced.\r\n\r\nCurrently, this issue is also on stable (after 3.4.2). If a 3.4.3 is ever release this issue will have to be addressed there as well.\r\n\r\nTo be clear - 3.4.2 does not contain the fix in PUP-1322.', 'https://tickets.puppetlabs.com/browse/PUP-1529', 'https://github.com/puppetlabs/puppet/commit/f29e6976711c2ac571165944304c6f16fdcfb437', '2014-01-28T15:47:12.000-0800', '2019-04-04T22:36:05.000-0700', '2019-04-04T22:36:05.000-0700', 'Closed', '', 6, '0', 0, 0, 0, 0, 'f29e6976711c2ac571165944304c6f16fdcfb437'),
('puppet', 22412, 13818706, 2457, 'authentication_authority key is not set when managing root''s password using the puppet user provider', 'If you try to set the root password on OS X using the Puppet user provider, there are two bugs:\r\n\r\n1. /var/db/dslocal/nodes/Default/users/root.plist has the ''passwd'' key set incorrectly.  It sets:\r\n\r\n{code:xml}\r\n<key>passwd</key>\r\n<string>********</string>\r\n{code}\r\n\r\nwhen it should be:\r\n\r\n{code:xml}\r\n<key>passwd</key>\r\n<array>\r\n             <string>********</string>\r\n<array>\r\n{code}\r\n\r\nThis causes ''dscl . read /Users/root'' to not display the contents of the ''Password'' attribute. If you use ''dsenableroot'' to enable root, you can see how the passwd key should be set (both in dscl and reading the .plist in dslocal).\r\n\r\n2. The root user cannot log in via the loginwindow (GUI login).  SSH works, but the GUI does not.  The major differences I see between root and other puppet-made accounts is that root lacks the ''KerberosKeys'' and ''authentication_authority'' keys in its dslocal plist.\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1210', 'https://github.com/puppetlabs/puppet/pull/2457', '2013-12-20T13:20:40.000-0800', '2019-04-04T22:36:06.000-0700', '2019-04-04T22:36:06.000-0700', 'Closed', 'osx;redmine', 11, '0', 2, 64, 6, 3, '680cdf677bc42952b12d3e255a939c1fa69acea9'),
('puppet', 29100, 14470021, 2513, 'Permissions for libdir are set arbitrarily', 'It appears that the mode for libdir is set during pluginsync, to the mode of the lib/ directory of some module being synced (apparently whichever comes first). However, the owner and group are always set to root. This means that a module which is readable only by puppet in the modulepath becomes readable only by root in the libdir. That causes problems for users who install modules with restrictive umasks and wish to install plugins for the puppet master, since it isn''t actually allowed to load them from the libdir (and {{require}} won''t find them in the modulepath).\r\n\r\nWorse still, the mode is set separately from the standard settings catalog, which means even overriding it in {{puppet.conf}} will cause it to be set correctly and then changed later by pluginsync.', 'https://tickets.puppetlabs.com/browse/PUP-1986', 'https://github.com/puppetlabs/puppet/pull/2513', '2014-03-19T11:10:30.000-0700', '2019-04-04T22:36:08.000-0700', '2019-04-04T22:36:08.000-0700', 'Closed', 'customer', 6, '0', 1, 17, 15, 2, '5d284841a3bb8ee1aca1d8b39528cde848d6f3af'),
('puppet', 28693, 14071014, 2480, 'Acceptance tests assume ruby is in path on windows', 'Which isn''t the case when running PE.\r\n\r\nIf we are going to be able to ensure open source functionality we need to make sure that we can run the tests against PE. PE doesn''t include Ruby in the path after its installed. This is an issue with a few tests that directly call ruby.', 'https://tickets.puppetlabs.com/browse/PUP-1937', 'https://github.com/puppetlabs/puppet/pull/2480', '2014-03-13T14:39:28.000-0700', '2019-04-04T22:36:09.000-0700', '2019-04-04T22:36:09.000-0700', 'Closed', '', 13, '0', 1, 3, 3, 1, 'cdf70e242f0bf81423419aae97060acab185e802'),
('puppet', 32026, 0, 0, 'puppet module install fails when given path containing spaces', 'I apologize if I haven''t set this issue up correctly. First time. :)\r\n\r\nI found while using Librarian-Puppet that I couldn''t install modules into paths containing spaces. I thought this was a problem with Librarian so I filed an issue there.\r\nhttps://github.com/rodjek/librarian-puppet/issues/201\r\n\r\nIt turns out the problem is with puppet module install. An example command that fails:\r\n\r\n{noformat}\r\npuppet module install \\r\n  --version 4.1.0 \\r\n  --target-dir ''/tmp/with spaces/stdlib'' \\r\n  --module_repository ''http://forge.puppetlabs.com'' \\r\n  --modulepath ''/tmp/with spaces/stdlib'' \\r\n  --module_working_dir ''/tmp/with spaces/stdlib_working'' \\r\n  --ignore-dependencies \\r\n  puppetlabs/stdlib\r\n{noformat}\r\n\r\nThe error output can be found [here|https://gist.github.com/bderickson/10670325].\r\n\r\nI''ve tested that this fails on Puppet 2.7.23 and 3.4.3 on Ubuntu Lucid.\r\n\r\nPlease let me know if there''s any other information you''d like me to provide. Thanks for your help.', 'https://tickets.puppetlabs.com/browse/PUP-2278', 'https://github.com/puppetlabs/puppet/commit/dd8fc2be79d40ef773b094dd973a30509a40229d', '2014-04-16T08:19:30.000-0700', '2019-04-04T22:36:12.000-0700', '2019-04-04T22:36:12.000-0700', 'Closed', '', 3, '0', 0, 0, 0, 0, 'dd8fc2be79d40ef773b094dd973a30509a40229d'),
('puppet', 21694, 22238086, 3158, 'Spurious ''trigger changed'' messages generated by scheduled task provider', 'The Windows scheduled task (scheduled_task) provider will generate spurious messages during Puppet runs which suggest that scheduled task resources are being reapplied during each run even when the task is present and its associated resource has not been modified. The messages in question look like the following:\r\n\r\n{noformat}notice: /Stage[main]/Schedtask/Scheduled_task[restart_some_service]/trigger: trigger changed ''{''every'' => ''1'', ''on'' => [''sun''], ''schedule'' => ''weekly'', ''start_date'' => ''2012-10-22'', ''start_time'' => ''01:00''}'' to ''[{''day_of_week'' => [''sun''], ''schedule'' => ''weekly'', ''start_time'' => ''01:00''}]''{noformat}\r\n\r\nThe resource associated with the task looks like this:\r\n\r\n{noformat}\r\n  scheduled_task { ''restart_some_service'':\r\n    ensure  => present,\r\n    enabled => true,\r\n    command => ''c:\windows\restart_some_service.bat'',\r\n    user    => ''SYSTEM'',\r\n    trigger => {\r\n      schedule    => weekly,\r\n      day_of_week => [sun],\r\n      start_time  => ''01:00'',\r\n    },\r\n    require => File[''restart_some_service.bat''],\r\n  }\r\n{noformat}\r\n\r\nThis seems to be some kind of artifact of date conversion/formatting or something. While Puppet reports a change, examining the history tab for the task shows no changes aside from the initial creation of the task and subsequent ''real'' changes which were initiated by actually modifying the resource. The notices will be generated regardless of whether there is a real change to report. ', 'https://tickets.puppetlabs.com/browse/PUP-1165', 'https://github.com/puppetlabs/puppet/pull/3158', '2013-12-18T04:52:38.000-0800', '2019-04-04T22:36:13.000-0700', '2019-04-04T22:36:13.000-0700', 'Closed', 'customer;pe_mcollective;redmine;scheduled_task;windows', 11, '0', 3, 51, 27, 2, '44cc510a879513c1c8fe6a4245b8fca2b9e62db8'),
('puppet', 50626, 22238176, 3159, 'scheduled_task triggers cannot be updated', 'I''m using the scheduled_task provider to create a daily task. The initial task creation goes fine, but on any future puppet run I get things like this:\r\n\r\n{noformat}\r\nchange from {''every'' => ''1'', ''schedule'' => ''daily'', ''start_date'' => ''2014-9-9'', ''start_time'' => ''12:00''} to [{''every'' => ''1'', ''schedule'' => ''daily'', ''start_date'' => ''2014-9-8'', ''start_time'' => ''12:00''}] failed: no implicit conversion from nil to integer\r\n{noformat}\r\n\r\nI previously had a less complicated definition and got this error:\r\n\r\n{noformat}\r\nchange from {''every'' => ''1'', ''schedule'' => ''daily'', ''start_date'' => ''2014-9-8'', ''start_time'' => ''12:00''} to [{''schedule'' => ''daily'', ''start_time'' => ''12:00''}] failed: no implicit conversion from nil to integer\r\n{noformat}\r\n\r\nUnfortunately I''m not sure if this was present in 3.6.2 as all my machines are running 3.7.0 and set to automatically upgrade. I made this class shortly before the upgrade and I don''t think it was a problem.\r\n\r\nAm I the only one having this problem?', 'https://tickets.puppetlabs.com/browse/PUP-3203', 'https://github.com/puppetlabs/puppet/pull/3159', '2014-09-09T07:05:58.000-0700', '2019-04-04T22:36:14.000-0700', '2019-04-04T22:36:14.000-0700', 'Closed', 'regression;scheduled_task;windows', 13, '0', 4, 62, 30, 2, 'a51c6faa78d3110a4113685c12e8b7810c39a2e7'),
('puppet', 54157, 31982288, 3754, 'Weekly tasks always notify ''trigger changed''', 'The Windows scheduled task (scheduled_task) provider will generate notices that weekly scheduled task triggers are changed even when no change is necessary. The messages in question look like the following:\r\n\r\n{noformat}notice: /Stage[main]/Schedtask/Scheduled_task[weekly_task]/trigger: trigger changed ''{''every'' => ''1'', ''on'' => [''mon'', ''tues'', ''wed'', ''thurs'', ''fri''], ''schedule'' => ''weekly'', ''start_date'' => ''2014-10-9'', ''start_time'' => ''07:30''}'' to ''[{''day_of_week'' => [''mon'', ''tues'', ''wed'', ''thurs'', ''fri''], ''schedule'' => ''weekly'', ''start_time'' => ''07:30''}]''{noformat}\r\n\r\nThe resource associated with the task looks like this:\r\n\r\n{noformat}\r\n  scheduled_task { ''Weekly Task'' :\r\n    ensure  => present,\r\n    command => "C:\Windows\System32\cmd.exe",\r\n    trigger => {\r\n      schedule    => weekly,\r\n      start_time  => ''07:30'',\r\n      day_of_week => [mon, tues, wed, thurs, fri],\r\n    },\r\n  }\r\n{noformat}\r\n\r\nThe provider seems to be comparing the day_of_week parameter against the on parameter.  Weekly triggers are supposed to use day_of_week according to the documentation.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3429', 'https://github.com/puppetlabs/puppet/pull/3754', '2014-10-09T11:59:37.000-0700', '2019-04-04T22:36:15.000-0700', '2019-04-04T22:36:15.000-0700', 'Closed', 'customer;docs_reviewed;scheduled_task;windows', 2, '0', 1, 10, 10, 2, '28e44a19dec157327c92165f735f567b1bb39686'),
('puppet', 55858, 23207763, 3228, 'Adding a setting to puppet.conf that has a :hook handled on define preloads incorrect directory environment settings.', 'When using directory environments, if you have a setting like ''certname'' set in puppet.conf (either in main, or in the section that will correspond to the run_mode of your application), setting values will be cached for the production environment which will return legacy default values for manifest and modulepath.\r\n\r\n{noformat}\r\njpartlow@percival:~/work/puppet$ cat ~/.puppet/puppet.conf \r\ncertname=foo\r\nenvironmentpath=$confdir/environments\r\njpartlow@percival:~/work/puppet$ be puppet apply -e ''notice("$settings::modulepath") notice("$settings::manifest") notice("$settings::config_version")''                                                      \r\nNotice: Scope(Class[main]): /home/jpartlow/.puppet/modules:/usr/share/puppet/modules\r\nNotice: Scope(Class[main]): /home/jpartlow/.puppet/manifests/site.pp\r\nNotice: Scope(Class[main]): \r\nNotice: Compiled catalog for foo in environment production in 0.01 seconds\r\nNotice: Finished catalog run in 0.06 seconds\r\n{noformat}\r\n\r\nThe reason for this is that Settings#parse_config looks up the environment for the preferred_run_mode, and then when it attempts to handle any :hooks for settings that have a non-default value, it looks up the setting value in this environment.  This causes a ChainedValues instance to be cached in the @values[environment][preferred_run_mode] hash, but because all of this is happening prior to @global_defaults_initialized being set true (and hence, before Puppet.do_initialize_settings_for_run_mode has set up the base_context and generated environment loaders) we are not yet in a position to create ValuesFromEnvironmentConf sections.  So the ChainedValues instance is created with a value_sets that does not have a section for the environment, and it passes up manifest/modulepath from the defaults instead.\r\n\r\nA solution to this is to use non cached instances of ChainedValues when handling setting values for :hooks.\r\n\r\nThere is a deeper disconnect though both in terms of what it means to handle setting hooks within an environment during configuration parsing, and also, how environment settings should work with their own setting hooks.  Currently they would never be processed if a hook was set on an environment setting and directory environments were in use.', 'https://tickets.puppetlabs.com/browse/PUP-3500', 'https://github.com/puppetlabs/puppet/pull/3228', '2014-10-22T00:20:59.000-0700', '2019-04-04T22:36:15.000-0700', '2019-04-04T22:36:15.000-0700', 'Closed', '', 17, '0', 1, 34, 2, 2, 'e134843b44d6d2a9ba3d661f34e5c971b6600120'),
('puppet', 273491, 212582901, 7038, 'External process termination handling rate (including "exec" resource) is slow', '*Puppet Version: 4.10.5+*\r\n *Puppet Server Version: irrelevant*\r\n *OS Name/Version: Any supported Windows OS*\r\n\r\nExecuting external processes by puppet on Windows can be very slow, compared to the execution time of the process itself, if the execution time is below 1 second. When applying manifests that contain many "exec" resources, it may take many minutes to apply. When analyzing logs, I took note that even simple "reg query" process took 1.02/1.03 second to run. Windows doesn''t spawn processes that slow, I wrote simple example in C# which showed that my machine is capable of executing about 140 of such commands per second (no parallelism, waiting for exit of each process before spawning another).\r\nI did a little bit of digging and found this [piece of code|https://github.com/puppetlabs/puppet/blob/31cd0aa11218e882c60de416e0f89af7b3c5262b/lib/puppet/util/windows/process.rb#L17]. This code waits for at least one second, unless the process terminated _immediately_ (which is rarely feasible).\r\n Replacing ''sleep(1)'' with ''sleep(0)'' is the simplest fix, but is not too efficient from a CPU consumption standpoint, so I propose a different fix in a [PR#7033|https://github.com/puppetlabs/puppet/pull/7033].\r\n\r\nI did a little more digging and found out that this ''sleep(1)'' was [added|https://github.com/puppetlabs/puppet/commit/1d058ce233aeb2f70e1612c56dac52aa5f9c4387] to properly handle signals, I did additional testing ("exec"-ed a slow process and tried to Ctrl-C an interactive puppet run), and it worked.\r\n\r\n*Desired Behavior: Process termination is handled immediately*\r\n\r\n*Actual Behavior: Processes are considered to be running at least for 1 second, even if they exit immediately*\r\n\r\n It would be great if this gets into 4.10.z release train, since at least our company is not yet ready for 5.x.', 'https://tickets.puppetlabs.com/browse/PUP-9092', 'https://github.com/puppetlabs/puppet/pull/7038', '2018-08-30T08:38:23.000-0700', '2019-04-04T22:36:44.000-0700', '2019-04-04T22:36:44.000-0700', 'Closed', '', 2, '0', 1, 3, 2, 1, 'cc8959c3572df066e2ef1bb4b61b3b0388473ed0'),
('puppet', 119711, 61583266, 4752, 'Puppet slowing down after calling Puppet.initialize_settings multiple times', 'I experienced some performance issues using foreman-proxy version 1.10.2-1 during class import.\r\n\r\nStack trace brought me to [initializer.rb in theforeman/smart-proxy|https://github.com/theforeman/smart-proxy/blob/develop/modules/puppet_proxy/initializer.rb#L20]. Smart-proxy is calling Puppet.initialize_settings for each puppet class. \r\n\r\nContinuing following stack trace brought me to @hooks_to_call_on_application_initialization array which is growing up on each Puppet.initialize_settings call and I don''t think it''s a proper behavior. Problematic lines are: [settings.rb:589|https://github.com/puppetlabs/puppet/blob/3.8.6/lib/puppet/settings.rb#L589] and [settings.rb:895|https://github.com/puppetlabs/puppet/blob/3.8.6/lib/puppet/settings.rb#L895]. I think that hooks should be added to this array only if they are unique. Another solution would be to clear hooks_to_call_on_application_initialization on each Puppet.settings.initialize_global_settings and Puppet.settings.initialize_app_defaults call.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6000', 'https://github.com/puppetlabs/puppet/pull/4752', '2016-03-03T00:57:19.000-0800', '2019-04-04T22:36:45.000-0700', '2019-04-04T22:36:45.000-0700', 'Closed', '', 3, '0', 1, 2, 2, 1, 'f9cd0a7305a267fa91eccfcdb39877ae56a7cc0a'),
('puppet', 101461, 47843313, 4349, 'Slow catalog run after updating to puppet 3.7.5', 'After upgrading 3.7.4 -> 3.7.5 (actually i was upgrading to 3.8.2 but was able to trace to performance problems to 3.7.5) I am seeing slower catalog compilations and a lot of failed puppet runs. \r\n\r\nI have about 800-1000 puppet clients connecting to a single puppetserver vm with 8 cores and 16GB RAM. Puppetserver configured with 9 jruby instances and 12GB of java Xmx. With 3.7.4 I have compilation times of 1-5s and now the compilation time is 15-100s _if_ it even succeeds. The majority of my nodes fails with the WritePendingException error. I''m not using puppetdb.\r\n\r\nHere are the log output from puppetserver-access.log for one failed run:\r\n\r\n\r\n{noformat}\r\n172.31.28.123 - - - 12/Oct/2015:11:18:27 +0000 "GET /production/node/lxserv641.smhi.se?transaction_uuid=95384261-d8f5-48a1-bf35-a4faf21fe5c9&fail_on_404=true HTTP/1.1" 200 7011 172.31.28.123 172.31.28.123 8140 36744\r\n172.31.28.123 - - - 12/Oct/2015:11:19:03 +0000 "GET /production/file_metadatas/pluginfacts?links=manage&recurse=true&checksum_type=md5&ignore=.svn&ignore=CVS&ignore=.git HTTP/1.1" 200 305 172.31.28.123 172.31.28.123 8140 36117\r\n172.31.28.123 - - - 12/Oct/2015:11:20:05 +0000 "GET /production/file_metadata/pluginfacts?links=manage&source_permissions=use HTTP/1.1" 404 51 172.31.28.123 172.31.28.123 8140 61710\r\n172.31.28.123 - - - 12/Oct/2015:11:20:38 +0000 "GET /production/file_metadatas/plugins?links=manage&recurse=true&checksum_type=md5&ignore=.svn&ignore=CVS&ignore=.git HTTP/1.1" 200 60788 172.31.28.123 172.31.28.123 8140 33207\r\n172.31.28.123 - - - 12/Oct/2015:11:21:17 +0000 "GET /production/file_metadata/plugins?links=manage&source_permissions=ignore HTTP/1.1" 200 316 172.31.28.123 172.31.28.123 8140 39250\r\n172.31.28.123 - - - 12/Oct/2015:11:25:33 +0000 "POST /production/catalog/lxserv641.smhi.se HTTP/1.1" 200 229376 172.31.28.123 172.31.28.123 8140 255513\r\n\r\n{noformat}\r\n\r\n\r\nand from puppetserver.log\r\n\r\n{noformat}\r\n2015-10-12 11:23:58,642 INFO  [puppet-server] Puppet Compiled catalog for lxserv641.smhi.se in environment production in 43.13 seconds\r\n2015-10-12 11:25:33,160 WARN  [o.e.j.s.HttpChannel] /production/catalog/lxserv641.smhi.se\r\njava.nio.channels.WritePendingException: null\r\n{noformat}\r\n\r\n\r\nSomehow my puppet master is getting overloaded. If I downgrade to 3.7.4, everything is fine. Looking at the release notes for 3.7.5 I cant really see what could cause such a performance difference, any ideas?\r\n\r\nMy guess is that since the catalog run takes so much longer for each agent, the number of concurrent agent runs is rising which overloads the server completely. So the underlying problem is probably a dramatic performance loss. When I use mcollective to trigger a puppet run with 20 concurrent agents it works without any failed runs. It''s slow, but it works. Normally, we run puppet via cron with a 900s splay time, so when a single agent run takes up to 100s there''s will be a lot of concurrent runs overloading the server. ', 'https://tickets.puppetlabs.com/browse/PUP-5380', 'https://github.com/puppetlabs/puppet/pull/4349', '2015-10-13T11:41:50.000-0700', '2019-04-04T22:36:45.000-0700', '2019-04-04T22:36:45.000-0700', 'Closed', '', 47, '0', 1, 27, 8, 4, '060fc3c13f9a95a713961a39e5b0bfbac5c50553'),
('puppet', 290588, 242647357, 7326, 'Puppet Parser cannot handle "case $:xxx:{ default: {} }" block', '*Puppet Version: 6.1.0*\r\n *Puppet Server Version:* *does not apply***\r\n *OS Name/Version: Windows but does not apply*\r\n\r\nI am using puppet internals (puppet parser) to parse puppet manifests into JSON (puppet structured AST).\r\n\r\nI have noticed that PNTransformer cannot transform this block \r\n{code:java}\r\nclass breakme {\r\n  case "test" {\r\n    default: {}\r\n  }\r\n}{code}\r\ninto JSON and crashes \r\n{code:java}\r\nVisitor Error: the configured receiver (Puppet::Pops::Model::PNTransformer) can''t handle instance of: NilClass (RuntimeError){code}\r\n(see crash stack trace attached).\r\n\r\n \r\nThe reason of this is because the instruction pretty much produces nothing AND PNTransformer has no method to visit the transform_NilClass (puppet server even thinks it''s illegal, This ''case'' statement has no effect.). However, the instruction being illegal is irrelevant, as the puppet parser has to parse the AST structure correctly anyway.\r\n \r\nPlease see the puppet-parser-test-current.rb and puppet-parser-test-fixed.rb as self-containing examples\r\n*Desired Behavior:*\r\n\r\n**It should resolve the default section into, for example, a "nop" instruction:\r\n{code:java}\r\n{"^":["class",{"#":["name","breakme","body",[{"^":["case","test",[{"#":["when",[{"^":["default"]}],"then",[{"^":["nop"]}]]}]]}]]}]}{code}\r\n*Actual Behavior:*\r\n\r\n**It crashes with {color:#FF0000}Visitor Error: the configured receiver (Puppet::Pops::Model::PNTransformer) can''t handle instance of: NilClass (RuntimeError){color}\r\n\r\n \r\n\r\n*Solution:*\r\nThe solution would be to add this method to the PNTransformer class:\r\n{code:java}\r\nclass Puppet::Pops::Model::PNTransformer \r\n  def transform_NilClass(e)\r\n    Puppet::Pops::PN::Call.new(''nop'')\r\n  end\r\nend{code}\r\n Or, it should raise appropriate exception of the expression being illegal, instead of crashing', 'https://tickets.puppetlabs.com/browse/PUP-9400', 'https://github.com/puppetlabs/puppet/pull/7326', '2019-01-06T04:57:55.000-0800', '2019-04-04T22:37:10.000-0700', '2019-04-04T22:37:10.000-0700', 'Closed', 'parser;resolved-issue-added', 5, '0', 1, 9, 0, 2, 'cb744a65ec83af0d82333fcfdc984772c4b0570b'),
('puppet', 252092, 190678538, 6856, '--config_version option to `puppet apply` leads to ruby-specific lastrun YAML', 'If you run {{puppet apply --config_version=''echo foo'' -e ''notify \{ "bar": \}''}} then the last run summary YAML ends up looking like this\r\n\r\n{noformat}\r\n---\r\nversion:\r\n config: !ruby/string:Puppet::Util::Execution::ProcessOutput "foo"\r\n[...]\r\n{noformat}\r\n\r\nHaving the explicit typing makes it difficult to parse with general YAML tools.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8767', 'https://github.com/puppetlabs/puppet/pull/6856', '2018-05-22T03:00:46.000-0700', '2019-04-04T22:37:11.000-0700', '2019-04-04T22:37:11.000-0700', 'Closed', '', 1, '0', 3, 140, 64, 17, 'd71a3326835b02790f911b6e2ab9172e4d98ce53'),
('puppet', 175707, 107137424, 5651, 'puppet prints deprecation warnings for SemVer even though they can''t be fixed', 'In puppet 4.9.2, if I run {{puppet apply foo.pp}} and it includes {{postgresql}} (from puppetlabs-postgresql), checking of the dependencies in metadata.json will produce the following warning:\r\n\r\n{quote}Warning: Use of class Puppet::SemVer is deprecated. SemanticPuppet::Version or SemanticPuppet::VersionRange should be used instead\r\n   (file & line not available)\r\n{quote}\r\nAs far as I can tell (based on printing a stack trace with {{puts}} in {{SemVer}}), this relates to the continued use of {{SemVer}} in {{module_tool}}, which is scheduled to be fixed in 5.0 (see PUP-6240). As a regular Puppet user, this is rather confusing, since it seems to be instructing the user to fix something, but in fact the user can''t fix it. As such, I suggest that the deprecation warning be removed until all uses of {{SemVer}} are removed from Puppet itself, or the condition on when to print it be fixed.', 'https://tickets.puppetlabs.com/browse/PUP-7232', 'https://github.com/puppetlabs/puppet/pull/5651', '2017-02-19T16:33:00.000-0800', '2019-04-04T22:37:13.000-0700', '2019-04-04T22:37:13.000-0700', 'Closed', '', 6, '0', 1, 236, 9, 2, 'd8537524e0a3a18e3e186bd18a5261682017f9ae'),
('puppet', 144483, 245354988, 7340, 'An invalid path to the --logdest option is silently ignored', 'When passing an invalid path to the {{--logdest}} option, I would expect at least a warning. Instead, it just silently ignores it:\r\n\r\n{code}\r\n# puppet agent -t --logdest /no/such/path/foo.log\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for master.puppetlabs.vm\r\nInfo: Applying configuration version ''1469935005''\r\n[...]\r\nNotice: Applied catalog in 33.58 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6571', 'https://github.com/puppetlabs/puppet/pull/7340', '2016-08-02T09:28:57.000-0700', '2019-04-04T22:37:14.000-0700', '2019-04-04T22:37:14.000-0700', 'Closed', 'puppethack;resolved-issue-added;the-goods', 7, '0', 1, 31, 4, 4, 'c3c88dfbd7117f4a3f880a5099b52b74f322c495'),
('puppet', 55402, 25513891, 3378, 'Windows ffi dependency fails for Ruby 2.1.3', 'Ruby 2.1.x was released on Windows for the first time with Ruby 2.1.3 in September: https://www.ruby-forum.com/topic/5768030\r\n\r\nRunning Ruby from source on Windows with Ruby 2.1.3 fails, because ffi 1.9.3 isn''t compatible with Ruby 2.1.x. The ffi dependency needs to be updated to require ffi 1.9.5+ on all our projects that depend on it: at least puppet, facter, hiera.', 'https://tickets.puppetlabs.com/browse/PUP-3479', 'https://github.com/puppetlabs/puppet/pull/3378', '2014-10-16T12:24:18.000-0700', '2019-04-04T22:38:27.000-0700', '2019-04-04T22:38:27.000-0700', 'Closed', 'puppethack;windows', 15, '0', 1, 2, 2, 1, '5895ea3c337a0cf76b922f5286a4e022c4370200'),
('puppet', 55132, 22757259, 3196, 'Syntax error in test suite on Ruby <= 1.8.7-p352', 'https://github.com/puppetlabs/puppet/commit/baee7126eca089adc894e8ae7232fc3eb698f0c7 introduced a syntax error in the test suite on older Ruby 1.8.7 versions. I''ve confirmed failure on 1.8.7-p352 and 1.8.7-p302, although it seems to have passed on 1.8.7-p374 on Travis.\r\n\r\nThe problem is that older Rubies don''t know that this is a single logical line of code, and need the newline to be escaped:\r\n\r\n  expect(PSON.parse(text))\r\n    .to eq({"data" => {}, "document_type" => "Node"})\r\n\r\nI''m not sure whether this is worth filing a ticket for, but CONTRIBUTING.md requests that commit messages reference a bug number, which is why I''m putting this into Jira. I''ll be submitting a trivial pull request shortly.', 'https://tickets.puppetlabs.com/browse/PUP-3470', 'https://github.com/puppetlabs/puppet/pull/3196', '2014-10-14T19:24:12.000-0700', '2019-04-04T22:38:27.000-0700', '2019-04-04T22:38:27.000-0700', 'Closed', 'puppethack', 2, '0', 1, 1, 1, 1, ''),
('puppet', 20110, 13038368, 2397, 'puppet apply on Windows always uses *nix style newlines from templates', 'When applying manifests containing templates using ''puppet apply'' on Windows, the Windows-style CRLF line ending is always replaced with *nix style LF. The behavior is the same whether the template originally contains Windows line endings or *nix line endings - the generated file always has *nix line endings.\r\n\r\nThis does *not* occur if the template is generated on a Linux master from an erb containing Windows-style line endings (the correct Windows style endings are preserved). Also, very strangely, Windows-style newlines are preserved with ''puppet apply'' when run on Linux.\r\n\r\n{noformat}\r\nC:\>puppet agent -t\r\nInfo: Retrieving plugin\r\n<...snip...>\r\nInfo: Caching catalog for server2008r2a\r\nInfo: Applying configuration version ''1386132854''\r\nNotice: /Stage[main]//Node[default]/File[c:/newline_test.txt]/content:\r\n\r\nInfo: /Stage[main]//Node[default]/File[c:/newline_test.txt]: Filebucketed c:/new\r\nline_test.txt to main with sum 72cff61ef2581d7e849e2fa4c20b4e31\r\nNotice: /Stage[main]//Node[default]/File[c:/newline_test.txt]/content: content c\r\nhanged ''{md5}72cff61ef2581d7e849e2fa4c20b4e31'' to ''{md5}ba4749398421eb02703fc958\r\n71fdd73e''\r\nNotice: Finished catalog run in 0.95 second\r\n\r\nC:\>hexdump.exe newline_test.txt\r\n00000000: 74 65 73 74 0D 0A 74 65 - 73 74 0D 0A 74 65 73 74 |test  test  test|\r\n00000010: 0D 0A 74 65 73 74 0D 0A - 74 65 73 74 0D 0A 74 65 |  test  test  te|\r\n00000020: 73 74 0D 0A 0D 0A       -                         |st    |\r\n00000026;\r\n\r\nC:\>hexdump.exe newline_test.txt.erb\r\n00000000: 74 65 73 74 0D 0A 74 65 - 73 74 0D 0A 74 65 73 74 |test  test  test|\r\n00000010: 0D 0A 74 65 73 74 0D 0A - 74 65 73 74 0D 0A 74 65 |  test  test  te|\r\n00000020: 73 74 0D 0A 0D 0A       -                         |st    |\r\n00000026;\r\n\r\nC:\>type test.pp\r\nfile { ''c:/newline_test.txt'':\r\n  ensure  => file,\r\n  content => template(''c:/newline_test.txt.erb''),\r\n}\r\nC:\>puppet apply test.pp \r\nNotice: Compiled catalog for server2008r2a in environment production in 0.09 sec\r\nonds\r\nNotice: /Stage[main]//File[c:/newline_test.txt]/content: content changed ''{md5}b\r\na4749398421eb02703fc95871fdd73e'' to ''{md5}72cff61ef2581d7e849e2fa4c20b4e31''\r\nNotice: Finished catalog run in 0.12 seconds\r\n\r\nC:\>hexdump.exe newline_test.txt\r\n00000000: 74 65 73 74 0A 74 65 73 - 74 0A 74 65 73 74 0A 74 |test test test t|\r\n00000010: 65 73 74 0A 74 65 73 74 - 0A 74 65 73 74 0A 0A    |est test test  |\r\n0000001f;\r\n{noformat}\r\n\r\nNote that I have only tested this on Puppet Enterprise.\r\n\r\n\r\n*Note*: There may be other places this happens. Look for File.read and adjust.\r\n\r\nrisk: high\r\nprobability: high (almost any windows template use when testing with apply on a windows agent)\r\nseverity: high (prevents template use with certain resources)\r\ntest layer: unit \r\ncovered by unit tests.  validate PR in windows and linux', 'https://tickets.puppetlabs.com/browse/PUP-927', 'https://github.com/puppetlabs/puppet/pull/2397', '2013-12-03T21:15:04.000-0800', '2019-04-04T22:38:28.000-0700', '2019-04-04T22:38:28.000-0700', 'Closed', 'puppethack;windows', 23, '0', 1, 10, 8, 5, 'e9b25b55b81e80a2e1a50073ff3d52b29b65ec95'),
('puppet', 53785, 22326788, 3166, 'relationship_spec.rb has minor bugs', 'There were a couple of typos in the relationship_spec.rb spec tests relating to ALL_EVENTS.', 'https://tickets.puppetlabs.com/browse/PUP-3393', 'https://github.com/puppetlabs/puppet/pull/3166', '2014-10-06T18:54:42.000-0700', '2019-04-04T22:38:28.000-0700', '2019-04-04T22:38:28.000-0700', 'Closed', 'puppethack;trivial', 3, '0', 1, 2, 2, 1, '5d1356c5889c325b8e819f7b854fbdc01c701aed'),
('puppet', 36835, 22052203, 3143, 'Windows user provider reports that the password is created instead of changed', 'If you change an existing user''s password on Windows, puppet reports:\r\n\r\n{noformat}\r\nNotice: /Stage[main]/Main/User[testing6]/password: created password\r\n{noformat}\r\n\r\nIf the desired password doesn''t match current password, the windows_adsi provider''s {{#password}} method returns :absent, to force the provider to apply the new password. But this causes puppet to think the property was "created".\r\n\r\nIt would be preferrable to say that the passwords were changed.\r\n\r\nSee https://github.com/puppetlabs/puppet/commit/51b33d1f/lib/puppet/provider/user/windows_adsi.rb#diff-cb6db5b98229b4ec070f9158795e3708R61', 'https://tickets.puppetlabs.com/browse/PUP-2647', 'https://github.com/puppetlabs/puppet/pull/3143', '2014-05-22T19:31:31.000-0700', '2019-04-04T22:38:29.000-0700', '2019-04-04T22:38:29.000-0700', 'Closed', 'docs_reviewed;puppethack;windows', 3, '0', 1, 2, 2, 2, '7193960b5a42ac763d4ddf3abd5ff759fbd65ab8'),
('puppet', 26706, 120745177, 5874, 'Yumrepo logs info messages without context', 'Since PUP-789, the yumrepo inifile provider logs two messages without any context (e.g. the resource or provider).\r\n\r\n{noformat}\r\ncreate new repo SCL in file /etc/yum.repos.d/SCL.repo\r\n/Stage[main]/Foreman::Install::Repos::Extra/Yumrepo[SCL]/ensure: created\r\nchanging mode of /etc/yum.repos.d/SCL.repo from 600 to 644\r\n{noformat}\r\n\r\nThe provider code calls "Puppet.info" currently when it should use just "info" to add context.  As these are class utility methods, it should ideally use the context from the instance to provide even better context, related to the resource that made the change.', 'https://tickets.puppetlabs.com/browse/PUP-1723', 'https://github.com/puppetlabs/puppet/pull/5874', '2014-02-17T05:27:04.000-0800', '2019-04-04T22:38:30.000-0700', '2019-04-04T22:38:30.000-0700', 'Closed', 'help_wanted;maintenance;puppethack;resolved-issue-added;yumrepo', 4, '0', 1, 3, 3, 1, '43329a6abdf9df54cd821234a14fba92d86f588b'),
('puppet', 37906, 23416568, 3241, 'ssl_server_ca_chain and ssl_client_ca_chain are dead settings', 'The ssl_server_ca_chain setting is used in webrick to add intermediate root certificates (chain) to the SSL context. When the ssl server sends its Server Certificate message, it includes the chain of certs so that clients can validate the connection.\r\n\r\nFor example, {{:localcacerts}} might contain the cert for {{C=US/O=GeoTrust Inc./CN=GeoTrust Global CA}}\r\n\r\nand {{:ssl_server_ca_chain}} might contain the cert for {{/C=US/O=GeoTrust Inc./CN=GeoTrust SSL CA - G2}}.', 'https://tickets.puppetlabs.com/browse/PUP-2716', 'https://github.com/puppetlabs/puppet/pull/3241', '2014-06-02T15:18:31.000-0700', '2019-04-04T22:38:32.000-0700', '2019-04-04T22:38:32.000-0700', 'Closed', 'docs_reviewed;puppethack', 4, '0', 2, 8, 19, 5, 'a5251011249c23d8833ec599fdfe5de00fbc1492'),
('puppet', 284007, 248855266, 7355, 'A heredoc with interpolation containing [ ] in the expression can cause syntax error', '*Puppet Version:* Anything greater than 5.X\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* N/A\r\n\r\nDownload the {{simp_pki_service}} module from https://github.com/simp/pupmod-simp-simp_pki_service and run {{puppet parser validate manifests/kra.pp}}.\r\n\r\nUse {{d07265e253bb2cb11314dbb962043a21a2cbad05}} for the breaking behavior. Changing the {{fact}} call to a local variable did not show any issues.\r\n\r\n*Desired Behavior:*\r\n\r\nNo validation errors should be shown (just as in Puppet 4)\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet parser validation fails with a syntax error in the HEREDOC at line 123.\r\n\r\nNote: Removing the only line in the *comments* section of the document causes the validation to no longer fail.\r\n\r\nUPDATE\r\n------\r\nThis is the same problem as in PUP-9163 which apparently did not fix all cases of the problem.\r\n\r\nThe issue is that the lexer looks at the wrong character when it is looking at what comes just before the {{\[}} char in an interpolated expression inside a heredoc. The position it is looking at depend on how much source text there is before the {{\[}} - if the erroneous position happens to be a space the result is a syntax error. ', 'https://tickets.puppetlabs.com/browse/PUP-9303', 'https://github.com/puppetlabs/puppet/pull/7355', '2018-11-06T08:02:09.000-0800', '2019-04-04T22:40:16.000-0700', '2019-04-04T22:40:16.000-0700', 'Closed', 'resolved-issue-added', 19, '0', 3, 345, 122, 12, 'c2a208db8320931cf6f1b2805d8abf26e61f41f7'),
('puppet', 148933, 121721762, 5894, 'create_resources does not honor ''@@resource'' as exported resource', 'I have an in house nagios module (that will eventually be on the forge) that has a file export defined in it. Every time that export is hit the exporting client side throws an error because it''s trying to write the file locally when it shouldn''t be. This only happens when Puppet Agent 1.6.1 is installed on the puppet server (I back reved the server to 2.4.0 and installed latest 1.6.1 agent and ran into it as well so it''s likely in the agent, but as it requires exported resources working I can''t give a test with just the agent)\r\n\r\nExample error:\r\n{code}\r\nError: Puppet::Util::FileType::FileTypeFlat could not write /etc/nagios/conf.d/host_ldap.home.bardicgrove.org_ldap.home.bardicgrove.org.cfg: No such file or directory @ rb_sysopen - /etc/nagios/conf.d/host_ldap.home.bardicgrove.org_ldap.home.bardicgrove.org.cfg\r\nError: /Stage[main]/Nagios::Client/Nagios::Resource[ldap.home.bardicgrove.org]/Nagios::Resource::Host[ldap.home.bardicgrove.org]/Nagios_host[ldap.home.bardicgrove.org]: Could not evaluate: Puppet::Util::FileType::FileTypeFlat could not write /etc/nagios/conf.d/host_ldap.home.bardicgrove.org_ldap.home.bardicgrove.org.cfg: No such file or directory @ rb_sysopen - /etc/nagios/conf.d/host_ldap.home.bardicgrove.org_ldap.home.bardicgrove.org.cfg\r\n{code}\r\n\r\nThe code that is getting called is listed in [0] which gets called by [1] on all systems.\r\n\r\n[0] https://github.com/tykeal/puppet-nagios/blob/master/manifests/resource.pp#L87-L91\r\n[1] https://github.com/tykeal/puppetserver-mod-profile/blob/master/manifests/nagios/client.pp\r\n\r\nFull lab / environment configuration can be found by a combination of the following 4 repositories:\r\n\r\nhttps://github.com/tykeal/puppetserver-main\r\nhttps://github.com/tykeal/puppetserver-hiera\r\nhttps://github.com/tykeal/puppetserver-mod-profile\r\nhttps://github.com/tykeal/puppetserver-mod-role\r\n\r\nUPDATE\r\n----\r\nThe problem here came from use of {{create_resources}} with resource type preceded by {{@@}} to indicate that the resource is exported.\r\nThere may also be a problem with virtual resources.', 'https://tickets.puppetlabs.com/browse/PUP-6698', 'https://github.com/puppetlabs/puppet/pull/5894', '2016-08-24T10:36:58.000-0700', '2019-04-04T22:40:17.000-0700', '2019-04-04T22:40:17.000-0700', 'Closed', 'resolved-issue-added', 36, '0', 1, 17, 0, 3, '091e258564073f90b04747e489c7dac943bc7333'),
('puppet', 131111, 127452312, 6018, 'Overriding evaluated resources silently changes its parameters wo re-eval', 'Override of user defined resources that have been evaluated will just change its parameters without re-evaluating its body. It also says nothing about that this happened. This is a problem in itself since it means that the resource will end up in the catalog with different parameters than those that were used when its body was evaluated. It is like having evaluated "add(2,2)=>4" and then changing it so it is reported as "add(3,2)=>4". This is total nonsense.\r\n\r\n{code:puppet}\r\ndefine foo($message) { notify {"$title n1": message => $message } }\r\nnotify { ''n1'': message => ''unchanged'' }\r\nfoo {''f1'': message => ''unchanged'' }\r\ndefine delayed {\r\n  Notify <| title == ''n1'' |>    { message => ''changed'' }\r\n  Foo    <| title == ''f1'' |>    { message => ''changed'' }\r\n}\r\ndelayed {''d1'': }\r\n{code}\r\nProduces:\r\n{code}\r\nNotice: Compiled catalog for funnybones.com in environment production in 0.06 seconds\r\nNotice: changed\r\nNotice: /Stage[main]/Main/Notify[n1]/message: defined ''message'' as ''changed''\r\nNotice: unchanged\r\nNotice: /Stage[main]/Main/Foo[f1]/Notify[f1 n1]/message: defined ''message'' as ''unchanged''\r\n{code}\r\n\r\nIn the example above it can be noted that the notify resource in the ''foo'' body is unchanged since the parameters to Foo[f1] was changed after evaluation.\r\n\r\nThis means that override is sensitive to evaluation order. We cannot perform reevaluation of the resource as it ultimately leads to the ability to write infinite loops (the change causes it to do another override, it could then also be used to affect the logic that included it in the first place which in essence means user has access to the catalog and can mutate anything (although with a horrible blunt API).\r\n\r\nIt should probably be an error to override something that has already been evaluated as the result that is produced is nonsense. Such a change is however not backwards compatible since currently nothing much happens and the change would break manifests that do this.\r\n\r\nThe more drastic approach of removing overrides will not work as long as what it is used to solve is not supported in a better way (e.g. merging reources). ', 'https://tickets.puppetlabs.com/browse/PUP-6290', 'https://github.com/puppetlabs/puppet/pull/6018', '2016-05-11T08:53:50.000-0700', '2019-04-04T22:40:22.000-0700', '2019-04-04T22:40:22.000-0700', 'Closed', '', 15, '0', 3, 79, 11, 3, '6bb785b43570a750f9aa9781472d51726a259ffd'),
('puppet', 130428, 163922882, 6552, 'include undef doesn''t fail', '{code}\r\n❯ puppet apply -e "include undef"\r\nNotice: Compiled catalog for zhora.local in environment production in 0.04 seconds\r\nNotice: Applied catalog in 0.03 seconds\r\n{code}\r\n\r\nExpected results: compilation failure\r\n\r\nSimilarly, {{include ''''}} doesn''t fail, though {{include nosuchclass}} does.\r\n\r\nExample scenario: {{include $::some::class::tyypo}} (in my case, I accidentally grabbed the dollar sign while copying and pasting)', 'https://tickets.puppetlabs.com/browse/PUP-6274', 'https://github.com/puppetlabs/puppet/pull/6552', '2016-05-06T14:18:02.000-0700', '2019-04-04T22:40:22.000-0700', '2019-04-04T22:40:22.000-0700', 'Closed', 'low-hanging-fruit', 3, '0', 1, 17, 0, 2, '497f5c0c888cd05aeb680b46c12204edfe0b2128'),
('puppet', 60589, 67460605, 4902, 'Update puppet package dependencies to require ruby 1.9.3 or greater', 'Update rpm, deb, gem packages to require ruby 1.9.3 as puppet will no longer run on pre-1.9.3.', 'https://tickets.puppetlabs.com/browse/PUP-3740', 'https://github.com/puppetlabs/puppet/pull/4902', '2014-12-04T12:02:54.000-0800', '2019-04-04T22:41:17.000-0700', '2019-04-04T22:41:17.000-0700', 'Closed', '', 2, '0', 1, 2, 0, 1, 'e5d5ce08b1310af5d7ce392bf8c768034b5ec672'),
('puppet', 21452, 614558290, 8566, 'incorrect permissions in rpms', 'The /usr/share/doc/puppet-3.3.1 and below directories have incorrect perms:\r\n\r\n<pre>\r\n% rpm -qlpv http://yum.puppetlabs.com/el/6/products/x86_64/puppet-3.3.1-1.el6.noarch.rpm|egrep ^d.+share.doc\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:03 /usr/share/doc/puppet-3.3.1\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/etc\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/etc/hieradb\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/data\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/data/manifests\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/ntp\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/ntp/manifests\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/ntp/templates\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/users\r\ndrwxr-x---    2 puppet  puppet                      0 Oct  7 19:00 /usr/share/doc/puppet-3.3.1/examples/hiera/modules/users/manifests\r\n</pre>\r\n\r\nthey''re all 0750', 'https://tickets.puppetlabs.com/browse/PUP-1099', 'https://github.com/puppetlabs/puppet/pull/8566', '2013-12-16T11:45:10.000-0800', '2019-04-04T22:41:22.000-0700', '2019-04-04T22:41:22.000-0700', 'Closed', 'redmine', 2, '0', 1, 292, 186, 5, 'c03324c5ded83df7dfbc3f8859e62e66bb2ba97e'),
('puppet', 15140, 30688020, 3691, 'Use consistent puppet agent service name on all platforms', 'For unknown reasons, the puppet agent service was renamed to puppetagent as part of #16144… but only on Fedora. Everywhere else it’s puppet.\r\n\r\nThis inconsistency is bad and pointless.\r\n\r\n 1. Let’s restore puppet as the agent’s service name on Fedora. It’s possible systemd supports some form of aliasing or symlinking; if so, we should change the name to puppet and use aliasing to keep puppetagent working until Puppet 4 (when we can remove it). If aliasing is infeasible, we should ship duplicate service configs to re-enable puppet.\r\n 2. Can anyone give a really really good reason for changing the name of the agent service and inconveniencing everybody? Is puppet confusing somehow? If so, we should change it EVERYWHERE at the same time on the Puppet 4 boundary.', 'https://tickets.puppetlabs.com/browse/PUP-411', 'https://github.com/puppetlabs/puppet/pull/3691', '2013-09-24T11:48:16.000-0700', '2019-04-04T22:41:24.000-0700', '2019-04-04T22:41:24.000-0700', 'Closed', '', 3, '0', 1, 1, 2, 1, 'f54a3db72040098235ef1bb21aa23565533a8c4a'),
('puppet', 14935, 30409618, 3673, 'Windows installer options should override existing settings', '', 'https://tickets.puppetlabs.com/browse/PUP-388', 'https://github.com/puppetlabs/puppet/pull/3673', '2013-09-18T23:00:50.000-0700', '2019-04-04T22:41:26.000-0700', '2019-04-04T22:41:26.000-0700', 'Closed', 'windows', 5, '0', 1, 127, 0, 1, '73d47b9d32f40c82bcd3ce0cca43c950cd417ea8'),
('puppet', 16317, 49633429, 4404, 'Installer for Puppet 3 does not check for hiera', 'The `install.rb` script for puppet checks for facter and will refuse to install puppet if facter is not on the system. However, puppet also cannot function correctly without hiera and the `install.rb` script does not check for that.\r\n\r\nThe installation script that we ship in the tarball should also check for hiera being present.', 'https://tickets.puppetlabs.com/browse/PUP-530', 'https://github.com/puppetlabs/puppet/pull/4404', '2013-10-07T11:37:05.000-0700', '2019-04-04T22:41:26.000-0700', '2019-04-04T22:41:26.000-0700', 'Closed', '', 1, '0', 2, 5, 14, 2, '8b482197744d0f45e6da0c6e890abb6844852d8f'),
('puppet', 19920, 215624128, 7089, 'puppetmaster-passenger package does not afford a way to test status of puppet master', 'The Debian puppetmaster-passenger package provides for running puppet master workers via apache/passenger, but there is no parallel to the init.d/puppetmaster script''s `service puppetmaster status` for determining whether puppet master is up.  The best you can do is to check `service apache2 status`.', 'https://tickets.puppetlabs.com/browse/PUP-912', 'https://github.com/puppetlabs/puppet/pull/7089', '2013-12-02T15:40:37.000-0800', '2019-04-04T22:41:26.000-0700', '2019-04-04T22:41:26.000-0700', 'Closed', '', 1, '0', 2, 113, 59, 2, 'd475e3889a27cc89cd0b9309569e12c22aa28b35'),
('puppet', 41044, 17869541, 2831, 'puppet-kick.8.gz conflict upgrading from 2.7.26 to 3.6.2', '{noformat}\r\n# apt-get install puppet facter puppet-common ruby-rgen\r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\nThe following extra packages will be installed:\r\n  hiera libjson-ruby ruby-json virt-what\r\nSuggested packages:\r\n  puppet-el vim-puppet ruby-selinux libselinux-ruby1.8 librrd-ruby1.9.1 librrd-ruby1.8\r\nThe following NEW packages will be installed\r\n  hiera libjson-ruby ruby-json ruby-rgen virt-what\r\nThe following packages will be upgraded:\r\n  facter puppet puppet-common\r\n3 to upgrade, 5 to newly install, 0 to remove and 3 not to upgrade.\r\nNeed to get 1,583 kB of archives.\r\nAfter this operation, 2,330 kB of additional disk space will be used.\r\nDo you want to continue [Y/n]? \r\n(Reading database ... 97569 files and directories currently installed.)\r\nPreparing to replace puppet-common 2.7.26-1puppetlabs1 (using .../puppet-common_3.6.2-1puppetlabs1_all.deb) ...\r\nUnpacking replacement puppet-common ...\r\ndpkg: error processing /var/cache/apt/archives/puppet-common_3.6.2-1puppetlabs1_all.deb (--unpack):\r\n trying to overwrite ''/usr/share/man/man8/puppet-kick.8.gz'', which is also in package puppet 2.7.26-1puppetlabs1\r\nNo apport report written because MaxReports has already been reached\r\n                                                                    dpkg-deb: error: subprocess paste was killed by signal (Broken pipe)\r\nPreparing to replace puppet 2.7.26-1puppetlabs1 (using .../puppet_3.6.2-1puppetlabs1_all.deb) ...\r\n * Stopping puppet agent                                                                                                                                                                                                              [ OK ] \r\nUnpacking replacement puppet ...\r\nSelecting previously unselected package ruby-json.\r\nUnpacking ruby-json (from .../ruby-json_1.6.3-1_i386.deb) ...\r\nSelecting previously unselected package libjson-ruby.\r\nUnpacking libjson-ruby (from .../libjson-ruby_1.6.3-1_all.deb) ...\r\nSelecting previously unselected package hiera.\r\nUnpacking hiera (from .../hiera_1.3.4-1puppetlabs1_all.deb) ...\r\nSelecting previously unselected package ruby-rgen.\r\nUnpacking ruby-rgen (from .../ruby-rgen_0.6.5-1puppetlabs1_all.deb) ...\r\nSelecting previously unselected package virt-what.\r\nUnpacking virt-what (from .../virt-what_1.11-1_i386.deb) ...\r\nPreparing to replace facter 1.6.18-1puppetlabs1 (using .../facter_2.0.2-1puppetlabs1_i386.deb) ...\r\nUnpacking replacement facter ...\r\nProcessing triggers for man-db ...\r\nProcessing triggers for ureadahead ...\r\nErrors were encountered while processing:\r\n /var/cache/apt/archives/puppet-common_3.6.2-1puppetlabs1_all.deb\r\nE: Sub-process /usr/bin/dpkg returned an error code (1)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-2878', 'https://github.com/puppetlabs/puppet/pull/2831', '2014-07-02T10:18:04.000-0700', '2019-04-04T22:41:27.000-0700', '2019-04-04T22:41:27.000-0700', 'Closed', '', 2, '0', 1, 2, 1, 1, '4b13ae6c56a4af7a5a50776c5d0bb956a95bb23a'),
('puppet', 46273, 0, 0, 'Windows MSI contains unneeded files ', 'The windows MSI contains in the puppet directory:\r\n* acceptance\r\n* autotest\r\n* ext\r\n* man\r\n* spec\r\n* tasks\r\n* yardoc\r\n...\r\n\r\nIt doesn''t seem like any of these should be in there.', 'https://tickets.puppetlabs.com/browse/PUP-3003', 'https://github.com/puppetlabs/puppet/commit/a235ab202b3ea9aba8bfe86caba883e3fbd2b9ba', '2014-08-01T16:25:46.000-0700', '2019-04-04T22:41:28.000-0700', '2019-04-04T22:41:28.000-0700', 'Closed', 'windows', 6, '0', 0, 0, 0, 0, 'a235ab202b3ea9aba8bfe86caba883e3fbd2b9ba'),
('puppet', 48100, 19946934, 2987, 'Include indent file in vim-puppet', '', 'https://tickets.puppetlabs.com/browse/PUP-3070', 'https://github.com/puppetlabs/puppet/pull/2987', '2014-08-15T15:48:37.000-0700', '2019-04-04T22:41:30.000-0700', '2019-04-04T22:41:30.000-0700', 'Closed', '', 4, '0', 1, 10, 0, 4, '1b84d3160d442871aba73be79bc7a3238c14d7f8'),
('puppet', 51943, 0, 0, 'Windows agent installer should specify that FQDN is expected', '', 'https://tickets.puppetlabs.com/browse/PUP-3315', 'https://github.com/puppetlabs/puppet/commit/8df1aa9914bfd17dc244cc56e28d3976265b3cfb', '2014-09-18T19:30:37.000-0700', '2019-04-04T22:41:30.000-0700', '2019-04-04T22:41:30.000-0700', 'Closed', 'windows', 4, '0', 0, 0, 0, 0, '8df1aa9914bfd17dc244cc56e28d3976265b3cfb'),
('puppet', 50832, 21046933, 3074, 'Upgrade conflict: puppetmaster-common and puppet-common', 'We''ve already addressed an issue where man pages were moved from the puppet packages to the puppet-common package. Unfortunately, we''re seeing this conflict again when upgrading a system with both puppet and puppetmaster installed. The conflict here being that puppetmaster-common now owns man pages that were previously packaged in puppet-common (or at least the puppet-common package provided by Debian Wheezy).\r\n\r\n{code}\r\nPreparing to replace puppetmaster 2.7.23-1~deb7u3 (using .../puppetmaster_3.7.0.30-1puppetlabs1_all.deb) ...\r\n[ ok ] Stopping puppet master.\r\nUnpacking replacement puppetmaster ...\r\nPreparing to replace puppetmaster-common 2.7.23-1~deb7u3 (using .../puppetmaster-common_3.7.0.30-1puppetlabs1_all.deb) ...\r\n[ ok ] Stopping puppet queue.\r\nUnpacking replacement puppetmaster-common ...\r\ndpkg: error processing /var/cache/apt/archives/puppetmaster-common_3.7.0.30-1puppetlabs1_all.deb (--unpack):\r\n trying to overwrite ''/usr/share/man/man8/puppet-master.8.gz'', which is also in package puppet-common 2.7.23-1~deb7u3\r\n[ ok ] Starting puppet queue.\r\nPreparing to replace puppet 2.7.23-1~deb7u3 (using .../puppet_3.7.0.30-1puppetlabs1_all.deb) ...\r\n[ ok ] Stopping puppet agent.\r\nUnpacking replacement puppet ...\r\nPreparing to replace puppet-common 2.7.23-1~deb7u3 (using .../puppet-common_3.7.0.30-1puppetlabs1_all.deb) ...\r\nUnpacking replacement puppet-common ...\r\nProcessing triggers for man-db ...\r\nErrors were encountered while processing:\r\n /var/cache/apt/archives/puppetmaster-common_3.7.0.30-1puppetlabs1_all.deb\r\nE: Sub-process /usr/bin/dpkg returned an error code (1)\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3227', 'https://github.com/puppetlabs/puppet/pull/3074', '2014-09-10T11:46:03.000-0700', '2019-04-04T22:41:31.000-0700', '2019-04-04T22:41:31.000-0700', 'Closed', '', 3, '0', 1, 2, 0, 1, '55f097184779848378c7f08112ac1140c4f83d68'),
('puppet', 105068, 235995968, 7269, 'puppet.conf permission issues should be blocking - now silently ignoring error', 'If puppetserver can''t access puppet.conf because of permission issues, it logs a warning line and carries on.\r\n\r\nAll configurations in puppet.conf are of course ignored.\r\n\r\nThis is a major headache because user is likely to issue\r\n\r\n{noformat}\r\nsudo /opt/puppetlabs/bin/puppet master --genconfig\r\n{noformat}\r\n\r\nwhich prints out the expected configurations.\r\n\r\nI would prefer the puppetserver to block when unable to access puppet.conf.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5575', 'https://github.com/puppetlabs/puppet/pull/7269', '2015-11-10T01:21:28.000-0800', '2019-04-04T22:46:16.000-0700', '2019-04-04T22:46:16.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 1, 78, 12, 5, 'e0a19c5c34faf7e952e9876602fc0eb331ba3206'),
('puppet', 189799, 119746323, 5850, 'helpful_error_message_when_hostname_not_match_server_certificate test fails with Ruby 2.4', 'When running the puppet acceptance test suite with Ruby 2.4.1, one test fails: https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/helpful_error_message_when_hostname_not_match_server_certificate.rb, with the following output:\r\n\r\n{code}\r\n Test Case tests/helpful_error_message_when_hostname_not_match_server_certificate.rb reported: #<Beaker::DSL::Outcomes::FailTest:\r\nExpected Server hostname ''hquif3c5f1yylte\.delivery\.puppetlabs\.net'' did not match server certificate; expected one of foobar_not_my_hostname, (.*)$ to match ''Warning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Failed to generate additional resources using ''eval_generate'': SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts: SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\nError: /File[/opt/puppetlabs/puppet/cache/lib]: Failed to generate additional resources using ''eval_generate'': SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\nError: /File[/opt/puppetlabs/puppet/cache/lib]: Could not evaluate: Could not retrieve file metadata for puppet:///plugins: SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\nError: Could not retrieve catalog from remote server: SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\nError: Could not send report: SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=foobar_not_my_hostname]\r\n{code}\r\n\r\nThis appears to be the result of SSL erroring in a different spot than previously; the test expects a specialized error message from {{post_connection_check}} (see https://github.com/ruby/ruby/blob/ruby_2_4/ext/openssl/lib/openssl/ssl.rb#L291, called from https://github.com/ruby/ruby/blob/b3209c258eddc093ffdcbf77ee079cdc93f094ae/lib/net/http.rb#L950), but with Ruby 2.4, it appears to be failing two lines earlier, with the error stacktrace pointing to this line: https://github.com/ruby/ruby/blob/ruby_2_4/lib/net/protocol.rb#L44, which calls out to C code.\r\n\r\nWe need to figure out if the failure is due to a change in Ruby''s error checking or a matter of misconfiguration. If the error checking has changed, we may need to update the logic here https://github.com/puppetlabs/puppet/blob/master/lib/puppet/network/http/connection.rb#L226-L234, if possible, to use the new output to still print the helpful error message.', 'https://tickets.puppetlabs.com/browse/PUP-7503', 'https://github.com/puppetlabs/puppet/pull/5850', '2017-05-08T13:30:21.000-0700', '2019-04-12T13:34:12.000-0700', '2019-04-12T13:34:12.000-0700', 'Closed', '', 3, '0', 1, 12, 13, 2, '215f1dfe111ba04b024d625bf830944a00a987d4'),
('puppet', 149101, 82863046, 5234, 'Ruby types still loaded even when a PCore type is found', 'In PE, we recently merged a change that ran `puppet generate types` on all changed environments. This resulted in catalog compile failures on the server side. They looked like the following.\r\n\r\nIt looks as though the PCore file is being loaded first, and then maybe the ruby type is being loaded still? Line 116 in {{profile/master.pp}} is the a use of pe_ini_setting, but not a definition of it.\r\n\r\n{code}\r\n2016-08-25 10:50:34,271 ERROR [qtp1820595966-74] [puppetserver] Puppet Evaluation Error: Error while evaluating a Resource Statement, Evaluation Error: Error while evaluating a Resource Statement, Attempt to redefine entity ''http://puppet.com/2016.1/runtime/resource_type_pp/pe_ini_setting''. Originally set /etc/puppetlabs/code/environments/production/.resource_types/pe_ini_setting.pp. at /opt/puppetlabs/puppet/modules/puppet_enterprise/manifests/profile/master.pp:116:3 on node wiagamb4u9sm77e.delivery.puppetlabs.net\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:113:in `fail_redefine''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:63:in `set_entry''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/module_loaders.rb:152:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/runtime3_type_loader.rb:66:in `find_impl''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/runtime3_type_loader.rb:55:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:142:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:141:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:141:in `internal_load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/base_loader.rb:32:in `load_typed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/loader.rb:49:in `load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:104:in `find_builtin_resource_type''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:71:in `find_resource_type''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:23:in `create_resources''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:310:in `create_resources''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:818:in `eval_ResourceExpression''\r\norg/jruby/RubyArray.java:2412:in `map''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:815:in `eval_ResourceExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:622:in `eval_BlockExpression''\r\norg/jruby/RubyArray.java:1613:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:622:in `eval_BlockExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:32:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:182:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:73:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:587:in `evaluate_definitions''\r\norg/jruby/RubyArray.java:1613:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:585:in `evaluate_definitions''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:584:in `evaluate_definitions''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/errors.rb:64:in `exceptwrap''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:583:in `evaluate_definitions''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:611:in `evaluate_generators''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:608:in `evaluate_generators''\r\norg/jruby/RubyKernel.java:1511:in `loop''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:605:in `evaluate_generators''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:187:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:187:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:241:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:162:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:266:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:264:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `benchmark''\r\n/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/1.9/benchmark.rb:295:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:262:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:53:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:121:in `do_find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:48:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:241:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:47:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:82:in `process''\r\norg/jruby/RubyArray.java:1613:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:81:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:87:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:87:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:60:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:58:in `process''\r\nfile:/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/puppetserver-lib/puppet/server/master.rb:42:in `handleRequest''\r\nPuppet$$Server$$Master_996578613.gen:13:in `handleRequest''\r\nrequest_handler_core.clj:273:in `invoke''\r\njruby_request.clj:46:in `invoke''\r\njruby_request.clj:31:in `invoke''\r\nrequest_handler_service.clj:34:in `handle_request''\r\nrequest_handler.clj:3:in `invoke''\r\nrequest_handler.clj:3:in `invoke''\r\ncore.clj:2493:in `invoke''\r\nring_middleware.clj:284:in `invoke''\r\ncore.clj:168:in `invoke''\r\ncore.clj:211:in `invoke''\r\ncore.clj:45:in `invoke''\r\ncore.clj:330:in `invoke''\r\ncore.clj:51:in `invoke''\r\nringutils.clj:86:in `invoke''\r\nmaster_core.clj:428:in `invoke''\r\nring.clj:21:in `invoke''\r\nring.clj:12:in `invoke''\r\ncomidi.clj:249:in `invoke''\r\nhttp.clj:152:in `invoke''\r\nhttp.clj:152:in `invoke''\r\nhttp.clj:148:in `invoke''\r\ncomidi.clj:336:in `invoke''\r\njetty9_core.clj:424:in `invoke''\r\nnormalized_uri_helpers.clj:80:in `invoke''\r\n{code}\r\n\r\nHere is the PCore file:\r\n{code}\r\ncat /etc/puppetlabs/code/environments/production/.resource_types/pe_ini_setting.pp\r\n# This file was automatically generated on 2016-08-25 10:40:26 -0700.\r\n# Use the ''puppet generate types'' command to regenerate this file.\r\n\r\nPuppet::Resource::ResourceType3.new(\r\n  ''pe_ini_setting'',\r\n  [\r\n    # The basic property that the resource should be in.\r\n    #\r\n    # Valid values are `present`, `absent`.\r\n    Puppet::Resource::Param(Enum[''present'', ''absent''], ''ensure''),\r\n\r\n    # The value of the setting to be defined.\r\n    Puppet::Resource::Param(Any, ''value'')\r\n  ],\r\n  [\r\n    # An arbitrary name used as the identity of the resource.\r\n    Puppet::Resource::Param(Any, ''name'', true),\r\n\r\n    # The name of the section in the ini file in which the setting should be defined.\r\n    Puppet::Resource::Param(Any, ''section''),\r\n\r\n    # The name of the setting to be defined.\r\n    Puppet::Resource::Param(Any, ''setting''),\r\n\r\n    # The ini file Puppet will ensure contains the specified setting.\r\n    Puppet::Resource::Param(Any, ''path''),\r\n\r\n    # The separator string to use between each setting name and value. Defaults to " = ", but you could use this to override e.g. whether or not the separator should include whitespace.\r\n    Puppet::Resource::Param(Any, ''key_val_separator''),\r\n\r\n    # The specific backend to use for this `pe_ini_setting`\r\n    # resource. You will seldom need to specify this --- Puppet will usually\r\n    # discover the appropriate provider for your platform.Available providers are:\r\n    #\r\n    # ruby\r\n    # :\r\n    Puppet::Resource::Param(Any, ''provider'')\r\n  ],\r\n  {\r\n    /(.*)/ => [''name'']\r\n  },\r\n  true)\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6653', 'https://github.com/puppetlabs/puppet/pull/5234', '2016-08-25T11:04:24.000-0700', '2019-04-15T16:17:51.000-0700', '2019-04-15T16:17:51.000-0700', 'Closed', '', 18, '0', 2, 66, 32, 10, '9224550240c421b44f8a0d19caea9d13f96b0df8'),
('puppet', 294574, 263792308, 7441, 'Use OpenSSL::X509::Name#to_utf8', 'Calling {{OpenSSL::X509::Name#to_s}} with a non USASCII string generates a binary ruby string, which can cause problems when later string operations are performed. We should always use the {{to_utf8}} method instead.\r\n\r\n{noformat}\r\nirb(main):013:0> name = "CN=root-ca-天"\r\n=> "CN=root-ca-天"\r\nirb(main):014:0>\r\nirb(main):015:0>  OpenSSL::X509::Name.parse(name).to_s\r\n=> "/CN=root-ca-\\xE5\\xA4\\xA9"\r\nirb(main):016:0>  OpenSSL::X509::Name.parse(name).to_s.encoding\r\n=> #<Encoding:ASCII-8BIT>\r\nirb(main):017:0>  OpenSSL::X509::Name.parse(name).to_utf8\r\n=> "CN=root-ca-天"\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9472', 'https://github.com/puppetlabs/puppet/pull/7441', '2019-02-01T16:44:29.000-0800', '2019-05-13T14:18:21.000-0700', '2019-05-13T14:18:21.000-0700', 'Closed', 'resolved-issue-added', 3, '0', 2, 80, 71, 18, 'a189789e77d5ab897f698bd4db3b0f84c3cc6522'),
('puppet', 301985, 266968273, 7462, 'Puppet Device plugin sync slow', '*Puppet Version: 6.0.5*\r\n *Puppet Server Version: 2019.0.0.67 (PE 2019.0.2)*\r\n *OS Name/Version: CentOS 7*\r\n\r\nChanges to Puppet Device plugin sync [PUP-8766|https://tickets.puppetlabs.com/browse/PUP-8766] appear to have greatly increased the time it takes for plugin sync to execute:\r\n\r\n*+2019.0.1+*\r\n{noformat}real	0m16.590s\r\nuser	0m4.394s\r\nsys	0m0.734s\r\n{noformat}\r\n *+2019.0.2+*\r\n{noformat}real	1m7.999s\r\nuser	0m32.533s\r\nsys	0m1.017s\r\n{noformat}\r\n*+2019.1.0 RC+*\r\n{noformat}real	1m2.258s\r\nuser	0m30.187s\r\nsys	0m0.880s\r\n{noformat}\r\n \r\n[Full log of a slow run|https://gist.github.com/shermdog/3439746e89ab73a40d616b4d119fa54b]', 'https://tickets.puppetlabs.com/browse/PUP-9584', 'https://github.com/puppetlabs/puppet/pull/7462', '2019-03-27T15:39:24.000-0700', '2019-05-13T14:18:26.000-0700', '2019-05-13T14:18:26.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 2, 87, 117, 2, '209789fead4833eaa10c3ae7ad44388d184881b4'),
('puppet', 302650, 266751578, 7458, 'waitforcert not working in 6.4', 'waitforcert doesnt seem to be working with puppet agent 6.4, at least on windows. Tested on Windows Server 2008 SP2 x64 and Windows Server 2012 R2.\r\n{code:java}\r\nPS C:\Users\Administrator> puppet agent -t --waitforcert 10\r\nInfo: csr_attributes file loading from C:/ProgramData/PuppetLabs/puppet/etc/csr_attributes.yaml\r\nInfo: Creating a new SSL certificate request for lab1-2012r2-10.nkgnet.local\r\nInfo: Certificate Request fingerprint (SHA256): 75:90:E7:59:1B:D2:E7:A9:46:8F:71:27:83:7F:E8:65:37:AB:1D:26:67:0D:1E:AD:5B:46:6B:B7:22:50:20:31\r\nInfo: Certificate for lab1-2012r2-10.nkgnet.local has not been signed yet\r\nExiting; no certificate found and waitforcert is disabled\r\nPS C:\Users\Administrator>{code}', 'https://tickets.puppetlabs.com/browse/PUP-9589', 'https://github.com/puppetlabs/puppet/pull/7458', '2019-04-01T21:39:51.000-0700', '2019-05-13T14:18:28.000-0700', '2019-05-13T14:18:28.000-0700', 'Closed', 'resolved-issue-added', 2, '0', 1, 3, 14, 2, '08042375b9e31b815a46fec4d205bbcc3202a6a0'),
('puppet', 302189, 267158074, 7467, 'Failed refreshonly resources generate duplicate event', 'PUP-9339 and PUP-8908 both cause an event to be added to the report when a refreshed resource fails. PUP-8908 was fixed first in 5.5.3, then PUP-9339 was fixed in 4.10.13 and merged up, but the semantic conflict wasn''t resolved correctly in [https://github.com/puppetlabs/puppet/commit/c3eed15cd1c2f4bdd6bdd3cca9acffe0a9a103a1] causing a duplicate event to end up in puppetdb. The duplicate events were first released in 5.5.9.\r\n\r\nTo reproduce:\r\n{code:puppet}exec { ''duplicate exec events'':\r\n  command     => ''/usr/bin/false'',\r\n  subscribe   => Notify[''test1''],\r\n  refreshonly => true,\r\n}\r\n\r\nnotify { ''test1'':\r\n  message => ''foo''\r\n}\r\n{code}\r\n\r\nresults in 2 events for the refreshed event:\r\n\r\n{code:yaml}\r\n  Exec[duplicate exec events]:\r\n    title: duplicate exec events\r\n    file: "/Users/josh/work/puppet/manifest.pp"\r\n    line: 1\r\n    resource: Exec[duplicate exec events]\r\n    resource_type: Exec\r\n    provider_used: posix\r\n    containment_path:\r\n    - Stage[main]\r\n    - Main\r\n    - Exec[duplicate exec events]\r\n    evaluation_time: 0.000102\r\n    tags:\r\n    - exec\r\n    - class\r\n    time: ''2019-03-28T13:59:12.868197000-07:00''\r\n    failed: true\r\n    failed_to_restart: true\r\n    changed: false\r\n    out_of_sync: true\r\n    skipped: false\r\n    change_count: 0\r\n    out_of_sync_count: 2\r\n    events:\r\n    - audited: false\r\n      property: \r\n      previous_value: \r\n      desired_value: \r\n      historical_value: \r\n      message: ''Failed to call refresh: ''''/usr/bin/false'''' returned 1 instead of one\r\n        of [0]''\r\n      name: refresh\r\n      status: failure\r\n      time: ''2019-03-28T13:59:12.882309000-07:00''\r\n      redacted: false\r\n      corrective_change: false\r\n    - audited: false\r\n      property: \r\n      previous_value: \r\n      desired_value: \r\n      historical_value: \r\n      message: ''Failed to call refresh: ''''/usr/bin/false'''' returned 1 instead of one\r\n        of [0]''\r\n      name: resource_error\r\n      status: failure\r\n      time: ''2019-03-28T13:59:12.882390000-07:00''\r\n      redacted: false\r\n      corrective_change: false\r\n    corrective_change: false\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9586', 'https://github.com/puppetlabs/puppet/pull/7467', '2019-03-28T14:00:06.000-0700', '2019-05-13T14:18:30.000-0700', '2019-05-13T14:18:30.000-0700', 'Closed', 'customer0', 2, '0', 1, 0, 1, 1, '0af747ad319b35d9b2a0e3dec99fdb9c1b3827b9'),
('puppet', 215426, 263423821, 7436, 'Use of server_list can cause misleading agent errors', 'h3. The issue:\r\n\r\nthe "server_urls" configuration setting can mask server-side issues by mistakingly pointing to a connectivity issue on port 0:\r\n\r\n{noformat}\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Failed to generate additional resources using ''eval_generate'': Connection refused - connect(2) for nil port 0\r\n{noformat}\r\n\r\nh3. Replication: \r\n\r\nConfigure an agent to connect to a master with the server_list setting:\r\n\r\n{noformat}\r\n[agent]\r\n#server = pe-201724-master.puppetdebug.vlan\r\nserver_list = pe-201724-master.puppetdebug.vlan:8140\r\n{noformat}\r\n\r\nRevoke the agent''s certificate on the master and observe the error on the next agent run:\r\n\r\nh3. Actual result:\r\n\r\n{noformat}\r\nWarning: Could not select a functional puppet master\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: Connection refused - connect(2) for nil port 0\r\nInfo: Retrieving pluginfacts\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Failed to generate additional resources using ''eval_generate'': Connection refused - connect(2) for nil port 0\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts: Connection refused - connect(2) for nil port 0\r\nInfo: Retrieving plugin\r\nError: /File[/opt/puppetlabs/puppet/cache/lib]: Failed to generate additional resources using ''eval_generate'': Connection refused - connect(2) for nil port 0\r\nError: /File[/opt/puppetlabs/puppet/cache/lib]: Could not evaluate: Could not retrieve file metadata for puppet:///plugins: Connection refused - connect(2) for nil port 0\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Connection refused - connect(2) for nil port 0\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\nError: Could not send report: Connection refused - connect(2) for nil port 0\r\n{noformat}\r\n\r\nh3. Expected result:\r\n\r\nChange the agent''s configuration to use the "server" setting and observe the difference.  The error points more clearly to an SSL issue:\r\n\r\n{noformat}\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\nInfo: Retrieving pluginfacts\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Failed to generate additional resources using ''eval_generate'': SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts: SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\nInfo: Retrieving plugin\r\nError: /File[/opt/puppetlabs/puppet/cache/lib]: Failed to generate additional resources using ''eval_generate'': SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\nError: /File[/opt/puppetlabs/puppet/cache/lib]: Could not evaluate: Could not retrieve file metadata for puppet:///plugins: SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\nError: Could not send report: SSL_connect SYSCALL returned=5 errno=0 state=unknown state\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8036', 'https://github.com/puppetlabs/puppet/pull/7436', '2017-10-09T12:25:36.000-0700', '2019-05-13T14:18:31.000-0700', '2019-05-13T14:18:31.000-0700', 'Closed', 'resolved-issue-added', 6, '0', 1, 3, 2, 1, '1e45c71e7f608193019e2b03afcc850ce7146055'),
('puppet', 300500, 269218832, 7478, 'Not possible to set Multiple Logging Destination with puppet agent  anymore', 'Puppet Version: > 5.5.7\r\n OS Name/Version: Debian Jessie\r\n\r\nBeginning with release 5.5.7, it is not possible anymore to have more then 1 logdestination.\r\n\r\nBefore it was possible to have multiple Logging Destinations, by appending logdest multiple times\r\n\r\nThis seems to be the Ticket related to it.\r\n https://tickets.puppetlabs.com/browse/PUP-2997\r\n Fixed since: PUP 5.5.7, PUP 6.0.3\r\n\r\nExample:\r\n\r\npuppet agent --no-daemonize --detailed-exitcodes --onetime --logdest console --logdest /var/log/puppetlabs/puppet/puppet.log\r\n Starting with release 5.5.7 the puppet agent ignores the second logdestination, which keeps us from saving changes to a local file.\r\n\r\nSteps to reproduce:\r\n\r\nInstall Agent 5.5.6 and run:\r\n{code} puppet agent --no-daemonize --detailed-exitcodes --onetime --logdest console --logdest /var/log/puppet.log\r\n{code}\r\nOutput will be show in console and also send to the file\r\n\r\nInstall Agent 5.5.7 or any higher version number and run:\r\n{code} puppet agent --no-daemonize --detailed-exitcodes --onetime --logdest console --logdest /var/log/puppet.log\r\n{code}\r\nOutput will be show in console but not send to the file\r\n\r\nDesired Behavior: Have all mentioned logdestinations enabled agian\r\n\r\nActual Behavior: Only the first mentioned logdestination will be applied', 'https://tickets.puppetlabs.com/browse/PUP-9565', 'https://github.com/puppetlabs/puppet/pull/7478', '2019-03-15T09:58:52.000-0700', '2019-05-13T14:21:20.000-0700', '2019-05-13T14:21:20.000-0700', 'Closed', 'resolved-issue-added', 4, '0', 1, 2, 11, 2, 'a656b828f2a3db98c5a8c87d04b6b2a249b3a7a0'),
('puppet', 108701, 103943388, 5578, 'Unnecessary amount of dns requests with SRV records', 'Originally filed in https://projects.puppetlabs.com/issues/19842 by Vincent Gallissot:\r\n\r\nI want to make you a feedback of using SRV records with Puppet 3.1.1\r\n\r\nMy architecture is :\r\n\r\n* puppetca = puppet master acting as ca and able to manage all nodes files (centos 6.3 with Puppet server 3.1.1)\r\n* puppet1 and puppet2 = puppet master not ca. They are configured the old way (not with SRV) with ca_server=puppetca, server=fqdn and ca=false\r\n* mynode = desktop with puppet 3.1.1, under Fedora 16\r\n\r\nHere are my DNS records : \r\n\r\nx-puppet.tcp IN SRV 0 50 8140 puppet1.foobar.fr.\r\nx-puppet.tcp IN SRV 0 50 8140 puppet2.foobar.fr.\r\nx-puppet.tcp IN SRV 10 100 8140 puppetca.foobar.fr.\r\nx-puppet-ca.tcp IN SRV 0 100 8140 puppetca.foobar.fr.\r\nx-puppet-report.tcp IN SRV 0 100 8140 puppetca.foobar.fr.\r\n\r\nFirst of all, thanks for correcting the bug in http://projects.puppetlabs.com/issues/18161, works fine now !\r\n\r\nSecondly, the tips given in http://projects.puppetlabs.com/issues/16840 work for me too.\r\n\r\nThirdly, as you can see in logs (files mynode, puppet1 and puppet2 .foobar.fr), with SRV, nodes try to reach every masters and generate a lot of requests, not only dns ones. It tries to access all servers in “x-puppet.tcp.foobar.fr.” and it’s not the best way. It also continue to resolve SRV even if it’s downloading its configuration from the master. Using SRV records is for high availability and load distribution. It shouldn’t double the nodes connexions. In facts, the more masters you have the more your network is overloaded.\r\n\r\nNodes should try to resolve “x-puppet.tcp.foobar.fr.” only one time and if the returned server is available to connect, the node shouldn’t do any other SRV request for “x-puppet.tcp.foobar.fr.” or tries to connect to the other masters.\r\n\r\nAs it’s written in the doc, the amount of DNS requests is very high, but is not needed at all.', 'https://tickets.puppetlabs.com/browse/PUP-5587', 'https://github.com/puppetlabs/puppet/pull/5578', '2015-12-08T09:43:40.000-0800', '2019-05-17T15:57:20.000-0700', '2019-05-17T15:57:20.000-0700', 'Closed', '', 3, '0', 1, 23, 1, 1, ''),
('puppet', 224551, 268534804, 7475, 'Error message for certificate name mismatch is clear as mud', 'A common error in enterprise environments is a mismatch between the server setting on the agent and the common name of the master''s cert / its dns alt names.\r\n\r\nToday, if this situation occurs the error message the agent prints is as clear as mud. For example:\r\n\r\n{code}\r\n# You can''t tell, but for this run server=master.tld\r\n# \r\n[root@aws-1 ssl]# puppet agent -t\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=master-1.tld]\r\nInfo: Retrieving pluginfacts\r\nError: /File[/opt/puppetlabs/puppet/cache/facts.d]: Failed to generate additional resources using ''eval_generate'': SSL_connect returned=1 errno=0 state=error: certificate verify failed: [ok for /CN=master-1.tld]\r\n...\r\n{code}\r\n\r\nThis error message is INCREDIBLY unhelpful. There''s kinda-sorta a reference to the master''s certificate being {{master-1.tld}}, but you can''t see in the message that the configured server is {{master.tld}}. There''s also no reference to other valid alt names.\r\n\r\nWhat we want:\r\n\r\nThe error message should clearly state something along the lines of\r\n\r\n{code}\r\nError: Unable to validate server certificate. Expected "master.tld":\r\n  server certificate common name "master-1.tld" does not match\r\n  server certificate alt name "puppet" does not match\r\n  server certificate alt name "master" does not match\r\n  server certificate alt name "master-alt.tld" does not match\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8213', 'https://github.com/puppetlabs/puppet/pull/7475', '2017-11-28T16:41:45.000-0800', '2019-05-30T15:54:18.000-0700', '2019-05-30T15:54:18.000-0700', 'Closed', 'resolved-issue-added', 9, '0', 2, 25, 338, 8, '1f632ae9de16bc1d9f8fef19d29b40e470171362'),
('puppet', 106805, 57279458, 4603, 'Puppet fails to convert Windows Unicode group or user names to sids', 'The win32-security gem that Puppet uses for SID conversion uses ANSI versions of APIs that can make it fail to convert Unicode group / user names to SIDs properly.\r\n\r\nhttps://github.com/puppetlabs/puppet-win32-ruby/blob/2.1.x-x64/ruby/lib/ruby/gems/2.1.0/gems/win32-security-0.2.5/lib/win32/security/windows/functions.rb#L79-L80', 'https://tickets.puppetlabs.com/browse/PUP-5538', 'https://github.com/puppetlabs/puppet/pull/4603', '2015-11-23T00:52:53.000-0800', '2019-06-03T09:24:26.000-0700', '2019-06-03T09:24:26.000-0700', 'Closed', 'encoding;i18n;windows', 15, '0', 2, 65, 6, 2, '42fceb295c4f37ca99b5d0d283b30970745dfadb'),
('puppet', 28870, 45336360, 4258, 'Generated resources never receive dependency edges', 'I''ve preserved the original description below for posterity. Note however that this issue is now tracking only the first (of two) issues described in the original problem report.\r\n\r\n-----\r\nFirst off I will quickly explain what it is I''m trying to do.  I have installed the puppetlabs-apache-0.0.3 module that provides a new type called a2mod.  My goal is to use virtual resources to collect a list of modules to enable/disable on a node.  I would also however, like to ensure that all other apache modules are disabled on the system.  I found the resources type has a purge option.  I then updated the provider to have an instances section since it did not have one.  It looks like this:\r\n\r\n{code}\r\n    class << self\r\n        attr_accessor :defpath\r\n    end\r\n\r\n    @defpath = "/etc/apache2/mods-available/"\r\n\r\n    def self.instances\r\n        self.defpath = [self.defpath] unless self.defpath.is_a? Array\r\n\r\n        instances = []\r\n\r\n        self.defpath.each do |path|\r\n            unless FileTest.directory?(path)\r\n                Puppet.debug "Apache module path %s does not exist" % path\r\n                next\r\n            end\r\n\r\n            check = [:ensure]\r\n\r\n            if public_method_defined? :enabled?\r\n                check << :enable\r\n            end\r\n\r\n            Dir.entries(path).each do |name|\r\n                if name =~ /.load/\r\n                    name = name.sub(".load","")\r\n                    instances << new(:name => name, :path => path)\r\n                end\r\n            end\r\n        end\r\n        instances\r\n    end\r\n{code}\r\n\r\nI then used the resources type to purge out unused apache modules.  This seemingly does the job I wanted it to do.  However, I wanted to notify my apache to restart if it had disabled any modules.  I added the notify metaparameter to the configuration but it would never notify.\r\n\r\n{code}\r\n    resources { ''a2mod'': tag => ''modtest'', notify => Exec[''apache2reload''], purge => true, loglevel => ''notice'' }\r\n{code}\r\n\r\nI then tried to add a tag for testing purposes and it would not see the tag being set.  I could however use loglevel but it would seem other metaparameters would not work properly.  I''m assuming that all parameters on   http://docs.puppetlabs.com/references/stable/metaparameter.html should be available to the resources type as indicated by the documentation for the resources type.\r\n\r\nSo, I''m wanting to understand if "all" metaparameters should work with the resources type or not.  And, is there any possible way to do a purge that would allow me to do a notify of another resource.', 'https://tickets.puppetlabs.com/browse/PUP-1963', 'https://github.com/puppetlabs/puppet/pull/4258', '2014-03-17T11:37:31.000-0700', '2019-06-03T16:25:01.000-0700', '2019-06-03T16:25:01.000-0700', 'Closed', 'redmine', 33, '0', 1, 187, 24, 6, '9aaed38999ee62a03520129128d699e09a1d2f7d'),
('puppet', 310858, 283980255, 7544, 'Reduce specificity of gem and pip providers', 'Due to the recent changes on package providers, when\r\nno default package provider is explicitly set it will\r\nalways fallback to gem/puppet_gem/pip/pip3 because of the way\r\nthat specificity is calculated for a system which does\r\nnot have a default(the match expression and number of ancestors)\r\n\r\nSince those are specific language package managers,\r\ntheir specificity should be lowered to 1 if none of those providers\r\nare set as default provider, otherwise the specificity\r\nis calculated like it was before.', 'https://tickets.puppetlabs.com/browse/PUP-9727', 'https://github.com/puppetlabs/puppet/pull/7544', '2019-05-31T03:22:47.000-0700', '2019-06-06T00:20:54.000-0700', '2019-06-06T00:20:54.000-0700', 'Resolved', '', 1, '0', 1, 85, 1, 7, 'a433c52a73ffe8427ce5b0f3ba7c1090685777c5'),
('puppet', 21655, 932444763, 8910, 'Incorrect ordering of group and user resource purging', 'I am using the following below code to purge/remove all unmanaged (to Puppet) users and groups on a system so that only OS groups and users I allow can exist.\r\n\r\nI receive errors in my log though because Puppet will attempt to remove a (primary) group before it removes the corresponding user.  Although a subsequent run has no errors (the user was eventually purged) I am left with undesired groups until I run Puppet again.  The current work around is to run Puppet multiple times and modify monitoring scripts to ignore the group deletion errors.\r\n\r\nAttempts at using before, require, ->, etc. notation do not cause the desired order (purge users then groups).\r\n\r\n\r\nI''d propose that Puppet be modified such that it either honors the specified ordering or as a rule always processes user removal/purging before it processes any group removal/purging.\r\n\r\n\r\n\r\nError in log:\r\n{noformat}\r\nError: /Group[vagrant]/ensure: change from present to absent failed: Could not delete group vagrant: Execution of ''/usr/sbin/groupdel vagrant'' returned 8: groupdel: cannot remove the primary group of user ''vagrant''\r\n{noformat}\r\n\r\n(note that vagrant was not logged in)\r\n(This was on an Ubuntu 12.04 server)\r\n\r\n\r\nIteration # 1 (failed):\r\n\r\n{noformat}\r\n  resources { ''user'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n  }\r\n\r\n  resources { ''group'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n  }\r\n{noformat}\r\n\r\nIteration # 2 (failed):\r\n{noformat}\r\n  resources { ''user'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n    before	=> Resources[''group''],\r\n  }\r\n\r\n  resources { ''group'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n  }\r\n{noformat}\r\n\r\n\r\nIteration # 3 (failed):\r\n{noformat}\r\n  resources { ''user'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n  }\r\n\r\n  resources { ''group'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n    require	=> Resources[''user''],\r\n  }\r\n{noformat}\r\n\r\n\r\nIteration # 4 (failed):\r\n{noformat}\r\n  resources { ''user'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n    before	=> Resources[''group''],\r\n  }\r\n\r\n  resources { ''group'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n    require	=> Resources[''user''],\r\n  }\r\n{noformat}\r\n\r\n\r\nIteration # 5 (failed):\r\n{noformat}\r\n  resources { ''user'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n  }\r\n\r\n  resources { ''group'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n  }\r\n\r\n  Resources[''user''] -> Resources[''group'']\r\n{noformat}\r\n\r\n\r\nIteration # 6 (failed):\r\n{noformat}\r\n  resources { ''user'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n    before	=> Resources[''group''],\r\n  }\r\n\r\n  resources { ''group'':\r\n    purge => true,\r\n    unless_system_user => false,\r\n    require	=> Resources[''user''],\r\n  }\r\n\r\n  Resources[''user''] -> Resources[''group'']\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-1153', 'https://github.com/puppetlabs/puppet/pull/8910', '2013-12-17T14:53:01.000-0800', '2019-06-10T10:19:48.000-0700', '2019-06-10T10:19:48.000-0700', 'Closed', 'autorequire;group;redmine;type_and_provider;user', 23, '0', 1, 61, 14, 2, ''),
('puppet', 293409, 275530998, 7502, 'Readd password protected private key support', 'If {{passfile}} exists when puppet starts for the first time, then it will encrypt its private key using 3DES-CBC. However, the current implementation is a bit dubious. If puppet tries to load an encrypted private key and the {{passfile}} does not exist, then ruby will hang due to openssl prompting for the password. Ruby uses the legacy {{PEM_write_*}} methods that only use 1 iteration. Per https://www.openssl.org/docs/man1.0.2/crypto/pem.html "The encryption key is determined using EVP_BytesToKey(), using salt and an iteration count of 1" and https://github.com/ruby/openssl/issues/13. Also puppetserver does not support password protected private keys, so it can''t be enabled on server hosts.', 'https://tickets.puppetlabs.com/browse/PUP-9466', 'https://github.com/puppetlabs/puppet/pull/7502', '2019-01-24T17:46:26.000-0800', '2019-06-11T16:09:08.000-0700', '2019-06-11T16:09:08.000-0700', 'Resolved', 'resolved-issue-added', 3, '0', 6, 164, 73, 10, 'd252487ae571088dff8dcd4bc1ffaeef9bf21238'),
('puppet', 304723, 276139749, 7509, 'protection against illegal methods in legacy functions hides syntax error', '*Puppet Version: 6.4.0*\r\n *Puppet Server Version: 6.3.0*\r\n *OS Name/Version: CentOS 7.6.1810*\r\n\r\nAfter updating our Puppet Server to latest release we received this issue on agents:\r\n\r\nroot@xyz1000 # puppet agent --test --environment=production\r\n Info: Using configured environment ''production''\r\n Info: Retrieving pluginfacts\r\n Info: Retrieving plugin\r\n Info: Retrieving locales\r\n Info: Loading facts\r\n Error: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Function Call, The code loaded from /etc/puppetlabs/code/environments/production/modules/etchosts/lib/puppet/parser/functions/get_host_hash.rb does not seem to be a Puppet 3x API function - no ''newfunction'' call. (file: /etc/puppetlabs/code/environments/production/modules/etchosts/manifests/base/solaris.pp, line: 94, column: 15) on node xyz1000.xyz.de\r\n Warning: Not using cache on failed catalog\r\n Error: Could not retrieve catalog; skipping run\r\n\r\nThe affected function is valid and was accepted valid before (I only replaced "values" by an empty array to reduce complexity:\r\n\r\n \r\n{noformat}\r\nmodule Puppet::Parser::Functions\r\n  newfunction(:get_host_hash, :type => :rvalue, :doc => "") do |args|\r\n\r\n    # start with an empty hash\r\n    temp = Hash.new\r\n\r\n    # empty array in this example\r\n    values = Array.new\r\n\r\n    # get the first argument number\r\n    firstargnr = args[1].to_i\r\n\r\n    # get the first argument number\r\n    secondargnr = args[2].to_i\r\n\r\n    # analyze each entry in the values\r\n    values.each do |entry|\r\n\r\n      # split the entry array to sub arrays\r\n      subentry = entry.split\r\n\r\n      # if first requested element starts with # sign or second requested argument starts with + sign skip this entry\r\n      if not subentry[firstargnr].empty? and not subentry[firstargnr].start_with?("#") and and not subentry[secondargnr].empty? and not subentry[secondargnr].start_with?("+")\r\n\r\n        # add to the hash\r\n        temp.merge!({"#{subentry[firstargnr]}" => "#{subentry[secondargnr]}"})\r\n\r\n      end\r\n\r\n    end\r\n\r\n    # return the hash\r\n    temp\r\n\r\n  end\r\n\r\nend\r\n{noformat}\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nWorks fine with 6.0.x and 5.5.x.\r\n\r\n*Actual Behavior:*\r\n\r\nUse of "func3x_check = false" in puppet.conf to get te catalog creation running again.\r\n\r\nroot@xyz1000 # puppet agent --test --environment=production\r\n Info: Using configured environment ''production''\r\n Info: Retrieving pluginfacts\r\n Info: Retrieving plugin\r\n Info: Retrieving locales\r\n Info: Loading facts\r\n Info: Caching catalog for xyz1000.xyz.de\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9643', 'https://github.com/puppetlabs/puppet/pull/7509', '2019-04-15T06:50:07.000-0700', '2019-06-12T04:36:19.000-0700', '2019-06-12T04:36:19.000-0700', 'Resolved', 'resolved-issue-added', 6, '0', 1, 19, 4, 3, 'ac69ecad012458736113db6f677ba1a43cf0eda7'),
('puppet', 224644, 275857965, 7508, 'Tag filtering for skip_tag incorrectly expanded', '{{\--skip_tags foo::bar}} splits the tag on the namespace separator {{::}} and expands to skip the set {{[''foo::bar'', ''foo'', ''bar'']}}. Because resources are tagged with all parent tags, this means that every resource in the `foo` namespace is skipped when {{\--skip_tags foo::bar}} is used. The same expansion issue was addressed for the {{\--tags}} flag in PUP-4495, but it appears that the expansion logic for {{\--tags}} and {{\--skip_tags}} is separate.', 'https://tickets.puppetlabs.com/browse/PUP-8215', 'https://github.com/puppetlabs/puppet/pull/7508', '2017-11-29T10:24:24.000-0800', '2019-06-12T11:46:05.000-0700', '2019-06-12T11:46:05.000-0700', 'Resolved', 'resolved-issue-added', 3, '0', 2, 18, 0, 2, 'cb9eeb7dc4a2d15705915d6f538bad5c85724746'),
('puppet', 300439, 271695722, 7489, 'Puppet upgrades debian packages with pending updates when setting them on hold', '*Puppet Version: 4.10.x, probably other too*\r\n *Puppet Server Version:*\r\n *OS Name/Version: Debian 8, probably other versions too*\r\n\r\nIf puppet sets a package with a pending upgrade on hold (ensure=>held), the pending upgrade is installed before the package is set on hold.\r\n\r\nDescribe steps to reproduce:\r\n\r\n1. Show available versions\r\n{code:java}\r\n# apt-cache policy openssl\r\nopenssl:\r\n  Installed: 1.0.1t-1+deb8u11\r\n  Candidate: 1.0.1t-1+deb8u11\r\n  Version table:\r\n *** 1.0.1t-1+deb8u11 0\r\n        500 http://mirror.ip-platform.net/debian-security/ jessie/updates/main amd64 Packages\r\n        100 /var/lib/dpkg/status\r\n     1.0.1t-1+deb8u8 0\r\n        500 http://mirror.ip-platform.net/debian/ jessie/main amd64 Packages{code}\r\n \r\n\r\n 2. Downgrade package:\r\n\r\n \r\n{code:java}\r\n# puppet resource package openssl ensure=1.0.1t-1+deb8u8\r\nNotice: /Package[openssl]/ensure: ensure changed ''1.0.1t-1+deb8u11'' to ''1.0.1t-1+deb8u8''\r\npackage { ''openssl'':\r\n ensure => ''1.0.1t-1+deb8u8'',\r\n}\r\n{code}\r\n3. Set package on hold:\r\n\r\n \r\n{code:java}\r\n# puppet resource --debug package openssl ensure=held\r\n[...]\r\nDebug: Prefetching apt resources for package\r\nDebug: Executing ''/usr/bin/dpkg-query -W --showformat ''${Status} ${Package} ${Version}\n''''\r\nDebug: Executing: ''/usr/bin/apt-get -q -y -o DPkg::Options::=--force-confold install openssl''\r\nDebug: Executing: ''dpkg --set-selections''\r\nNotice: /Package[openssl]/ensure: ensure changed ''1.0.1t-1+deb8u8'' to ''held''\r\nDebug: Finishing transaction 28203320\r\nDebug: Storing state\r\nDebug: Stored state in 0.45 seconds\r\nDebug: Executing: ''/usr/bin/dpkg-query -W --showformat ''${Status} ${Package} ${Version}\n'' openssl''\r\npackage { ''openssl'':\r\n ensure => ''1.0.1t-1+deb8u11'',\r\n}\r\n{code}\r\n4. Now the package has been upgraded:\r\n{code:java}\r\n# apt-cache policy openssl\r\nopenssl:\r\n Installed: 1.0.1t-1+deb8u11\r\n Candidate: 1.0.1t-1+deb8u11\r\n Version table:\r\n 1.0.2l-1~bpo8+1 0\r\n 200 http://mirror.ip-platform.net/debian/ jessie-backports/main amd64 Packages\r\n *** 1.0.1t-1+deb8u11 0\r\n 500 http://mirror.ip-platform.net/debian-security/ jessie/updates/main amd64 Packages\r\n 100 /var/lib/dpkg/status\r\n 1.0.1t-1+deb8u8 0\r\n 500 http://mirror.ip-platform.net/debian/ jessie/main amd64 Packages{code}\r\n \r\n\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nThe package version stays unchanged and the package is marked on-hold.\r\n\r\n*Actual Behavior:*\r\n\r\nThe package has been upgraded and is on hold. This is counterintuitive and also not reflected by the agent output, especially as the "on hold" setting may be performed especially to prevent the pending upgrade from being installed.\r\n\r\n*Probable cause:*\r\n\r\nThe reason this happens is the apt-get install line marked bold above. If the package already is installed, it should not happen.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9564', 'https://github.com/puppetlabs/puppet/pull/7489', '2019-03-15T05:56:04.000-0700', '2019-06-13T13:07:19.000-0700', '2019-06-13T13:07:19.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 1, 87, 7, 5, 'a9fc5a2f680da06990a87fe8badc96b966ac0c60'),
('puppet', 307503, 277719132, 7517, 'Hiera Lookup Fails when convert_to is used', 'common.yaml has lookup_options configured with convert_to Sensitive for a data item:\r\n{code}\r\nlookup_options:\r\n "^*my_con_pwd":\r\n convert_to:\r\n - "Sensitive"\r\n{code}\r\n\r\nIf lookup_option is configured as shown above but this data is interpolated for another setting in a list, like:\r\n{code}\r\nmy_env_list:\r\n   db_settings:\r\n      db_pwd: "%{hiera(''my_con_pwd'')}"\r\n{code}\r\nthen the following error occurs:\r\n{code}\r\n2019-05-06 17:10:27 -0700 Puppet (err): Evaluation Error: Error while evaluating a Function Call, Lookup of key ''my_env_list'' failed: The convert_to lookup_option for key ''my_con_pwd'' raised error: undefined method `call_function'' for #<Hiera::Scope:0x0000000001bf4e28> \r\n{code}\r\nCall-stack:\r\n{code}\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:111:in `rescue in convert_result''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:105:in `convert_result''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:65:in `block in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:71:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:52:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:76:in `search_and_merge''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `block (2 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `block in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `reduce''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:81:in `block (3 levels) in interpolate_method''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:75:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:81:in `block (2 levels) in interpolate_method''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:19:in `with_scope''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:80:in `block in interpolate_method''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:60:in `block (2 levels) in interpolate_string''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:49:in `gsub''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:49:in `block in interpolate_string''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:133:in `with''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:48:in `interpolate_string''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/interpolation.rb:20:in `interpolate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/context.rb:187:in `interpolate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:92:in `decrypt''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:69:in `decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `block in decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `each_pair''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `block in decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `each_pair''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `block in decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `each_pair''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `block in decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `each_pair''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:72:in `decrypt_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/eyaml_lookup_key.rb:42:in `eyaml_lookup_key''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:53:in `block in lookup_key''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:50:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:50:in `lookup_key''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:31:in `block in invoke_with_location''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:133:in `with''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:30:in `invoke_with_location''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:20:in `block (2 levels) in unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `block (2 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `block in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:19:in `block in unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:133:in `with''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:18:in `unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_key_function_provider.rb:77:in `unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:56:in `block (2 levels) in unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `block (2 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `block in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:219:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:55:in `block in unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:133:in `with''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:48:in `unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/global_data_provider.rb:36:in `unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/global_data_provider.rb:23:in `block (2 levels) in unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:75:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/global_data_provider.rb:23:in `block in unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:19:in `with_scope''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/global_data_provider.rb:18:in `unchecked_key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb:26:in `block in key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:90:in `check''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb:26:in `key_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:125:in `lookup_global''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:321:in `do_lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:67:in `block (4 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:67:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:67:in `block (3 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:133:in `with''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:66:in `block (2 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:91:in `convert_result''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:65:in `block in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:75:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:52:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:52:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:76:in `search_and_merge''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `block (2 levels) in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `block in lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `reduce''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/hiera/puppet_function.rb:74:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/hiera/puppet_function.rb:46:in `hiera_no_default''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n/home/tstuser/tst.pp:59:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:303:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:964:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:933:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:370:in `eval_AssignmentExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:90:in `visit_this_1''\r\n\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:32:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:72:in `block (2 levels) in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:71:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:71:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:70:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:70:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:136:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:386:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:386:in `evaluate_classes''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/include.rb:48:in `include''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n:1:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:303:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:964:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:933:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:48:in `block in visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:92:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n:in `stack''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:33:in `eval''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:33:in `stack''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:737:in `eval_Program''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:48:in `block in visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:92:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:125:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:136:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:592:in `evaluate_main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:166:in `block (2 levels) in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:166:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:260:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:155:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:35:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:301:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:232:in `block in benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.4.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:231:in `benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:299:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:54:in `block in find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/node/environment.rb:450:in `with_text_domain''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:53:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:198:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:262:in `block in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:260:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:233:in `main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:174:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:375:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:667:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:375:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:136:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:73:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9693', 'https://github.com/puppetlabs/puppet/pull/7517', '2019-05-06T18:15:29.000-0700', '2019-06-17T16:10:47.000-0700', '2019-06-17T16:10:47.000-0700', 'Resolved', 'resolved-issue-added', 3, '0', 2, 14, 0, 2, '2bf3a14b02b1c97ded33732b20d588d54d4fa618'),
('puppet', 262704, 197815306, 6894, 'FastGettext.default_text_domain order dependent test failure', 'When running _bundle exec rake parallel:spec[12]_ from the puppet master branch on a Fedora Linux (I''ve tested 27 and 28) the following statement:\r\n{code:ruby}\r\nFastGettext.translation_repositories[FastGettext.default_text_domain]\r\n{code}\r\nreturns {{nil}} which results in the message "undefined method `chain'' for nil:NilClass" in file _lib/puppet/gettext/config.rb_ on line 179. This in turn, causes +40 spec test failures.\r\n\r\nSample stack trace from one of the failed tests:\r\n{code}\r\n  1) Puppet::Resource::Catalog::Compiler when initializing should cache the server metadata and reuse it\r\n     Failure/Error: puppet_translations = FastGettext.translation_repositories[FastGettext.default_text_domain].chain\r\n     NoMethodError:\r\n       undefined method `chain'' for nil:NilClass\r\n     # ./lib/puppet/gettext/config.rb:179:in `copy_default_translations''\r\n     # ./lib/puppet/gettext/config.rb:73:in `reset_text_domain''\r\n     # ./lib/puppet/node/environment.rb:426:in `with_text_domain''\r\n     # ./lib/puppet/indirector/catalog/compiler.rb:53:in `find''\r\n     # ./spec/unit/indirector/catalog/compiler_spec.rb:35:in `block (3 levels) in <top (required)>''\r\n     # util/rspec_runner:44:in `run''\r\n     # util/rspec_runner:59:in `<main>''\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8959', 'https://github.com/puppetlabs/puppet/pull/6894', '2018-06-26T02:01:20.000-0700', '2019-06-19T10:16:32.000-0700', '2019-06-19T10:16:32.000-0700', 'Closed', '', 8, '0', 1, 1, 1, 1, 'b0d486bbc11e540883d00cf0c8488bc54ee3baa6'),
('puppet', 313352, 290322996, 7588, 'Constants assigned twice emit warning during Litmus use on Windows.', 'When running acceptance tests via Litmus, the Puppet::Util::Windows::APITypes::FFI module from lib/puppet/util/windows/api_types.rb is loaded via the puppet gem.\r\n\r\nUnfortunately this module always gets loaded twice and a warning is returned to the commandline:\r\n\r\n\r\n{noformat}\r\nC:/src/puppetlabs-java_ks/.bundle/gems/ruby/2.5.0/gems/puppet-6.4.2-x64-mingw32/lib/puppet/util/windows/api_types.rb:6: warning: already initialized constant FFI::WIN32_FALSE\r\nC:/src/puppetlabs-java_ks/.bundle/gems/ruby/2.5.0/gems/pdk-1.10.0/lib/pdk/util/windows/api_types.rb:6: warning: previous definition of WIN32_FALSE was here\r\nC:/src/puppetlabs-java_ks/.bundle/gems/ruby/2.5.0/gems/puppet-6.4.2-x64-mingw32/lib/puppet/util/windows/api_types.rb:9: warning: already initialized constant FFI::ERROR_SUCCESS\r\nC:/src/puppetlabs-java_ks/.bundle/gems/ruby/2.5.0/gems/pdk-1.10.0/lib/pdk/util/windows/api_types.rb:9: warning: previous definition of ERROR_SUCCESS was here\r\n{noformat}\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9789', 'https://github.com/puppetlabs/puppet/pull/7588', '2019-06-20T11:07:37.000-0700', '2019-06-25T15:14:06.000-0700', '2019-06-25T15:14:06.000-0700', 'Closed', 'litmus;windows', 6, '0', 1, 2, 2, 1, ''),
('puppet', 309697, 287176359, 7560, 'Puppet 6 client exits on start when it cannot connect to puppetserver ', '*Puppet Version: 6.4.2*\r\n *Puppet Server Version: 6.3.0*\r\n *OS Name/Version: CentOS 7.6*\r\n\r\nIn previous versions of puppet, I would spin up instances in AWS, regardless of the puppetservere being available, and have runinterval at 20 seconds. Whenever the base packages were installed, I''d update the puppet configuration to a runinterval of every 30 minutes.\r\n\r\nSince I''ve started version 6 clients, this "trick" no longer works. The puppet client will try to connect to the puppetserver when it starts, and if it doesn''t it will exit. That''s quite disastrous for my deployment strategy.\r\n\r\nSteps to reproduce:\r\n\r\nPre-requisites: Have the above puppet server and client versions on a single machine. Have puppetserver and client stopped.\r\n\r\n1. Start puppet client.\r\n\r\n*Desired Behavior:*\r\n\r\nA. puppet client starts, regardless of a connection is possible with the puppetserver. It will re-try each runinterval.\r\n\r\n*Actual Behavior:*\r\n - puppet client exits with below message in /var/log/messages:\r\n{noformat}May 22 15:08:05 bas-t-1 systemd: Started Puppet agent.\r\nMay 22 15:08:07 bas-t-1 puppet-agent[12580]: Could not run: Failed to open TCP connection to bas-t-1.t.dam.loc:8140 (Connection refused - connect(2) for "bas-t-1.t.dam.loc" port 8140)\r\nMay 22 15:08:07 bas-t-1 systemd: puppet.service: main process exited, code=exited, status=1/FAILURE\r\nMay 22 15:08:07 bas-t-1 systemd: Unit puppet.service entered failed state.\r\nMay 22 15:08:07 bas-t-1 systemd: puppet.service failed.{noformat}\r\npuppet.conf:\r\n{noformat}[main]\r\nserver = bas-t-1.t.dam.loc\r\nenvironment = production\r\nruninterval = 20s\r\nhiera_config = /etc/puppetlabs/puppet/hiera.yaml\r\n[master]\r\ndns_alt_names = bas-t-1.t.dam.loc{noformat}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9717', 'https://github.com/puppetlabs/puppet/pull/7560', '2019-05-22T08:28:52.000-0700', '2019-07-02T09:25:14.000-0700', '2019-07-02T09:25:14.000-0700', 'Closed', 'resolved-issue-added', 3, '0', 12, 306, 112, 3, '81c6de706b4735f83d0b79c3924a4f3bec0b9f08'),
('puppet', 311950, 287721421, 7566, 'Puppet ssl submit_request does not translate custom oids correctly', 'When defining an extension request in csr_attributes.yaml, like so:\r\n{code}\r\n---\r\nextension_requests:\r\n  pp_role: pe_compiler \r\n{code}\r\nRunning `puppet ssl submit_request` results in the following error:\r\n{code}\r\nError: Could not run: Failed to submit certificate request: Cannot create CSR with extension request pp_role: OBJ_txt2obj: first num too large\r\nWrapped exception:\r\nCannot create CSR with extension request pp_role: OBJ_txt2obj: first num too large\r\n{code}\r\nHowever, doing a puppet agent run to generate the CSR works fine.\r\n\r\nPer [~josh], the SSL application may be registering the oids like the puppet agent code path does, and the call to `Puppet::SSL::Oids.register_puppet_oids` should be moved to the SSL provider, instead of each application having to do it.  Also, Puppet''s `certificate_extensions.rb` beaker test only runs `puppet agent` and should be expanded to include at least `puppet ssl`.', 'https://tickets.puppetlabs.com/browse/PUP-9746', 'https://github.com/puppetlabs/puppet/pull/7566', '2019-06-10T16:10:02.000-0700', '2019-07-02T09:25:15.000-0700', '2019-07-02T09:25:15.000-0700', 'Closed', 'resolved-issue-added', 7, '0', 1, 7, 0, 2, 'f786578206963c03d90cb949a2ddcd518cb13e0b'),
('puppet', 126290, 214049645, 7059, 'it should not be possible to disable manifest ordering', 'Manifest ordering have as far as I can tell been proven to work, problem is with it being configurable it''s not something one can really rely on in public code as you just have no way to know if your users have it on or not.\r\n\r\nWhen next allowed by semver I''d propose it be turned on and remain on without the option to configure.', 'https://tickets.puppetlabs.com/browse/PUP-6165', 'https://github.com/puppetlabs/puppet/pull/7059', '2016-04-12T11:48:05.000-0700', '2019-07-02T10:20:19.000-0700', '2019-07-02T10:20:19.000-0700', 'Closed', '', 11, '0', 1, 10, 155, 9, 'ee646fc6b5263383c772f6f2c492d394910b2b74'),
('puppet', 90662, 278548014, 7522, 'Provide helpful error message when provider does not have instances defined', 'When using the RAL to get a list of resources, if the provider does not have the {{instances}} method defined you get:\r\n\r\n{code}\r\nError: Could not run: Provider getsetsebool has not defined the ''instances'' class method\r\n{code}\r\n\r\nRegurgitating an implementation detail is incredibly unhelpful except for those few that actually know how types and providers work.\r\n\r\nI''d like to suggest we add a default {{instances}} method on providers that gives us a more helpful error message which every provider must then override (which they''ll do anyway if they want to provide this feature, if not they get a user friendly error message for free).', 'https://tickets.puppetlabs.com/browse/PUP-4930', 'https://github.com/puppetlabs/puppet/pull/7522', '2015-07-27T10:09:07.000-0700', '2019-07-03T01:38:14.000-0700', '2019-07-03T01:38:14.000-0700', 'Closed', 'resolved-issue-added', 5, '0', 1, 1, 2, 1, '3f028d49e757da95660fbd2dfa72096f84e007ec'),
('puppet', 246189, 182331455, 6792, 'rpm package provider is too specific', '*Puppet Version: 5.3.5 (and older)*\r\n *Puppet Server Version: N/A*\r\n *OS Name/Version: Centos/Redhat*\r\n\r\nThe uninstall method in the rpm package provider is more specific than the package resource it is uninstalling, and uses a cache that can become out of date by the time it executes.\r\n\r\n*Desired Behavior:*\r\n\r\nUnconditionally uninstall a package when conditions are not specified.\r\n\r\n*Actual Behavior:*\r\n\r\nExample:\r\n{code:java}\r\n  package { ''cronie-anacron'':\r\n    ensure  => absent,\r\n    require => Package[''cronie-noanacron'']\r\n  }\r\n\r\n  package { ''cronie-noanacron'':\r\n    ensure => installed,\r\n  }\r\n{code}\r\n \r\n{code:java}\r\nyum[3546]: Updated: cronie-anacron-1.4.11-19.el7.x86_64 \r\nyum[3546]: Updated: cronie-1.4.11-19.el7.x86_64 \r\nyum[3546]: Installed: cronie-noanacron-1.4.11-19.el7.x86_64\r\n\r\npuppet-agent[1371]: (/Stage[main]/Package[cronie-noanacron]/ensure) created \r\npuppet-agent[1371]: Execution of ''/usr/bin/rpm -e cronie-anacron-1.4.11-17.el7.x86_64'' returned 1: error: package cronie-anacron-1.4.11-17.el7.x86_64 is not installed \r\npuppet-agent[1371]: (/Stage[main]/Package[cronie-anacron]/ensure) change from ''1.4.11-17.el7'' to ''absent'' failed: Execution of ''/usr/bin/rpm -e cronie-anacron-1.4.11-17.el7.x86_64'' returned 1: error: package cronie-anacron-1.4.11-17.el7.x86_64 is not installed\r\n{code}\r\n\r\n To reset the test environment after that puppet run, download cronie-1.4.11-14.el7.x86_64.rpm and cronie-anacron-1.4.11-14.el7.x86_64.rpm and run:\r\n\r\n{code:java}\r\nrpm -e cronie cronie-noanacron crontabs ; yum install -y cronie-* ; rpm -qa | grep cron ; puppet agent -t ; rpm -qa | grep cron\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8664', 'https://github.com/puppetlabs/puppet/pull/6792', '2018-04-17T16:19:37.000-0700', '2019-07-03T01:41:38.000-0700', '2019-07-03T01:41:38.000-0700', 'Resolved', 'cs_pr_review;resolved-issue-added', 2, '0', 1, 143, 43, 2, '80d14267c596c32a3bd2d72379a781028368c673'),
('puppet', 262030, 270497692, 7483, 'puppet device permissions preventing reading dirs', 'With umask=027, puppet device sets permissions in a way preventing pe-puppet user from reading some directories \r\n(https://docs.google.com/document/d/1C_opr4OdiovFO1qScz7qH3Qu4RECbpMkobAQNJrT85k/edit#heading=h.glx17pt2xr21)', 'https://tickets.puppetlabs.com/browse/PUP-9642', 'https://github.com/puppetlabs/puppet/pull/7483', '2018-06-21T05:56:50.000-0700', '2019-07-03T01:45:57.000-0700', '2019-07-03T01:45:57.000-0700', 'Closed', 'dtt;resolved-issue-added', 22, '0', 3, 90, 10, 2, '843a1b6d70eddce888655404242c9a9eda7e9072'),
('puppet', 308724, 279682659, 7527, 'Removing user on Solaris 11 with altered managehome', '*Puppet Version: 6.4.2*\r\n *Puppet Server Version: N/A*\r\n *OS Name/Version: Solaris 11*\r\n\r\n*Desired Behavior: Able to remove a user without any errors*\r\n\r\n*Actual Behavior:*\r\n\r\nWhen applying the following an error occurs:\r\n{code:java}root@yz4rr58lsjdxqz3:~# puppet apply -e ''user { "testuser": ensure => "present", managehome => false }''\r\nNotice: /File[/etc/puppetlabs/code/environments/production]/ensure: created\r\nNotice: Compiled catalog for yz4rr58lsjdxqz3.delivery.puppetlabs.net in environment production in 0.03 seconds\r\nNotice: /Stage[main]/Main/User[testuser]/ensure: created\r\nNotice: Applied catalog in 0.06 seconds\r\nroot@yz4rr58lsjdxqz3:~# puppet apply -e ''user { "testuser": ensure => "absent",  managehome => true  }''\r\nNotice: Compiled catalog for yz4rr58lsjdxqz3.delivery.puppetlabs.net in environment production in 0.03 seconds\r\nError: Could not delete user testuser: Execution of ''/usr/sbin/userdel -r testuser'' returned 12: UX: /usr/sbin/userdel: ERROR: Unable to remove home directory. No such file or directory\r\nError: /Stage[main]/Main/User[testuser]/ensure: change from ''present'' to ''absent'' failed: Could not delete user testuser: Execution of ''/usr/sbin/userdel -r testuser'' returned 12: UX: /usr/sbin/userdel: ERROR: Unable to remove home directory. No such file or directory\r\nNotice: Applied catalog in 0.12 seconds// code placeholder\r\n{code}\r\nWe are seeing this issue in puppetlabs-accounts in [https://github.com/puppetlabs/puppetlabs-accounts/pulls/222] when running adhoc against Solaris 11.', 'https://tickets.puppetlabs.com/browse/PUP-9706', 'https://github.com/puppetlabs/puppet/pull/7527', '2019-05-15T07:54:40.000-0700', '2019-07-03T01:48:01.000-0700', '2019-07-03T01:48:01.000-0700', 'Closed', 'resolved-issue-added', 2, '0', 3, 41, 13, 2, '4229af8387ffd3dd179ed145343196bbd5374721'),
('puppet', 313529, 291330342, 7593, 'undefined method `pip_version'' with pip3 provider', '*Puppet Version: 6.5.0*\r\n *Puppet Server Version: 6.4.0*\r\n *OS Name/Version: Debian stretch*\r\n\r\nAfter updating puppet-agent to 6.5.0 and the puppet server to 6.4.0 package resources with a pip3 provider throw the following error:\r\n{noformat}Debug: Prefetching pip3 resources for packageDebug: Executing ''/usr/bin/pip3 --version''\r\nDebug: Executing ''/usr/bin/pip3 freeze --all''Debug: Puppet::Type::Package::ProviderPip3: Prefetched instance: %{name} via command: %{command}\r\nDebug: Puppet::Type::Package::ProviderPip3: Prefetched instance: %{name} via command: %{command}\r\nError: Could not get latest version: undefined method `pip_version'' for Package[checkdmarc](provider=pip3)(command=default):Puppet::Type::Package::ProviderPip3\r\nInfo: Unknown failure using insync_values? on type: Package[checkdmarc] / property: ensure to compare values [:latest] and 4.1.10 Error: /Stage[main]/Main/Node[redacted]/Mail::Dmarc_report[redacted]/Package[checkdmarc]/ensure: change from ''4.1.10'' to ''latest'' failed: Could not get latest version: undefined method `pip_version'' for Package[checkdmarc](provider=pip3)(command=default):Puppet::Type::Package::ProviderPip3{noformat}\r\nThe code from the module is just:\r\n{noformat}package { ''checkdmarc'':\r\n ensure => ''latest''\r\n , provider => ''pip3''\r\n , require => Package[''python3-pip'']\r\n }{noformat}\r\n \r\n{noformat}$ /usr/bin/pip3 --version\r\npip 9.0.1 from /usr/lib/python3/dist-packages (python 3.5)\r\n{noformat}\r\n \r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9790', 'https://github.com/puppetlabs/puppet/pull/7593', '2019-06-21T01:36:31.000-0700', '2019-07-03T01:48:58.000-0700', '2019-07-03T01:48:58.000-0700', 'Closed', 'regression;resolved-issue-added;type_and_provider', 10, '0', 1, 3, 3, 2, 'ad356f3424b8b64250cf26fe0df0aec114b0672b'),
('puppet', 62743, 162757655, 6525, 'pacman provider''s yaourt support now totally broken', 'As of pacman 4.2, the pacman provider''s yaourt support is totally broken by an upstream change.\r\n\r\nhttps://projects.archlinux.org/pacman.git/commit/?id=61ba5c961e4a3536c4bbf41edb348987a9993fdb removed the {{--asroot}} option from {{makepkg}}, so {{yaourt}} can no longer build packages as root.\r\n\r\nSpeaking with some people in the Arch community, it seems like a bad idea and big security hole that it ever could.\r\n\r\nI''ll be researching alternatives, but it seems like the best thing would probably be to just deprecate the yaourt support.', 'https://tickets.puppetlabs.com/browse/PUP-3802', 'https://github.com/puppetlabs/puppet/pull/6525', '2014-12-31T19:03:55.000-0800', '2019-07-11T00:43:47.000-0700', '2019-07-11T00:43:47.000-0700', 'Resolved', 'arch;help_wanted;package;pacman;type_and_provider;yaourt', 4, '0', 5, 19, 5, 3, ''),
('puppet', 301168, 266338539, 7450, 'Serial execution with puppet device and ciscopuppet fails', 'When executing puppet device with multiple instances of ciscopuppet  nodes beyond the first fail to execute:\r\n\r\n\r\n{noformat}\r\n[root@h0wm6jin2afatag ~]# puppet device -v --trace\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: starting applying configuration to nexus1 at file:///etc/puppetlabs/puppet/devices/nexus1.conf\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\n/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/gems/cisco_node_utils-2.0.0/lib/cisco_node_utils/node.rb:154: warning: constant ::Fixnum is deprecated\r\nInfo: Caching catalog for nexus1\r\nInfo: Applying configuration version ''1553200309''\r\nNotice: Applied catalog in 0.12 seconds\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: starting applying configuration to nexus2 at file:///etc/puppetlabs/puppet/devices/nexus2.conf\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: Error 403 on SERVER: Forbidden request: /puppet/v3/node/nexus2 (method :get). Please see the server logs for details.\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\n/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/gems/cisco_node_utils-2.0.0/lib/cisco_node_utils/node.rb:154: warning: constant ::Fixnum is deprecated\r\nError: Could not retrieve catalog from remote server: Error 403 on SERVER: Forbidden request: /puppet/v3/catalog/nexus2 (method :post). Please see the server logs for details.\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:241:in `is_http_200?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:120:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:464:in `block in retrieve_new_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:518:in `block in thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:517:in `thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:463:in `retrieve_new_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:75:in `retrieve_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:167:in `prepare_and_retrieve_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:341:in `run_internal''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:239:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:252:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:217:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:327:in `block (2 levels) in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:256:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:256:in `collect''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:256:in `block in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:252:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:241:in `main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:390:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:671:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:135:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:73:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\nError: Could not retrieve catalog; skipping run\r\nError: Could not send report: Error 403 on SERVER: Forbidden request: /puppet/v3/report/nexus2 (method :put). Please see the server logs for details.\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:241:in `is_http_200?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:190:in `save''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:285:in `save''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:416:in `send_report''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:388:in `run_internal''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:239:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:252:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:217:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:327:in `block (2 levels) in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:256:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:256:in `collect''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:256:in `block in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:252:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/device.rb:241:in `main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:390:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:671:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:135:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:73:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n\r\n{noformat}\r\n\r\n\r\nServer Log \r\n{noformat}\r\n2019-03-21T20:31:49.135Z INFO  [qtp2129953650-177] [puppetserver] Puppet ''replace_facts'' command for nexus1 submitted to PuppetDB with UUID 15cc8e0d-5e6c-4ee8-9c6f-2e1c0129763e\r\n2019-03-21T20:31:49.301Z WARN  [qtp2129953650-177] [puppetserver] Puppet Host is missing hostname and/or domain: nexus1\r\n2019-03-21T20:31:49.305Z INFO  [qtp2129953650-177] [puppetserver] Puppet Compiled catalog for nexus1 in environment production in 0.07 seconds\r\n2019-03-21T20:31:49.305Z INFO  [qtp2129953650-177] [puppetserver] Puppet Caching catalog for nexus1\r\n2019-03-21T20:31:49.342Z INFO  [qtp2129953650-177] [puppetserver] Puppet ''replace_catalog'' command for nexus1 submitted to PuppetDB with UUID a0568882-d669-440d-b4ec-16379250973b\r\n2019-03-21T20:31:49.588Z INFO  [qtp2129953650-181] [puppetserver] Puppet ''store_report'' command for nexus1 submitted to PuppetDB with UUID 06465d95-6019-4f82-8f76-1ea37d7d04b8\r\n2019-03-21T20:31:51.111Z ERROR [qtp2129953650-176] [p.t.a.rules] Forbidden request: nexus1(10.16.114.187) access to /puppet/v3/node/nexus2 (method :get) (authenticated: true) denied by rule ''puppetlabs node''.\r\n2019-03-21T20:31:55.961Z ERROR [qtp2129953650-176] [p.t.a.rules] Forbidden request: nexus1(10.16.114.187) access to /puppet/v3/catalog/nexus2 (method :post) (authenticated: true) denied by rule ''puppetlabs catalog''.\r\n2019-03-21T20:31:55.996Z ERROR [qtp2129953650-181] [p.t.a.rules] Forbidden request: nexus1(10.16.114.187) access to /puppet/v3/report/nexus2 (method :put) (authenticated: true) denied by rule ''puppetlabs report''\r\n{noformat}\r\n\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9587', 'https://github.com/puppetlabs/puppet/pull/7450', '2019-03-21T13:57:37.000-0700', '2019-07-12T01:44:22.000-0700', '2019-07-12T01:44:22.000-0700', 'Closed', 'resolved-issue-added', 21, '0', 6, 400, 365, 2, '17094bbf78e91b2f8b152bce7fe75bdc75db03c3'),
('puppet', 305706, 272115451, 7491, 'Backport certname mismatch to 5.5.x and 6.0.x (PUP-8213)', 'When running with ruby 2.4 or 2.5, ruby will raise a certname mismatch error before we have a chance to handle it, and print a meaningful message.\r\n\r\nThis is a backport of the changes made in 6.4.x in PUP-8213', 'https://tickets.puppetlabs.com/browse/PUP-9649', 'https://github.com/puppetlabs/puppet/pull/7491', '2019-04-19T16:13:41.000-0700', '2019-07-12T01:45:00.000-0700', '2019-07-12T01:45:00.000-0700', 'Resolved', '', 2, '0', 11, 322, 356, 10, 'ca0d5ca429222b09b733460866939643da738fff'),
('puppet', 315708, 292994892, 7599, 'PAL fixes to support AST compilation', 'In the process of writing the Ruby code for the new AST compilation endpoint, we discovered several bugs and API gaps in PAL. This ticket tracks those fixes.', 'https://tickets.puppetlabs.com/browse/PUP-9818', 'https://github.com/puppetlabs/puppet/pull/7599', '2019-07-09T11:44:49.000-0700', '2019-07-12T09:07:37.000-0700', '2019-07-12T09:07:37.000-0700', 'Resolved', '', 1, '0', 4, 31, 5, 4, 'bf6614edde3a79a5997a86a47d0741c9878350be'),
('puppet', 106593, 217076813, 7107, 'Error when purging local users on Windows', 'This a significant user.\r\n\r\nFROM THE USER:\r\n\r\nWe want to control the local users with Puppet and purge any unmanaged user for audit compliance and security purposes. When I configure this in the below manifest I get the following error: \r\nError: /Stage[main]/Main/Resources[user]: Failed to generate additional resources using ''generate'': comparison of String with 499 failed \r\nCan this please be fixed.\r\n\r\nuser { [''Administrator'', ''guest'']: \r\nensure => present \r\n}\r\n\r\nresources { ''user'': \r\npurge => true \r\n}\r\n\r\n\r\nAs a generic rule of thumb you can expect us to use Puppet and all classes on every Windows edition available from 2003 and up, although 2008 and up is really the current scope, don''t care too much about 2003. I just tested and this doesn''t work on Windows 2012R2 either. I''ve never tested it before, we''re in the process of putting this compliancy rule in Puppet so this is the first time I run into this. It looks like a bug to me, tt work fine (as expected) for for example the group resource or host resource and even type/providers we created ourselves.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6716', 'https://github.com/puppetlabs/puppet/pull/7107', '2015-11-20T09:29:02.000-0800', '2019-07-15T16:43:02.000-0700', '2019-07-15T16:43:02.000-0700', 'Resolved', 'customer;manage-user-group;type_and_provider;user;windows;windows-parity', 7, '0', 2, 110, 2, 5, 'faf95ff55aa6cbb747fb6906dd95f0f195ab45bd'),
('puppet', 104507, 217354295, 7110, 'Windows Service provider should use something better than net.exe - perhaps direct FFI access', 'From http://stackoverflow.com/q/33531461/18475, {{net.exe}} can timeout while waiting for a process that is in a start pending state. The Windows provider for service in Puppet uses {{net.exe}}, which returns a non-zero exit code when it times out waiting for the service, even if the service does eventually start up. \r\n\r\nIt is believed (needs research) that [Service Controller ({{sc.exe}})|https://technet.microsoft.com/en-us/library/bb490995.aspx] doesn''t suffer from this issue.\r\n\r\nInvestigate using it instead. As a benefit, it can also [create and destroy services|http://ss64.com/nt/sc.html].', 'https://tickets.puppetlabs.com/browse/PUP-5475', 'https://github.com/puppetlabs/puppet/pull/7110', '2015-11-05T08:28:52.000-0800', '2019-07-15T16:45:39.000-0700', '2019-07-15T16:45:39.000-0700', 'Closed', 'maintenance;service;tech-debt;type_and_provider;windows', 8, '0', 1, 168, 69, 2, 'c1596a95266c61ae4d06ffdbafc9c4f67b4b685a'),
('puppet', 161236, 219853857, 7136, 'Windows package provider should set working directory (cwd)', 'Some installations may require files other than the installer to install properly.  The assumption of these installation packages may be that the path to these files is the current working directory.\r\n\r\nHowever, the Windows package provider currently does not set a working directory - and hence cannot currently support certain types of installations.\r\n\r\nPUP-6919 tracks the work to support {{cwd}} with the underlying {{Puppet::Util::Execution.execute}} mechanism.  This ticket is to track setting the {{cwd}} automatically to the same location as the installer source.', 'https://tickets.puppetlabs.com/browse/PUP-6920', 'https://github.com/puppetlabs/puppet/pull/7136', '2016-11-15T22:54:48.000-0800', '2019-07-15T16:47:26.000-0700', '2019-07-15T16:47:26.000-0700', 'Closed', 'package;type_and_provider;windows', 3, '0', 1, 211, 5, 9, '49fb0d4aecd31fad153be19b588409263e505e04'),
('puppet', 46494, 207597205, 6987, 'User resource on AIX returns a non-working structure or ''attributes''', 'The `user` resource on AIX returns back non-working Puppet code for the ''attributes'' key.\r\n\r\nExample:\r\n{code:title=puppet resource user root|borderStyle=solid}# puppet resource user root | tee /tmp/root.pp\r\n\r\nuser { ''root'':\r\n  ensure           => ''present'',\r\n  attributes       => {''account_locked'' => ''false'', ''admin'' => ''true'', ''auditclasses'' => ''general'', ''auth1'' => ''SYSTEM'', ''auth2'' => ''NONE'', ''core'' => ''-1'', ''cpu'' => ''-1'', ''daemon'' => ''true'', ''data'' => ''-1'', ''fsize'' => ''-1'', ''histexpire'' => ''0'', ''histsize'' => ''0'', ''host_last_login'' => ''removed.example.com'', ''host_last_unsuccessful_login'' => ''removed.example.com'', ''login'' => ''true'', ''loginretries'' => ''0'', ''maxexpired'' => ''-1'', ''maxrepeats'' => ''8'', ''minalpha'' => ''0'', ''mindiff'' => ''0'', ''mindigit'' => ''0'', ''minlen'' => ''0'', ''minloweralpha'' => ''0'', ''minother'' => ''0'', ''minspecialchar'' => ''0'', ''minupperalpha'' => ''0'', ''name'' => ''root'', ''nofiles'' => ''2000'', ''pwdwarntime'' => ''0'', ''registry'' => ''files'', ''rlogin'' => ''true'', ''rss'' => ''-1'', ''stack'' => ''-1'', ''su'' => ''true'', ''sugroups'' => ''ALL'', ''system'' => ''compat'', ''time_last_login'' => ''1407248916'', ''time_last_unsuccessful_login'' => ''1407184651'', ''tpath'' => ''nosak'', ''tty_last_login'' => ''/dev/pts/1'', ''tty_last_unsuccessful_login'' => ''ssh'', ''ttys'' => ''ALL'', ''umask'' => ''22'', ''unsuccessful_login_count'' => ''0''},\r\n  comment          => ''root'',\r\n  expiry           => ''2032-12-31'',\r\n  gid              => ''0'',\r\n  groups           => [''system'', ''bin'', ''sys'', ''security'', ''cron'', ''audit'', ''lp''],\r\n  home             => ''/'',\r\n  password         => ''WuthH/s1ny/5s'',\r\n  password_max_age => ''0'',\r\n  password_min_age => ''0'',\r\n  shell            => ''/bin/ksh'',\r\n  uid              => ''0'',\r\n}\r\n{code}\r\nAnd then running the same code through puppet apply:\r\n{code:title=puppet apply root.pp|borderStyle=solid}# puppet apply /tmp/root.pp\r\nNotice: Compiled catalog for myhost.example.com in environment production in 0.28 seconds\r\nError: Parameter attributes failed on User[root]: Attributes value pairs must be separated by an = at /tmp/root.pp:14\r\nWrapped exception:\r\nAttributes value pairs must be separated by an =\r\n\r\n{code}\r\nThe issue seems to stem from the attributes field. `puppet resource` outputs a key/value object for attributes, while puppet apply seems to expect an array with key=value parts in it as a string.\r\n\r\nChanging it to an array of key=value pairs results in a still broken setup. Puppet resource outputs several key/value pairs that are NOT items that can be changed via the chuser command it runs under the covers. It should not return the ''name'' or the ''system'' keys.\r\n\r\nThis was my working root.pp file:\r\n{code:title=root.pp}user { ''root'':\r\n  ensure           => ''present'',\r\n  attributes => [''account_locked=false'', ''admin=true'', ''auditclasses=general'', ''auth1=SYSTEM'', ''auth2=NONE'', ''core=-1'', ''cpu=-1'', ''daemon=true'', ''data=-1'', ''fsize=-1'', ''histexpire=0'', ''histsize=0'', ''host_last_login=removed.example.com'', ''host_last_unsuccessful_login=removed.example.com'', ''login=true'', ''loginretries=0'', ''maxexpired=-1'', ''maxrepeats=8'', ''minalpha=0'', ''mindiff=0'', ''mindigit=0'', ''minlen=0'', ''minloweralpha=0'', ''minother=0'', ''minspecialchar=0'', ''minupperalpha=0'', ''nofiles=2000'', ''pwdwarntime=0'', ''registry=files'', ''rlogin=true'', ''rss=-1'', ''stack=-1'', ''su=true'', ''sugroups=adm'', ''time_last_login=1407248916'', ''time_last_unsuccessful_login=1407184651'', ''tpath=nosak'', ''tty_last_login=/dev/pts/1'', ''tty_last_unsuccessful_login=ssh'', ''ttys=ALL'', ''umask=22'', ''unsuccessful_login_count=0''],\r\n  comment          => ''root'',\r\n  expiry           => ''2032-12-31'',\r\n  gid              => ''0'',\r\n  groups           => [''system'', ''bin'', ''sys'', ''security'', ''cron'', ''audit'', ''lp''],\r\n  home             => ''/'',\r\n  password         => ''fakepass'',\r\n  password_max_age => ''0'',\r\n  password_min_age => ''0'',\r\n  shell            => ''/bin/ksh'',\r\n  uid              => ''0'',\r\n}\r\n{code}\r\nPS:', 'https://tickets.puppetlabs.com/browse/PUP-3021', 'https://github.com/puppetlabs/puppet/pull/6987', '2014-08-05T07:32:33.000-0700', '2019-07-16T05:47:19.000-0700', '2019-07-16T05:47:19.000-0700', 'Resolved', 'aix;aix-parity;cli;help_wanted;maintenance;puppethack;type_and_provider;user', 5, '0', 5, 2107, 1006, 18, 'dac0a1a1f57406b5e4a1eca558abece7640a0a82'),
('puppet', 318074, 301177500, 7638, '"Failed to apply catalog: undefined method `each'' for #<Puppet::Type::Cisco_tacacs_server:0x0000000206c7f8>"', '*Puppet Version:* 6.7.0\r\n*Puppet Server Version:* n/a\r\n*OS Name/Version:* n/a\r\n\r\nThe ciscopuppet acceptance tests fail on trivial catalogs with "Error: Failed to apply catalog: undefined method `each'' for #<Puppet::Type::Cisco_tacacs_server:0x0000000206c7f8>", due to https://github.com/puppetlabs/puppet/commit/6c257fc7827989c2af2901f974666f0f23611153#diff-7f00f7dbc0f9bfecbaadfec966d0b8b1L2149 . Specifically, the change from {{[list]}} to {{Array(list)}} in the chunk linked.\r\n\r\nObserve the following pry example to show the issue:\r\n\r\n{code}\r\n[10] pry(main)> class Foo\r\n[10] pry(main)*   include Enumerable\r\n[10] pry(main)* end  \r\n=> Foo\r\n[11] pry(main)> Foo.new.to_a\r\nNoMethodError: undefined method `each'' for #<Foo:0x000055b8c11be7c8>\r\nfrom (pry):13:in `to_a''\r\n[12] pry(main)> Array(Foo.new)\r\nNoMethodError: undefined method `each'' for #<Foo:0x000055b8c1188308>\r\nfrom (pry):14:in `to_a''\r\n[13] pry(main)> [Foo.new]\r\n=> [#<Foo:0x000055b8c110dcc0>]\r\n[14] pry(main)> class Foo2\r\n[14] pry(main)* end  \r\n=> nil\r\n[15] pry(main)> Array(Foo2.new)\r\n=> [#<Foo2:0x000055b8c1065598>]\r\n[16] pry(main)> \r\n{code}\r\n\r\nThis can be traced back to https://github.com/puppetlabs/puppet/blob/0c34993f87f100f3bbbccfbb5b000a51094fce5e/lib/puppet/type.rb#L2276 without having a `each` method. This bug was introduced in 2005 (see my previous unrelated analysis of this in https://twitter.com/dev_el_ops/status/1141814653653311489?s=19).\r\n\r\n*Desired Behavior:*\r\n\r\nPuppet not failing on a ruby error.\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet failing on a ruby error.\r\n\r\nFull stacktrace from https://jenkins-master-prod-1.delivery.puppetlabs.net/view/modules/view/networking/view/ciscopuppet/job/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/lastFailedBuild/PLATFORM=cisconx-64default.%257Bssh%253D%257Buser%253Dadmin%252Cpassword%253Dadmin%257D%257D,WORKER_LABEL=beaker/consoleFull :\r\n\r\n{code}\r\n00:06:07.170   * TestStep :: 1.1 Apply default manifest with ''default'' as a string in attributes [ensure => present] :: MANIFEST    \r\n00:06:07.170     test_manifest :: manifest:\r\n00:06:07.171     0\r\n00:06:07.171     test_manifest :: check puppet apply cmd (code: [0, 2])\r\n00:06:07.171     \r\n00:06:16.260             cisco_tacacs_server      { ''default'': ensure => present }\r\n00:06:16.260           \r\n00:06:16.260                                        cisco_aaa_authorization_login_cfg_svc { ''default'':\r\n00:06:16.260                                    \r\n00:06:16.260         ensure                                   => ''present'',\r\n00:06:16.260         groups                                   => ''default'',\r\n00:06:16.260         method                                   => ''default'',\r\n00:06:16.260     \r\n00:06:16.260                                  }\r\n00:06:16.260     Notice: Compiled catalog for sut in environment production in 0.12 seconds\r\n00:06:16.271     Info: Applying configuration version ''1564016874''\r\n00:06:16.271     Error: Failed to apply catalog: undefined method `each'' for #<Puppet::Type::Cisco_tacacs_server:0x0000000206c7f8>\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2190:in `to_a''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2190:in `Array''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2190:in `block in autorelation''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2127:in `block in eachautorequire''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2126:in `each''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2126:in `eachautorequire''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2183:in `autorelation''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/type.rb:2215:in `autorequire''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/graph/relationship_graph.rb:173:in `block (2 levels) in build_autorelation_dependencies''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/graph/relationship_graph.rb:172:in `each''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/graph/relationship_graph.rb:172:in `block in build_autorelation_dependencies''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/graph/relationship_graph.rb:171:in `each''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/graph/relationship_graph.rb:171:in `build_autorelation_dependencies''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/graph/relationship_graph.rb:25:in `populate_from''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/resource/catalog.rb:266:in `relationship_graph''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/transaction.rb:222:in `relationship_graph''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/transaction.rb:172:in `evaluate''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/resource/catalog.rb:240:in `block (2 levels) in apply''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:521:in `block in thinmark''\r\n00:06:16.271     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308:in `realtime''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:520:in `thinmark''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/resource/catalog.rb:239:in `block in apply''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util/log.rb:161:in `with_destination''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/transaction/report.rb:146:in `as_logging_destination''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/resource/catalog.rb:238:in `apply''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/configurer.rb:194:in `block (2 levels) in apply_catalog''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:521:in `block in thinmark''\r\n00:06:16.271     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308:in `realtime''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:520:in `thinmark''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/configurer.rb:193:in `block in apply_catalog''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:233:in `block in benchmark''\r\n00:06:16.271     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308:in `realtime''\r\n00:06:16.271     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:232:in `benchmark''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/configurer.rb:192:in `apply_catalog''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/configurer.rb:381:in `run_internal''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/configurer.rb:242:in `block in run''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/context.rb:65:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet.rb:266:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/configurer.rb:219:in `run''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/apply.rb:343:in `apply_catalog''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/apply.rb:260:in `block (2 levels) in main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/context.rb:65:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet.rb:266:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/apply.rb:243:in `block in main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/context.rb:65:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet.rb:266:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/apply.rb:207:in `main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/apply.rb:177:in `run_command''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:340:in `block (4 levels) in main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/context.rb:65:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet.rb:266:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:339:in `block (3 levels) in main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/context.rb:65:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet.rb:266:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:261:in `block (2 levels) in main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:259:in `each''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:259:in `collect''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:259:in `block in main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/context.rb:65:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet.rb:266:in `override''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application/device.rb:244:in `main''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application.rb:390:in `run_command''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application.rb:382:in `block in run''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util.rb:687:in `exit_on_fail''\r\n00:06:16.285     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/application.rb:382:in `run''\r\n00:06:16.298     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util/command_line.rb:143:in `run''\r\n00:06:16.298     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/lib/puppet/util/command_line.rb:77:in `execute''\r\n00:06:16.298     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/puppet-6.7.0/bin/puppet:5:in `<top (required)>''\r\n00:06:16.298     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/bin/puppet:23:in `load''\r\n00:06:16.298     /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/bin/puppet:23:in `<top (required)>''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli/exec.rb:74:in `load''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli/exec.rb:74:in `kernel_load''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli/exec.rb:28:in `run''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli.rb:424:in `exec''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor/command.rb:27:in `run''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126:in `invoke_command''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor.rb:387:in `dispatch''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli.rb:27:in `dispatch''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor/base.rb:466:in `start''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli.rb:18:in `start''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/exe/bundle:30:in `block in <top (required)>''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/friendly_errors.rb:124:in `with_friendly_errors''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/exe/bundle:22:in `<top (required)>''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/bundle:23:in `load''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/bundle:23:in `<main>''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/ruby_executable_hooks:15:in `eval''\r\n00:06:16.298     /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/ruby_executable_hooks:15:in `<main>''\r\n00:06:16.298 RuntimeError: Unexpected error while applying catalog\r\n00:06:16.298 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/lib/utilitylib.rb:388\r\n00:06:16.304 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/dsl/structure.rb:44\r\n00:06:16.305 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/logger.rb:239\r\n00:06:16.306 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/dsl/structure.rb:43\r\n00:06:16.306 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/lib/utilitylib.rb:351\r\n00:06:16.307 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/lib/utilitylib.rb:311\r\n00:06:16.308 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/lib/utilitylib.rb:1022\r\n00:06:16.308 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/cisco_aaa_login_cfg_svc/test_cisco_aaa_login_cfg_svc.rb:177\r\n00:06:16.309 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/cisco_aaa_login_cfg_svc/test_cisco_aaa_login_cfg_svc.rb:173\r\n00:06:16.310 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/cisco_aaa_login_cfg_svc/test_cisco_aaa_login_cfg_svc.rb:173\r\n00:06:16.310 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/dsl/structure.rb:124\r\n00:06:16.311 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/logger.rb:239\r\n00:06:16.312 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/dsl/structure.rb:123\r\n00:06:16.313 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/tests/beaker_tests/cisco_aaa_login_cfg_svc/test_cisco_aaa_login_cfg_svc.rb:169\r\n00:06:16.313 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_case.rb:133\r\n00:06:16.314 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_case.rb:133\r\n00:06:16.315 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308\r\n00:06:16.315 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_case.rb:130\r\n00:06:16.316 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_suite.rb:66\r\n00:06:16.316 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_suite.rb:63\r\n00:06:16.317 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_suite.rb:63\r\n00:06:16.318 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/test_suite.rb:115\r\n00:06:16.319 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/cli.rb:192\r\n00:06:16.319 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/lib/beaker/cli.rb:118\r\n00:06:16.320 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/gems/beaker-4.6.0/bin/beaker:9\r\n00:06:16.321 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/bin/beaker:23\r\n00:06:16.321 /tmp/jenkins/workspace/forge-netdev_cisco-ciscopuppet_intn-sys_smoke-develop/PLATFORM/cisconx-64default.%7Bssh%3D%7Buser%3Dadmin%2Cpassword%3Dadmin%7D%7D/WORKER_LABEL/beaker/.bundle/gems/bin/beaker:23\r\n00:06:16.322 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli/exec.rb:74\r\n00:06:16.323 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli/exec.rb:74\r\n00:06:16.323 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli/exec.rb:28\r\n00:06:16.323 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli.rb:424\r\n00:06:16.324 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor/command.rb:27\r\n00:06:16.325 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor/invocation.rb:126\r\n00:06:16.325 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor.rb:387\r\n00:06:16.325 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli.rb:27\r\n00:06:16.326 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/vendor/thor/lib/thor/base.rb:466\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/cli.rb:18\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/exe/bundle:30\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/lib/bundler/friendly_errors.rb:124\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/gems/bundler-1.16.5/exe/bundle:22\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/bundle:23\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/bundle:23\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/ruby_executable_hooks:15\r\n00:06:16.327 /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/gems/2.3.0/bin/ruby_executable_hooks:15\r\n00:06:16.327 Begin teardown\r\n00:06:16.327 \r\n00:06:16.327 * \r\n00:06:16.327 --------\r\n00:06:16.327  * TestStep :: absent clean\r\n00:06:16.327 no feature tacacs+\r\n00:06:21.430 End teardown\r\n00:06:21.465 Warning: tests/beaker_tests/cisco_aaa_login_cfg_svc/test_cisco_aaa_login_cfg_svc.rb errored in 26.54 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9926', 'https://github.com/puppetlabs/puppet/pull/7638', '2019-07-25T03:46:51.000-0700', '2019-07-25T17:34:24.000-0700', '2019-07-25T17:34:24.000-0700', 'Resolved', 'resolved-issue-added', 3, '0', 1, 19, 2, 2, '38eac9eac0691d4d59db8152f5ea4f212e21bf1d'),
('puppet', 317861, 300743910, 7632, 'v6.7.0 Breaks camptocamp-postfix', 'The new version (v6.7.0) of the puppet-agent has introduced a regression that has broken our MTA (Postfix), based on the camptocamp-postfix module.\r\n \r\nSteps to reproduce on Ubuntu 18.04 LTS:\r\n```\r\nwget https://apt.puppetlabs.com/puppet6-release-bionic.deb\r\ndpkg -i puppet6-release-bionic.deb\r\napt update;apt install -y puppet-agent\r\npuppet module install camptocamp-postfix --version 1.8.0\r\npuppet apply -e ''include ::postfix''\r\n```\r\nOutput: Error: Could not prefetch mailalias provider ''aliases'': Could not parse line "postmaster:    root" (file: /etc/aliases, line: 3)\r\nError: Failed to apply catalog: Could not parse line "postmaster:    root" (file: /etc/aliases, line: 3)', 'https://tickets.puppetlabs.com/browse/PUP-9914', 'https://github.com/puppetlabs/puppet/pull/7632', '2019-07-23T17:41:31.000-0700', '2019-08-06T11:31:54.000-0700', '2019-08-06T11:31:54.000-0700', 'Resolved', 'resolved-issue-added', 8, '0', 1, 41, 13, 5, 'da614eb71d2c3b1b8e20e4218c2826e22522ab70'),
('puppet', 68130, 34777098, 3896, 'Add support for no_proxy env var', 'Puppet::Util::HttpProxy returns a proxy object to use for interacting with the forge in the case that http_proxy is set.  However, it does not take into account the no_proxy variable meaning that it will always use the proxy even if no_proxy would have it go direct.', 'https://tickets.puppetlabs.com/browse/PUP-4030', 'https://github.com/puppetlabs/puppet/pull/3896', '2015-02-16T15:29:58.000-0800', '2019-08-07T15:06:28.000-0700', '2019-08-07T15:06:28.000-0700', 'Closed', '', 8, '0', 1, 1, 0, 1, '90560edf0f43f5382bd539646988f7a96ea3809e'),
('puppet', 173751, 104436384, 5604, 'The yaml_data function used by lookup should return empty hash for empty yaml files', 'Since upgrading to 4.9.0 my Puppet installation is throwing errors up about {{lookup_options}} not being found in Hiera.\r\n\r\nFull error:\r\n\r\n{noformat}\r\nInfo: Using configured environment ''ci''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Resource Statement, Lookup of key ''lookup_options'' failed: Value returned from Hierarchy entry "yaml" has wrong type, expects a Hash value, got Boolean in Value returned from Hierarchy entry "yaml" has wrong type, expects a Hash value, got Boolean at /etc/puppetlabs/code/modules/klxnginx/manifests/init.pp:4:3 on node klx-ci\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{noformat}\r\n\r\nLine 4 of {{klxnginx/manifests/init.pp}} is as follows:\r\n\r\n{noformat}\r\nclass { ''nginx'' : }\r\n{noformat}\r\n\r\nwhich references the [Puppet NGINX|https://forge.puppet.com/puppet/nginx/changelog] module', 'https://tickets.puppetlabs.com/browse/PUP-7164', 'https://github.com/puppetlabs/puppet/pull/5604', '2017-02-02T05:41:27.000-0800', '2019-08-13T14:41:33.000-0700', '2019-08-13T14:41:33.000-0700', 'Closed', '', 13, '0', 1, 78, 2, 3, '8463cd30455a02d776d5377408f75874b2ed8fe8'),
('puppet', 319404, 303726755, 7651, 'Change $deviceconfdir section to agent', 'Setting {{$deviceconfdir}} in the main section makes puppetserver want to create it, which it shouldn''t.\r\n\r\nStarting puppetserver with an affected agent fails because of this:\r\n\r\n{noformat}\r\nAug 02 08:57:43 lnfb7hk8n03wnpk systemd[1]: Starting puppetserver Service...\r\nAug 02 08:58:01 lnfb7hk8n03wnpk puppetserver[17006]: RuntimeError: Got 1 failure(s) while initializing: File[/etc/puppetlabs/puppet/devices]: change from ''absent'' to ''directory'' failed: Could not set ''directory'' on ensure: Permission denied - /etc/puppetlabs/puppet/devices\r\nAug 02 08:58:01 lnfb7hk8n03wnpk puppetserver[17006]: block in use at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/settings.rb:1026\r\nAug 02 08:58:01 lnfb7hk8n03wnpk puppetserver[17006]: apply at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:249\r\nAug 02 08:58:01 lnfb7hk8n03wnpk puppetserver[17006]: use at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/settings.rb:1016\r\nAug 02 08:58:01 lnfb7hk8n03wnpk puppetserver[17006]: initialize_puppet at uri:classloader:/puppetserver-lib/puppet/server/puppet_config.rb:45\r\nAug 02 08:58:01 lnfb7hk8n03wnpk puppetserver[17006]: initialize at uri:classloader:/puppetserver-lib/puppet/server/master.rb:32\r\nAug 02 08:58:02 lnfb7hk8n03wnpk puppetserver[17006]: Execution error (RuntimeError) at RUBY/block in use (/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/settings.rb:1026).\r\nAug 02 08:58:02 lnfb7hk8n03wnpk puppetserver[17006]: (RuntimeError) Got 1 failure(s) while initializing: File[/etc/puppetlabs/puppet/devices]: change from ''absent'' to ''directory'' failed: Could not set ''directory'' on ensure: Permission denied - /etc/puppetlabs/puppet/devices\r\n{noformat}\r\n\r\nChanging the section of {{$deviceconfdir}} to {{agent}} fixes the issue.', 'https://tickets.puppetlabs.com/browse/PUP-9936', 'https://github.com/puppetlabs/puppet/pull/7651', '2019-08-02T03:00:03.000-0700', '2019-08-14T02:05:19.000-0700', '2019-08-14T02:05:19.000-0700', 'Resolved', '', 0, '0', 4, 27, 49, 3, 'b571b41b0ac7902d380fb8c719962821f4043a11'),
('puppet', 31126, 0, 0, 'Puppet always recreates Nagios_hosts', 'I''ve been using puppet with nagios for ages without any problems. Recently I looked into the puppet logs on my nagios server and it seems on every puppet run, puppet throws an error and recreates all the nagios_host objects (see below), even if none of them have been changed. I haven''t changed my config so is there a new bug?\r\n\r\nThanks,\r\nJonathan\r\n\r\n[jg4461@monitor ~]$ sudo puppet agent -t\r\nNotice: Ignoring --listen on onetime run\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/concat_basedir.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/python_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/srvadminpkgcount.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/gitolite_basedir.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/lib_path.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/virtualenv_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/ads_domain.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/rubyversion_major.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/cron_dayofmonth.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/partitions.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/winbind_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/vmparent.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/root_home.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/mountpoints.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/manufacturer.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/cron_dayofweek.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/oracle_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/cron_hour.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/os_maj_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/gateway.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/iptables_persistent_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/warranty.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/cron_minute.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/pip_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/iptables_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/ip6tables_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/isopenmanagesupported.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/pe_version.rb\r\nInfo: Loading facts in /var/lib/puppet/lib/facter/environment.rb\r\nInfo: Caching catalog for monitor.resnet.bris.ac.uk\r\nError: /Stage[main]/Nagios::Server/Resources[nagios_host]: Failed to generate additional resources using ''generate'': undefined method `file='' for #<Puppet::Error:0x7f0910359ab0>\r\nInfo: Applying configuration version ''1396867605''\r\nError: Could not prefetch nagios_host provider ''naginator'': undefined method `file='' for #<Puppet::Error:0x7f0912f92ff0>\r\nNotice: /Stage[main]/Nagios::Server/Nagios_host[radius01.nomadic-core.bris.ac.uk]/ensure: created\r\n...', 'https://tickets.puppetlabs.com/browse/PUP-2170', 'https://github.com/puppetlabs/puppet/commit/1fee8e77a2e3c6d8a4ada9a06b4a23c0e1c04e6f', '2014-04-07T07:16:41.000-0700', '2019-08-14T06:37:31.000-0700', '2019-08-14T06:37:31.000-0700', 'Closed', '', 15, '0', 0, 0, 0, 0, '1fee8e77a2e3c6d8a4ada9a06b4a23c0e1c04e6f'),
('puppet', 318146, 301329716, 7639, 'PKey.read monkey patch is incompatible with JRuby 9.1', 'Puppetserver 6.0 uses JRuby 9.1 which is compatible (sort of) with MRI 2.3. However, that version of JRuby doesn''t implement \{{OpenSSL::PKey.read}} so our monkey patch in puppet fails:\r\n\r\n{noformat}\r\n$ ruby --version\r\njruby 9.1.17.0 (2.3.3) 2018-04-20 d8b1ff9 Java HotSpot(TM) 64-Bit Server VM 25.162-b12 on 1.8.0_162-b12 +jit [darwin-x86_64]\r\n$ git rev-parse HEAD\r\nf292c7ebcfd2b5e0f6696c40ae4f66ed7c053947\r\n$ bx rake parallel;spec\r\nrake aborted!\r\nNameError: undefined method `read'' for module `OpenSSL::PKey''\r\n/Users/josh/work/puppet/lib/puppet/util/monkey_patches.rb:104:in `<module:PKey>''\r\n/Users/josh/work/puppet/lib/puppet/util/monkey_patches.rb:103:in `<main>''\r\n/Users/josh/work/puppet/lib/puppet/util.rb:1:in `<module:(root)>''\r\n/Users/josh/work/puppet/lib/puppet/util.rb:17:in `<module:Util>''\r\n/Users/josh/work/puppet/lib/puppet/util.rb:16:in `<main>''\r\n...\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9927', 'https://github.com/puppetlabs/puppet/pull/7639', '2019-07-25T15:04:18.000-0700', '2019-08-19T11:07:51.000-0700', '2019-08-19T11:07:51.000-0700', 'Resolved', 'resolved-issue-added', 2, '0', 1, 14, 32, 3, '9ab09d90cbc61e8ef7a3f44f2129863e81d37eff'),
('puppet', 315541, 297786346, 7611, 'puppet parser validate version 6.6.0 does not accept STDIN properly', '*Puppet Version: 6.6.0 and 6.5.0*\r\n *Puppet Server Version: N/A*\r\n *OS Name/Version: Ubuntu 19.04 using bionic packages 6.6.0-1bionic*\r\n\r\nPassing code over stdin to puppet parser fails with ''Error: undefined method `message'' for nil:NilClass''. I was able to reproduce with 6.5.0 and 6.6.0, but not with 6.4.2\r\n\r\n*Desired Behavior:*\r\n\r\nValidation of code using filename or stdin should be identical\r\n\r\n*Actual Behavior:*\r\n\r\n> touch foo.pp\r\n> puppet parser validate foo.pp\r\n> cat foo.pp | puppet parser validate\r\nError: undefined method `message'' for nil:NilClass\r\nError: Try ''puppet help parser validate'' for usage\r\n\r\nI noticed this because emacs flycheck uses stdin to do syntax checking.\r\n\r\nNote that the documentation (man puppet parser) states that this is a valid way to submit output:\r\n\r\nEXAMPLES\r\n\r\n \r\n\r\nValidate from STDIN:\r\n\r\n$ cat init.pp | puppet parser validate', 'https://tickets.puppetlabs.com/browse/PUP-9816', 'https://github.com/puppetlabs/puppet/pull/7611', '2019-07-08T13:45:02.000-0700', '2019-08-19T15:39:03.000-0700', '2019-08-19T15:39:03.000-0700', 'Resolved', 'resolved-issue-added', 11, '0', 2, 20, 7, 2, 'b153fa7271a720fd42b6caba0f8bdd7fe78df870'),
('puppet', 31264, 15916578, 2654, 'Package resource not working as expected in 3.5.0', 'One of my modules has the following code:\r\n\r\n{code}\r\npackage { ''inetd'': ensure => absent; }\r\n{code}\r\n\r\nOn the next Puppet run, Puppet tries to remove the xinetd package (debug output):\r\n{code}\r\nDebug: Executing ''/bin/rpm -q inetd --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n''\r\nDebug: Executing ''/bin/rpm -q inetd --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n --whatprovides''\r\nDebug: Executing ''/bin/rpm -e xinetd-2.3.14-39.el6_4.x86_64''\r\nError: Execution of ''/bin/rpm -e xinetd-2.3.14-39.el6_4.x86_64'' returned 1: error: Failed dependencies:\r\n        xinetd is needed by (installed) tftp-server-0.49-7.el6.x86_64\r\nError: /Stage[main]/Services/Package[inetd]/ensure: change from 2.3.14-39.el6_4 to absent failed: Execution of ''/bin/rpm -e xinetd-2.3.14-39.el6_4.x86_64'' returned 1: error: Failed dependencies:\r\n        xinetd is needed by (installed) tftp-server-0.49-7.el6.x86_64\r\n{code}\r\n\r\nI''ve also noticed this problem with the JRE package.  Our local yum repo has many versions of java.  One of these packages has the %{NAME} ''jre'' (downloaded from oracle''s site directly) which is what we used to create the package resource.  However it''s substituting other java packages that provide ''jre'' and installing those packages instead.  In fact, if there''s a package that provides ''jre'' already installed on your system puppet won''t install the package named jre!', 'https://tickets.puppetlabs.com/browse/PUP-2182', 'https://github.com/puppetlabs/puppet/pull/2654', '2014-04-08T13:04:38.000-0700', '2019-08-23T13:47:51.000-0700', '2019-08-23T13:47:51.000-0700', 'Closed', '', 38, '0', 1, 51, 6, 7, 'd67954bb1418679c8ab080f031d90faee7f20a16'),
('puppet', 322201, 310637429, 7683, 'Regression: Unable to install g++ package using dpkg provider', '*Puppet Version: 6.8.0*\r\n *Puppet Server Version: NA*\r\n *OS Name/Version: Ubuntu 16.04 and Ubuntu 18.04*\r\n\r\n*Desired Behavior:*\r\n\r\nInstall "g++" package using dpkg provider\r\n\r\n*Actual Behavior:*\r\n\r\nI get this message:\r\n\r\n \r\n{noformat}Info: Package g++ is virtual, defaulting to binutils\r\n{noformat}\r\nIf I do simple "apt-get install g++", that works fine but unable to do that with changes made to dpkg provider in 6.8.0. I think the "++" sign is breaking the parsing added here:\r\n\r\n \r\n\r\n[https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/dpkg.rb#L126]\r\n\r\n \r\n\r\nThe issue was introduced in PUP-9824 I think. If I run the dpkg command being used the first line that contains a "g" is "binutils" so I think what''s getting matched is just "g" and not "g++".\r\n\r\n \r\n\r\nReproduce:\r\n\r\nInstall Puppet on Ubuntu 16.04 or Ubuntu 18.04 and try to install g++\r\n\r\n \r\n{noformat}puppet resource package g++ ensure=installed\r\n{noformat}\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9975', 'https://github.com/puppetlabs/puppet/pull/7683', '2019-08-24T12:48:21.000-0700', '2019-08-27T15:47:34.000-0700', '2019-08-27T15:47:34.000-0700', 'Resolved', '', 4, '0', 1, 1, 1, 1, ''),
('puppet', 322106, 310958602, 7684, 'Regression: allow_virtual => true matches too much for dpkg provider', '*Puppet Version:* 6.8.0\r\n*Puppet Server Version:* 6.5.0\r\n*OS Name/Version:* Debian buster (10.x)\r\n\r\nSince the change of allow_virtual to true in Puppet 6.8.0 some of our package resources behaved strangely and required to change the parameter back to the old default. At first we thought this only affected packages where the name and a provides value are identical (e.g. a resource to uninstall vim and install vim-nox now tried to unistall vim-nox since it also provides vim).\r\n\r\nAfter installing a new server with the new Puppet version we noticed that the package bc had not been installed. It is defined with the simplest of package resources:\r\n\r\n{code:Manifest}\r\npackage { ''bc'':\r\n    ensure => latest\r\n}\r\n{code}\r\n\r\nLooking at the provider source code we can see the relevant part here\r\n\r\n{code:title=dpkg.rb}\r\n      if @resource.allow_virtual?\r\n        output = dpkgquery(\r\n          "-W",\r\n          "--showformat",\r\n          self.class::DPKG_QUERY_PROVIDES_FORMAT_STRING\r\n        ).lines.find {|package| package.match(/\[.*#{@resource[:name]}.*\]/)}\r\n        if output          \r\n          hash = self.class.parse_line(output,self.class::FIELDS_REGEX_WITH_PROVIDES)\r\n          Puppet.info("Package #{@resource[:name]} is virtual, defaulting to #{hash[:name]}")\r\n          @resource[:name] = hash[:name]\r\n        end\r\n      end\r\n{code}\r\n\r\nwith the constant used being defined further up in the file as\r\n\r\n{code:title=dpkg.rb}\r\n  self::DPKG_QUERY_PROVIDES_FORMAT_STRING = %Q{''${Status} ${Package} ${Version} [${Provides}]\\n''}\r\n{code}\r\n\r\nRunning the command\r\n\r\n{code:shell}\r\ndpkg-query -W --showformat ''${Status} ${Package} ${Version} [${Provides}]\n"''\r\n{code}\r\n\r\non the affected system we can see the output the provider processes in the above code, a line might look like one of these\r\n\r\n{code}\r\n"install ok installed php-apcu-bc 1.0.4-4 [php7.3-apcu-bc]\r\n"install ok installed php7.3-bcmath 7.3.4-2 [php-bcmath]\r\n"install ok installed php7.3-odbc 7.3.4-2 [php-odbc, php-pdo-odbc, php7.3-pdo-odbc]\r\n{code}\r\n\r\nIt is easy to see that all of these would also match the package resource named bc since the code just matches .*name.* within the comma-separated list of dpkg provides values, with no concern for matching a full name.\r\n\r\n*Desired Behavior:*\r\n\r\nVirtual packages (provides values) should only match exactly. The default for allow_virtual should be false for at least the apt and dpkg provider since there are many packages in the apt repositories that have identical names and provides values which leads to broken systems when puppet starts uninstalling packages on ensure => absent.\r\n\r\n*Actual Behavior:*\r\n\r\nPackage resources are currently satisfied that they have found a matching package when they find the resource name as a substring in the list of provides values anywhere.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9974', 'https://github.com/puppetlabs/puppet/pull/7684', '2019-08-23T08:18:54.000-0700', '2019-08-27T15:47:50.000-0700', '2019-08-27T15:47:50.000-0700', 'Resolved', 'resolved-issue-added', 2, '0', 2, 144, 74, 5, ''),
('puppet', 161235, 216200297, 7098, 'Puppet::Util::Windows::Process.execute should accept a working directory', '{{Puppet::Util::Execution.execute}} should take in a `cwd` option that lets the user specify the new process'' working directory.', 'https://tickets.puppetlabs.com/browse/PUP-6919', 'https://github.com/puppetlabs/puppet/pull/7098', '2016-11-15T22:51:41.000-0800', '2019-09-04T16:28:08.000-0700', '2019-09-04T16:28:08.000-0700', 'Closed', 'package;type_and_provider;windows', 4, '0', 4, 224, 59, 5, 'f2e51692de70020dd97028182b938f931a169920'),
('puppet', 315304, 294360638, 7602, 'Performance of unpacking modules is extremely slow', '*Puppet Version: any*\r\n *Puppet Server Version: any*\r\n *OS Name/Version: any*\r\n\r\nInstalling modules from Puppet Forge is extremely slow. I have found a culprit. It is a\r\n\r\n{{Puppet::ModuleTool::Tar::Mini}}\r\n\r\nimplementation.\r\n\r\nThe unpack is *100x times* slower then executing a {{tar xzvf}} system command!\r\n\r\n*Steps to reproduce:*\r\n\r\nInstall a module from Puppet Forge and measure a time:\r\n\r\n{{time puppet module install puppetlabs-stdlib --version 4.25.1}}\r\n\r\nThen execute:\r\n\r\n{{time bash -c ''curl [https://forge.puppet.com/v3/files/puppetlabs-stdlib-4.25.1.tar.gz] -o puppetlabs-stdlib-4.25.1.tar.gz && tar xzvf puppetlabs-stdlib-4.25.1.tar.gz''}}\r\n\r\n*Desired Behavior:*\r\n\r\nExtraction of downloaded modules should be about the same performance as system tar xzvf command. It might be at most 2x times slower then system command, but preferably should be about the same.\r\n\r\n*Temporal solution:*\r\n\r\nTo install modules faster i propose to switch to Gnu implementation as a first choice. Al least until Minitar can be much faster.', 'https://tickets.puppetlabs.com/browse/PUP-9813', 'https://github.com/puppetlabs/puppet/pull/7602', '2019-07-03T15:53:20.000-0700', '2019-09-10T21:10:28.000-0700', '2019-09-10T21:10:28.000-0700', 'Closed', '', 3, '0', 1, 44, 17, 3, ''),
('puppet', 320046, 305347976, 7660, 'no_proxy environment variable does not work', 'Commit 90560edf0f43f5382bd539646988f7a96ea3809e for PUP-4030 added the ability to skip an http proxy if the host and port matched an entry in the {{NO_PROXY}} environment variable. However it didn''t actually work because our connection factory passed the {{Site}} object instead of a String or URI. To reproduce specify an unused http proxy port and try to not use a proxy for the puppet server:\r\n\r\n{noformat}\r\n$ env NO_PROXY=$(bundle exec puppet config print server --section main) bundle exec puppet agent -t --http_proxy_host localhost --http_proxy_port 12345\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: Failed to open TCP connection to localhost:12345 (Connection refused - connect(2) for "localhost" port 12345)\r\nInfo: Retrieving pluginfacts\r\nError: /File[/Users/josh/.puppetlabs/opt/puppet/cache/facts.d]: Failed to generate additional resources using ''eval_generate'': Failed to open TCP connection to localhost:12345 (Connection refused - connect(2) for "localhost" port 12345)\r\nError: /File[/Users/josh/.puppetlabs/opt/puppet/cache/facts.d]: Could not evaluate: Could not retrieve file metadata for puppet:///pluginfacts: Failed to open TCP connection to localhost:12345 (Connection refused - connect(2) for "localhost" port 12345)\r\n...\r\n{noformat}\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9942', 'https://github.com/puppetlabs/puppet/pull/7660', '2019-08-07T15:05:26.000-0700', '2019-09-16T11:57:53.000-0700', '2019-09-16T11:57:53.000-0700', 'Resolved', 'resolved-issue-added', 2, '0', 1, 6, 8, 2, 'cb4a9b7da148f97ed9ce02f859ad6a90115c0079'),
('puppet', 77763, 305409874, 7663, 'Puppet''s http connection factory doesn''t support authenticating proxies', 'Work for ticket PUP-4030 uncovered that puppet''s http connection code does not support authenticating proxies (that require a username and password). Note there are {{http_proxy_user}} and {{http_proxy_password}} settings, but they are only used with the PMT and some providers.\r\n\r\nPuppet connection handling should be refactored to use Puppet::Util::HttpProxy class.', 'https://tickets.puppetlabs.com/browse/PUP-4470', 'https://github.com/puppetlabs/puppet/pull/7663', '2015-04-28T11:52:36.000-0700', '2019-09-16T11:58:37.000-0700', '2019-09-16T11:58:37.000-0700', 'Resolved', 'resolved-issue-added', 4, '0', 1, 15, 11, 2, '64ec44b6331c978ca3bde47f5ae4bc672949ada8'),
('puppet', 31144, 305367539, 7662, 'Don''t use an http proxy when connecting to localhost', 'We had a PE site which had set the http_proxy_\{port,host\} settings for PMT usage, which had the unintended consequence that all puppet master http connections went through the proxy, including those to the dashboard for node lookups. When something (not yet identified) changed in the network/proxy configuration, these lookups failed causing all agent runs to fail.\r\n\r\nThis raises the question about whether it *ever* makes sense for the master to use a proxy for connections to localhost.\r\n\r\nWe''ve considered two approaches here:\r\n1) add a new setting for http proxy exclusions. This could be set to, e.g. {{localhost;*.internal.lan}}, etc.\r\n2) never using the proxy settings when talking to localhost\r\n\r\nThere may be some other approaches that would work as well.', 'https://tickets.puppetlabs.com/browse/PUP-2172', 'https://github.com/puppetlabs/puppet/pull/7662', '2014-04-07T10:58:36.000-0700', '2019-09-16T11:58:45.000-0700', '2019-09-16T11:58:45.000-0700', 'Resolved', 'resolved-issue-added', 8, '0', 1, 1, 1, 1, 'afe29f6702ec7b9e1b3973b3de73ca2c64f19fae'),
('puppet', 320444, 311982823, 7691, 'Exec logs output of Sensitive unless and onlyif checks at debug', '*Puppet Version:* 6.7.2\r\n *Puppet Server Version:* N/A\r\n *OS Name/Version:* macOS 10.14, Ubuntu 18.10\r\n\r\nI have been working on implementing support for Sensitive in a module that contains many execs. When I use Sensitive in the command parameter it redacts the command and does not show any command output in debug mode. However, when I use Sensitive in the unless or onlyif parameters it redacts the command and logs the output at debug.\r\n\r\nThis is problematic for me because some of the commands being used in the unless statements are leaking passwords into reports when running in debug.\r\n\r\nI would expect that if I mark a command as Sensitive that I wouldn''t get logged output from the command as it would have a higher likelihood of containing sensitive information.\r\n\r\nThe following manifest can reproduce the issue:\r\n{code:puppet}# test.pp\r\nexec { ''Sensitive command'':\r\n  command => Sensitive(''/bin/echo "secret0"''),\r\n}\r\n\r\nexec { ''Sensitive unless'':\r\n  command => ''/bin/echo Pass'',\r\n  unless  => Sensitive(''/bin/echo "secret1"''),\r\n}\r\n\r\nexec { ''Sensitive onlyif'':\r\n  command => ''/bin/echo Pass'',\r\n  onlyif  => Sensitive(''/bin/echo "secret2''),\r\n}\r\n{code}\r\n \r\n\r\nWhen I run puppet apply test.pp --debug I get the following output:\r\n{noformat}puppet apply test.pp --debug\r\nDebug: Runtime environment: puppet_version=6.7.2, ruby_version=2.4.5, run_mode=user, default_encoding=UTF-8\r\n...\r\nInfo: Applying configuration version ''1565384722''\r\nDebug: Exec[Sensitive command](provider=posix): Executing ''[redacted]''\r\nDebug: Executing: ''[redacted]''\r\nNotice: /Stage[main]/Main/Exec[Sensitive command]/returns: executed successfully\r\nDebug: /Stage[main]/Main/Exec[Sensitive command]: The container Class[Main] will propagate my refresh event\r\nDebug: Exec[Sensitive unless](provider=posix): Executing check ''[redacted]''\r\nDebug: Executing: ''[redacted]''\r\nDebug: /Stage[main]/Main/Exec[Sensitive unless]/unless: secret1\r\nDebug: /Stage[main]/Main/Exec[Sensitive unless]: ''[command redacted]'' won''t be executed because of failed check ''unless''\r\nDebug: Exec[Sensitive onlyif](provider=posix): Executing check ''[redacted]''\r\nDebug: Executing: ''[redacted]''\r\nDebug: /Stage[main]/Main/Exec[Sensitive onlyif]/onlyif: secret2\r\nDebug: Exec[Sensitive onlyif](provider=posix): Executing ''[redacted]''\r\nDebug: Executing: ''[redacted]''\r\nNotice: /Stage[main]/Main/Exec[Sensitive onlyif]/returns: executed successfully\r\nDebug: /Stage[main]/Main/Exec[Sensitive onlyif]: The container Class[Main] will propagate my refresh event\r\nDebug: Class[Main]: The container Stage[main] will propagate my refresh event\r\nDebug: Finishing transaction 70240057109900\r\nDebug: Storing state\r\nDebug: Pruned old state cache entries in 0.00 seconds\r\nDebug: Stored state in 0.01 seconds\r\nNotice: Applied catalog in 0.07 seconds\r\n{noformat}\r\nIt''s a bit verbose, but you can see secret1 and secret2 leaked above on the following lines:\r\n{noformat}Debug: /Stage[main]/Main/Exec[Sensitive unless]/unless: secret1\r\nDebug: /Stage[main]/Main/Exec[Sensitive onlyif]/onlyif: secret2\r\n{noformat}\r\nIt''s worth noting that logoutput does not affect this particular behavior:\r\n{noformat}# logoutput.pp\r\nexec { ''Sensitive unless'':\r\n  command => ''/bin/true'',\r\n  logoutput  => false,\r\n  unless => Sensitive(''/bin/echo secret1'')\r\n}\r\n\r\npuppet apply --debug logoutput.pp\r\n...\r\nInfo: Applying configuration version ''1565385531''\r\nDebug: Exec[Sensitive unless](provider=posix): Executing check ''[redacted]''\r\nDebug: Executing: ''[redacted]''\r\nDebug: /Stage[main]/Main/Exec[Sensitive unless]/unless: secret1\r\nDebug: /Stage[main]/Main/Exec[Sensitive unless]: ''[command redacted]'' won''t be executed because of failed check ''unless''\r\nDebug: Finishing transaction 70187444945900\r\nDebug: Storing state\r\nDebug: Pruned old state cache entries in 0.00 seconds\r\nDebug: Stored state in 0.01 seconds\r\nNotice: Applied catalog in 0.02 seconds\r\n{noformat}\r\n*Desired Behavior:* When I run code in debug that contains an exec with Sensitive unless/onlyif commands the output of that command should be redacted or not logged.\r\n\r\n*Actual Behavior:* Sensitive unless/onlyif checks log their output at debug.\r\n\r\nSome minor digging shows the following code in the check methods for unless (in lib/puppet/type/exec.rb):\r\n{code:ruby}      # Return true if the command does not return 0.\r\n      def check(value)\r\n        begin\r\n          output, status = provider.run(value, true)\r\n        rescue Timeout::Error\r\n          err _("Check %{value} exceeded timeout") % { value: value.inspect }\r\n          return false\r\n        end\r\n\r\n        output.split(/\n/).each { |line|\r\n          self.debug(line)\r\n        }\r\n\r\n        status.exitstatus != 0\r\n      end\r\n    end\r\n{code}\r\nThe code for onlyif is quite similar. I suspect that this is the code responsible for logging the output in debug mode. A quick git blame shows that the output.split blocks in those methods haven''t been touched in a long time and probably got missed in previous passes for Sensitive.', 'https://tickets.puppetlabs.com/browse/PUP-9956', 'https://github.com/puppetlabs/puppet/pull/7691', '2019-08-09T14:24:39.000-0700', '2019-09-16T12:19:58.000-0700', '2019-09-16T12:19:58.000-0700', 'Resolved', 'resolved-issue-added', 4, '0', 1, 23, 6, 2, '91c755f9be626c441345b40e2148b6c95ec49d10'),
('puppet', 245716, 306705272, 7671, 'puppet plugin download doesn''t re-use HTTP connections', 'The {{puppet plugin download}} command doesn''t re-use connections to the\r\nPuppet Server when downloading plugins from modules. This adds considerable time to\r\ndownloads along with extra load on the Puppet Server due to multiple redundant TLS handshakes.\r\n\r\nh2. Reproduction Case\r\n\r\n  - Install {{puppet-agent}} 5.5.0 and {{puppetserver}} 5.3.0 on a CentOS 7\r\n    node:\r\n\r\n{code:bash}\r\nrpm -Uvh http://yum.puppetlabs.com/puppet5/puppet5-release-el-7.noarch.rpm\r\nyum install -y puppet-agent-5.5.0 puppetserver-5.3.0\r\n{code}\r\n\r\n  - Configure the puppet agent to connect to the local host and start\r\n    puppetserver:\r\n\r\n{code:bash}\r\n/opt/puppetlabs/bin/puppet config set --section main server $(hostname -f)\r\nsystemctl start puppetserver\r\n{code}\r\n\r\n\r\n  - Run {{puppet agent -t}} to verify things work.\r\n\r\n  - Install the {{puppetlabs-windows}} module, which brings in a ton of\r\n    plugins that will have to be synced:\r\n\r\n{code:bash}\r\n/opt/puppetlabs/bin/puppet module install puppetlabs-windows\r\n{code}\r\n\r\n  - Empty the plugin cache, and time a puppet agent run along with the\r\n    number of network connections it opens:\r\n\r\n{code:bash}\r\nrm -rf /opt/puppetlabs/puppet/cache/lib\r\ntime /opt/puppetlabs/bin/puppet agent -t --http_debug 2>&1|grep -e Info: -e ''opening connection''\r\n{code}\r\n\r\n  - Empty the cache again and time a puppet plugin download run along\r\n    with the number of network connections opened:\r\n\r\n{code:bash}\r\nrm -rf /opt/puppetlabs/puppet/cache/lib\r\ntime /opt/puppetlabs/bin/puppet plugin download --verbose --http_debug 2>&1|grep -e Info: -e ''opening connection''\r\n{code}\r\n\r\n\r\n\r\nh3. Outcome\r\n\r\nThe puppet agent run uses a handful of connections:\r\n\r\n{noformat}\r\n# rm -rf /opt/puppetlabs/puppet/cache/lib\r\n# time /opt/puppetlabs/bin/puppet agent -t --http_debug 2>&1|grep -e Info: -e ''opening connection''\r\n\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nInfo: Caching catalog for wzwhytp204ipraf.delivery.puppetlabs.net\r\nInfo: Applying configuration version ''1523665266''\r\n\r\nreal	0m43.990s\r\nuser	0m16.685s\r\nsys	0m1.497s\r\n{noformat}\r\n\r\nThe puppet plugin download run uses hundreds of connections and takes much\r\nlonger than the puppet agent run despite only doing a subset of the work:\r\n\r\n{noformat}\r\n# rm -rf /opt/puppetlabs/puppet/cache/lib\r\n# time /opt/puppetlabs/bin/puppet plugin download --verbose --http_debug 2>&1|grep -e Info: -e ''opening connection''\r\n\r\nInfo: Retrieving pluginfacts\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nInfo: Retrieving plugin\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\n... omitted hundreds of open calls for brevity ...\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\nInfo: Retrieving locales\r\nopening connection to wzwhytp204ipraf.delivery.puppetlabs.net:8140...\r\n\r\nreal  3m39.345s\r\nuser  1m29.576s\r\nsys 0m2.405s\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe {{puppet plugin download}} action should complete much faster than\r\n{{puppet agent -t}} when populating a cold plugin cache.', 'https://tickets.puppetlabs.com/browse/PUP-8662', 'https://github.com/puppetlabs/puppet/pull/7671', '2018-04-13T17:33:38.000-0700', '2019-09-16T13:13:57.000-0700', '2019-09-16T13:13:57.000-0700', 'Resolved', 'resolved-issue-added', 3, '0', 1, 17, 2, 2, '1a0869c530734e7ffb05e44e4ddda09f1e85cf1b'),
('puppet', 95553, 308842675, 7678, 'Puppet::Resource::Catalog::Compiler#set_server_facts always produces a warning on ipv6 only systems', 'When compiling a catalogue for an IPv6-only system such as\r\n{code}\r\nigalic@mydb02 ~> ip a\r\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default \r\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r\n    inet 127.0.0.1/8 scope host lo\r\n       valid_lft forever preferred_lft forever\r\n    inet6 ::1/128 scope host \r\n       valid_lft forever preferred_lft forever\r\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\r\n    link/ether 52:54:00:ba:b8:17 brd ff:ff:ff:ff:ff:ff\r\n    inet6 2a01:4f8:211:9d6::14/64 scope global \r\n       valid_lft forever preferred_lft forever\r\n    inet6 fe80::5054:ff:feba:b817/64 scope link \r\n       valid_lft forever preferred_lft forever\r\nigalic@mydb02 ~>\r\n{code}\r\n\r\npuppet will throw the warning: {{Warning: Could not retrieve fact ipaddress}}\r\n\r\nGiven that the code that produces this warning has a fallback for _some_ {{nil?}} values, perhaps it''s not necessary to issue a warning at all, and instead just add another {{.nil?}} case:\r\n\r\n{code}\r\n  # Initialize our server fact hash; we add these to each client, and they\r\n  # won''t change while we''re running, so it''s safe to cache the values.\r\n  def set_server_facts\r\n    @server_facts = {}\r\n\r\n    # Add our server version to the fact list\r\n    @server_facts["serverversion"] = Puppet.version.to_s\r\n\r\n    # And then add the server name and IP\r\n    {"servername" => "fqdn",\r\n      "serverip" => "ipaddress"\r\n    }.each do |var, fact|\r\n      @server_facts[var] = value if value = Facter.value(fact)\r\n    end\r\n\r\n    if @server_facts["servername"].nil?\r\n      host = Facter.value(:hostname)\r\n      if domain = Facter.value(:domain)\r\n        @server_facts["servername"] = [host, domain].join(".")\r\n      else\r\n        @server_facts["servername"] = host\r\n      end\r\n    end\r\n    if @server_facts["serverip"].nil?\r\n      @server_facts["serverip"] = Facter.value(:ipaddress6)\r\n    end\r\n  end\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5109', 'https://github.com/puppetlabs/puppet/pull/7678', '2015-08-29T04:34:40.000-0700', '2019-09-16T14:45:56.000-0700', '2019-09-16T14:45:56.000-0700', 'Resolved', 'IPv6;help_wanted;resolved-issue-added', 6, '0', 1, 31, 4, 2, '48f720a68d9a2903b9ea71561f87af16136d76f6'),
('puppet', 23233, 318081010, 7724, 'Puppet package providers use execpipe, which does not set LC_ALL or LANG', 'The opkg, rpm, pip, dpkg, pacman, and openbsd package providers all use `Puppet::Util::Execution.execpipe` to run commands, which does not normalize langage/locale environment variables. If any of the commands executed by those providers have been localized, then trying to execute a command and parse the output may fail because the parsing assumes an English locale/lang. `Puppet::Util::Execution.execute` does reset the LC_ALL and LANG variables, but `execpipe` calls out to Ruby''s `Kernel#open` without normalizing the command output first.\r\n\r\nThis could be reconciled by converting all of the `execpipe` invocations to `execute`. Alternately the code used in `execute` could be duplicated in the `execpipe` method.', 'https://tickets.puppetlabs.com/browse/PUP-1401', 'https://github.com/puppetlabs/puppet/pull/7724', '2014-01-08T12:01:34.000-0800', '2019-09-18T08:42:23.000-0700', '2019-09-18T08:42:23.000-0700', 'Accepted', 'i18n;utf-8', 1, '0', 2, 73, 93, 4, ''),
('puppet', 32446, 23435405, 3247, 'Puppet client does not update and does consult the crl during authentication', 'I my tests puppet client never updates it''s /var/lib/puppet/ssl/ca/ca_crl.pem from the master\r\neven if I delete it - it is not fetched from master then client runs.\r\n\r\nAnother issue is that puppet client does not consult the crl - after revoking cert of node dev2.internal on master - and manually copying /var/lib/puppet/ssl/ca/{ca_crl.pem,inventory.txt} to client mon1a.internal and restarting the client to make sure it can pickup the crl changes - I was still able to trigger client puppet run on mon1a.internal from dev2.internal.\r\n\r\nIt looks like puppet - client does not take the crl into consideration then authenticating.\r\n\r\nThe relevant config on mon1a.internal is\r\n<pre>\r\n # allow all authenticated nodes to trigger puppet run\r\npath /run\r\nmethod save\r\nauth yes\r\nallow *\r\n</pre>\r\nthis ACL comes first in the auth.conf file\r\n\r\nAnd this is the command I used to triger puppet run from dev2.internal\r\n<pre>\r\n curl --cert /var/lib/puppet/ssl/certs/dev2.internal.pem --key  /var/lib/puppet/ssl/private_keys/dev2.internal.pem --cacert /var/lib/puppet/ssl/certH "Content-Type: text/pson" -d "{}" https://mon1a.internal:8139/production/run/dev2.internal\r\n</pre>\r\nCould these problems be taken care of?\r\n\r\nThanks\r\nAlex\r\n\r\n*Ed- description from #9205 which is closely related included*\r\n\r\nWe came across this in a weird way.  Last night we reissued the CA certificate, which had expired.  We then reissued the puppetmaster and puppetca certificate (which we had to do for RHEL4 and RHEL5 but all other systems were happy without this step).  We then noticed on RHEL4 and RHEL5 that they were still complaining about cert validation, but ONLY for getting plugins and sending the report (it got a catalog and was able to get files for modules, etc, just fine).  We did an strace and found this was the only times it was trying to get a CRL (and was failing).  Why is this the only time the CRL was in play?  ', 'https://tickets.puppetlabs.com/browse/PUP-2310', 'https://github.com/puppetlabs/puppet/pull/3247', '2014-04-21T09:53:21.000-0700', '2019-09-20T08:16:53.000-0700', '2019-09-20T08:16:53.000-0700', 'Resolved', 'redmine;resolved-issue-added;resolved_issue_added', 10, '0', 1, 9, 0, 2, '4951f174b945923fcfaa2c080d1d7f24aa6a17db'),
('puppet', 274566, 316272624, 7709, 'File: source attribute broken for HTTP(s) URI''s containing query parameters', '*Puppet Version:* 4.4.0 *-* 5.5.6\r\n *Puppet Server Version:* All\r\n *OS Name/Version:* All\r\n\r\nWe want to use the [`source` attribute of the file type|https://puppet.com/docs/puppet/5.5/types/file.html#file-attribute-source] to get host specific stuff from a web service. For this we''re using the following code:\r\n{code:puppet}file { ''/etc/path/to/file'':\r\n  ensure => file,\r\n  source => ''https://fancywebservice.example.org/get_host_specific_config.py?host=foobar''\r\n}{code}\r\nThe important part here is the `host=foobar` parameter. If it''s not added, the web service will return a 404.\r\n\r\n*Desired Behavior:*\r\n The file type should be able to retrieve a file from a http(s) URL which contains query parameters\r\n\r\n*Actual Behavior:*\r\n{noformat}Error: /Stage[main]/Main/File[/etc/path/to/file]: Could not evaluate: Could not retrieve information from environment production source(s) https://fancywebservice.example.org/get_host_specific_config.py?host=foobar{noformat}\r\nThis happens, because Puppet, for reason unknown to me, requests only the `path` element of the uri and skips on the query parameters:\r\n\r\n[https://github.com/puppetlabs/puppet/blob/7ec328f0832492353cad5b2b3ae6e90449fa105f/lib/puppet/util/http_proxy.rb#L184]\r\n\r\n \r\n\r\nI will submit a PR to fix this.', 'https://tickets.puppetlabs.com/browse/PUP-9109', 'https://github.com/puppetlabs/puppet/pull/7709', '2018-09-06T04:02:04.000-0700', '2019-09-30T10:03:08.000-0700', '2019-09-30T10:03:08.000-0700', 'Resolved', 'resolved-issue-added', 3, '0', 2, 19, 3, 2, '1fdd75f089ab8c9e3947c7820c85465e4edadf71'),
('puppet', 263871, 267236738, 7469, 'validate_cmd creates tmp file with inconsistent permissions', '*Puppet Version: 5.5.0*\r\n *Puppet Server Version: NA*\r\n *OS Name/Version: Linux & Mc OSX confirmed*\r\n\r\nWhen the validate_cmd runs it creates a temporary file however the permissions it assigns to this temporary file are not related to the permissions defined on the file type object. \r\n\r\n*Desired Behaviour:*\r\n\r\nThe temporary file used when running the validate command should have the exact same permissions as the file resources it is trying to create.  e.g. \r\n\r\nwith a file type of\r\n{code:puppet}file {''/tmp/test'':\r\n   owner => ''foo'',\r\n   group => ''bar'',\r\n   mode  => ''0555'',\r\n   validate_cmd => ''test -x %''\r\n}{code}\r\nthe tmpe file created should have `foo:bar 0555` permissions\r\n\r\n*Actual Behavior:*\r\n\r\nI have observed the following behaviour.\r\n * tmp files are always created with permissions `0600`\r\n * if the file being managed does not exist the tmp file is owned by root\r\n * if the file being managed the tmp file uses has the same owner as the file being managed on disk\r\n\r\n \r\n the following runs a loop to detect the how the tmp file is created.  the tests use the folloing manifest file\r\n{code:puppet}file {''/tmp/test/test'':\r\n  ensure => file,\r\n  owner => ''jbond'',\r\n  group => ''jbond'',\r\n  content => ''foobar'',\r\n  validate_cmd => ''/bin/false '',\r\n}\r\n{code}\r\n*output when `/tmp/test/test` doesn''t exist*\r\n{code:bash}root@dev:~# ls -la /tmp/test/\r\ntotal 8\r\ndrwxr-xr-x  2 root root 4096 Jul  5 16:40 .\r\ndrwxrwxrwt 11 root root 4096 Jul  5 16:41 ..\r\nroot@dev01.l:~# while true ; do ls -l /tmp/test/ | grep test ; done\r\n-rw------- 1 root root 6 Jul  5 16:41 test20180705-24634-jluwct\r\n{code}\r\n*output when file exists with correct permissions*\r\n{code:bash}root@dev01.l:~# ls -la /tmp/test/test\r\n-rw-r--r-- 1 jbond jbond 0 Jul  5 16:42 /tmp/test/test\r\nroot@dev:~# while true ; do ls -l /tmp/test/ | grep test | egrep -v ''test$''; done\r\n-rw------- 1 jbond jbond 6 Jul  5 16:43 test20180705-5929-sdmjsa\r\n {code}\r\n*output when file exists with correct incorrect permissions*\r\n{code:bash}root@dev~# chown nsd:nsd /tmp/test/test\r\nroot@dev:~# ls -la !$\r\nls -la /tmp/test/test\r\n-rw-r--r-- 1 nsd nsd 0 Jul  5 16:42 /tmp/test/test\r\nroot@dev:~# while true ; do ls -l /tmp/test/ | grep test | egrep -v ''test$''; done\r\n-rw------- 1 nsd nsd 6 Jul  5 16:43 test20180705-22012-13alhap\r\n{code}\r\nThis causes problems when the validate command drops previlages or needs to run as a specific user.  An example of this is  using `/usr/lib/quagga/bgpd` to validate quagga files.  The command by default drops privileges to the quagga user before reading the config file.  if the file is owned by anything other then quagga then the validate command fails.  \r\n\r\n \r\n\r\n* note the bgpd command does take a user parameter so you can run the tests as the root user.  however bgpd still drops privileges to the root user and when it does so it does so *without* `CAP_DAV_OVERRIDE`.  meaning that even the root user can only validate files owned by root\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8983', 'https://github.com/puppetlabs/puppet/pull/7469', '2018-07-05T09:55:54.000-0700', '2019-09-30T12:40:55.000-0700', '2019-09-30T12:40:55.000-0700', 'Resolved', 'resolved-issue-added', 5, '0', 2, 60, 15, 5, 'b1ad1bb1ba733d147d152d27a21f8ab9e0da3be8'),
('puppet', 178941, 284668092, 7545, 'Confine systemd provider to init system matching systemd', 'I''ve created a PR to allow systemd provider to work in a chrooted environment.\r\n\r\n/run/systemd/system does not exist when running Puppet in a chroot environment\r\n\r\nThe init executable (/proc/1/exe) should always point to something with systemd in the name, which would be safe to query\r\n\r\nhttps://github.com/puppetlabs/puppet/pull/5693', 'https://tickets.puppetlabs.com/browse/PUP-7312', 'https://github.com/puppetlabs/puppet/pull/7545', '2017-03-07T05:38:01.000-0800', '2019-10-03T04:19:07.000-0700', '2019-10-03T04:19:07.000-0700', 'Resolved', 'linux;resolved-issue-added;service;systemd;type_and_provider', 5, '0', 1, 3, 8, 1, 'a7b9d0e78787bb39d545c48afe32119e20d70dc8'),
('puppet', 229124, 303737922, 7652, 'Win-2012r2 FR Puppet Acceptance showing 4 test failures (localisation)', 'These errors were spotted when doing {{win-2012r2-fr-x86_64}} imaging acceptance testing.\r\n\r\nBuild Log is at: https://jenkins-imaging.delivery.puppetlabs.net/view/Win-vSphere/job/imaging_win-2012r2-fr_x86_64_vmware_vsphere.cygwin_acceptance_packer/12/consoleFull\r\n\r\nGist of build log is also saved at: https://gist.github.com/jcoconnor/f2392aeeb038c060d9c5e91f5cadd45c\r\n\r\n{noformat}\r\n01:36:50.996 Failed Tests Cases:\r\n01:36:50.996   Test Case tests/windows/eventlog.rb reported: #<Beaker::DSL::Outcomes::FailTest: \r\n01:36:50.996 Event not found in Application event log\r\n01:36:50.996 >\r\n01:36:50.996     Test line: tests/windows/eventlog.rb:35:in `block (3 levels) in run_test''\r\n01:36:50.997   Test Case tests/resource/group/should_query_all.rb reported: #<Beaker::DSL::Outcomes::FailTest: \r\n01:36:50.997 group Accès DCOM service de certificats found by puppet, not natively\r\n01:36:50.997 >\r\n01:36:50.997     Test line: tests/resource/group/should_query_all.rb:19:in `block (4 levels) in run_test''\r\n01:36:50.997   Test Case tests/resource/user/should_query_all.rb reported: #<Beaker::DSL::Outcomes::FailTest: \r\n01:36:50.997 user Invité found by puppet, not natively\r\n01:36:50.997 >\r\n01:36:50.997     Test line: tests/resource/user/should_query_all.rb:21:in `block (4 levels) in run_test''\r\n01:36:50.997 Errored Tests Cases:\r\n01:36:50.997   Test Case tests/face/parser_validate.rb reported: #<Beaker::Host::CommandFailure: Host ''m5a0caz1vz71n0h'' exited with 1 running:\r\n01:36:50.998  chown Administrator:Administrators C:/cygwin64/tmp/parser_validate.nBctlx/parser_validate.pp\r\n01:36:50.998 Last 10 lines of output were:\r\n01:36:50.998 	chown: invalid group: ''Administrator:Administrators''>\r\n01:36:50.998     Test line: tests/face/parser_validate.rb:30:in `block (4 levels) in run_test''\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8319', 'https://github.com/puppetlabs/puppet/pull/7652', '2018-01-05T02:57:29.000-0800', '2019-10-03T04:19:47.000-0700', '2019-10-03T04:19:47.000-0700', 'Resolved', 'Engineering-Initiative', 3, '0', 1, 8, 1, 5, '5d3ef531e54fbe6683440dccdd33f00880454854'),
('puppet', 303636, 300193017, 7626, 'Type package (provider yum) fails when handling kernel packages', '*Puppet Version:* \r\n\r\n4.10.4\r\n\r\n*Puppet Server Version:*\r\n\r\n3.6.2\r\n *OS Name/Version:*\r\n\r\nCentOS 7\r\n\r\n*Desired Behavior:*\r\n\r\n**Being able to handle yum packages that in the rare cases in which you can have *multiple versions* of a package *installed* without conflict (e.g., the kernel package)\r\n\r\n*Actual Behavior:*\r\n\r\nError: Could not update: Failed to update to version 3.10.0-957.10.1.el7.x86_64, got version 3.10.0-957.5.1.el7 instead\r\nError: /Stage[main]/Dap_pcappiper::Install/Package[kernel-devel]/ensure: change from 3.10.0-957.5.1.el7 to 3.10.0-957.10.1.el7.x86_64 failed: Could not update: Failed to update to version 3.10.0-957.10.1.el7.x86_64, got version 3.10.0-957.5.1.el7 instead\r\n\r\npackage {''kernel-devel'':\r\n ensure => ''3.10.0-957.10.1.el7.x86_64'',\r\n}\r\n\r\n \r\n\r\nWhen running i debug mode I can see the following command\r\n\r\n/bin/rpm -q kernel-devel --nosignature --nodigest --qf ''%\{NAME} %|EPOCH?\{%{EPOCH}}:\{0}| %\{VERSION} %\{RELEASE} %\{ARCH}\n''\r\n\r\nAnd if I run that I get\r\n\r\nsudo /bin/rpm -q kernel-devel --nosignature --nodigest --qf ''%\{NAME} %|EPOCH?\{%{EPOCH}}:\{0}| %\{VERSION} %\{RELEASE} %\{ARCH}\n''\r\nkernel-devel 0 3.10.0 957.5.1.el7 x86_64\r\nkernel-devel 0 3.10.0 957.10.1.el7 x86_64\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9605', 'https://github.com/puppetlabs/puppet/pull/7626', '2019-04-08T01:38:23.000-0700', '2019-10-03T04:21:14.000-0700', '2019-10-03T04:21:14.000-0700', 'Resolved', 'needs_repro;resolved-issue-added', 2, '0', 1, 300, 35, 9, '5af5f9dab8318969ff14c85fe219711035777794'),
('puppet', 310253, 294620700, 7604, 'Regression: File mode changed on every puppet run', '*Puppet Version: 5.5.14, 5.5.10*\r\n *Puppet Server Version: 5.3.8*\r\n *OS Name/Version: Windows 10 / 1809*\r\n\r\nFile modes are applied on every puppet run at least if files reside in special folders like "Program Files" and "Windows". This was working in *5.5.1*\r\n\r\nReproducible: Always, see example below\r\n\r\n*Desired Behavior:*\r\n\r\nFile modes are not changed\r\n\r\n*Actual Behavior:*\r\n\r\nFile modes are changed with every run ({{mode changed ''2000644'' to ''0644''}})\r\n\r\n*Example*\r\n\r\n \r\n{code:java}C:\Users\administrator>cacls C:\Windows\system32\puppet_facter_pci.ids.gz\r\nC:\Windows\system32\puppet_facter_pci.ids.gz APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(OI)(CI)(special access:)\r\n                                                                                                            READ_CONTROL\r\n                                                                                                            FILE_READ_DATA\r\n                                                                                                            FILE_READ_EA\r\n                                                                                                            FILE_WRITE_EA                                             APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(CI)(IO)(special access:)\r\n                                                                                                            GENERIC_READ                                             BUILTIN\Administrators:(special access:)\r\n                                                                    STANDARD_RIGHTS_ALL\r\n                                                                    DELETE\r\n                                                                    READ_CONTROL\r\n                                                                    WRITE_DAC\r\n                                                                    WRITE_OWNER\r\n                                                                    SYNCHRONIZE\r\n                                                                    STANDARD_RIGHTS_REQUIRED\r\n                                                                    FILE_GENERIC_READ\r\n                                                                    FILE_GENERIC_WRITE\r\n                                                                    FILE_READ_DATA\r\n                                                                    FILE_WRITE_DATA\r\n                                                                    FILE_APPEND_DATA\r\n                                                                    FILE_READ_EA\r\n                                                                    FILE_WRITE_EA\r\n                                                                    FILE_READ_ATTRIBUTES\r\n                                                                    FILE_WRITE_ATTRIBUTES                                             MBOX\Domain Admins:(special access:)\r\n                                                                READ_CONTROL\r\n                                                                SYNCHRONIZE\r\n                                                                FILE_GENERIC_READ\r\n                                                                FILE_READ_DATA\r\n                                                                FILE_READ_EA\r\n                                                                FILE_READ_ATTRIBUTES                                             Everyone:(special access:)\r\n                                                      READ_CONTROL\r\n                                                      SYNCHRONIZE\r\n                                                      FILE_GENERIC_READ\r\n                                                      FILE_READ_DATA\r\n                                                      FILE_READ_EA\r\n                                                      FILE_READ_ATTRIBUTES                                             NT AUTHORITY\SYSTEM:F\r\n\r\nC:\Users\administrator>puppet apply -e "file { ''C:\Windows\system32\puppet_facter_pci.ids.gz'': mode => ''0644''}"\r\nNotice: Compiled catalog for host in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/File[C:\Windows\system32\puppet_facter_pci.ids.gz]/mode: mode changed ''2000644'' to ''0644''\r\nNotice: Applied catalog in 0.77 secondsC:\Users\administrator>cacls C:\Windows\system32\puppet_facter_pci.ids.gz\r\nC:\Windows\system32\puppet_facter_pci.ids.gz APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(OI)(CI)(special access:)\r\n                                                                                                            READ_CONTROL\r\n                                                                                                            FILE_READ_DATA\r\n                                                                                                            FILE_READ_EA\r\n                                                                                                            FILE_WRITE_EA                                             APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(CI)(IO)(special access:)\r\n                                                                                                            GENERIC_READ                                             BUILTIN\Administrators:(special access:)\r\n                                                                    STANDARD_RIGHTS_ALL\r\n                                                                    DELETE\r\n                                                                    READ_CONTROL\r\n                                                                    WRITE_DAC\r\n                                                                    WRITE_OWNER\r\n                                                                    SYNCHRONIZE\r\n                                                                    STANDARD_RIGHTS_REQUIRED\r\n                                                                    FILE_GENERIC_READ\r\n                                                                    FILE_GENERIC_WRITE\r\n                                                                    FILE_READ_DATA\r\n                                                                    FILE_WRITE_DATA\r\n                                                                    FILE_APPEND_DATA\r\n                                                                    FILE_READ_EA\r\n                                                                    FILE_WRITE_EA\r\n                                                                    FILE_READ_ATTRIBUTES\r\n                                                                    FILE_WRITE_ATTRIBUTES                                             MBOX\Domain Admins:(special access:)\r\n                                                                READ_CONTROL\r\n                                                                SYNCHRONIZE\r\n                                                                FILE_GENERIC_READ\r\n                                                                FILE_READ_DATA\r\n                                                                FILE_READ_EA\r\n                                                                FILE_READ_ATTRIBUTES                                             Everyone:(special access:)\r\n                                                      READ_CONTROL\r\n                                                      SYNCHRONIZE\r\n                                                      FILE_GENERIC_READ\r\n                                                      FILE_READ_DATA\r\n                                                      FILE_READ_EA\r\n                                                      FILE_READ_ATTRIBUTES                                             NT AUTHORITY\SYSTEM:F\r\n\r\nC:\Users\administrator>puppet apply -e "file { ''C:\Windows\system32\puppet_facter_pci.ids.gz'': mode => ''0644''}"\r\nNotice: Compiled catalog for host in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/File[C:\Windows\system32\puppet_facter_pci.ids.gz]/mode: mode changed ''2000644'' to ''0644''\r\nNotice: Applied catalog in 0.75 seconds\r\n\r\n{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9722', 'https://github.com/puppetlabs/puppet/pull/7604', '2019-05-27T09:56:43.000-0700', '2019-10-03T04:21:40.000-0700', '2019-10-03T04:21:40.000-0700', 'Resolved', 'resolved-issue-added', 1, '0', 1, 31, 0, 3, 'dbc09041afd2b34d6f0962efbf7828b82e0620b8'),
('puppet', 318202, 301401729, 7640, 'New installers no longer needs puppetres.dll ', 'Following [PA-2701|https://tickets.puppetlabs.com/browse/PA-2701], puppet agent no longer uses puppetres.dll as the EventMessageFile, so puppetres.dll should not be installed on versions containing this fix.\r\n\r\nTo be merged together with [PA-2701|https://tickets.puppetlabs.com/browse/PA-2701].', 'https://tickets.puppetlabs.com/browse/PUP-9928', 'https://github.com/puppetlabs/puppet/pull/7640', '2019-07-26T02:28:10.000-0700', '2019-10-03T04:24:27.000-0700', '2019-10-03T04:24:27.000-0700', 'Resolved', '', 1, '0', 1, 3, 71, 4, '13e30256d7d00c55986a9288caf025d2757738c2'),
('puppet', 322037, 311219422, 7688, 'Can''t create users using useradd provider when specifying uid since 6.8.0', '*Puppet Version: 6.8.0*\r\n *Puppet Server Version: 6.4.0*\r\n *OS Name/Version: Ubuntu 18.04*\r\n\r\nCreating a user specifying the UID (uses useradd provider automatically):\r\n{code:puppet}user { ''test'':   ...   uid => 123,}\r\n{code}\r\n*Desired Behavior:*\r\n\r\nUser is created with uid 123.\r\n\r\n*Actual Behavior:*\r\n\r\n{{Error: Could not create user test1: Execution of ''[redacted]'' returned 1: Error: Could not execute posix command: no implicit conversion of Integer into String}}\r\n\r\nDebugging showed the command as:\r\n\r\n{{["/usr/sbin/useradd", "-c", "Test1", "-g", "users", "-d", "/home/test1", "-p", "removed", "-s", "/bin/tcsh", "-u", 123, "-m", "test1"]}}\r\n\r\nSo I''m assuming the 123 argument there should be quoted.\r\n\r\nSuspect this is to do with this change, but can''t see why:\r\n\r\n[https://github.com/puppetlabs/puppet/commit/70d20329012fc986c3d130f5769cc644f248c1b0#diff-f5b9cc80dd02278d845d220721ac0217]', 'https://tickets.puppetlabs.com/browse/PUP-9973', 'https://github.com/puppetlabs/puppet/pull/7688', '2019-08-22T14:35:02.000-0700', '2019-10-03T13:57:59.000-0700', '2019-10-03T13:57:59.000-0700', 'Resolved', 'resolved-issue-added', 7, '0', 1, 32, 4, 2, '76852e0a41fd764d03cfb09aa68a34340faf9684'),
('puppet', 327890, 325932586, 7774, 'Exec resources fail if the working directory is inaccessible', '*Puppet Version:* 6.8.1\r\n *Puppet Server Version:* 6.5.0\r\n *OS Name/Version:* CentOS 7\r\n\r\nExec resources fail unnecessarily when the working directory from which the ''agent'' or ''apply'' face is launched does not exist or is inaccessible to puppet. Additionally, in the event that the working directory exists but is inaccessible to the process, the diagnostic emitted incorrectly reports that the directory does not exist.\r\n\r\nI typically observe this on machines where my home directory is NFS-mounted, such that it is inaccessible to the local root account. With that as my working directory, I {{sudo}} a privileged shell in which to run the Puppet agent, but catalog application fails on account of errors from multiple {{Exec}} resources. Changing directory to a root-accessible one allows catalog application to succeed. In at least some cases, the command being executed is insensitive to the accessibility of the working directory, so there''s no particular reason that the {{Exec}} should fail.\r\n\r\n*Desired Behavior:*\r\n\r\n{{Exec}} resources should not automatically fail on account of a missing or inaccessible working directory, unless a specific working directory is requested via the {{cwd}} parameter.\r\n\r\nPuppet, generally, should not rely on the working directory being accessible except where it actually needs to access it for some configuration-, face-, or catalog-specific reason.\r\n\r\n*Actual Behavior:*\r\n\r\n{{Exec}} resources with no {{cwd}} specified fail spuriously when Puppet''s working directory cannot be accessed, even when execution of the command does not depend on accessing that directory. The specific failure mode seems to depend on details of the situation, but the one I normally run into can be reproduced with {{puppet apply}}, too, like so:\r\n----\r\n*Example 1*\r\n\r\n1. log in to a machine on which my home directory is on an automounted NFS file system with root squashing in effect\r\n 2. {{sudo bash}} to obtain a root shell\r\n 3. Execute\r\n{code:shell}puppet apply --execute "exec { ''/bin/echo'': }"{code}\r\n*_Output:_*\r\n{quote}Notice: Compiled catalog for xxx.yyy.zzz in environment production in 0.04 seconds\r\n Error: Working directory /mnt/auto/home/a_group/jbolling does not exist!\r\n Error: /Stage[main]/Main/Exec[/bin/echo]/returns: change from ''notrun'' to [''0''] failed: Working directory /mnt/auto/home/miller2grp/jbolling does not exist!\r\n Notice: Applied catalog in 0.12 seconds\r\n{quote}\r\n----\r\nErrors of the same form are also reported by the agent under these circumstances if the catalog being applied contains `Exec` resources without {{cwd}} parameters. On the other hand, these particular failures do not occur if the {{Exec}} in question has a {{cwd}} parameter designating an existing, accessible directory, notwithstanding that the Puppet process''s own working directory is inaccessible to it.\r\n\r\nOddly enough, a different failure occurs if Puppet''s working directory actually doesn''t exist. That situation can be reproduced like so:\r\n----\r\n*Example 2*\r\n\r\n1. Create a fresh directory for the experiment: {{mkdir doomed}}.\r\n 2. Make that directory the working directory: {{cd doomed}}.\r\n 3. In a separate shell, remove the directory: {{rm doomed}}.\r\n 4. In the first shell, run any Puppet command at all, for example\r\n{code:shell}puppet agent --test{code}\r\nor\r\n{code:shell}puppet apply --execute "exec { ''/bin/echo'': cwd => ''/tmp'' }"{code}\r\n.\r\n\r\n*_Output_*\r\n{quote}shell-init: error retrieving current directory: getcwd: cannot access parent directories: No such file or directory\r\n terminate called after throwing an instance of ''boost::filesystem::filesystem_error''\r\n what(): boost::filesystem::current_path: No such file or directory\r\n Aborted\r\n{quote}\r\n----\r\nAs described in conjunction with Example 1, however, Puppet does not actually need to access the current working directory to compile or apply a catalog, at least not as a general rule, so this failure is spurious.\r\n\r\nOf course, these issues can be worked around by ensuring that the working directory is an existing, accessible one before running Puppet, and I imagine that both failure scenarios presented are unlikely for most people. However, I personally hit the Example 1 case often enough to inspire me to file this report. I note also that it''s distinctly more annoying when it occurs as a result of {{puppet agent --test}} ing a catalog that takes a minute to retrieve and a few minutes to apply, and there is some risk that such a failure leaves the system in an unexpected state requiring manual intervention.', 'https://tickets.puppetlabs.com/browse/PUP-10080', 'https://github.com/puppetlabs/puppet/pull/7774', '2019-10-03T08:15:12.000-0700', '2019-10-09T06:32:53.000-0700', '2019-10-09T06:32:53.000-0700', 'Closed', '', 13, '0', 1, 5, 1, 1, ''),
('puppet', 313276, 290026883, 7587, 'Unintentional secret reveal while installing modules ', '*Puppet Version:* any\r\n *Puppet Server Version:* any\r\n *OS Name/Version:* any\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet Forge is public, and downloading modules don''t require authentication. However there are some repositories that can hold modules and require authentication to connect.\r\n\r\nThose repositories are:\r\n * [Artifactory|https://www.jfrog.com/confluence/display/RTF/Puppet+Repositories] (live)\r\n * [Nexus|https://github.com/wavesoftware/nexus-repository-puppet] (emerging)\r\n\r\nWhen installing modules from those repositories user is forced to set his credentials in plain text in URI supported form, for ex.:\r\n{noformat}https://admin:s3creT@pkg.acmecorp.com/repository/puppet{noformat}\r\nInstalling modules with similar module repository being set, reveals those credentials. In fact it''s done each time a module is installed, with a message:\r\n{noformat}Notice: Preparing to install into /home/jdoe/.puppetlabs/etc/code/modules ...\r\nNotice: Downloading from https://jdoe:s3creT@pkg.acmecorp.com/repository/puppet ...\r\n{noformat}\r\n*Desired Behavior:*\r\n\r\nPuppet should mask password if given, like this:\r\n{noformat}Notice: Preparing to install into /home/jdoe/.puppetlabs/etc/code/modules ...\r\nNotice: Downloading from https://jdoe:***@pkg.acmecorp.com/repository/puppet ...\r\n{noformat}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9787', 'https://github.com/puppetlabs/puppet/pull/7587', '2019-06-19T15:45:49.000-0700', '2019-10-10T08:45:23.000-0700', '2019-10-10T08:45:23.000-0700', 'Resolved', 'resolved-issue-added', 5, '0', 1, 70, 1, 3, '11b70c584e4e26e09ec4558cd58ae61e8d1e1a76'),
('puppet', 141117, 101395735, 5502, 'exec resources leak the command string when execution fails', 'If an exec is run as an inline sh script with an eyaml''d password variable, the password will get logged in plaintext on the console and agent if it fails. loglevel and logoutput don''t do anything in this situation, as it''s the command that''s being displayed, not the output of the command. It was suggested to make the command into a script and run it that way, but that presents putting the password plaintext in the script, not a viable long-term solution.\r\n\r\nHaving the exec''s inline sh script executed in this manner presents another issue. The same data is present in the cached catalog on agents in /opt/puppetlabs/puppet/cache/client_data/catalog/*.json. I imagine this issue is caught somewhere in https://tickets.puppetlabs.com/browse/PUP-1974.\r\n\r\nJust an idea to branch off of the "sensitive" resource type mentioned in PUP-1974: Most passwords and sensitve data will be coming from an eyaml''d variable(at least, in our scenario). If there were a setting in puppet.conf that would mark all eyaml data as "sensitive", hashing or masking it in logs and cached catalogs, that might take care of the lion''s share of sensitive information leaks. This would be in addition to being able "to give manifest/module authors the ability to specify resource properties (such as attributes or titles) which are sensitive".', 'https://tickets.puppetlabs.com/browse/PUP-6494', 'https://github.com/puppetlabs/puppet/pull/5502', '2016-07-12T09:19:56.000-0700', '2019-10-15T09:55:08.000-0700', '2019-10-15T09:55:08.000-0700', 'Closed', 'secrets', 22, '0', 1, 86, 13, 6, 'e1dd130100316f7fcaf7f2dc095f6b50c98cc6be'),
('puppet', 188237, 165263981, 6578, '"Successful" puppet agent reports hide provider errors', 'It''s possible to get a successful agent run report that on closer inspection include errors.\r\n\r\nFor instance, an error points to a failure with the Chocolatey provider. Because the provider failed out, it did not return a complete list of resources to manage, and the agent run completes successfully on this smaller catalog without raising an alarm.\r\n\r\nThere is no way for an administrator to notice this problem and correct it without drilling down into green agent reports to confirm whether an error has occurred or not. On large scale deployments this solution rapidly becomes unmanageable.\r\n\r\nAgent runs need to return some condition when providers fail that highlights that this has occurred. There needs to be a scaleable way to monitor and report on this kind of failure.\r\n\r\nPlease add all errors and warnings for consideration as failed run status assignment criteria [here|https://docs.google.com/document/d/1PKLzYYPyPVt0pKS4Fc6r-1BbDAfK8eFOmTICcgT5gQ4/edit?usp=sharing].', 'https://tickets.puppetlabs.com/browse/PUP-7630', 'https://github.com/puppetlabs/puppet/pull/6578', '2017-04-27T12:08:17.000-0700', '2019-10-21T07:47:00.000-0700', '2019-10-21T07:47:00.000-0700', 'Closed', '', 22, '0', 1, 129, 14, 2, '4d48014dacf89305b4d273a5e2ae984155a09ca2'),
('puppet', 182344, 158212242, 6448, 'FileBucket should use `Puppet::Util::replace_file` to write contents', 'Per feedback on PR for PUP-1334, https://github.com/puppetlabs/puppet/pull/5704, it would be ideal to use {{Puppet::Util::replace_file}} to write the contents file instead of {{Puppet::FileSystem::open}}.\r\n\r\nDue to PUP-7394 and PUP-7395 doing so at the time of filing this ticket was not optimal, but once those are addressed this change should be made.\r\n\r\nSee https://github.com/MosesMendoza/puppet/commit/9f1bf4b3a186942439f41a282c57823bae4af5a2 for an implementation', 'https://tickets.puppetlabs.com/browse/PUP-7397', 'https://github.com/puppetlabs/puppet/pull/6448', '2017-03-23T14:44:34.000-0700', '2019-10-21T07:47:10.000-0700', '2019-10-21T07:47:10.000-0700', 'Closed', '', 5, '0', 3, 79, 48, 6, '8ae474b1291566335d9c6f1ef6600399ac368a48'),
('puppet', 249624, 186629987, 6822, 'Numeric(''0'') raises an error', 'The {{Numeric}} data type when given the string "0" will fail because it attempts to look at the second char in the string - if it is a downcased ''b'' or ''x'' - and this fails since there is nothing to downcase.', 'https://tickets.puppetlabs.com/browse/PUP-8703', 'https://github.com/puppetlabs/puppet/pull/6822', '2018-05-08T06:02:30.000-0700', '2019-10-21T07:47:39.000-0700', '2019-10-21T07:47:39.000-0700', 'Closed', '', 1, '0', 1, 9, 4, 2, '363b5c70afec4a3b2d669a7b22f17c99065a5a84'),
('puppet', 249032, 186008489, 6817, 'Comparison of Numeric to Timestamp/Timespan fails, but other way is ok', 'When comparing Numeric to Timestamp or Timespan it does not work to compare with the Numeric value first:\r\n\r\n{code:puppet}\r\n1 < Timespan(2)\r\n1 < Timestamp(2)\r\n{code}\r\nbut works in reverse\r\n{code:puppet}\r\nTimespan(2) > 1\r\nTimestamp(2) > 1\r\n{code}\r\n\r\nIt should work both ways.', 'https://tickets.puppetlabs.com/browse/PUP-8694', 'https://github.com/puppetlabs/puppet/pull/6817', '2018-05-03T03:14:40.000-0700', '2019-10-21T07:47:47.000-0700', '2019-10-21T07:47:47.000-0700', 'Closed', '', 2, '0', 14, 1336, 1, 17, '0a67d07f8fbe40fd089970aaefbb94b729fd8e83'),
('puppet', 188415, 160817321, 6486, 'Agent sends wrong content-type when using http file sources', 'Error when running a Puppet agent run:\r\n\r\n{code}\r\nfile {''C:\temp\example.msi'':\r\n  ensure  => present,\r\n  source => ''http://foo.example.com/example.msi'',\r\n}\r\n{code}\r\n\r\nThe file was hosted on an IIS server, and gave this error when run:\r\n\r\n{code}\r\nError: Could not set ''file'' on ensure: Error 406 on SERVER: <!DOCTYPE html PUBLI\r\nC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-str\r\nict.dtd">\r\n<html xmlns="http://www.w3.org/1999/xhtml">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>\r\n<title>406 - Client browser does not accept the MIME type of the requested page.\r\n</title>\r\n<style type="text/css">\r\n<!--\r\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;b\r\nackground:#EEEEEE;}\r\nfieldset{padding:0 15px 10px 15px;}\r\nh1{font-size:2.4em;margin:0;color:#FFF;}\r\nh2{font-size:1.7em;margin:0;color:#CC0000;}\r\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;}\r\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS\r\n", Verdana, sans-serif;color:#FFF;\r\nbackground-color:#555555;}\r\n#content{margin:0 0 0 2%;position:relative;}\r\n.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;positio\r\nn:relative;}\r\n-->\r\n</style>\r\n</head>\r\n<body>\r\n<div id="header"><h1>Server Error</h1></div>\r\n<div id="content">\r\n<div class="content-container"><fieldset>\r\n  <h2>406 - Client browser does not accept the MIME type of the requested page.<\r\n/h2>\r\n  <h3>The page you are looking for cannot be opened by your browser because it h\r\nas a file name extension that your browser does not accept.</h3>\r\n</fieldset></div>\r\n</div>\r\n</body>\r\n</html>\r\nat /etc/puppetlabs/code/environments/production/modules/profiles/manifests/msi_download.pp:7\r\nError: Could not set ''file'' on ensure: Error 406 on SERVER: <!DOCTYPE html PUBLI\r\nC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-str\r\nict.dtd">\r\n<html xmlns="http://www.w3.org/1999/xhtml">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>\r\n<title>406 - Client browser does not accept the MIME type of the requested page.\r\n</title>\r\n<style type="text/css">\r\n<!--\r\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;b\r\nackground:#EEEEEE;}\r\nfieldset{padding:0 15px 10px 15px;}\r\nh1{font-size:2.4em;margin:0;color:#FFF;}\r\nh2{font-size:1.7em;margin:0;color:#CC0000;}\r\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;}\r\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS\r\n", Verdana, sans-serif;color:#FFF;\r\nbackground-color:#555555;}\r\n#content{margin:0 0 0 2%;position:relative;}\r\n.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;positio\r\nn:relative;}\r\n-->\r\n</style>\r\n</head>\r\n<body>\r\n<div id="header"><h1>Server Error</h1></div>\r\n<div id="content">\r\n<div class="content-container"><fieldset>\r\n  <h2>406 - Client browser does not accept the MIME type of the requested page.<\r\n/h2>\r\n  <h3>The page you are looking for cannot be opened by your browser because it h\r\nas a file name extension that your browser does not accept.</h3>\r\n</fieldset></div>\r\n</div>\r\n</body>\r\n</html>\r\nat /etc/puppetlabs/code/environments/production/modules/profiles/manifests/msi_download.pp:7\r\nWrapped exception:\r\nError 406 on SERVER: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "h\r\nttp://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\r\n<html xmlns="http://www.w3.org/1999/xhtml">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>\r\n<title>406 - Client browser does not accept the MIME type of the requested page.\r\n</title>\r\n<style type="text/css">\r\n<!--\r\nbody{margin:0;font-size:.7em;font-family:Verdana, Arial, Helvetica, sans-serif;b\r\nackground:#EEEEEE;}\r\nfieldset{padding:0 15px 10px 15px;}\r\nh1{font-size:2.4em;margin:0;color:#FFF;}\r\nh2{font-size:1.7em;margin:0;color:#CC0000;}\r\nh3{font-size:1.2em;margin:10px 0 0 0;color:#000000;}\r\n#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:"trebuchet MS\r\n", Verdana, sans-serif;color:#FFF;\r\nbackground-color:#555555;}\r\n#content{margin:0 0 0 2%;position:relative;}\r\n.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;positio\r\nn:relative;}\r\n-->\r\n</style>\r\n</head>\r\n<body>\r\n<div id="header"><h1>Server Error</h1></div>\r\n<div id="content">\r\n<div class="content-container"><fieldset>\r\n  <h2>406 - Client browser does not accept the MIME type of the requested page.<\r\n/h2>\r\n  <h3>The page you are looking for cannot be opened by your browser because it h\r\nas a file name extension that your browser does not accept.</h3>\r\n</fieldset></div>\r\n</div>\r\n</body>\r\n</html>\r\n{code}\r\n\r\nSame code ran fine when running with puppet apply\r\n\r\nhttps://support.microsoft.com/en-us/help/942050/error-message-when-you-visit-a-web-site-that-is-hosted-on-a-server-that-is-running-internet-information-services-7.0-http-error-406---not-acceptable\r\n\r\nWorkaround was to use the remote_file module in the mean time', 'https://tickets.puppetlabs.com/browse/PUP-7482', 'https://github.com/puppetlabs/puppet/pull/6486', '2017-04-28T11:05:46.000-0700', '2019-10-21T07:49:03.000-0700', '2019-10-21T07:49:03.000-0700', 'Closed', 'Windows', 12, '0', 2, 51, 6, 2, 'a5f9d59943620c1ea2f20592a40003e5186a1281'),
('puppet', 182335, 0, 0, 'Puppet::Util.replace_file cannot be used to create a read-only file (on non-Windows)', 'Assuming a file does not yet exist, a call to {{FileUtils.replace_file}} like the following will fail:\r\n\r\n{code}\r\nPuppet::Util.replace_file(''/tmp/foo'', 0440) { |of| FileUtils.copy_stream(StringIO.new("\u1234"), of) }\r\n{code}\r\n\r\nWith an error like:\r\n\r\n{code}\r\nErrno::EACCES: Permission denied @ rb_sysopen - /tmp/foo20170323-24678-rg0fn9\r\nfrom /usr/local/opt/rbenv/versions/2.1.9/lib/ruby/2.1.0/fileutils.rb:494:in `initialize''\r\n{code}\r\n\r\nThis is because the {{replace_file}} code will use permissions of an existing file should it exist, but will try to {{chmod}} a file **before** yielding it back in the block if it does not yet exist.  Therefore it is impossible to create a new read-only file like you might normally with Ruby itself like:\r\n\r\n{code}\r\nFile.open(''/tmp/foo.txt'', ''w+'', 0440) { |fh| fh.write(''hello world'') }\r\n# => 11\r\n{code}\r\n\r\nAlso note that the code path on Windows is slightly different and does not exhibit the same problem.', 'https://tickets.puppetlabs.com/browse/PUP-7394', 'https://github.com/puppetlabs/puppet/commit/6507fb866081f8a1789e25b380adb16dd2f8ade7', '2017-03-23T14:09:03.000-0700', '2019-10-21T07:49:11.000-0700', '2019-10-21T07:49:11.000-0700', 'Closed', '', 3, '0', 0, 0, 0, 0, '6507fb866081f8a1789e25b380adb16dd2f8ade7'),
('puppet', 224387, 155278399, 6396, 'The Variant type without any types matches in strange ways', 'The {{Variant}} type when used as just {{Variant}} (no list of types) has an implementation that uses {{all?}} to check if all types in a RHS variant can be assigned to the LHS type. This fails when the RHS Variant is empty.\r\n\r\nAn empty {{Variant}} should only be assignable from a {{Variant}} as the only meaningful interpretation of a {{Variant}} without any types to perform an OR matching operation on is that it means "all types that are actually {{Variant}}".\r\n\r\nIf an empty {{Variant}} was to be interpreted as {{Variant\[Any}}}, then it is essentially the same as {{Any}}, and that is surprising.\r\n\r\nIf it was to be an error to use {{Variant}} as an expression, we need to change the entire implementation how parameterized types are formed using the AST. (It has one expression that evaluates to the base {{Variant}} type, followed by an "at" expression {{\[T1, T2,...]}} that constrains/widens/defines the type instance that will be created.\r\n\r\nWhen fixing this, there are numerous tests that include the {{Variant}} in the list of "all types", and this change will require a special section of tests for the {{Variant}} type.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8212', 'https://github.com/puppetlabs/puppet/pull/6396', '2017-11-28T07:23:14.000-0800', '2019-10-21T07:49:41.000-0700', '2019-10-21T07:49:41.000-0700', 'Closed', '', 3, '0', 1, 74, 5, 3, 'ca1417784959f56bef97dccff96a5dabec9eb045'),
('puppet', 230110, 163385244, 6542, 'When enforcing String data type for a class param, a regex data type does not raise an error.', 'When enforcing a String data type for a class parameter:\r\n\r\n{code:puppet}\r\nclass test::myclass(String $my_string = ''default'') { \r\n  notify { "notice ${my_string}": }\r\n}\r\n{code}\r\n\r\nIf you provide a Regex data type, no exception is raised:\r\n\r\n{code:puppet}\r\nclass { ''test::myclass'':\r\n  my_string => /my_regex/\r\n}\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8343', 'https://github.com/puppetlabs/puppet/pull/6542', '2018-01-11T09:00:17.000-0800', '2019-10-21T07:50:45.000-0700', '2019-10-21T07:50:45.000-0700', 'Closed', '', 1, '0', 4, 25, 4, 3, 'deb02d249767276628c5918d4c3d4d3225780d89'),
('puppet', 230042, 162261252, 6510, 'Add transaction_completed to schema', 'Forked off of PUP-8288 to track adding the transaction_completed flag to the report schema for serialization/deserialization.  Broken out into a separate ticket targeted at master branch to minimize impact to our LTS release at 4.10.x, which the flag/partial fix was added to.', 'https://tickets.puppetlabs.com/browse/PUP-8342', 'https://github.com/puppetlabs/puppet/pull/6510', '2018-01-10T15:14:20.000-0800', '2019-10-21T07:50:53.000-0700', '2019-10-21T07:50:53.000-0700', 'Closed', '', 4, '0', 1, 13, 3, 4, '8d9df399356fae8d5d0e667e0d14031470c3a799'),
('puppet', 228387, 163566982, 6548, 'Puppet webrick no longer functions in Ruby 2.3.6/2.4.3 and up', '*Puppet Version:*  4.10.8\r\n*OS Name/Version:* FreeBSD 11.1-RELEASE (Affects Linux as well), with OpenSSL 1.0.2k\r\n\r\nWhen Launching the puppetmaster rc.d script on FreeBSD, which uses $Puppet_Location/puppet/network/http/webrick.rb, webrick fails to accept SSL/TLS connections, due to a change upstream in Ruby.\r\n\r\nhttps://bugs.ruby-lang.org/issues/14005\r\n\r\nThe issue occurs in webrick.rb, supplied by puppet.\r\nwebrick.rb:32 {\r\nsock.accept\r\n}\r\nDue to the changes in Ruby, this should read:\r\nsock.accept_nonblock\r\n\r\nTo reproduce, run a webrick puppetmaster with Ruby 2.3.6 or newer on any OS using OpenSSL.\r\n\r\n*Desired Behavior:*\r\nWebrick puppetmaster does the needful \r\n\r\n*Actual Behavior:*\r\nWebrick puppetmaster outputs the following to logs:\r\n[2017-12-25 21:30:26] ERROR OpenSSL::SSL::SSLError: SSL_accept returned=1 errno=0 state=SSLv3 read client hello B: unexpected record\r\n        /usr/local/lib/ruby/site_ruby/2.3/puppet/network/http/webrick.rb:32:in `accept''\r\n        /usr/local/lib/ruby/site_ruby/2.3/puppet/network/http/webrick.rb:32:in `block (2 levels) in listen''\r\n        /usr/local/lib/ruby/2.3/webrick/server.rb:314:in `block in start_thread''\r\n\r\nand the following on the client:\r\nError: /File[/var/puppet/lib]: Failed to generate additional resources using ''eval_generate'': SSL_read: decryption failed or bad record mac                               \r\n\r\n--\r\nI am aware webrick is being deprecated, however it is still in use currently.\r\nI have filed a separate bug with FreeBSD to change the default puppet pkg to use sysutils/puppetserver from the ports system.\r\nhttps://bugs.freebsd.org/bugzilla/show_bug.cgi?id=224623\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8297', 'https://github.com/puppetlabs/puppet/pull/6548', '2017-12-28T02:23:51.000-0800', '2019-10-21T07:51:19.000-0700', '2019-10-21T07:51:19.000-0700', 'Closed', '', 6, '0', 2, 17, 26, 2, '59e0a22b996a090fe511c9cccb92da1cbf65b62e'),
('puppet', 228279, 160828449, 6487, 'Bad Markdown in ''unique'' function breaks Strings-generated reference', '*Puppet Version:* 5.3.3\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* N/A\r\n\r\nThe Puppet Strings-generated docs for the [{{unique}} function|https://puppet.com/docs/puppet/5.3/function_strings_prefer_v4.html#unique] include a Markdown error resulting in a broken codeblock and formatting.\r\n\r\n*Desired Behavior:*\r\n\r\nThe formatting is correct and the page renders correctly on the docs site.\r\n\r\n*Actual Behavior:*\r\n\r\nThe formatting is wrong and the page renders incorrectly on the docs site.', 'https://tickets.puppetlabs.com/browse/PUP-8292', 'https://github.com/puppetlabs/puppet/pull/6487', '2017-12-22T11:50:18.000-0800', '2019-10-21T07:51:26.000-0700', '2019-10-21T07:51:26.000-0700', 'Closed', '', 0, '0', 1, 1, 1, 1, '793c47bda85bf05c916c08b87db821b802ca7f68'),
('puppet', 227615, 159647899, 6469, 'PAL task_signature adds ''default'' to some type descriptions', 'Using {{bolt task show}} on the following metadata file results in some strange artifacts\r\n{code}\r\n{\r\n  "description": "Do a thing.",\r\n  "parameters": {\r\n    "foo": {\r\n      "description": "The foo",\r\n      "type": "String[1]"\r\n    }\r\n  }\r\n}\r\n{code}\r\n\r\nresults in\r\n\r\n{code}\r\nPARAMETERS:\r\n- foo: String[1, default]\r\n    The foo\r\n{code}\r\n\r\nI''m not sure where {{default}} is coming from. It doesn''t seem to happen in all the examples I try however.', 'https://tickets.puppetlabs.com/browse/PUP-8270', 'https://github.com/puppetlabs/puppet/pull/6469', '2017-12-20T10:46:28.000-0800', '2019-10-21T07:51:43.000-0700', '2019-10-21T07:51:43.000-0700', 'Closed', '', 3, '0', 1, 17, 11, 4, '938fc7829990a781cd10960dd6f0d27b80f8c346'),
('puppet', 243167, 178114657, 6769, 'PuppetStack.stacktrace is slow with a large stack', 'Several places in Puppet call {{PuppetStack.stacktrace[0]}} to get their "caller". Most notably, log messages where the "source" is a Scope object _without_ an associated resource use that method to determine the "source" to log from. There are also some Puppet functions that use it (empty, create_resource, and more).\r\n\r\nThose calls become quite slow (I saw up to 50ms) when the stack is large. While it''s probably uncommon for the stack to grow that deep, _no_ caller currently uses anything but the top element of the stack, which means this is a straightforward opportunity for improvement.\r\n\r\nIt probably makes sense to either make that method lazy, which is a bit of a challenge as it''s both a filter and a map, or to add a method that specifically returns the top element of the stack, which satisfies every current caller.', 'https://tickets.puppetlabs.com/browse/PUP-8610', 'https://github.com/puppetlabs/puppet/pull/6769', '2018-03-27T12:09:29.000-0700', '2019-10-21T07:52:04.000-0700', '2019-10-21T07:52:04.000-0700', 'Closed', '', 2, '0', 1, 73, 71, 13, '28569888c84526dfb362f1a73d503096f14e3abb'),
('puppet', 240172, 173967053, 6724, 'Lexer errors with non existing Issues::HEREDOC_MISSING_ENDTAG', 'Given an expression such as:\r\n{code:puppet}\r\n@("")\r\nThis is heredoc $text\r\n|-END\r\n{code}\r\nthe lexer attempts to error with {{Issues::HEREDOC_MISSING_ENDTAG}}. Since there''s no such issue, this instead results in a {{NameError}}. The correct issue to use here, given that there''s no actual tag, would be {{Issues::HEREDOC_EMPTY_TAG}}.', 'https://tickets.puppetlabs.com/browse/PUP-8519', 'https://github.com/puppetlabs/puppet/pull/6724', '2018-03-08T00:43:23.000-0800', '2019-10-21T07:53:29.000-0700', '2019-10-21T07:53:29.000-0700', 'Closed', '', 1, '0', 1, 14, 1, 3, '8df9e0c1e29251c99fa3b6133a0e80cebb77a73f'),
('puppet', 237580, 171820374, 6689, 'selinux types are being set on every run', '*Puppet Version: 5.4.0*\r\n *Puppet Server Version:*\r\n *OS Name/Version: RHEL 7.4*\r\n\r\nThe handling of selinux file parameters seems to have changed between 5.3.5 and 5.4.0.  Specifically, we are managing some .k5login files as type ''krb5_home_t'':\r\n\r\n{code:puppet}\r\n  file { "${basedir}/${name}/.k5login": seltype => ''krb5_home_t'' }\r\n{code}\r\n\r\nAs of when we upgraded to v5.4.0, puppet has been trying to reset the parameters every run, e.g.:\r\n\r\n{noformat}\r\nFeb 20 15:16:50 XXXX04 puppet-agent[99767]: (/Stage[main]/P_puppet_server::\r\nAutomation::User/K5login[/var/lib/foo/.k5login]/seluser) seluser changed  to ''user_u''\r\nFeb 20 15:16:50 XXXX04 puppet-agent[99767]: (/Stage[main]/P_puppet_server::\r\nAutomation::User/K5login[/var/lib/foo/.k5login]/selrole) selrole changed  to ''object_r''\r\nFeb 20 15:16:50 XXXX04 puppet-agent[99767]: (/Stage[main]/P_puppet_server::\r\nAutomation::User/K5login[/var/lib/foo/.k5login]/seltype) seltype changed  to ''krb5_home_t''\r\nFeb 20 15:16:50 XXXX04 puppet-agent[99767]: (/Stage[main]/P_puppet_server::\r\nAutomation::User/K5login[/var/lib/foo/.k5login]/selrange) selrange changed  to ''s0''\r\n{noformat}\r\n\r\nDowngrading to 5.3.5 reverts the behavior - e.g. the values are no longer updated every run.\r\n\r\nNote that selinux is off on these hosts anyway.\r\n\r\n*Desired Behavior:  don''t change every run*\r\n\r\n*Actual Behavior:  tries to change every run*', 'https://tickets.puppetlabs.com/browse/PUP-8477', 'https://github.com/puppetlabs/puppet/pull/6689', '2018-02-20T13:31:39.000-0800', '2019-10-21T07:54:49.000-0700', '2019-10-21T07:54:49.000-0700', 'Closed', 'regression', 10, '0', 2, 110, 65, 3, '5ec1c670de80ecd6295ddf0763cd26f8076a7908'),
('puppet', 237172, 170283843, 6654, 'fqdn_rand should use md5 on non-fips enabled hosts', 'Puppet 5.4''s {{fqdn_rand}} function produces a different value than earlier versions for the same set of inputs. \r\n\r\n{noformat}\r\n$ bx puppet apply -e ''$value = fqdn_rand(30); notice("$puppetversion: $value")''\r\nNotice: Scope(Class[main]): 5.4.0: 22\r\nNotice: Compiled catalog for r1nc1m63jxi6u3e.delivery.puppetlabs.net in environment production in 0.04 seconds\r\n{noformat}\r\n\r\n{noformat}\r\n$ bx puppet apply -e ''$value = fqdn_rand(30); notice("$puppetversion: $value")''\r\nNotice: Scope(Class[main]): 5.3.5: 5\r\nNotice: Compiled catalog for r1nc1m63jxi6u3e.delivery.puppetlabs.net in environment production in 0.03 seconds\r\n{noformat}\r\n\r\nThis is a problem because the values are often written into service configuration files. When they change, services get notified and restart.\r\n\r\nWe should restore the previous {{fqdn_rand}} behavior of calculating its seed value using MD5 when running on a non-FIPS enabled master. FIPS enabled masters should continue using SHA256.', 'https://tickets.puppetlabs.com/browse/PUP-8469', 'https://github.com/puppetlabs/puppet/pull/6654', '2018-02-16T11:51:10.000-0800', '2019-10-21T07:54:56.000-0700', '2019-10-21T07:54:56.000-0700', 'Closed', '', 4, '0', 1, 39, 4, 2, '56ddf57d776c610cfe56a97ec99ea92cfa0ed94c'),
('puppet', 236125, 168365185, 6627, '"puppet cert clean" only works if at least one cert has already been signed', 'PUP-1916 added the ability to clean certificates that have not yet been signed, without having to manually sign/revoke them first. However, this only works if there is at least one signed certificate in the list of certificate names passed to "puppet cert clean".', 'https://tickets.puppetlabs.com/browse/PUP-8448', 'https://github.com/puppetlabs/puppet/pull/6627', '2018-02-09T15:03:03.000-0800', '2019-10-21T07:55:04.000-0700', '2019-10-21T07:55:04.000-0700', 'Closed', '', 3, '0', 2, 18, 4, 2, '21f42f05c19c522aa93acece7abfa68fdc38b638'),
('puppet', 235785, 167919964, 6622, 'Default upper limit of Timestamp and Timespan data types is incorrectly set equal to lower limit', 'The data types {{Float}}, {{Integer}}, {{Timespan}}, and {{Timestamp}} in the Puppet type system can be specified with a lower and upper limit using the syntax {{T[min, max]}}. When using just one argument, {{T[x]}} the  {{Float}} and {{Integer}} will interpret this as {{T[x, <no limit>]}} whereas {{Timespan}} and {{Timestamp}} interprets it as {{T[x,x]}}. The latter interpretation is incorrect. {{Timespan}} and {{Timestamp}} must be changed to use the same semantics as {{Float}} and {{Integer}}.', 'https://tickets.puppetlabs.com/browse/PUP-8439', 'https://github.com/puppetlabs/puppet/pull/6622', '2018-02-08T00:57:57.000-0800', '2019-10-21T07:56:40.000-0700', '2019-10-21T07:56:40.000-0700', 'Closed', '', 2, '0', 2, 22, 12, 4, '1dce68320379a8dc46b5e249fb4faadf6be28dd2'),
('puppet', 235706, 168094385, 6624, 'puppet should only ignore pot files when syncing locales', '*Puppet Version: 5.3.4*\r\n *Puppet Server Version: n/a*\r\n *OS Name/Version:*\r\n\r\n*Desired Behavior:*\r\n\r\nPuppet should only ignore {{*.pot}} files when syncing {{locales}}, but not for {{plugins}} or {{pluginfacts}}.\r\n\r\n*Actual Behavior:*\r\n\r\nThe default {{pluginsignore}} applies to all plugin related requests. We should instead exclude {{*.pot}} files in the same way we do for {{config.yaml}}, in the locales-specific downloader.\r\n\r\nIf you create an executable script named {{my.pot}} in the {{facts.d}} directory of a module, the agent won''t download the file. On master:\r\n\r\n{noformat}\r\n$ echo <<END > ~/.puppetlabs/etc/code/environments/production/modules/acl/facts.d/my.pot\r\nheredoc> #!/bin/sh\r\nheredoc> echo "foo=bar"\r\nheredoc> END\r\n$ chmod a+x  ~/.puppetlabs/etc/code/environments/production/modules/acl/facts.d/my.pot\r\n{noformat}\r\n\r\nOn agent, the file isn''t downloaded:\r\n\r\n{noformat}\r\n$ bx puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\n...\r\n$ find  ~/.puppetlabs/opt/puppet/cache/facts.d\r\n/Users/josh/.puppetlabs/opt/puppet/cache/facts.d\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8436', 'https://github.com/puppetlabs/puppet/pull/6624', '2018-02-07T11:45:26.000-0800', '2019-10-21T07:56:54.000-0700', '2019-10-21T07:56:54.000-0700', 'Closed', '', 3, '0', 1, 3, 3, 3, '714feb0ab76026de0601147ff1465d09a9be0370'),
('puppet', 234032, 167539239, 6608, 'Puppet config print lists invalid value for environment_timeout when set to unlimited', 'When running {{puppet config print --all}} on the command line with {{environment_timeout}} set to {{unlimited}} in {{puppet.conf}}, the value for {{environment_timeout}} is listed as {{Infinity}}, which is not a valid setting (it can be a positive integer, 0, or `{{unlimited`}}). As a user if I saw this I would presume it was a valid setting.\r\n\r\nWhen I try using {{Infinity}} as a setting value for {{environment_timeout}}, I get a not so helpful error message and stack trace.\r\n{code}puppet apply --environment_timeout=Infinity -e "notify{''foo'':}"\r\n/Users/matthaus/src/puppet/lib/puppet/settings/ttl_setting.rb:43:in `munge'': Invalid ''time to live'' format ''"Infinity"'' for parameter: environment_timeout (Puppet::Settings::ValidationError)\r\n	from /Users/matthaus/src/puppet/lib/puppet/settings/ttl_setting.rb:25:in `munge''\r\n	from /Users/matthaus/src/puppet/lib/puppet/settings.rb:1310:in `interpolate''\r\n	from /Users/matthaus/src/puppet/lib/puppet/settings.rb:1082:in `value_sym''\r\n	from /Users/matthaus/src/puppet/lib/puppet/settings.rb:1054:in `value''\r\n	from /Users/matthaus/src/puppet/lib/puppet/settings/environment_conf.rb:87:in `environment_timeout''\r\n	from /Users/matthaus/src/puppet/lib/puppet/environments.rb:414:in `entry''\r\n	from /Users/matthaus/src/puppet/lib/puppet/environments.rb:345:in `get''\r\n	from /Users/matthaus/src/puppet/lib/puppet/util/autoload.rb:131:in `module_directories''\r\n	from /Users/matthaus/src/puppet/lib/puppet/util/autoload.rb:166:in `search_directories''\r\n	from /Users/matthaus/src/puppet/lib/puppet/util/autoload.rb:100:in `files_to_load''\r\n	from /Users/matthaus/src/puppet/lib/puppet/util/autoload.rb:220:in `files_to_load''\r\n	from /Users/matthaus/src/puppet/lib/puppet/application.rb:212:in `available_application_names''\r\n	from /Users/matthaus/src/puppet/lib/puppet/util/command_line.rb:90:in `find_subcommand''\r\n	from /Users/matthaus/src/puppet/lib/puppet/util/command_line.rb:73:in `execute''\r\n	from /usr/bin/puppet:5:in `<main>''\r\n{code}\r\nThe simple reproducer here is:\r\n{code}puppet config print --environment_timeout=unlimited environment_timeout\r\nInfinity\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8409', 'https://github.com/puppetlabs/puppet/pull/6608', '2018-01-30T16:53:26.000-0800', '2019-10-21T07:57:20.000-0700', '2019-10-21T07:57:20.000-0700', 'Closed', '', 6, '0', 1, 73, 21, 8, '131ca5619e456d4ca81bdd4e7a57d1114850e458'),
('puppet', 232984, 165105563, 6572, 'Standard Array conversions do not work on return value from tree_each function', 'I am trying to see what the {{tree_each}} function actually produces, to see how I could use it for complex tree transformations.\r\n\r\nI went with the simplest approach first:\r\n{noformat}\r\n# t1.pp\r\n\r\n$hash = {\r\n  foo => bar,\r\n  baz => [\r\n    quux,\r\n    { whatsit => whosit }\r\n  ]\r\n}\r\n\r\n$tree = $hash.tree_each\r\n\r\n$tree_array = Array($tree)\r\nnotice(inline_template(''<% require "pp"; pp @tree_array %>''))\r\n{noformat}\r\nThe result was less than helpful:\r\n{noformat}\r\n$ puppet apply t1.pp\r\nError: Evaluation Error: Error while evaluating a Function Call, super: no superclass method `to_a'' for #<Puppet::Pops::Types::Iterable::DepthFirstTreeIterator:0x0000000314be98>\r\nDid you mean?  to_s at /home/vagrant/t1.pp:13:15 on node localhost\r\n{noformat}\r\n\r\nNext, I tried something [~henrik.lindberg] suggested:\r\n{noformat}\r\n# t2.pp\r\n\r\n$hash = {\r\n  foo => bar,\r\n  baz => [\r\n    quux,\r\n    { whatsit => whosit }\r\n  ]\r\n}\r\n\r\n$tree = $hash.tree_each\r\n\r\n$tree_array = *$tree\r\nnotice(inline_template(''<% require "pp"; pp @tree_array %>''))\r\n{noformat}\r\nThis gave me:\r\n{noformat}\r\n$ puppet apply t2.pp\r\n[#<Puppet::Pops::Types::Iterable::DepthFirstTreeIterator:0x000000043feea0\r\n  @containers_t=\r\n   #<Puppet::Pops::Types::PVariantType:0x00000003451598\r\n    @types=\r\n     [#<Puppet::Pops::Types::PArrayType:0x00000003211df0\r\n       @element_type=#<Puppet::Pops::Types::PAnyType:0x00000003204b00>,\r\n       @size_type=nil>,\r\n      #<Puppet::Pops::Types::PHashType:0x00000003211850\r\n       @key_type=#<Puppet::Pops::Types::PAnyType:0x00000003204b00>,\r\n       @size_type=nil,\r\n       @value_type=#<Puppet::Pops::Types::PAnyType:0x00000003204b00>>,\r\n      #<Puppet::Pops::Types::PObjectType:0x00000002c15de8\r\n       @annotations=nil,\r\n       @attributes={},\r\n       @checks=nil,\r\n       @equality=nil,\r\n       @equality_include_type=true,\r\n       @functions={},\r\n       @name=nil,\r\n       @parent=nil>]>,\r\n  @current_path=[],\r\n  @element_t=nil,\r\n  @include_refs=false,\r\n  @indexer_stack=[],\r\n  @recursed=false,\r\n  @root={"foo"=>"bar", "baz"=>["quux", {"whatsit"=>"whosit"}]},\r\n  @value_stack=[{"foo"=>"bar", "baz"=>["quux", {"whatsit"=>"whosit"}]}],\r\n  @with_containers=true,\r\n  @with_root=true,\r\n  @with_values=true>]\r\nNotice: Scope(Class[main]):\r\nNotice: Compiled catalog for localhost\r\n{noformat}\r\nAgain, not very useful.\r\n\r\nI tried passing the results of the {{*}} operator to the {{Array}} conversion...\r\n{noformat}\r\n# t3.pp\r\n\r\n$hash = {\r\n  foo => bar,\r\n  baz => [\r\n    quux,\r\n    { whatsit => whosit }\r\n  ]\r\n}\r\n\r\n$tree = $hash.tree_each\r\n\r\n$tree_array = Array(*$tree)\r\nnotice(inline_template(''<% require "pp"; pp @tree_array %>''))\r\n{noformat}\r\nand got the same as the first attempt:\r\n{noformat}\r\n$ puppet apply t3.pp\r\nError: Evaluation Error: Error while evaluating a Function Call, super: no superclass method `to_a'' for #<Puppet::Pops::Types::Iterable::DepthFirstTreeIterator:0x00000004b52878>\r\nDid you mean?  to_s at /home/vagrant/t3.pp:13:15 on node localhost\r\n{noformat}\r\n\r\nFinally, I used a {{map}} to convert it to itself:\r\n{noformat}\r\n# t4.pp\r\n\r\n$hash = {\r\n  foo => bar,\r\n  baz => [\r\n    quux,\r\n    { whatsit => whosit }\r\n  ]\r\n}\r\n\r\n$tree = $hash.tree_each\r\n\r\n$tree_array = $tree.map |$idx,$val| { [ $idx, $val ] }\r\nnotice(inline_template(''<% require "pp"; pp @tree_array %>''))\r\n{noformat}\r\nand this gave something useful:\r\n{noformat}\r\n$ puppet apply t4.pp\r\n[[0, [[], {"foo"=>"bar", "baz"=>["quux", {"whatsit"=>"whosit"}]}]],\r\n [1, [["foo"], "bar"]],\r\n [2, [["baz"], ["quux", {"whatsit"=>"whosit"}]]],\r\n [3, [["baz", 0], "quux"]],\r\n [4, [["baz", 1], {"whatsit"=>"whosit"}]],\r\n [5, [["baz", 1, "whatsit"], "whosit"]]]\r\nNotice: Scope(Class[main]):\r\nNotice: Compiled catalog for localhost\r\n{noformat}\r\n\r\n[~henrik.lindberg] told me to submit a ticket, so here I am. :)', 'https://tickets.puppetlabs.com/browse/PUP-8393', 'https://github.com/puppetlabs/puppet/pull/6572', '2018-01-24T16:54:27.000-0800', '2019-10-21T07:57:52.000-0700', '2019-10-21T07:57:52.000-0700', 'Closed', '', 3, '0', 1, 55, 2, 3, '8e4016335bc7862d98730d95069ea6ea850cca91'),
('puppet', 244183, 179394895, 6776, 'Remove deprecation of empty(undef) introduced in PUP-8492', 'In PUP-8492 the empty function was moved from stdlib to puppet and it introduced a deprecation of calling {{empty(undef)}}. As discussed in PUP-8492, that deprecation is not wanted and it should be removed.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8623', 'https://github.com/puppetlabs/puppet/pull/6776', '2018-04-04T06:34:05.000-0700', '2019-10-21T07:59:58.000-0700', '2019-10-21T07:59:58.000-0700', 'Closed', '', 1, '0', 1, 2, 3, 2, '6103aadbe1232b8a37dccb5824358921a97f8c52'),
('puppet', 324178, 315993539, 7706, 'Systemd provider is not correctly selected as the service provider if puppet is run as non root', '*Puppet Version: 6.8.1*\r\n\r\nIt seems that this change breaks a few things when Puppet is not being run as root, for example during spec tests (i.e. pdk test unit).\r\n\r\nAt least under Ubuntu 16.04 and 18.04 the file /proc/1/exe is not accessible by regular users, so Puppet::FileSystem.exist?(''/proc/1/exe'') returns false and Puppet::FileSystem.readlink(''/proc/1/exe'').include?(''systemd'') fails with Errno::EACCES. ls also fails, obviously:\r\n\r\n{code}\r\n\r\n$ ls /proc/1/exe\r\nls: cannot read symbolic link ''/proc/1/exe'': Permission denied\r\nlrwxrwxrwx 1 root root 0 Sep  7 00:13 /proc/1/exe\r\nThis has interesting implications in that now Puppet no longer recognizes that systemd is the correct service provider for recent Debian and Ubuntu releases. Thus spec tests for services fail with cryptic error messages like this:\r\n{code}\r\n\r\n\r\n\r\n{code}\r\n$ pdk test unit\r\n...\r\nfailed: rspec: ./spec/classes/service_spec.rb:9: Could not find the daemon directory (tested [/etc/sv,/var/lib/service])\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10016', 'https://github.com/puppetlabs/puppet/pull/7706', '2019-09-10T06:16:31.000-0700', '2019-10-29T07:06:20.000-0700', '2019-10-29T07:06:20.000-0700', 'Closed', 'resolved-issue-added', 10, '0', 1, 8, 7, 2, '93ca5f0ea2b99e8c7a1b5619fa02a6c56f202b33'),
('puppet', 305737, 273312363, 7494, 'Run rspec tests against ruby 2.6 or latest', 'Update travis and appveyor to test against ruby latest which is now ruby 2.6.3.', 'https://tickets.puppetlabs.com/browse/PUP-9650', 'https://github.com/puppetlabs/puppet/pull/7494', '2019-04-22T10:05:50.000-0700', '2019-11-12T17:07:27.000-0800', '2019-11-12T17:07:27.000-0800', 'Resolved', '', 2, '0', 4, 16, 6, 7, '6affa6e5337051fd063def0c0149a782f22106ca'),
('puppet', 330903, 336528943, 7810, 'no_proxy does not exclude hosts whose FQDN matches based on suffix', '*Puppet Version: 5.5.17*\r\n *Puppet Server Version: 5.3.10*\r\n *OS Name/Version: CentOS 7*\r\n\r\n*Original Summary* Since update to puppet 5.5.17 puppetdb forge module cannot connect to puppetdb\r\n\r\nSince the update to puppet agent 5.5.17 the puppetdb forge module is using the configured proxy server and ignoring the no_proxy setting when trying to validate the connection to puppetdb.  This worked properly on 5.5.16. \r\n\r\nMy environment proxy settings are:\r\n\r\n{noformat}\r\nhttp_proxy=http://ottinstall.ls.cbn:3128\r\nftp_proxy=http://ottinstall.ls.cbn:3128\r\nhttps_proxy=http://ottinstall.ls.cbn:3128\r\nno_proxy=ls.cbn, localhost, puppet, 127.0.0.1\r\n{noformat}\r\n\r\nMy puppetdb server is: {{https://glycon.ls.cbn:8081}}\r\n\r\n*Desired Behavior:* \r\n\r\nRespect the no_proxy value {{ls.cbn}} and not proxy connections to {{https://glycon.ls.cbn:8018}}\r\n\r\n*Actual Behavior:*\r\n\r\n{noformat}\r\nopening connection to ottinstall.ls.cbn:3128...\r\nopened\r\n<- "CONNECT glycon.ls.cbn:8081 HTTP/1.1\r\nHost: glycon.ls.cbn:8081\r\n\r\n"\r\n-> "HTTP/1.1 403 Forbidden\r\n"\r\n-> "Server: squid/3.5.20\r\n"\r\n-> "Mime-Version: 1.0\r\n"\r\n-> "Date: Sat, 19 Oct 2019 18:46:40 GMT\r\n"\r\n-> "Content-Type: text/html;charset=utf-8\r\n"\r\n-> "Content-Length: 3448\r\n"\r\n-> "X-Squid-Error: ERR_ACCESS_DENIED 0\r\n"\r\n-> "Vary: Accept-Language\r\n"\r\n-> "Content-Language: en\r\n"\r\n-> "X-Cache: MISS from ottinstall.ls.cbn\r\n"\r\n-> "X-Cache-Lookup: NONE from ottinstall.ls.cbn:80\r\n"\r\n-> "Via: 1.1 ottinstall.ls.cbn (squid/3.5.20)\r\n"\r\n-> "Connection: keep-alive\r\n"\r\n-> "\r\n"\r\nConn close because of connect error 403 "Forbidden"\r\nNotice: Unable to connect to puppetdb server (https://glycon.ls.cbn:8081): 403 "Forbidden"\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10106', 'https://github.com/puppetlabs/puppet/pull/7810', '2019-10-19T11:52:20.000-0700', '2019-11-15T15:42:05.000-0800', '2019-11-15T15:42:05.000-0800', 'Resolved', 'resolved-issue-added', 6, '0', 2, 12, 13, 3, 'f316912f9b6b9dbb6fadd6a3a290feb644499eb4'),
('puppet', 329033, 328503519, 7784, 'Exec resource should not leak sensitive commands when a relative path is given', 'From: https://tickets.puppetlabs.com/browse/PUP-6494?focusedCommentId=692157&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-692157\r\n\r\n{code:puppet}\r\nexec { "echo_passphrase":\r\n command => Sensitive("echo \"${secretpw.unwrap}\""),\r\n}\r\n{code}\r\n\r\n{noformat}\r\nError: Failed to apply catalog: Validation of Exec[populate_luksfile] failed: ''echo "supersecretpassword"'' is not qualified and no path was specified. Please qualify the command or specify a path.\r\n{noformat}\r\n\r\nThe issue is the error message includes the entire command to execute, instead of the first component of command which wasn''t an absolute path.', 'https://tickets.puppetlabs.com/browse/PUP-10100', 'https://github.com/puppetlabs/puppet/pull/7784', '2019-10-11T09:56:14.000-0700', '2019-11-15T16:32:03.000-0800', '2019-11-15T16:32:03.000-0800', 'Resolved', 'resolved-issue-added', 5, '0', 3, 223, 16, 4, '8d3cdfe9deed1145a31e83fca759950a975ff359'),
('puppet', 325377, 324364068, 7763, 'skip_tags not documented for puppet agent', '*Puppet Version: 5.5.16*\r\n *Puppet Server Version: 5.5.16*\r\n *OS Name/Version: FreeBSD-12-RELEASE*\r\n\r\npuppet agent --help\r\n\r\n...\r\n''--tags'' allows you to specify what portions of a configuration you want\r\nto apply. Puppet elements are tagged with all of the class or definition\r\nnames that contain them, and you can use the ''tags'' flag to specify one\r\nof these names, causing only configuration elements contained within\r\nthat class or definition to be applied. This is very useful when you are\r\ntesting new configurations -- for instance, if you are just starting to\r\nmanage ''ntpd'', you would put all of the new elements into an ''ntpd''\r\nclass, and call puppet with ''--tags ntpd'', which would only apply that\r\nsmall portion of the configuration during your testing, rather than\r\napplying the whole thing.\r\n\r\n...\r\n\r\n*Desired Behavior:*\r\n\r\nAdd a section describing --skip_tags option.\r\n\r\n*Actual Behavior:*\r\n\r\nSee above\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10026', 'https://github.com/puppetlabs/puppet/pull/7763', '2019-09-19T05:42:37.000-0700', '2019-11-16T12:21:46.000-0800', '2019-11-16T12:21:46.000-0800', 'Resolved', 'beginner;resolved-issue-added', 4, '0', 1, 3, 0, 1, '360057b623adba05665b6401bcea2a80ebbbe69b'),
('puppet', 297090, 333393464, 7793, 'Puppet 3 API functions should be loaded from the pluginsync location as part of the cache system loader', '*Puppet Version:* 6.3.0\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* Windows 10 - 1803 Ruby 2.5\r\n\r\nDescribe your issue in as much detail as possible...\r\nDescribe steps to reproduce...\r\n\r\n*Desired Behavior:*\r\nPuppet 3 API functions that are plugin sync''d should be loaded from the cache libdir\r\n\r\n*Actual Behavior:*\r\nPuppet 3 API functions are missing\r\n\r\nPreviously in PUP-6964 (https://github.com/puppetlabs/puppet/pull/7019) the system loader was modified to to be able to load Puppet 3 API functions;\r\n\r\nof note - https://github.com/puppetlabs/puppet/pull/7019/files#diff-83a8daf215ff39828e0e3758c2e5a866R34\r\n\r\nSee how the system loader has loadables of {{[:func_4x, :func_3x, :datatype]}}\r\n\r\nHowever when the system cache loader was introduced in PUP-9035 (https://github.com/puppetlabs/puppet/commit/7404ee14745c78bd4a3173c79cac198809faea74 ) the loadables specified did not include the Puppet 3 API functions.\r\n\r\nof note - https://github.com/puppetlabs/puppet/pull/6963/files#diff-83a8daf215ff39828e0e3758c2e5a866R30\r\n\r\nSee how the cache loader has loadables of {{[:func_4x, :datatype]}}\r\n\r\nThe comment at https://github.com/puppetlabs/puppet/pull/6963/files#diff-83a8daf215ff39828e0e3758c2e5a866R22 says they should be the same but is clear they are not.\r\n\r\nAlso note that the acceptance tests do not test for this;\r\nhttps://github.com/puppetlabs/puppet/pull/6963/files#diff-d3791ca879b2c6c0586dd8974a7bec0eR25\r\n\r\nThat is just a Puppet 4 API location', 'https://tickets.puppetlabs.com/browse/PUP-9509', 'https://github.com/puppetlabs/puppet/pull/7793', '2019-02-22T01:08:29.000-0800', '2019-11-18T09:45:14.000-0800', '2019-11-18T09:45:14.000-0800', 'Resolved', 'resolved-issue-added', 4, '0', 1, 2, 4, 1, 'f87235c4f44d4bfe683c6389fdc890a2c6d3ab45'),
('puppet', 117135, 325963596, 7775, 'exec resources fail unless cwd is readable', 'The {{exec()}} resource always attempts to perform a {{chdir()}} to the current working directory (cwd). This is true regardless of the value of the {{cwd}} parameter.\r\n\r\nIf the cwd isn''t accessible by the user running Puppet, Puppet will fail to apply the {{exec()}} resource. This is true regardless of whether the command being executed actually requires the cwd to be readable.\r\n\r\nAn example:\r\n\r\n{noformat}\r\n$ cd /tmp\r\n$ mkdir test\r\n$ cd test\r\n$ chmod 0000 .\r\n\r\n$ puppet apply -e ''exec { "/bin/pwd": logoutput => true }''\r\nNotice: Compiled catalog for myhost.example.org in environment production in 0.05 seconds\r\nError: Permission denied @ dir_chdir - /tmp/test\r\nError: /Stage[main]/Main/Exec[/bin/pwd]/returns: change from notrun to 0 failed: Permission denied @ dir_chdir - /tmp/test\r\nNotice: Applied catalog in 0.04 seconds\r\n\r\n$ puppet apply -e ''exec { "/bin/pwd": logoutput => true, cwd => "/" }''\r\nNotice: Compiled catalog for myhost.example.org in environment production in 0.06 seconds\r\nError: Permission denied @ dir_chdir - /tmp/test\r\nError: /Stage[main]/Main/Exec[/bin/pwd]/returns: change from notrun to 0 failed: Permission denied @ dir_chdir - /tmp/test\r\nNotice: Applied catalog in 0.05 seconds\r\n{noformat}\r\n\r\nIf the cwd is accessible, the {{exec}} will succeed:\r\n\r\n{noformat}\r\n$ chmod 0755 .\r\n\r\n$ puppet apply -e ''exec { "/bin/pwd": logoutput => true }''\r\nNotice: Compiled catalog for myhost.example.org in environment production in 0.05 seconds\r\nNotice: /Stage[main]/Main/Exec[/bin/pwd]/returns: /tmp/test\r\nNotice: /Stage[main]/Main/Exec[/bin/pwd]/returns: executed successfully\r\nNotice: Applied catalog in 0.05 seconds\r\n\r\n{noformat}\r\n\r\nYou may be tempted to respond: "Why does this matter? It''s almost never useful to run Puppet as a non-root user, and the root user has implicit access to all files and directories."\r\n\r\nThe problem is that this is not true.\r\n\r\nAt our site, we are deploying NFSv4 user home directories, where home directories are mounted from an NFSv4 server with sec=krb5p (that is, with Kerberos security). In such a scenario, the root user always and implicit possesses host/hostname@DOMAIN credentials, and nothing more.\r\n\r\nUser home directories are private (mode 0700) by default. Effectively, this means that the root user is unable to {{chdir()}} to a user''s home directory, or any subdirectory thereof.\r\n\r\nAs we began to deploy NFSv4 user home directories, developers who run {{sudo puppet agent --test}} from the command line began reporting Puppet failures. Investigating the problems let us to discover the {{exec}} resource''s behavior of always attempting to {{chdir()}} to the cwd, regardless of what the {{cwd}} parameter is set to (or whether it''s defined at all).\r\n\r\nOur developers get hit by this because they are typically sitting in their (NFSv4-based) home directory when they attempt to run {{sudo puppet agent --test}}.\r\n\r\nI would argue that the {{exec}} resource should behave this way:\r\n\r\n# If the {{cwd}} parameter is defined, the {{exec}} resource attempts to {{chdir()}} to that directory, and _only_ that directory.\r\n# If the {{cwd}} parameter is undefined, the {{exec}} resource should not call {{chdir()}} at all.\r\n\r\nThe current behavior of the {{exec}} resource is at best extremely non-intuitive and at worst outright incorrect, even if it only causes problems when specific (and uncommon) conditions are met (i.e., root not having implicit access to the cwd).\r\n\r\nThoughts?', 'https://tickets.puppetlabs.com/browse/PUP-5915', 'https://github.com/puppetlabs/puppet/pull/7775', '2016-02-17T10:44:17.000-0800', '2019-11-18T10:28:27.000-0800', '2019-11-18T10:28:27.000-0800', 'Resolved', 'resolved-issue-added', 9, '0', 2, 21, 1, 2, 'f1b7230473c3e61fe0f988d3529554818cac9ad2'),
('puppet', 283215, 325547779, 7770, 'Notify resource exposes Sensitive data when message is a Sensitive data', '*Puppet Version: 6.0.2*\r\n *Puppet Server Version: 2019.0.0*\r\n *OS Name/Version: Mac OS X, also confirmed on Linux by customer*\r\n\r\nThe Notify{} resource will leak Sensitive data if the message is a raw value of Sensitive() type.\r\n\r\nIt looks like the Notify{} resource is mishandling the processing of the message parameter if the input is a raw Sensitive datatype (not encapsulated in double quotes).\r\n\r\n*Desired Behavior:*\r\n\r\nNo Sensitive data should be output in clear text.\r\n\r\n*Actual Behavior:*\r\n\r\nFor example, in the following code both message 1 and 2 leak sensitive data:\r\n{code:java}\r\n$secret = Sensitive(''s3cret'')\r\nnotify { ''Sensitive message 1'':\r\n message => $secret,\r\n}\r\nnotify { ''Sensitive message 2'':\r\n message => Sensitive(''s3cret2''),\r\n}\r\nnotify { ''Sensitive message 3'':\r\n message => "${secret}",\r\n}\r\n{code}\r\nOutput:\r\n{noformat}\r\nNotice: Compiled catalog for kevin.reeuwijk-c02tp0a7g8wl in environment production in 0.03 seconds\r\nNotice: s3cret\r\nNotice: /Stage[main]/Main/Notify[Sensitive message 1]/message: changed [redacted] to [redacted]\r\nNotice: s3cret2\r\nNotice: /Stage[main]/Main/Notify[Sensitive message 2]/message: changed [redacted] to [redacted]\r\nNotice: Sensitive [value redacted]\r\nNotice: /Stage[main]/Main/Notify[Sensitive message 3]/message: defined ''message'' as ''Sensitive [value redacted]''\r\nNotice: Applied catalog in 0.02 seconds{noformat}\r\nThere are two messages in the output that should not appear:\r\n\r\n \r\n{noformat}\r\nNotice: s3cret\r\nNotice: s3cret2\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9295', 'https://github.com/puppetlabs/puppet/pull/7770', '2018-10-31T08:09:01.000-0700', '2019-11-19T09:16:33.000-0800', '2019-11-19T09:16:33.000-0800', 'Resolved', 'resolved-issue-added', 14, '0', 1, 2, 2, 1, '3270a6e31fe26f1be12499d6f096b1b1fb859dc0'),
('puppet', 332037, 332273097, 7791, 'no_proxy config setting is ignored when http_proxy environment variable is set', 'If a host matches the {{no_proxy}} exception list set in the environment or puppet.conf, then ruby may decide to use the proxy due to the way that Puppet creates the Net::HTTP object. See PUP-9990 for more details.', 'https://tickets.puppetlabs.com/browse/PUP-10112', 'https://github.com/puppetlabs/puppet/pull/7791', '2019-10-24T15:14:33.000-0700', '2019-11-19T09:17:24.000-0800', '2019-11-19T09:17:24.000-0800', 'Resolved', 'resolved-issue-added', 4, '0', 3, 100, 11, 4, '87a8824279937f5fb77c51ad27694aa29f26eaac'),
('puppet', 55473, 218861623, 7126, 'Systemd provider doesn''t scan for changed units', 'When a package updates it''s sysvinit script or systemd unit (or for that matter if I were to be manually managing a systemd unit with a file resource), nothing ever tells systemd to check for changed units. \r\n\r\nTypically you would invoke `systemctl daemon-reload` to scan for new and changed units. \r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3483', 'https://github.com/puppetlabs/puppet/pull/7126', '2014-10-17T09:32:32.000-0700', '2019-11-19T16:08:18.000-0800', '2019-11-19T16:08:18.000-0800', 'Closed', 'community;resolved-issue-added;systemd;type_and_provider', 26, '0', 1, 38, 1, 2, 'f8d5c60ddb130c6429ff12736bfdb4ae669a9fd4'),
('puppet', 175424, 334530033, 7798, 'systemd service provider missing double dash', 'The systemd service provider doesn''t use double dashes for ending options, meaning that it will fail on any service with a name beginning with a {{-}} (dash):\r\n\r\n{noformat}\r\n13:52:54 runejuhl@tolu:~\r\n$ /opt/puppetlabs/bin/puppet --version\r\n4.9.2\r\n13:53:00 runejuhl@tolu:~ \r\n$ /opt/puppetlabs/bin/puppet apply -e "service { ''-h-asd'': enable=>true}" | head\r\nNotice: Compiled catalog for tolu.petardo.dk in environment production in 0.27 seconds\r\nsystemctl [OPTIONS...] {COMMAND} ...\r\n\r\nQuery or send control commands to the systemd manager.\r\n\r\n  -h --help           Show this help\r\n     --version        Show package version\r\n     --system         Connect to system manager\r\n     --user           Connect to user service manager\r\n  -H --host=[USER@]HOST\r\nError: Failed to apply catalog: Broken pipe @ io_write - <STDOUT>\r\n{noformat}\r\n\r\nUnits starting with {{-}} are fairly common in systemd, e.g. the {{\-.mount}} unit.\r\n\r\nFor a quick fix, it looks like changing https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/service/systemd.rb#L47 like this would work (albeit only when enabling/disabling):\r\n\r\n{noformat}\r\n- output = systemctl(action, @resource[:name])\r\n+ output = systemctl(action, ''--'', @resource[:name])\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7218', 'https://github.com/puppetlabs/puppet/pull/7798', '2017-02-14T04:55:59.000-0800', '2019-11-19T16:08:18.000-0800', '2019-11-19T16:08:18.000-0800', 'Resolved', 'beginner;linux;provider;resolved-issue-added;service;systemd;type_and_provider', 3, '0', 1, 28, 28, 2, 'fd2fd497b0ccbae1249118876665aca16e8ccea3'),
('puppet', 329426, 338755750, 7816, 'puppet device fails when using csr_attributes.yaml', 'Whilst trying to use trusted facts for my puppet device, I noticed the `puppet device --target devicename` fail with the error "OBJ_txt2obj: first num too large". However, manually requesting the cert with `puppet ssl` does work and behaves as expected. Guessing it''s related to [PUP-9746|https://tickets.puppetlabs.com/browse/PUP-9746], or at least a similar issue.\r\n\r\n*Desired Behavior:* First `puppet device` run should request a cert with correct extension requests\r\n\r\n*Actual Behavior:* First `puppet device` run fails with "Cannot create CSR with extension request extension_name: OBJ_txt2obj: first num too large"', 'https://tickets.puppetlabs.com/browse/PUP-10104', 'https://github.com/puppetlabs/puppet/pull/7816', '2019-10-15T03:07:56.000-0700', '2019-11-21T01:58:01.000-0800', '2019-11-21T01:58:01.000-0800', 'Closed', 'beginner;resolved-issue-added', 6, '0', 1, 9, 0, 2, '8dc3df8a69dc03eaef80a96d650b2a574f48a14b'),
('puppet', 333915, 341123414, 7844, 'Could not request certificate', '*Puppet Version: 5.5.17*\r\n *Puppet Server Version: 5.3.6*\r\n *OS Name/Version: RHEL 7.7*\r\n\r\nI am migrating RHEL servers from RHS 5 to 6. Everything is working properly, except for requesting Puppet Certificate. After editing my puppet.conf on my client, and do a puppet agent -t for example, I have error "Error: Could not request certificate: wrong number of arguments (given 1, expected 2)".\r\n\r\n*Desired Behavior: Get an actual certificate request*\r\n\r\n*Actual Behavior: Got the error "Error: Could not request certificate: wrong number of arguments (given 1, expected 2)".*\r\n\r\n \r\n\r\nDebug: Selected server from the ca_server setting: [RHS URL]\r\nDebug: Selected port from the ca_port setting: 8140\r\nDebug: Creating new connection for [RHS URL]:8140\r\nError: Could not request certificate: wrong number of arguments (given 1, expected 2)\r\n/opt/puppetlabs/puppet/lib/ruby/2.4.0/net/http/exceptions.rb:6:in `initialize''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:322:in `new''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:322:in `rescue in execute_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:306:in `execute_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:186:in `block (2 levels) in do_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:332:in `block in with_connection''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/nocache_pool.rb:15:in `with_connection''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:331:in `with_connection''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:183:in `block in do_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:180:in `upto''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:180:in `do_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/connection.rb:80:in `get''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:160:in `http_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:139:in `http_get''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:174:in `block in find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:263:in `block in do_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/request.rb:231:in `do_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:263:in `do_request''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/rest.rb:167:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/certificate/rest.rb:12:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:198:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/host.rb:201:in `certificate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/host.rb:329:in `wait_for_cert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:483:in `wait_for_certificates''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:349:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:375:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:667:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:375:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:139:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10121', 'https://github.com/puppetlabs/puppet/pull/7844', '2019-11-07T06:21:13.000-0800', '2019-11-22T08:09:49.000-0800', '2019-11-22T08:09:49.000-0800', 'Resolved', 'resolved-issue-added', 7, '0', 1, 36, 12, 2, '57534ad0134cfd51b9074a6e75ee9df50f362f60'),
('puppet', 242078, 176882971, 6759, 'Augeas unable to handle escaped quotes within quotes', '*Puppet Version: 5.4.0*\r\n *Puppet Server Version: 5.2.0*\r\n *OS Name/Version: CentOS 7.4.1708*\r\n\r\nI am unable to find a way to set the "log_format" variable in nginx.conf using augeas. The problem seems to be the combination of quotes within quotes just doesn''t seem to be possible.\r\n\r\nThe desired value I am trying to set exactly is:\r\n{noformat}timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_time $upstream_response_time $pipe''{noformat}\r\nTake careful note that I need to have the long single quoted string, but that this contains some double quoted strings. I have tried every possible combination I can think of for enclosing in single or double quoted strings in and for escaping then, but I have not successfully managed to set exactly what is required. I have tried so many different possible ways over the last 2 days that I am now convinced I haven''t missed something and that this has to be a bug.\r\n\r\nTo describe some of the more obvious steps I have tried, lets store the initial variables like as following:\r\n{code:puppet}\r\n#The log title:\r\n$log_title = ''timed_combined''\r\n\r\n#Set-up the needed log_format string:\r\n$log_format_str = ''$remote_addr - $remote_user $http_x_unit_id [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_time $upstream_response_time $pipe''\r\n{code}\r\nThe initial most logical combination of options that I have tried are (elaborated here to try and make it clear):\r\n\r\n*Attempt 1*\r\nEscape the double quotes within the substring, then pass the variable in augeas with escaped quotes:\r\n{code:puppet}\r\n# Create the combined string\r\n$use_log_format = regsubst("${log_title} ''${log_format_str}''", ''"'', ''\\"'', ''G'')\r\n\r\naugeas { ''set-up_log_format'':\r\n    context => "/files${conf_file}/http",\r\n    changes => [\r\n        "set log_format \"${use_log_format}\""\r\n    ]\r\n}\r\n{code}\r\nProduces:\r\n{noformat}\r\n-    log_format  main  ''$remote_addr - $remote_user [$time_local] "$request" ''\r\n-                      ''$status $body_bytes_sent "$http_referer" ''\r\n-                      ''"$http_user_agent" "$http_x_forwarded_for"'';\r\n+    log_format  timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\" $request_time $upstream_response_time $pipe'';\r\n{noformat}\r\n*Result:* Produces almost exactly what I want, but unfortunately the escapes have been passed through and retained. The result is confirmed when grep''ing the file:\r\n{noformat}\r\nroot@devsvr2 ~]# grep log_format /etc/nginx/nginx.conf\r\n    log_format  timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\" $request_time $upstream_response_time $pipe'';\r\n{noformat}\r\nMaybe I do not need the escapes? Let''s try without...\r\n\r\n*Attempt 2*\r\nDon''t escape the double quotes within the substring, but still pass the variable in augeas with escaped quotes:\r\n{code:puppet}\r\n# Create the combined string\r\n$use_log_format = "${log_title} ''${log_format_str}''"\r\n\r\naugeas { ''set-up_log_format'':\r\n    context => "/files${conf_file}/http",\r\n    changes => [\r\n        "set log_format \"${use_log_format}\""\r\n    ]\r\n}\r\n{code}\r\nProduces:\r\n{noformat}\r\n-    log_format  main  ''$remote_addr - $remote_user [$time_local] "$request" ''\r\n-                      ''$status $body_bytes_sent "$http_referer" ''\r\n-                      ''"$http_user_agent" "$http_x_forwarded_for"'';\r\n+    log_format  timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] ;\r\n{noformat}\r\n*Result:* As you might expect, the unescaped quotes cause the value to be truncated completely. How about we wrap it in single quotes in the augeas command instead? Let''s try it...\r\n\r\n*Attempt 3*\r\nSingle quotes in the augeas command instead of the escaped doubles:\r\n{code:puppet}\r\n# Create the combined string\r\n$use_log_format = "${log_title} ''${log_format_str}''"\r\n\r\naugeas { ''set-up_log_format'':\r\n    context => "/files${conf_file}/http",\r\n    changes => [\r\n        "set log_format ''${use_log_format}''"\r\n    ]\r\n}\r\n{code}\r\nProduces:\r\n{noformat}\r\n-    log_format  main  ''$remote_addr - $remote_user [$time_local] "$request" ''\r\n-                      ''$status $body_bytes_sent "$http_referer" ''\r\n-                      ''"$http_user_agent" "$http_x_forwarded_for"'';\r\n+    log_format  timed_combined  ;\r\n{noformat}\r\n*Result:* Now we''ve lost the value altogether. Maybe I''d better escape those single quotes in the string too...\r\n\r\n*Attempt 4*\r\n*Single quotes in the augeas command, but add escapes to the single quotes that define the substring in the variable*\r\n{code:puppet}\r\n# Create the combined string\r\n$use_log_format = "${log_title} \\''${log_format_str}\\''"\r\n\r\naugeas { ''set-up_log_format'':\r\n    context => "/files${conf_file}/http",\r\n    changes => [\r\n        "set log_format ''${use_log_format}''"\r\n    ]\r\n}\r\n{code}\r\nProduces:\r\n{noformat}\r\n-    log_format  main  ''$remote_addr - $remote_user [$time_local] "$request" ''\r\n-                      ''$status $body_bytes_sent "$http_referer" ''\r\n-                      ''"$http_user_agent" "$http_x_forwarded_for"'';\r\n+    log_format  timed_combined  \''$remote_addr - $remote_user $http_x_unit_id [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_time $upstream_response_time $pipe\'';\r\n{noformat}\r\n*Result:* Oh wonderful! Now we have a the reverse of attempt 1 - the escaped single quotes have now been passed through to the final output. Again, confirming this is real and not just in the displayed output:\r\n{noformat}\r\n[root@devsvr2 ~]# grep log_format /etc/nginx/nginx.conf\r\n    log_format  timed_combined  \''$remote_addr - $remote_user $http_x_unit_id [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_time $upstream_response_time $pipe\'';\r\n{noformat}\r\n\r\nAs you can see, this is how I began. I tried adding various extra levels of escape and switching back and forth between single and double quotes, but nothing worked.\r\n\r\nI then eventually tried to apply the same set-up manually using augtool, and it didn''t take long to get a working result:\r\n*Attempt 1:*\r\nSet the line value, in double quotes, with no escapes:\r\n{noformat}\r\naugtool> set /files/etc/nginx/nginx.conf/http/log_format "timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_time $upstream_response_time $pipe''"\r\n{noformat}\r\n*Produces:*\r\n{noformat}\r\naugtool> print /files/etc/nginx/nginx.conf/http/log_format\r\n/files/etc/nginx/nginx.conf/http/log_format = "timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] $request $status $body_bytes_sent $http_referer $http_user_agent $request_time $upstream_response_time $pipe''"\r\n{noformat}\r\n*Result:* Missing the double quotes in the output. Okay, I''ll try escaping them:\r\n\r\n*Attempt 2:*\r\nSet the line value, in double quotes, and escape the double quotes in the substring:\r\n{noformat}\r\naugtool> set /files/etc/nginx/nginx.conf/http/log_format "timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\" $request_time $upstream_response_time $pipe''"\r\n{noformat}\r\n*Produces:*\r\n{noformat}\r\naugtool> print /files/etc/nginx/nginx.conf/http/log_format\r\n/files/etc/nginx/nginx.conf/http/log_format = "timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\" $request_time $upstream_response_time $pipe''"\r\n{noformat}\r\n*Result:* Escapes are shown in the output value above, but when ''save'' is run and we check the file on disk, we can see that it is actually correct:\r\n{noformat}\r\n[root@devsvr2 ~]# grep log_format /etc/nginx/nginx.conf\r\n    log_format  timed_combined  ''$remote_addr - $remote_user $http_x_unit_id [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" $request_time $upstream_response_time $pipe'';\r\n{noformat}\r\n\r\nSo, I guess the ultimate question is: Is this a bug, or is this the correct expected behaviour? If it is the latter, then this feature is becomes pretty unusable.\r\n\r\nBefore posting, I did a fair amount of searching for someone else with the exact same issue, and though I found plenty of comments/tickets/posts from people with similar issues, none were the exact same issue as mine; but I apologise now if the above for the slightest moment wastes someone''s time.', 'https://tickets.puppetlabs.com/browse/PUP-8561', 'https://github.com/puppetlabs/puppet/pull/6759', '2018-03-20T07:48:22.000-0700', '2019-12-10T04:14:57.000-0800', '2019-12-10T04:14:57.000-0800', 'Closed', '', 12, '0', 1, 14, 1, 2, 'd6f2ddf86b5e21df1db8f5ee3595aaaa39db6c29'),
('puppet', 21416, 783720977, 8823, 'pip provider should handle multiple pips/pythons', 'The Pip provider should provide a way to specify the path to pip.  This would allow people to manage multiple python installs, by pointing to the one they want to install into.  \r\n\r\nIn RHEL, this makes it easy to have a non-system python installed somewhere (ie: 2.7 or 3.x) and let puppet manage the python packages.\r\n\r\nThis is related to bug #15980.  (related in the way that if you could provide the path to the pip binary, 15980 would have a workaround).', 'https://tickets.puppetlabs.com/browse/PUP-1082', 'https://github.com/puppetlabs/puppet/pull/8823', '2013-12-16T11:06:29.000-0800', '2019-12-10T07:41:57.000-0800', '2019-12-10T07:41:57.000-0800', 'Resolved', 'package;pip;redmine;resolved-issue-added;type_and_provider', 4, '0', 2, 16, 87, 4, '12d6bd592be53ed3916e5b90491e07a71ea81169'),
('puppet', 42950, 285497891, 7555, 'Rapid-fire puppet runs cause race condition with SSL data', 'It appears that two rapid-fire puppet runs can cause a race condition of some kind when:\r\n\r\n# Puppet requests a certificate from the master.\r\n# An additional puppet run is triggered immediately, before the signed certificate is received.\r\n# New private keys are generated - but the master has already received the original CSR.\r\n# The master continuously returns the original certificate, which does not match the newly generated private keys / csr on the agent, from the second puppet run.\r\n\r\nThis shouldn''t be possible, but I''ve seen it demonstrated by a customer.\r\n\r\nIt''s also possible I''m misinterpreting exactly what is happening.\r\n\r\n/cc [~reid] for comment - he''s seen the bug in the past but couldn''t nail it down cohesively.', 'https://tickets.puppetlabs.com/browse/PUP-2958', 'https://github.com/puppetlabs/puppet/pull/7555', '2014-07-21T14:16:44.000-0700', '2019-12-10T07:44:06.000-0800', '2019-12-10T07:44:06.000-0800', 'Resolved', 'customer;resolved-issue-added;support', 14, '0', 1, 50, 3, 2, '7151d01ca62daa936e7af88750199958741324d3'),
('puppet', 97917, 62308703, 4772, 'puppet inspect is using wrong path for catalog data', 'Deploying Puppet 4 at a client which makes heavy use of {{puppet inspect}} and found that Puppet 4 uses the wrong path to find the client catalog.\r\n\r\n{code}\r\n[vagrant@client ~]$ sudo puppet agent --test\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for client.example.com\r\nInfo: Applying configuration version ''1442215415''\r\nNotice: /Stage[main]/Main/File[/etc/hosts]/content: audit change: previously recorded value {md5}e2b06541983600068fff455f8c11861a has been changed to {md5}28c9f9f5a3d060a500d4b57f9875ba32\r\nNotice: Applied catalog in 0.39 seconds\r\n\r\n[vagrant@client ~]$ sudo puppet inspect\r\nError: Could not run: Could not find catalog for client.example.com\r\n{code}\r\n\r\nStrace shows us that it''s looking in the {{client_yaml}} directory instead of {{client_data}}.\r\n\r\n{code}\r\n[pid  7817] lstat("/opt/puppetlabs", {st_mode=S_IFDIR|0755, st_size=42, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet", {st_mode=S_IFDIR|0755, st_size=102, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet/lib", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet/lib/ruby", {st_mode=S_IFDIR|0755, st_size=47, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet/lib/ruby/vendor_ruby", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0\r\n[pid  7817] lstat("/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/yaml.rb", {st_mode=S_IFREG|0644, st_size=1940, ...}) = 0\r\n[pid  7817] stat("/etc/puppetlabs/puppet/routes.yaml", 0x7fff96c96bd0) = -1 ENOENT (No such file or directory)\r\n[pid  7817] stat("/opt/puppetlabs/puppet/cache/client_yaml/catalog/client.example.com.yaml", 0x7fff96c96bd0) = -1 ENOENT (No such file or directory)\r\n[pid  7817] write(2, "\33[1;31mError: Could not run: Cou"..., 78Error: Could not run: Could not find catalog for client.example.com) = 78\r\n{code}\r\n\r\nThe catalog is actually stored in {{/opt/puppetlabs/puppet/cache/client_data/catalog/}}. \r\n\r\nFurthermore, the catalog is now in JSON format not YAML, and there''s no documented command line option to read this properly.\r\n\r\n{code}\r\n$ ls -la /opt/puppetlabs/puppet/cache/client_data/catalog/\r\ntotal 24\r\ndrwxr-xr-x 2 root root    64 Sep 14 07:46 .\r\ndrwxr-x--- 3 root root    20 Aug  2 22:49 ..\r\n-rw-rw---- 1 root root 16947 Sep 14 07:46 client.example.com.json\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5233', 'https://github.com/puppetlabs/puppet/pull/4772', '2015-09-14T00:35:09.000-0700', '2019-12-10T07:44:54.000-0800', '2019-12-10T07:44:54.000-0800', 'Closed', '', 16, '0', 1, 20, 9, 2, 'e1c0c5fccb5777086563cd434697dfbe105fac45'),
('puppet', 151753, 219833811, 7134, 'Windows service in Paused state cannot be managed', 'When a service is in the Paused state; it''s ''ensure'' property cannot be managed by Puppet\r\n\r\nNote that for our own services that use nssm; nssm has a characteristic that it uses the "Paused" service state for a service that has reached a fault state (see https://nssm.cc/usage )\r\n\r\n*To reproduce:*\r\n * Install puppet-agent\r\n * Ensure pxp-agent service is stopped in services.msc\r\n * Ensure the ProgramData/PuppetLabs/pxp-agent/etc/pxp-agent.conf file is renamed or deleted\r\n * Run _puppet resource service pxp-agent ensure=running_\r\n\r\nThe service will now be in the paused state. \r\nAttempting _puppet resource service pxp-agent ensure=stopped_ will echo back ensure=stopped , but services.msc will show the service as still paused. \r\nAttempting _puppet resource service pxp-agent ensure=running_ will return an error:\r\n\r\n{noformat}C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Puppet>puppet resource serv\r\nice pxp-agent ensure=running\r\nError: Cannot start pxp-agent, error was: Execution of ''C:/Windows/system32/net.\r\nexe start pxp-agent'' returned 2: The requested service has already been started.\r\n\r\n\r\nMore help is available by typing NET HELPMSG 2182.\r\nWrapped exception:\r\nExecution of ''C:/Windows/system32/net.exe start pxp-agent'' returned 2: The reque\r\nsted service has already been started.\r\n\r\nMore help is available by typing NET HELPMSG 2182.\r\nError: /Service[pxp-agent]/ensure: change from stopped to running failed: Cannot\r\n start pxp-agent, error was: Execution of ''C:/Windows/system32/net.exe start pxp\r\n-agent'' returned 2: The requested service has already been started.\r\n\r\nMore help is available by typing NET HELPMSG 2182.{noformat}\r\n\r\nOutside of Puppet, the service can be stopped by simply using the Stop option in services.msc\r\n\r\n*Expected behaviour:*\r\n * The "Paused" state should be understood by Puppet for a Windows service resource. Or at least; Puppet should actually stop a service in the "Paused" state when ensure=stopped is applied.', 'https://tickets.puppetlabs.com/browse/PUP-6702', 'https://github.com/puppetlabs/puppet/pull/7134', '2016-09-14T03:33:40.000-0700', '2019-12-10T07:49:21.000-0800', '2019-12-10T07:49:21.000-0800', 'Closed', 'service;type_and_provider;windows', 19, '0', 2, 156, 6, 5, '8c0f78a9afbdd50467007f854dc18b512ae260db'),
('puppet', 335042, 340632020, 7840, 'Deferring template rendering is awkward', 'Currently users have to jump through awkward hoops to render secrets agent side:\r\n\r\n{code}\r\n$variables = {\r\n  ''password'' => Deferred(''vault_lookup::lookup'',\r\n                  ["secret/test", ''https://vault.docker:8200'']),\r\n}\r\n\r\n# compile the template source into the catalog\r\nfile { ''/etc/secrets.conf'':\r\n  ensure  => file,\r\n  content => Deferred(''inline_epp'',\r\n               [file(''mymodule/secrets.conf.epp''), $variables]),\r\n}\r\n{code}\r\n\r\nThe problem with the solution is that the *template* file has to be stored in the *files* directory and that''s super unintuitive.\r\n\r\nAfter some conversation in Slack, I''m proposing a {{find_template()}} function that would make this make a lot more sense in that the template source is still stored in the traditional {{templates}} directory.\r\n\r\n{code}\r\n$variables = {\r\n  ''password'' => Deferred(''vault_lookup::lookup'',\r\n                  ["secret/test", ''https://vault.docker:8200'']),\r\n}\r\n\r\n# compile the template source into the catalog\r\nfile { ''/etc/secrets.conf'':\r\n  ensure  => file,\r\n  content => Deferred(''inline_epp'',\r\n               [find_template(''mymodule/secrets.conf.epp'').file, $variables]),\r\n}\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10139', 'https://github.com/puppetlabs/puppet/pull/7840', '2019-11-13T11:37:12.000-0800', '2019-12-11T13:45:37.000-0800', '2019-12-11T13:45:37.000-0800', 'Resolved', '', 8, '0', 1, 132, 0, 2, 'f070b8ebd42056c8d86aa5d1da606d3a8edb5d19'),
('puppet', 213667, 222612111, 7162, '"Attempt to redefine entity" caused by using a resource collector ', 'See PUP-7650 for the root cause of the issue. This behaviour is also sometimes (indeterminately) cause by using a *resource collector*, and that does not seem to be corrected by the patch linked in PUP-7650.\r\n\r\nThe error thrown is:\r\n\r\n{code}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Virtual Query, Could not autoload puppet/type/pe_ini_setting: Attempt to redefine entity ''http://puppet.com/2016.1/runtime/type/pe_ini_setting''. Set at unknown location at /etc/puppetlabs/code/modules/classroom/manifests/master/student_environment.pp:51:3 on node superdog.puppetlabs.vm\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8002', 'https://github.com/puppetlabs/puppet/pull/7162', '2017-09-28T09:59:09.000-0700', '2019-12-12T05:28:32.000-0800', '2019-12-12T05:28:32.000-0800', 'Closed', 'resolved-issue-added', 24, '0', 1, 3, 1, 1, '1586ddfd6770bcb0760ab6af2938f559e608b561'),
('puppet', 237430, 170548069, 6662, 'Unable to modify local user group membership with forcelocal', '*Puppet Version: 5.4.0*\r\n *Puppet Server Version: 5.2.0*\r\n *OS Name/Version: RHEL 7*\r\n\r\nBreaking Change: https://tickets.puppetlabs.com/browse/PUP-8223\r\n\r\nI also validated this is broken when using a puppet apply with this code.\r\n{code:puppet}group { ''group1'' :\r\n ensure => present,\r\n gid => ''901'',\r\n forcelocal => true,\r\n }\r\n\r\ngroup { ''group2'' :\r\n ensure => present,\r\n gid => ''902'',\r\n forcelocal => true,\r\n }\r\n\r\nuser { ''user1'' :\r\n ensure => present,\r\n home => ''/home/user1'',\r\n uid => ''900'',\r\n gid => ''user1'',\r\n comment => ''user1'',\r\n shell => ''/bin/bash'',\r\n forcelocal => true,\r\n managehome => true,\r\n groups => [''group1'', ''group2''],\r\n require => Group[''group1'', ''group2''],\r\n }\r\n{code}\r\nSo far I have found two issues.\r\n\r\n1) lusermod does not support -G\r\n # lusermod --help\r\n Usage: lusermod [OPTION...] user\r\n -i, --interactive prompt for all information\r\n -c, --gecos=STRING GECOS information\r\n -d, --directory=STRING home directory\r\n -m, --movedirectory move home directory contents\r\n -s, --shell=STRING set shell for user\r\n -u, --uid=NUM set UID for user\r\n -g, --gid=NUM set primary GID for user\r\n -l, --login=STRING change login name for user\r\n -P, --plainpassword=STRING plaintext password for the user\r\n -p, --password=STRING pre-hashed password for the user\r\n -L, --lock lock account\r\n -U, --unlock unlock account\r\n --commonname=STRING set common name for user\r\n --givenname=STRING set given name for user\r\n --surname=STRING set surname for user\r\n --roomnumber=STRING set room number for user\r\n --telephonenumber=STRING set telephone number for user\r\n --homephone=STRING set home telephone number for user\r\n\r\nHelp options:\r\n -?, --help Show this help message\r\n --usage Display brief usage message\r\n\r\n2) the new code will not "modify" the user''s groups in /etc/group because the user already exists.\r\n\r\n*Desired Behavior:*  \r\n user type allowed to modify local users groups\r\n\r\n*Actual Behavior:*\r\n\r\n{noformat}\r\nError: UID 900 already exists, use allowdupe to force user creation\r\n Error: /Stage[main]/Localusers::Identities/User[user1]/groups: change from to ''group1,group2'' failed: UID 900 already exists, use allowdupe to force user creation\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8470', 'https://github.com/puppetlabs/puppet/pull/6662', '2018-02-19T11:59:11.000-0800', '2019-12-12T05:33:01.000-0800', '2019-12-12T05:33:01.000-0800', 'Closed', '', 16, '0', 2, 23, 15, 5, '480353461e7b321af25fc5f190c11f9de864cb72'),
('puppet', 240507, 174089506, 6726, 'AIX user resource fails with new service packs', 'New versions of AIX have changed the behavior of the {{chpasswd}} command to report errors when the command syntax is incorrect. See the links below. \r\n\r\nhttp://www-01.ibm.com/support/docview.wss?uid=isg1IV95055\r\nhttp://www-01.ibm.com/support/docview.wss?uid=isg1IJ04629\r\n\r\nThe change to behavior went into 7100-05-01-1731 and 7200-02-01-1731, so setting the password in these AIX versions will fail. This will also cause new user creations to fail on these SPs. \r\n\r\nThe issue is that in  https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/user/aix.rb#L279 we use {{chpasswd -e -c username}}, where as the username is not a valid option to the command. Since the behavior change, customers have seen failures in the user resources on these new SPs. \r\n\r\n\r\n*Errors*\r\n\r\n{code}\r\nDebug: Executing: ''/usr/bin/mkuser shell=/usr/bin/ksh minage=0 maxage=0 groups=patrol patrol''\r\nDebug: Executing: ''/bin/chpasswd -e -c patrol''\r\nError: Could not set ''present'' on ensure: undefined local variable or method `param'' for User[patrol](provider=aix):Puppet::Type::User::ProviderAix at /root/newuser.pp:10\r\nError: Could not set ''present'' on ensure: undefined local variable or method `param'' for User[patrol](provider=aix):Puppet::Type::User::ProviderAix at /root/newuser.pp:10\r\nWrapped exception:\r\nundefined local variable or method `param'' for User[patrol](provider=aix):Puppet::Type::User::ProviderAix\r\nError: /Stage[main]/Main/User[patrol]/ensure: change from absent to present failed: Could not set ''present'' on ensure: undefined local variable or method `param'' for User[patrol](provider=aix):Puppet::Type::User::ProviderAix at /root/newuser.pp:10\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8538', 'https://github.com/puppetlabs/puppet/pull/6726', '2018-03-09T11:00:46.000-0800', '2019-12-12T05:33:42.000-0800', '2019-12-12T05:33:42.000-0800', 'Closed', 'cs_pr_review;maintenance;triage', 3, '0', 1, 1, 1, 1, 'ee982cf532f1a253426b7e76f2352f9ce77af61e'),
('puppet', 251126, 188648840, 6839, 'The match function does not accept a type alias ', 'h1.  The Problem\r\n\r\nPassing a type alias to the match function results in an error.  \r\n\r\nExample Code: \r\n\r\nhttps://github.com/npwalker/regex_variable/blob/test_pattern_type_alias/manifests/profile/test.pp#L14\r\n\r\nAnd example error:\r\n\r\n{code}\r\nerror during compilation: Evaluation Error: Error while evaluating a Method call, match() expects pattern of T, where T is String, Regexp, Regexp[r], Pattern[p], or Array[T]. Got Puppet::Pops::Types::PTypeAliasType (file: /home/travis/build/npwalker/regex_variable/spec/fixtures/modules/regex_variable/manifests/profile/test.pp, line: 14, column: 21) on node travis-job-npwalker-regex-variable-124411915.travisci.net\r\n{code}\r\n\r\nWhich can been seen in travis as well: \r\n\r\nhttps://travis-ci.com/npwalker/regex_variable/jobs/124411915#L532', 'https://tickets.puppetlabs.com/browse/PUP-8745', 'https://github.com/puppetlabs/puppet/pull/6839', '2018-05-16T12:42:38.000-0700', '2019-12-12T05:37:11.000-0800', '2019-12-12T05:37:11.000-0800', 'Closed', '', 2, '0', 1, 29, 0, 2, 'a89c8b1e0a0fde2c3253700efc5082a56d49bbca'),
('puppet', 262552, 207165343, 6983, '[Regression] PUP-8167 behaviour noted in Puppet AiO 5.5.3', '*Puppet Version:* All-in-One 5.5.3\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* Solaris 10 u 10\r\n\r\nThis appears to be a regression\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8957', 'https://github.com/puppetlabs/puppet/pull/6983', '2018-06-25T03:06:22.000-0700', '2019-12-12T05:40:29.000-0800', '2019-12-12T05:40:29.000-0800', 'Closed', 'service;solaris;solaris-parity;type_and_provider', 12, '0', 1, 6, 21, 3, 'd9714949a02dedfac65c71ffaa728620a8fc4c01'),
('puppet', 262757, 243441449, 7328, 'Type and provider info should be logged when prefetch fails', 'While the puppet agent is applying a catalog, it will pre-fetch resource instances that share a common source. Such as packages from the same provider or cron jobs from the same crontab. Catalog application will abort with an error message if this prefetch operation fails. Often, these errors are terse, cryptic, and give no insight into which sort of resource type failed to fetch (cron job? package? SSH key?). In the case of types based on the ParsedFile provider, the prefetch code is shared among all types which means that the stack trace produced by {{--trace}} doesn''t even help distinguish what type encountered the error.\r\n\r\nError messages should be clear about which type and provider failed so that users can proceed directly to debugging instead of puzzling out what happened.\r\n\r\nh2. Reproduction Case\r\n\r\n  - Install PE 2018.1.2 on CentOS 7.\r\n\r\n  - Configure {{site.pp}} in the production environment with a cron resource:\r\n\r\n{code:bash}\r\ncat <<EOF > /etc/puppetlabs/code/environments/production/manifests/master_node.pp\r\nnode ''$(hostname -f)'' {\r\n  cron {''cron job to trigger prefetch'':\r\n    command => ''/bin/true'',\r\n    user => ''root'',\r\n    hour => 1,\r\n  }\r\n}\r\nEOF\r\n{code}\r\n\r\n  - Write garbage to root''s crontab to trigger a parse failure:\r\n\r\n{code:bash}\r\nprintf ''\0\0\0\0odelay'' > /var/spool/cron/root\r\n{code}\r\n\r\n  - Run {{puppet agent -t}}\r\n\r\nh3. Outcome\r\n\r\nThe catalog fails to apply with a very terse, cryptic error message:\r\n\r\n{noformat}\r\n# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201812-master.puppetdebug.vlan\r\nInfo: Applying configuration version ''1530028114''\r\nError: Failed to apply catalog: Could not parse line "\u0000\u0000\u0000\u0000odelay" (file: root, line: 2)\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nError message should include the type and provider name as is done when prefetch fails due to a LoadError or Puppet::MissingCommand error:\r\n\r\n{noformat}\r\n# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201812-master.puppetdebug.vlan\r\nInfo: Applying configuration version ''1530028653''\r\nError: Failed to apply catalog: Could not prefetch cron provider ''crontab'': Could not parse line "\u0000\u0000\u0000\u0000odelay" (file: root, line: 2)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8962', 'https://github.com/puppetlabs/puppet/pull/7328', '2018-06-26T09:06:15.000-0700', '2019-12-12T05:40:52.000-0800', '2019-12-12T05:40:52.000-0800', 'Closed', 'resolved-issue-added', 6, '0', 1, 24, 6, 2, '0ec9ee25bf100f983f5160e6cc9fc149fa2d73dc'),
('puppet', 278613, 223954226, 7177, 'Unable to modify user account expiry date when forcelocal == true', '*Puppet Version: 5.5.6 6.0.1*\r\n *Puppet Server Version: 5.2.0*\r\n *OS Name/Version: CentOS 7.5*\r\n\r\nSimilar to https://tickets.puppetlabs.com/browse/PUP-8470 (where lusermod does not support -G), lusermod does not support -e either.\r\n{code:puppet}\r\nuser {"someuser":\r\n  ensure => present,\r\n  forcelocal => true,\r\n  expiry => "2019-05-31"\r\n}\r\n{code}\r\n\r\n *Desired Behavior:*\r\nuser type allowed to modify local user''s account expiry parameter\r\n\r\n*Actual Behavior:*\r\n\r\n{noformat}\r\nError: Could not set expiry on user[someuser]: Execution of ''/sbin/lusermod -e 2019-05-31 someuser'' returned 1: Error parsing arguments: unknown option.\r\nUsage: lusermod [-imLU?] [-i|--interactive] [-c|--gecos STRING]\r\n        [-d|--directory STRING] [-m|--movedirectory] [-s|--shell STRING]\r\n        [-u|--uid NUM] [-g|--gid NUM] [-l|--login STRING]\r\n        [-P|--plainpassword STRING] [-p|--password STRING] [-L|--lock]\r\n        [-U|--unlock] [--commonname=STRING] [--givenname=STRING]\r\n        [--surname=STRING] [--roomnumber=STRING] [--telephonenumber=STRING]\r\n        [--homephone=STRING] [-?|--help] [--usage] [OPTION...] user\r\nError: /Stage[main]/Main/User[someuser]/expiry: change from ''absent'' to ''2019-05-31'' failed: Could not set expiry on user[someuser]: Execution of ''/sbin/lusermod -e  someuser'' returned 1: Error parsing arguments: unknown option.\r\nUsage: lusermod [-imLU?] [-i|--interactive] [-c|--gecos STRING]\r\n        [-d|--directory STRING] [-m|--movedirectory] [-s|--shell STRING]\r\n        [-u|--uid NUM] [-g|--gid NUM] [-l|--login STRING]\r\n        [-P|--plainpassword STRING] [-p|--password STRING] [-L|--lock]\r\n        [-U|--unlock] [--commonname=STRING] [--givenname=STRING]\r\n        [--surname=STRING] [--roomnumber=STRING] [--telephonenumber=STRING]\r\n        [--homephone=STRING] [-?|--help] [--usage] [OPTION...] user\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-9195', 'https://github.com/puppetlabs/puppet/pull/7177', '2018-10-03T01:55:12.000-0700', '2019-12-12T05:47:04.000-0800', '2019-12-12T05:47:04.000-0800', 'Closed', 'Community;resolved-issue-added', 3, '0', 2, 4, 12, 2, '77e3ec5fd065693776071ccc25ffce30db5e4911'),
('puppet', 284764, 235158389, 7266, 'puppet package provider fails when reading from registry', '*Puppet Version: 5.5.6*\r\n *Puppet Server Version: 5.3.5*\r\n *OS Name/Version: Windows 2016*\r\n\r\nThe ClaySys AppForms 6 application creates a Registry key in:\r\n\r\n{{HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\ClaySys AppForms_6\ConnectionString}}\r\n\r\n... that causes the Windows package provider to fail. The data appears to binary but {{reg_enum_value}} expects a string and calls {{read_wide_string}} in ...\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/windows/package.rb#L28\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/registry.rb#L62\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/registry.rb#L120\r\n\r\n*Desired Behavior: It does not fail.*\r\n\r\n*Actual Behavior:*\r\n\r\n{code}\r\nDebug: Unable to convert value "8\xB3zk\xF6\xBB\xDF\n\x18lK8\xA1\xAA\x96\xA9T0\tB \xFC\xF5\v\xC0>\xE2\xC0\xDAEI\x98\xC2h\x00\xD21\xE8*\xA2\xB2rW\xAF5R\xB8\xDDm\xB4n0\xE1\xD9\xDC@J\xA1\x86\xC3\b\xD8)q\x96\xED\x8A\xB50\x83\xC8J\xAB\xAD\xCA\xACI\x05\f\xFC\xE9\xD6A\xEF\xB5\t\xE7B\x1D\x18\fc\x1EM\x9BS\x83\xE8\xA6\x84c;\x87\xF5?e1\x97\x1C\xB9\xAA?\xDF@\xBB\xBCs\x9A\x18\x95\xFD<D\xB2\xA5\xE9\x8D\xC4\x93-\xABw\xBD\xF9\x9B\xA1w\xE0\a\r<\xB3\xCD\xD5\x00x\xD3V\x8CQ\xD1?g6\x99\xB6>\xBE\xBE\x05SB\bI\xA3\x8E\xAB\xDD\xA2Yl\xF3\xB5\xFC\x04\xC9\x8A\xB7`\xD9\x96\xC1\xFD=\xF4\xA8\xE4\xB3\xBC\xFCb\xDA\xC6\xF0\b\xD7\x89\xAABO\xAC\xB6\x1C\xC8\x8E\xD1\x80\x10Q\xFE\x00\x0F\x99\xAFB\xB5\xFBU\x8BJ\x1C\xEC''.".force_encoding("UTF-16LE") to encoding UTF-8 due to #<Encoding::InvalidByteSequenceError: "\xB8\xDD" on UTF-16LE>\r\nError: Cannot collect packages for Puppet::Type::Package::ProviderWindows provider; "\xB8\xDD" on UTF-16LE \r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9312', 'https://github.com/puppetlabs/puppet/pull/7266', '2018-11-12T09:27:52.000-0800', '2019-12-12T05:49:41.000-0800', '2019-12-12T05:49:41.000-0800', 'Closed', '', 9, '0', 3, 98, 6, 5, '2b16db5eb7b10aced53756686747f2cd2c94ec3d'),
('puppet', 295978, 253207328, 7393, 'Unable to use remote URI as source parameter with package provider on Windows', 'Prior to Puppet 5.5.7, it was possible with the ''windows'' provider for the Package resource to use HTTP sources for MSI packages. As of Puppet 5.5.7, this functionality no longer works.\r\n\r\nExample:\r\n{code}package { ''my software'':\r\nensure => ''1.0.0'',\r\nsource => ''http://my-web-repo.net/my-package.msi'',\r\n}\r\n{code}\r\nError message:\r\n{code}''Error: Could not update: Working directory http://my-web-repo.net does not exist!''\r\n{code}\r\nPuppet 5.5.7 implemented https://tickets.puppetlabs.com/browse/PUP-6920, which allows for the working directory to be the same directory as the package source, which breaks the unintended functionality of the windows provider using a remote URI. It previously worked because MSI was actually handling the download of the installer rather than Puppet handling the download.', 'https://tickets.puppetlabs.com/browse/PUP-9496', 'https://github.com/puppetlabs/puppet/pull/7393', '2019-02-12T18:30:01.000-0800', '2019-12-12T06:05:00.000-0800', '2019-12-12T06:05:00.000-0800', 'Closed', 'customer;package;resolved-issue-added;type_and_provider;windows', 2, '0', 1, 17, 2, 2, '5e756f6a9d6b65c4e88e63425359b9b39acdd091'),
('puppet', 306573, 275730488, 7504, 'String to integer conversion fails', '*Puppet Version:2018.1.5*\r\n *Puppet Server Version:5.5.8*\r\n *OS Name/Version: RHEl and Solaris*\r\n\r\n*Desired Behavior:* \r\n\r\nConvert "08" from a string to an integer successfully on puppet run.\r\n\r\n*Actual Behavior:*\r\n\r\nFails to convert "08" from a string to an integer on a puppet run.\r\n\r\nSome of our newly added code was failing on what seems to be a valid String -> Integer conversion.\r\n\r\nA minimal case to reproduce:\r\n\r\nThis, which is essentially the same as one of the examples in the docs ([https://puppet.com/docs/puppet/5.5/function.html#conversion-to-integer]) works:\r\n\r\n# puppet apply -e ''notify \{ "message": message => Integer("010", 10) }'' \r\nNotice: Compiled catalog for denga02l.unix.anz in environment production in 0.05 seconds \r\nNotice: 10 \r\nNotice: /Stage[main]/Main/Notify[message]/message: defined ''message'' as 10 \r\nNotice: Applied catalog in 0.26 seconds\r\n\r\nAs you can see the "radix" argument to specify base 10 makes it it correctly interpret the string as a decimal number\r\n\r\n# puppet apply -e ''notify \{ "message": message => Integer("07", 10) }''\r\nNotice: Compiled catalog for pe-201817-master.puppetdebug.vlan in environment production in 0.11 seconds\r\nNotice: 7\r\nNotice: /Stage[main]/Main/Notify[message]/message: defined ''message'' as 7\r\nNotice: Applied catalog in 0.30 seconds\r\n\r\nBut this fails:\r\n\r\n# puppet apply -e ''notify \{ "message": message => Integer("08", 10) }'' \r\nError: Evaluation Error: Error while evaluating a Function Call, ''new'' The string ''08'' cannot be converted to Integer (line: 1, column: 33) on node denga02l.unix.anz\r\n\r\nSince the first example correctly interprets the string I suspect that there are two passes over it - one of which is trying to interpret the value as octal, and the second which is doing the actual conversion.\r\n\r\nThis happens on both RHEL and Solaris systems\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9689', 'https://github.com/puppetlabs/puppet/pull/7504', '2019-04-29T01:47:44.000-0700', '2019-12-12T06:10:10.000-0800', '2019-12-12T06:10:10.000-0800', 'Resolved', 'resolved-issue-added', 4, '0', 1, 20, 3, 2, '466b2e111b4819045b43da647e6da94b5663c7a7'),
('puppet', 308025, 287896101, 7568, 'Solaris Crontabs -> puppet resource cron only returns root account', '*Puppet Version:2018.1.5*\r\n *Puppet Server Version:*\r\n *OS Name/Version: Solaris 11*\r\n\r\nUnable to get a cron job from crontab for another user using `puppet resource cron` or `crontab -l` Solaris 11.\r\n\r\nThis has been set with a .pp code through classification and it uses the `user` resource to set up the cron job. \r\n\r\nExample :\r\n\r\ncrontab -l -> returns only jobs in the root crontab file.\r\n\r\ncrontab -l username -> returns only cron jobs in the users crontab.\r\n\r\nPuppet Resource Cron will only return the root crontab.\r\n\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nWhen running a puppet resource cron it should return all crontabs\r\n\r\n*Actual Behavior:*\r\n\r\nOnly the root accounts crontab is returned on Solaris 11.\r\n\r\n \r\n\r\nCron is created with pp code\r\n   cron\r\n\r\n{ ''my cron job'':                         command => "my command",                          user => "someuser",                 }', 'https://tickets.puppetlabs.com/browse/PUP-9697', 'https://github.com/puppetlabs/puppet/pull/7568', '2019-05-09T09:40:00.000-0700', '2019-12-12T06:10:28.000-0800', '2019-12-12T06:10:28.000-0800', 'Closed', 'resolved-issue-added', 1, '0', 1, 1, 1, 1, '76180dc58fb9f5e3c95be45f0cdf034b74cec76a'),
('puppet', 335096, 340863814, 7842, 'puppet service and puppet-agent failing on windows ', 'Installing the puppet-agent on windows platforms isn''t generating a CSR, and I''ve also encountered problems with manually trying to start the puppet service in general on windows platforms. This started cropping up in PE 2018.1.x CI, tests started failing because CSRs were not showing up when the tests expected them to.\r\n\r\nAn example of the failure can be seen in this [Agent Integration job|https://cinext-jenkinsmaster-enterprise-prod-1.delivery.puppetlabs.net/view/pe-integration/view/pe-2018.1.x/job/enterprise_pe-acceptance-tests_integration-system_pe_full-agent_nightly_2018.1.x/154/LAYOUT=centos6-64mcd-windows10ent-64f-32f-windows2008r2-64f-windows2012r2-64f-windows2016-64f-windows2019-64f,LEGACY_AGENT_VERSION=NONE,PLATFORM=NOTUSED,SCM_BRANCH=2018.1.x,UPGRADE_FROM=NONE,UPGRADE_TO_VERSION=NONE,label=beaker/] for PE 2018.1.x, with a puppet-agent SHA of 5.5.17.71.gb6ebce3', 'https://tickets.puppetlabs.com/browse/PUP-10140', 'https://github.com/puppetlabs/puppet/pull/7842', '2019-11-13T13:56:55.000-0800', '2020-01-08T04:08:47.000-0800', '2020-01-08T04:08:47.000-0800', 'Resolved', '', 10, '0', 1, 41, 33, 2, '30c25cba7c077a5e257e31f3846b9fa02789cdfe'),
('puppet', 327639, 328736199, 7785, 'Puppet won''t install (some) packages with ensure => held', '*Puppet Version: 6.9.0-1bionic*\r\n *Puppet Server Version: 6.2.0-1bionic*\r\n *OS Name/Version: Ubuntu 18.04*\r\n\r\nI have postfix and installed and held:\r\n\r\n \r\n{code:java}package { ''postfix'':\r\n ensure => ''held'',\r\n}{code}\r\n \r\n\r\n \r\n{code:java}# dpkg -l | grep postfix\r\nhi postfix 3.3.0-1ubuntu0.2 amd64 High-performance mail transport agent{code}\r\n \r\n\r\n \r\n\r\nNow I''m trying to install a few sub-packages, also as held:\r\n\r\n \r\n{code:java}$packages = [\r\n ''postfix-pcre'',\r\n ''postfix-mysql'',\r\n]\r\npackage { $packages:\r\n ensure => ''held'',\r\n}\r\n{code}\r\n \r\n\r\nWhen running puppet, the following messages are displayed:\r\n\r\nNotice: /Stage[main]/Main/Package[postfix-pcre]/ensure: created\r\n Notice: /Stage[main]/Main/Package[postfix-mysql]/ensure: created\r\n\r\n*Desired Behavior:*\r\n\r\n**Packages postfix-pcre and postfix-mysql should be installed and set to "held".\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\nNeither package is installed. The puppet resource command results in a package resource with ensure set to "purged":\r\n{code:java}# puppet resource package postfix-mysql ensure=held\r\nNotice: /Package[postfix-mysql]/ensure: created\r\npackage { ''postfix-mysql'':\r\n ensure => ''purged'',\r\n provider => ''apt'',\r\n}{code}\r\n \r\n\r\n This seems to only affect sub-packages like in this Postfix example; I have other packages set to ensure => held which have been installed properly.', 'https://tickets.puppetlabs.com/browse/PUP-10059', 'https://github.com/puppetlabs/puppet/pull/7785', '2019-10-02T05:43:50.000-0700', '2020-01-08T04:15:02.000-0800', '2020-01-08T04:15:02.000-0800', 'Resolved', 'resolved-issue-added', 1, '0', 1, 18, 15, 2, '46ac235539e8f1be1a935de5f269c7f6e4f66bbd'),
('puppet', 329403, 333560787, 7794, 'Systemd provider is not correctly selected on Alpine Linux', '*Puppet Version: 6.8.0 - 6.10.0*\r\n\r\nRunning unit tests (i.e pdk test unit) on Alpine Linux with puppet agents >= 6.8.0 fails:\r\n\r\n \r\n{code:java}\r\npdk (INFO): Using Ruby 2.4.6\r\npdk (INFO): Using Puppet 6.8.0\r\nRun options: exclude {:bolt=>true}\r\n Evaluated 83 tests in 30.530483644 seconds: 1 failures, 0 pending.\r\nfailed: rspec: ./spec/classes/common_spec.rb:9: Could not find the daemon directory (tested [/etc/sv,/var/lib/service])\r\n common should contain class: Ubuntu on ubuntu-18.04-x86_64 is expected to compile into a catalogue without dependency cycles\r\n Failure/Error:\r\n let(:facts) { os_facts }\r\nit { is_expected.to compile.with_all_deps }\r\n end\r\n{code}\r\n \r\n\r\nThis seems to be related to changes in:\r\n\r\nhttps://tickets.puppetlabs.com/browse/PUP-7312\r\nhttps://tickets.puppetlabs.com/browse/PUP-10016', 'https://tickets.puppetlabs.com/browse/PUP-10102', 'https://github.com/puppetlabs/puppet/pull/7794', '2019-10-15T01:27:13.000-0700', '2020-01-08T04:15:33.000-0800', '2020-01-08T04:15:33.000-0800', 'Resolved', 'resolved-issue-added', 15, '0', 2, 59, 17, 4, 'e9a74c423e483164782490a07b47f599848d376d'),
('puppet', 335940, 343226089, 7852, 'Systemd provider daemon-reload broken in puppet 6.11.0', '*Puppet Version:* 6.11.0\r\n*Puppet Server Version:* NA\r\n*OS Name/Version:* RHEL7\r\n\r\nThe feature implemented in https://tickets.puppetlabs.com/browse/PUP-3483 where daemon-reload is called if required has been broken in puppet 6.11\r\n\r\nMy PR https://github.com/voxpupuli/puppet-prometheus/pull/390 worked yesterday, but today puppet 6.11 came out and now the build fails.\r\n\r\nThis change https://github.com/puppetlabs/puppet/commit/0ea1776b096b379b554b835ab091ec00d325e99c#diff-dafbe8211057bc10ff2cfe788a6c4ebbR130 looks to be the problem.\r\n\r\nWith the {noformat}''--''{noformat} added where it has been, the {noformat}''--property=NeedDaemonReload''{noformat} argument is not processed (as an option) and all properties are returned.', 'https://tickets.puppetlabs.com/browse/PUP-10149', 'https://github.com/puppetlabs/puppet/pull/7852', '2019-11-19T15:38:10.000-0800', '2020-01-08T06:52:35.000-0800', '2020-01-08T06:52:35.000-0800', 'Resolved', 'resolved-issue-added', 2, '0', 1, 5, 5, 2, '837c064548908991cd6203522af983a2b35989e1'),
('puppet', 341337, 360720246, 7917, 'Puppet lookup invocation recursion detection not thread-safe', 'Initial production testing by Customer0 with Puppet in multithreaded mode has revealed that the code to detect recursive hiera lookups is not thread-safe:\r\n{code}\r\n2020-01-07T08:41:31.500-08:00 ERROR [qtp612319309-15848] [puppetserver] Puppet Evaluation Error: Error while evaluating a Resource Statement, Lookup of key ''ntp::config_template'' failed: Recursive lookup detected in [epel::epel_debuginfo_sslclientkey, ntp::tinker, ntp::leapfile, ntp::config_template] (file: /etc/puppetlabs/code/environments/production/site/profile/manifests/time.pp, line: 2, column: 3) on node ldap-testfixture-prod-2.delivery.puppetlabs.net\r\n{code}\r\n\r\nThese errors come from https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/lookup/invocation.rb#L84. Current theory is that since the {{@current}} class variable is not thread-safe, if multiple threads look for the same key at the same time, this error could occur. In their environments, this was happening when doing automatic lookup of class params via hiera.', 'https://tickets.puppetlabs.com/browse/PUP-10222', 'https://github.com/puppetlabs/puppet/pull/7917', '2020-01-07T10:38:50.000-0800', '2020-01-10T07:31:01.000-0800', '2020-01-10T07:31:01.000-0800', 'Resolved', '', 1, '0', 1, 10, 3, 1, '7628f8bfcbd9947d1706c36af67ee7c247db80ca'),
('puppet', 336155, 358838753, 7899, 'Ruby stacktraces no longer interleave Puppet Code stacktraces', '*Puppet Version:* 6.11.1\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* Windows 10\r\n\r\nAs part of https://github.com/puppetlabs/puppet/pull/7754 the Puppet Stack Trace feature was modified to use an independent stack trace storing mechanism, however this may have introduced an unforseen behaviour change.\r\n\r\nPreviously users would be able to trace how Puppet has traversed the invocations within a Manifest file.  For example int the given manifest\r\n\r\n{code}\r\nclass nest1 {\r\n  fail(''somethinng'')\r\n}\r\n\r\nclass nest2 {\r\n  include nest1\r\n}\r\n\r\ninclude nest2\r\n{code}\r\n\r\nPreviously in Puppet 6.10.1, we can see a {{puppet apply <manifest> --trace}} gives\r\n\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Function Call, somethinng (file: C:/Source/puppet/tmp/test.pp, line: 2, column: 3) on node glenn.sarti-r90qu2hx\r\nC:/Source/puppet/lib/puppet/parser/functions/fail.rb:10:in `block in get_binding''\r\nC:/Source/puppet/lib/puppet/parser/functions.rb:206:in `block (2 levels) in newfunction''\r\n...\r\nC:/Source/puppet/tmp/test.pp:2:in `block in call_function''\r\n...\r\nC:/Source/puppet/tmp/test.pp:6:in `block in call_function''\r\n...\r\nC:/Source/puppet/tmp/test.pp:9:in `block in call_function''\r\n...\r\nC:/Source/puppet/tmp/test.pp:in `stack''\r\n...\r\n{code}\r\n\r\nWe can see the various includes and Puppet call stack.\r\n\r\nHowever in Puppet 6.11.1 we get:\r\n\r\n{code}\r\n...\r\nError: Evaluation Error: Error while evaluating a Function Call, somethinng (file: C:/Source/puppet/tmp/test.pp, line: 2, column: 3) on node glenn.sarti-r90qu2hx\r\n{code}\r\n\r\nAnd that''s it.  The call stack within Puppet is no longer available.  Now, that''s probably due to Puppet no longer using the Ruby stack to store the information, however...\r\n\r\nDue to the way the stack is implemented, the stack is cleared (via the `shift` in https://github.com/puppetlabs/puppet/blob/1356f58d66/lib/puppet/pops/puppet_stack.rb#L44-L46) BEFORE any error trapping can occur.\r\n\r\nEffectively, the Puppet Stack is no longer available during exceptions, only the exception location, which seems a concerning.', 'https://tickets.puppetlabs.com/browse/PUP-10150', 'https://github.com/puppetlabs/puppet/pull/7899', '2019-11-21T06:01:11.000-0800', '2020-01-11T14:02:17.000-0800', '2020-01-11T14:02:17.000-0800', 'Resolved', 'resolved-issue-added', 24, '0', 1, 281, 169, 6, '943913f5cd44589da4cdfbbd3eb109992e7718d1'),
('puppet', 328315, 339894223, 7827, 'premature loading of module-provided facts under `-p`', 'When running {{facter -p}} on windows with the puppetlabs/ciscopuppet module pluginsynced to the agent, facter is loading {{facter/cisco.rb}} from {{C:/ProgramData/PuppetLabs/puppet/cache/lib}} before setting up the {{$LOAD_PATH}} to load that file''s dependencies from there. Please see the attached screenshot for the debug modifications I did and the results on the machine showing the issue.\r\n\r\nTo make sure there is nothing wonky with the {{facter/cisco_nexus}} file itself, a {{require}} within a {{setcode}} worked fine.\r\n\r\nRegular agent runs work fine and do not show any errors.\r\nh3. Desired Behaviour\r\n\r\n{{facter -p}} loads files from puppet''s cache only once, after {{$LOAD_PATH}} has been properly initialised.', 'https://tickets.puppetlabs.com/browse/PUP-10136', 'https://github.com/puppetlabs/puppet/pull/7827', '2019-10-07T10:30:12.000-0700', '2020-01-12T11:45:15.000-0800', '2020-01-12T11:45:15.000-0800', 'Resolved', 'resolved-issue-added', 1, '0', 1, 6, 6, 2, '92ab109c1dc6060e56a66acde8f8ecfc68fac5f0'),
('puppet', 338500, 354363399, 7893, 'puppetdb_query doesn''t respect hostprivkey & hostcert settings', '*Puppet Version: 6.11.1*\r\n*Puppet Server Version: 6.6.0*\r\n*OS Name/Version: Ubuntu 16.04 xenial*\r\n\r\nI hit into this issue when tried to call {{puppetdb_query}} function from choria playbook. It fails to find SSL certificate & private key. Then I tried to run \r\n{{puppet apply -e "notice(puppetdb_query(''nodes[certname]{}''))"}}\r\n*as non-root user* but it fails with same error.\r\n\r\nI have {{hostprivkey}} and {{hostcert}} in my user''s {{~/.puppetlabs/etc/puppet/puppet.conf}} ({{[main]}} section). Those cert & key are 100% valid. {{puppet config print}} shows proper values. But it seems {{puppetdb_query}} doesn''t respect the settings.\r\n\r\nThough this function forks fine if I set {{certname}} to {{username.mcollective}} (filename of user certificate, see below).\r\n\r\n*Desired Behavior:*\r\n{{puppetdb_query}} function must respect {{hostprivkey}} and {{hostcert}} config parameters.\r\n\r\n*Actual Behavior:*\r\nI replaced actual user name with {{username}} and host name with {{hostname.tld}} in output below:\r\n{code}\r\n$ cat ~/.puppetlabs/etc/puppet/puppet.conf\r\n[main]\r\n  hostprivkey = $privatekeydir/username.mcollective.pem\r\n  hostcert = $certdir/username.mcollective.pem\r\n\r\n$ puppet config print hostprivkey hostcert\r\nhostcert = /home/username/.puppetlabs/etc/puppet/ssl/certs/username.mcollective.pem\r\nhostprivkey = /home/username/.puppetlabs/etc/puppet/ssl/private_keys/username.mcollective.pem\r\n\r\n$ puppet apply -e "notice(puppetdb_query(''nodes[certname]{}''))"\r\nError: Failed to initialize SSL: The private key is missing from ''/home/username/.puppetlabs/etc/puppet/ssl/private_keys/hostname.tld.pem''\r\nError: Run `puppet agent -t`\r\nError: Evaluation Error: Error while evaluating a Function Call, The private key is missing from ''/home/username/.puppetlabs/etc/puppet/ssl/private_keys/hostname.tld.pem'' (line: 1, column: 8) on node hostname.tld\r\n{code}\r\n\r\nThough, if I set {{certname}} in puppet.conf it works fine:\r\n{code}\r\n$ cat ~/.puppetlabs/etc/puppet/puppet.conf\r\n[main]\r\n  certname = username.mcollective\r\n\r\n$ puppet apply -e "notice(puppetdb_query(''nodes[certname]{}''))"\r\nNotice: Scope(Class[main]): [{certname => hostname.tld}, ... ]\r\nNotice: Compiled catalog for username.mcollective in environment production in 0.19 seconds\r\nNotice: Applied catalog in 0.04 seconds\r\n{code}\r\n\r\nTrace log:\r\n{code}\r\nusername@spdapuppetp1:~$ puppet apply -e "notice(puppetdb_query(''nodes[certname]{}''))" --trace\r\nError: Failed to initialize SSL: The private key is missing from ''/home/username/.puppetlabs/etc/puppet/ssl/private_keys/hostname.tld.pem''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/x509/cert_provider.rb:171:in `load_private_key''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/ssl_provider.rb:112:in `load_context''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:215:in `block in base_context''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:164:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:54:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:266:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/puppetdb/http.rb:219:in `action''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/puppetdb.rb:74:in `block in query_puppetdb''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/puppetdb.rb:71:in `query_puppetdb''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/puppetdb_query.rb:8:in `puppetdb_query''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:42:in `stack''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:303:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:976:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:945:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:94:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1289:in `block in unfold''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1284:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1284:in `unfold''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:945:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:49:in `block in visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:96:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:42:in `stack''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:737:in `eval_Program''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:49:in `block in visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:96:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:125:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:30:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:137:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:594:in `evaluate_main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:166:in `block (2 levels) in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:166:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:274:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:155:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:34:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:307:in `block (2 levels) in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:305:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:233:in `block in benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:232:in `benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:303:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:56:in `block in find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/node/environment.rb:423:in `with_text_domain''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:55:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:223:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:232:in `block in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:274:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:207:in `main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:177:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:687:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:143:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\nError: Run `puppet agent -t`\r\nError: Evaluation Error: Error while evaluating a Function Call, The private key is missing from ''/home/username/.puppetlabs/etc/puppet/ssl/private_keys/hostname.tld.pem'' (line: 1, column: 8) on node hostname.tld\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/x509/cert_provider.rb:171:in `load_private_key''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/ssl_provider.rb:112:in `load_context''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:215:in `block in base_context''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:164:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:54:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:266:in `lookup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/puppetdb/http.rb:219:in `action''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/puppetdb.rb:74:in `block in query_puppetdb''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/puppetdb.rb:71:in `query_puppetdb''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions/puppetdb_query.rb:8:in `puppetdb_query''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:60:in `invoke''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:43:in `block in dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:42:in `dispatch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:42:in `stack''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:305:in `block in call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:303:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:976:in `call_function_with_block''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:945:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:94:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1289:in `block in unfold''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1284:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1284:in `unfold''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:945:in `eval_CallNamedFunctionExpression''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:49:in `block in visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:96:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:42:in `stack''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:737:in `eval_Program''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:49:in `block in visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:43:in `visit_this''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:96:in `visit_this_1''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:81:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:125:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:30:in `safeevaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:137:in `evaluate_code''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:79:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:71:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:594:in `evaluate_main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:166:in `block (2 levels) in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:166:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:274:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:155:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:34:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:307:in `block (2 levels) in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:305:in `block in compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:233:in `block in benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:232:in `benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:303:in `compile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:56:in `block in find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/node/environment.rb:423:in `with_text_domain''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:55:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:223:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:232:in `block in main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:274:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:207:in `main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:177:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:687:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:143:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10165', 'https://github.com/puppetlabs/puppet/pull/7893', '2019-12-07T01:18:22.000-0800', '2020-01-12T12:01:52.000-0800', '2020-01-12T12:01:52.000-0800', 'Resolved', 'resolved-issue-added', 3, '0', 1, 33, 9, 2, '381f096a72179e6ead2dacdcf80a7ad3c0c86afc'),
('puppet', 327453, 338085118, 7812, 'User resource on Windows confuses domain and local accounts', '*Puppet Version: 6.4.3 (PE Agent from PE 2019.1.1)*\r\n *Puppet Server Version: PE 2019.1.1*\r\n *OS Name/Version: Tested against Windows 2016*\r\n\r\nBehavior of the user resource goes wonky when an AD account exists that has the same name as the local user account you’re trying to manage on a Windows server that is domain-joined.\r\n\r\n*Desired Behavior:*\r\n\r\nEnforcing configuration of local user accounts on Windows domain-member servers works normally.\r\n\r\n*Actual Behavior:*\r\n\r\nWhen a user account exists locally on a member server, and a user account with the same name also exists in the Active Directory domain, this happens when setting `ensure=>absent` on that local user account:\r\n * The first puppet run, the local user account is detected, and removed\r\n * The second puppet run, the provider seems to detect the *domain* user account, and tries to delete the account again (from the local user database), which fails with this error:\r\n\r\nCould not set ''absent'' on ensure: (in OLE method `Delete'': )\r\nOLE error code:800708AD in Active Directory\r\nThe user name could not be found.\r\nHRESULT error code:0x80020009\r\nException occurred. (file: /etc/puppetlabs/code/environments/development/site-modules/profile/manifests/base.pp, line: 98)\r\nWrapped exception:\r\n(in OLE method `Delete'': )\r\nOLE error code:800708AD in Active Directory\r\nThe user name could not be found.\r\nHRESULT error code:0x80020009\r\nException occurred.\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10057', 'https://github.com/puppetlabs/puppet/pull/7812', '2019-10-01T02:11:17.000-0700', '2020-01-12T12:58:59.000-0800', '2020-01-12T12:58:59.000-0800', 'Resolved', 'resolved-issue-added', 2, '0', 1, 101, 28, 2, '5ecd2ea5b6ac97477a73d785a344e5e6fc340fc6'),
('puppet', 290075, 349994741, 7872, 'HP-UX usermod syntax is incorrect', '*Puppet Version:*\r\n*Puppet Server Version:*\r\n*OS Name/Version:*\r\n\r\nDescribe your issue in as much detail as possible…\r\nDescribe steps to reproduce…\r\n\r\n*Desired Behavior:*\r\n\r\n\r\n*Actual Behavior:*\r\n\r\n\r\nPlease take a moment and attach any relevant log output and/or manifests. This will help us immensely when troubleshooting the issue.\r\n\r\nExamples:\r\nRun puppet agent with --test --trace --debug\r\n\r\nRelevant sections of {{/var/log/puppetlabs/puppetserver/puppetserver.log}} or any applicable logs from the same directory.\r\n\r\nFor more detailed information turn up the server logs by upping the log level in the server''s logback.xml\r\n\r\nRelevant sections of configurations files (puppet.conf, hiera.conf, Server''s conf.d, defaults/sysconfig)\r\n\r\nFor memory issues with server heap dumps are also helpful.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9391', 'https://github.com/puppetlabs/puppet/pull/7872', '2019-01-02T08:20:54.000-0800', '2020-01-12T13:02:42.000-0800', '2020-01-12T13:02:42.000-0800', 'Resolved', 'resolved-issue-added', 5, '0', 1, 3, 3, 2, '7a13ac89bb1cf9631f5e0a86b6c31f055b3d371a'),
('puppet', 331590, 338720008, 7814, 'Package provider removes colon from package name', 'Hello,\r\n\r\nthe puppet-agent in version 6.9.0 (I am not sure on which version bug appeared first) has broken package provider in a way than it "eats" colon ":" from package name.\r\n\r\nWhich breaks package/slot handling on Gentoo Linux.\r\n\r\nOn Gentoo you can install package with emerge to a specific version slot by specifying slot after package name separated with a colon eg.:\r\n\r\n"emerge dev-db/postgresql:11"\r\n\r\nOn puppet-agent version 6.7.2 it was working alright.\r\n\r\nBest regards\r\n\r\nAM\r\n\r\n \r\n\r\nError message:\r\n\r\nError: /Stage[main]/Package::Dev_db::Postgresql/Package[dev-db/postgresql:11]/ensure: change from ''absent'' to ''present'' failed: Execution of ''/usr/bin/emerge dev-db/postgresql11'' returned 1: These are the packages that would be merged, in order:\r\n \r\nCalculating dependencies ... done! \r\n \r\nemerge: there are no ebuilds to satisfy "dev-db/postgresql11".\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10124', 'https://github.com/puppetlabs/puppet/pull/7814', '2019-10-23T02:33:07.000-0700', '2020-01-13T14:14:14.000-0800', '2020-01-13T14:14:14.000-0800', 'Resolved', 'bug;linux;package;provider;resolved-issue-added', 4, '0', 1, 7, 7, 2, '8c1da3b05be88bda2c1a6d60d4c457c17720e708'),
('puppet', 328673, 343340783, 7854, 'Protect against binary diffs', '*Puppet Version:* 5.5.16\r\n*Puppet Server Version:* PE 2018.1.9\r\n*OS Name/Version:* RHEL 7.6\r\n\r\n*Desired Behavior:*\r\n\r\n{{puppet agent}} can manage the contents of a {{file}} resource that uses a {{Binary}} type for its contents, with behavior consistent with {{puppet apply}} running the same manifest.\r\n\r\n*Actual Behavior:*\r\n\r\nAttempting to write binary file content represented in hex as {{c7 d1 fc 84}}, converted to base64 and passed as {{Binary(''x9H8hA=='')}}, editing {{/etc/puppetlabs/code/environments/production/manifests/site.pp}}:\r\n\r\n{code}\r\n[root@pe-201819-master manifests]# cat site.pp\r\n## site.pp ##\r\n\r\n# This file (/etc/puppetlabs/puppet/manifests/site.pp) is the main entry point\r\n...\r\nnode default {\r\n  # This is where you can declare classes for all nodes.\r\n  # Example:\r\n  #   class { ''my_class'': }\r\n  file { ''/tmp/test'':\r\n    ensure  => present,\r\n    content => Binary(''x9H8hA==''),\r\n  }\r\n}\r\n\r\n[root@pe-201819-master manifests]# puppet apply site.pp\r\nNotice: Compiled catalog for pe-201819-master.puppetdebug.vlan in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/Node[default]/File[/tmp/test]/ensure: defined content as ''{md5}387d16f3cb61048e6fb16cfd81367ce8''\r\nNotice: Applied catalog in 0.20 seconds\r\n\r\n[root@pe-201819-master manifests]# od -t x1 /tmp/test\r\n0000000 c7 d1 fc 84\r\n0000004\r\n{code}\r\n\r\nThis is the expected result of applying the manifest. {{puppet apply}} works as expected.\r\n\r\nRunning as {{puppet agent}} fails:\r\n\r\n{code}\r\n[root@pe-201819-master manifests]# puppet agent --test\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201819-master.puppetdebug.vlan\r\nInfo: Applying configuration version ''1570644420''\r\nNotice: /Stage[main]/Main/Node[default]/File[/tmp/test]/content: Received a Log attribute with invalid encoding:"\n--- /tmp/test\t2019-10-09 18:06:34.850138853 +0000\n+++ /tmp/puppet-file20191009-20057-12z3c2w\t2019-10-09 18:07:15.397076080 +0000\n@@ -1 +1 @@\n-\xC7\xD1\xFC\x84\n\\ No newline at end of file\n+x9H8hA==\n\\ No newline at end of file\n"\nBacktrace:\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:190:in `newmessage''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:313:in `initialize''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:88:in `new''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:88:in `create''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:11:in `send_log''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:20:in `block (2 levels) in <module:Logging>''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:45:in `block in checksum_insync?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:19:in `write_temporarily''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:44:in `checksum_insync?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/content.rb:104:in `insync?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:278:in `safe_insync?''\r\nNotice: /Stage[main]/Main/Node[default]/File[/tmp/test]/content: content changed ''{md5}387d16f3cb61048e6fb16cfd81367ce8'' to ''{md5}1567c6c4f10f34202b0f7578d8d44e43''\r\nNotice: Applied catalog in 21.24 seconds\r\n{code}\r\n\r\nExcerpted with debug logging:\r\n\r\n{code}\r\n...\r\n2019-10-09 18:25:28 +0000 Puppet (debug): Executing: ''diff -u /tmp/test /tmp/puppet-file20191009-29036-thyi2b''\r\n2019-10-09 18:25:28 +0000 /Stage[main]/Main/Node[default]/File[/tmp/test]/content (notice): Received a Log attribute with invalid encoding:"\n--- /tmp/test\t2019-10-09 18:25:21.809153889 +0000\n+++ /tmp/puppet-file20191009-29036-thyi2b\t2019-10-09 18:25:28.063298027 +0000\n@@ -1 +1 @@\n-\xC7\xD1\xFC\x84\n\\ No newline at end of file\n+x9H8hA==\n\\ No newline at end of file\n"\nBacktrace:\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:190:in `newmessage''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:313:in `initialize''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:88:in `new''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:88:in `create''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:11:in `send_log''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/logging.rb:20:in `block (2 levels) in <module:Logging>''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:45:in `block in checksum_insync?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:19:in `write_temporarily''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:44:in `checksum_insync?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/content.rb:104:in `insync?''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:278:in `safe_insync?''\r\n2019-10-09 18:25:28 +0000 Puppet (debug): Executing: ''diff -u /tmp/test /tmp/puppet-file20191009-29036-2dqm05''\r\n2019-10-09 18:25:28 +0000 /Stage[main]/Main/Node[default]/File[/tmp/test]/content (notice):\r\n2019-10-09 18:25:28 +0000 /Stage[main]/Main/Node[default]/File[/tmp/test]/content (notice): content changed ''{md5}387d16f3cb61048e6fb16cfd81367ce8'' to ''{md5}1567c6c4f10f34202b0f7578d8d44e43'' (corrective)\r\n2019-10-09 18:25:28 +0000 /Stage[main]/Main/Node[default]/File[/tmp/test] (debug): The container Node[default] will propagate my refresh event\r\n...\r\n{code}\r\n\r\nThe file is created, but with the base64 content written as a string:\r\n\r\n{code}\r\n[root@pe-201819-master manifests]# od -t x1 /tmp/test\r\n0000000 78 39 48 38 68 41 3d 3d\r\n0000010\r\n\r\n[root@pe-201819-master manifests]# cat /tmp/test\r\nx9H8hA==\r\n{code}\r\n\r\nmd5 of the incorrect content ends in {{4e43}}. md5 of the correct content ends in {{7ce8}}.', 'https://tickets.puppetlabs.com/browse/PUP-10097', 'https://github.com/puppetlabs/puppet/pull/7854', '2019-10-09T11:15:34.000-0700', '2020-01-13T14:15:09.000-0800', '2020-01-13T14:15:09.000-0800', 'Resolved', 'beginner;resolved-issue-added', 15, '0', 2, 114, 4, 3, 'ca1ae19e74699a7a0b37893c2ac04344f11bff0a'),
('puppet', 337748, 349193644, 7867, 'Observe server_list for CA requests', 'puppet does not observe the {{server_list}} setting when making CA requests. This is a regression introduced in https://tickets.puppetlabs.com/browse/PUP-10040 as it wasn''t apparent that {{Puppet::Rest::Routes}} called {{Puppet::Util::Connection.determine_server}} to set the {{@default_server}}.\r\n\r\nWe need to enable the server_list resolver such that:\r\n\r\n# If we successfully resolved the CA server/port once in a session, then we should always reuse that same server/port \r\n# Next if SRV records are enabled, we should try to connect to each entry. If that fails, fallback to #3\r\n# Next if {{server_list}} is set and {{ca_server}} is not set explicitly (so inherits {{server}}), we should try each server/port combo. If the list is exhausted, raise an error.\r\n# Next fallback to {{ca_server}} setting which defaults to {{server}}. If that fails, fallback to #5\r\n# Raise no more routes to try\r\n\r\nNote we are preserving the old behavior of "if the server list is exhausted, raise an error" instead of falling back to settings.', 'https://tickets.puppetlabs.com/browse/PUP-10157', 'https://github.com/puppetlabs/puppet/pull/7867', '2019-12-03T21:40:09.000-0800', '2020-01-13T14:30:24.000-0800', '2020-01-13T14:30:24.000-0800', 'Resolved', 'resolved-issue-added', 3, '0', 1, 95, 23, 4, '0ba90f74295f59c11a16eb7530cc20b0a4aedb4b'),
('puppet', 337552, 349663440, 7868, 'Cumulus v4.0.0 support', 'Cumulus recently released v4.0.0 of it''s operating system: [https://cumulusnetworks.com/about/press-releases/fourth-generation-launch/]\r\n\r\nI''ve been hitting issues when running Puppet on this, some service definitions that previously worked are no longer valid:\r\n{code:java}\r\nDebug: Service[collectd@mgmt.service](provider=debian): Could not find collectd@mgmt.service in /etc/init.d\r\nDebug: Service[collectd@mgmt.service](provider=debian): Could not find collectd@mgmt.service.sh in /etc/init.d{code}\r\nLooking at the provider code: [https://github.com/puppetlabs/puppet/blob/4f6e758348d6f5e8a287f90f4ea04d9ffec0e4d1/lib/puppet/provider/service/systemd.rb#L28]\r\n\r\nIt seems that this needs to be updated to support Cumulus v4 as well.  I''m not sure if there''s other work involved here in adding a new OS version.', 'https://tickets.puppetlabs.com/browse/PUP-10162', 'https://github.com/puppetlabs/puppet/pull/7868', '2019-12-03T12:30:35.000-0800', '2020-01-13T15:09:13.000-0800', '2020-01-13T15:09:13.000-0800', 'Closed', 'resolved-issue-added', 5, '0', 1, 1, 1, 1, '15ed9d149d216697269e9ee8ce32630c12cc00e1'),
('puppet', 341094, 360335819, 7915, 'Unable to create local user when username already exists in Windows domain', '*Puppet Version: 6.3.0*\r\n *Puppet Server Version: N/A (happens with puppet apply)*\r\n *OS Name/Version: Windows Server 2012 R2 (and I believe other Windows OS'')*\r\n\r\nWhen using the below user resource declaration on a domain joined computer that also has a user called ''test_user'' in the domain an error is thrown and the user is not created.\r\n{quote}{{user { ''test_user'':}}\r\n{{  ensure   => present,}}\r\n{{  comment  => ''Test user'',}}\r\n{{  password => ''user_pass'',}}\r\n{{  groups   => [''Administrators''],}}\r\n{{}}}\r\n{quote}\r\nThe name of the user to be created, whether noop is on/off and whether using puppet apply or puppet agent do not matter.\r\n\r\n*Desired Behavior:*\r\n\r\nA local user with the same name is created on the computer using the attributes specified.\r\n\r\n*Actual Behavior:*\r\n\r\nThe following output is produced:\r\n{quote}{{Notice: Compiled catalog for member.domain.com in environment production in 0.02 seconds}}\r\n{{Error: /Stage[main]/Main/User[test_user]: Could not evaluate: ADSI connection error: failed to parse display name of moniker `WinNT://./test_user,user''}}\r\n{{  HRESULT error code:0x800708ad}}\r\n{{    The user name could not be found.}}\r\n{{Wrapped exception:}}\r\n{{failed to parse display name of moniker `WinNT://./test_user,user''}}\r\n{{  HRESULT error code:0x800708ad}}\r\n{{    The user name could not be found.}}\r\n{{Notice: Applied catalog in 0.04 seconds}}{quote}\r\n \r\n\r\n*Partial workaround:*\r\n\r\nIf we change the manifest to the one shown below then the user is created successfully when not in noop mode:\r\n{quote}{{$username  = ''test_user''}}\r\n{{$user_pass = ''user_pass''}}\r\n{{exec { ''create local user first'':}}\r\n{{  command => "${system32}/net.exe user ${username} ${user_pass} /add /y",}}\r\n{{  unless  => "${system32}/net.exe user ${username}",}}\r\n{{  before  => User[$username],}}\r\n{{}}}\r\n{{user { $username:}}\r\n{{  ensure   => present,}}\r\n{{  comment  => ''Test user'',}}\r\n{{  password => $user_pass,}}\r\n{{  groups   => [''Administrators''],}}\r\n{{}}}{quote}\r\nIn noop mode the error still appears.\r\n\r\n*Other information:*\r\n\r\nAccording to the documentation ([https://puppet.com/docs/puppet/latest/types/user.html#user-provider-windows_adsi]) the user resource is for local user management and hence shouldn''t be effected by domain users.\r\n\r\nI think the issue lies in the fact that *principal.rb* uses ''*LookupAccountSidW*'' which specifies that if an account can''t be found on the local system it tries to resolve it using domain controllers. [https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-lookupaccountsidw]\r\n\r\nThis is not the behaviour wanted when managing a local user but it looks like the same code is also being used for finding users to be placed as members of groups which does allow domain users.\r\n\r\nI''m wondering if it''s possible to separate the local user management out and use ''*LookupAccountSidLocalW*'' which only looks on the local machine for the account. [https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-lookupaccountsidlocalw]\r\n\r\nA trace log with the original resource declaration is attached\r\n\r\n[^user-trace.log]\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10219', 'https://github.com/puppetlabs/puppet/pull/7915', '2020-01-05T23:31:30.000-0800', '2020-01-13T16:55:23.000-0800', '2020-01-13T16:55:23.000-0800', 'Resolved', 'puppet-agent;puppet-apply;resolved-issue-added;type_and_provider;windows', 9, '0', 1, 9, 1, 2, 'f017013aa721bc4926f0fbed1515629f9d2dfa4a'),
('puppet', 324443, 333002220, 7792, 'User resource always reports password changed when account disabled for Win 2012 R2', 'This case is already fixed with PUP 4.6.1. Corresponding JIRA case " https://tickets.puppetlabs.com/browse/PUP-6586".\r\n\r\nHowever, latest version 6.x, the issue still persists.( PE Version 2019.1.1)\r\n\r\n```\r\nPS C:\Program Files\Puppet Labs\Puppet\bin> .\puppet.bat apply -e "user { ''mcoad\r\nmin'': ensure => present, password => ''password@123''}"\r\nNotice: Compiled catalog for b3apzcy9g7ci4uo.delivery.puppetlabs.net in environm\r\nent production in 0.02 seconds\r\nNotice: /Stage[main]/Main/User[mcoadmin]/ensure: created\r\nNotice: Applied catalog in 0.21 seconds\r\nPS C:\Program Files\Puppet Labs\Puppet\bin> .\puppet.bat apply -e "user { ''mcoad\r\nmin'': ensure => present, password => ''password@1234''}"\r\nNotice: Compiled catalog for b3apzcy9g7ci4uo.delivery.puppetlabs.net in environm\r\nent production in 0.02 seconds\r\nWarning: User[mcoadmin](provider=windows_adsi): The user account ''mcoadmin'' is d\r\nisabled; puppet will not reset the password\r\nNotice: /Stage[main]/Main/User[mcoadmin]/password: changed [redacted] to [redact\r\ned]\r\nNotice: Applied catalog in 0.08 seconds\r\n```\r\nThis issue has not appeared over 5.5.x version ( PE Version 2018.1.5)\r\n\r\n```\r\nPS C:\Program Files\Puppet Labs\Puppet\bin> .\puppet.bat apply user1.pp\r\nNotice: Compiled catalog for ms2012.ldap.plab in environment production in 0.02 seconds\r\nNotice: /Stage[main]/User1/User[mcoadmin]/password: changed password\r\nNotice: Applied catalog in 0.23 seconds\r\nPS C:\Program Files\Puppet Labs\Puppet\bin> .\puppet.bat apply user1.pp\r\nNotice: Compiled catalog for ms2012.ldap.plab in environment production in 0.02 seconds\r\nNotice: Applied catalog in 0.47 seconds\r\n```\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10021', 'https://github.com/puppetlabs/puppet/pull/7792', '2019-09-11T19:37:46.000-0700', '2020-01-14T09:35:19.000-0800', '2020-01-14T09:35:19.000-0800', 'Resolved', 'resolved-issue-added', 7, '0', 1, 2, 2, 1, 'a1add95a949fd14a3c48d2349803a28cae6c9d36'),
('puppet', 281272, 244526592, 7335, 'Puppet pidlock checks only look for PID if it is running, not process name', '*Puppet Version: 6.0.2 (or any)*\r\n *Puppet Server Version:  2018.1*\r\n *OS Name/Version: Windows (linux most likely as well)*\r\n\r\nWhen puppet runs it created the pidlock file with the pid of puppet.  If puppet stops/crashes while running the lock file remains.  Puppet reads the file, checks for pid as integer, and sees if that pid is running (system.kill(0) to see if alive). If ANY PID responds, it locks, even if the PID is not a puppet PID.\r\n\r\n*Desired Behavior: Puppet should check PID to see if it is running and its puppet, not just running.*\r\n\r\n*Actual Behavior: if any process has that pid, puppet locks.*\r\n\r\nSteps to replicate (tested on windows 2016 with Puppet 6.0.2)\r\n\r\n1 - start puppet run with ''puppet agent -t''\r\n\r\n2 - while running stop the puppet/puppet-pxp agent services\r\n\r\n3 - open pidloclk file, there should be a PID there\r\n\r\n4 - change PID lock file contents to any other currently running PID\r\n\r\n5 - start puppet / run ''puppet agent -t''\r\n\r\n \r\n\r\nAffected Code: [https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/pidlock.rb#L55]\r\n\r\nThis is the logic check that only determines if a pid is active, not who owns it.', 'https://tickets.puppetlabs.com/browse/PUP-9247', 'https://github.com/puppetlabs/puppet/pull/7335', '2018-10-18T13:07:23.000-0700', '2020-01-22T22:29:44.000-0800', '2020-01-22T22:29:44.000-0800', 'Closed', 'agent;cspapercuts;linux;puppet-agent;windows', 1, '0', 1, 105, 2, 3, 'e165f2d5f4130d1bfceb4cd8eda86093181693b4'),
('puppet', 23138, 11631706, 2270, 'Windows File: Error: ReplaceFile is unable to find file (or file resources generating 0 byte files): replace_file errors', 'Module to reproduce the issue is here: \r\nhttps://github.com/openstack-hyper-v/puppet-jenkins/\r\n\r\nSpecifically the slave.pp file and the windows file components found in it.\r\n\r\n{noformat}\r\nNotice: /Stage[main]/Jenkins::Slave/File[C:\ProgramData\jenkins-slave\jenkins-slave.xml]/content:\r\n\r\nInfo: FileBucket got a duplicate file {md5}d41d8cd98f00b204e9800998ecf8427e\r\nInfo: /Stage[main]/Jenkins::Slave/File[C:\ProgramData\jenkins-slave\jenkins-slave.xml]: Filebucketed\r\n C:/ProgramData/jenkins-slave/jenkins-slave.xml to puppet with sum d41d8cd98f00b204e9800998ecf8427e\r\nError: ReplaceFile(C:/ProgramData/jenkins-slave/jenkins-slave.xml, C:/ProgramData/jenkins-slave/jenkins-slave.xml20140107-2944-124j5d4):  The system cannot find the file specified.\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/file.rb:14:in `replace_file''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:456:in `replace_file''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/type/file.rb:720:in `write''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/type/file/content.rb:150:in `sync''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harness.rb:193:in `sync''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harness.rb:130:in `sync_if_needed''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harness.rb:82:in `block in perform_changes''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harness.rb:81:in `each''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harness.rb:81:in `perform_changes''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harness.rb:18:in `evaluate''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:174:in `apply''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:187:in `eval_resource''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:117:in `call''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:117:in `block (2 levels) in evaluate''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:327:in `block in thinmark''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/sys/ruby/lib/ruby/1.9.1/benchmark.rb:295:in `realtime''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:326:in `thinmark''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:117:in `block in evaluate''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/graph/relationship_graph.rb:118:in `traverse''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:108:in `evaluate''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/resource/catalog.rb:164:in `block in apply''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util/log.rb:149:in `with_destination''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/transaction/report.rb:108:in `as_logging_destination''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/resource/catalog.rb:163:in `apply''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:125:in `block in apply_catalog''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:161:in `block in benchmark''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/sys/ruby/lib/ruby/1.9.1/benchmark.rb:295:in `realtime''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:160:in `benchmark''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:124:in `apply_catalog''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:192:in `run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:44:in `block (4 levels) in run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent/locker.rb:20:in `lock''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:44:in `block (3 levels) in run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:114:in `with_client''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:41:in `block (2 levels) in run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:79:in `run_in_fork''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:40:in `block in run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:179:in `call''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:179:in `controlled_run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:38:in `run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application/agent.rb:355:in `onetime''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application/agent.rb:321:in `run_command''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:364:in `block (2 levels) in run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:470:in `plugin_hook''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:364:in `block in run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:478:in `exit_on_fail''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:364:in `run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util/command_line.rb:137:in `run''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/lib/puppet/util/command_line.rb:91:in `execute''\r\nC:/Program Files (x86)/Puppet Labs/Puppet/puppet/bin/puppet:4:in `<main>''\r\nError: /Stage[main]/Jenkins::Slave/File[C:\ProgramData\jenkins-slave\jenkins-slave.xml]/content: change from {md5}d41d8cd98f00b204e9800998ecf8427e to {md5}7fdfe67c86f483cc0f89d5842da3aab6 failed:\r\nReplaceFile(C:/ProgramData/jenkins-slave/jenkins-slave.xml, C:/ProgramData/jenkins-slave/jenkins-slave.xml20140107-2944-124j5d4):  The system cannot find the file specified.\r\nNotice: /Stage[main]/Jenkins::Slave/Exec[sc_create_service]: Dependency File[C:\ProgramData\jenkins-slave\jenkins-slave.exe] has failures: true\r\nNotice: /Stage[main]/Jenkins::Slave/Exec[sc_create_service]: Dependency File[C:\ProgramData\jenkins-slave\jenkins-slave.xml] has failures: true\r\nWarning: /Stage[main]/Jenkins::Slave/Exec[sc_create_service]: Skipping because of failed dependencies\r\n{noformat}\r\n\r\nError occurs if file present or not.   \r\n\r\nicacls on files causing issues\r\n{noformat}\r\nC:\ProgramData\jenkins-slave>icacls jenkins-slave.exe\r\njenkins-slave.exe BUILTIN\Administrators:(M,WDAC,WO)\r\n                  HV-COMPUTE09\None:(RX,W)\r\n                  Everyone:(RX,W)\r\n                  NT AUTHORITY\SYSTEM:(F)\r\n\r\nSuccessfully processed 1 files; Failed processing 0 files\r\n\r\nC:\ProgramData\jenkins-slave>icacls jenkins-slave.xml\r\njenkins-slave.xml NT AUTHORITY\SYSTEM:(I)(F)\r\n                  BUILTIN\Administrators:(I)(F)\r\n                  BUILTIN\Users:(I)(RX)\r\n\r\nSuccessfully processed 1 files; Failed processing 0 files\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1389', 'https://github.com/puppetlabs/puppet/pull/2270', '2014-01-07T14:17:48.000-0800', '2020-01-25T14:42:23.000-0800', '2020-01-25T14:42:23.000-0800', 'Closed', 'windows', 13, '0', 1, 21, 34, 2, 'aead9c21ae31202bf245a6e79451a11932ed9bb7'),
('puppet', 340709, 367479688, 7944, 'puppet fails with JSON error when a fact value equals Infinity', '*Puppet Version: 6.10 and possibly earlier*\r\n\r\nANY fact converted to / interpreted as (Ruby) {{Infinity}} generates a JSON error when executing {{puppet agent}} or {{puppet facts}} The same error does not occur when executing {{facter -p}}\r\n\r\n*Desired Behavior:*\r\n\r\nNo JSON error via {{puppet}}\r\n\r\n*Actual Behavior:*\r\n\r\n Given:\r\n{code}puppet config print maxwaitforcert\r\nunlimited\r\n{code}\r\nCreate a custom fact for {{maxwaitforcert}}:\r\n{code}Facter.add(''maxwaitforcert'') do\r\n  setcode do\r\n    Puppet.settings[''maxwaitforcert'']\r\n  end\r\nend\r\n{code}\r\n{code}[root@pe-201921-master ~]# puppet facts\r\nError: 862: Infinity not allowed in JSON\r\nError: Try ''puppet help facts find'' for usage\r\n{code}\r\n{code}[root@pe-201921-master ~]# puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nError: Failed to apply catalog: Could not render to json: 862: Infinity not allowed in JSON\r\n{code}\r\nVersus:\r\n{code}[root@pe-201921-master ~]# facter -p maxwaitforcert\r\ninf\r\n{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10210', 'https://github.com/puppetlabs/puppet/pull/7944', '2019-12-26T11:04:37.000-0800', '2020-01-31T04:25:58.000-0800', '2020-01-31T04:25:58.000-0800', 'Closed', '', 15, '0', 1, 9, 5, 3, ''),
('puppet', 255723, 363990062, 7931, '"puppet facts upload" face only tries first master in server_list', '*Puppet Version:* 5.5.1\r\n*Puppet Server Version:* 5.5.2 (2018.1.0.41)\r\n*OS Name/Version:* RHEL 7\r\n\r\nWhen a node''s puppet.conf specifies multiple masters in server_list the facts upload face only tries the first master in the list. If this fails due to a hostname lookup failure on the first master the face exits with an error, rather than trying the second master. \r\n\r\nSteps to reproduce:\r\n\r\n- remove any "server" configs from puppet.conf\r\n- add the following "server_list" configuration: "foo.example,actual-master.example" (where "actual-master.example" is the working master address, and "foo.example" is not resolvable to an IP address)\r\n- run "puppet facts upload"\r\n\r\n*Desired Behavior:*\r\n\r\n- the face should gracefully fail over to the second master in the server_list and complete the facts upload successfully\r\n\r\n*Actual Behavior:*\r\n\r\n- the face fails with the following error message:\r\n\r\n{noformat}\r\n# puppet facts upload\r\nNotice: Uploading facts for ''pe-201730-master.puppetdebug.vlan'' to: ''foo.example''\r\nError: Failed to open TCP connection to foo.example:8140 (getaddrinfo: Name or service not known)\r\nError: Try ''puppet help facts upload'' for usage\r\n{noformat}\r\n\r\nI''m attaching the output of "puppet facts upload --debug --trace" as well. \r\n\r\nThis face (and the facts endpoint in puppetserver) were (re)added in this PR: https://github.com/puppetlabs/puppet/pull/6434\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8900', 'https://github.com/puppetlabs/puppet/pull/7931', '2018-05-31T17:23:28.000-0700', '2020-02-18T09:05:07.000-0800', '2020-02-18T09:05:07.000-0800', 'Resolved', 'resolved-issue-added', 12, '0', 2, 32, 25, 2, '1a00489e8a3e3f8b21007e065eab3675b3164b83'),
('puppet', 310162, 336174636, 7807, 'Cannot run Puppet Agent as Administrator if first PA run is done as System', '*Puppet Version:* 6.4.2\r\n *Puppet Server Version:* N/A\r\n *OS Name/Version:* Windows Server 2016 x64\r\n\r\nWhen installing Puppet Agent (6.4.2/PE 2019.1.0) on Server 2016 using a Powershell script running as the SYSTEM account, Administrator users can''t run Puppet. Daemon/service runs are performed as expected. Direct Puppet runs appear to occur but no report is sent to the master.\r\n *UPDATE* - It the first Run as SYSTEM that is the problem - so have changed ticket title.\r\n\r\nPUP-8939 had reportedly solved this issue.\r\n\r\n*Desired Behavior:*\r\n\r\n*note* - so far, this can only be replicated using scheduled tasks as {{psexec}} doesn''t provide the same permissions environment :\r\n # Install: {{schtasks /create /tn PuppetInstall /RL HIGHEST /RU SYSTEM /F /SC ONCE /ST 11:15 /TR ''cmd /c c:\WINDOWS\system32\WindowsPowerShell\v1.0\powershell.exe -sta -WindowStyle Hidden -ExecutionPolicy Bypass -NonInteractive -NoProfile -File c:\puppet.ps1 >> C:\windows\temp\puppet-ins.log 2>&1''}}\r\n # Run PA {{schtasks /create /tn PuppetInstall /RL HIGHEST /RU SYSTEM /F /SC ONCE /ST 11:17 /TR ''cmd /c c:\WINDOWS\system32\WindowsPowerShell\v1.0\powershell.exe -sta -WindowStyle Hidden -ExecutionPolicy Bypass -NonInteractive -NoProfile -File c:\puppetrun.ps1 >> C:\windows\temp\puppet-run.log 2>&1''}}\r\n # Populate csr_attributes.yml and {{server}} in the agent config as necessary.\r\n # As an Administrator, run {{puppet agent --test}} on the newly installed agent.\r\n\r\n See [https://gist.github.com/jcoconnor/79767ef986a3ec600de0cd84ec4ea600] for example {{puppet-ins.ps1}} and {{puppet-run.ps1}} scripts.\r\n\r\n*Actual Behavior:*\r\n\r\nCatalog retrieval fails; log has been redacted:\r\n{code}2019-05-21 17:20:36 -0400 Puppet (debug): HTTP POST https://compiler.example.net:8140/puppet/v3/catalog/examplenode.example.net returned 200 OK\r\n2019-05-21 17:20:36 -0400 Puppet (debug): Caching connection for https://compiler.example.net:8140\r\n2019-05-21 17:20:36 -0400 Puppet (info): Caching catalog for examplenode.example.net\r\n2019-05-21 17:20:38 -0400 Puppet (err): ReplaceFile(C:/ProgramData/PuppetLabs/puppet/cache/client_data/catalog/examplenode.example.net.json, C:/ProgramData/PuppetLabs/puppet/cache/client_data/catalog/examplenode.example.net.json20190521-6580-blokpv):  Access is denied. \r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/file.rb:89:in `replace_file''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:636:in `replace_file''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/indirector/json.rb:17:in `save''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:200:in `find''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:466:in `block in retrieve_new_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:518:in `block in thinmark''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:517:in `thinmark''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:465:in `retrieve_new_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:75:in `retrieve_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:167:in `prepare_and_retrieve_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:342:in `run_internal''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:240:in `block in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet.rb:264:in `override''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:217:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:59:in `block (5 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/timeout.rb:93:in `block in timeout''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/timeout.rb:103:in `timeout''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:58:in `block (4 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:21:in `lock''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:52:in `block (3 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:130:in `with_client''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:49:in `block (2 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:87:in `run_in_fork''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:48:in `block in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:46:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:371:in `onetime''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:353:in `run_command''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:671:in `exit_on_fail''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:139:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/bin/puppet:4:in `<main>''\r\n2019-05-21 17:20:38 -0400 Puppet (err): Could not retrieve catalog from remote server: ReplaceFile(C:/ProgramData/PuppetLabs/puppet/cache/client_data/catalog/examplenode.example.net.json, C:/ProgramData/PuppetLabs/puppet/cache/client_data/catalog/examplenode.example.net.json20190521-6580-blokpv):  Access is denied. \r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/file.rb:89:in `replace_file''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:636:in `replace_file''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/indirector/json.rb:17:in `save''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:200:in `find''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:466:in `block in retrieve_new_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:518:in `block in thinmark''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:517:in `thinmark''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:465:in `retrieve_new_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:75:in `retrieve_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:167:in `prepare_and_retrieve_catalog''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:342:in `run_internal''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:240:in `block in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet.rb:264:in `override''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:217:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:59:in `block (5 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/timeout.rb:93:in `block in timeout''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/timeout.rb:103:in `timeout''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:58:in `block (4 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:21:in `lock''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:52:in `block (3 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:130:in `with_client''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:49:in `block (2 levels) in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:87:in `run_in_fork''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:48:in `block in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:46:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:371:in `onetime''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:353:in `run_command''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:671:in `exit_on_fail''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:139:in `run''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/bin/puppet:4:in `<main>''\r\n{code}\r\nReporting also fails:\r\n{code}2019-05-21 17:20:38 -0400 Puppet (debug): Using cached connection for https://compiler.example.net:8140\r\n2019-05-21 17:20:39 -0400 Puppet (debug): HTTP PUT https://compiler.example.net:8140/puppet/v3/report/examplenode.example.net returned 200 OK\r\n2019-05-21 17:20:39 -0400 Puppet (debug): Caching connection for https://compiler.example.net:8140\r\n2019-05-21 17:20:39 -0400 Puppet (err): Could not send report: ReplaceFile(C:/ProgramData/PuppetLabs/puppet/cache/state/last_run_report.yaml, C:/ProgramData/PuppetLabs/puppet/cache/state/last_run_report.yaml20190521-6580-1yfrb1r):  Access is denied. \r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/file.rb:89:in `replace_file''\r\n...\r\n{code}\r\nACLs from C:\ProgramData\PuppetLabs\puppet\cache\ on the agent:\r\n{code}PS C:\Windows\system32> Get-Acl C:\ProgramData\PuppetLabs\puppet\cache\ | Select *\r\n\r\nPSPath : Microsoft.PowerShell.Core\FileSystem::C:\ProgramData\PuppetLabs\puppet\cache\\r\nPSParentPath : Microsoft.PowerShell.Core\FileSystem::C:\ProgramData\PuppetLabs\puppet\r\nPSChildName : cache\r\nPSDrive : C\r\nPSProvider : Microsoft.PowerShell.Core\FileSystem\r\nCentralAccessPolicyId :\r\nCentralAccessPolicyName :\r\nPath : Microsoft.PowerShell.Core\FileSystem::C:\ProgramData\PuppetLabs\puppet\cache\\r\nOwner : NT AUTHORITY\SYSTEM\r\nGroup : NT AUTHORITY\SYSTEM\r\nAccess : {System.Security.AccessControl.FileSystemAccessRule,\r\nSystem.Security.AccessControl.FileSystemAccessRule,\r\nSystem.Security.AccessControl.FileSystemAccessRule}\r\nSddl : O:SYG:SYD:AI(A;OICIID;FA;;;SY)(A;OICIID;FA;;;BA)(A;OICIID;FA;;;S-1-5-21-1092630797-2642148860\r\n-572411492-162715)\r\nAccessToString : NT AUTHORITY\SYSTEM Allow FullControl\r\nBUILTIN\Administrators Allow FullControl\r\nDEVAONNET\ah14740 Allow FullControl\r\nAuditToString :\r\nAccessRightType : System.Security.AccessControl.FileSystemRights\r\nAccessRuleType : System.Security.AccessControl.FileSystemAccessRule\r\nAuditRuleType : System.Security.AccessControl.FileSystemAuditRule\r\nAreAccessRulesProtected : False\r\nAreAuditRulesProtected : False\r\nAreAccessRulesCanonical : True\r\nAreAuditRulesCanonical : True\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9719', 'https://github.com/puppetlabs/puppet/pull/7807', '2019-05-24T12:40:19.000-0700', '2020-02-18T09:07:00.000-0800', '2020-02-18T09:07:00.000-0800', 'Resolved', 'resolved-issue-added', 11, '0', 1, 93, 35, 10, '2ec4c89073d994fbee9b0abe4bfd16bcd66855f7'),
('puppet', 338721, 364871829, 7936, 'Generalize forcelocal parameter use for user/group resources', 'Currently, the {{forcelocal}} parameter forces the management of local accounts/groups when they are also being managed by some other NSS. However, this parameter is wrongly coupled with the {{libuser}} feature, which is a platform-specific application.\r\n\r\nThis parameter can also be used on AIX and Windows, but due to the way it was implemented it is impossible to do so.\r\n\r\nPUP-9465 and PUP-10168 are tasked with separating the libuser functionality from the useradd/groupadd providers into a separate libuser provider.\r\n\r\nWhen that work is complete, we can work on generalizing the {{forcelocal}} parameter:\r\n- add a new feature called {{manages_local_users/groups}}\r\n- remove the {{libuser}} feature\r\n- make {{forcelocal}} require the new {{manages_local_users/groups}} feature instead\r\n- update impacted providers accordingly', 'https://tickets.puppetlabs.com/browse/PUP-10169', 'https://github.com/puppetlabs/puppet/pull/7936', '2019-12-10T01:15:59.000-0800', '2020-02-18T09:10:05.000-0800', '2020-02-18T09:10:05.000-0800', 'Resolved', 'resolved-issue-added', 0, '0', 1, 40, 25, 11, 'd5604609d743539d3fd3a89b375657f9ea407e51'),
('puppet', 40051, 366177063, 7940, '"Array" settings get misleading formatting for default values and error reporting', 'From the user''s perspective, the new ":array" settings type is just a comma separated list, like we use in existing settings like {{dns_alt_names}} or {{tags}}. But the default values and error reporting for the {{disable_warnings}} setting aren''t formatted with this in mind, and are presented in a confusing fashion:\r\n \r\n{code}\r\nError: Could not initialize global default settings: Cannot disable unrecognized warning types ["stuff"]. Valid values are ["deprecations"].\r\n{code}\r\n\r\nSee also the config reference, which shows the default value as "[]". (http://docs.puppetlabs.com/references/latest/configuration.html#disablewarnings) \r\n\r\nIf you try to follow these hints and give a value like {{[deprecations]}}, you get:\r\n\r\n{code}\r\nError: Could not initialize global default settings: Cannot disable unrecognized warning types ["[deprecations"]"]. Valid values are ["deprecations"].\r\n{code}\r\n\r\nBoo. The UI is a comma-separated list without brackets, so any error or information reporting should present that same UI.', 'https://tickets.puppetlabs.com/browse/PUP-2820', 'https://github.com/puppetlabs/puppet/pull/7940', '2014-06-23T10:28:47.000-0700', '2020-02-18T09:15:16.000-0800', '2020-02-18T09:15:16.000-0800', 'Resolved', 'beginner;help_wanted;resolved-issue-added;simplefix', 5, '0', 1, 2, 2, 1, '6dad99e04778293191d0408bd90485f041b9410c'),
('puppet', 346292, 375432788, 7985, 'Order dependent test failure with recent pidlock changes', '{noformat}\r\n$ bundle exec ruby --version\r\nruby 2.3.8p459 (2018-10-18 revision 65136) [x86_64-darwin18]\r\n$ git rev-parse HEAD\r\n88cb4f20657b9ea7b9eafc34a6039bde5102c5cd\r\n$ bundle exec rspec spec/unit/agent_spec.rb:220  spec/unit/util/pidlock_spec.rb:23\r\n...\r\n  1) Puppet::Util::Pidlock#ps pid argument on posix should allow ps execution\r\n     Failure/Error: expect(@lock).to be_locked\r\n       expected `#<Puppet::Util::Pidlock:0x00007fd1d5a5f308 @lockfile=#<Puppet::Util::Lockfile:0x00007fd1d5a5f2e0 @fil...ers/8m/d6146zxd6bv_3h8y4ykvvxh40000gn/T/rspecrun20200213-39510-1m2gjzq/lock20200213-39510-15x8lj0">>.locked?` to return true, got false\r\n     # ./spec/unit/util/pidlock_spec.rb:23:in `block (3 levels) in <top (required)>''\r\n     # ./spec/spec_helper.rb:180:in `block (2 levels) in <top (required)>''\r\n\r\nFinished in 0.11031 seconds (files took 0.99606 seconds to load)\r\n2 examples, 1 failure\r\n{noformat}\r\n\r\nRunning the pidlock spec in isolation works fine, so something about the agent_spec is leaking into the other test.', 'https://tickets.puppetlabs.com/browse/PUP-10294', 'https://github.com/puppetlabs/puppet/pull/7985', '2020-02-13T16:57:21.000-0800', '2020-02-20T23:59:33.000-0800', '2020-02-20T23:59:33.000-0800', 'Resolved', '', 1, '0', 1, 36, 24, 1, '6d248816c5b02c2023d67624ca23c6ecd7d429d8'),
('puppet', 129419, 126738816, 6002, 'Cannot convert Puppet::Util::Log to integer', 'Re-creating [this issue|https://projects.puppetlabs.com/issues/22930]. There seems to be a bug in a particular method where an integer return value is expected, but a log object is returned instead. This prevents the exception from bubbling up into an error that the user can actually understand', 'https://tickets.puppetlabs.com/browse/PUP-6256', 'https://github.com/puppetlabs/puppet/pull/6002', '2016-05-02T13:40:35.000-0700', '2020-02-21T14:40:29.000-0800', '2020-02-21T14:40:29.000-0800', 'Closed', '', 2, '0', 1, 12, 0, 2, '42f1f27d914576be95b8745b6015897993f9aea3'),
('puppet', 278499, 220520209, 7145, 'puppet ignores exit code from windows exe package install because it uses ''start''', 'This effects all supported versions of puppet:\r\n\r\nWe use "cmd /c start" to execute exe package installs on Windows: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/windows/exe_package.rb#L45. Comments suggest this is because otherwise executables that are console apps will launch a new window (which is undesired).\r\n\r\nHowever, the use of "start" means the calling process (i.e. puppet) will never see the actual exit code from the installation, only the exit code from the call to start (which will be 0: success) \r\n\r\nThis means from puppet''s perspective exe package installs _always_ succeed and puppet will always report a successful installation, regardless of whether or not the application install actually succeeded.', 'https://tickets.puppetlabs.com/browse/PUP-9193', 'https://github.com/puppetlabs/puppet/pull/7145', '2018-10-02T09:18:12.000-0700', '2020-02-24T12:04:34.000-0800', '2020-02-24T12:04:34.000-0800', 'Closed', 'package;type_and_provider;windows', 2, '0', 1, 43, 20, 8, '1a83c51e64a3a813f68144b5d08314b3284725a8'),
('puppet', 16393, 45040047, 4248, '(#22719) Allow exec to runas different user on windows', 'The `exec` type has a `user` parameter that allows the exec to be performed as a different user. On Windows, this functionality is not supported, because unlike *nix, we can''t switch users without the password.\r\n\r\nTo support this feature, we would need to add a `password` parameter to the `exec` type, and modify the SUIDManager to support switching users on Windows.', 'https://tickets.puppetlabs.com/browse/PUP-532', 'https://github.com/puppetlabs/puppet/pull/4248', '2013-10-08T09:26:33.000-0700', '2020-02-25T14:24:56.000-0800', '2020-02-25T14:24:56.000-0800', 'Ready for Engineering', 'exec;windows', 5, '0', 1, 14, 1, 3, '89aeafb2ed888fed5292b8ced8d6131aafb86f27'),
('puppet', 19915, 216795231, 7105, 'Puppet silent about inability to acquire pidlock', 'The {{--verbose}} flag does tell the user that something has happened, but without it there isn''t any indication. I would expect the error to always show up (even without verbose) and a non-zero exit status.\r\n\r\n{noformat}\r\nroot@debian-607-x64-vf503-nocm:~# puppet agent --verbose\r\nError: Could not run: Could not create PID file: /var/run/puppet/agent.pid\r\nroot@debian-607-x64-vf503-nocm:~# echo $?\r\n0\r\nroot@debian-607-x64-vf503-nocm:~# puppet agent\r\nroot@debian-607-x64-vf503-nocm:~# echo $?\r\n0\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-911', 'https://github.com/puppetlabs/puppet/pull/7105', '2013-12-02T15:26:19.000-0800', '2020-02-26T16:31:25.000-0800', '2020-02-26T16:31:25.000-0800', 'Closed', '', 11, '0', 1, 38, 3, 2, 'f389743b4b730aede26591bde35d7d1398587b3d'),
('puppet', 36799, 378548485, 7993, 'puppet describe --list requires the description to include a period', 'Given this code:\r\n\r\n{code:ruby}\r\n    Puppet::Type.newtype(:rcsrepo) do\r\n      desc ''A local version control repository''\r\n      ensurable\r\n      ...\r\n    end\r\n{code}\r\n\r\nI see this behavior.\r\n\r\n{noformat}\r\n    [root@master ~]# puppet describe --list | grep rcsrepo\r\n    rcsrepo         - .. no documentation ..\r\n    [root@master ~]# puppet describe rcsrepo\r\n \r\n    rcsrepo\r\n    =======\r\n    A local version control repository\r\n{noformat}\r\n\r\nIf I add a period at the end, `puppet describe --list` outputs as expected.\r\n\r\nSee [https://github.com/puppetlabs/puppet/blob/master/lib/puppet/application/describe.rb#L73](https://github.com/puppetlabs/puppet/blob/master/lib/puppet/application/describe.rb#L73)\r\n\r\nWhy is this?', 'https://tickets.puppetlabs.com/browse/PUP-2641', 'https://github.com/puppetlabs/puppet/pull/7993', '2014-05-22T14:30:13.000-0700', '2020-02-28T19:17:21.000-0800', '2020-02-28T19:17:21.000-0800', 'Resolved', 'beginner;help_wanted;redmine', 3, '0', 2, 95, 55, 2, 'ba60582c489635317535c2ee6f053c5da1e0334f'),
('puppet', 338977, 360067286, 7906, 'Cannot change flavor on installed dnf module', '*Puppet Version:* 6.11.0\r\n *OS Name/Version:* CentOS/RHEL/Fedora\r\n\r\nApply the following manifest installing the postgresql module stream with the {{client}} flavor/profile:\r\n\r\n{{package {''postgresql'':}}\r\n {{  ensure   => ''9.6'',}}\r\n {{  flavor   => ''client'',}}\r\n {{  provider => ''dnfmodule'',}}\r\n {{}}}\r\n\r\nApply the following manifest, changing the flavor:\r\n\r\n{{package {''postgresql'':}}\r\n {{  ensure   => ''9.6'',}}\r\n {{  flavor   => ''*server*'',}}\r\n {{  provider => ''dnfmodule'',}}\r\n {{}}}\r\n\r\n*Desired Behavior:*\r\n\r\n{{postgres --version}} should print out the PostgreSQL server version.\r\n\r\n*Actual Behavior:*\r\n\r\n{{postgres}} does not exist because the installed flavor is still *client*, not *server*.\r\n\r\nThis can be confirmed with: {{dnf module list --installed}}', 'https://tickets.puppetlabs.com/browse/PUP-10171', 'https://github.com/puppetlabs/puppet/pull/7906', '2019-12-11T04:24:20.000-0800', '2020-03-03T03:23:57.000-0800', '2020-03-03T03:23:57.000-0800', 'Resolved', 'resolved-issue-added', 0, '0', 3, 106, 8, 7, '575302b499885635198e7be35ecd8666ee6eca47'),
('puppet', 342832, 367487027, 7945, 'Cannot set/change password of a user resource on macOS 10.15', 'It looks like direct access to binary plists under {{/var/db/dslocal/nodes/Default/}} has been blocked beginning with macOS 10.15 (even with Full Disk Access activated), so we can no longer overwrite that file to set/change the password on an macOS user.\r\n\r\n{code}\r\nError: Unable to write the file /var/db/dslocal/nodes/Default/users/testuser.plist. #<IOError: File /var/db/dslocal/nodes/Default/users/testuser.plist not writable!>\r\n{code}\r\n\r\nThere''s still _a way_ to circumvent this and still be able to modify passwords. It involves the use of the {{dsimport}} command to indirectly manipulate the contents of the binary user plist.\r\n\r\nFor this, we need to have the {{ShadowHashData}} (which we previously wrote to the plist) in binary format, then converted to base64.\r\n\r\nHere is some ancient {{dsimport}} documentation (Apple seems to have removed all mentions of this tool since, but it still works): http://web.archive.org/web/20090106120111/http://support.apple.com/kb/TA21305?viewlocale=en_US\r\n\r\nBasically the steps would be to:\r\n1. If the user exists, remove the existing ShadowHashData (with dscl delete)\r\n {{dscl -plist . read /Users/testuser}} should show no {{ShadowHashData}}\r\n2. Import the file with the base64-converted hash using dsimport: {{dsimport /file/to/import /Local/Default M}}\r\n {{dscl -plist . read /Users/testuser}} should show the new {{ShadowHashData}}\r\n\r\nThe challenge that remains is to correctly build the ShadowHashData plist, convert it to binary and then to base64, then build the dsimport file.\r\n\r\nAs per the documentation above, this is a file that changes the hashed password of an existing account:\r\n\r\n{code}\r\n0x0A 0x5C 0x3A 0x2C dsRecTypeStandard:Users 2 dsAttrTypeStandard:RecordName base64:dsAttrTypeNative:ShadowHashData\r\ntestuser:<base64 string>\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10246', 'https://github.com/puppetlabs/puppet/pull/7945', '2020-01-21T06:28:19.000-0800', '2020-03-03T03:25:32.000-0800', '2020-03-03T03:25:32.000-0800', 'Resolved', 'resolved-issue-added', 0, '0', 1, 69, 6, 3, '688779d43c770598ca72c83e14b555f342252150'),
('puppet', 345706, 373012371, 7972, 'mailalias always performs a "change" when value has a comma', 'I''m using puppet 2.7 and on one node, I have a mailalias resource to\r\nsetup something for redmine like the following:\r\n\r\n{code}\r\n    mailalias {\r\n        "redmine":\r\n            recipient =>\r\n''|/usr/share/redmine/extra/mail_handler/sub-mailhandler.py -e\r\nredmine@redmine.example.com -- /usr/share/redmine/extra/mail_handler/rdm-mailhandler.rb --url https://redmine.example.com --key somerandomalphanumstring --no-check-certificate --unknown-user accept --no-permission-check --allow-override project,tracker,category,priority,status'';\r\n    }\r\n{code}\r\n\r\npuppet is always refreshing the alias for no reason. changing the value\r\nto the same thing.\r\n\r\nafter doing some more testing, I found out that mailalias bugs in the above manner as soon as there is a comma in the recipient parameter value (e.g. with "...project" it''s ok but with "...project," I start seeing the issue).', 'https://tickets.puppetlabs.com/browse/PUP-10287', 'https://github.com/puppetlabs/puppet/pull/7972', '2020-02-10T00:48:00.000-0800', '2020-03-03T03:25:50.000-0800', '2020-03-03T03:25:50.000-0800', 'Resolved', 'resolved-issue-added', 0, '0', 1, 2, 1, 2, '91fbc026c6d013020a684f53d9418edfa8219295'),
('puppet', 24894, 338726615, 7815, 'Dpkg package provider misbehaving for held package with specific version', 'Judging from this StackOverflow question [1], I am running into a long-standing problem with the dpkg package provder. I have packages pinned to specific versions in Puppet with\r\n\r\n       ensure => ''version_string''\r\n\r\nand at the same time have put these packages on ''hold'' with dpkg to prevent unintended manual upgrades. Now, on every Puppet run, I get this:\r\n\r\n       Package[mypackage]/ensure: ensure changed ''held'' to ''version_string''\r\n\r\nI assume this is because of the following code in provider/package/dpkg.rb, line 92 (in Puppet 3.3.2-1puppetlabs1):\r\n\r\n       hash[:ensure] = :held if hash[:desired] == ''hold''\r\n\r\nwhich sets the current ''ensure'' to ''held'', where the desired ''ensure'' is the package version. It seems to me that the ''ensure'' parameter should not be (ab)used to implement the ''holdable'' feature.\r\n\r\n[1] http://serverfault.com/questions/370266/puppet-using-ensure-with-package-version-and-held', 'https://tickets.puppetlabs.com/browse/PUP-1537', 'https://github.com/puppetlabs/puppet/pull/7815', '2014-01-29T10:59:04.000-0800', '2020-03-03T03:26:01.000-0800', '2020-03-03T03:26:01.000-0800', 'Resolved', 'debian;linux;package;puppethack;redmine;resolved-issue-added;type_and_provider;ubuntu', 6, '0', 1, 218, 28, 11, 'b6ab1697afd29b6293d133a345a4a51cd258457d'),
('puppet', 348479, 383288208, 8015, 'Client does not reconnect when the server closes a persistent connection', 'Puppet may fail to reuse a previously cached connection under the following conditions:\r\n\r\n1. It uses the new HTTP client\r\n2. The previous request was kept alive (the server didn''t send {{Connection: close}})\r\n3. The server closes the connection between the time that the client caches it and when the client tries to reuse it.\r\n\r\nPuppet will report that the connection was "interrupted after 0.001 seconds".\r\n\r\nThe issue occurs because puppet''s HTTP client makes a non-local return from the block passed to {{Net::HTTP#request}}. As a result the {{Net::HTTP#end_transport}} method is never called, which is what sets {{last_communication}} to the current timestamp. https://github.com/ruby/ruby/blob/v2_5_7/lib/net/http.rb#L1567\r\n\r\nThe next time {{Net::HTTP#request}} is called, the client''s side of the socket is still open and it interprets the nil {{last_communication}} value to mean "we''ve never used this connection before", so it skips the call to {{Net::HTTP#connect}}. https://github.com/ruby/ruby/blob/v2_5_7/lib/net/http.rb#L1537-L1546\r\n\r\nBut as soon as it tries to write the request and read the response, EOFError is raised.', 'https://tickets.puppetlabs.com/browse/PUP-10347', 'https://github.com/puppetlabs/puppet/pull/8015', '2020-03-03T17:25:10.000-0800', '2020-03-04T11:43:45.000-0800', '2020-03-04T11:43:45.000-0800', 'Resolved', '', 2, '0', 1, 27, 3, 3, '71d87efe13d5681420679afeb5e43696a9415903'),
('puppet', 347571, 379899776, 8003, 'Puppet tries to print ssl information for non-ssl connections in debug mode', 'When running in debug mode, puppet tries to print ssl information (protocol & ciphers) for each new connection, but it does it for non-ssl connections. It''s unlikely to be triggered in 6.13.0 because only the CA REST APIs and PMT are using the new http client, but can be triggered via:\r\n\r\n {noformat}\r\n$ bx puppet module search puppetlabs-stdlib --debug --module_repository=http://localhost:8081/artifactory/api/puppet/puppet\r\nDebug: Runtime environment: puppet_version=6.13.0, ruby_version=2.3.8, run_mode=user, default_encoding=UTF-8\r\nNotice: Searching http://localhost:8081/artifactory/api/puppet/puppet ...\r\nDebug: Could not find library ''pe_license'' required to enable feature ''pe_license''\r\nDebug: Creating new connection for http://localhost:8081\r\nDebug: Starting connection for http://localhost:8081\r\nError: Could not connect to http://localhost:8081/artifactory/api/puppet/puppet\r\n  There was a network communications problem\r\n    The error we caught said ''Request to http://localhost:8081/artifactory/api/puppet/puppet/v3/modules?query=puppetlabs-stdlib failed after 0.002 seconds: undefined method `ssl_version'' for #<TCPSocket:fd 9>''\r\n{noformat}\r\n\r\nThe problem is a {{verifier}} is being passed to the {{pool}} in the non-ssl case, and the pool is using that to determine if the connection is ssl based or not.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10314', 'https://github.com/puppetlabs/puppet/pull/8003', '2020-02-25T14:09:42.000-0800', '2020-03-04T11:46:28.000-0800', '2020-03-04T11:46:28.000-0800', 'Resolved', '', 2, '0', 3, 57, 12, 4, 'a6d053d87dcc3ace061396a6247c257169277faf'),
('puppet', 203387, 317486654, 7718, 'puppet resource <...> --to_yaml mishandles structured resource values', 'I''m specifically experiencing this with\r\n\r\n{code}\r\npuppet resource ec2_instance --to_yaml\r\n{code}\r\n\r\nusing the puppetlabs-aws module from the forge. The module itself doesn''t seem to be touching any yaml related stuff. Without the yaml flag I get this data: https://gist.github.com/wkalt/a97a42b84b1afc3cd23236ea32eed3fa and using the yaml flag I get https://gist.github.com/wkalt/a97a42b84b1afc3cd23236ea32eed3fa . Note that the former has ruby maps embedded, which is the bug.', 'https://tickets.puppetlabs.com/browse/PUP-7808', 'https://github.com/puppetlabs/puppet/pull/7718', '2017-08-01T09:47:23.000-0700', '2020-03-05T00:32:15.000-0800', '2020-03-05T00:32:15.000-0800', 'Resolved', 'resolved-issue-added', 6, '0', 4, 52, 10, 5, '34e09e195b863998ae7463611d11e3f3006afebd'),
('puppet', 94774, 0, 0, 'Puppet''s HTTP API does not allow callers to trust system cacerts', 'Puppet''s HTTP connection code does not allow callers to specify that they want to trust the default set of cacerts. To do so, you need to get access to the {{Net::HTTP#store}} and call {{OpenSSL::X509::Store#set_default_paths}}, but this is not currently possible.\r\n\r\nThe PMT works around this by rolling its own {{Net::HTTP}} object, leading to duplicate proxy handling logic. It would be nice to DRY this up, but to do so, our HTTP code needs to provide a way for callers to trust the system''s cacerts. This would also be useful for providers that need to make network connections, and not rely on open-uri to do so.\r\n\r\nNext Steps:\r\n\r\n1. Update puppet, report and fileserver http services to accept an optional {{include_system_store}} argument which defaults to false.\r\n2. Remove the {{ssl_context}} argument from the same set of services. Note the ca server needs to remain as-is, because the agent needs to pass in an {{ssl_context}} during ssl bootstrapping.\r\n3. Update the HTTP client get, post, etc methods to accept either {{include_system_store}} or {{ssl_context}} but not both.\r\n4. Add a {{Puppet::HTTP::Client#system_ssl_context}} method that calls {{Puppet::SSL::SSLProvider.create_system_context}} and memoizes it\r\n5. If {{include_system_store}} is true, then {{Puppet::HTTP::Client#get}} (etc) should use the {{system_ssl_context}} for that connection.\r\n\r\nAcceptance Criteria:\r\n\r\n1. The client should be able to connect to well-known servers like github.com, whose SSL cert is not issued by the puppet PKI.\r\n2. The client should not perform revocation checking, since the CA cert won''t be in puppet''s CRL bundle.\r\n3. A connection created with the system_ssl_context should not be reused when making a connection to puppet infrastructure (using the puppet_ssl_context) and vice-versa. This can be verified looking at the http_debug log and seeing when new connections are started vs reused.', 'https://tickets.puppetlabs.com/browse/PUP-5069', 'https://github.com/puppetlabs/puppet/commit/9f664971fe0f55fbbba07b3d1aceb1c80f056ef8', '2015-08-24T11:15:48.000-0700', '2020-03-05T11:46:06.000-0800', '2020-03-05T11:46:06.000-0800', 'Resolved', 'ssl', 3, '0', 0, 0, 0, 0, '9f664971fe0f55fbbba07b3d1aceb1c80f056ef8'),
('puppet', 347941, 382902342, 8013, 'Secondary group handling causing issues in 6.13.0', '*Puppet Version: 6.13.0*\r\n *Puppet Server Version: 6.9.0-1.el7*\r\n *OS Name/Version: Centos 7*\r\n\r\nIssues with managing users, groups and secondary groups with 6.13.0, issue is not present in 6.12.0.\r\n\r\n*Desired Behavior:*\r\n\r\n \r\n\r\n{{Info: Applying configuration version ''1582911791''}}\r\n {{Notice: /Stage[main]/Users::Users/Users::Local_user[jsmith]/Accounts::User[jsmith]/Group[jsmith]/ensure: created}}\r\n {{Notice: /Stage[main]/Users::Users/Users::Local_user[jsmith]/Accounts::User[jsmith]/User[jsmith]/ensure: created}}\r\n {{Notice: /Stage[main]/Users::Groups/Users::Virtual_group[dev]/Group[dev]/members: members changed ''auser,another'' to [''auser'', ''another'', ''jsmith''] (corrective)}}\r\n\r\n \r\n\r\n*Actual Behavior:*\r\n\r\n{{Info: Loading facts}}\r\n {{Error: Failed to apply catalog: Parameter members failed on Group[dev]: can''t find user for jsmith (file: /etc/puppetlabs/code/environments/production/modules/users/manifests/virtual_group.pp, line: 13)}}\r\n\r\n \r\n\r\nlocal_user.pp contains the following code...\r\n\r\n{{accounts::user { "$title":}}\r\n {{  ensure => $ensure,}}\r\n {{  shell => $shell,}}\r\n {{  comment => $comment,}}\r\n {{  home => $home,}}\r\n {{  home_mode => $home_mode,}}\r\n {{  uid => $uid,}}\r\n {{  gid => $gid,}}\r\n {{  group => $group,}}\r\n {{  create_group => $create_group,}}\r\n {{  membership => $membership,}}\r\n {{  forcelocal => $forcelocal,}}\r\n {{  password => $password,}}\r\n {{  locked => $locked,}}\r\n {{  sshkeys => $sshkeys,}}\r\n {{  purge_sshkeys => $purge_sshkeys,}}\r\n {{  managehome => $managehome,}}\r\n {{  bashrc_content => $bashrc_content,}}\r\n {{  bashrc_source => $bashrc_source,}}\r\n {{  bash_profile_content => $bash_profile_content,}}\r\n {{  bash_profile_source => $bash_profile_source,}}\r\n {{  system => $system,}}\r\n {{  ignore_password_if_empty => $ignore_password_if_empty,}}\r\n {{  forward_content => $forward_content,}}\r\n {{  forward_source => $forward_source,}}\r\n \{{ }}}\r\n\r\n{{User[$title] -> Group[$groups.delete($group)]}}\r\n\r\n \r\n\r\nOn 6.12.0 and earlier we see the primary group created, the user and the secondary group, on 6.13.0 this does not occur we get an error that the not yet created user can''t be found.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10320', 'https://github.com/puppetlabs/puppet/pull/8013', '2020-02-28T11:47:31.000-0800', '2020-03-06T02:34:11.000-0800', '2020-03-06T02:34:11.000-0800', 'Resolved', '', 7, '0', 1, 31, 12, 2, '8feb8baca243a76b8d9ed283497d71a0622c24e9'),
('puppet', 348856, 384575930, 8024, 'Agents no longer accept rich data in catalogs', 'Add the following to a puppetserver''s site.pp:\r\n\r\n{code:puppet}\r\nnotify { "deferred":\r\n   message => Deferred("join", [[1, 2, 3], ":"])\r\n}\r\n{code}\r\n\r\nRun an agent from the same host or different host. The {{Accept}} header is missing rich data so the server returns an JSON catalog:\r\n\r\n{noformat}\r\n$ git rev-parse HEAD\r\ne9107d98e911f8b956061ab0d5a116c559b8b9a3\r\n$ bundle exec puppet agent -t --http_debug\r\n-> "POST /puppet/v3/catalog/XXX?environment=production HTTP/1.1\r\nX-Puppet-Version: 6.14.0\r\nUser-Agent: Puppet/6.14.0 Ruby/2.5.7-p206 (x86_64-darwin18)\r\nAccept: application/json, application/x-msgpack, text/pson\r\nAccept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\r\nHost: indoor-overtime.delivery.puppetlabs.net:8140\r\nContent-Length: 8002\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\n"\r\n...\r\n-> "HTTP/1.1 200 OK\r\n"\r\n-> "Date: Thu, 05 Mar 2020 23:29:16 GMT\r\n"\r\n-> "Content-Type: application/json;charset=utf-8\r\n"\r\n-> "X-Puppet-Version: 6.14.0\r\n"\r\n-> "Vary: Accept-Encoding, User-Agent\r\n"\r\n-> "Content-Encoding: gzip\r\n"\r\n-> "Content-Length: 431\r\n"\r\n-> "\r\n"\r\n{noformat}\r\n\r\nAs a result the deferred function is never evaluated on the client. In 6.13.0, the agent sends:\r\n\r\n{noformat}\r\n<- "POST /puppet/v3/catalog/XXX?environment=production HTTP/1.1\r\nAccept: application/vnd.puppet.rich+json, application/json, application/vnd.puppet.rich+msgpack, application/x-msgpack, text/pson\r\nX-Puppet-Version: 6.13.0\r\nAccept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\r\nUser-Agent: Puppet/6.13.0 Ruby/2.5.7-p206 (x86_64-darwin18)\r\nHost: indoor-overtime.delivery.puppetlabs.net:8140\r\nContent-Length: 7976\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\n"\r\n...\r\n{noformat}\r\n\r\nSo something is broken in how the agent generates the list of {{Accept}} headers.\r\n\r\nAdditionally static catalogs are broken and server_list is not used to resolve the file server or report services.', 'https://tickets.puppetlabs.com/browse/PUP-10359', 'https://github.com/puppetlabs/puppet/pull/8024', '2020-03-05T15:32:15.000-0800', '2020-03-06T11:09:25.000-0800', '2020-03-06T11:09:25.000-0800', 'Resolved', '', 1, '0', 3, 80, 16, 7, '2763f0e9429cce72daea410766892d1c5fcc2d22'),
('puppet', 322755, 314274311, 7699, 'no_proxy config setting is overridden by http_proxy environment variable', '*Puppet Version: 6.8.0*\r\n *Puppet Server Version: 6.5.0*\r\n *OS Name/Version: CentOS 6/7*\r\n\r\nI''m seeing {{puppet-agent}} fail to respect the {{no_proxy}} setting when defined in the config file. Having checked the diff that merged this support into 6.8.0, I''ve added some debug logging to identify the code path being taken, and it correctly determines a proxy should be bypassed, but then tries to use the proxy to connect to the {{puppetserver}} anyway, which is blocked by local policy\r\n\r\n*Desired Behavior:*\r\n\r\nPuppet agent should respect the {{no_proxy}} setting in {{puppet.conf}}\r\n\r\n*Actual Behavior:*\r\n\r\n{code:none}\r\npuppet agent --test --server_list master1 --noop\r\n# Lots of debug output omitted\r\nDebug: LOCAL Using settings no_proxy 10.0.0.0/8,example.com,*.example.com,local,*.local,127.0.0.1,localhost,master1,master2\r\nDebug: LOCAL not using proxy because destination (?-mix:^master1$) matched a no_proxy entry for master1\r\nDebug: LOCAL not using proxy because no_proxy? returned True\r\nDebug: Starting connection for https://master1:8140\r\nDebug: Unable to connect to server from server_list setting: 403 "Forbidden"\r\nError: Could not run Puppet configuration client: Could not select a functional puppet master from server_list: ''master1''\r\n# 403 Forbidden is coming from local webproxy\r\n{code}\r\n\r\n(hostnames and actual value of no_proxy obfuscated. Lines containing LOCAL are local modifications to the puppet code to expose the behaviour).\r\n\r\nI only see this happen when the {{no_proxy}} setting is being read from {{puppet.conf}}. If {{no_proxy}} is set as env var, it properly bypasses the proxy for the unqualified hostname which matches the {{no_proxy}} value.\r\n\r\nIt feels like {{puppet agent}} is not using the proxy settings from puppet.conf at all. It does all the work to decide whether it should and that answer isn''t respected by the thing that actually makes the requests to the {{puppetserver}}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9990', 'https://github.com/puppetlabs/puppet/pull/7699', '2019-08-29T06:40:03.000-0700', '2020-03-11T01:46:19.000-0700', '2020-03-11T01:46:19.000-0700', 'Resolved', 'jira_escalated;proxy;resolved-issue-added', 16, '0', 1, 59, 11, 4, '54a3e6bfe1f907bbe5505b39f4d9cdfec2be428f'),
('puppet', 51011, 0, 0, 'puppet reports "end of file reached" if server closes HTTP connection', 'I have two dirname.rb functions in my code, one from stdlib and one in a different module I installed at an earlier stage. This has never been a problem, puppet has somehow chosen one of them and not complained about it. After upgrading to 3.7.0 on the clients, the puppetruns crashes with\r\n"Error: Could not retrieve catalog from remote server: end of file reached"\r\n\r\nusing --debug parameter did not make the reasons for this any clearer and I have not found any documentation in release notes about this. I think this change should be included in release notes and there should be a clearer error message about it. ', 'https://tickets.puppetlabs.com/browse/PUP-3238', 'https://github.com/puppetlabs/puppet/commit/bd737a89a213e15c3d1db32e64bd596b08886b2a', '2014-09-12T00:05:37.000-0700', '2020-03-30T16:13:51.000-0700', '2020-03-30T16:13:51.000-0700', 'Closed', 'LTS-Triage', 47, '0', 0, 0, 0, 0, 'bd737a89a213e15c3d1db32e64bd596b08886b2a'),
('puppet', 235343, 167791223, 6618, 'Agent''s node request fails if environment directory doesn''t exist locally', 'Hi there,\r\n\r\nour puppet-agent got upgraded from 5.3.3 to 5.3.4 on all of our servers (Debian 8, Debian 9) and some of them throw a Warning at the beginning of their puppetrun.\r\n{noformat}\r\nWarning: Unable to fetch my node definition, but the agent run will continue:\r\nWarning: Could not intern from application/json: Could not find a directory environment named ''my_custom_env'' anywhere in the path: /etc/puppetlabs/code/environments. Does the directory exist?\r\n{noformat}\r\n\r\n"my_custom_env" is located on my puppetserver under "/opt" somewhere so I don''t know where "/etc/puppetlabs/code/environments" is coming from. Have you encountered this warning before? Do you know how to fix this?\r\n\r\nbest regards and thanks\r\nSebastian', 'https://tickets.puppetlabs.com/browse/PUP-8419', 'https://github.com/puppetlabs/puppet/pull/6618', '2018-02-06T01:49:56.000-0800', '2020-03-31T20:55:59.000-0700', '2020-03-31T20:55:59.000-0700', 'Closed', 'regression', 20, '0', 1, 13, 3, 2, '917849f65340753e6d50e13e4edb0d8fff23cf09'),
('puppet', 123360, 86257176, 5289, 'Multiple contradictory ''consumes'' annotation do not lead to an error', 'I have a {{Sql}} service resource that is exported by a {{Db}} component and define a {{Web}} component as follows:\r\n{code}\r\ndefine web(\r\n  $database = undef,\r\n  $dbuser = undef,\r\n  $dbpassword = undef,\r\n  $dbhost = undef,\r\n  $port = 80)\r\n{\r\n  $txt = @("EOS")\r\nWeb server ${name} on ${::fqdn}:\r\n  connect to ${dbuser}:${dbpassword}@${dbhost}/${database}\r\n\r\nuptime: ${uptime_seconds}\r\nEOS\r\n\r\n  file { "/root/${name}.txt": content => $txt }\r\n}\r\n\r\nWeb consumes Sql {\r\n  dbuser => ''nouser'',\r\n  dbpassword => ''nopassword'',\r\n  dbhost => ''nohost'',\r\n  database => ''nodatabase''\r\n}\r\n\r\nWeb consumes Sql {\r\n  dbuser => $user,\r\n  dbpassword => $password,\r\n  dbhost => $host,\r\n  database => $database\r\n}\r\n{code}\r\n\r\nEven though there are two {{Web consumes Sql}} annotations with contradictory parameter mappings, it is possible to use this component in an application and instantiate such an application in the {{site}} block.\r\n\r\nThis should lead to compile errors, ideally both during environment compilation and node compilation. Of course, the same thing with {{produces}} annotations should also lead to an error.\r\n\r\nI''ll attach a tar of my {{/etc/puppetlabs/code/environments/production}} dir with all the manifests I used', 'https://tickets.puppetlabs.com/browse/PUP-6087', 'https://github.com/puppetlabs/puppet/pull/5289', '2016-03-23T16:45:16.000-0700', '2020-03-31T20:56:43.000-0700', '2020-03-31T20:56:43.000-0700', 'Closed', '', 2, '0', 1, 4, 28, 3, '036d5efce2d6e1a15a04b80db4f89990ed591560'),
('puppet', 313648, 290770936, 7590, 'Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given)', '*Puppet Version:* 6.5.0\r\n *Puppet Server Version:* 6.4.0\r\n *OS Name/Version:* Linux ip-10-0-42-40 4.4.0-1047-aws #56-Ubuntu SMP Sat Jan 6 19:39:06 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n{code}Error: Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given)\r\nError: Facter: error while resolving custom facts in /opt/puppetlabs/puppet/cache/lib/facter/package_provider.rb: Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given)\r\n{code}\r\n*Describe steps to reproduce…*\r\n\r\nLimited to AWS Kernel ...\r\n{code}uname -a\r\nLinux ip-10-0-42-40 4.4.0-1047-aws #56-Ubuntu SMP Sat Jan 6 19:39:06 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n{code}\r\nInstall Puppet 6 and puppetlabs-stdlib ...\r\n{code}sudo -i\r\nwget https://apt.puppetlabs.com/puppet6-release-xenial.deb\r\ndpkg -i puppet6-release-xenial.deb\r\napt update\r\napt install -y puppetserver\r\nsource /etc/profile.d/puppet-agent.sh\r\npuppet config set server $(hostname -f)\r\npuppetserver ca setup\r\nsystemctl start puppetserver\r\npuppet module install puppetlabs-stdlib\r\n{code}\r\nTrigger ...\r\n{code}puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nNotice: /File[/opt/puppetlabs/puppet/cache/lib/facter]/ensure: created\r\n...\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nError: Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given)\r\nError: Facter: error while resolving custom facts in /opt/puppetlabs/puppet/cache/lib/facter/package_provider.rb: Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given)\r\nInfo: Caching catalog for ip-10-0-42-40.us-west-2.compute.internal\r\nInfo: Applying configuration version ''1561145391''\r\nInfo: Creating state file /opt/puppetlabs/puppet/cache/state/state.yaml\r\nNotice: Applied catalog in 0.02 seconds\r\n{code}\r\nOr ...\r\n{code}facter -p os\r\n2019-06-21 19:36:32.606934 ERROR puppetlabs.facter - error while resolving custom facts in /opt/puppetlabs/puppet/cache/lib/facter/package_provider.rb: Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given)\r\n{\r\n  architecture => "amd64",\r\n  distro => {\r\n    codename => "xenial",\r\n    description => "Ubuntu 16.04.3 LTS",\r\n    id => "Ubuntu",\r\n    release => {\r\n      full => "16.04",\r\n      major => "16.04"\r\n    }\r\n  },\r\n  family => "Debian",\r\n  hardware => "x86_64",\r\n  name => "Ubuntu",\r\n  release => {\r\n    full => "16.04",\r\n    major => "16.04"\r\n  },\r\n  selinux => {\r\n    enabled => false\r\n  }\r\n}\r\n{code}\r\nOr ...\r\n{code}/opt/puppetlabs/puppet/bin/ruby /opt/puppetlabs/puppet/cache/lib/facter/package_provider.rb\r\nTraceback (most recent call last):\r\n	15: from /opt/puppetlabs/puppet/cache/lib/facter/package_provider.rb:11:in `<main>''\r\n	14: from /opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require''\r\n	13: from /opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require''\r\n	12: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/package.rb:9:in `<top (required)>''\r\n	11: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/package.rb:10:in `<module:Puppet>''\r\n	10: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/metatype/manager.rb:127:in `newtype''\r\n	 9: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:215:in `loadall''\r\n	 8: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:79:in `loadall''\r\n	 7: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:79:in `each''\r\n	 6: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:81:in `block in loadall''\r\n	 5: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:66:in `load_file''\r\n	 4: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:66:in `load''\r\n	 3: from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/gem.rb:1:in `<top (required)>''\r\n	 2: from /opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require''\r\n	 1: from /opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/core_ext/kernel_require.rb:59:in `require''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package_targetable.rb:23:in `<top (required)>'': Could not autoload puppet/provider/package/gem: superclass must be a Class (Module given) (Puppet::Error)\r\n{code}\r\nResolve ...\r\n{code}puppet module uninstall puppetlabs-stdlib\r\npuppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for ip-10-0-42-40.us-west-2.compute.internal\r\nInfo: Applying configuration version ''1561145919''\r\nNotice: Applied catalog in 0.05 seconds\r\n{code}\r\nUnable to reproduce with Generic Kernel ...\r\n{code}uname -a\r\nLinux fy4y57a54szfeln 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-9794', 'https://github.com/puppetlabs/puppet/pull/7590', '2019-06-21T12:52:43.000-0700', '2020-04-01T09:34:14.000-0700', '2020-04-01T09:34:14.000-0700', 'Closed', 'resolved-issue-added', 6, '0', 2, 5, 2, 4, '6d37b1ef8e18e52e2d30e30eb259addd2c5bbf0f'),
('puppet', 140429, 225547395, 7196, '"Unable to set ownership" error with logdest on agents', 'Customer has noted that after installing a 2016.2 agent and setting up logdest via /etc/sysconfig/puppet:\r\n\r\n{code:java}\r\nPUPPET_EXTRA_OPTS=--logdest=/var/log/puppetlabs/puppet/puppet.log\r\n{code}\r\n\r\nThe log shows the error:\r\n\r\n{code:java}\r\n2016-07-07 07:51:55 -0700 Puppet (err): Unable to set ownership to puppet:puppet for log file: /var/log/puppetlabs/puppet/puppet.log\r\n{code}\r\n\r\nThis is caused by the fact that even though the new AIO agent no longer creates the puppet user and group, the log destination code still refers to them at https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/log/destinations.rb#L95-L102.  On a master, this code is fine, since the default puppet user "pe-puppet" is created, but on an agent they default to "puppet" which is not.  \r\n\r\nEither the AIO agent RPM needs to have the creation of the puppet user and group added back to the pre-install script as it was in Puppet 3.x, or logic needs to be added to the destinations.rb to not run on agents where the user does not exist to prevent the error.', 'https://tickets.puppetlabs.com/browse/PUP-7331', 'https://github.com/puppetlabs/puppet/pull/7196', '2016-07-07T09:43:23.000-0700', '2020-04-02T00:28:32.000-0700', '2020-04-02T00:28:32.000-0700', 'Closed', 'cspapercuts;resolved-issue-added;the-goods', 8, '0', 1, 13, 2, 2, '5353736cdcafc8f2268003e4f9b06d4ab9e7f5f3'),
('puppet', 348571, 385019599, 8025, 'Change http client API to generic options hash', 'The HTTP client API needs to use a generic options hash instead of keyword arguments for two reasons:\r\n\r\n1. The API currently uses keyword arguments, but we need to add a puppetserver implementation. If we add a new argument to puppet''s implementation, then it will break puppetserver, unless it collects "extra" options using {{**options}}. But then we''ll end up with some arguments expressed as keyword arguments and some "leftovers".\r\n2. Callers of the API sometimes pass options that the client implementation doesn''t know about, such as {{compress}}. The API needs a way to pass options which may only be understood by one implementation. Each implementation should parse and validate options it recognizes and pass through options it doesn''t.', 'https://tickets.puppetlabs.com/browse/PUP-10353', 'https://github.com/puppetlabs/puppet/pull/8025', '2020-03-04T11:31:28.000-0800', '2020-04-06T06:37:02.000-0700', '2020-04-06T06:37:02.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 1, 125, 78, 10, '7e6e24ee5c6c65d85c74a9a15d0879097a3ca12d'),
('puppet', 353752, 397760231, 8071, 'Upgraded to Puppetserver 6.9.2 from Puppet 6.5', 'Upgraded Puppet Server from 6.5.1 to 6.9.2\r\n\r\nWe are seeing a error when trying to query for environments. "Error: undefined method `collect'' for nil:NilClass". API is reporting a 406 error.\r\n\r\nCheck the SSL and auth.conf.  \r\n\r\nDump for the puppet server logs:\r\n\r\n{noformat}\r\n2020-04-01T14:30:31.118-07:00 ERROR [qtp1259599435-40] [puppetserver] Puppet Server Error: undefined method `collect'' for nil:NilClass\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/environments.rb:204:in `list''\r\norg/jruby/RubyArray.java:2579:in `collect''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/environments.rb:275:in `list''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/environments.rb:351:in `list''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/master/v3/environments.rb:11:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/master/v3/authorization.rb:14:in `block in wrap''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:82:in `block in process''\r\norg/jruby/RubyArray.java:1800:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:81:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:88:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:88:in `process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:87:in `block in process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:70:in `block in with_request_profiling''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:66:in `with_request_profiling''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:86:in `block in process''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:93:in `respond_to_errors''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:85:in `process''\r\nuri:classloader:/puppetserver-lib/puppet/server/master.rb:64:in `block in handleRequest''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:290:in `override''\r\nuri:classloader:/puppetserver-lib/puppet/server/master.rb:63:in `handleRequest''\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10405', 'https://github.com/puppetlabs/puppet/pull/8071', '2020-04-01T14:35:41.000-0700', '2020-04-06T06:38:16.000-0700', '2020-04-06T06:38:16.000-0700', 'Resolved', 'doc_reviewed', 5, '0', 1, 12, 5, 2, 'f1fe18533ff0a0bec1381c87cb03ad08b31c3f0d'),
('puppet', 350907, 392878143, 8055, 'pkgng does not parse latest version properly', '*Puppet Version: 5.5.18*\r\n *Puppet Server Version: 5.5.18*\r\n *OS Name/Version: FreeBSD 12*\r\n\r\nthe pkgng provider does not parse the output of pkg version -voRL= correctly.\r\nIf the package is no longer found in the repo, no latest version can be parsed out of it.\r\n\r\nFor example the output is:\r\nsysutils/splunk ? orphaned: sysutils/splunk\r\ndatabases/sqlite3 < needs updating (remote has 3.30.1)\r\n\r\n*Desired Behavior:*\r\n\r\nlatests version for splunk should be nil\r\nlatests version for sqlite3 should be 3.30.1\r\n\r\n*Actual Behavior:*\r\n\r\nlatests version for splunk is sysutils/splunk\r\nlatests version for sqlite3 is 3.30.1\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10382', 'https://github.com/puppetlabs/puppet/pull/8055', '2020-03-24T02:27:05.000-0700', '2020-04-06T06:38:25.000-0700', '2020-04-06T06:38:25.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 1, 19, 1, 3, '7a0cf69201fcd5487f6862f31868ce92d1e4c904'),
('puppet', 350775, 392443974, 8053, 'pkgng does not support install_options', '*Puppet Version: 5.5.18*\r\n *Puppet Server Version: 5.5.18*\r\n *OS Name/Version: FreeBSD 12.1*\r\n\r\nThe pkgng provider does not support install_options\r\n\r\n*Desired Behavior:* \r\n\r\npackage { ''mypackage'':\r\n    ensure => present,\r\n    source => ''[https://my.downloadsite.com/mypackage-freebsd-11.1.txz''-amd64|https://my.downloadsite.com/mypackage-freebsd-11.1.txz''] ,\r\n    provider => ''pkgng'',\r\n    install_options = ''-f'',\r\n}\r\n\r\n \r\n\r\nNotice: /Stage[main]/Mymodule::Install/Package[mypackage]/ensure: created\r\n\r\n*Actual Behavior:*\r\n\r\nError: Could not update: Execution of ''/usr/local/sbin/pkg add -q [https://my.downloadsite.com/mypackage-freebsd-11.1-amd64.txz''|https://my.downloadsite.com/mypackage-freebsd-11.1.txz''] returned 70: pkg: wrong architecture: FreeBSD:11:amd64 instead of FreeBSD:12:amd64\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10380', 'https://github.com/puppetlabs/puppet/pull/8053', '2020-03-23T08:02:58.000-0700', '2020-04-06T06:38:39.000-0700', '2020-04-06T06:38:39.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 1, 35, 3, 2, '63446562777bf9b4e2692d1f3ece0af53299ef33'),
('puppet', 350515, 390711578, 8046, 'puppet plugin download doesn''t download from locales mount', 'Running {{puppet plugin download}} doesn''t download from the locales mount, though {{puppet agent}} does. We should be consistent. This issue was introduced when switching to the http client, because we''re checking for the {{locales}} capability for only the {{:puppet}} service, but in the case of {{puppet plugin download}} we only connect to the {{:fileserver}} service.', 'https://tickets.puppetlabs.com/browse/PUP-10374', 'https://github.com/puppetlabs/puppet/pull/8046', '2020-03-18T15:09:52.000-0700', '2020-04-06T06:38:50.000-0700', '2020-04-06T06:38:50.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 70, 65, 4, 'c57ee591df99829c41396cc15bfafa4f2a910ed4'),
('puppet', 321972, 386843019, 8032, 'Can''t disable Puppet::SSL::Host deprecation warning when using puppetdb terminus', 'PuppetDB module uses deprecated in puppet 6.8.0 function, causing a warning:\r\n\r\n{noformat}\r\nWarning: Puppet::SSL::Host is deprecated and will be removed in a future release of Puppet.\r\n\r\n   (location: /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/host.rb:235:in `initialize'')\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10355', 'https://github.com/puppetlabs/puppet/pull/8032', '2019-08-22T11:03:26.000-0700', '2020-04-06T06:39:49.000-0700', '2020-04-06T06:39:49.000-0700', 'Resolved', 'doc_reviewed', 10, '0', 2, 19, 25, 4, '2491e0698a356ce117b83f4a128299813b9a6c01'),
('puppet', 347916, 381370436, 8009, 'puppet_gem package provider ensure => absent breaks subsequent File resources', '*Puppet Version: 6.13.0*\r\n *Puppet Server Version: 6.8.0*\r\n *OS Name/Version: RHEL 7*\r\n\r\nGems can be installed into the puppet agent''s ruby environment for use in providers etc.\r\n When they''re no longer required, it should be possible to remove them.\r\n eg.\r\n{noformat}package { ''redis_gem'':\r\n  ensure => absent,\r\n  name   => ''redis'',\r\n  provider => ''puppet_gem'',\r\n}\r\n{noformat}\r\nWhilst the puppet_gem provider does successfully uninstall the gem, subsequent File/Concat resources fail. (I imagine other stuff might fail too, but this was the first thing I hit)\r\n{noformat}Info: Applying configuration version ''puppet6server1-redis_gem_test-79e063b8d35''\r\nNotice: /Stage[main]/Profile::Redis_keepalived/Package[redis gem]/ensure: removed (corrective)\r\nNotice: /Stage[main]/Keepalived::Config/Concat[/etc/keepalived/keepalived.conf]/File[/etc/keepalived/keepalived.conf]/content: \r\n--- /etc/keepalived/keepalived.conf	2020-02-28 11:27:08.821195162 +0000\r\n+++ /tmp/puppet-file20200228-21277-1uxs10h	2020-02-28 11:28:30.905963796 +0000\r\n@@ -1,4 +1,4 @@\r\n-## Managed by Puppet\r\n+# Managed by Puppet\r\n vrrp_script check_redis {\r\n   script    "/usr/libexec/keepalived/check_redis.sh"\r\n   interval  2\r\n\r\nInfo: Computing checksum on file /etc/keepalived/keepalived.conf\r\nError: Could not back up /etc/keepalived/keepalived.conf: pid: 21277 nil spec! included in [#<Gem::StubSpecifi...\r\n--- SNIP --- (The array printed is ~150KB long, so I''ve not included it here and continue with the stack trace)\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/specification.rb:743:in `_all''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/specification.rb:1153:in `latest_specs''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/rubygems.rb:44:in `directories''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:142:in `gem_directories''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:172:in `search_directories''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:98:in `get_file''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:62:in `load_file''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:201:in `load''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/instance_loader.rb:51:in `loaded_instance''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/terminus.rb:112:in `terminus_class''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:366:in `make_terminus''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:140:in `terminus''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/file_bucket_file/selector.rb:16:in `get_terminus''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/file_bucket_file/selector.rb:20:in `head''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:260:in `head''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/file_bucket/dipper.rb:48:in `backup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/backups.rb:82:in `backup_file_with_filebucket''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/backups.rb:28:in `perform_backup_with_bucket''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/backups.rb:15:in `perform_backup''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file.rb:1024:in `backup_existing''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file.rb:761:in `remove_existing''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file.rb:888:in `write''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/data_sync.rb:93:in `contents_sync''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/content.rb:136:in `sync''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:241:in `sync''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:136:in `sync_if_needed''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:90:in `block in perform_changes''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:89:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:89:in `perform_changes''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:21:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:267:in `apply''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:287:in `eval_resource''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:191:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:191:in `block (2 levels) in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:521:in `block in thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:520:in `thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:191:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:122:in `traverse''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:178:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:240:in `block (2 levels) in apply''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:521:in `block in thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:520:in `thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:239:in `block in apply''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:161:in `with_destination''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/report.rb:146:in `as_logging_destination''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:238:in `apply''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:187:in `block (2 levels) in apply_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:521:in `block in thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:520:in `thinmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:186:in `block in apply_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:233:in `block in benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/benchmark.rb:308:in `realtime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:232:in `benchmark''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:185:in `apply_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:394:in `run_internal''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:235:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:289:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:212:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:59:in `block (5 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/timeout.rb:93:in `block in timeout''\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/timeout.rb:103:in `timeout''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:58:in `block (4 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:21:in `lock''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:52:in `block (3 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:130:in `with_client''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:49:in `block (2 levels) in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:87:in `run_in_fork''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:48:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:46:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:410:in `onetime''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:370:in `block in run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:289:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:368:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:710:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:143:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10319', 'https://github.com/puppetlabs/puppet/pull/8009', '2020-02-28T03:35:31.000-0800', '2020-04-06T06:40:01.000-0700', '2020-04-06T06:40:01.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 1, 14, 0, 2, 'fa734d02f22b2fcd147c62997cc4817fdc74c7c2'),
('puppet', 337164, 395348084, 8064, 'Pacman provider shouldn''t be doing partial upgrades', '*Puppet Version: 6.10.1*\r\n *Puppet Server Version:*\r\n *OS Name/Version: Arch Linux*\r\n\r\nEvery time the pacman provider is used to install a package, it includes the y flag to refresh the package list, eg:\r\n\r\n{{==> default: Debug: Executing: ''/usr/bin/pacman --noconfirm --needed --noprogressbar -Sy virtualbox-guest-utils''}}\r\n\r\nFrom the Arch Linux wiki, this is a "partial upgrade" which they say shouldn''t be done:\r\n\r\n[https://wiki.archlinux.org/index.php/System_maintenance#Partial_upgrades_are_unsupported]\r\n\r\n*Desired Behavior:*\r\n\r\nEither:\r\n # Don''t refresh the package list (remove the y flag), in which case new packages will be installed matching the same point in time version as the rest of the system\r\n # Add the u flag so the package list is updated and all existing packages are upgraded to the current point in time versions\r\n\r\nOption 2 probably isn''t desired( ? ). Asking Puppet to install a new package shouldn''t result in the rest of the system being upgraded( ? )\r\n\r\n*Actual Behavior:*\r\n\r\nRunning on Arch Linux (with pacman as the default provider), this resource:\r\n\r\n{package \{ ''virtualbox-guest-utils'': ensure => ''present'' }}\r\n\r\nshould produce something more like this in the log:\r\n\r\n {{==> default: Debug: Executing: ''/usr/bin/pacman --noconfirm --needed --noprogressbar -S virtualbox-guest-utils''}}', 'https://tickets.puppetlabs.com/browse/PUP-10152', 'https://github.com/puppetlabs/puppet/pull/8064', '2019-11-29T15:54:13.000-0800', '2020-04-06T06:40:21.000-0700', '2020-04-06T06:40:21.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 1, 8, 26, 2, 'd23d6dbfd2e578016441ab292d934b4d74ab436f'),
('puppet', 229892, 373486415, 7977, 'Puppet apply doesn''t stream file content', '*Puppet Version:* Puppet 4 (at least) and up\r\n*Puppet Server Version:* n/a\r\n*OS Name/Version:* all\r\n\r\nWhen running {{puppet apply}} with a file resource and source parameter, then puppet will load the entire file into memory, instead of streaming it.\r\n\r\nThis was noticed while researching why the bug described in PUP-7482 only affected {{puppet agent}} but not {{puppet apply}}.\r\n\r\n*Desired Behavior:*\r\n\r\nWhen managing files with a {{source}} parameter, puppet apply should always stream file content from all of the following sources\r\n\r\n{{<absolute path>}} local file\r\n{{file://<URI-encoded path>}} local file\r\n{{puppet:///modules/mymodule}} local file\r\n{{http?://host:port/path/to/file}} remote file\r\n\r\n*Actual Behavior:*\r\n\r\n{{puppet apply}} does not stream file content from http-based sources. See https://github.com/puppetlabs/puppet/blob/5.3.3/lib/puppet/type/file/source.rb#L274-L276.\r\n\r\nAt first glance it appears the {{Puppet::Type::File::ParameterSource#content}} method can be deleted entirely, and should always rely on {{chunk_file_from_disk}} or {{chunk_file_from_source}}.', 'https://tickets.puppetlabs.com/browse/PUP-8338', 'https://github.com/puppetlabs/puppet/pull/7977', '2018-01-09T16:11:51.000-0800', '2020-04-07T11:36:44.000-0700', '2020-04-07T11:36:44.000-0700', 'Resolved', '', 3, '0', 3, 42, 20, 2, '59f2055b176271404a2a58b8145e2ccfe73db08e'),
('puppet', 349424, 387453585, 8037, 'Puppet apply recursive copy of directory fails in file resource', '*Puppet Version: 6.14.0*\r\n *Puppet Server Version: NA*\r\n *OS Name/Version: Centos 7*\r\n\r\nIn Puppet 6.14 copying a puppet served directory fails. Here is an example\r\n\r\n file { ''/a'':\r\n {{  ensure  => ''directory'',}}\r\n {{  source  => "puppet:///modules/test",}}\r\n {{  recurse => true,}}\r\n {{  purge   => true,}}\r\n }\r\n\r\nNow fails with this error\r\n\r\n{{[root@rcudb vagrant]# puppet apply test_case.pp}}\r\n {{Notice: Compiled catalog for rcudb.example.com in environment production in 0.05 seconds}}\r\n {{Notice: /Stage[main]/Main/File[/a]/ensure: created}}\r\n {{{color:#de350b}Error: Could not set ''file'' on ensure: Is a directory @ io_fread - /etc/puppetlabs/code/environments/production/modules/test/files{color}}}\r\n {{{color:#de350b}Error: Could not set ''file'' on ensure: Is a directory @ io_fread - /etc/puppetlabs/code/environments/production/modules/test/files{color}}}\r\n {{{color:#de350b}Wrapped exception:{color}}}\r\n {{{color:#de350b}Is a directory @ io_fread - /etc/puppetlabs/code/environments/production/modules/test/files{color}}}\r\n {{{color:#de350b}Error: /Stage[main]/Main/File[/a/a.a]/ensure: change from ''absent'' to ''file'' failed: Could not set ''file'' on ensure: Is a directory @ io_fread -{color} /etc/puppetlabs/code/environments/production/modules/test/files}}\r\n {{Notice: Applied catalog in 0.42 seconds}}\r\n\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nWith puppet version puppet-agent.x86_64 0:6.13.0-1.el7 This works as expected:\r\n\r\n{{root@rcudb vagrant]# puppet apply test_case.pp}}\r\n {{Notice: Compiled catalog for rcudb.example.com in environment production in 0.06 seconds}}\r\n {{Notice: /Stage[main]/Main/File[/a]/seltype: seltype changed ''etc_runtime_t'' to ''default_t''}}\r\n {{Notice: /Stage[main]/Main/File[/a/a.a]/ensure: defined content as ''\{md5}d41d8cd98f00b204e9800998ecf8427e''}}\r\n {{Notice: Applied catalog in 0.47 seconds}}\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10367', 'https://github.com/puppetlabs/puppet/pull/8037', '2020-03-12T02:16:52.000-0700', '2020-04-07T11:36:44.000-0700', '2020-04-07T11:36:44.000-0700', 'Resolved', 'doc_reviewed', 9, '0', 1, 44, 1, 2, 'e711110b82e682941e416a3b99f07f8cfa66ae3f'),
('puppet', 349360, 387417895, 8036, 'puppet agent unable to fetch file from https source - Error: certificate verify failed', '*Puppet Version: 6.14.0*\r\n *Puppet Server Version:  6.9.1*\r\n *OS Name/Version: CentOS Linux release 7.7.1908 (Core) and CentOS Linux release 8.1.1911 (Core)*\r\n\r\nFile resource with an source https source cannot be created and produces the following error:\r\n\r\n \r\n{code:java}Error: certificate verify failed [unable to get local issuer certificate for CN=DigiCert SHA2 High Assurance Server CA,OU=www.digicert.com,O=DigiCert Inc,C=US] Error: /Stage[main]/Main/File[tree.js]/ensure: change from ''absent'' to ''file'' failed: certificate verify failed [unable to get local issuer certificate for CN=DigiCert SHA2 High Assurance Server CA,OU=www.digicert.com,O=DigiCert Inc,C=US]\r\n{code}\r\n \r\n\r\nCommand to reproduce:\r\n\r\n \r\n{code:java}puppet apply -e "file { ''puppet6.repo.rpm'': ensure => ''present'', source => ''https://yum.puppet.com/puppet6-release-el-8.noarch.rpm'', path => ''/tmp/puppet6.repo.rpm'' }"\r\n{code}\r\n \r\n\r\nI am suspecting this is related to PUP-10260 - Modifies puppet to use the new http client for all REST requests. It seems like the new agent''s http client only has access to the puppetmaster CA, hence getting SSL certificate issues when source is not on the puppetmaster.\r\n\r\nRelated ticket: PUP-7814 https://tickets.puppetlabs.com/browse/PUP-7814, where it is explained why https source for file would failed, but is missing why it worked in 6.13.0 but it no longers works in 6.14.0.\r\n\r\n*Desired Behavior:*\r\n\r\nFile is downloaded without SSL error and created in path.\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet agent produces the following error:\r\n{code:java}Error: certificate verify failed [unable to get local issuer certificate for CN=DigiCert SHA2 High Assurance Server CA,OU=www.digicert.com,O=DigiCert Inc,C=US]\r\nError: /Stage[main]/Main/File[tree.js]/ensure: change from ''absent'' to ''file'' failed: certificate verify failed [unable to get local issuer certificate for CN=DigiCert SHA2 High Assurance Server CA,OU=www.digicert.com,O=DigiCert Inc,C=US]{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10365', 'https://github.com/puppetlabs/puppet/pull/8036', '2020-03-11T11:12:56.000-0700', '2020-04-16T11:49:54.000-0700', '2020-04-16T11:49:54.000-0700', 'Resolved', 'doc_reviewed', 7, '0', 2, 370, 9, 9, '0267d37ea1ba77662172aeb4ae0110ce6f26cfed'),
('puppet', 238912, 173292771, 6711, 'Puppet lookup always includes classes from the ENC', 'The puppet lookup command evaluates classes that are returned from the ENC when the {{--compile}} flag is not specified. This results in failures of the lookup command if the catalog cannot be compiled. \r\n\r\n \r\n\r\n*Reproduction Steps* \r\n # Install PE or Puppetserver\r\n # Create a class like the one below.\r\n # Classify a node with the class in the classifier\r\n # Run {{puppet lookup anyhierakey --node <nodename>}}\r\n\r\nA simple class to cause a failure in the lookup is below. \r\n\r\n \r\n{code}class test (\r\n  String $myparam,\r\n) {\r\n  file {$myparam:\r\n    ensure => absent,\r\n  }\r\n}\r\n{code}\r\n*Logs*\r\n\r\nUsing the steps above, we see this output from a lookup.\r\n{code}# puppet lookup anything --node pe-201735-agent.puppetdebug.vlan --debug \r\n...\r\nDebug: importing ''/etc/puppetlabs/code/environments/production/modules/test/manifests/init.pp'' in environment production\r\nDebug: Automatically imported test from test into production\r\n...\r\nError: Could not run: Evaluation Error: Error while evaluating a Resource Statement, Class[Test]: expects a value for parameter ''myparam''\r\n{code}\r\n*Workaround*\r\n\r\nAdd the {{--node_terminus plain}} to the command.\r\n{code}# puppet lookup anything --node pe-201735-agent.puppetdebug.vlan --node_terminus plain\r\n--- "test"\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8502', 'https://github.com/puppetlabs/puppet/pull/6711', '2018-02-28T12:38:31.000-0800', '2020-04-22T17:26:54.000-0700', '2020-04-22T17:26:54.000-0700', 'Closed', '', 2, '0', 1, 1, 32, 2, 'efb3ce8391c76e4f3403e66294626be686e4738f'),
('puppet', 190026, 153091893, 6369, 'puppet lookup --facts <json file> can''t modify $facts hash', 'I was trying to simulate a change to my {{$facts[''networking'']}} fact, so I ran {{facter --json > ~/Desktop/facts.json}}, edited the appropriate spot, and tried to pass that to {{puppet lookup --facts}}. No dice: my change was ignored. \r\n\r\nThat''s because I was using {{facts.networking}} in my hierarchy, and apparently --facts doesn''t actually set the $facts variable — it just sets top-scope variables with names from the JSON. \r\n\r\n* Problem one: That''s unexpected, and it interferes with using {{facter --json}} as a basis for simulating other nodes. \r\n\r\nSo, I tried wrapping the facts json in another object with only a {{"facts":}} key. Which resulted in the following error: "Error: Could not run: Attempt to assign to a reserved variable name: ''facts''"\r\n\r\n* Problem two: If your hierarchy uses the $facts variable like we recommend (instead of ::factname vars), it''s impossible to simulate any changes with the puppet lookup CLI. I expect this blocks setting other values for $trusted or $server_facts, as well. \r\n\r\nThe first problem goes into the bucket of things we need to discuss around puppet lookup''s UX. The second problem seems like a straight-up defect. ', 'https://tickets.puppetlabs.com/browse/PUP-7507', 'https://github.com/puppetlabs/puppet/pull/6369', '2017-05-09T17:48:10.000-0700', '2020-04-22T17:50:36.000-0700', '2020-04-22T17:50:36.000-0700', 'Closed', 'hiera', 25, '0', 1, 52, 3, 5, '5cde767dc1e67afc729b4ff6cdf5d603e02228ae'),
('puppet', 356444, 407591537, 8111, 'Persistent http connection timeouts can''t be changed when using the new http client', 'The http client hardcodes the timeout for the http connection pool to 15 seconds. As a result, persistent connections can''t be tuned or disabled. This issue existed when the client was created, but only noticed when most of puppet was switched over to use the client for network connections. To reproduce:\r\n\r\n{noformat}\r\n$ puppet agent -td --http_keepalive_timeout 0 | grep ''Using cached connection''\r\nDebug: Using cached connection for https://bleak-scorecard.delivery.puppetlabs.net:8140\r\nDebug: Using cached connection for https://bleak-scorecard.delivery.puppetlabs.net:8140\r\nDebug: Using cached connection for https://bleak-scorecard.delivery.puppetlabs.net:8140\r\nDebug: Using cached connection for https://bleak-scorecard.delivery.puppetlabs.net:8140\r\nDebug: Using cached connection for https://bleak-scorecard.delivery.puppetlabs.net:8140\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10434', 'https://github.com/puppetlabs/puppet/pull/8111', '2020-04-22T15:43:43.000-0700', '2020-04-27T03:39:29.000-0700', '2020-04-27T03:39:29.000-0700', 'Resolved', 'doc_reviewed', 4, '0', 2, 44, 19, 5, 'fd907e5fd8ca7a47aed757f7d94caee14125d97f'),
('puppet', 354993, 403441243, 8096, 'Unify service return values', 'The {{get|post|put|*}} REST API methods aren''t consistent about return values. For example {{put}} can return a boolean, the stringified response body or the response object. It would be good to make those consistent. Also it would be good to always return the response so that the caller can elect to resubmit the request with different parameters if needed. If the method also returns an entity, then have the method return an array containing {{[response, entity]}}.', 'https://tickets.puppetlabs.com/browse/PUP-10418', 'https://github.com/puppetlabs/puppet/pull/8096', '2020-04-09T09:12:04.000-0700', '2020-04-27T03:44:11.000-0700', '2020-04-27T03:44:11.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 5, 185, 59, 15, 'cc967563b11523150a2af300eb810933b7529889'),
('puppet', 354829, 405928008, 8102, 'Comparing rpm package versions without epoch fails', '*Desired Behavior:*\r\n To succesfully do the version comparison:\r\n{panel}\r\n3:1.0 > 1.2\r\n{panel}\r\n \r\n\r\n \r\n\r\n*Actual Behavior:*\r\n Is not able to compare epoch *3* against missing epoch.\r\n\r\n \r\n\r\n*Proposed solution:*\r\n\r\nCurrently, missing epoch is considered to be nil in the code. This should be instead treated as 0 when comparing versions. This case occurs when a package with a version containing epoch was already installed.\r\n\r\n \r\n\r\nRegarding this topic, version received in the :ensure field of the manifest should be stripped of epoch when installing packages (as yum at least seems to use epoch just for sorting the versions but will not find specific version when epoch is mentioned).\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10416', 'https://github.com/puppetlabs/puppet/pull/8102', '2020-04-08T09:04:39.000-0700', '2020-04-27T03:44:31.000-0700', '2020-04-27T03:44:31.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 9, 512, 285, 8, '972ecfe708b7bb39973bee6935a39d2fcdb3b4de'),
('puppet', 354468, 402661645, 8093, 'Windows service calls deprecated `puppet agent --configprint`', 'If you set the log_level to debug and restart the Windows agent running as a service, \r\n\r\n{noformat}\r\nC:\> puppet config set log_level debug --section main\r\nC:\> puppet config set logdest C:\Users\Administrator --section main\r\n{noformat}\r\n\r\nThen the Windows agent will log a deprecation warning each time it runs due to calling `puppet agent --configprint runinterval`. It should instead call `puppet config print runinterval --section agent`.\r\n\r\n{noformat}\r\n2020-04-06 21:27:15 +0000 Puppet (warning): Using --configprint is deprecated. Use ''puppet config <subcommand>'' instead.\r\n   (location: C:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/settings.rb:498:in `print_config_options'')\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10414', 'https://github.com/puppetlabs/puppet/pull/8093', '2020-04-06T14:32:08.000-0700', '2020-04-27T03:45:24.000-0700', '2020-04-27T03:45:24.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 2, 3, 3, 1, '773ed106ad2b24bcb834e3519162331e14361d82'),
('puppet', 354076, 399826852, 8081, 'Puppet .dmg packages fail on macOS 10.15', '*Puppet Version: 5.5.19, 6.14.0*\r\n *Puppet Server Version: 5.3.12*\r\n *OS Name/Version: macOS 10.15.4*\r\n\r\nThe pkgdmg provider uses the "-noidme" flag when mounting .dmg files with hdiutil. Per the man page for hdiutil in macOS 10.15, the IDME flags have been removed.\r\n\r\n"Removed the deprecated "hdiutil internet-enable" command and the IDME attach flags."\r\n\r\nThe use of the "-noidme" flag with hdiutil on any version of macOS 10.15 causes hdiutil to output a deprecation warning, which then causes the pkgdmg provider to fail to parse the plist xml generated by hdiutil, causing .dmg packages to fail in puppet.\r\n\r\nRemoving the "-noidme" flag from pkgdmg.rb seems to correct the issue. \r\n\r\n*Desired Behavior:*\r\n\r\n.dmg packages get installed correctly by puppet.\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\nPuppet fails to install .dmg packages with the following error:\r\n{code:java}\r\nFatal error: Start tag expected, ''<'' not found at :1.\r\nError: Could not set ''present'' on ensure: undefined method `has_key?'' for nil:NilClass (file: /etc/puppetlabs/code/modules/darwin/manifests/init.pp, line: 212)\r\nError: Could not set ''present'' on ensure: undefined method `has_key?'' for nil:NilClass (file: /etc/puppetlabs/code/modules/darwin/manifests/init.pp, line: 212)\r\nWrapped exception:\r\nundefined method `has_key?'' for nil:NilClass{code}\r\nUpon inspection with the debug output, the error above occurs when puppet attempts to mount a .dmg with hdiutil using the following command:\r\n{code:java}\r\nhdiutil mount -plist -nobrowse -readonly -noidme -mountrandom /tmp package.dmg{code}\r\nWhich generates the following output:\r\n{code:java}\r\nhdiutil: attach: WARNING: ignoring IDME options (obsolete)\r\n<?xml version="1.0" encoding="UTF-8"?>\r\n<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\r\n<plist version="1.0">\r\n<dict>\r\n <key>system-entities</key>\r\n <array>\r\n <dict>\r\n <key>content-hint</key>\r\n <string>Apple_partition_scheme</string>\r\n <key>dev-entry</key>\r\n <string>/dev/disk10</string>\r\n <key>potentially-mountable</key>\r\n <false/>\r\n <key>unmapped-content-hint</key>\r\n <string>Apple_partition_scheme</string>\r\n </dict>\r\n <dict>\r\n <key>content-hint</key>\r\n <string>Apple_partition_map</string>\r\n <key>dev-entry</key>\r\n <string>/dev/disk10s1</string>\r\n <key>potentially-mountable</key>\r\n <false/>\r\n <key>unmapped-content-hint</key>\r\n <string>Apple_partition_map</string>\r\n </dict>\r\n <dict>\r\n <key>content-hint</key>\r\n <string>Apple_HFS</string>\r\n <key>dev-entry</key>\r\n <string>/dev/disk10s2</string>\r\n <key>mount-point</key>\r\n <string>/private/tmp/dmg.YdyjLr</string>\r\n <key>potentially-mountable</key>\r\n <true/>\r\n <key>unmapped-content-hint</key>\r\n <string>Apple_HFS</string>\r\n <key>volume-kind</key>\r\n <string>hfs</string>\r\n </dict>\r\n </array>\r\n</dict>\r\n</plist>{code}\r\nThe first line in the output is not xml, which causes the pkgdmg provider to fail when attempting to parse the generated plist xml.', 'https://tickets.puppetlabs.com/browse/PUP-10408', 'https://github.com/puppetlabs/puppet/pull/8081', '2020-04-02T16:38:29.000-0700', '2020-04-27T03:46:53.000-0700', '2020-04-27T03:46:53.000-0700', 'Resolved', 'doc_reviewed', 5, '0', 1, 2, 2, 2, '6a50df80602f376be159a6d6dc45c91ad58b519c'),
('puppet', 351396, 394166722, 8060, 'Use ''**'' to pass keyword arguments in Ruby 2.7', '*Puppet Version: 5.5.10 (but it is not fixed in master branch also)*\r\n *Puppet Server Version:*\r\n *OS Name/Version:*\r\n\r\nUbuntu Focal. puppet 5.5.10, ruby2.7.\r\n\r\n*Desired Behavior:*\r\n\r\nNo warning pops up when puppet is executed with Ruby 2.7.\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\nA warning is emitted here: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/file_system/file_impl.rb#L83\r\n\r\nThe ''**'' operator should be used to pass keyword arguments from now on.', 'https://tickets.puppetlabs.com/browse/PUP-10393', 'https://github.com/puppetlabs/puppet/pull/8060', '2020-03-27T05:16:34.000-0700', '2020-04-27T03:50:29.000-0700', '2020-04-27T03:50:29.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 1, 1, 1, 1, 'b03ab65fe4475ab0c3ee5155a70fb99216d46b06'),
('puppet', 350600, 398074444, 8076, 'Custom file ownership for lastrunreport as defined in puppet.conf is ignored', '*Puppet Version: 6.14.0*\r\n *Puppet Server Version: 6.9.1*\r\n *OS Name/Version: Ubuntu 18.04.4 LTS (Bionic Beaver)*\r\n\r\nSomewhat similarly to PUP-10325, the custom ownership settings for the `lastrunreport` file in `puppet.conf` also doesn''t seem to be preserved once the agent run is finished. Interestingly enough, _during_ the run it seems to be correctly set.\r\n\r\n*Desired Behavior:*\r\n\r\n**After the run is finished, the `lastrunreport` file should have the ownership and permissions set as specified in `puppet.conf`.\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\nDuring the run the ownership/permissions seems to be correctly set, but once finished, the ownership of the `lastrunreport` file is set to `root:root` and permissions to `0660`.', 'https://tickets.puppetlabs.com/browse/PUP-10376', 'https://github.com/puppetlabs/puppet/pull/8076', '2020-03-19T08:29:13.000-0700', '2020-04-27T03:54:39.000-0700', '2020-04-27T03:54:39.000-0700', 'Resolved', 'doc_reviewed', 5, '0', 1, 5, 1, 1, '0cfc461d3e784be17f20a56a2c2f6c39649627c9'),
('puppet', 350599, 402508540, 8091, 'Latest version ensured for python packages is incorrect', 'In [lib/puppet/provider/package/pip.rb|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/pip.rb] pip version checks and python packages sortings/comparisons are prone to be often done incorrectly. One example would be for the ''numpy'' package. Below can be seen some of this package''s versions being sorted incorrectly:\r\n||{color:#00875a}Correctly sorted{color}||{color:#de350b}Currently sorted{color}||\r\n|1.10.4|1.10.4|\r\n|1.11.0b3|{color:#de350b}1.11.0{color}|\r\n|1.11.0rc1|{color:#de350b}1.11.0b3{color}|\r\n|1.11.0rc2|{color:#de350b}1.11.0rc1{color}|\r\n|1.11.0|{color:#de350b}1.11.0rc2{color}|\r\n|1.11.1rc1|{color:#de350b}1.11.1{color}|\r\n|1.11.1|{color:#de350b}1.11.1rc1{color}|\r\n|1.11.2rc1|{color:#de350b}1.11.2{color}|\r\n|1.11.2|{color:#de350b}1.11.2rc1{color}|\r\n\r\n \r\n\r\nThis impacts package installation, using pip, when trying to ensure the latest version for any python package. \r\n\r\n \r\n\r\n*{{Proposed solution:}}*\r\n\r\nAll pip version checks and python packages comparison/sortings should be done using {color:#57d9a3}Puppet::Util::Package::Version::Pip.compare{color} instead of {color:#de350b}Puppet::Util::Package.versioncmp{color}.\r\n\r\nThis solution''s implementation impact needs to be addressed as following:\r\n * in case of invalid/unsupported versions, it shouldn''t raise anything which might disrupt the rest of a manifest application/agent run\r\n * would be a good idea to investigate pip''s legacy versions (see [pip''s source code|https://github.com/pypa/pip/blob/master/src/pip/_vendor/packaging/version.py], check if this is still being used by packages/if such packages still exist and then, based on findings, maybe reconsider supporting them {color:#ff8b00}*OR*{color} find a suitable solution for when puppet will come across one of them)\r\n * some refactoring needs to be done for partially duplicated code: get all available versions for a package in only one method (at least per pip version particularities) by sorting the list of available versions and use it to find out the latest version and also use it when checking for a version range)\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10375', 'https://github.com/puppetlabs/puppet/pull/8091', '2020-03-19T08:27:40.000-0700', '2020-04-27T03:55:55.000-0700', '2020-04-27T03:55:55.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 2, 55, 44, 4, 'b4041607d2c38e842c95f3b41e042c15ecb59320'),
('puppet', 349097, 386972351, 8034, 'Convert some beaker tests to rspec integration', 'The switch to using the http client for all indirector requests introduced regressions that weren''t caught in nightly CI or when running {{jenkins please test this with servertests}}. Fortunately this was caught downstream before we released in PUP-10359, but it would be good to faster feedback.\r\n\r\nThe issues weren''t tested during PR testing, because {{with servertests}} only runs tests tagged with {{risk:high}} or {{audit:high}}, and several tests that would have caught the issue are tagged as {{*:medium}}, such as:\r\n\r\n{noformat}\r\nacceptance/tests/direct_puppet/static_catalog_env_control.rb\r\nacceptance/tests/direct_puppet/cached_catalog_remediate_local_drift.rb\r\nacceptance/tests/language/sensitive_data_type.rb\r\nacceptance/tests/reports/failover_master.rb\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10362', 'https://github.com/puppetlabs/puppet/pull/8034', '2020-03-09T10:54:31.000-0700', '2020-04-27T04:00:03.000-0700', '2020-04-27T04:00:03.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 2, 352, 56, 3, '02b5f208ce4842f7f213d609419c74638f8f55fb'),
('puppet', 348140, 384328535, 8023, 'Custom file mode for lastrunreport as defined in puppet.conf is ignored', '*Puppet Version: 6.13.0*\r\n *Puppet Server Version: 6.7.1*\r\n *OS Name/Version: CentOS Linux release 7.7.1908 (Core)*\r\n\r\n \r\n\r\nWe just attempted to upgrade puppet agent from 6.8.1 to 6.13.0 and found that after the upgrade the file permissions on the "lastrunreport" file were reset and not honored to what was defined in our puppet.conf:\r\n\r\nExample:\r\n{code:java}\r\n[agent]\r\n  lastrunreport = /var/tmp/puppet/last_run_report.yaml { mode = 0664 }\r\n  lastrunfile = /var/tmp/puppet/last_run_summary.yaml { mode = 0664 }{code}\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nPermissions should match what''s defined in puppet.conf:\r\n\r\n \r\n{code:java}\r\n$ ls -lah\r\ntotal 856K\r\ndrwxr-xr-x. 2 root root 61 Feb 28 21:20 .\r\ndrwxrwxrwt. 6 root root 4.0K Feb 28 14:32 ..\r\n-rw-rw-r--. 1 root root 848K Feb 28 21:20 last_run_report.yaml\r\n-rw-rw-r--. 1 root root 1.7K Feb 28 21:20 last_run_summary.yaml\r\n$\r\n{code}\r\nBoth files have a mode of 664\r\n\r\n \r\n\r\n \r\n\r\n*Actual Behavior:*\r\n\r\nIn reality, after the upgrade the file permissions will be correct if the puppet service is restarted... But after a manual, or scheduled run (by the service daemon) the file permissions will be incorrect:\r\n{code:java}\r\n$ ls -lah\r\ntotal 856K\r\ndrwxr-xr-x. 2 root root   61 Feb 28 21:20 .\r\ndrwxrwxrwt. 6 root root 4.0K Feb 28 14:32 ..\r\n-rw-rw----. 1 root root 848K Feb 28 21:20 last_run_report.yaml\r\n-rw-rw-r--. 1 root root 1.7K Feb 28 21:20 last_run_summary.yaml\r\n$\r\n{code}\r\nNotice that last_run_report.yaml has a mode of 660 when it should be 664\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10325', 'https://github.com/puppetlabs/puppet/pull/8023', '2020-03-02T16:24:34.000-0800', '2020-04-27T04:01:28.000-0700', '2020-04-27T04:01:28.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 106, 0, 2, '41acdf3a9d9c271b975eedf431f3b5607063a77d'),
('puppet', 348081, 391779433, 8051, 'Forward http client requests to puppetserver', 'In order to switch the http report processor and other server-side termini to using the new HTTP Client API, we need to provide a puppetserver implementation of the API. However, we don''t want to introduce an incompatibility in puppet 6.x such that it requires a specific version of puppetserver 6.x to work.\r\n\r\nSo the idea is to create an implementation of the HTTP Client API which adapts the legacy \r\n{{Puppet::Network::HttpPool.http_client_class}} that puppetserver currently registers.\r\n\r\nFor this ticket:\r\n\r\n\r\n1. Create {{Puppet::HTTP::ExternalClient}} which implements a subset of the {{Puppet::HTTP::Client}} API, {{get}} and {{post}}, as those are the only methods implemented in puppetserver.\r\n2. All other public methods should raise {{NotImplementedError}}, like {{create_session}}, {{put}}, etc.\r\n3. When {{get}} or {{post}} are called, the external client should create an instance of {{Puppet::Network::HttpPool.http_client_class}} and adapt the Client API to the legacy Connection API. So raise instances of {{Puppet::HTTP::HTTPError}} or subclasses, return {{Puppet::HTTP::Response}} objects, etc.\r\n4. Register the {{Puppet::HTTP::ExternalClient}} in the puppet runtime when the {{HttpPool.http_client_class=}} method is called.', 'https://tickets.puppetlabs.com/browse/PUP-10324', 'https://github.com/puppetlabs/puppet/pull/8051', '2020-03-02T09:57:23.000-0800', '2020-04-27T04:02:11.000-0700', '2020-04-27T04:02:11.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 5, 375, 82, 9, 'b0db9dfda95bfafc9a1940e5b2167c123f5e5a64'),
('puppet', 343144, 392362023, 8052, 'windows pidlock can raise access denied', 'If puppet is running in the background as a service, and you run {{puppet agent -t}} in the foreground, then the foreground process may not have permission to open the process token for the background process running as {{LocalSystem}} resulting in an ugly error message:\r\n\r\n{noformat}\r\nc:\Program Files\Puppet Labs\Puppet\puppet\lib\ruby\vendor_ruby\puppet>puppet agent -t --trace\r\nError: Could not run Puppet configuration client: OpenProcess(2000, 0, 1604):  Access is denied.\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/process.rb:73:in `open_process''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/process.rb:125:in `get_process_image_name_by_pid''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/pidlock.rb:69:in `clear_if_stale''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/pidlock.rb:11:in `locked?''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/pidlock.rb:20:in `lock''\r\nc:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:19:in `lock''\r\n{noformat}\r\n\r\nPuppet should either interpret that to mean "the pid specified in the lockfile is still running" or it needs to enable the {{SeDebugPrivilege}} prior to calling {{OpenProcess}} like we do when managing file DACLs. The former is unable to tell if the running process is puppet/ruby or some other process that is now reusing the stale pid, which is the problem we had originally. Might be able to run {{tasklist}} to get the command line, though enabling the debug privilege would definitely detect if the process id is puppet:\r\n\r\n{code:ruby}\r\nwith_privilege(SE_DEBUG_PRIVILEGE) do\r\n  open_process(PROCESS_QUERY_INFORMATION, false, pid) do |phandle|\r\n    ...\r\n  end\r\nend\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10248', 'https://github.com/puppetlabs/puppet/pull/8052', '2020-01-22T22:16:32.000-0800', '2020-04-27T05:33:00.000-0700', '2020-04-27T05:33:00.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 1, 66, 17, 4, 'f62104da8d2aa26ec0aba82b9bdd84c99d4cc842'),
('puppet', 341497, 398379671, 8078, 'Puppet 6 daemons do not release ssl_lockfile', 'The {{puppet}} service holds {{ssl_lockfile}} after submiting a Certificate\r\nSigning Request. This blocks other processes from running {{puppet agent -t}}\r\nor {{puppet ssl download_cert}} after the request has been signed by the\r\nPuppet CA.\r\n\r\nh2. Reproduction Case\r\n\r\n  - Install Puppet Server 6.7 on CentOS 7 and initialize it:\r\n\r\n{code:bash}\r\nyum install -y http://yum.puppetlabs.com/puppet6-release-el-7.noarch.rpm\r\nyum install -y puppetserver\r\n\r\nsource /etc/profile.d/puppet-agent.sh\r\npuppet config set server $(hostname -f)\r\npuppetserver ca setup\r\nsystemctl start puppetserver\r\n{code}\r\n\r\n  - Install Puppet Agent 6.11.1 on another CentOS 7 node, configure it to talk\r\n    with the server, and start the daemon:\r\n\r\n{code:bash}\r\nyum install -y http://yum.puppetlabs.com/puppet6-release-el-7.noarch.rpm\r\nyum install -y puppet-agent\r\n\r\nsource /etc/profile.d/puppet-agent.sh\r\npuppet config set server <hostname of server from step 1>\r\nsystemctl start puppet\r\n{code}\r\n\r\n\r\n  - Sign the certificate on the server:\r\n\r\n{code:bash}\r\npuppetserver ca sign --certname=<hostname of agent from step 2>\r\n{code}\r\n\r\n  - Run {{puppet agent -t}} or {{puppet ssl download_cert}} on the agent.\r\n\r\nh3. Outcome\r\n\r\nBoth commands fail with "Could not run: Another puppet instance is already running; exiting"\r\n\r\n{noformat}\r\n# puppet agent -t --trace\r\nError: Could not run: Another puppet instance is already running; exiting\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/state_machine.rb:421:in `with_lock''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/state_machine.rb:392:in `run_machine''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/state_machine.rb:370:in `ensure_client_certificate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:505:in `wait_for_certificates''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:368:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:687:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:143:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n\r\n# puppet ssl download_cert --trace\r\nError: Could not run: Another puppet instance is already running; exiting\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/state_machine.rb:421:in `with_lock''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/state_machine.rb:392:in `run_machine''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/ssl/state_machine.rb:361:in `ensure_ca_certificates''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/ssl.rb:130:in `main''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:390:in `run_command''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:687:in `exit_on_fail''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:143:in `run''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\r\n{noformat}\r\n\r\nThis is because the {{ssl_lockfile}} exists and is held by the daemon:\r\n\r\n{noformat}\r\n# ls $(puppet config print ssl_lockfile)\r\n/etc/puppetlabs/puppet/ssl/ssl.lock\r\n\r\n# echo $(cat $(puppet config print ssl_lockfile))\r\n10460\r\n\r\n# systemctl show -p MainPID puppet\r\nMainPID=10460\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe daemon releases the {{ssl_lockfile}} when it is not actively updating certificate state.', 'https://tickets.puppetlabs.com/browse/PUP-10228', 'https://github.com/puppetlabs/puppet/pull/8078', '2020-01-08T14:32:54.000-0800', '2020-04-27T05:33:47.000-0700', '2020-04-27T05:33:47.000-0700', 'Resolved', 'doc_reviewed', 4, '0', 3, 85, 36, 2, 'd4623582ccbdb538c169690fbb7ea1bc40a001ad'),
('puppet', 320115, 305637810, 7664, 'User type has custom retrieve() with non-standard return values', 'The core user type has a custom retrieve() method which returns a Hash that is inconsistent with the data type returned by the common method in Puppet::Type.retrieve(). As a result, mechanisms expecting to use retrieve() will have problems with user resources.\r\n\r\nHere is the offending code in the user type: [https://github.com/puppetlabs/puppet/blob/master/lib/puppet/type/user.rb#L496-L513]\r\n\r\nI think it may be safe and desirable to just remove the user type''s retrieve block and let the standard one take effect. The existing retrieve method seems to be 10+ years old and may just be an artifact of a much earlier time in Puppet''s life.\r\n\r\nRegardless if the method is needed or not, it should have a return value consistent with the expected return value from the standard Puppet::Type.retrieve() method.', 'https://tickets.puppetlabs.com/browse/PUP-9943', 'https://github.com/puppetlabs/puppet/pull/7664', '2019-08-08T06:58:19.000-0700', '2020-04-27T05:35:26.000-0700', '2020-04-27T05:35:26.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 2, 22, 3, '56579d3495ac66cab0db939aa78e3193154409a2'),
('puppet', 349295, 397984579, 8074, '5.5.17 agents fail on interval runs', 'After upgrade to 2018.1.11, agents with 5.5.17 fail to run successfully on interval. Manual agent runs are successful and also when set with cron job. \n\nError is no implicit conversion from nil to integer (TypeError)\n\n\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:98:in `exit'': no implicit conversion from nil to integer (TypeError)\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:98:in `block in run_in_fork''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:94:in `fork''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:94:in `run_in_fork''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:48:in `block in run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:46:in `run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/daemon.rb:170:in `block in run_event_loop''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/scheduler/job.rb:49:in `run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/scheduler/scheduler.rb:39:in `block in run_ready''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/scheduler/scheduler.rb:34:in `each''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/scheduler/scheduler.rb:34:in `run_ready''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/scheduler/scheduler.rb:11:in `run_loop''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/daemon.rb:193:in `run_event_loop''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/daemon.rb:149:in `start''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:402:in `main''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:354:in `run_command''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:375:in `block in run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:667:in `exit_on_fail''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:375:in `run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:139:in `run''\nfrom /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\nfrom /opt/puppetlabs/puppet/bin/puppet:5:in `<main>''\n\n~* Please see Zendesk Support tab for further comments and attachments.~', 'https://tickets.puppetlabs.com/browse/PUP-10366', 'https://github.com/puppetlabs/puppet/pull/8074', '2020-03-11T01:17:21.000-0700', '2020-04-27T05:46:27.000-0700', '2020-04-27T05:46:27.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 4, '0', 2, 38, 38, 2, 'a2d41deaae314cc49bdd1bfd4f04f88055f4567f'),
('puppet', 356870, 410407689, 8123, 'Pass credentials in basic_auth hash', 'The old API accepts credentials as {{options[:basic_auth]}} where it contains a hash of {{\{user: "username"\}}} and {{\{password: "a password"\}}}. The new API accepts a flattened version {{options[:user]}} and {{options[:password]}}, which assumes basic authentication. We should be able to support different authentication schemes in the future, so it would be good to namespace them, e.g. {{options[:basic_auth]}} vs {{options[:digest_auth]}}.', 'https://tickets.puppetlabs.com/browse/PUP-10470', 'https://github.com/puppetlabs/puppet/pull/8123', '2020-04-27T09:45:36.000-0700', '2020-04-30T09:10:15.000-0700', '2020-04-30T09:10:15.000-0700', 'Resolved', '', 2, '0', 1, 34, 38, 6, '4db27afa92d5ddea5a688d0357254b491523efca'),
('puppet', 356228, 407151124, 8109, 'RedHat RHBA-2020:1028 breaks yum.rb in yum provider for some systems', '*Puppet Version: 5.5.x (probably 6.x as well)*\r\n *Puppet Server Version: NA, but 5.3.x*\r\n *OS Name/Version: RedHat Linux 7.8*\r\n\r\nDescribe your issue in as much detail as possible…\r\n Describe steps to reproduce…\r\n\r\n*Desired Behavior:*\r\n\r\nYum package ensure => latest should ensure latest\r\n\r\n*Actual Behavior:*\r\n\r\nYum package ensure => latest never finds an update.  Explicit versions work OK.\r\n\r\nMore details:\r\n\r\nRH added a newline character when subscription manager is enabled.\r\n\r\nyum.rb looks for first blank line: [https://github.com/puppetlabs/puppet/blob/f2709eb5b28894cf017dbe41290d3c0d168e721b/lib/puppet/provider/package/yum.rb#L123-L125]\r\n\r\n \r\n{code:java}lib/puppet/provider/package/yum.rb:123-125\r\n def self.parse_updates(str)\r\n # Strip off all content before the first blank line\r\n body = str.partition(/^\s*\n/m).last\r\n{code}\r\n As a result, parse_updates returns {} when subscription manager is enabled.\r\n\r\nOld behavior:\r\n{code:java}# yum check-update\r\n Loaded plugins: product-id, search-disabled-repos, subscription-manager\r\n This system is not registered with an entitlement server. You can use subscription-manager to register.{code}\r\n \r\n\r\nNew behavior:\r\n{code:java}# yum check-update\r\n Loaded plugins: product-id, search-disabled-repos, subscription-manager\r\n\r\nThis system is not registered with an entitlement server. You can use subscription-manager to register.{code}\r\n \r\n\r\nworkaround 1: disable subscription-manager\r\n workaround 2: downgrade subscription-manager\r\n\r\n \r\n\r\nExample Code:\r\n $app == ''pcmhi''\r\n $version == ''latest''\r\n{code:java} # package\r\n    package { $app:\r\n        ensure    => $version,\r\n        provider  => yum,\r\n        require   => Yumrepo[$app],\r\n        subscribe => [\r\n            Package[''nginx''],\r\n            Package[''python3'']\r\n        ]\r\n    }{code}\r\n \r\n  \r\n\r\nRepo Contents:\r\n{code:java}Index of rpm/pcmhi/quality_assurance\r\nName                       Last modified      Size\r\n../\r\nrepodata/                   20-Apr-2020 19:28    -\r\npcmhi-3.5.23-0.x86_64.rpm   20-Apr-2020 16:01  19.53 MB\r\npcmhi-3.6.0-0.x86_64.rpm    20-Apr-2020 19:28  23.33 MB\r\n\r\n{code}\r\nManual Update Check:\r\n{code:java}# yum check-update | grep pcmhi\r\n pcmhi.x86_64             1:3.6.0-0             pcmhi{code}\r\n \r\n\r\nPuppet logs:\r\n{code:java}^[[0;36mDebug: Executing: ''/bin/rpm --version''^[[0m\r\n ^[[0;36mDebug: Executing ''/bin/rpm -qa --nosignature --nodigest --qf ''%{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n'' | sort''^[[0m\r\n ^[[0;36mDebug: Executing: ''/bin/yum check-update''^[[0m{code}\r\n \r\n\r\nPoC debug output for yum.rb:\r\n  \r\n{code:java}def self.parse_updates(str)\r\n     # Strip off all content before the first blank line\r\n     self.debug "parse_updates input #{str}"\r\n     body = str.partition(/^\s*\n/m).last\r\n     self.debug "parse_updates body #{body}"\r\n\r\n     updates = Hash.new { |h, k| h[k] = [] }\r\n     body.split.each_slice(3) do |tuple|\r\n       self.debug "tuple #{tuple}"\r\n       break if tuple[0] =~ /^(Obsoleting|Security:|Update)/  {code}\r\n \r\n\r\nCustom Debug Output (bad):\r\n  \r\n  \r\n{code:java}Debug: Executing: ''/bin/yum check-update''\r\nDebug: Puppet::Type::Package::ProviderYum: parse_updates body - note that the subscription manager warning is present on a bad run\r\nDebug: Puppet::Type::Package::ProviderYum: ----------------------------\r\nDebug: Puppet::Type::Package::ProviderYum: This system is not registered with an entitlement server. You can use subscription-manager to register.\r\ncontainerd.io.x86_64 1.2.6-3.3.el7 sbai \r\ndocker-ce.x86_64 3:19.03.5-3.el7 sbai \r\ndocker-ce-cli.x86_64 1:19.03.5-3.el7 sbai \r\npcmhi.x86_64 1:3.6.0-0 pcmhi \r\npuppet-agent.x86_64 5.5.19-1.el7 puppet5\r\nrhn-check.x86_64 2.0.2-24.el7 rhel7 \r\nrhn-client-tools.x86_64 2.0.2-24.el7 rhel7 \r\nrhn-setup.x86_64 2.0.2-24.el7 rhel7 \r\nDebug: Puppet::Type::Package::ProviderYum: ----------------------------\r\nDebug: Puppet::Type::Package::ProviderYum: update tuple - should be name|version|repo: ["This", "system", "is"]\r\nDebug: Puppet::Type::Package::ProviderYum: parse_updates output {}\r\n{code}\r\n \r\n\r\nCustom Debug Output (downgraded subscription-manager package):\r\n{code:java}Debug: Executing: ''/bin/yum check-update''\r\nDebug: Puppet::Type::Package::ProviderYum: parse_updates body - note that the subscription manager warning is present on a bad run\r\nDebug: Puppet::Type::Package::ProviderYum: ----------------------------\r\nDebug: Puppet::Type::Package::ProviderYum: containerd.io.x86_64                               1.2.6-3.3.el7         sbai   \r\ndocker-ce.x86_64                                   3:19.03.5-3.el7       sbai   \r\ndocker-ce-cli.x86_64                               1:19.03.5-3.el7       sbai   \r\npcmhi.x86_64                                       1:3.6.0-0             pcmhi  \r\npuppet-agent.x86_64                                5.5.19-1.el7          puppet5\r\nrhn-check.x86_64                                   2.0.2-24.el7          rhel7  \r\nrhn-client-tools.x86_64                            2.0.2-24.el7          rhel7  \r\nrhn-setup.x86_64                                   2.0.2-24.el7          rhel7  \r\nsubscription-manager.x86_64                        1.24.26-1.el7         rhel7  \r\nsubscription-manager-rhsm.x86_64                   1.24.26-1.el7         rhel7  \r\nsubscription-manager-rhsm-certificates.x86_64      1.24.26-1.el7         rhel7  \r\nDebug: Puppet::Type::Package::ProviderYum: ----------------------------\r\n<snip>\r\nDebug: Puppet::Type::Package::ProviderYum: update tuple - should be name|version|repo: ["pcmhi.x86_64", "1:3.6.0-0", "pcmhi"]\r\nDebug: Puppet::Type::Package::ProviderYum: update_to_hash {:name=>"pcmhi", :epoch=>"1", :version=>"3.6.0", :release=>"0", :arch=>"x86_64"}\r\nDebug: Puppet::Type::Package::ProviderYum: short_name pcmhi\r\nDebug: Puppet::Type::Package::ProviderYum: long_name pcmhi.x86_64\r\n<snip>\r\nDebug: Puppet::Type::Package::ProviderYum: parse_updates output {"containerd.io"=>[{:name=>"containerd.io", :epoch=>"0", :version=>"1.2.6", :release=>"3.3.el7", :arch=>"x86_64"}], "containerd.io.x86_64"=>[{:name=>"containerd.io", :epoch=>"0", :version=>"1.2.6", :release=>"3.3.el7", :arch=>"x86_64"}], "docker-ce"=>[{:name=>"docker-ce", :epoch=>"3", :version=>"19.03.5", :release=>"3.el7", :arch=>"x86_64"}], "docker-ce.x86_64"=>[{:name=>"docker-ce", :epoch=>"3", :version=>"19.03.5", :release=>"3.el7", :arch=>"x86_64"}], "docker-ce-cli"=>[{:name=>"docker-ce-cli", :epoch=>"1", :version=>"19.03.5", :release=>"3.el7", :arch=>"x86_64"}], "docker-ce-cli.x86_64"=>[{:name=>"docker-ce-cli", :epoch=>"1", :version=>"19.03.5", :release=>"3.el7", :arch=>"x86_64"}], "pcmhi"=>[{:name=>"pcmhi", :epoch=>"1", :version=>"3.6.0", :release=>"0", :arch=>"x86_64"}], "pcmhi.x86_64"=>[{:name=>"pcmhi", :epoch=>"1", :version=>"3.6.0", :release=>"0", :arch=>"x86_64"}], "puppet-agent"=>[{:name=>"puppet-agent", :epoch=>"0", :version=>"5.5.19", :release=>"1.el7", :arch=>"x86_64"}], "puppet-agent.x86_64"=>[{:name=>"puppet-agent", :epoch=>"0", :version=>"5.5.19", :release=>"1.el7", :arch=>"x86_64"}], "rhn-check"=>[{:name=>"rhn-check", :epoch=>"0", :version=>"2.0.2", :release=>"24.el7", :arch=>"x86_64"}], "rhn-check.x86_64"=>[{:name=>"rhn-check", :epoch=>"0", :version=>"2.0.2", :release=>"24.el7", :arch=>"x86_64"}], "rhn-client-tools"=>[{:name=>"rhn-client-tools", :epoch=>"0", :version=>"2.0.2", :release=>"24.el7", :arch=>"x86_64"}], "rhn-client-tools.x86_64"=>[{:name=>"rhn-client-tools", :epoch=>"0", :version=>"2.0.2", :release=>"24.el7", :arch=>"x86_64"}], "rhn-setup"=>[{:name=>"rhn-setup", :epoch=>"0", :version=>"2.0.2", :release=>"24.el7", :arch=>"x86_64"}], "rhn-setup.x86_64"=>[{:name=>"rhn-setup", :epoch=>"0", :version=>"2.0.2", :release=>"24.el7", :arch=>"x86_64"}], "subscription-manager"=>[{:name=>"subscription-manager", :epoch=>"0", :version=>"1.24.26", :release=>"1.el7", :arch=>"x86_64"}], "subscription-manager.x86_64"=>[{:name=>"subscription-manager", :epoch=>"0", :version=>"1.24.26", :release=>"1.el7", :arch=>"x86_64"}], "subscription-manager-rhsm"=>[{:name=>"subscription-manager-rhsm", :epoch=>"0", :version=>"1.24.26", :release=>"1.el7", :arch=>"x86_64"}], "subscription-manager-rhsm.x86_64"=>[{:name=>"subscription-manager-rhsm", :epoch=>"0", :version=>"1.24.26", :release=>"1.el7", :arch=>"x86_64"}], "subscription-manager-rhsm-certificates"=>[{:name=>"subscription-manager-rhsm-certificates", :epoch=>"0", :version=>"1.24.26", :release=>"1.el7", :arch=>"x86_64"}], "subscription-manager-rhsm-certificates.x86_64"=>[{:name=>"subscription-manager-rhsm-certificates", :epoch=>"0", :version=>"1.24.26", :release=>"1.el7", :arch=>"x86_64"}]}\r\n{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10432', 'https://github.com/puppetlabs/puppet/pull/8109', '2020-04-21T09:48:42.000-0700', '2020-05-01T09:20:49.000-0700', '2020-05-01T09:20:49.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 2, 37, 16, 3, 'ade968986c9cb352f07821b86cea4da97c37b422'),
('puppet', 305257, 323418893, 7752, 'Pip package provider does not handle pip executable paths with spaces', 'The package pip provider has some suggestion of Windows support. However, it uses "execpipe" to invoke commands, which puts a shell redirection of "2>&1" into the final command which is not compatible with Windows.\r\n\r\nOn a Windows system with Python installed when the "pip_version" method is called it results in an error: "Cannot collect packages for Puppet::Type::Package::ProviderPip3 provider; undefined method `[]'' for nil:NilClass"\r\n\r\nReworking this in terms of execute allows the pip provider to work on Windows as well.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9647', 'https://github.com/puppetlabs/puppet/pull/7752', '2019-04-17T13:39:22.000-0700', '2020-05-01T13:20:35.000-0700', '2020-05-01T13:20:35.000-0700', 'Resolved', 'maintenance;resolved-issue-added;triage', 6, '0', 2, 38, 19, 2, 'e1ad42e61000b9daef2c74116ee65bde4bd1b59c'),
('puppet', 263957, 323406318, 7751, 'pip provider fails if "pip --version" does not emit the version on the first line of output', '*Puppet Version: 4.8.2*\r\n*OS Name/Version: Debian 8.10*\r\n\r\n \r\n\r\nWhen trying to install a package with the pip provider\r\n\r\npuppet agent -t fails with\r\n{code:java}\r\nInfo: Using configured environment ''xxx''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for myhost.com\r\nInfo: Applying configuration version ''123213''\r\nError: Failed to apply catalog: undefined method `[]'' for nil:NilClass\r\n \r\n{code}\r\nwith --trace it points to:\r\n\r\n \r\n{code:java}\r\nError: Failed to apply catalog: undefined method `[]'' for nil:NilClass\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:64:in `block (2 levels) in pip_version''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:63:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:63:in `collect''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:63:in `block in pip_version''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/execution.rb:81:in `block (2 levels) in execpipe''\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/open-uri.rb:36:in `open''\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/open-uri.rb:36:in `open''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/execution.rb:80:in `block in execpipe''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:128:in `withenv''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/execution.rb:79:in `execpipe''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider.rb:117:in `execpipe''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:62:in `pip_version''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:43:in `instances''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package.rb:4:in `prefetch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:323:in `prefetch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:223:in `prefetch_if_necessary''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:107:in `block in evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:116:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:116:in `traverse''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:154:in `evaluate''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:222:in `block in apply''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:155:in `with_destination''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/report.rb:142:in `as_logging_destination''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:221:in `apply''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:171:in `block in apply_catalog''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `block in benchmark''\r\n \r\n{code}\r\nThe code is:\r\n{code:java}\r\n1  def self.pip_version\r\n2    pip_cmd = self.pip_cmd\r\n3    return nil unless pip_cmd\r\n4    execpipe [pip_cmd, ''--version''] do |process|\r\n5      process.collect do |line|\r\n6        return line.strip.match(/^pip (\d+\.\d+\.?\d*).*$/)[1]\r\n7      end\r\n8    end\r\n9  end\r\n\r\n{code}\r\nLine 6 fails when "pip --version" returns other information:\r\n{code:java}\r\n# pip --version\r\n/usr/local/lib/python2.7/dist-packages/urllib3/contrib/socks.py:37: DependencyWarning: SOCKS support in urllib3 requires the installation of optional dependencies: specifically, PySocks.  For more information, see https://urllib3.readthedocs.io/en/latest/contrib.html#socks-proxies\r\n  DependencyWarning\r\npip 1.5.6 from /usr/lib/python2.7/dist-packages (python 2.7)\r\n{code}\r\nBecause then there is no match, it returns null and using [1] on null obviously fails.\r\n\r\nInstalling python-pysocks removes the warning and fixes the puppet run.\r\n\r\n\r\n*Desired Behavior:*\r\n\r\nThe pip_version function should be able to handle additional output. Either by checking if there is a match or by filtering out stderr.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8986', 'https://github.com/puppetlabs/puppet/pull/7751', '2018-07-06T05:14:46.000-0700', '2020-05-11T00:59:04.000-0700', '2020-05-11T00:59:04.000-0700', 'Resolved', 'Easy;jira_escalated;linux;package;pip;resolved-issue-added;type_and_provider', 4, '0', 1, 31, 1, 2, '1003464465f066c3db6058740fb8443f80f8a0eb'),
('puppet', 348049, 383395856, 8016, 'Facter 4 debug logs don''t use Puppet logger', '*Puppet Version: 6.13*\r\n *Puppet Server Version: ---*\r\n *OS Name/Version: all*\r\n\r\n \r\n\r\nWhen we enable facterng feature flag\r\n{code:java}\r\npuppet config set facterng true{code}\r\n and run \r\n{code:java}\r\npuppet facts --debug{code}\r\n log messages use Facter 4 logger instead of Puppet logger\r\n\r\n \r\n\r\nFacter 4 logger output format is\r\n{code:java}\r\n[<date_time> ] <log-level> <class-name> - <log-message>\r\n{code}\r\nPuppet debug logs fro facter\r\n{code:java}\r\nDebug: Facter: <log-message>{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10322', 'https://github.com/puppetlabs/puppet/pull/8016', '2020-03-02T07:13:29.000-0800', '2020-05-13T01:53:22.000-0700', '2020-05-13T01:53:22.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 1, 28, 2, 2, 'bdc11fb0197c6be048753488f7983710d5b9ec69'),
('puppet', 342589, 373940145, 7982, 'Change strict_hostname_checking to true', 'the decision was to change the default for strict_hostname_checking from false to true in the next release and to remove the option entirely (and only allow strict hostname checking) in Puppet 7. This would include an advisory that users not upgrading should change strict_hostname_checking to true.\r\n\r\nFor those who want the previous insecure behavior for the remainder of the 6 series they may disable strict_hostname_checking. However they are encouraged to switch to the preferred way to have that functionality in 7 now. For those users that want to classify their nodes using the CN but with partial segment matching they should switch their node declarations to use regexes. For those users that want to include hostname, fqdn, or domain facts in their classification schemes they should do so explicitly in a default node block. (I can create example manifests if desired)\r\n\r\nThe rationale for this, is that partial segment matching could also be considered insecure (don''t have a rating for it though), there are more explicit ways to match partial CNs or facts in a site.pp (see above workarounds), and other options don''t allow for users to opt out of the security fixes (should they be relying on this behavior) in the short term.\r\n\r\n \r\n\r\nBecause this is a documented option (though inherently insecure) I will do this work with a PR to the open source repo (not a private fork), but w/o reference to the CVE. I will open this PR towards the end of the normal release cycle as well.', 'https://tickets.puppetlabs.com/browse/PUP-10238', 'https://github.com/puppetlabs/puppet/pull/7982', '2020-01-17T10:41:22.000-0800', '2020-05-13T18:18:22.000-0700', '2020-05-13T18:18:22.000-0700', 'Resolved', '', 2, '0', 1, 31, 9, 2, 'df826baa0ed1f3ebb182798aa6e04a9e8f35fd80'),
('puppet', 341492, 373838010, 7980, 'Close the http connection prior to sleeping retry-after seconds', 'To prevent thundering herds, puppetserver may return Retry-After and ask the agent to sleep. Until recently the agent would keep the connection open, until timeout occurs. To reduce resource usage on puppetserver, we should close the connection immediately.\r\n\r\nThe latest puppetserver version will return {{Connection: close}}, but agents may talk to older puppetservers versions which would benefit from this.', 'https://tickets.puppetlabs.com/browse/PUP-10227', 'https://github.com/puppetlabs/puppet/pull/7980', '2020-01-08T13:56:09.000-0800', '2020-05-13T18:18:23.000-0700', '2020-05-13T18:18:23.000-0700', 'Resolved', 'resolved-issue-added', 6, '0', 1, 9, 2, 3, 'dc7b92db8212cfeb16407212fef2ac93676054f9'),
('puppet', 332233, 363912169, 7928, 'Functions are slower if called with chained syntax than with prefix syntax', '*Puppet Version: 5.5.17*\r\n *Puppet Server Version: 2018.1*\r\n *OS Name/Version: Centos 7*\r\n\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nAs documented in [https://puppet.com/docs/puppet/5.5/lang_functions.html#chained-function-calls], chained function call syntax should result in same behaviour as prefixed syntax.\r\n\r\n*Actual Behavior:*\r\n\r\nUsing chained syntax results in slower performance of the function call. The performance depends on the size of the object "before the dot".\r\n\r\n{{Examples:}}\r\n\r\n{{Run puppet apply test.pp --debug --profile}}\r\n\r\nPlease see attached:\r\n * test.pp\r\n * test.log', 'https://tickets.puppetlabs.com/browse/PUP-10113', 'https://github.com/puppetlabs/puppet/pull/7928', '2019-10-28T07:45:25.000-0700', '2020-05-13T18:18:24.000-0700', '2020-05-13T18:18:24.000-0700', 'Resolved', 'resolved-issue-added', 10, '0', 3, 28, 3, 4, '455f08d71d7e1d028e5a6b320b0ca51b37eb73da'),
('puppet', 357903, 416332910, 8149, 'Puppet settings catalog requires codedir to be a directory', 'When file-sync is in {{versioned_deploys}} mode, we turn the target of Puppet''s codedir setting into a symlink that points at the most recently-deployed version of the code. However, Puppet''s internal settings catalog tries to ensure that {{codedir}} is a directory. When it finds a symlink instead, it errors, causing server startup to fail.\r\n{code:java}2020-05-06T16:27:25.444Z ERROR [clojure-agent-send-pool-0] [puppetserver] Puppet Could not set ''directory'' on ensure: File exists - /etc/puppetlabs/code/latest\r\nFile exists - /etc/puppetlabs/code/latestorg/jruby/RubyDir.java:632:in `mkdir''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/ensure.rb:93:in `block in set_directory''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:490:in `set''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:570:in `sync''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/file/ensure.rb:189:in `sync''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:241:in `sync''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:136:in `sync_if_needed''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:82:in `perform_changes''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:21:in `evaluate''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:267:in `apply''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:287:in `eval_resource''org/jruby/RubyMethod.java:119:in `call''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:191:in `block in evaluate''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:521:in `block in thinmark''uri:classloader:/META-INF/jruby.home/lib/ruby/stdlib/benchmark.rb:308:in `realtime''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:520:in `thinmark''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:191:in `block in evaluate''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:122:in `traverse''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:178:in `evaluate''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:240:in `block in apply''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:521:in `block in thinmark''uri:classloader:/META-INF/jruby.home/lib/ruby/stdlib/benchmark.rb:308:in `realtime''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:520:in `thinmark''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:239:in `block in apply''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:165:in `with_destination''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/report.rb:146:in `as_logging_destination''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:238:in `apply''/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/settings.rb:1070:in `use''uri:classloader:/puppetserver-lib/puppet/server/puppet_config.rb:89:in `initialize_puppet''uri:classloader:/puppetserver-lib/puppet/server/master.rb:37:in `initialize'' \r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10500', 'https://github.com/puppetlabs/puppet/pull/8149', '2020-05-06T11:33:04.000-0700', '2020-05-18T10:48:59.000-0700', '2020-05-18T10:48:59.000-0700', 'Closed', '', 8, '0', 1, 20, 4, 5, ''),
('puppet', 337880, 350258823, 7874, 'Puppet should not load types and providers during environment convergence', 'During environment convergence, puppet loads types and providers for pluginsynced modules, potentially multiple times. Type/provider loading is triggered when writing the cached catalog and/or when converting the resource catalog to a RAL catalog.\r\n\r\nHowever, if the environment doesn''t converge the first time, then puppet will switch environments, and pluginsync in a different environment, potentially receiving different versions of type/provider code. Puppet can reload new versions of types and providers, but can''t reload helper code required by type/providers. This can result in newer providers calling methods in older helper code still in memory.\r\n\r\nThis problem may occur when the classifier uses pluginsynced facts to determine environment, a node doesn''t have that fact yet (or a wrong version of the fact), puppetdb doesn''t have a facts for that node in the "final" environment, the node attempts to get a catalog, and there are different versions of a module in different environments.\r\n\r\nThe problem may not occur, or may not be noticed if the different versions of modules don''t conflict in a way that causes an exception.\r\n\r\nThe problem won''t occur if the agent resolves the environment during the node request (before pluginsync). However, the agent doesn''t send facts with the node request (a long standing request), so this generally applies to nodes that have already resolved the environment once.\r\n\r\nHere''s a stacktrace showing the inifile type/provider being loaded during the environment resolution process (using 5.5.17):\r\n\r\n{noformat}\r\n# puppet --version\r\n5.5.17\r\n# rm -rf /opt/puppetlabs/puppet/cache/lib/ && puppet config set certname "agent55x$RANDOM" --section main && puppet agent -t --trace --logdest /tmp/out.log\r\n\r\n--> #0  #<Class:Puppet::Util::Autoload>.mark_loaded(name#String, file#String) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:43\r\n    #1  #<Class:Puppet::Util::Autoload>.load_file(name#String, env#Puppet::Node::Environment::Remote) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:70\r\n    #2  Puppet::Util::Autoload.load(name#Symbol, env#Puppet::Node::Environment::Remote) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/autoload.rb:198\r\n    #3  Puppet::MetaType::Manager.type(name#Symbol) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/metatype/manager.rb:174\r\n    #4  #<Class:Puppet::Resource>.resource_type(type#String, title#String, environment#Puppet::Node::Environment::Remote) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:360\r\n    #5  Puppet::Resource.resource_type at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:348\r\n    #6  Puppet::Resource.parse_title at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:656\r\n    #7  Puppet::Resource.to_hash at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:392\r\n    #8  Puppet::Resource.to_data_hash at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:93\r\n    #9  block in Puppet::Resource::Catalog.block in to_data_hash at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:506\r\n    ͱ-- #10 Array.map at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:506\r\n    #11 Puppet::Resource::Catalog.to_data_hash at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:506\r\n    #12 Puppet::Network::FormatSupport.to_json(*args#Array) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/format_support.rb:100\r\n    #13 Puppet::Network::Format.render(instance#Puppet::Resource::Catalog) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/format.rb:65\r\n    #14 Puppet::Network::FormatSupport.render(format#String) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/format_support.rb:106\r\n    #15 Puppet::Resource::Catalog::Json.to_json(object#Puppet::Resource::Catalog) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/json.rb:19\r\n    #16 block in Puppet::Indirector::JSON.block in save(request#Puppet::Indirector::Request) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/json.rb:17\r\n    #17 #<Class:Puppet::Util>.replace_file(file#Pathname, default_mode#Integer, &block#Proc) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:603\r\n    #18 Puppet::Indirector::JSON.save(request#Puppet::Indirector::Request) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/json.rb:17\r\n    #19 Puppet::Indirector::Indirection.find(key#String, options#Hash) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:204\r\n    #20 block in Puppet configuration client.block in retrieve_new_catalog(query_options#Hash) at /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:455\r\n{noformat}\r\n\r\nTo fix this problem the conversion of resource catalog to RAL catalog and writing the cached catalog need to occur after the environment converges.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10160', 'https://github.com/puppetlabs/puppet/pull/7874', '2019-12-04T11:42:30.000-0800', '2020-05-18T14:50:24.000-0700', '2020-05-18T14:50:24.000-0700', 'Resolved', 'resolved-issue-added', 2, '0', 18, 426, 425, 3, 'f490127b4554a2bb4d30117c8f581cb7cb816a7f'),
('puppet', 160414, 418554153, 8159, 'useradd provider fails if the current value of user''s expiry is nil', 'Error: /Stage[main]/xxx::Userlistt/Resources[user]: Failed to generate additional resources using ''generate'': expected numeric                                    [250/1815]\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/provider/user/useradd.rb:40:in `+''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/provider/user/useradd.rb:40:in `block (2 levels) in <top (required)>''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/provider/nameservice.rb:218:in `call''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/provider/nameservice.rb:218:in `unmunge''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/provider/user/useradd.rb:208:in `block (3 levels) in <top (required)>''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/property.rb:471:in `retrieve''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/user.rb:393:in `block in retrieve''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/user.rb:387:in `each''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/user.rb:387:in `inject''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/user.rb:387:in `retrieve''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type.rb:1076:in `retrieve_resource''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/resources.rb:149:in `user_check''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/resources.rb:94:in `check''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/resources.rb:113:in `block in generate''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/resources.rb:113:in `select''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/type/resources.rb:113:in `generate''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/transaction/additional_resource_generator.rb:17:in `generate_additional_resources''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/transaction.rb:83:in `block in evaluate''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/transaction.rb:83:in `each''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/transaction.rb:83:in `evaluate''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/resource/catalog.rb:169:in `block in apply''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/util/log.rb:149:in `with_destination''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/transaction/report.rb:112:in `as_logging_destination''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/resource/catalog.rb:168:in `apply''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/configurer.rb:120:in `block in apply_catalog''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/util.rb:161:in `block in benchmark''\r\n/usr/lib64/ruby/2.1.0/benchmark.rb:294:in `realtime''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/util.rb:160:in `benchmark''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/configurer.rb:119:in `apply_catalog''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/configurer.rb:227:in `run_internal''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/configurer.rb:134:in `block in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/context.rb:64:in `override''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet.rb:246:in `override''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/configurer.rb:133:in `run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:47:in `block (4 levels) in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent/locker.rb:20:in `lock''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:47:in `block (3 levels) in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:117:in `with_client''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:44:in `block (2 levels) in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:82:in `run_in_fork''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:43:in `block in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application.rb:179:in `call''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application.rb:179:in `controlled_run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/agent.rb:41:in `run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application/agent.rb:361:in `onetime''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application/agent.rb:327:in `run_command''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application.rb:381:in `block (2 levels) in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application.rb:507:in `plugin_hook''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application.rb:381:in `block in run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/util.rb:496:in `exit_on_fail''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/application.rb:381:in `run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/util/command_line.rb:146:in `run''\r\n/usr/lib64/ruby/vendor_ruby/2.1.0/puppet/util/command_line.rb:92:in `execute''\r\n/usr/bin/puppet:8:in `<main>''', 'https://tickets.puppetlabs.com/browse/PUP-6909', 'https://github.com/puppetlabs/puppet/pull/8159', '2016-11-09T20:34:32.000-0800', '2020-05-19T02:41:59.000-0700', '2020-05-19T02:41:59.000-0700', 'Closed', 'linux;platform-os;sles;type_and_provider;user', 8, '0', 1, 1, 1, 1, ''),
('puppet', 356873, 411730666, 8128, 'Accept symbols as names of runtime implementation', 'The {{Puppet.runtime[name]}} API should use symbols, e.g. {{:http}}, because it doesn''t require the caller to allocate a string (puppet doesn''t use the frozen string pragma yet).\r\n\r\nIf a string is specified, we may want to covert to a symbol using {{String#to_sym}}, but we could also just not do that.\r\n\r\nUpdate API docs to use a symbol.', 'https://tickets.puppetlabs.com/browse/PUP-10471', 'https://github.com/puppetlabs/puppet/pull/8128', '2020-04-27T09:52:51.000-0700', '2020-05-19T06:51:45.000-0700', '2020-05-19T06:51:45.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 42, 26, 16, 'faadd1185f047c7fbcecb2e24c2d1be1aa6abf1b'),
('puppet', 356713, 409806098, 8117, 'Add deprecation warning to find/search/save/destroy methods in the abstract rest terminus', 'Add deprecation warnings to the find/search/save/destroy methods to the Puppet::Indirection::Rest.', 'https://tickets.puppetlabs.com/browse/PUP-10445', 'https://github.com/puppetlabs/puppet/pull/8117', '2020-04-24T13:19:50.000-0700', '2020-05-19T06:53:14.000-0700', '2020-05-19T06:53:14.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 1, 18, 0, 2, 'c0adb0b199755afdc9e77216bf2d70f825416cd1'),
('puppet', 356711, 409798168, 8116, 'Deprecate http file content terminus', 'Puppet no longer uses the indirector to retrieve file content from puppet/http(s) URLS, so the {{http}} fille content terminus can be deprecated in 6.x and removed in puppet 7.', 'https://tickets.puppetlabs.com/browse/PUP-10444', 'https://github.com/puppetlabs/puppet/pull/8116', '2020-04-24T13:14:41.000-0700', '2020-05-19T06:54:12.000-0700', '2020-05-19T06:54:12.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 5, 0, 1, 'c8da674dc441b789db2205bf21127749be979c91'),
('puppet', 356111, 406377457, 8105, 'Add method for registering runtime implementations', 'Puppetserver needs to be able to register its http client implementation (See SERVER-2780). This ticket is to make the change in puppet so puppetserver can do that.', 'https://tickets.puppetlabs.com/browse/PUP-10429', 'https://github.com/puppetlabs/puppet/pull/8105', '2020-04-20T11:19:06.000-0700', '2020-05-19T06:55:17.000-0700', '2020-05-19T06:55:17.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 4, 78, 26, 5, 'aff8428d7a19ea255dd74dd0dcd5cbfe5d701516'),
('puppet', 355521, 403446376, 8097, 'Observe waitforlock when acquiring the ssl lock', 'PUP-8051 adds an option so the agent can wait for an in-progress run to finish. This ticket is to add the same functionality to the ssl state machine lock. This ticket is blocked on PUP-10228', 'https://tickets.puppetlabs.com/browse/PUP-10420', 'https://github.com/puppetlabs/puppet/pull/8097', '2020-04-14T11:44:28.000-0700', '2020-05-19T06:56:02.000-0700', '2020-05-19T06:56:02.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 81, 12, 2, 'e6a1418487359aa3d5b2e62d93ab33ab50fb3ad9'),
('puppet', 347230, 414745277, 8140, 'puppet plugin download fails if agent specified environment doesn''t exist on the agent', 'Add a {{dev}} environment to {{/etc/puppetlabs/code/environments/dev}} on the puppetserver.\r\nOn a different host, the agent run will succeed, but plugin download will fail:\r\n\r\n{noformat}\r\n$ puppet agent -t -E dev\r\nInfo: Using configured environment ''dev''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for XXX\r\nInfo: Applying configuration version ''1582303430''\r\n$  bx puppet plugin download  -E dev\r\nbundler: failed to load command: puppet (/Users/josh/work/puppet/.bundle/ruby/2.3.0/bin/puppet)\r\nPuppet::Environments::EnvironmentNotFound: Could not find a directory environment named ''dev'' anywhere in the path: /Users/josh/.puppetlabs/etc/code/environments. Does the directory exist?\r\n  /Users/josh/work/puppet/lib/puppet/environments.rb:40:in `get!''\r\n  /Users/josh/work/puppet/lib/puppet/application_support.rb:34:in `push_application_context''\r\n  /Users/josh/work/puppet/lib/puppet/application.rb:370:in `run''\r\n  /Users/josh/work/puppet/lib/puppet/util/command_line.rb:143:in `run''\r\n  /Users/josh/work/puppet/lib/puppet/util/command_line.rb:77:in `execute''\r\n  /Users/josh/work/puppet/bin/puppet:5:in `<top (required)>''\r\n  /Users/josh/work/puppet/.bundle/ruby/2.3.0/bin/puppet:22:in `load''\r\n  /Users/josh/work/puppet/.bundle/ruby/2.3.0/bin/puppet:22:in `<top (required)>''\r\n{noformat}\r\n\r\nThe problem is the {{plugin}} application needs to specify that the environment is not required to exist locally:\r\n\r\n{code:diff}\r\ndiff --git a/lib/puppet/application/plugin.rb b/lib/puppet/application/plugin.rb\r\nindex 2d0402e43f..06beb9eabf 100644\r\n--- a/lib/puppet/application/plugin.rb\r\n+++ b/lib/puppet/application/plugin.rb\r\n@@ -1,3 +1,4 @@\r\n require ''puppet/application/face_base''\r\n class Puppet::Application::Plugin < Puppet::Application::FaceBase\r\n+  environment_mode :not_required\r\n end\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10307', 'https://github.com/puppetlabs/puppet/pull/8140', '2020-02-21T08:51:41.000-0800', '2020-05-19T06:58:53.000-0700', '2020-05-19T06:58:53.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 24, 0, 2, '0e6c6eec4b15869a93e316f3cd80175ffd1a3a0e'),
('puppet', 346028, 409857093, 8119, 'external trusted data is executed for file_content requests', '*Puppet Version: 6.12.0*\r\n *Puppet Server Version: 6.8.0*\r\n *OS Name/Version: RHEL*\r\n\r\nWhen using the trusted_external_command setting, the command is executed for every file_content request, not just catalogs. This info can''t possibly be required for a file_content request and this will cause a huge performance impact to the puppetserver as this could easily be executed 1000 times for a given node if it''s new and needs to do a pluginsync, or if there are a lot of files managed.\r\n\r\nThe error you see below is just from my trusted_external_command and is irrelevant other than show that it does execute it each time\r\n\r\n \r\n{code:java}\r\n172.17.0.2 - - - 12/Feb/2020:11:52:37 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/chomp.rb?environment=production& HTTP/1.1" 200 1295 172.17.0.2 172.17.0.2 8140 96\r\n2020-02-12 11:52:37,545 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned172.17.0.2 - - - 12/Feb/2020:11:52:37 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/chop.rb?environment=production& HTTP/1.1" 200 1343 172.17.0.2 172.17.0.2 8140 107\r\n2020-02-12 11:52:37,632 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned172.17.0.2 - - - 12/Feb/2020:11:52:37 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/clamp.rb?environment=production& HTTP/1.1" 200 1330 172.17.0.2 172.17.0.2 8140 84\r\n2020-02-12 11:52:37,730 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned172.17.0.2 - - - 12/Feb/2020:11:52:37 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/concat.rb?environment=production& HTTP/1.1" 200 1331 172.17.0.2 172.17.0.2 8140 85\r\n2020-02-12 11:52:37,811 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned172.17.0.2 - - - 12/Feb/2020:11:52:37 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/convert_base.rb?environment=production& HTTP/1.1" 200 1935 172.17.0.2 172.17.0.2 8140 87\r\n2020-02-12 11:52:37,916 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned172.17.0.2 - - - 12/Feb/2020:11:52:37 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/count.rb?environment=production& HTTP/1.1" 200 1373 172.17.0.2 172.17.0.2 8140 86\r\n2020-02-12 11:52:38,013 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned172.17.0.2 - - - 12/Feb/2020:11:52:38 +0000 "GET /puppet/v3/file_content/plugins/puppet/parser/functions/create_ini_settings.rb?environment=production& HTTP/1.1" 200 1711 172.17.0.2 172.17.0.2 8140 94\r\n2020-02-12 11:52:38,107 WARN  [c.p.p.ShellUtils] Executed an external process which logged to STDERR: loading of puppet_x/external_data/multiplexer failed, no external data will be returned {code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10292', 'https://github.com/puppetlabs/puppet/pull/8119', '2020-02-12T05:52:47.000-0800', '2020-05-19T06:59:50.000-0700', '2020-05-19T06:59:50.000-0700', 'Resolved', 'doc_reviewed', 8, '0', 3, 31, 8, 2, '3a674690358e15072a537d3d5f0f96e181007233'),
('puppet', 338108, 412313627, 8132, 'Agent incorrectly reporting corrective changes when base64 padding is missing from Content-MD5', '*Puppet Version: 6.11.1*\r\n *Puppet Server Version: 6*\r\n *OS Name/Version: Centos* \r\n\r\nReproducing this requires using a file from an https server as the source for a local file. In our case it is things that are secret like /etc/shadow that we don''t want committed to our puppet repo. \r\n\r\n*Local Reproducing Steps:*\r\n\r\n* run the command below and copy the md5 resulted\r\n\r\n{code:bash}[root@unpaved-song ttt]# printf ''%s'' "File Data" | md5sum\r\n0ee8336a3589503bcb03c7885950c909{code}\r\n\r\n* create a .rb file and copy the following inside to have a server with a get response with "File Data" text and a Content-MD5 header.\r\n\r\n \r\n{code:ruby}# server.rb\r\nrequire ''socket''\r\nserver = TCPServer.new 5678\r\nwhile session = server.accept\r\n  request = session.gets\r\n  puts request \r\n  session.print "HTTP/1.1 200\r\n"\r\n  session.print "Content-Type: text/html\r\n"\r\n  session.print "Content-MD5: 0ee8336a3589503bcb03c7885950c909\r\n"\r\n  session.print "\r\n"\r\n  session.print "File Data"\r\n  session.close\r\nend\r\n{code}\r\n\r\n* run ruby server.rb to start the server\r\n* run puppet apply -e ''file \{"/file_from_server": source => "http://localhost:5678"}'' to get the data form the local server\r\n\r\n{code:java}[root@unpaved-song ttt]# puppet apply -e ''file {"/file_from_server": source => "http://localhost:5678"}''\r\nNotice: Compiled catalog for unpaved-song.delivery.puppetlabs.net in environment production in 0.01 seconds\r\nNotice: /Stage[main]/Main/File[/file_from_server]/ensure: defined content as ''{md5}f5d7fb75fe1beb6f1bedaefa6bddf7df9e7df797b9ef4d9c''\r\nNotice: Applied catalog in 0.07 seconds\r\n{code}\r\n\r\n* Running the command again you will get\r\n\r\n{code:java}Notice: /Stage[main]/Main/File[/file_from_server]/content: content changed ''{md5}0ee8336a3589503bcb03c7885950c909'' to ''{md5}f5d7fb75fe1beb6f1bedaefa6bddf7df9e7df797b9ef4d9c''\r\n{code}\r\n \r\n\r\n*Desired Behavior:*\r\n\r\nI want the agent to calculate the md5sum correctly when pulling a file from a remote https server. \r\n\r\n*Actual Behavior:*\r\n\r\nAgent reports changing content from an MD5 with 128 bits to an ''MD5'' with 196 bits. It doesn''t change the file as no changes are needed. The ''changed'' file''s md5sum is the same before and  after the agent runs.\r\n\r\nIt seems to be using a 196 bit hash in place of an md5sum and reporting it needs changing as the 128 bit and 196 bit values are not equal.', 'https://tickets.puppetlabs.com/browse/PUP-10164', 'https://github.com/puppetlabs/puppet/pull/8132', '2019-12-05T13:51:59.000-0800', '2020-05-19T07:02:13.000-0700', '2020-05-19T07:02:13.000-0700', 'Resolved', 'doc_reviewed', 8, '0', 1, 11, 1, 2, 'b6c270674d2fbdf75ff87959b5c8fa0cedf4d971'),
('puppet', 353908, 404922918, 8100, '"Unable to set ownership" error with logdest on agents running as root', 'As described in the attached issue, a puppet agent run raises the following error: "Puppet (err): Unable to set ownership to puppet:puppet for log file".\r\nCaused by trying to change the owner to puppet:puppet which doesn''t exist and shouldn''t happen when run as root.\r\n\r\nThis happens if the file doesn''t exist but also when it does, since it writes to a temporary file and tries to set owner on this one too.\r\n\r\nAlso the command line parameter "--no-manage_internal_file_permissions" dosen''t help.\r\n\r\nAlthough this should have been fixed, it''s not.', 'https://tickets.puppetlabs.com/browse/PUP-10407', 'https://github.com/puppetlabs/puppet/pull/8100', '2020-04-02T00:28:32.000-0700', '2020-05-19T09:38:20.000-0700', '2020-05-19T09:38:20.000-0700', 'Resolved', 'doc_reviewed', 4, '0', 1, 2, 39, 2, '5f16070ad576e9c9aa6c33e3e38f7005930f1c21'),
('puppet', 259518, 406732902, 8107, 'AIX package installation is not checking state of the package ', 'Hi, \r\n\r\nWhen we installing packages on AIX servers, We are only checking package name and version. We are not checking the package state. If the package is broken or inconsistent state, the puppet is not reporting any error. Puppet thinks the package is installed and good shape. So it is leaving the customer to check manually about the issue. \r\n\r\n \r\n\r\nOne of our customer package was installed but it was inconsistent, puppet didn''t check the status of that package. \r\n\r\nFor example: \r\n\r\n+*Broken state:-*+\r\n\r\n \r\n\r\n[root@tstspap221:/root]# /usr/sbin/installp -L -d /nfs/infra/veritas/sw/VOM/VRTSsfmh_7.3.1.200_AIX.bff\r\n\r\nVRTSsfmh:VRTSsfmh:7.3.1.200::I:?:::::N:Veritas Infoscale Operations Manager Managed Host::::0::\r\n\r\n[root@tstspap221:/root]# /usr/bin/lslpp -Lc VRTSsfmh\r\n\r\n#Package Name:Fileset:Level:State:PTF Id:Fix State:Type:Description:Destination Dir.:Uninstaller:Message Catalog:Message Set:Message Number:Parent:Automatic:EFIX Locked:Install Path:Build Date\r\n\r\nVRTSsfmh:VRTSsfmh:7.3.1.200: : :?: :Veritas Infoscale Operations Manager Managed Host: : : : : : :0:0:/:\r\n\r\n[root@tstspap221:/root]#\r\n\r\n[root@tstspap221:/root]#\r\n\r\n \r\n\r\n \r\n\r\n+*Successful* *installation*:*-*+\r\n\r\n \r\n\r\n[root@qatcdex143:/root]# lslpp -Lcq VRTSsfmh\r\n\r\nVRTSsfmh:VRTSsfmh:7.3.1.200: : :C: :Veritas Infoscale Operations Manager Managed Host: : : : : : :0:0:/:\r\n\r\n[root@qatcdex143:/root]# /usr/sbin/installp -L -d /nfs/infra/veritas/sw/VOM/VRTSsfmh_7.3.1.200_AIX.bff\r\n\r\nVRTSsfmh:VRTSsfmh:7.3.1.200::I:C:::::N:Veritas Infoscale Operations Manager Managed Host::::0::\r\n\r\n[root@qatcdex143:/root]#\r\n\r\n \r\n\r\n{color:#ff0000}*State codes:*{color}\r\nA – Applied.\r\nB – Broken.\r\nC – Committed.\r\nE – EFIX Locked.\r\nO – Obsolete. (partially migrated to newer version)\r\n? – Inconsistent State...Run lppchk -v.\r\n\r\n \r\n\r\nCan we add install_option for AIX provider ? Currently AIX provider will not support install_option attribute. \r\n\r\n \r\n\r\nExpected Result,\r\n\r\n \r\n\r\nIf broken package or incosistent pacakge , Puppet will raise error and report failed change. \r\n\r\n \r\n\r\n \r\n\r\n \r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8937', 'https://github.com/puppetlabs/puppet/pull/8107', '2018-06-06T20:11:25.000-0700', '2020-05-27T02:58:35.000-0700', '2020-05-27T02:58:35.000-0700', 'Resolved', 'aix;customer;doc_reviewed;package;type_and_provider', 1, '0', 1, 46, 2, 2, '328dfa049e831bd8a61598652ad8cd692712ec65'),
('puppet', 304376, 272619650, 7492, 'Windows package resource does not remove trailing whitespace', 'Package Inspector in Windows is reading in the version number without removing trailing whitespace, which when submitted to the DB as a fact causes the updated facts for that agent to be discarded.\r\n\r\nAs seen on a Windows machine:\r\n\r\n{code:puppet}\r\npackage { ''McAfee SiteAdvisor Enterprise'':\r\n  ensure => ''1.7.0.144                                                                                                                                                                                                                                                      '',\r\n}\r\n{code}\r\n\r\nWhich is passed into a fact as:\r\n\r\n{code:json}\r\n{\r\n"name": "node.puppet.com",\r\n"values": {\r\n"_puppet_inventory_1": {\r\n"packages": [\r\n["McAfee SiteAdvisor Enterprise", "1.7.0.144\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000", "windows"]\r\n{code}\r\n\r\nWhich in turn causes PuppetDB to reject facts from the node, including facts other than the one with the null bit:\r\n\r\n{code:puppet}\r\n2017-10-06 17:32:11,961 ERROR [p.p.command] [5,166,564] [replace facts] Retrying after attempt 0 for node.puppet.com, due to: org.postgresql.util.PSQLException: ERROR: invalid byte sequence for encoding "UTF8": 0x00 \r\norg.postgresql.util.PSQLException: ERROR: invalid byte sequence for encoding "UTF8": 0x00\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9639', 'https://github.com/puppetlabs/puppet/pull/7492', '2019-04-10T14:56:52.000-0700', '2020-05-28T13:08:25.000-0700', '2020-05-28T13:08:25.000-0700', 'Resolved', 'cstop10;jira_escalated;maintenance;resolved-issue-added;triage', 3, '0', 1, 59, 1, 2, '0d9a3f9f3e4bad87e5963dacf61eedaf626cf730'),
('puppet', 357470, 420310398, 8163, 'LOAD_PATH can get corrupted when multithreading is on', '', 'https://tickets.puppetlabs.com/browse/PUP-10483', 'https://github.com/puppetlabs/puppet/pull/8163', '2020-04-30T14:37:28.000-0700', '2020-05-28T17:15:24.000-0700', '2020-05-28T17:15:24.000-0700', 'Resolved', '', 0, '0', 1, 3, 0, 1, 'bb3d3594722cfc05a46ed1682151a42d700bb2e2'),
('puppet', 356838, 409466876, 8114, 'Portage package provider doesn''t work on Gentoo-based distributions', '*Puppet Version:* 6.13.0\r\n *Puppet Server Version:* 6.10.0\r\n *OS* *Name/Version:*  Sabayon Linux 20.03\r\n\r\nThe portage provider in Puppet confines to only operatingsystem gentoo, which won''t work on distributions based on Gentoo.\r\n\r\n*Desired Behavior:*\r\n\r\nThe portage provider works on all Gentoo-family distributions.\r\n\r\n*Actual Behavior:*\r\n\r\n{{Error: /Package[net-misc/choria-bin]: Provider portage is not functional on this host}}', 'https://tickets.puppetlabs.com/browse/PUP-10469', 'https://github.com/puppetlabs/puppet/pull/8114', '2020-04-27T05:09:38.000-0700', '2020-05-29T01:19:49.000-0700', '2020-05-29T01:19:49.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 1, 7, 2, 2, '396764d21d605650f38910439a1c40896c8b0ede'),
('puppet', 127750, 0, 0, 'site.pp with file resource containing UTF8 failing on certain platforms', '{code}\r\n  jzhs4gu5sg0xuan.delivery.puppetlabs.net (sles10-64-1) 20:41:15$ puppet agent -t --environment supports_utf8_y3vl7m8o --server szl38k2b9kcl48n.delivery.puppetlabs.net\r\n      Info: Using configured environment ''supports_utf8_y3vl7m8o''\r\n      Info: Retrieving pluginfacts\r\n      Info: Retrieving plugin\r\n      Info: Caching catalog for jzhs4gu5sg0xuan.delivery.puppetlabs.net\r\n      Info: Applying configuration version ''1461296478''\r\n      Error: invalid byte sequence in US-ASCII\r\n      Error: /Stage[main]/Main/File[/tmp/supports_utf8_y3vl7m8o.xW6229]/content: change from {md5}d41d8cd98f00b204e9800998ecf8427e to {md5}f1c1271f5e21eba48374b96e43caddc1 failed: invalid byte sequence in US-ASCII\r\n      Notice: Applied catalog in 0.13 seconds\r\n{code}\r\n\r\nsee:\r\nhttps://github.com/puppetlabs/puppet/blob/stable/acceptance/tests/direct_puppet/supports_utf8.rb\r\n(we can''t use expect_failure() in that test, so test will have to be unskipped when this is fixed)\r\n\r\nfailing on: \r\n* arista4-32\r\n* cumulus25-64\r\n* osx1009\r\n* osx1010\r\n* osx1011\r\n* sles10', 'https://tickets.puppetlabs.com/browse/PUP-6217', 'https://github.com/puppetlabs/puppet/commit/18057d35528d877d7c3c22e47d211ba577a57b71', '2016-04-21T13:50:38.000-0700', '2020-06-06T16:28:48.000-0700', '2020-06-06T16:28:48.000-0700', 'Closed', 'i18n;utf-8', 14, '0', 0, 0, 0, 0, '18057d35528d877d7c3c22e47d211ba577a57b71'),
('puppet', 223720, 0, 0, 'No docs to run Puppet 4, 5, or 6 from source', 'The last official docs on running Puppet from source were for [Puppet 3.8|https://docs.puppet.com/puppet/3.8/from_source.html]. These are linked to from the Puppet repo''s README.\r\n\r\nAre there official docs for running Puppet from source for any newer versions of Puppet? Should there be? If so, what platforms should those docs cover? \r\n\r\nShould these docs exist as part of the versioned Puppet documentation, or in the GitHub repo? Should the docs team own them as user-facing docs, or should Platform own them as developer docs?', 'https://tickets.puppetlabs.com/browse/PUP-8200', 'https://github.com/puppetlabs/puppet/commit/f3265237264de95d59807ad9333182b5e405f9b9', '2017-11-22T10:43:36.000-0800', '2020-06-08T11:23:56.000-0700', '2020-06-08T11:23:56.000-0700', 'Closed', '', 7, '0', 0, 0, 0, 0, 'f3265237264de95d59807ad9333182b5e405f9b9'),
('puppet', 21361, 753887313, 8786, 'Remove ability to specify file checksum in `content` property', 'Using the source attribute to access static catalogs is the replacement for this use case (setting content => <md5 chucksum>), but you can still use magic {{content}} values. We have to remove this, but it needs to be on a major version boundary, probably Puppet 6.\r\n\r\nPlease ensure consistency with the deprecation warning provided to users:\r\n\r\nUsing a checksum in a file\''s "content" property is deprecated. The ability to use a checksum to retrieve content from the filebucket using the "content" property will be removed in a future release. The literal value of the "content" property will be written to the file. Functionality is being replaced by the use of static catalogs. See [https://puppet.com/docs/puppet/latest/static_catalogs.html] for more information.\r\n\r\n—\r\n\r\nPrevious description:\r\n\r\nRather than passing around the contents of a file (e.g. in logs) we use the checksum; to support this the user is also allowed to _specify_ the contents as a checksum, but this leads to an ambiguity when the actual contents match the checksum pattern.', 'https://tickets.puppetlabs.com/browse/PUP-1043', 'https://github.com/puppetlabs/puppet/pull/8786', '2013-12-16T03:02:16.000-0800', '2020-06-10T23:26:32.000-0700', '2020-06-10T23:26:32.000-0700', 'Ready for Engineering', 'redmine', 9, '0', 1, 23, 13, 2, '9aa28d1852eff0e5a8622c979af0bc205ecb4107'),
('puppet', 31124, 293253182, 7601, 'Not possible to manage SELinux file contexts via puppet in a sane way', 'There''s currently no sane way to manage SELinux file contexts using puppet. The only way is to call ''semanage'' via a ''exec'' resource. But then the next issue comes up: Puppet seems to keep some file context rule cache, built once at startup. I wasn''t able to find a way to invalidate this cache without restarting the whole puppet agent. Even when calling ''restorecon'' from puppet, the next puppet run will reset file contexts for ''file'' resources found in the catalog because of the cached file context rules. \r\n\r\n*How to reproduce:*\r\n{code:title=setest.pp|borderStyle=solid}\r\nfile { ''/srv/setest-before'':\r\n	ensure => directory,\r\n}\r\n-> exec { ''semanage'':\r\n	command =>  ''/usr/sbin/semanage fcontext -a -t home_root_t /srv/setest[^/]*'',\r\n	creates => ''/srv/setest-after'',\r\n}\r\n-> file { ''/srv/setest-after'':\r\n	ensure => directory,\r\n}\r\n{code}\r\n\r\n{code}\r\n# semanage fcontext -l | grep -c ''^/srv/setest''\r\n0\r\n# puppet apply setest.pp\r\n{code}\r\n\r\n\r\n*Expected behavior:*\r\n/srv/setest-before created with default file context\r\n/srv/setest-after created according to new file context rule. \r\n\r\n*Seen behavior:*\r\nBoth directories are created with default file context.tUP21', 'https://tickets.puppetlabs.com/browse/PUP-2169', 'https://github.com/puppetlabs/puppet/pull/7601', '2014-04-07T06:40:28.000-0700', '2020-06-24T11:04:23.000-0700', '2020-06-24T11:04:23.000-0700', 'Resolved', 'linux;resolved-issue-added;selinux', 25, '0', 1, 28, 1, 3, '0b142e7f69fe34ec0e27a339661f4acb8074afa1'),
('puppet', 350662, 401388032, 8089, '''puppet resource service'' does not return all active services on Ubuntu', '*Puppet Version: 6.14.0*\r\n *Puppet Server Version: whatever''s in PE 2019.5.0*\r\n *OS Name/Version: Ubuntu 18.04.4*\r\n{code:java}\r\n$ puppet resource service pe-postgresql\r\nservice { ''pe-postgresql'':\r\n  ensure   => ''running'',\r\n  enable   => ''true'',\r\n  provider => ''systemd'',\r\n}\r\n$ puppet resource service | grep pe-postgresql\r\n$ {code}\r\n*Desired Behavior:*\r\n\r\npe-postgresql should be listed when listing all services, because it definitely exists.\r\n\r\n*Actual Behavior:*\r\n\r\nSeems to be omitted. Some related debugging\r\n{code:java}\r\nsystemctl list-unit-files --type service --full | grep pe-postgresql\r\npe-postgresql.service                  bad\r\npe-postgresql11.service                static\r\npe-postgresql96.service                static{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10378', 'https://github.com/puppetlabs/puppet/pull/8089', '2020-03-19T16:08:49.000-0700', '2020-07-02T02:59:27.000-0700', '2020-07-02T02:59:27.000-0700', 'Resolved', 'doc_reviewed', 4, '0', 2, 21, 2, 3, '1a67a99756619e9c85a03d78d837de2f0c8fb33d'),
('puppet', 356395, 413446408, 8134, 'Zypper provider doesn''t recognize --no-gpg-checks as global option', '*Puppet Version:* 5.5.19**\r\n\r\n*Desired Behavior:* When running the below code, it should recognize the following install option as a global option.\r\n\r\n \r\n{code:java}\r\npackage { $foo:\r\nensure => installed,\r\ninstall_options => [''--no-gpg-checks''],\r\n}{code}\r\n \r\n\r\n*Actual Behavior:*\r\n\r\nIt appends the option to the end of the zypper command, and errors out when read as a sub-command option.\r\n\r\n*Workaround:*\r\n\r\nUsing the --no-gpg-check variant (note the lack of an S at the end) is recognized as a global zypper option, relevant code [here|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/zypper.rb#L91]. This issue is closely related to PUP-4090.\r\n\r\nA note on discoverability: The Zypper help output and manual only lists the "checks" variant of the option.', 'https://tickets.puppetlabs.com/browse/PUP-10433', 'https://github.com/puppetlabs/puppet/pull/8134', '2020-04-22T10:37:24.000-0700', '2020-07-02T03:00:25.000-0700', '2020-07-02T03:00:25.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 0, '0', 1, 14, 0, 2, '1c2153aa43b4e333f10058ae484a044a7d23ee2d'),
('puppet', 356472, 407927778, 8112, 'Running remove_old_postgresql_versions after upgrade failed', 'On Ubuntu 18.04, I ran the upgrade to 2019.5 and saw in the output a suggestion to run {{puppet infrastructure run remove_old_postgresql_versions}}. When I did that I got\r\n{code:java}\r\nThis node does not appear to have PE Postgresql11 installed, this plan can only be run to remove old Postgresql data after upgrading to PE Postgresql11. {code}\r\nin task error output.\r\n\r\nWhen I checked, the system was running postgresql 11\r\n{code:java}\r\n$ ps -ef | grep postgres\r\npe-post+ 14416     1  0 22:21 ?        00:00:00 /opt/puppetlabs/server/apps/postgresql/11/bin/postgres -D /opt/puppetlabs/server/data/postgresql/11/data -c log_directory=/var/log/puppetlabs/postgresql/11 -p 5432 {code}\r\n \r\n\r\nI tracked this back to the task checking whether postgres 11 is being used and found the following odd behavior\r\n{code:java}\r\n$ puppet resource service pe-postgresql\r\nservice { ''pe-postgresql'':\r\n  ensure   => ''running'',\r\n  enable   => ''true'',\r\n  provider => ''systemd'',\r\n}\r\n$ puppet resource service | grep pe-postgresql\r\n$ {code}\r\nThe task checks whether the {{pe-postgresql11}} service exists, but puppet didn''t show that service. This appears to be a bug in puppet (although it''s also more efficient on some platforms to check whether a single service exists than to grep all of them).', 'https://tickets.puppetlabs.com/browse/PUP-10437', 'https://github.com/puppetlabs/puppet/pull/8112', '2020-04-23T04:29:30.000-0700', '2020-07-02T03:01:13.000-0700', '2020-07-02T03:01:13.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 3, 22, 2, 3, '226cd26417f0d3153f8f5e97dba39df176db1c97'),
('puppet', 354877, 411507910, 8126, 'Installer switch "service-enable true" reports wrong actions in certain conditions', 'When installing an agent on Ubuntu (any version) using switches to both enable and stop the puppet service, via\r\n{code:bash}curl -k https://<fqdnhere>:8140/packages/current/install.bash | bash -s -- --puppet-service-ensure stopped --puppet-service-enable true\r\n{code}\r\nThe output shows this:\r\n{code:java}Setting the puppet service to ensure=stopped and enable=true\r\nservice { ''puppet'':\r\n  ensure => ''stopped'',\r\n  enable => ''false'',\r\n  provider => ''systemd'',\r\n}{code}\r\nThe expected output, and the output on EL6/7/8, is this:\r\n{code:java}Setting the puppet service to ensure=stopped and enable=true\r\nservice { ''puppet'':\r\n  ensure => ''stopped'',\r\n  enable => ''true'',\r\n  provider => ''systemd'',\r\n}{code}\r\nThis issue is entirely cosmetic, the service does end up enabled. The issue is not present when the switch "--puppet-service-enable true" is used standalone.\r\n\r\n~* Please see Zendesk Support tab for further comments and attachments.~', 'https://tickets.puppetlabs.com/browse/PUP-10479', 'https://github.com/puppetlabs/puppet/pull/8126', '2020-04-08T11:29:01.000-0700', '2020-07-02T03:01:53.000-0700', '2020-07-02T03:01:53.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 0, '0', 1, 65, 24, 3, '050dd9929da37621f10ef73017a63f4a9e1007f2'),
('puppet', 357551, 413083014, 8133, 'pip package provider does not handle pip executable paths with spaces', '*Puppet Version: 6.4.5 and 6.14.0*\r\n*OS Name/Version: Windows*\r\n\r\nOn a Windows Server 2016 node running Puppet 6.4.5 and 6.14.0 with Python installed in a path with spaces, the Puppet catalog returns the below error if package collection is enabled:\r\n\r\nCannot collect packages for Puppet::Type::Package::ProviderPip provider; [nil, nil]\r\n\r\nMore specifically, this issue was fixed in PUP-9647 for getting the pip version, but this was not fixed when Puppet executes the `pip freeze -all'' command to get the packages. \r\n\r\n*Desired Behavior:*\r\n\r\nQuote function should be added to the pip provider here:\r\n[https://github.com/puppetlabs/puppet/blob/6.14.0/lib/puppet/provider/package/pip.rb#L79]\r\n\r\n \r\n\r\nRelevant sections of configurations files (puppet.conf, hiera.conf, Server''s conf.d, defaults/sysconfig)\r\n\r\nFor memory issues with server heap dumps are also helpful.', 'https://tickets.puppetlabs.com/browse/PUP-10485', 'https://github.com/puppetlabs/puppet/pull/8133', '2020-05-01T13:20:13.000-0700', '2020-07-02T03:02:21.000-0700', '2020-07-02T03:02:21.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 2, 48, 20, 2, '3e3b2f183e53e411f1638761cb0fb148db1e8444'),
('puppet', 173739, 407087573, 8108, 'regression - systemd provider does not honor documented enabled states', 'We found this bug again with puppet-agent 1.9.0\r\n\r\nFor CentOS:\r\npuppet-agent-1.9.0-1.el7.x86_64\r\n\r\nFor Ubuntu:\r\nii  puppet-agent                          1.9.0-1xenial                         amd64        The Puppet Agent package contains all of the elements needed to run puppet, including ruby, facter, hiera and mcollective.\r\n\r\nThe virtlockd/virtlogd services under systemd (both on Ubuntu and CentOS) are being marked as non-idempotent due to\r\n2017-02-02 03:38:31 +0000 /Stage[main]/Nova::Compute::Libvirt::Services/Service[virtlockd]/enable (notice): enable changed ''false'' to ''true''\r\n2017-02-02 03:38:31 +0000 /Stage[main]/Nova::Compute::Libvirt::Services/Service[virtlogd]/enable (notice): enable changed ''false'' to ''true''\r\n\r\nSee logs\r\nhttp://logs.openstack.org/38/393738/15/check/gate-puppet-openstack-integration-4-scenario002-tempest-ubuntu-xenial/55b4fbf/logs/puppet.txt.gz#_2017-02-02_03_38_31\r\nhttp://logs.openstack.org/38/393738/15/check/gate-puppet-openstack-integration-4-scenario001-tempest-centos-7/ea5b599/logs/puppet.txt.gz#_2017-02-02_03_43_59\r\n\r\n\r\nPrevious bug PUP-6370 was described as:\r\nThe systemd provider considers too many states as "disabled" and should probably just simply track the return value of "is-enabled" instead of capturing stdout and comparing it to a static list of knows states.  This has the added benefit of us not having to externally track new states added to systemd over time.\r\n\r\nThis issue was found in puppet-nova''s CI where we found that the virtlockd and virtlogd services attempt to be enabled on every run; their "is-enabled" state is "indirect".\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7163', 'https://github.com/puppetlabs/puppet/pull/8108', '2017-02-01T20:00:07.000-0800', '2020-07-02T03:03:23.000-0700', '2020-07-02T03:03:23.000-0700', 'Resolved', 'doc_reviewed;linux;service;systemd;type_and_provider', 7, '0', 1, 87, 15, 4, '2de0e097e586d3bb96344e8c4c09952e8dc73a7d'),
('puppet', 195934, 407325833, 8110, 'User resource expiry incorrect on SLES 11', 'Setting the user resource''s expiry to `absent` in SLES 11 results in the expiry for the user to be `1970-01-01` instead of `never`. This is different from what is seen in CentOS 6/7, and results in users that are not able to authenticate. \r\n\r\n{code}\r\n# puppet resource user testuser ensure=present expiry=absent\r\nNotice: /User[testuser]/ensure: created\r\nuser { ''testuser'':\r\n  ensure => ''present'',\r\n  expiry => ''1970-01-01'',\r\n}\r\n# puppet resource user testuser ensure=present expiry=absent\r\nNotice: /User[testuser]/expiry: undefined ''expiry'' from ''1970-01-01''\r\nuser { ''testuser'':\r\n  ensure => ''present'',\r\n  expiry => ''1970-01-01'',\r\n}\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7663', 'https://github.com/puppetlabs/puppet/pull/8110', '2017-06-14T10:35:30.000-0700', '2020-07-02T03:03:43.000-0700', '2020-07-02T03:03:43.000-0700', 'Resolved', 'doc_reviewed;platform-os;sles;type_and_provider;user', 0, '0', 2, 47, 1, 3, '4e77fbf849324f967dc12644b6cecc3bd922bb16'),
('puppet', 76574, 414772031, 8141, 'The error message associated with a file resource that requires a non-existent directory is misleading.', 'When managing a file, if you specify a location that requires an intermediate directory that is missing, and not managed by puppet, the error message is misleading. It implies that the issue is with the temp file created, rather than the missing directory itself. For example, when managing /etc/eyaml/config.yaml, /etc/eyaml does not exist:\r\n\r\nCatalog:\r\n{code}\r\n  file {''/etc/eyaml/config.yaml'':\r\n    ensure => file,\r\n    content => template(''eyaml/config.yaml.erb''),\r\n  }\r\n{code}\r\n{code}\r\nError:\r\nError: Could not set ''file'' on ensure: No such file or directory - /etc/eyaml/config.yaml20150420-14321-me6waj.lock at 66:/etc/puppetlabs/puppet/environments/eyaml/dist/eyaml/manifests/init.pp\r\nError: Could not set ''file'' on ensure: No such file or directory - /etc/eyaml/config.yaml20150420-14321-me6waj.lock at 66:/etc/puppetlabs/puppet/environments/eyaml/dist/eyaml/manifests/init.pp\r\nWrapped exception:\r\nNo such file or directory - /etc/eyaml/config.yaml20150420-14321-me6waj.lock\r\nError: /Stage[main]/Eyaml/File[/etc/eyaml/config.yaml]/ensure: change from absent to file failed: Could not set ''file'' on ensure: No such file or directory - /etc/eyaml/config.yaml20150420-14321-me6waj.lock at 66:/etc/puppetlabs/puppet/environments/eyaml/dist/eyaml/manifests/init.pp\r\n{code}\r\n\r\nThe preference would be to generate an error that indicates that /etc/eyaml does not exist, or even a generic "Parent directories for $file do not exist"', 'https://tickets.puppetlabs.com/browse/PUP-4442', 'https://github.com/puppetlabs/puppet/pull/8141', '2015-04-20T15:20:23.000-0700', '2020-07-02T03:50:13.000-0700', '2020-07-02T03:50:13.000-0700', 'Resolved', 'beginner;doc_reviewed', 5, '0', 1, 15, 0, 2, '690a1f3757032f5d47376679e91f475be7f87f7a'),
('puppet', 364176, 440731930, 8205, 'HTTP 406 Not Acceptable error message should contain format names', 'If the server can''t generate a response in a mime type that the agent accepts, the server will emit an HTTP 406 Not Acceptable error, but the message includes the format objects instead of the names, leading to an unintelligible message on the agent:\r\n\r\n{noformat}\r\nWarning: Error 406 on SERVER: Not Acceptable: No supported formats are acceptable (Accept: [#<Puppet::Network::Format:0x7854686e @required_methods=[:render_method, :intern_method], @thename=:json, @confine_collection=#<Puppet::ConfineCollection:0x5c6ddb08 @confines=[], @label="Puppet::Network::Format[json]">, @charset=#<Encoding:UTF-8>, @render_multiple_method="to_multiple_json", @extension="json", @intern_multiple_method="from_multiple_json", @render_method="to_json", @weight=15, @mime="application/json", @intern_method=:from_data_hash, @options=nil>, #<Puppet::Network::Format:0x1393113d @required_methods=[:render_method, :intern_method], @thename=:pson, @confine_collection=#<Puppet::ConfineCollection:0x31d503f1 @confines=[], @label="Puppet::Network::Format[pson]">, @charset=nil, @render_multiple_method="to_multiple_pson", @extension="pson", @intern_multiple_method="from_multiple_pson", @render_method="to_pson", @weight=10, @mime="text/pson", @intern_method=:from_data_hash, @options=nil>])\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10549', 'https://github.com/puppetlabs/puppet/pull/8205', '2020-06-26T09:54:34.000-0700', '2020-07-07T03:21:44.000-0700', '2020-07-07T03:21:44.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 1, 3, 2, 2, 'bf40d7d2996fa9b506bf846cf822ef1003129431'),
('puppet', 358908, 426629247, 8184, 'Sensitive data type is lost when declaring multiple resources using title arrays', '*Puppet Version:* 6.15.0, 5.5.20\r\n*Puppet Server Version:* N/A\r\n*OS Name/Version:* N/A\r\n\r\nWhen multiple resources are declared using an array of titles, the type information for {{Sensitive}} parameters is lost. This results in type validation errors if a resource declares a data type such as {{Sensitive[String]}}\r\n\r\nInstall Puppet 6 on CentOS 7 and create a defined type with a password parameter declared to be {{Sensitive[String]}}:\r\n\r\n{code:bash}\r\nmkdir -p /etc/puppetlabs/code/environments/production/modules/test_mod/manifests\r\n\r\ncat <<''EOF'' > /etc/puppetlabs/code/environments/production/modules/test_mod/manifests/service.pp\r\ndefine test_mod::service(\r\n  Sensitive[String] $password,\r\n){\r\n  notify{"${title} ${password}": }\r\n}\r\nEOF\r\n{code}\r\n\r\nAttempt to apply the following manifest:\r\n\r\n{code:puppet}\r\ntest_mod::service { ["ServiceA","ServiceB"]:\r\n  password => Sensitive("password")\r\n}\r\n{code}\r\n\r\n*Desired Behavior:*\r\n\r\nOutput matches individual resources declared in a loop:\r\n\r\n{noformat}\r\n# puppet apply <<''EOF''\r\neach(["ServiceA","ServiceB"] ) |String $svc_name| {\r\n  test_mod::service { $svc_name:\r\n    password => Sensitive("password")\r\n  }\r\n}\r\nEOF\r\n\r\nNotice: Compiled catalog for olde-pacemaker.delivery.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: ServiceA Sensitive [value redacted]\r\nNotice: /Stage[main]/Main/Test_mod::Service[ServiceA]/Notify[ServiceA Sensitive [value redacted]]/message: defined ''message'' as ''ServiceA Sensitive [value redacted]''\r\nNotice: ServiceB Sensitive [value redacted]\r\nNotice: /Stage[main]/Main/Test_mod::Service[ServiceB]/Notify[ServiceB Sensitive [value redacted]]/message: defined ''message'' as ''ServiceB Sensitive [value redacted]''\r\nNotice: Applied catalog in 0.01 seconds\r\n{noformat}\r\n\r\n*Actual Behavior:*\r\n\r\nCompilation fails when defining the second resource as {{password}} has been coerced to a {{String}}:\r\n\r\n{noformat}\r\n# puppet apply <<''EOF''\r\ntest_mod::service { ["ServiceA","ServiceB"]:\r\n  password => Sensitive("password")\r\n}\r\nEOF\r\n\r\nError: Test_mod::Service[ServiceB]: parameter ''password'' expects a Sensitive[String] value, got String on node olde-pacemaker.delivery.puppetlabs.net\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10511', 'https://github.com/puppetlabs/puppet/pull/8184', '2020-05-14T12:03:34.000-0700', '2020-07-07T03:29:38.000-0700', '2020-07-07T03:29:38.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 1, 20, 2, 3, '9a88e12cfdb5de67457e185c68fd42a485cde61a'),
('puppet', 363206, 436073820, 8200, 'File sources whose path starts with double slashes are interpreted as a local file', 'Specifying a file source with an extra leading slash in the path causes puppet to think the source is a local file, and doesn''t provide indications that that''s what happened:\r\n\r\nCreate the following manifest on the server:\r\n{code:puppet}file { ''/tmp/doubleslash'':\r\n  ensure => file,\r\n  source => "http://www.google.com//index.html",\r\n}\r\n{code}\r\nThe agent run results in:\r\n{noformat}$ bx puppet agent -t\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for localhost\r\nInfo: Applying configuration version ''1592422524''\r\nError: /Stage[main]/Main/File[/tmp/doubleslash]: Could not evaluate: Could not retrieve information from environment production source(s) http://www.google.com//index.html\r\n{noformat}\r\nRunning with {{--http_debug}} shows that the HEAD request to google is never made.', 'https://tickets.puppetlabs.com/browse/PUP-10544', 'https://github.com/puppetlabs/puppet/pull/8200', '2020-06-17T12:13:27.000-0700', '2020-07-07T06:46:29.000-0700', '2020-07-07T06:46:29.000-0700', 'Closed', 'doc_reviewed', 2, '0', 2, 52, 34, 2, 'c78eaa4f710cd4a5f83387f500fcc4f87dbc62a7'),
('puppet', 363201, 436049250, 8199, 'Puppet agents can''t download file content from puppetserver via "raw" https', 'Trying to download a file from puppetserver using as an {{https}} source instead of {{puppet://}} will fail because puppetserver does not allow HEAD requests. This is similar to PUP-6380. For example, given:\r\n\r\n{code:puppet}\r\nfile { ''/tmp/ca.pem'':\r\n  ensure => file,\r\n  source => "https://${server_facts[''servername'']}:8140/puppet-ca/v1/certificate/ca?environment=production",\r\n}\r\n{code}\r\n\r\nThe agent will fail:\r\n\r\n{noformat}\r\n$ puppet agent -t --http_debug\r\n...\r\n<- "HEAD /puppet-ca/v1/certificate/ca?environment=production HTTP/1.1\r\nX-Puppet-Version: 6.17.0\r\nUser-Agent: Puppet/6.17.0 Ruby/2.5.7-p206 (x86_64-darwin18)\r\nAccept: */*\r\nHost: dusty-haulage.delivery.puppetlabs.net:8140\r\n\r\n"\r\n-> "HTTP/1.1 403 Forbidden\r\n"\r\n-> "Date: Wed, 17 Jun 2020 18:39:03 GMT\r\n"\r\n-> "X-Puppet-Version: 6.16.0\r\n"\r\n-> "Content-Length: 103\r\n"\r\n-> "\r\n"\r\nConn end_transport\r\nConn keep-alive\r\nError: /Stage[main]/Main/File[/tmp/puppetserver]: Could not evaluate: Could not retrieve information from environment production source(s) https://dusty-haulage.delivery.puppetlabs.net:8140/puppet-ca/v1/certificate/ca?environment=production\r\n{noformat}\r\n\r\nOne possible solution is to sniff the response header and fallback to a partial GET request as is done for PUP-6380.', 'https://tickets.puppetlabs.com/browse/PUP-10543', 'https://github.com/puppetlabs/puppet/pull/8199', '2020-06-17T11:41:30.000-0700', '2020-07-07T06:47:22.000-0700', '2020-07-07T06:47:22.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 1, 17, 23, 2, 'f591d09ad0164bc30d8c07ca069829af3b43bd15'),
('puppet', 343627, 449151253, 8224, 'Ensure Windows wide character strings have a wide terminator', 'Prior to ruby 2.1.0, it was possible for multibyte strings to have only a single null terminator, followed by garbage which could cause buffer overruns. This was fixed in https://github.com/ruby/ruby/commit/1549894a0699abdfab1fbba0e468afd3f2f990b3, but never backported to 1.9.3.\r\n\r\nWe added code to puppet to protect against this. See https://github.com/puppetlabs/puppet/commit/cabd95cbd06ac3d834e0e401bcb07c2878a0b0f2 and https://github.com/puppetlabs/puppet/commit/b7c10f5d045af5890f83159b74ab5d5a23e0abc9\r\n\r\nHowever, puppet''s {{from_string_to_wide_string}} copies the wide string from the ruby heap to the native heap using {{FFI::MemoryPointer#put_array_of_uchar}}. But it does not explicitly double null terminate the resulting wide string pointer. For example, here''s a string of character length 1 and byte length 2.\r\n\r\n{noformat}\r\nirb(main):025:0> str = "a".encode("UTF-16LE")\r\n=> "a"\r\nirb(main):026:0> str.bytes.length\r\n=> 2\r\nirb(main):027:0> str.length\r\n=> 1\r\n{noformat}\r\n\r\nWhen copying from the ruby heap to the native heap, we get a pointer to memory of length 2 bytes, which doesn''t have room for the double null:\r\n\r\n{noformat}\r\nirb(main):028:0> ptr = FFI::MemoryPointer.new(:byte, str.bytes.length)\r\n=> #<FFI::MemoryPointer address=0x0000000003aea340 size=2>\r\nirb(main):029:0> ptr.total\r\n=> 2\r\n{noformat}\r\n\r\nThis hasn''t been an issue because {{Puppet::Util::Windows::String.wide_string}} embeds a double null in the ruby string:\r\n\r\n{noformat}\r\nirb(main):030:0> str = Puppet::Util::Windows::String.wide_string("a")\r\n=> "a\u0000"\r\nirb(main):031:0> str.bytes.length\r\n=> 4\r\nirb(main):032:0> str.length\r\n=> 2\r\n{noformat}\r\n\r\nWe should always explicitly double null terminate the wide string in the native heap, so as to not rely on the ruby workaround.', 'https://tickets.puppetlabs.com/browse/PUP-10254', 'https://github.com/puppetlabs/puppet/pull/8224', '2020-01-25T14:42:23.000-0800', '2020-07-07T06:51:01.000-0700', '2020-07-07T06:51:01.000-0700', 'Closed', 'doc_reviewed', 2, '0', 1, 13, 12, 1, '94df3c1a3992d89b2d7d5db8a70373c135bdd86b'),
('puppet', 160802, 436097485, 8201, 'Add support for username:password@domain for http/https sources', 'the following code:\r\n\r\n{code}\r\nfile { ''/tmp/hello.txt'':\r\nensure => file,\r\nsource => "http://myuser:mypassword@hostwith.basic.auth.demo/hello.txt",\r\n}\r\n{code}\r\n\r\ncurrently results to:\r\n\r\n{code}\r\n2016-11-14 09:41:32 +0000 /Stage[main]/Hello/File[/tmp/hello.txt] (err): Could not evaluate: Could not retrieve information from environment production source(s) http://myuser:mypassword@hostwith.basic.auth.demo/hello.txt\r\n{code}\r\n\r\nit would be great if this was supported in the product', 'https://tickets.puppetlabs.com/browse/PUP-6916', 'https://github.com/puppetlabs/puppet/pull/8201', '2016-11-14T01:45:25.000-0800', '2020-07-07T06:58:36.000-0700', '2020-07-07T06:58:36.000-0700', 'Resolved', 'doc_reviewed;help_wanted;maintenance', 2, '0', 2, 41, 30, 6, '392353374d3585b51909dc3cd7cbd18ccc8d61d4'),
('puppet', 135135, 434808060, 8197, 'HTTP file sources fail for GET-only URIs', 'URIs that only succeed on a GET cannot currently be used as file sources, as when retrieving file metadata, we use a HEAD request. The most notable of these URI types are Amazon S3 presigned URIs. These URIs contain a signatures with the HTTP method in them, which is usually GET for downloading. This causes them to return a 403 when responding to a HEAD request. If that occurs puppet will fallback to making a partial GET request using the Range header, so that it can retrieve the file checksum and determine if the local file needs to be updated, but do so without retrieving any file content.\r\n\r\nPull request with a fix is here: https://github.com/puppetlabs/puppet/pull/5002', 'https://tickets.puppetlabs.com/browse/PUP-6380', 'https://github.com/puppetlabs/puppet/pull/8197', '2016-06-02T11:21:05.000-0700', '2020-07-07T06:59:11.000-0700', '2020-07-07T06:59:11.000-0700', 'Resolved', 'doc_reviewed', 7, '0', 5, 141, 20, 6, '896548df40f2920554a3bc239cf2dcba867ac78c'),
('puppet', 365067, 445002089, 8212, 'ConnectionAdapter encodes the path and query whereas the Connection class didn''t', 'A regression in 6.16.0 causes puppet to encode paths and queries when calling the legacy HTTP API {{Puppet::Network::HttpPool}}. To reproduce, given the following code:\r\n\r\n{code}\r\nrequire ''puppet''\r\nrequire ''puppet/network/http_pool''\r\n\r\nPuppet.initialize_settings([''--http_debug''])\r\nquery = URI.escape({ ''a'' => ''b'' }.to_json)\r\n\r\nhttp = Puppet::Network::HttpPool.http_instance(''www.google.com'', 80, false, false)\r\nhttp.get("/foo%20bar?q=#{query}")\r\n{code}\r\n\r\nIn 6.16.0 it results in:\r\n\r\n{noformat}\r\n$ bx ruby http.rb\r\nopening connection to www.google.com:80...\r\nopened\r\nConn transport_request\r\nConn begin_transport\r\n<- "GET /foo%2520bar?q=%257B%2522a%2522%3A%2522b%2522%257D HTTP/1.1\r\n{noformat}\r\n\r\nWhereas in 6.15.0:\r\n\r\n{noformat}\r\n$ bx ruby http.rb\r\nopening connection to www.google.com:80...\r\nopened\r\nConn transport_request\r\nConn begin_transport\r\n<- "GET /foo%20bar?q=%7B%22a%22:%22b%22%7D HTTP/1.1\r\n{noformat}\r\n\r\nNote the different levels of encoding on the {{GET}} request line.\r\n\r\nThis issue was introduced in PUP-10289 when switching over to the {{ConnectionAdapter}}. See https://github.com/puppetlabs/puppet/pull/8166#commitcomment-40394792\r\n\r\n/cc [~vchepkov]', 'https://tickets.puppetlabs.com/browse/PUP-10580', 'https://github.com/puppetlabs/puppet/pull/8212', '2020-07-06T13:56:05.000-0700', '2020-07-07T11:51:31.000-0700', '2020-07-07T11:51:31.000-0700', 'Resolved', '', 1, '0', 2, 74, 45, 3, '0d96de3e1464790f8aa940a4e7472bce700418d5'),
('puppet', 253150, 418090297, 8158, 'check_manage_home useradd provider needs to add -M on Debian', 'Regarding the code here:\r\n\r\n[https://github.com/puppetlabs/puppet/blob/1c77bfb8961587ddf5399cd4a70fc908cac6a6ec/lib/puppet/provider/user/useradd.rb#L127-L135]\r\n\r\nThere is an edge case that is missed. If force_local is true and manage_home is false, then "-M" should be added as a command line argument on Debian Jessie (and possibly others).\r\n\r\nIf this is not in place, a bug occurs as follows when running on Debian Jessie (and possibly others). First manually create `/home/bob` (like pam_mkhomedir might do) and then try to add `bob` with a resource like this, and it will fail:\r\n\r\n{code:puppet}\r\nuser { ''bob'':\r\n\r\n  force_local => true,\r\n\r\n  manage_home => false,\r\n\r\n  ... Other Params ...\r\n\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8897', 'https://github.com/puppetlabs/puppet/pull/8158', '2018-05-29T14:40:16.000-0700', '2020-07-08T06:08:42.000-0700', '2020-07-08T06:08:42.000-0700', 'Resolved', 'doc_reviewed;platform-os', 1, '0', 1, 34, 20, 3, '4a747eb2a6bddc5d551e9acef3bcbd7268bc1fd7'),
('puppet', 112226, 0, 0, 'Yum package provider: ensure => latest fails when RHEL channel has broken or bad duplicate errata', 'Yum can report errata as broken or bad duplicates in certain scenarios. See [yum check-update reports broken update notices |https://access.redhat.com/solutions/1502743] for an example "solution". While this is intermittent and likely an issue with the Red Hat channel, Puppet fails to ensure latest\r\n\r\n{noformat}\r\n[root@puppet-astephens puppet-enterprise-2015.3.1-el-7-x86_64]# puppet apply -e "package{''puppet-agent'': ensure => ''latest''}"\r\nNotice: Compiled catalog for puppet-astephens.dev.cmmint.net in environment production in 0.57 seconds\r\nError: Could not get latest version: undefined method `[]'' for nil:NilClass\r\nError: /Stage[main]/Main/Package[puppet-agent]/ensure: change from 1.3.2-1.el7 to latest failed: Could not get latest version: undefined method `[]'' for nil:NilClass\r\nNotice: Applied catalog in 1.34 seconds\r\n{noformat}\r\n\r\nWhich is caused by:\r\n\r\n{noformat}\r\nUpdate notice RHSA-2014:0675 (from rhel-x86_64-server-optional-7) is broken, or a bad duplicate, skipping.\r\nYou should report this problem to the owner of the rhel-x86_64-server-optional-7 repository.\r\nUpdate notice RHSA-2014:0686 (from rhel-x86_64-server-optional-7) is broken, or a bad duplicate, skipping.\r\nUpdate notice RHSA-2014:0685 (from rhel-x86_64-server-optional-7) is broken, or a bad duplicate, skipping.\r\nUpdate notice RHSA-2014:0702 (from rhel-x86_64-server-optional-7) is broken, or a bad duplicate, skipping.\r\nUpdate notice RHSA-2014:0678 (from rhel-x86_64-server-optional-7) is broken, or a bad duplicate, skipping.\r\nUpdate notice RHSA-2014:0704 (from rhel-x86_64-server-optional-7) is broken, or a bad duplicate, skipping.\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5707', 'https://github.com/puppetlabs/puppet/commit/ad438b3d7398a7f86033ad13c2a47261caaebd4c', '2016-01-13T08:02:59.000-0800', '2020-07-08T23:51:00.000-0700', '2020-07-08T23:51:00.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, 'ad438b3d7398a7f86033ad13c2a47261caaebd4c'),
('puppet', 364693, 442379639, 8208, 'Puppet cannot apply a cached catalog containing binary rich data', 'If a cached catalog contains rich data (such as {{Binary}}) then puppet will fail to load the cached catalog and fallback to loading a new catalog. This doesn''t happen with {{Sensitive}} because that data type is handled differently:\r\n\r\n{noformat}\r\nCached catalog for vernal-creator.delivery.puppetlabs.net failed: Could not parse JSON data for catalog vernal-creator.delivery.puppetlabs.net: Could not intern from rich_data_json: Internal Error: Puppet Context '':loaders'' missing\r\n{noformat}\r\n\r\nTo reproduce, create the following resource:\r\n\r\n{code:puppet}\r\nnotify { ''message'':\r\n  message => Binary.new(''aGk='')\r\n}\r\n{code}\r\n\r\nNote {{aGk=}} is base64 for {{hi}}\r\n\r\nRun the agent once to cache the catalog:\r\n\r\n{noformat}\r\n[root@vernal-creator ~]# puppet agent --no-daemonize --onetime --verbose\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for vernal-creator.delivery.puppetlabs.net\r\nInfo: Applying configuration version ''1593554072''\r\nNotice: hi\r\nNotice: /Stage[main]/Main/Notify[message]/message: defined ''message'' as ''hi''\r\nNotice: Applied catalog in 0.01 seconds\r\n{noformat}\r\n\r\nRun it again, but this time force the agent to use a cached catalog:\r\n\r\n{noformat}\r\n[root@vernal-creator ~]# puppet agent --no-daemonize --onetime --use_cached_catalog --verbose --trace\r\nError: Cached catalog for vernal-creator.delivery.puppetlabs.net failed: Could not parse JSON data for catalog vernal-creator.delivery.puppetlabs.net: Could not intern from rich_data_json: Internal Error: Puppet Context '':loaders'' missing\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loaders.rb:176:in `loaders''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loaders.rb:89:in `find_loader''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/types/types.rb:319:in `create''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:216:in `pcore_type_hash_to_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:139:in `block in initialize''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:155:in `convert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:157:in `block (3 levels) in convert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:171:in `with''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:157:in `block (2 levels) in convert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:157:in `each_pair''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:157:in `block in convert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:179:in `with_value''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:195:in `build''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:157:in `convert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/serialization/from_data_converter.rb:72:in `convert''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:55:in `initialize_from_hash''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:42:in `from_data_hash''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:437:in `block in from_data_hash''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:436:in `collect''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:436:in `from_data_hash''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/formats.rb:216:in `block in data_to_instance''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:314:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/formats.rb:214:in `data_to_instance''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/formats.rb:189:in `block in intern''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:314:in `override''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/formats.rb:188:in `intern''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/format_support.rb:12:in `convert_from''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/json.rb:11:in `from_json''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/json.rb:62:in `load_json_from_file''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/json.rb:10:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:265:in `find_in_cache''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:215:in `find''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:497:in `block in retrieve_catalog_from_cache''\r\n{noformat}\r\n\r\nSince the cached catalog fails, puppet will fallback to requesting a new catalog (though it defeats the purpose of using a cached catalog):\r\n\r\n{noformat}\r\n# continued from above\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Caching catalog for vernal-creator.delivery.puppetlabs.net\r\nInfo: Applying configuration version ''1593554078''\r\nNotice: hi\r\nNotice: /Stage[main]/Main/Notify[message]/message: defined ''message'' as ''hi''\r\nNotice: Applied catalog in 0.01 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10572', 'https://github.com/puppetlabs/puppet/pull/8208', '2020-06-30T16:52:07.000-0700', '2020-07-14T01:24:08.000-0700', '2020-07-14T01:24:08.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 2, '0', 1, 53, 14, 3, '50f377a57e2cedb809879f2492a80cabb603d7b0'),
('puppet', 228229, 161947735, 6502, 'Exceptions during transaction evaluate reported as success', 'Forked off of PUP-7630, to handle only the issue that overall success is reported when an exception is not caught inside transaction.evaluate.\r\n\r\nActually affects versions as far back as  pup 4.0.0-rc1.', 'https://tickets.puppetlabs.com/browse/PUP-8288', 'https://github.com/puppetlabs/puppet/pull/6502', '2017-12-21T15:42:35.000-0800', '2020-07-22T08:36:56.000-0700', '2020-07-22T08:36:56.000-0700', 'Closed', '', 3, '0', 1, 13, 3, 4, 'e58f47581365541db09318aff697d93397ece31c'),
('puppet', 101989, 162742611, 6521, 'Update filebucket manpage with how to manage puppetserver''s filebucket', 'It seems configuration parameter {{bucketdir}} is not used in Puppet 4. \r\n\r\n{code}\r\n# /opt/puppetlabs/bin/puppet config print bucketdir \r\n/opt/puppetlabs/puppet/cache/bucket\r\n\r\n# ls /opt/puppetlabs/puppet/cache/bucket | wc -w \r\n0\r\n{code}\r\n\r\nInstead, buckets are held here, so setting is ignored:\r\n\r\n{code}\r\n# ls /opt/puppetlabs/server/data/puppetserver/bucket/ | wc -w \r\n16\r\n{code}\r\n\r\nHow does one get location of this directory from a puppet manifest? \r\n\r\nWhat is the configuration parameter for puppet server filebucket?', 'https://tickets.puppetlabs.com/browse/PUP-5392', 'https://github.com/puppetlabs/puppet/pull/6521', '2015-10-19T05:44:27.000-0700', '2020-07-24T21:39:53.000-0700', '2020-07-24T21:39:53.000-0700', 'Closed', '', 19, '0', 2, 863, 280, 35, 'e0aeef69b85c279f74c370f8153d4e7a870f6596'),
('puppet', 352740, 397968810, 8073, 'Pip package provider outputs warning on puppet run', '*Puppet Version:* 6.14.0.135.gaf1499b7 (but may have started happening in earlier builds)\r\n*Puppet Server Version:* N/A, but using latest PE master build (rc2-37)\r\n*OS Name/Version:* centos 6, sles 12, ubuntu 18.04\r\nWhen doing a puppet agent -t run, the following warnings are printed.\r\n{code}\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:18: warning: already initialized constant PIP_VERSION\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:18: warning: previous definition of PIP_VERSION was here\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:19: warning: already initialized constant PIP_VERSION_RANGE\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/pip.rb:19: warning: previous definition of PIP_VERSION_RANGE was here\r\n{code}\r\n\r\nThis doesn''t cause any errors, but is printed on every run.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10401', 'https://github.com/puppetlabs/puppet/pull/8073', '2020-03-30T15:55:02.000-0700', '2020-07-29T09:38:22.000-0700', '2020-07-29T09:38:22.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 3, '0', 1, 0, 2, 1, '852b7eff7ecb3e05010daec0bd669c308d9c64cb'),
('puppet', 348520, 415935946, 8147, 'Puppet Agent fails to self-restart on config change or update', 'When the configuration of Puppet Agent changes, or when Puppet Agent is upgraded to a newer version, it gets completely stuck. The Puppet Agent essentially stops all operations. The following messages get logged:\r\n\r\n{noformat}\r\n$ systemctl status puppet\r\n● puppet.service - Puppet agent\r\n   Loaded: loaded (/usr/lib/systemd/system/puppet.service; enabled; vendor preset: disabled)\r\n   Active: active (running) since Tue 2020-03-03 18:46:45 CET; 19h ago\r\n Main PID: 11433 (puppet)\r\n   CGroup: /system.slice/puppet.service\r\n           └─11433 /opt/puppetlabs/puppet/bin/ruby /opt/puppetlabs/puppet/bin/puppet agent --no-daemonize\r\n\r\nMar 04 09:46:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 10:16:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 10:46:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 11:16:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 11:46:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 12:16:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 12:46:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 13:16:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 13:46:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\nMar 04 14:16:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\n{noformat}\r\n\r\nThe system log contains the following additional entries:\r\n\r\n{noformat}\r\nMar  3 18:50:35 host.example.com systemd: Reloading Puppet agent.\r\nMar  3 18:50:35 host.example.com systemd: Reloaded Puppet agent.\r\nMar  3 18:50:35 host.example.com puppet-agent[11433]: Caught HUP; storing restart\r\nMar  3 18:50:35 host.example.com puppet-agent[4047]: (/Stage[main]/Puppet::Agent::Service::Daemon/Service[puppet]) Triggered ''refresh'' from 1 event\r\nMar  3 18:50:35 host.example.com puppet-agent[4047]: (/Stage[main]/Puppet::Agent::Service::Systemd/Service[puppet-run.timer]) Triggered ''refresh'' from 1 event\r\nMar  3 18:50:35 host.example.com systemd: Reloading.\r\nMar  3 18:50:35 host.example.com puppet-agent[4047]: (/Stage[main]/Puppet::Agent::Service::Systemd/Exec[systemctl-daemon-reload-puppet]) Triggered ''refresh'' from 1 event\r\nMar  3 18:50:36 host.example.com puppet-agent[4047]: Applied catalog in 256.53 seconds\r\nMar  3 18:50:38 host.example.com puppet-agent[11433]: Processing restart\r\nMar  3 18:50:38 host.example.com puppet-agent[11433]: Puppet::Agent::Locker.running? is deprecated as it is inherently unsafe. The only safe way to know if the lock is locked is to try lock and perform some action and then handle the LockError that may result.\r\nMar  3 18:50:38 host.example.com puppet-agent[11433]:   (location: /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:37:in `running?'')\r\nMar  3 18:50:47 host.example.com puppet-agent[11433]: Config file /etc/puppetlabs/puppet/puppet.conf changed; triggering re-parse of all config files.\r\nMar  3 19:16:47 host.example.com puppet-agent[11433]: Shutdown/restart in progress (:restart_requested); skipping run\r\n{noformat}\r\n\r\nThis was also reported on the [Puppet Users list|https://groups.google.com/forum/#!msg/puppet-users/sJ51uEpB3Sc/jL_5DInGAAAJ]. Several people confirmed this issue over there. In that thread [~josh] asked to create a JIRA ticket. I couldn''t find an existing ticket.\r\n\r\nThis is a major issue, because it essentially breaks automation with Puppet. The Puppet Agent has to be manually restarted.', 'https://tickets.puppetlabs.com/browse/PUP-10351', 'https://github.com/puppetlabs/puppet/pull/8147', '2020-03-04T05:41:35.000-0800', '2020-08-10T23:39:32.000-0700', '2020-08-10T23:39:32.000-0700', 'Resolved', 'doc_reviewed', 17, '0', 1, 2, 14, 1, '3c1a4a338d158b5ea38a797f06b1202a65955803'),
('puppet', 351394, 423442977, 8175, 'URI.escape is obsolete in Ruby 2.7', 'After using puppet 5.5.10 in Ubuntu with Ruby 2.7 I got the warning below:\r\n\r\n/usr/lib/ruby/vendor_ruby/puppet/util.rb:461: warning: URI.escape is obsolete\r\n\r\n \r\n\r\nI also checked if it was fixed in the master branch but it doesn''t:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/util.rb#L463\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10391', 'https://github.com/puppetlabs/puppet/pull/8175', '2020-03-27T05:05:12.000-0700', '2020-08-11T02:11:03.000-0700', '2020-08-11T02:11:03.000-0700', 'Resolved', 'platform_7', 2, '0', 1, 47, 27, 13, '88229422dd1c2deae7763711025035f70dc00127'),
('puppet', 302978, 446562540, 8215, 'puppet 6 apply fails if puppet types have been generated', '*Puppet Version:*\r\n6.4.0\r\n*Puppetserver Version*\r\n6.3.0\r\n*OS Name/Version:*\r\nCentOS 7.5\r\n\r\nStumbled upon an unusual behavior in Puppet 6 (works as expected on Puppet 5)\r\n\r\nIf command puppet generate types has been executed, puppet apply fails.\r\nPuppet agent works normally.\r\n\r\n{noformat}\r\n[root@master ~]# puppet apply -e ''include bootstrap::master''\r\nNotice: Compiled catalog for master.localdomain in environment production in 0.81 seconds\r\nNotice: Applied catalog in 0.89 seconds\r\n\r\n[root@master ~]# puppet generate types\r\nNotice: Generating Puppet resource types.\r\nWarning: The a2mod provider is deprecated, please use apache::mod instead\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/a2mod.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/concat_file.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/concat_fragment.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/git_config.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/ini_setting.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/ini_subsetting.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/postgresql_conf.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/postgresql_conn_validator.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/postgresql_psql.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/postgresql_replication_slot.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/puppetdb_conn_validator.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/anchor.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/file_line.pp'' using ''pcore'' format.\r\nNotice: Generating ''/etc/puppetlabs/code/environments/production/.resource_types/vcsrepo.pp'' using ''pcore'' format.\r\n\r\n[root@master ~]# puppet apply -e ''include bootstrap::master''\r\nNotice: Compiled catalog for master.localdomain in environment production in 0.75 seconds\r\nError: Could not autoload puppet/type/anchor: Attempt to redefine entity ''http://puppet.com/2016.1/runtime/type/anchor''. Set at unknown location\r\nError: Could not autoload puppet/type/anchor: Attempt to redefine entity ''http://puppet.com/2016.1/runtime/type/anchor''. Set at unknown location\r\n\r\n{noformat}\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-9602', 'https://github.com/puppetlabs/puppet/pull/8215', '2019-04-03T05:33:26.000-0700', '2020-08-13T06:48:43.000-0700', '2020-08-13T06:48:43.000-0700', 'Resolved', 'doc_reviewed', 37, '0', 7, 186, 80, 8, '6f773d2ee476bc1531f3b8213e2b8c0d0f60fe1b'),
('puppet', 368742, 465728969, 8268, 'Add facts and vars back to PAL ScriptCompiler scope', '*Puppet Version: 6.15.0 - 6.17.0*\r\n\r\nAs part of work on Bolt, PUP-10397 removed vars and facts for the current node from PAL''s script compiler. This resulted in a breaking change to a public API, affecting downstream projects that rely on PAL. The script compiler should make the current node''s vars and facts available again.\r\n\r\n*Desired Behavior:*\r\n\r\n**PAL''s script compiler should have access to vars and facts for the node running the script.\r\n\r\n*Actual Behavior:*\r\n\r\nPAL''s script compiler does not have access to the vars and facts for the node running the script, causing project''s that rely on the PAL API to lose access to this data.', 'https://tickets.puppetlabs.com/browse/PUP-10615', 'https://github.com/puppetlabs/puppet/pull/8268', '2020-08-10T13:57:15.000-0700', '2020-08-20T01:56:12.000-0700', '2020-08-20T01:56:12.000-0700', 'Resolved', 'docs-reviewed', 0, '0', 1, 67, 3, 2, 'efb86030552af31a579eb553f25883a91c79a6d4'),
('puppet', 35962, 447801799, 8218, 'An error is logged during an agent run if the puppetmaster does not have at least one <module>/lib dir in its modules directory.', 'To reproduce:\r\n\r\n(Make sure you have a ''127.0.0.1       localhost puppetmaster'' entry in /etc/hosts for the below)\r\n\r\nIn one terminal setup the master:\r\n\r\n{noformat}\r\n    jpartlow@percival:~/work/puppet$ rm -rf ~/test/master/bug-test\r\n    jpartlow@percival:~/work/puppet$ mkdir -p ~/test/master/bug-test\r\n    jpartlow@percival:~/work/puppet$ bundle exec puppet master --no-daemonize --trace --autosign=true --debug --confdir=~/test/master/bug-test --vardir=~/test/master/bug-test --certname puppetmaster\r\n{noformat}\r\n\r\nIn another terminal, run the agent:\r\n\r\n{noformat}\r\n    jpartlow@percival:~/work/puppet$ be puppet agent -t --server puppetmaster\r\n    Info: Creating a new SSL key for percival.corp.puppetlabs.net\r\n    Info: Caching certificate for ca\r\n    Info: Creating a new SSL certificate request for percival.corp.puppetlabs.net\r\n    Info: Certificate Request fingerprint (SHA256): 20:18:5A:F0:3B:A0:BE:76:6B:03:71:ED:BD:EF:47:04:F1:49:3F:BD:63:AC:42:3D:7E:0F:66:3F:08:F9:70:C9\r\n    Info: Caching certificate for percival.corp.puppetlabs.net\r\n    Info: Caching certificate_revocation_list for ca\r\n    Info: Retrieving plugin\r\n    Error: /File[/home/jpartlow/.puppet/var/lib]: Could not evaluate: Could not retrieve information from environment production source(s) puppet://puppetmaster/plugins\r\n    Info: Caching catalog for percival.corp.puppetlabs.net\r\n    Info: Applying configuration version ''1374537817''\r\n    Info: Creating state file /home/jpartlow/.puppet/var/state/state.yaml\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-2608', 'https://github.com/puppetlabs/puppet/pull/8218', '2014-05-16T15:33:27.000-0700', '2020-08-20T02:06:45.000-0700', '2020-08-20T02:06:45.000-0700', 'Resolved', 'doc_reviewed;redmine', 6, '0', 1, 9, 12, 6, 'dc0aad9f3b4f7977f740ba5942efd620f7bc6bd2'),
('puppet', 366012, 449261769, 8225, 'Puppet::Util::Yaml safe_load not loading "Time" class which leads to compilation error for time serial data', '*Puppet Version: 6.16.0*\r\n\r\n*Puppet Server Version: PE 2019.8*\r\n *OS Name/Version: RHEL*\r\n\r\nCustomer is using `audit -> mtime` in a file resource. When the time is saved into transactionstore.yaml. The next puppet agent run will fail with the following error:\r\n{code:java}\r\nError: Transaction store file /opt/puppetlabs/puppet/cache/state/transactionstore.yaml is corrupt ((/opt/puppetlabs/puppet/cache/state/transactionstore.yaml): Tried to load unspecified class: Time); replacing\r\nWrapped exception:\r\nTried to load unspecified class: Time {code}\r\nThis should be because Puppet::Util::Yaml is using safe_load now and by default "Time" class is not permitted to load.\r\n\r\n*Desired Behavior:* Understand that there should be some security concerns to contain only few classes by default. The Puppet::Util::Yaml has a parameter called ''allowed_classes''. Thus, an option to configure ''allowed_classes'' from Puppet (for example) Hiera is expected. Otherwise, as long as there are needs such as auditing time from this case, the Classes out of the list will trigger the same error message.\r\n\r\n*Actual Behavior:* \r\n\r\nError: Transaction store file /opt/puppetlabs/puppet/cache/state/transactionstore.yaml is corrupt ((/opt/puppetlabs/puppet/cache/state/transactionstore.yaml): Tried to load unspecified class: Time); replacing\r\nWrapped exception:\r\nTried to load unspecified class: Time\r\n\r\n*How to Reproduce:*\r\n\r\nDefine a file resource in manifest:\r\n{code:java}\r\nfile { $file_path :\r\naudit => mtime,\r\n} {code}\r\n(1) Touch the file.\r\n\r\n(2) edited the file once. \r\n\r\n(3) Run puppet agent -t, can see successful logging the time.\r\n{code:java}\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201980-agent.platform9.puppet.net\r\nInfo: Applying configuration version ''pe-201980-master-production-6e5f8c73c43''\r\nNotice: /Stage[main]/Ggtest::Selva/File[/tmp/text.abc]/mtime: audit change: previously recorded value ''2020-07-15 03:11:23 +0000'' has been changed to ''2020-07-15 03:43:48 +0000''\r\nNotice: Applied catalog in 0.12 seconds\r\n[root@pe-201980-agent ~]# {code}\r\nMeanwhile, the content of /opt/puppetlabs/puppet/cache/state/transactionstore.yaml managed to store that data.\r\n{code:java}\r\n---\r\nresources:\r\n  File[/tmp/text.abc]:\r\n    parameters:\r\n      mtime:\r\n        system_value:\r\n        - 2020-07-15 03:43:48.772919060 +00:00\r\n      ensure:\r\n        system_value: {code}\r\n(4) run puppet agent once more with the following error of unable to load Time class:\r\n{code:java}\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201980-agent.platform9.puppet.net\r\nError: Transaction store file /opt/puppetlabs/puppet/cache/state/transactionstore.yaml is corrupt ((/opt/puppetlabs/puppet/cache/state/transactionstore.yaml): Tried to load unspecified class: Time); replacing\r\nWrapped exception:\r\nTried to load unspecified class: Time\r\nInfo: Applying configuration version ''pe-201980-master-production-6e5f8c73c43''\r\nNotice: Applied catalog in 0.07 seconds\r\n[root@pe-201980-agent ~]# {code}\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10585', 'https://github.com/puppetlabs/puppet/pull/8225', '2020-07-14T20:46:35.000-0700', '2020-08-20T10:12:42.000-0700', '2020-08-20T10:12:42.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 7, '0', 1, 16, 1, 2, 'ce082b7c4953db57cee65361ed368f2e31abe113'),
('puppet', 366100, 449151253, 8224, 'Regression: Puppet::Util.default_env method removed in 5.5.21 and 6.17.0', 'Commit https://github.com/puppetlabs/puppet/commit/94df3c1a3992d89b2d7d5db8a70373c135bdd86b unintentionally removed the {{Puppet::Util.default_env}} method in 5.5.21 and 6.17.0, causing the following error when testing puppet modules using rspec-puppet:\r\n\r\n{noformat}\r\n Failure/Error: require ''puppetlabs_spec_helper/module_spec_helper''\r\n NameError:\r\n   undefined local variable or method `default_env'' for Puppet::Util:Module\r\n # ./vendor/bundle/ruby/2.5.0/gems/rspec-puppet-2.7.8/lib/rspec-puppet/monkey_patches.rb:139:in `get_env''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppet-6.17.0/lib/puppet/node/environment.rb:501:in `extralibs''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppet-6.17.0/lib/puppet/node/environment.rb:76:in `initialize''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppet-6.17.0/lib/puppet/node/environment.rb:43:in `new''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppet-6.17.0/lib/puppet/node/environment.rb:43:in `create''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppet-6.17.0/lib/puppet.rb:240:in `base_context''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppet-6.17.0/lib/puppet/test/test_helper.rb:53:in `initialize''\r\n # ./vendor/bundle/ruby/2.5.0/gems/rspec-puppet-2.7.8/lib/rspec-puppet.rb:77:in `block in <top (required)>''\r\n # ./vendor/bundle/ruby/2.5.0/gems/rspec-puppet-2.7.8/lib/rspec-puppet.rb:34:in `<top (required)>''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppetlabs_spec_helper-2.15.0/lib/puppetlabs_spec_helper/module_spec_helper.rb:1:in `require''\r\n # ./vendor/bundle/ruby/2.5.0/gems/puppetlabs_spec_helper-2.15.0/lib/puppetlabs_spec_helper/module_spec_helper.rb:1:in `<top (required)>''\r\n # ./spec/spec_helper.rb:7:in `require''\r\n # ./spec/spec_helper.rb:7:in `<top (required)>''\r\n{noformat}\r\n\r\nSee also https://github.com/rodjek/rspec-puppet/issues/796.\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10586', 'https://github.com/puppetlabs/puppet/pull/8224', '2020-07-15T10:15:28.000-0700', '2020-08-20T11:00:21.000-0700', '2020-08-20T11:00:21.000-0700', 'Resolved', 'doc_reviewed', 6, '0', 1, 13, 12, 1, '15baa1cc39d32c1a14d8854c66dc9d3fec7f0511'),
('puppet', 367500, 464889737, 8260, 'File Resource HTTP GET - Misuse of URL encoding', '*Puppet Version: 6.16.0*\r\n *Puppet Server Version: 6.*\r\n *OS Name/Version: Win10x64 WinServer2012R2*\r\n\r\nAfter upgrading from agent 6.13.0 URL''s that are pre-encoded are being re-encoded during the HTTP GET phase of file resource execution. The header HEAD phase is working as expected. This was not occurring in agent 6.13.0 but occurs in 6.16 and 6.15 versions of the agent\r\n\r\nWhen attempting to remove the encoding the HTTP HEAD uses the correct url unencoded, but when the GET goes to encode, it for some reason drops the trailing ''='' (in fact no ''='' are encoded at all) which is found in all Azure SAS tokens and storage keys.\r\n\r\nWe store sensitive files in Azure private blob containers, and utilize a SAS token who''s sensitive data is looked up via a hiera eyaml and appended to the https:// endpoint of the url as the file "source" parameter\r\n\r\n*Desired Behavior:*\r\n\r\nIf already encoded the file resource should not re-encode during the GET phase\r\n\r\nIf not encoded, the GET phase should encode the request but not drop the trailing ''=''.\r\n\r\n*Actual Behavior:*\r\n\r\nDummy file resource being run in debug when specifying with the encoded section of the SAS token appended to the http request:\r\n{code:java}\r\nDebug: Using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384\r\nDebug: HTTP HEAD https://anystorageaccount.blob.core.windows.net/puppet/test/test.txt?sv=2019-02-02&st=2020-07-28T20%3A18%3A53Z&se=2020-07-28T20%3A38%3A00Z&sr=b&sp=r&sig=xkd9E0xReTZ18zc1Woa1rQmhAwcaYYJRHZcac5yczQ8%3D returned 200 OK\r\nDebug: Caching connection for https://anystorageaccount.blob.core.windows.net:443\r\nDebug: Using cached connection for https://anystorageaccount.blob.core.windows.net:443\r\nDebug: HTTP GET https://anystorageaccount.blob.core.windows.net/puppet/test/test.txt?sv=2019-02-02&st=2020-07-28T20%253A18%253A53Z&se=2020-07-28T20%253A38%253A00Z&sr=b&sp=r&sig=xkd9E0xReTZ18zc1Woa1rQmhAwcaYYJRHZcac5yczQ8%253D returned 403 Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\r\nDebug: Closing connection for https://anystorageaccount.blob.core.windows.net:443\r\nError: Could not set ''file'' on ensure: Error 403 on SERVER: ´╗┐<?xml version="1.0" encoding="utf-8"?><Error><Code>AuthenticationFailed</Code><Message>Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\r\nRequestId:ce4f9ec1-501e-0114-7f1e-65a9cd000000\r\nTime:2020-07-28T20:34:34.9632157Z</Message><AuthenticationErrorDetail>Signature fields not well formed.\r\n{code}\r\nsame file resource, with the token portion of the string unencoded. The final ''='' of the string is stripped off during the GET\r\n{code:java}\r\nDebug: Using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384\r\nDebug: HTTP HEAD https://anystorageaccount.blob.core.windows.net/puppet/test/test.txt?sv=2019-02-02&st=2020-07-28T20:18:53Z&se=2020-07-28T21:03:00Z&sr=b&sp=r&sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c= returned 200 OK\r\nDebug: Caching connection for https://anystorageaccount.blob.core.windows.net:443\r\nDebug: Using cached connection for https://anystorageaccount.blob.core.windows.net:443\r\nDebug: HTTP GET https://anystorageaccount.blob.core.windows.net/puppet/test/test.txt?sv=2019-02-02&st=2020-07-28T20%3A18%3A53Z&se=2020-07-28T21%3A03%3A00Z&sr=b&sp=r&sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c returned 403 Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\r\nDebug: Closing connection for https://anystorageaccount.blob.core.windows.net:443\r\nError: Could not set ''file'' on ensure: Error 403 on SERVER: ´╗┐<?xml version="1.0" encoding="utf-8"?><Error><Code>AuthenticationFailed</Code><Message>Server failed to authenticate the request. Make sure the value of Authorization header is formed correctly including the signature.\r\nRequestId:1a6c4010-101e-003e-7920-659add000000\r\nTime:2020-07-28T20:46:22.0326377Z</Message><AuthenticationErrorDetail>Signature fields not well formed.\r\n{code}\r\nWe noticed that puppet 6.15.0 introduced many changes to the file http resource according to the documentation.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10603', 'https://github.com/puppetlabs/puppet/pull/8260', '2020-07-28T13:53:31.000-0700', '2020-08-24T09:46:52.000-0700', '2020-08-24T09:46:52.000-0700', 'Resolved', 'docs-reviewed', 10, '0', 1, 48, 2, 3, 'e7887d6db253e0bb1c39b4a8d6a2d8e531a0e948'),
('puppet', 367445, 463840362, 8252, 'Puppet_Agent : Constant Corrective Change for sles 12', '_Basic Info_\r\n *Module Version:4.0.0*\r\n *Puppet Version:2019.8.0*\r\n *OS Name/Version:SLES 12*\r\n\r\n_When using the puppet_agent modules package_version to auto_ \r\n\r\n*Desired Behavior: Once correct version is installed, should not see any corrective changes.*\r\n\r\n*Actual Behavior: Seeing corrective change every puppet run*\r\n{code:java}"Notice: /Stage[main]/Puppet_agent::Install/Package[puppet-agent]/ensure: ensure changed ''6.16.0-1.sles12'' to ''6.16.0'' (corrective)"\r\n{code}\r\nAlso tested against centos and it did not have this issue, seems specific to sles.\r\n\r\nThis was also tested on PE 2019.5.0 with puppet_agent v4.0.0 without this issue.', 'https://tickets.puppetlabs.com/browse/PUP-10609', 'https://github.com/puppetlabs/puppet/pull/8252', '2020-07-28T06:58:37.000-0700', '2020-08-27T05:11:47.000-0700', '2020-08-27T05:11:47.000-0700', 'Resolved', 'docs_reviewed;jira_escalated', 1, '0', 1, 17, 0, 2, 'c66a1ae962d5735df079aaf70a2371cd4cb68c5e'),
('puppet', 145220, 82002932, 5221, 'The environment cache erroneously binds topscope and compilation gets values from "first compilation after restart"', 'There''s a fairly detailed reproducible test case with more details [here|https://github.com/thrnio/function-cache-bug].\r\n\r\nIn short, the resultant value of a function defined in the Puppet language which does not reference any Ruby code will be cached when {{environment_timeout}} is set to {{unlimited}}. This cache is generated separately based on parameters passed to the function, but it is shared between runs and between nodes. This causes a problem when the function refers to fact values, because if a fact value used by the function changed between runs or between nodes, the result of the function may not be accurate.\r\n\r\nThis behavior does not occur if the function calls a Ruby function. It also does not occur if {{environment_timeout}} is set to {{0}}.\r\n\r\nIf the expected use of functions defined in the Puppet language is to only ever reference data that is passed in directly via variables, then the scoping should reflect that by not making any top-scope variables available within a function, although this would make functions different than every other construct in Puppet, so I don''t think that would be a good resolution. Better is to stop this result caching behavior from occurring.\r\n\r\nThis occurs at least in Puppet Server 2.4.0 on CentOS 7, both FOSS and PE builds. I have not tested this in other versions or under other conditions.', 'https://tickets.puppetlabs.com/browse/PUP-6582', 'https://github.com/puppetlabs/puppet/pull/5221', '2016-08-04T11:56:42.000-0700', '2020-09-04T12:16:38.000-0700', '2020-09-04T12:16:38.000-0700', 'Closed', '', 21, '0', 3, 55, 1, 5, 'c6da73058b0c958ee0fd6213ee0e37acacb9ab08'),
('puppet', 27200, 449707662, 8226, 'Puppet run continues despite failed Pluginsync', 'A puppet run that has enough custom types/providers/facts to sync to a local system that it exceeds configtimeout (default 2m), should not continue to perform a puppet run, but rather completely fail. This would be the only way to meet the expectation that pluginsync ensures certain types/providers/facts are available before a module''s code runs.\r\n\r\nIf a puppetrun can continue despite failing to download plugins or custom facts, the proper operation of puppet modules cannot be guaranteed (without sanity checks in the puppet code). Also, it becomes impossible to base a Hiera hierarchy off of a custom fact because the first run would fail to pull in the expected Hiera data.', 'https://tickets.puppetlabs.com/browse/PUP-1763', 'https://github.com/puppetlabs/puppet/pull/8226', '2014-02-24T20:54:47.000-0800', '2020-09-15T02:13:53.000-0700', '2020-09-15T02:13:53.000-0700', 'Resolved', 'doc_reviewed', 5, '0', 5, 111, 63, 6, 'a9e4f61189f3b8d77af02b0ac2eda75fad2433a8'),
('puppet', 25794, 121770446, 5895, 'put warn/error for attempt to instantiate virtual class under --strict control', 'Declaring a virtual class should not instantiate it without being realized.  This worked in puppet 2.6.1 but is broken in 2.6.7.  I also tried it in 2.7.9 and it still seems to be broken.  The code below is a very simple example.  vclass and the notify should not happen because it is not realized.\r\n\r\n{code}\r\nclass vclass {\r\n    notify {"vclass":\r\n        message => "I''ve been realized"\r\n    }\r\n}\r\n\r\nclass iclass {\r\n    @class {"vclass": }\r\n}\r\n\r\nclass {"iclass":}\r\n{code}\r\n\r\nPuppet 2.7.9 output:\r\n{code}\r\npuppet apply --debug iclass.pp\r\ndebug: importing ''/root/iclass.pp'' in environment production\r\ndebug: Creating default schedules\r\ndebug: Failed to load library ''selinux'' for feature ''selinux''\r\ndebug: Failed to load library ''shadow'' for feature ''libshadow''\r\ndebug: Puppet::Type::User::ProviderDirectoryservice: file /usr/bin/dscl does not exist\r\ndebug: Puppet::Type::User::ProviderUser_role_add: file roleadd does not exist\r\ndebug: Failed to load library ''ldap'' for feature ''ldap''\r\ndebug: Puppet::Type::User::ProviderLdap: feature ldap is missing\r\ndebug: Puppet::Type::User::ProviderPw: file pw does not exist\r\ndebug: /File[/etc/puppet/ssl/public_keys]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/etc/puppet/ssl/certificate_requests]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/var/lib/puppet/state/state.yaml]: Autorequiring File[/var/lib/puppet/state]\r\ndebug: /File[/var/lib/puppet/clientbucket]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/var/lib/puppet/state/last_run_report.yaml]: Autorequiring File[/var/lib/puppet/state]\r\ndebug: /File[/var/lib/puppet/run]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/etc/puppet/ssl/private_keys]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/var/lib/puppet/state/graphs]: Autorequiring File[/var/lib/puppet/state]\r\ndebug: /File[/var/lib/puppet/client_data]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/var/lib/puppet/log]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/etc/puppet/ssl]: Autorequiring File[/etc/puppet]\r\ndebug: /File[/etc/puppet/ssl/private]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: /File[/var/lib/puppet/lib]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/var/lib/puppet/facts]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/var/lib/puppet/state]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/var/lib/puppet/state/last_run_summary.yaml]: Autorequiring File[/var/lib/puppet/state]\r\ndebug: /File[/var/lib/puppet/client_yaml]: Autorequiring File[/var/lib/puppet]\r\ndebug: /File[/etc/puppet/ssl/certs]: Autorequiring File[/etc/puppet/ssl]\r\ndebug: Finishing transaction 23948234472800\r\ndebug: Loaded state in 0.00 seconds\r\ndebug: Loaded state in 0.00 seconds\r\ninfo: Applying configuration version ''1327691293''\r\ndebug: /Schedule[daily]: Skipping device resources because running on a host\r\ndebug: /Schedule[monthly]: Skipping device resources because running on a host\r\nnotice: I''ve been realized\r\nnotice: /Notify[vclass]/message: defined ''message'' as ''I''ve been realized''\r\ndebug: /Schedule[hourly]: Skipping device resources because running on a host\r\ndebug: /Schedule[never]: Skipping device resources because running on a host\r\ndebug: /Schedule[weekly]: Skipping device resources because running on a host\r\ndebug: /Schedule[puppet]: Skipping device resources because running on a host\r\ndebug: Finishing transaction 23948233321400\r\ndebug: Storing state\r\ndebug: Stored state in 0.00 seconds\r\nnotice: Finished catalog run in 0.03 seconds\r\ndebug: Finishing transaction 23948233059620\r\n{code}\r\n\r\nPuppet 2.6.1:\r\n{code}\r\npuppet apply --debug iclass.pp\r\ndebug: Creating default schedules\r\ndebug: Failed to load library ''selinux'' for feature ''selinux''\r\ndebug: Puppet::Type::File::ProviderMicrosoft_windows: feature microsoft_windows is missing\r\ndebug: Failed to load library ''ldap'' for feature ''ldap''\r\ndebug: /File[/home/keibaker/.puppet/ssl/private_keys]: Autorequiring File[/home/keibaker/.puppet/ssl]\r\ndebug: /File[/home/keibaker/.puppet/ssl/public_keys]: Autorequiring File[/home/keibaker/.puppet/ssl]\r\ndebug: /File[/home/keibaker/.puppet/ssl]: Autorequiring File[/home/keibaker/.puppet]\r\ndebug: /File[/home/keibaker/.puppet/var/log]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/var]: Autorequiring File[/home/keibaker/.puppet]\r\ndebug: /File[/home/keibaker/.puppet/var/state/graphs]: Autorequiring File[/home/keibaker/.puppet/var/state]\r\ndebug: /File[/home/keibaker/.puppet/ssl/certificate_requests]: Autorequiring File[/home/keibaker/.puppet/ssl]\r\ndebug: /File[/home/keibaker/.puppet/var/clientbucket]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/var/client_data]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/var/client_yaml]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/var/facts]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/var/lib]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/var/run]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: /File[/home/keibaker/.puppet/ssl/certs]: Autorequiring File[/home/keibaker/.puppet/ssl]\r\ndebug: /File[/home/keibaker/.puppet/var/state/state.yaml]: Autorequiring File[/home/keibaker/.puppet/var/state]\r\ndebug: /File[/home/keibaker/.puppet/ssl/private]: Autorequiring File[/home/keibaker/.puppet/ssl]\r\ndebug: /File[/home/keibaker/.puppet/var/state]: Autorequiring File[/home/keibaker/.puppet/var]\r\ndebug: Finishing transaction 70277340166120\r\ndebug: Loaded state in 0.02 seconds\r\ninfo: Applying configuration version ''1327691483''\r\ndebug: Finishing transaction 70277340695320\r\ndebug: Storing state\r\ndebug: Stored state in 0.01 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1606', 'https://github.com/puppetlabs/puppet/pull/5895', '2014-02-06T18:38:01.000-0800', '2020-09-15T15:24:49.000-0700', '2020-09-15T15:24:49.000-0700', 'Closed', 'redmine', 13, '0', 5, 134, 6, 8, 'f0f32874805ed584101483771ffc21bb24d166aa'),
('puppet', 117270, 204945415, 6956, 'Deprecate source_permissions', 'We are steering people away from {{source_permissions}} for two reasons:\r\n# it doesn''t make sense for environments (including PE) that use git for the backend (user/group aren''t managed by git)\r\n# -it is not fully supported/supportable by static_catalogs- no longer true, it will now be fully supported in static_catalogs\r\n\r\nIt is still used by pluginsync for external facts however, and we will need to find a replacement mechanism for that, see linked PUP-5920.', 'https://tickets.puppetlabs.com/browse/PUP-5921', 'https://github.com/puppetlabs/puppet/pull/6956', '2016-02-17T17:16:43.000-0800', '2020-09-23T06:27:31.000-0700', '2020-09-23T06:27:31.000-0700', 'Closed', 'docs_reviewed', 16, '0', 1, 39, 5, 4, 'be91caa1e194020e9d457bda40dfa394bb3510a1'),
('puppet', 150707, 84437817, 5262, 'Timespan sometimes parses fractions incorrectly.', 'The following code, when applied, \r\n{code:puppet} \r\nnotice(strftime(Timespan(''02:03.4'', ''%M:%S.%L''), ''%M:%S.%L'')) \r\n{code} \r\nincorrectly notices \r\n{code} \r\n02:03.004 \r\n{code} \r\nThe reason is that the ''4'' is parsed by the ''%L'' format descriptor, and hence considered to be milliseconds. While this is correct in some sense, it''s not very intuitive. Puppet should instead do what Ruby''s DateTime#strptime does and treat %L and %N as values to the right of a decimal point, i.e. a "4" is intepreted as "0.4", which means 400000000 nanoseconds.', 'https://tickets.puppetlabs.com/browse/PUP-6686', 'https://github.com/puppetlabs/puppet/pull/5262', '2016-09-07T04:43:58.000-0700', '2020-09-28T07:39:18.000-0700', '2020-09-28T07:39:18.000-0700', 'Closed', '', 2, '0', 3, 131, 49, 7, '0f49ae807142ad4de649a370de48553dfcdb196c'),
('puppet', 274845, 215094108, 7081, 'Remove CA related deprecation warnings', 'Puppet 5.5.6 will emit deprecation warnings for ca related settings even if the setting is never set on the CLI or in settings:\r\n\r\n{noformat}\r\n$ bx puppet agent -t\r\nWarning: Accessing ''ca'' as a setting is deprecated.\r\n   (location: /Users/josh/work/puppet/lib/puppet/settings.rb:1165:in `issue_deprecation_warning'')\r\nExiting; no certificate found and waitforcert is disabled\r\n{noformat}\r\n\r\nWe should remove these warning from the settings entirely, as they will still be available in Puppet 6.\r\n\r\nSee PUP-9027', 'https://tickets.puppetlabs.com/browse/PUP-9116', 'https://github.com/puppetlabs/puppet/pull/7081', '2018-09-07T10:24:52.000-0700', '2020-10-09T10:08:00.000-0700', '2020-10-09T10:08:00.000-0700', 'Closed', '', 1, '0', 2, 13, 46, 1, 'a84df7fb0fb6733e70585a7dff33999a06569705'),
('puppet', 371054, 484883753, 8326, 'Resource collector overrides cause Puppet Server to retain Compiler instances', 'Use of a resource collector with an override block will cause Puppet Server to retain {{Puppet::Parser::Catlog}} objects in memory after requests finish.\r\n\r\nSee SERVER-2874 for more context and PE reproduction case.\r\n\r\nh2. Reproduction Case\r\n\r\n  - Install Puppet Server on CentOS 7 along with the Java development tools:\r\n\r\n{code:bash}\r\nyum install -y http://yum.puppetlabs.com/puppet6-release-el-7.noarch.rpm\r\nyum install -y puppetserver java-devel\r\nsource /etc/profile.d/puppet-agent.sh\r\n{code}\r\n\r\n  - Install the `pupeptlabs-inifile` module and use it to enable JRuby class reification. This allows Ruby objects, like {{Puppet::Parser::Compiler}}, to be identified easily in the Java heap:\r\n\r\n{code:bash}\r\npuppet module install puppetlabs-inifile\r\n\r\npuppet apply <<''EOF''\r\nini_subsetting { ''Enable JRuby reify.classes'':\r\n  ensure            => present,\r\n  path              => ''/etc/sysconfig/puppetserver'',\r\n  section           => '''',\r\n  key_val_separator => ''='',\r\n  setting           => ''JAVA_ARGS'',\r\n  subsetting        => ''-Djruby.reify.classes'',\r\n  value             => ''=true'',\r\n}\r\nEOF\r\n{code}\r\n\r\n  - Bootstrap the CA, configure the agent, and start the {{puppetserver}} service:\r\n\r\n{code:bash}\r\npuppetserver ca setup\r\npuppet config set server $(hostname -f)\r\nsystemctl start puppetserver\r\n{code}\r\n\r\n  - Give the service a trivial catalog to compile:\r\n\r\n{code:bash}\r\ncat <<''EOF'' > /etc/puppetlabs/code/environments/production/manifests/site.pp\r\nnode default {\r\n  notify { ''test message'':\r\n    message => ''Hello, world!'',\r\n  }\r\n\r\n  Notify <| title == ''test message'' |> {\r\n    message => ''collector override'',\r\n  }\r\n}\r\nEOF\r\n{code}\r\n\r\n  - Run {{puppet}} a couple of times:\r\n\r\n{code:bash}\r\npuppet agent -t\r\npuppet agent -t\r\n{code}\r\n\r\n  - Check the number of {{Puppet::Parser::Compiler}} instances retained in Puppet Server memory:\r\n\r\n{code:bash}\r\nsudo -u puppet jmap -histo:live $(systemctl show -p MainPID puppetserver|cut -d= -f2)|fgrep ''rubyobj.Puppet.Parser.Compiler''\r\n{code}\r\n\r\nh3. Outcome\r\n\r\nAfter running the agent twice, the {{puppetserver}} service is retaining two Compiler instances in memory:\r\n\r\n{noformat}\r\n# sudo -u puppet jmap -histo:live $(systemctl show -p MainPID puppetserver|cut -d= -f2)|fgrep ''rubyobj.Puppet.Parser.Compiler''\r\n\r\n5895:             2             64  rubyobj.Puppet.Parser.Compiler\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nNo compiler instances should be retained as the compiler is discarded at the end of the request and the {{-histo:live}} flag forces a full garbage collection.', 'https://tickets.puppetlabs.com/browse/PUP-10657', 'https://github.com/puppetlabs/puppet/pull/8326', '2020-09-02T16:15:40.000-0700', '2020-10-12T06:16:58.000-0700', '2020-10-12T06:16:58.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 4, '0', 1, 3, 4, 2, 'bbe667f0a62ed88a11eaad53eedf292aa9b4691e'),
('puppet', 369684, 476652701, 8307, 'Performance regression with large hashes using lookup', '*Puppet Version: starting from 5.0.0*\r\n**\r\n\r\nAfter upgrading our Puppet installation from 4.10 to 6.x I found large catalog compile time increasing (over 300 seconds) for some nodes.\r\n\r\nProfiling shows problem with large hashes in Hiera yamls.\r\n\r\n \r\n\r\nGood case:\r\n\r\n \r\n{code:java}\r\n$ sudo yum downgrade -y http://yum.puppetlabs.com/el/6x/PC1/x86_64/puppet-agent-1.10.14-1.el6.x86_64.rpm\r\n$ puppet --version\r\n4.10.12\r\n$ time puppet lookup --hiera_config hiera.yaml hash1.hash2.hash3.key1\r\n--- value1\r\n...\r\nreal    0m2.195s\r\nuser    0m2.010s\r\nsys     0m0.181s{code}\r\nBad cases:\r\n\r\n \r\n\r\n \r\n{code:java}\r\n$ sudo yum update -y http://yum.puppetlabs.com/puppet5/el/6/x86_64/puppet-agent-5.0.0-1.el6.x86_64.rpm\r\n$ puppet --version\r\n5.0.0\r\n$ time puppet lookup --hiera_config hiera.yaml hash1.hash2.hash3.key1\r\n--- value1\r\n...\r\nreal    0m9.837s\r\nuser    0m9.623s\r\nsys     0m0.207s{code}\r\n{code:java}\r\n$ sudo yum update -y puppet-agent\r\n$ puppet --version\r\n6.17.0\r\n$ time puppet lookup --hiera_config hiera.yaml hash1.hash2.hash3.key1\r\n--- value1\r\nreal    0m9.788s\r\nuser    0m9.494s\r\nsys     0m0.296s{code}\r\nMy research ended on follow debug points:\r\n\r\n \r\n{code:java}\r\n$ patch /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb <<EOF\r\n--- data_provider.rb\r\n+++ data_provider.rb\r\n@@ -80,11 +80,14 @@\r\n   # @param data_provider [DataProvider] The data provider that produced the hash\r\n   # @return [Object] The data value\r\n   def validate_data_value(value, &block)\r\n+require ''time''\r\n+print "data_provider.rb::validate_data_value::1 ", ::Time.now.to_f, "\n"\r\n     # The DataProvider.value_type is self recursive so further recursive check of collections is needed here\r\n     unless value_is_validated? || DataProvider.value_type.instance?(value)\r\n       actual_type = Types::TypeCalculator.singleton.infer(value)\r\n       raise Types::TypeAssertionError.new("#{yield} has wrong type, expects Puppet::LookupValue, got #{actual_type}", DataProvider.value_type, actual_type)\r\n     end\r\n+print "data_provider.rb::validate_data_value::2 ", ::Time.now.to_f, "\n"\r\n     value\r\n   end\r\n end\r\nEOF{code}\r\nRun with debug timestamps on 6.17.0:\r\n{code:java}\r\n$ time puppet lookup --hiera_config hiera.yaml hash1.hash2.hash3.key1\r\ndata_provider.rb::validate_data_value::1 1597847682.16178\r\ndata_provider.rb::validate_data_value::2 1597847689.6889844\r\n--- value1\r\nreal    0m9.819s\r\nuser    0m9.557s\r\nsys     0m0.261s{code}\r\nRun with debug timestamps on 4.10.12:\r\n{code:java}\r\n$ time puppet lookup --hiera_config hiera.yaml hash1.hash2.hash3.key1\r\ndata_provider.rb::validate_data_value::1 1597847876.923722\r\ndata_provider.rb::validate_data_value::2 1597847876.9429817\r\n--- value1\r\n...\r\nreal    0m2.206s\r\nuser    0m2.050s\r\nsys     0m0.151s\r\n{code}\r\nSlowdown from 19ms to 7.5s (390 times) on 2000 items.\r\n\r\n \r\n\r\n \r\n\r\nFor 4000 items - slowndown from 38ms to 31s (800 times)\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10628', 'https://github.com/puppetlabs/puppet/pull/8307', '2020-08-19T07:55:26.000-0700', '2020-10-12T06:17:35.000-0700', '2020-10-12T06:17:35.000-0700', 'Resolved', 'doc_reviewed', 12, '0', 2, 4, 10, 3, '898804a373b77486517fa421332fc359feedb682'),
('puppet', 365792, 448896195, 8222, 'puppet_gem provider does not use vendored PKG_CONFIG_PATH when installing native extensions', 'Based on bellow issue on using /opt/puppetlabs/puppet/bin/gem, we will update puppet_gem package provider to be able to handle rugged installation with puppet: *puppet resource package rugged ensure=present provider=puppet_gem*\r\n\r\n------\r\n\r\n \r\n\r\nWhen installing R10K, if you install Rugged with the following method\r\n\r\n`/opt/puppetlabs/puppet/bin/gem install rugged`\r\n\r\nIt will build as intended, but will then cause SegV to occur on running R10K even no matter what provider you have it set to use.\r\n\r\nIf you first set your pkgconfig env with \r\n `export PKG_CONFIG_PATH=/opt/puppetlabs/puppet/lib/pkgconfig`\r\n\r\nAnd then install Rugged, it will then build and run as intended.\r\n\r\nThe Puppet Gem environment should probably handle making sure gems built use vendored components.', 'https://tickets.puppetlabs.com/browse/PUP-10584', 'https://github.com/puppetlabs/puppet/pull/8222', '2020-07-14T06:33:16.000-0700', '2020-10-13T08:25:06.000-0700', '2020-10-13T08:25:06.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 1, 13, 3, 3, '297dd4355de239099b466749340cf3e9af6d7b4d'),
('puppet', 370140, 473169474, 8296, 'hold => none not idempotent with dpkg provider', '*Puppet Version: 5.5.21/6.18.0*\r\n *Puppet Server Version: n/a*\r\n *OS Name/Version: Debian/Ubuntu (any)*\r\n\r\nWhen explicitly specifying {{hold => none}} in a manifest, puppet will always report changes. Sample resource:\r\n{code}package { ''mc'':\r\n    ensure => present,\r\n    mark   => none,\r\n}\r\n{code}\r\n*Desired Behavior:*\r\n\r\nPuppet should set mark to none and not report any subsequent changes.\r\n\r\n*Actual Behavior:*\r\n\r\nPuppet sets mark to none on each run.\r\n\r\n----------------------------\r\n\r\nSolved by the following patch:\r\n{code}--- a/lib/puppet/provider/package/dpkg.rb\r\n+++ b/lib/puppet/provider/package/dpkg.rb\r\n@@ -74,7 +74,7 @@ Puppet::Type.type(:package).provide :dpkg, :parent => Puppet::Provider::Package\r\n       elsif [''config-files'', ''half-installed'', ''unpacked'', ''half-configured''].include?(hash[:status])\r\n         hash[:ensure] = :absent\r\n       end\r\n-      hash[:mark] = :hold if hash[:desired] == ''hold''\r\n+      hash[:mark] = hash[:desired] == ''hold'' ? :hold : :none\r\n     else\r\n       Puppet.debug("Failed to match dpkg-query line #{line.inspect}")\r\n     end\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10643', 'https://github.com/puppetlabs/puppet/pull/8296', '2020-08-25T05:19:58.000-0700', '2020-10-13T08:57:19.000-0700', '2020-10-13T08:57:19.000-0700', 'Resolved', '', 0, '0', 1, 23, 8, 2, '46287c92cd80262007bcccb4785f9837dec8971b'),
('puppet', 371830, 486608949, 8328, 'if pluginsync fails puppet should apply cached catalog', 'This ticket relates to https://tickets.puppetlabs.com/browse/PUP-1763 and https://tickets.puppetlabs.com/browse/PUP-10598\r\n\r\nIn the case we have ignore_plugin_errors==false and usecacheonfailure==true, puppet should apply cached catalog when pluginsync fails', 'https://tickets.puppetlabs.com/browse/PUP-10667', 'https://github.com/puppetlabs/puppet/pull/8328', '2020-09-15T02:11:44.000-0700', '2020-10-13T08:58:02.000-0700', '2020-10-13T08:58:02.000-0700', 'Resolved', '', 3, '0', 1, 46, 1, 3, '4fb793ebc6382cc73789d8c549228e7ade6963d0'),
('puppet', 201571, 492465692, 8338, 'No useful debug output for yum/rpm provider success/failure/version information', 'When running puppet agent with the debug flag, there''s no indication as to whether a package was successfully upgraded, or what version it was upgraded to, requiring customers and support to fish for this information on the command line.\r\n\r\nExample debug output from a failed package upgrade:\r\n{code}\r\n[[0;36mDebug: Facter: resolving Xen facts.^[[0m\r\n1531 ^[[0;36mDebug: Evicting cache entry for environment ''production''^[[0m\r\n1532 ^[[0;36mDebug: Caching environment ''production'' (ttl = 0 sec)^[[0m\r\n1533 ^[[mNotice: Compiled catalog for cmh1vlatgps003d.dev2a.dswd1.com in environment production in 0.05 seconds^[[0m\r\n1534 ^[[0;36mDebug: Creating default schedules^[[0m\r\n1535 ^[[0;36mDebug: Loaded state in 0.11 seconds^[[0m\r\n1536 ^[[0;36mDebug: Loaded state in 0.08 seconds^[[0m\r\n1537 ^[[0;32mInfo: Applying configuration version ''1500483207''^[[0m\r\n1538 ^[[0;36mDebug: Prefetching yum resources for package^[[0m\r\n1539 ^[[0;36mDebug: Executing: ''/bin/rpm --version''^[[0m\r\n1540 ^[[0;36mDebug: Executing ''/bin/rpm -qa --nosignature --nodigest --qf ''%{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n''''^[[0m\r\n1541 ^[[0;36mDebug: Executing: ''/usr/bin/yum check-update''^[[0m\r\n1542 ^[[0;36mDebug: Finishing transaction 22088640^[[0m\r\n1543 ^[[0;36mDebug: Storing state^[[0m\r\n1544 ^[[0;36mDebug: Stored state in 0.12 seconds^[[0m\r\n1545 ^[[mNotice: Applied catalog in 2.38 seconds^[[0m\r\n1546 ^\r\n{code}\r\n\r\nSince we see this situation quite frequently in support, and lengthens time to resolution, and  seems trivial to add this the debug logging, I wanted to get this issue submitted and tracked, along with a recent Zendesk example.', 'https://tickets.puppetlabs.com/browse/PUP-7791', 'https://github.com/puppetlabs/puppet/pull/8338', '2017-07-20T11:10:40.000-0700', '2020-10-13T08:58:37.000-0700', '2020-10-13T08:58:37.000-0700', 'Resolved', '', 0, '0', 1, 32, 0, 2, 'e8f1c10278c7392c6dcb5a0474c6cfb6f4357157'),
('puppet', 296813, 498301125, 8359, 'Fact yaml should quote mac addresses.', 'In puppet 6 (and not in 5), `puppet facts --render-as yaml` outputs mac addresses unquoted.\r\nIf your mac address doesn''t contain any chars A-F this is a problem as other tools parsing this yaml will interpret the value as a sexagesimal (base 60) integer.\r\nhttps://yaml.org/type/int.html\r\n\r\nCached fact data in /opt/puppetlabs/server/data/puppetserver/yaml/facts is also broken.\r\nOne tool affected by this problem is the enc script that ships with Foreman.  It loads data from /opt/puppetlabs/server/data/puppetserver/yaml/facts/some_node.yaml and uploads the facts to foreman as json.  Foreman understandably doesn''t like the mac address it receives in the payload.', 'https://tickets.puppetlabs.com/browse/PUP-9505', 'https://github.com/puppetlabs/puppet/pull/8359', '2019-02-20T08:38:19.000-0800', '2020-10-21T07:16:26.000-0700', '2020-10-21T07:16:26.000-0700', 'Resolved', 'community;doc_reviewed;platform_7', 7, '0', 1, 20, 1, 2, 'dddc00246a82ae4e7bc8fe40d05ed1e6fd0f0d82'),
('puppet', 375479, 507654804, 8411, 'masterport not honoured when is configured in other section than main', 'https://tickets.puppetlabs.com/browse/PUP-10670 introduced the `serverport` alias for `masterport` and changed Puppet to use it internally instead of `masterport`.\r\n\r\nThis introduced the following change in behaviour:\r\n - when setting `masterport` in any section different than `main`(eg. agent), this is ignored and the default `serverport` value is used.\r\n\r\n - users that have `masterport` set in their configuration, in a different section than `main`(eg. agent), are also affected as Puppet will not pick up the value set for `masterport` and it will use the default `serverport` value.', 'https://tickets.puppetlabs.com/browse/PUP-10722', 'https://github.com/puppetlabs/puppet/pull/8411', '2020-10-21T02:17:37.000-0700', '2020-10-22T05:20:01.000-0700', '2020-10-22T05:20:01.000-0700', 'Closed', 'doc_reviewed', 1, '0', 1, 161, 0, 2, 'c641b04b08ceb22f1dfb094c581ac4a382f49a16'),
('puppet', 190900, 120473737, 5869, 'Handling of non-leading tildes in rpmvercmp', 'rpmvercmp handles only the leading tilde.\r\nSo, the following test fails.\r\n\r\n\r\n{code:ruby}\r\nit { expect(provider.rpmvercmp("~", "~~")).to eq(1) }\r\n{code}\r\n\r\nA tilde must sort before everything else.\r\nhttps://github.com/rpm-software-management/rpm/issues/214', 'https://tickets.puppetlabs.com/browse/PUP-7529', 'https://github.com/puppetlabs/puppet/pull/5869', '2017-05-13T22:43:40.000-0700', '2020-10-23T16:54:54.000-0700', '2020-10-23T16:54:54.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 1, 5, 0, 2, 'dfe2a1c9ef7916122c9c3914f32d7ddef659ed72'),
('puppet', 16694, 80623616, 5185, 'Extend batch processing to use more aggressive algorithm', 'The initial implementation of batch processing followed the most conservative ordering.  This extends batch processing to allow a more optimized algorithm (all items in the ready q for a given provider are batch candidates).', 'https://tickets.puppetlabs.com/browse/PUP-562', 'https://github.com/puppetlabs/puppet/pull/5185', '2013-10-14T14:32:56.000-0700', '2020-10-23T16:54:54.000-0700', '2020-10-23T16:54:54.000-0700', 'Ready for Engineering', '', 0, '0', 5, 1494, 1174, 24, '544b8d67bd89dcc9506840ba567242ef3fe2805d'),
('puppet', 20281, 240337207, 7310, 'Relationship Expression is not R-value producing - validation missing', 'The future parser / evaluator does not flag an error when a relationship expression is used where an R-value is required. e.g. \r\n{code}\r\n$a = foo -> bar\r\n{code}\r\n\r\nIt cannot be an R-value since the evaluation is delayed until the end of the compilation. The checker/validator should be updated and list RelationshipExpression as not being an R-value. \r\n\r\nThe work is a one-liner, plus some tests.', 'https://tickets.puppetlabs.com/browse/PUP-937', 'https://github.com/puppetlabs/puppet/pull/7310', '2013-12-04T18:35:48.000-0800', '2020-10-23T16:54:57.000-0700', '2020-10-23T16:54:57.000-0700', 'Ready for Engineering', '', 3, '0', 1, 188, 0, 4, 'b71de8846bf10fcc1f3a66b24254114baf71c48d'),
('puppet', 223221, 0, 0, '--render-as broken in puppet config print', 'The \--render-as option is in puppet config print''s documentation and is validated, but has no effect. {{puppet config print}} should be able to opt out of having {{\--render-as}} shown in its help in favor of showing a new option {{\--format}} to align with {{puppet facts}}. The new {{\--format}} option will need to be created.\r\n\r\nFor example, \r\n{code:bash}\r\npuppet config print --render-as json\r\n{code}\r\nruns successfully, but does not output json.\r\n\r\n{code:bash}\r\npuppet config print --render-as foo\r\n{code}\r\noutputs "Error: Could not parse application options: I don''t know how to render ''foo''"\r\n\r\nThe {{\--format}} types to support are {{json}}, {{yaml}}, and {{flat}} (the default, also the current output).', 'https://tickets.puppetlabs.com/browse/PUP-8188', 'https://github.com/puppetlabs/puppet/commit/fa5b7de333e42747a13436575f9b40678487c519', '2017-11-21T08:42:50.000-0800', '2020-10-23T16:55:13.000-0700', '2020-10-23T16:55:13.000-0700', 'Closed', '', 7, '0', 0, 0, 0, 0, 'fa5b7de333e42747a13436575f9b40678487c519'),
('puppet', 287001, 239463660, 7306, 'Ensure provider suitability is always lazily evaluated', '[Puppet::Provider::Service::Upstart|https://github.com/puppetlabs/puppet/blob/c6ee7ddcb80f2ec4be03edcafade20d1853a4aee/lib/puppet/provider/service/upstart.rb#L30-L35] had a confine added that is run when the provider is loaded.\r\n\r\n{code:ruby}\r\n  confine :true => begin\r\n    initctl(''version'', ''--quiet'')\r\n    true\r\n  rescue\r\n    false\r\n  end\r\n{code}\r\n\r\nThis causes issues with running tests under things like JRuby, and also means that it is not possible for the provider to become suitable during the course of a transaction.  Instead of using a begin/rescue/end block which will be evaluated during the provider definition, this should be something that will be evaluated only when checking if the provider is suitable.\r\n \r\n\r\nThis probably means creating a new type of [Puppet::Confine|https://github.com/puppetlabs/puppet/tree/c6ee7ddcb80f2ec4be03edcafade20d1853a4aee/lib/puppet/confine] that is capable of taking a block to be lazily evaluated as the only existing one that does any sort of "call this code later" goes through the feature machinery. We could also modify the existing {{true}} and {{false}} confines to optionally accept a block.', 'https://tickets.puppetlabs.com/browse/PUP-9336', 'https://github.com/puppetlabs/puppet/pull/7306', '2018-11-30T10:18:48.000-0800', '2020-10-23T17:01:10.000-0700', '2020-10-23T17:01:10.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 3, 84, 43, 8, '84ddb03c98a99bd8b03614ca0fda04935e214ff5'),
('puppet', 374908, 506859484, 8407, 'Fix json output of puppet facts show action', '*Puppet Version: main branch*\r\n *Puppet Server Version:*\r\n *OS Name/Version: All*\r\n\r\nBy default puppet facts show output is rendered as json. The json output is not pretty printed.\r\n\r\n*Desired Behavior:*\r\n\r\n*`"os": {*\r\n *"name": "Darwin",*\r\n *"hardware": "x86_64",*\r\n *"architecture": "x86_64",*\r\n *"family": "Darwin",*\r\n *"release": {*\r\n *"full": "18.7.0",*\r\n *"major": "18",*\r\n *"minor": "7"*\r\n *},*\r\n *"macosx": {*\r\n *"build": "18G95",*\r\n *"product": "Mac OS X",*\r\n *"version": {*\r\n *"full": "10.14.6",*\r\n *"major": "10.14",*\r\n *"minor": "6"*\r\n *}*\r\n *}}`*\r\n\r\n*Actual Behavior:*\r\n\r\n The output for os query :\r\n\r\n`\{"os":{"architecture":"x86_64","family":"Darwin","hardware":"x86_64","macosx":{"build":"18G95","product":"Mac OS X","version":{"full":"10.14.6","major":"10.14","minor":"6"}},"name":"Darwin","release":\{"full":"18.7.0","major":"18","minor":"7"}}}`', 'https://tickets.puppetlabs.com/browse/PUP-10716', 'https://github.com/puppetlabs/puppet/pull/8407', '2020-10-14T05:58:00.000-0700', '2020-10-26T01:19:09.000-0700', '2020-10-26T01:19:09.000-0700', 'Closed', 'platform_7', 2, '0', 1, 21, 2, 2, 'eafff42154eec6929f27823d30fc610fa8481885'),
('puppet', 376350, 511778815, 8425, 'Old report processors don''t work with the new puppetserver http client', 'Add the following report processor to {{lib/puppet/reports/legacy.rb}}, which is a simplified version of the {{http}} processor from puppet 5/6:\r\n\r\n{code:ruby}\r\nrequire ''puppet''\r\nrequire ''puppet/network/http_pool''\r\nrequire ''uri''\r\n\r\nPuppet::Reports.register_report(:legacy) do\r\n  def process\r\n    url = URI.parse(Puppet[:reporturl])\r\n    conn = Puppet::Network::HttpPool.http_instance(url.host, url.port, false)\r\n    response = conn.post(url.path, self.to_yaml, { "Content-Type" => "application/x-yaml" })\r\n    unless response.kind_of?(Net::HTTPSuccess)\r\n      Puppet.err ("Unable to submit report to #{Puppet[:reporturl]} [#{response.code}] #{response.msg}")\r\n    end\r\n  end\r\nend\r\n{code}\r\n\r\nMake sure puppetserver includes commit https://github.com/puppetlabs/puppetserver/commit/d6c07c9fae476cfd07502436fd397fa8ef60ac67 and the report processor is the jruby load-path.\r\n\r\nConfigure puppet.conf with:\r\n\r\n{code:ini}\r\n[server]\r\nreports = legacy\r\nreporturl = http://localhost:8000/reports\r\n{code}\r\n\r\nStart a simple http server on port 8000, like {{python -m SimpleHTTPServer}}\r\n\r\nStart puppetserver and run the agent, and the report processor will fail with:\r\n\r\n{noformat}\r\n020-10-28 11:26:04,868 ERROR [qtp470539277-446] [puppetserver] Puppet Report processor failed: undefined method `code'' for nil:NilClass\r\n/Users/josh/work/puppet/lib/puppet/reports/legacy.rb:35:in `process''\r\n/Users/josh/work/puppet/lib/puppet/indirector/report/processor.rb:37:in `block in process''\r\n/Users/josh/work/puppet/lib/puppet/indirector/report/processor.rb:54:in `block in processors''\r\norg/jruby/RubyArray.java:1809:in `each''\r\n/Users/josh/work/puppet/lib/puppet/indirector/report/processor.rb:51:in `processors''\r\n/Users/josh/work/puppet/lib/puppet/indirector/report/processor.rb:30:in `process''\r\n/Users/josh/work/puppet/lib/puppet/indirector/report/processor.rb:14:in `save''\r\n{noformat}\r\n\r\nThis is because {{Puppet::HTTP::Response#nethttp}} returns nil', 'https://tickets.puppetlabs.com/browse/PUP-10730', 'https://github.com/puppetlabs/puppet/pull/8425', '2020-10-28T11:34:08.000-0700', '2020-10-30T16:51:29.000-0700', '2020-10-30T16:51:29.000-0700', 'Resolved', 'platform_7', 2, '0', 6, 158, 87, 21, 'e0dab29d1ef4dd74c5ad6ac8d8c2207fa2ca1a3d'),
('puppet', 243380, 0, 0, 'sort_formats does not sort consistently with MRI Ruby which causes issues when find .find processes the hash to select a choice', 'get_format relies on the order that .find processes the hash to find the first entry to use. So the order of the hash which is insertion order matters.\r\n\r\nThere is a problem with {{Puppet::Pops::Type::StringConverter.sort_formats}} its passed an array which it sorts based on assignablity and rank order. This method on Ruby is not consistent in the order of the hash it ends up creating.\r\n\r\nI had it process 3 entries from in the array, in the normal order and reverse order and then printed out the values:\r\n\r\n{code: ruby}\r\n   sort_formats(merged[-6..-4])\r\n   sort_formats(merged[-6..-4].reverse) \r\n{code}\r\n\r\nThe array''s after sorting look like this. These arrays should be sorted in the same order:\r\n\r\n{noformat}\r\nformat_map:\r\nkey: Hash rank: 2\r\nkey: Array rank: 4\r\nkey: Binary rank: 0\r\n\r\nformat_map:\r\nkey: Binary rank: 0\r\nkey: Hash rank: 2\r\nkey: Array rank: 4\r\n{noformat}\r\n\r\nI think there are a couple issues with this part of the code:\r\n\r\n{code}\r\n        else\r\n          # arbitrary order if disjunct (based on name of type)\r\n          rank_a = type_rank(a)\r\n          rank_b = type_rank(b)\r\n          if rank_a == 0 || rank_b == 0\r\n            a.to_s <=> b.to_s\r\n          else\r\n            rank_a <=> rank_b\r\n          end\r\n{code}\r\n\r\nWhy do we ignore the rank if any one of the key''s has a rank of 0? \r\n\r\nDo we want a sort of this instead? where we use the rank if one of them is set and reverse the rank comparison so that high ranked items are higher?\r\nOr should we be only using the {{a.to_s <=> b.to_s}} check when the ranks match\r\n\r\n{code}\r\n          if rank_a == 0 && rank_b == 0\r\n            a.to_s <=> b.to_s\r\n          else\r\n            rank_b <=> rank_a\r\n          end\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8615', 'https://github.com/puppetlabs/puppet/commit/334ea05e4d4885f28420615039042f47f75c9f30', '2018-03-28T11:57:55.000-0700', '2020-11-03T11:42:32.000-0800', '2020-11-03T11:42:32.000-0800', 'Accepted', '', 4, '0', 0, 0, 0, 0, '334ea05e4d4885f28420615039042f47f75c9f30'),
('puppet', 185591, 463490241, 8251, 'Remove win32-service gem dependency from packaging', 'This task should be completed after PUP-7445 code changes, and involves updating any of the following if necessary:\r\n\r\n* {{Gemfile}}\r\n* {{.gemspec}}\r\n* {{project_data.yaml}}\r\n* Removing gem from {{puppet-win32-ruby}} which is used by {{ci:test:git}}\r\n* Removing gem reference from {{puppet-agent}} packaging repo', 'https://tickets.puppetlabs.com/browse/PUP-7446', 'https://github.com/puppetlabs/puppet/pull/8251', '2017-04-12T10:54:50.000-0700', '2020-11-05T00:56:28.000-0800', '2020-11-05T00:56:28.000-0800', 'Resolved', 'platform-os;platform_7', 1, '0', 1, 0, 2, 1, '321f36fac7856fdd8af82f80d236fb2603a825ea'),
('puppet', 374909, 504865293, 8399, 'When query for a specific fact with puppet facts show there are 3 additional puppet specific facts displayed', '*.Puppet Version: main branch*\r\n *Puppet Server Version:*\r\n *OS Name/Version: all*\r\n\r\nAfter resolving the requested facts, in puppet are added 3 additional local facts: "clientcert", "clientversion" and "clientnoop". `puppet facts show` action should display only the requested facts without the additional facts.\r\n\r\n*Desired Behavior:*\r\n\r\nFor ''timezone'' query (puppet facts show timezone) the output should be:\r\n\r\n{"timezone":"EEST"}\r\n\r\n*Actual Behavior:*\r\n\r\nFor ''timezone'' query (puppet facts show timezone) the output is:\r\n\r\n{"timezone":"EEST","clientcert":"macbookpro.local","clientversion":"6.14.0","clientnoop":false}\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10717', 'https://github.com/puppetlabs/puppet/pull/8399', '2020-10-14T06:11:16.000-0700', '2020-11-05T00:57:57.000-0800', '2020-11-05T00:57:57.000-0800', 'Resolved', 'platform_7', 0, '0', 1, 7, 1, 2, 'c9dfabb6a395ca96c216b52d6686678e0b0751ee'),
('puppet', 376434, 514298484, 8431, 'fresh puppet agent installation fails when msgpack is enabled on puppetserver', 'Hi!\r\n(I''m not sure if this is a bug in puppet agent or puppetserver)\r\n\r\nI''m running the latest puppetserver \r\n\r\n{code}\r\nroot ~ # puppetserver -v\r\npuppetserver version: 6.14.1\r\nroot ~ # \r\n{code}\r\n\r\nthe msgpack gem is installed:\r\n\r\n{code}\r\nroot ~ # puppetserver gem list msgpack\r\n\r\n*** LOCAL GEMS ***\r\n\r\nmsgpack (1.3.3 java)\r\nroot ~ # \r\n{code}\r\n\r\npreferred_serialization_format isn''t set on the server:\r\n\r\n{code}\r\n[main]\r\n    ca_server = *\r\n    certname = *\r\n    codedir = /etc/puppetlabs/code\r\n    environmentpath = /etc/puppetlabs/code/environments\r\n    hiera_config = $confdir/hiera.yaml\r\n    hostprivkey = $privatekeydir/$certname.pem { mode = 640 }\r\n    logdir = /var/log/puppetlabs/puppet\r\n    pluginfactsource = puppet:///pluginfacts\r\n    pluginsource = puppet:///plugins\r\n    privatekeydir = $ssldir/private_keys { group = service }\r\n    reports = puppetdb,foreman\r\n    rundir = /var/run/puppetlabs\r\n    server = *\r\n    show_diff = true\r\n    ssldir = /etc/puppetlabs/puppet/ssl\r\n    vardir = /opt/puppetlabs/puppet/cache\r\n\r\n[agent]\r\n    classfile = $statedir/classes.txt\r\n    default_schedules = false\r\n    environment = snow\r\n    localconfig = $vardir/localconfig\r\n    masterport = 8140\r\n    noop = false\r\n    report = true\r\n    runinterval = 7200\r\n    splay = true\r\n    splaylimit = 7200\r\n    usecacheonfailure = true\r\n\r\n[master]\r\n    autosign = /etc/puppetlabs/puppet/autosign.conf { mode = 0664 }\r\n    ca = true\r\n    certname = *\r\n    external_nodes = /etc/puppetlabs/puppet/node.rb\r\n    logdir = /var/log/puppetlabs/puppetserver\r\n    node_terminus = exec\r\n    parser = current\r\n    rundir = /var/run/puppetlabs/puppetserver\r\n    ssldir = /etc/puppetlabs/puppet/ssl\r\n    storeconfigs = true\r\n    strict_variables = true\r\n    trusted_external_command = /etc/puppetlabs/puppet/trusted-external-commands/*.rb\r\n    vardir = /opt/puppetlabs/server/data/puppetserver\r\n{code}\r\n\r\nWe rolled out the msgpack gem to existing agents:\r\n\r\n{code}\r\n  if fact(''aio_agent_version'') {\r\n    package { ''msgpack'':\r\n      ensure   => ''present'',\r\n      provider => ''puppet_gem'',\r\n    }\r\n  }\r\n{code}\r\n\r\nbecause I forgot to install it on the servers as well, we did that with multiple days delay:\r\n\r\n{code}\r\n    package { ''msgpack-puppetserver'':\r\n      ensure   => ''present'',\r\n      name     => ''msgpack'',\r\n      provider => ''puppetserver_gem'',\r\n      notify   => Service[''puppetserver''],\r\n    }\r\n{code}\r\n\r\nthis means by the time it got installed on the puppetservers, all existing agents already had the gem installed. those agents produce the following debug output:\r\n\r\n{code}\r\nDebug: catalog supports formats: rich_data_json json rich_data_msgpack msgpack pson yaml dot\r\n...\r\nDebug: file_metadata supports formats: json msgpack pson yaml\r\nDebug: Closing connection for https://*:8140\r\nDebug: Creating new connection for https://*:8140\r\nDebug: Starting connection for https://*:8140\r\nDebug: Using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256\r\nDebug: HTTP GET https://*:8140/puppet/v3/file_metadatas/plugins?recurse=true&ignore=.svn&ignore=CVS&ignore=.git&ignore=.hg&links=follow&checksum_type=md5&source_permissions=ignore&environment=snow returned 200 OK\r\nDebug: Caching connection for https://*:8140\r\n...\r\nDebug: file_metadata supports formats: json msgpack pson yaml\r\nDebug: Using cached connection for https://*:8140\r\nDebug: HTTP GET https://*:8140/puppet/v3/file_metadatas/locales?recurse=true&ignore=.svn&ignore=CVS&ignore=.git&ignore=.hg&ignore=%2A.pot&ignore=config.yaml&links=follow&checksum_type=md5&source_permissions=ignore&environment=snow returned 200 OK\r\nDebug: Caching connection for https://*:8140\r\nDebug: Finishing transaction 40300740\r\n{code}\r\n\r\nthats from a up2date box:\r\n{code}\r\nroot ~ # puppet --version\r\n6.19.1\r\nroot ~ # /opt/puppetlabs/puppet/bin/gem list msgpack\r\n\r\n*** LOCAL GEMS ***\r\n\r\nmsgpack (1.3.1)\r\nroot ~ # \r\n{code}\r\n\r\n\r\nnow a new setup. I installed the puppet6-el7-release rpm and afterwards puppet-agent. the config file is empty:\r\n\r\n{code}\r\nroot ~ # cat /etc/puppetlabs/puppet/puppet.conf \r\n# This file can be used to override the default puppet settings.\r\n# See the following links for more details on what settings are available:\r\n# - https://puppet.com/docs/puppet/latest/config_important_settings.html\r\n# - https://puppet.com/docs/puppet/latest/config_about_settings.html\r\n# - https://puppet.com/docs/puppet/latest/config_file_main.html\r\n# - https://puppet.com/docs/puppet/latest/configuration.html\r\nroot ~ #\r\n{code}\r\n\r\nthis nodes logs:\r\n{code}\r\nDebug: Puppet::Network::Format[msgpack]: feature msgpack is missing\r\nDebug: catalog supports formats: rich_data_json json rich_data_msgpack pson yaml dot\r\nDebug: Using cached connection for https://:8140\r\nDebug: HTTP POST https://*:8140/puppet/v3/catalog/*?environment=production returned 200 OK\r\nDebug: Caching connection for https://*:8140\r\nError: Could not retrieve catalog from remote server: Failed to deserialize Puppet::Resource::Catalog from rich_data_msgpack: uninitialized constant MessagePack\r\nWrapped exception:\r\nuninitialized constant MessagePack\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\nDebug: Resolving service ''report'' using Puppet::HTTP::Resolver::SRV\r\nDebug: Searching for SRV records for domain: *\r\nDebug: Found 0 SRV records for: _x-puppet-report._tcp.*\r\nDebug: Searching for SRV records for domain: *\r\nDebug: Using cached record for _x-puppet._tcp.*\r\nDebug: Yielding next server of *:8140\r\nDebug: Using cached connection for https://*:8140\r\nDebug: Caching connection for https://*:8140\r\nDebug: Resolved service ''report'' to https://*:8140/puppet/v3\r\nDebug: Puppet::Network::Format[msgpack]: feature msgpack is missing\r\nDebug: report supports formats: json pson yaml\r\nDebug: Using cached connection for https://*:8140\r\nDebug: HTTP PUT https://*:8140/puppet/v3/report/*?environment=production returned 200 OK\r\nDebug: Caching connection for https://*:8140\r\nDebug: Closing connection for https://*:8140\r\n{code}\r\n\r\ninstalled gems on the new agent:\r\n{code}\r\nroot ~ # /opt/puppetlabs/puppet/bin/gem list\r\n\r\n*** LOCAL GEMS ***\r\n\r\nbigdecimal (default: 1.3.4)\r\ncmath (default: 1.0.0)\r\nconcurrent-ruby (1.1.5)\r\ncsv (default: 1.0.0)\r\ndate (default: 1.0.0)\r\ndeep_merge (1.0.1)\r\ndid_you_mean (1.2.0)\r\netc (default: 1.0.0)\r\nfacter (3.14.14)\r\nfacter-ng (4.0.43)\r\nfast_gettext (1.1.2)\r\nfcntl (default: 1.0.0)\r\nffi (1.13.1)\r\nfiddle (default: 1.0.0)\r\nfileutils (default: 1.0.2)\r\ngettext (3.2.2)\r\nhiera (3.6.0)\r\nhiera-eyaml (3.2.0)\r\nhighline (1.6.21)\r\nhocon (1.3.1)\r\nhttpclient (2.8.3)\r\nio-console (default: 0.4.6)\r\nipaddr (default: 1.2.0)\r\njson (default: 2.1.0)\r\nlocale (2.1.3)\r\nminitest (5.10.3)\r\nmulti_json (1.14.1)\r\nnet-ssh (4.2.0)\r\nnet-telnet (0.1.1)\r\nopenssl (default: 2.1.2)\r\noptimist (3.0.1)\r\npower_assert (1.1.1)\r\npsych (default: 3.0.2)\r\npuppet (6.19.1)\r\npuppet-resource_api (1.8.13)\r\nrake (12.3.3)\r\nrdoc (default: 6.0.1.1)\r\nscanf (default: 1.0.0)\r\nsdbm (default: 1.0.0)\r\nsemantic_puppet (1.0.2)\r\nstringio (default: 0.0.1)\r\nstrscan (default: 1.0.0)\r\nsys-filesystem (1.3.2)\r\ntest-unit (3.2.7)\r\ntext (1.3.1)\r\nthor (1.0.1)\r\nwebrick (default: 1.4.2)\r\nxmlrpc (0.3.0)\r\nzlib (default: 1.0.0)\r\nroot ~ #\r\n{code}\r\n\r\nI got a few questions here:\r\n* my understanding of https://puppet.com/docs/puppet/6.19/experiments_msgpack.html is that msgpack is only used if preferred_serialization_format is set. That does not seem to be the case\r\n* Why isn''t there a fallback to pson/json? the agent notices that the msgpack gem isn''t installed on the agent.', 'https://tickets.puppetlabs.com/browse/PUP-10772', 'https://github.com/puppetlabs/puppet/pull/8431', '2020-10-29T03:11:21.000-0700', '2020-11-09T03:47:37.000-0800', '2020-11-09T03:47:37.000-0800', 'Resolved', 'doc_reviewed', 6, '0', 1, 52, 2, 3, 'af0080766378d7ae71622a391d7305c021ab00cd'),
('puppet', 375617, 507922908, 8413, 'Deprecate func3x_check setting', 'The {{func3x_check}} setting will be removed in puppet 7. It currently defaults to {{false}} but if set to {{true}} we should issue a deprecation warning.', 'https://tickets.puppetlabs.com/browse/PUP-10724', 'https://github.com/puppetlabs/puppet/pull/8413', '2020-10-21T16:32:35.000-0700', '2020-11-09T03:49:50.000-0800', '2020-11-09T03:49:50.000-0800', 'Resolved', 'doc_reviewed', 2, '0', 1, 23, 1, 2, 'e783aaa62e19ad3f76f2ba9891a6fba1832516ae'),
('puppet', 374990, 503725233, 8394, 'Puppet''s feature detection can leave rubygems in a bad state', 'If a gem is managed by a native package manager (rpm, etc), and it is updated during a puppet run, it is possible for rubygems to be left in a bad state causing the run to fail.\r\n\r\nThis can be reproduced using:\r\n\r\n{code:ruby}\r\nrequire ''fileutils''\r\nrequire ''rubygems''\r\nif File.exist?("/tmp/thor-1.0.1.gemspec")\r\n  FileUtils.mv("/tmp/thor-1.0.1.gemspec", "/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/specifications/thor-1.0.1.gemspec")\r\nend\r\nGem.clear_paths\r\nbegin\r\n  require ''msgpack''\r\nrescue LoadError => e\r\nend\r\nFileUtils.mv("/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/specifications/thor-1.0.1.gemspec", "/tmp/thor-1.0.1.gemspec")\r\nGem::Specification.latest_specs\r\n{code}\r\n\r\nRubygems monkey patches {{Kernel.require}} so that if the gem fails to load, it will try to activate it. This has the side effect of caching the stub specifications for all gems.\r\n\r\nIf the gemspec is then removed via rpm upgrade, then the cached stub specification will refer to a gemspec that no longer exists.\r\n\r\nIf we later try to load the full specifications (such as when autoloading a terminus), then rubygems will raise:\r\n\r\n{noformat}\r\n/opt/puppetlabs/puppet/lib/ruby/2.5.0/rubygems/specification.rb:743:in `_all'': pid: 9272 nil spec! included in [...#<Gem::StubSpecification:0x0000000001bf0bc0 @extension_dir=nil, @full_gem_path=nil, @gem_dir=nil, @ignored=nil, @loaded_from="/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/specifications/thor-1.0.1.gemspec", @data=#<Gem::StubSpecification::StubLine:0x0000000001c44810 @name="thor", @version=#<Gem::Version "1.0.1">...]\r\n{noformat}\r\n\r\nIt can also be reproduced in puppet using:\r\n\r\n{code:ruby}\r\nrequire ''fileutils''\r\nrequire ''puppet''\r\n \r\nif File.exist?("/tmp/thor-1.0.1.gemspec")\r\n  FileUtils.mv("/tmp/thor-1.0.1.gemspec", "/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/specifications/thor-1.0.1.gemspec")\r\nend\r\n \r\nPuppet.initialize_settings\r\nPuppet[:log_level] = ''debug''\r\n \r\nPuppet.features.msgpack?\r\nFileUtils.mv("/opt/puppetlabs/puppet/lib/ruby/gems/2.5.0/specifications/thor-1.0.1.gemspec", "/tmp/thor-1.0.1.gemspec")\r\nPuppet::FileBucket::File.indirection.terminus(:rest)\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10719', 'https://github.com/puppetlabs/puppet/pull/8394', '2020-10-14T13:09:44.000-0700', '2020-11-09T06:49:56.000-0800', '2020-11-09T06:49:56.000-0800', 'Resolved', 'doc_reviewed', 5, '0', 1, 7, 3, 2, 'cc691cc2fc72ffc70a4705f8a26e8ae9817bb376'),
('puppet', 370505, 503150734, 8388, 'puppet 6 agent doesn''t honor usecacheonfailure setting when using server_list', '*Puppet Version:* 6.17.0 (PE2019.8.1)\r\n *Puppet Server Version:  2019.8.0.37*\r\n *OS Name/Version: RHEL8*\r\n\r\nHad a case where /etc/resolv.conf was accidentally removed and puppet agent hasn''t recovered it for unknown reason.  usecacheonfailure is set to true\r\n\r\n \r\n\r\n \r\n\r\nEasy to reproduce, manage /etc/resolv.conf by puppet, remove the file, puppet agent will start failing and not recovering the file. The log entry :\r\n\r\n \r\n{noformat}\r\nCould not run Puppet configuration client: Could not select a functional puppet master from server_list:{noformat}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10648', 'https://github.com/puppetlabs/puppet/pull/8388', '2020-08-27T09:27:42.000-0700', '2020-11-09T08:42:30.000-0800', '2020-11-09T08:42:30.000-0800', 'Resolved', 'doc_reviewed', 4, '0', 1, 12, 15, 1, '139b5e93a2bfa82afd9c6aa1a04db5f3c6e8bd94'),
('puppet', 356948, 476189956, 8304, 'Remove Puppet::Util::Yaml.load_file', 'The load_file method is unsafe, and should be removed:\r\n\r\n{noformat}\r\n  def self.load_file(filename, default_value = false, strip_classes = false)\r\n    Puppet.deprecation_warning(_("Puppet::Util::Yaml.load_file is deprecated. Use safe_load_file instead."))\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10475', 'https://github.com/puppetlabs/puppet/pull/8304', '2020-04-27T17:12:13.000-0700', '2020-11-09T08:57:06.000-0800', '2020-11-09T08:57:06.000-0800', 'Resolved', 'doc_reviewed;platform_7', 0, '0', 1, 0, 76, 2, 'f3c90046d4cfd8b634b0e5f326cbedc48ba03ca7'),
('puppet', 347102, 390445062, 8044, 'Windows user management fails if group contains not resolvable Domain accounts', '*Puppet Version:6.11.1, 6.12, 6.13*\r\n *Puppet Server Version: 6.7.1*\r\n *OS Name/Version: Windows Server 2012 R2*\r\n\r\nUnable to manage windows users if a not resolvable SID exists in a group.  Also, the command ''puppet resource group'' fails if there is a not resolvable SID in any group on the server.  We currently run Puppet 5.5.6 and this is not an issue.  We are holding off on upgrading.  \r\n\r\n*Steps to reproduce:*\r\n # **Create a test user in Active Directory\r\n # Add the test user to the local Administrators group on a windows server\r\n # Delete the test user in Active Directory\r\n # There are two tests\r\n ## Run *puppet resource group* command\r\n ## Run *puppet apply -e "group \{''Administrators'': ensure => ''present'', members => [''Administrator''], auth_membership => false }"* \r\n\r\n*Desired Behavior:*\r\n\r\nPuppet should ignore not resolvable SIDs so we can still manage windows users locally\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\nAfter running *''puppet resource group'':*  Error: Could not run: Could not resolve name: S-1-5-21-994416979-1451695006-1560425512-1327 (unresolvable)\r\n\r\nAfter running *puppet apply -e "group \{''Administrators'': ensure => ''present'', members => [''Administrator''], auth_membership => false }":*  Error: /Stage[main]/Main/Group[Administrators]: Could not evaluate: Could not resolve name: S-1-5-21-994416979-1451695006-1560425512-1327 (unresolvable)\r\n\r\n \r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10303', 'https://github.com/puppetlabs/puppet/pull/8044', '2020-02-20T09:54:06.000-0800', '2020-11-10T00:17:21.000-0800', '2020-11-10T00:17:21.000-0800', 'Resolved', 'doc_reviewed;jira_escalated', 0, '0', 1, 61, 28, 8, 'e6a73b55c7de9ae54af0a69ece25f458f064e71c'),
('puppet', 356947, 470176520, 8281, 'Remove deprecated Puppet::Resource methods', 'Remove the following deprecated methods:\r\n\r\n{noformat}\r\nlib/puppet/resource.rb:    Puppet.deprecation_warning(_(''The method Puppet::Resource.set_default_parameters is deprecated and will be removed in the next major release of Puppet.''))\r\nlib/puppet/resource.rb:    Puppet.deprecation_warning(_(''The method Puppet::Resource.validate_complete is deprecated and will be removed in the next major release of Puppet.''))\r\nlib/puppet/resource/type.rb:    Puppet.deprecation_warning(_(''The method Puppet::Resource::Type.assign_parameter_values is deprecated and will be removed in the next major release of Puppet.''))\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10474', 'https://github.com/puppetlabs/puppet/pull/8281', '2020-04-27T17:10:40.000-0700', '2020-11-10T01:38:47.000-0800', '2020-11-10T01:38:47.000-0800', 'Resolved', 'doc_reviewed;platform_7', 0, '0', 1, 0, 134, 3, '2ddb9bbb96bdc016a4231585b8b968e35862c941'),
('puppet', 356946, 501002622, 8380, 'Remove legacy auth.conf support', 'Per https://puppet.com/docs/puppetserver/latest/deprecated_features.html#use-of-core-puppet-authconf-for-authorizing-master-service-routes\r\n\r\n"The jruby-puppet.use-legacy-auth-conf setting will be removed from Puppet Server configuration, and Puppet Server will instead always use the new trapperkeeper-authorization “auth.conf” when authorizing client requests."\r\n\r\nThis ticket is to remove the legacy authorization layer from puppet. This includes the {{rest_authconfig}} setting, the AuthConfigLoader, AuthConfigParser, DefaultAuthProvider, AuthConfig, Authorization, Rights, AuthStore, beaker and rspec tests.', 'https://tickets.puppetlabs.com/browse/PUP-10473', 'https://github.com/puppetlabs/puppet/pull/8380', '2020-04-27T17:04:55.000-0700', '2020-11-10T01:39:43.000-0800', '2020-11-10T01:39:43.000-0800', 'Resolved', 'doc_reviewed;platform_7', 4, '0', 2, 57, 12, 6, 'a87d581372a2c4103a0f6aed8434ba67925092c9'),
('puppet', 356936, 469712792, 8279, 'Remove Puppet.define_settings', 'Remove the Puppet.define_settings method', 'https://tickets.puppetlabs.com/browse/PUP-10472', 'https://github.com/puppetlabs/puppet/pull/8279', '2020-04-27T16:46:48.000-0700', '2020-11-10T01:40:23.000-0800', '2020-11-10T01:40:23.000-0800', 'Resolved', 'doc_reviewed;platform_7', 2, '0', 1, 0, 6, 1, '94ce5345da413158612e31229d7899778df730fb'),
('puppet', 356722, 479129584, 8316, 'Remove application orchestration language features', 'Remove the language features deprecated in https://tickets.puppetlabs.com/browse/PUP-9251', 'https://tickets.puppetlabs.com/browse/PUP-10446', 'https://github.com/puppetlabs/puppet/pull/8316', '2020-04-24T15:01:34.000-0700', '2020-11-10T01:41:29.000-0800', '2020-11-10T01:41:29.000-0800', 'Resolved', 'doc_reviewed;platform_7', 4, '0', 16, 1640, 5088, 48, '9e19488442589fd70ca501d6c31bd39df3c860df'),
('puppet', 356464, 467516132, 8274, 'Remove strict_hostname_checking', 'Remove the strict_hostname_checking puppet setting. It was changed to false in 6.x, otherwise a node could get a catalog it wasn''t supposed to have.\r\n\r\nRemove the node_name setting which is related to strict_hostname_checking.', 'https://tickets.puppetlabs.com/browse/PUP-10436', 'https://github.com/puppetlabs/puppet/pull/8274', '2020-04-22T21:40:16.000-0700', '2020-11-10T01:57:20.000-0800', '2020-11-10T01:57:20.000-0800', 'Resolved', 'doc_reviewed;platform_7', 3, '0', 2, 4, 129, 4, '5005bc00141dae716c321f6f3a2e28ca6bd8fe54'),
('puppet', 291460, 471308613, 8290, 'Remove future_features logic', 'Make sure any functionality controlled by the {{future_features}} flag has been removed/updated for Puppet 7', 'https://tickets.puppetlabs.com/browse/PUP-9426', 'https://github.com/puppetlabs/puppet/pull/8290', '2019-01-10T14:47:58.000-0800', '2020-11-10T02:02:22.000-0800', '2020-11-10T02:02:22.000-0800', 'Resolved', 'doc_reviewed;platform_7', 3, '0', 3, 46, 93, 3, '75982560e7d15af064d158dd5c64618dbcd94093'),
('puppet', 291105, 464912326, 8263, 'Don''t backup to the local filebucket by default', 'Puppet agent''s will backup any overwritten or deleted file to its local filebucket via the default {{backup}} parameter for the file type. It defaults to {{puppet}} which means to use the filebucket named {{puppet}} which is automatically created.\r\n\r\nMany users run into trouble because the filebucket will grow unbounded, such as PUP-1137. It has been proposed to use the {{tidy}} resource to clean up stale files, but can lead to memory issues with large numbers of {{file}} resources being created. See https://github.com/npwalker/pe_metric_curl_cron_jobs/issues/3\r\n\r\nFor this ticket we should change the default value of the {{bucket}} parameter from {{puppet}} to {{false}}, see https://github.com/puppetlabs/puppet/blob/6.1.0/lib/puppet/type/file.rb#L110, and update the {{file}} reference documentation to reflect the new behavior.', 'https://tickets.puppetlabs.com/browse/PUP-9407', 'https://github.com/puppetlabs/puppet/pull/8263', '2019-01-09T15:03:00.000-0800', '2020-11-10T02:03:11.000-0800', '2020-11-10T02:03:11.000-0800', 'Resolved', 'doc_reviewed;platform_7', 5, '0', 1, 19, 18, 6, '8e9657f998adfbc6989ffbc44f8ed8823d1e4fed'),
('puppet', 287916, 464919978, 8264, 'Change default value of hostcsr setting', 'The {{hostcsr}} setting seems valid as it''s similar to {{hostcert}}, {{hostcrl}}, but the setting is actually dead. Instead hosts generate CSRs and store them as "{{requestdir}}/{{certname}}.pem".\r\n\r\nThis ticket is to either make {{hostcsr}} resolve to the correct thing. Since it''s changing the default value of a setting, it needs to happen in 7.0.', 'https://tickets.puppetlabs.com/browse/PUP-9346', 'https://github.com/puppetlabs/puppet/pull/8264', '2018-12-07T15:03:36.000-0800', '2020-11-10T02:04:29.000-0800', '2020-11-10T02:04:29.000-0800', 'Resolved', 'doc_reviewed;platform_7', 2, '0', 2, 6, 6, 3, 'eb81e348b009b978d60d4e5c3cb0b707636df38d'),
('puppet', 205816, 511195653, 8423, 'The list of reserved type names known to the parser validator is incomplete', 'The {{Checker4_0}} class, used for validating the AST produced by the puppet parser, keeps a list named [RESERVED_TYPE_NAMES|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/validation/checker4_0.rb#L360-L380]. This list is incomplete. It lacks the following entries:\r\n{code:ruby}\r\n    ''init'' => true,\r\n    ''object'' => true,\r\n    ''sensitive'' => true,\r\n    ''semver'' => true,\r\n    ''semverrange'' => true,\r\n    ''string'' => true,\r\n    ''timestamp'' => true,\r\n    ''timespan'' => true,\r\n    ''typeset'' => true,\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7843', 'https://github.com/puppetlabs/puppet/pull/8423', '2017-08-15T01:01:41.000-0700', '2020-11-10T02:39:30.000-0800', '2020-11-10T02:39:30.000-0800', 'Resolved', 'doc_reviewed', 5, '0', 1, 31, 0, 2, '90b06271b583cd19aab4c37cb0fe42a6f6851569'),
('puppet', 192222, 495694095, 8346, 'Make attempt to export or virtualize a class an error', 'Currently (under to control of --strict), it is a warning or an error to attempt to use {{@class}} or {{@@class}} in a resource expression or a {{create_resources}} call.\r\n\r\nIn Puppet 7.0.0 this should always be an error.\r\n\r\nNote the configuration for this is done twice, once for the static validation, and once for the runtime. The checker4_0 has the static validation logic, and the runtime check is in the `create_resources`. See PUP-1606 where the warnings were added.', 'https://tickets.puppetlabs.com/browse/PUP-7582', 'https://github.com/puppetlabs/puppet/pull/8346', '2017-05-22T06:00:26.000-0700', '2020-11-10T02:41:02.000-0800', '2020-11-10T02:41:02.000-0800', 'Resolved', 'doc_reviewed;platform_7', 16, '0', 1, 16, 72, 5, '0befcf3270d738aeb1a480590ee824c82ca312c8'),
('puppet', 185590, 439842211, 8204, 'Remove win32-process usage within Puppet', 'win32-process gem is no longer maintained and should be removed / replaced with FFI equivalents inside the Puppet.\r\n\r\nwin32/process is currently consumed explicitly in:\r\n\r\n* https://github.com/puppetlabs/puppet/blob/ce5500dd660019b2be6d132b14f70baff4c553fa/ext/windows/service/daemon.rb\r\n* https://github.com/puppetlabs/puppet/blob/3a5dfed0fef8fc5cb1b6ec168766115de3e8f23b/lib/puppet/util/windows/process.rb\r\n* https://github.com/puppetlabs/puppet/blob/e39b265ef0b34644bb645b4f6674c257ddaa75fa/lib/puppet/type/exec.rb\r\n* https://github.com/puppetlabs/puppet/blob/59f1bcfef7515cc4558ad038f8c9c6a515fe419e/install.rb\r\n\r\nIt is used implicitly at least in:\r\n\r\n* https://github.com/puppetlabs/puppet/blob/ebd96213cab43bb2a8071b7ac0206c3ed0be8e58/lib/puppet/util/pidlock.rb\r\n\r\nwin32/process performs monkey patches to Rubys process execution and should be extricated carefully.\r\n\r\n\r\nAnother ticket will be added to remove the dependency from the .gemspec / Gemfile / puppet-agent packaging repos.', 'https://tickets.puppetlabs.com/browse/PUP-7445', 'https://github.com/puppetlabs/puppet/pull/8204', '2017-04-12T10:48:43.000-0700', '2020-11-10T02:41:45.000-0800', '2020-11-10T02:41:45.000-0800', 'Resolved', 'doc_reviewed;platform-os;platform_7', 1, '0', 1, 864, 5, 6, '1f468fbf52fff8aa9b78fbc9096ee7408003a67c'),
('puppet', 31150, 505074738, 8400, 'puppet config set certname accepts upper-case names', 'On CentOS 6 with Puppet 3.5.0, the certname subcommand accepts upper case letters for the certname. If you then try to change the name to lower-case, puppet complains and refuses to do so:\r\n\r\n{noformat}\r\n[sharon.fonge@puppetmaster ~]$ sudo puppet cert list\r\n[sharon.fonge@puppetmaster ~]$ puppet cert sign puppetclient.local.org\r\nError: Could not find certificate request for puppetclient.local.org\r\n[sharon.fonge@puppetmaster ~]$ sudo rm -rf /etc/puppet/ssl /var/lib/puppet/ssl\r\n[sharon.fonge@puppetmaster ~]$ sudo rm -rf /etc/puppet/ssl /usr/lib/puppet/ssl\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-2173', 'https://github.com/puppetlabs/puppet/pull/8400', '2014-04-07T11:06:29.000-0700', '2020-11-10T02:44:09.000-0800', '2020-11-10T02:44:09.000-0800', 'Resolved', 'doc_reviewed', 4, '0', 5, 262, 120, 7, '6d4ae569bbe0414abece45e4bfa49b549dd69b1b'),
('puppet', 371191, 483989743, 8323, 'Data Type casts cause Puppet Server to retain Compiler instances', 'Casting between Puppet Data Types, such as {{Integer("9")}}, will cause Puppet Server to retain {{Puppet::Parser::Catlog}} objects in memory after requests finish.\r\n\r\nSee SERVER-2874 for more context and PE reproduction case.\r\n\r\nh2. Reproduction Case\r\n\r\n  - Install Puppet Server on CentOS 7 along with the Java development tools:\r\n\r\n{code:bash}\r\nyum install -y http://yum.puppetlabs.com/puppet6-release-el-7.noarch.rpm\r\nyum install -y puppetserver java-devel\r\nsource /etc/profile.d/puppet-agent.sh\r\n{code}\r\n\r\n  - Install the `pupeptlabs-inifile` module and use it to enable JRuby class reification. This allows Ruby objects, like {{Puppet::Parser::Compiler}}, to be identified easily in the Java heap:\r\n\r\n{code:bash}\r\npuppet module install puppetlabs-inifile\r\n\r\npuppet apply <<''EOF''\r\nini_subsetting { ''Enable JRuby reify.classes'':\r\n  ensure            => present,\r\n  path              => ''/etc/sysconfig/puppetserver'',\r\n  section           => '''',\r\n  key_val_separator => ''='',\r\n  setting           => ''JAVA_ARGS'',\r\n  subsetting        => ''-Djruby.reify.classes'',\r\n  value             => ''=true'',\r\n}\r\nEOF\r\n{code}\r\n\r\n  - Bootstrap the CA, configure the agent, and start the {{puppetserver}} service:\r\n\r\n{code:bash}\r\npuppetserver ca setup\r\npuppet config set server $(hostname -f)\r\nsystemctl start puppetserver\r\n{code}\r\n\r\n  - Give the service a trivial catalog to compile:\r\n\r\n{code:bash}\r\ncat <<''EOF'' > /etc/puppetlabs/code/environments/production/manifests/site.pp\r\nnode default {\r\n  $string_version = "9"\r\n  $version = Integer($string_version)\r\n}\r\nEOF\r\n{code}\r\n\r\n  - Run {{puppet}} a couple of times:\r\n\r\n{code:bash}\r\npuppet agent -t\r\npuppet agent -t\r\n{code}\r\n\r\n  - Check the number of {{Puppet::Parser::Compiler}} instances retained in Puppet Server memory:\r\n\r\n{code:bash}\r\nsudo -u puppet jmap -histo:live $(systemctl show -p MainPID puppetserver|cut -d= -f2)|fgrep ''rubyobj.Puppet.Parser.Compiler''\r\n{code}\r\n\r\nh3. Outcome\r\n\r\nAfter running the agent twice, the {{puppetserver}} service is retaining two Compiler instances in memory:\r\n\r\n{noformat}\r\n# sudo -u puppet jmap -histo:live $(systemctl show -p MainPID puppetserver|cut -d= -f2)|fgrep ''rubyobj.Puppet.Parser.Compiler''\r\n5871:             2             64  rubyobj.Puppet.Parser.Compiler\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nNo compiler instances should be retained as the compiler is discarded at the end of the request and the {{-histo:live}} flag forces a full garbage collection.', 'https://tickets.puppetlabs.com/browse/PUP-10659', 'https://github.com/puppetlabs/puppet/pull/8323', '2020-09-04T08:51:58.000-0700', '2020-11-10T08:42:39.000-0800', '2020-11-10T08:42:39.000-0800', 'Resolved', 'doc_reviewed;jira_escalated', 4, '0', 1, 8, 3, 1, 'cb19d8491ad8817f00c3b618abfeccf99a63999e'),
('puppet', 367118, 448227984, 8219, 'Puppet lookup on remote nodes should skip loading local external facts', 'When performing a puppet lookup on a remote node, puppet requires some settings that are provided by Facter. When Facter provides the setting, it evaluates all external facts even if it does not need them.\r\n\r\nWhen running this command puppet should not evaluate all local external facts.', 'https://tickets.puppetlabs.com/browse/PUP-10599', 'https://github.com/puppetlabs/puppet/pull/8219', '2020-07-23T04:43:31.000-0700', '2020-11-13T16:58:03.000-0800', '2020-11-13T16:58:03.000-0800', 'Resolved', 'docs-reviewed', 0, '0', 1, 41, 3, 3, '54d39228c044351f6bb9e527a27d1495a7eeab93'),
('puppet', 153502, 157083799, 6431, 'Error running puppet with non-existent and non-default environment', 'If no matching local $environment folder on agent, error when running any ''puppet config'' or ''puppet module'' command.\r\nSee REPROs in comments below.\r\n\r\nFor example, if you have an environment called ''dev'' on the master, and you want to set an agent''s $environment from the default of ''production'' to ''dev'', you might issue a {{puppet config set environment dev}} comand. When run, {{puppet config}} will look up the current environment (''production'' at this point) and ensure there is a corresponding ''production'' folder in the environments path. Assume this succeeds because a ''production'' folder exists locally on the agent, by default, but NO OTHER environment folders exist locally on the agent (and shouldn''t need to exist in my view).\r\n\r\nNow the environment is set to ''dev''.\r\n\r\nIf a user issues any {{puppet config}} command at this point, the  current environment (''dev'' at this point) will NOT have a corresponding environment folder, so we get an error like:\r\n\r\n{code}\r\nCould not find a directory environment named ''dev'' anywhere in the path: /etc/puppetlabs/code/environments. Does the directory exist?\r\n{code}\r\n\r\n{code}\r\n[root@pup-vra7-0403 ~]# puppet config set environment production\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/environments.rb:38:in `get!'': Could not find a directory environment named ''dev'' anywhere in the path: /etc/puppetlabs/code/environments. Does the directory exist? (Puppet::Environments::EnvironmentNotFound)\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application_support.rb:29:in `push_application_context''\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:337:in `run''\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:132:in `run''\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute''\r\n	from /usr/local/bin/puppet:5:in `<main>''\r\n{code}\r\n\r\nThis means we''re stuck and cannot issue any {{puppet config print}} or {{puppet config set}} commands even to get us back to an environment setting of ''production''!', 'https://tickets.puppetlabs.com/browse/PUP-6739', 'https://github.com/puppetlabs/puppet/pull/6431', '2016-09-25T13:35:26.000-0700', '2020-12-01T12:29:29.000-0800', '2020-12-01T12:29:29.000-0800', 'Closed', 'the-goods', 36, '0', 1, 10, 4, 2, 'bc6a6fa52c741bb76bfbebead40144726e3cb4dd'),
('puppet', 379680, 531322895, 8447, 'puppet 7 gem is missing runtime dependency on scanf', 'Ruby 2.7 removed the scanf implementation (in Kernel, IO and String) from core ruby to a separate gem. Puppet''s [{{scanf}} function|https://puppet.com/docs/puppet/latest/function.html#scanf] depends on that ruby method, but only expresses the {{scanf}} runtime dependency in its [{{Gemfile}}|https://github.com/puppetlabs/puppet/blob/96029b003cfbb5303426cbc110f350a0d4b6af06/Gemfile#L21], but not in the gem that is pushed to rubygems. See https://rubygems.org/gems/puppet/versions/7.0.0.\r\n\r\nAs a result, if a module calls the puppet {{scanf}} function using puppet 7 (gem) and ruby 2.7, such as when running rspec tests, then you''ll see (for example in https://github.com/puppetlabs/puppetlabs-puppetdb/pull/317)\r\n\r\n{noformat}\r\n       LoadError:\r\n         cannot load such file -- scanf\r\n{noformat}\r\n\r\nThis doesn''t affect module functionality when testing or running against puppet-agent 7 packages, because the {{scanf}} gem is included.\r\n\r\nAFAIK rubygems doesn''t have a way to express conditional runtime dependencies (i.e. only add this dependency when running on ruby 2.7 and up). So the best thing may be to always add the runtime dependency for the puppet 7.x collection? If you''re running the puppet 7 gem with ruby 2.5.0, then things will still work (the scanf gem is ignored).\r\n\r\n{noformat}\r\n$ rbenv shell 2.5.8\r\n$ gem install scanf --no-document\r\nFetching: scanf-1.0.0.gem (100%)\r\nSuccessfully installed scanf-1.0.0\r\n1 gem installed\r\n$ irb\r\nirb(main):001:0> require ''scanf''\r\n=> true\r\nirb(main):002:0> $LOADED_FEATURES.grep /scanf/\r\n=> ["/usr/local/Cellar/rbenv/1.1.2/versions/2.5.8/lib/ruby/2.5.0/scanf.rb"]\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10797', 'https://github.com/puppetlabs/puppet/pull/8447', '2020-12-02T09:37:15.000-0800', '2020-12-09T08:32:41.000-0800', '2020-12-09T08:32:41.000-0800', 'Resolved', 'doc_reviewed;platform_7.1', 1, '0', 1, 2, 2, 3, '2c4e357a9b1eb0303ee4acb1d9baab3632678b83'),
('puppet', 378889, 524157126, 8445, 'Puppet Node Clean action''s LoggerIO needs to implement `warn`', 'In the [Puppet Node|https://github.com/puppetlabs/puppet/blob/d4982257ab2ab5f4f1e696c212b328fa99a9253d/lib/puppet/face/node/clean.rb#L49-L57] face''s ''clean'' action, we load the Puppet Server CA CLI as a library, passing in a ''LoggerIO'' object as an adapter between the CA''s logging facilities and Puppet''s.\r\n\r\nPreviously, we only needed `inform` and `err` methods to call the relevant APIs in the CA - and it appears our LoggerIO adapter only implements those two methods.\r\n\r\nWith the new cadir default change (see SERVER-2896) we may `warn` as well which will now cause {{puppet node clean}} calls to fail with an undefined method on LoggerIO.\r\n\r\nTo fix this we should update the LoggerIO adapter to provide all the methods available in the Puppet Server CA''s Logger.', 'https://tickets.puppetlabs.com/browse/PUP-10786', 'https://github.com/puppetlabs/puppet/pull/8445', '2020-11-19T09:06:33.000-0800', '2020-12-09T08:33:19.000-0800', '2020-12-09T08:33:19.000-0800', 'Resolved', 'doc_reviewed', 0, '0', 1, 23, 3, 3, '8e054afba2643218049b8711069264e4d9c311ae'),
('puppet', 377970, 519448937, 8437, 'Calling scope#tags results in undefined method', 'The following prints a confusing error message in 4.10.5 and up:\r\n\r\n{noformat}\r\n$ bundle exec puppet apply -e "notice(inline_template(''<%= tags %>''))"\r\nError: Evaluation Error: Error while evaluating a Function Call, Failed to parse inline template: undefined method `tags'' for Scope(Class[main]):Puppet::Parser::Scope (line: 1, column: 8) on node localhost\r\n{noformat}\r\n\r\nWithin the body of the ERB template, {{self}} is {{TemplateWrapper}} and {{TemplateWrapper#tags}} is a valid method that delegates to the {{Scope}}, but that doesn''t forward it to the parser resource, due to https://github.com/puppetlabs/puppet/commit/02576c98fa5a8b7decb7b53c9407bf8523947220#diff-b929053e73f66fa12eac30a6222276489f6ea778ec407f99183a03e763b38623\r\n\r\nWe should either remove the {{tags}} method from {{TemplateWrapper}} or raise a more meaningful error (to call {{all_tags}} instead) /cc [~ben.ford], [~david.schmitt]', 'https://tickets.puppetlabs.com/browse/PUP-10779', 'https://github.com/puppetlabs/puppet/pull/8437', '2020-11-11T12:45:52.000-0800', '2020-12-09T08:34:04.000-0800', '2020-12-09T08:34:04.000-0800', 'Resolved', 'doc_reviewed', 2, '0', 1, 5, 4, 2, '5c8c5e8c5d2c4d27af002efde7578af08dadd1ae'),
('puppet', 374883, 515739398, 8434, 'Fine grained environment timeout issues', 'Puppet''s environment cache has three methods for evicting a single expired environment, all expired environments, or all environments, but they don''t mutate the cache in a consistent way:\r\n\r\n1. Whenever {{Puppet::Environments::Cached#get_conf(name)}} is called to lookup the {{EnvironmentConf}} for an environment, we clear that environment if it is now expired via {{evict_if_expired(name)}}, but the method doesn''t update the {{@next_expiration}} instance variable. As a result, the optimization in {{clear_all_evicted}} may cause us to call the {{cache_expiration_service.expired?(name.to_sym}} twice.\r\n\r\n2. Whenever {{Puppet::Environments::Cached#get(name)}} is called, we clear all environments that are now expired via {{clear_all_expired}}. This method updates the cache consistently.\r\n\r\n3. Whenever {{Puppet::Environments::Cached#clear_all}} is called, the {{cache_expiration_service}} is never notified of the eviction, which could lead to puppetserver holding onto environment names in memory. The method also does not clear environment related settings (for each environment). So anyone calling `Puppet[:rich_data]` for example could "see" the value from the now evicted environment. The {{clear_all}} method is used when Puppet[:rich_data] is set and also in unit tests.\r\n\r\n4. The {{Puppet::Environments::Cached#clear}} method does not remove the environment entry from the {{@expirations}} sorted set and doesn''t recalculate the {{@next_expiration}} time, or clear the enviroment related settings. The {{clear}} methods does not appear to be used in puppet, as it was decided earlier to only support a REST API for cache eviction.', 'https://tickets.puppetlabs.com/browse/PUP-10713', 'https://github.com/puppetlabs/puppet/pull/8434', '2020-10-13T17:25:46.000-0700', '2020-12-09T08:39:28.000-0800', '2020-12-09T08:39:28.000-0800', 'Resolved', 'doc_reviewed', 3, '0', 10, 134, 73, 2, '7810030d1580e9eec52081255c717b73ba8a28b0'),
('puppet', 379059, 535068137, 8453, 'user provider with uid/gid as Integer raises warning', ' \r\n{code:java}\r\n # cat foo.pp \r\nuser { ''user1'':\r\n  ensure             => ''present'',\r\n  gid                => 10008,\r\n  groups             => [''bla''],\r\n  home               => ''/home/user1'',\r\n  provider           => ''useradd'',\r\n  shell              => ''/bin/bash'',\r\n  uid                => ''10008'',\r\n}\r\n\r\n# puppet apply --noop foo.pp\r\nNotice: Compiled catalog for foo in environment production in 0.02 seconds\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/user.rb:468: warning: deprecated Object#=~ is called on Integer; it always returns nil\r\nNotice: /Stage[main]/Main/User[user1]/ensure: current_value ''absent'', should be ''present'' (noop)\r\nNotice: Class[Main]: Would have triggered ''refresh'' from 1 event Notice: Stage[main]: Would have triggered ''refresh'' from 1 event Notice: Applied catalog in 0.41 seconds\r\n{code}\r\n\r\nvs.\r\n\r\n\r\n{code:java}\r\n # cat foo.pp \r\nuser { ''user1'':\r\n  ensure             => ''present'',\r\n  gid                => ''10008'',\r\n  groups             => [''bla''],\r\n  home               => ''/home/user1'',\r\n  provider           => ''useradd'',\r\n  shell              => ''/bin/bash'',\r\n  uid                => ''10008'',\r\n}\r\n\r\n\r\n # puppet apply --noop foo.pp \r\nNotice: Compiled catalog for foo in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/User[user1]/ensure: current_value ''absent'', should be ''present'' (noop)\r\nNotice: Class[Main]: Would have triggered ''refresh'' from 1 event\r\nNotice: Stage[main]: Would have triggered ''refresh'' from 1 event\r\nNotice: Applied catalog in 0.42 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10790', 'https://github.com/puppetlabs/puppet/pull/8453', '2020-11-20T15:58:48.000-0800', '2020-12-14T07:04:02.000-0800', '2020-12-14T07:04:02.000-0800', 'Closed', 'doc_reviewed;platform_7.1', 2, '0', 1, 1, 1, 1, '85be0bf028f98c5a1d31c22958fd10811328f371'),
('puppet', 374199, 0, 0, 'Assess SSL provider spec after upgrade to openssl 1.1.1h', 'After upgrading to openssl 1.1.1h, the following rspec failure can be seen:\r\n\r\n \r\n{code}$ bundle exec rspec ./spec/unit/ssl/ssl_provider_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n.......................................F................................\r\n\r\nFailures:\r\n\r\n  1) Puppet::SSL::SSLProvider when creating an ssl context with client certs raises if root cert signature is invalid\r\n     Failure/Error:\r\n       expect {\r\n         subject.create_context(**config.merge(cacerts: global_cacerts))\r\n       }.to raise_error(Puppet::SSL::CertVerifyError,\r\n                        "Invalid signature for certificate ''CN=Test CA''")\r\n     \r\n       expected Puppet::SSL::CertVerifyError with "Invalid signature for certificate ''CN=Test CA''" but nothing was raised\r\n     # ./spec/unit/ssl/ssl_provider_spec.rb:278:in `block (3 levels) in <top (required)>''\r\n     # ./spec/spec_helper.rb:180:in `block (2 levels) in <top (required)>''\r\n     # /home/gabi/.rvm/gems/ruby-2.6.3/gems/webmock-3.9.1/lib/webmock/rspec.rb:37:in `block (2 levels) in <top (required)>''\r\n\r\nFinished in 0.51384 seconds (files took 1.09 seconds to load)\r\n72 examples, 1 failure\r\n\r\nFailed examples:\r\n\r\nrspec ./spec/unit/ssl/ssl_provider_spec.rb:274 # Puppet::SSL::SSLProvider when creating an ssl context with client certs raises if root cert signature is invalid\r\n{code}\r\nWe traced this to [https://github.com/openssl/openssl/commit/42bb51e59308b3ebc5cc1c35ff4822fba6b52d79], notably the changing of {{X509_V_FLAG_CHECK_SS_SIGNATURE}} to no longer check signature of the root CA. Downgrading openssl to 1.1.1g causes the test to pass again.\r\n\r\nThis currently impacts GitHub Actions Windows runners, as ruby 2.7.2 there comes with openssl 1.1.1h.', 'https://tickets.puppetlabs.com/browse/PUP-10689', 'https://github.com/puppetlabs/puppet/commit/2b8f2a3ad41abf6204f91ad42d62350018141620', '2020-10-07T06:22:35.000-0700', '2020-12-15T00:05:29.000-0800', '2020-12-15T00:05:29.000-0800', 'Resolved', '', 2, '0', 0, 0, 0, 0, '2b8f2a3ad41abf6204f91ad42d62350018141620'),
('puppet', 349115, 387021981, 8035, 'server_list is processed once per service not once per session', 'In 6.13.0, if puppet is configured to use {{server_list}}, it tries to connect to each entry in the list, stopping at the first HTTP 200 connection to puppetserver''s simple status endpoint, and adds the resolved {{server}} and {{port}} into puppet''s context, which is then looked up each time a connection is made. Each time connection attempt may result in a 2 minute timeout for each failed connection. The timeout defaults to 2 minutes, but is configurable using the {{http_connect_timeout}} puppet setting.\r\n\r\nIn 6.14.0, puppet will resolve {{server_list}} for {{puppet}}, {{fileserver}} and {{report}} services. This can result in additional delay during the run. So if 6.13.0 was delayed X minutes, then puppet 6.14.0 will be delayed 3X minutes. The exact number depends on how many entries in {{server_list}} fail before a successfully connection is made.', 'https://tickets.puppetlabs.com/browse/PUP-10363', 'https://github.com/puppetlabs/puppet/pull/8035', '2020-03-09T15:10:22.000-0700', '2020-12-22T08:06:55.000-0800', '2020-12-22T08:06:55.000-0800', 'Resolved', 'doc_reviewed', 5, '0', 1, 10, 5, 2, '6a12f143633112bc5c0539bea8ec7baf2539f00e'),
('puppet', 290248, 242171777, 7320, 'provider gem in package type doesn''t work anymore when rubygems is >=  3.0.0', 'Since version 3.x, gem will not have anymore the 2 params {{\-\-no-ri}} and {{\-\-no-rdoc}}, that currently are the default params.([https://github.com/puppetlabs/puppet/blob/24ead48f617cd3912491fe419ac7b67cda53a320/lib/puppet/provider/package/gem.rb#L131)] when is used the provider gem in the type package. This should be addressed by adding an option to disable them or override them through the parameter `install_options` already existing in the type package. The version 3.x of rubygems is a constraint since the new bundler major version 2.0.0 dropped support for rubygem older than 3.0.0 : [https://github.com/bundler/bundler/releases/tag/v2.0.0] .\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-9395', 'https://github.com/puppetlabs/puppet/pull/7320', '2019-01-03T08:06:27.000-0800', '2021-01-04T23:45:01.000-0800', '2021-01-04T23:45:01.000-0800', 'Closed', 'gem;package;resolved-issue-added;sadness;type_and_provider', 15, '0', 2, 127, 99, 3, 'd13b9d970c4d5780d23d10c81138e4a09e843028'),
('puppet', 69290, 109795636, 5699, 'package resource doesn''t find new packages in yum repo', 'I created a new meta RPM and added it to my yum repo.\r\n\r\nI then added a package resource to install the new RPM.\r\n\r\nThe manifest fails as follows:\r\n\r\n{code}\r\nError: /Stage[main]/Profile_sensu_client::Nagios_plugins/Package[ubnt-meta-nagios-plugins]/ensure: change from absent to present failed: Execution of ''/bin/yum -d 0 -e 0 -y list ubnt-meta-nagios-plugins'' returned 1: Error: No matching Packages to list\r\n{code}\r\n\r\nThis is because "yum list" does not update the yum cache:\r\n{code}\r\n# yum list ubnt-meta-nagios-plugins\r\nLoaded plugins: fastestmirror\r\nLoading mirror speeds from cached hostfile\r\n * base: mirror.solarvps.com\r\n * epel: mirror.cogentco.com\r\n * extras: mirror.us.leaseweb.net\r\n * updates: mirror.steadfast.net\r\nError: No matching Packages to list\r\n{code}\r\n\r\nHowever, if I just try "yum install" directly, the cache is updated, and the package is found and installed:\r\n{code}\r\n# yum install ubnt-meta-nagios-plugins\r\nLoaded plugins: fastestmirror\r\nbase                                                                                                                  | 3.6 kB  00:00:00\r\nepel                                                                                                                  | 4.4 kB  00:00:00\r\nextras                                                                                                                | 3.4 kB  00:00:00\r\nforeman                                                                                                               | 2.9 kB  00:00:00\r\nforeman-plugins                                                                                                       | 2.9 kB  00:00:00\r\npuppetlabs-deps                                                                                                       | 2.5 kB  00:00:00\r\npuppetlabs-products                                                                                                   | 2.5 kB  00:00:00\r\nupdates                                                                                                               | 3.4 kB  00:00:00\r\nyo61                                                                                                                  | 2.9 kB  00:00:00\r\n(1/4): foreman-plugins/x86_64/primary_db                                                                              |  49 kB  00:00:00\r\n(2/4): epel/x86_64/primary_db                                                                                         | 4.0 MB  00:00:00\r\n(3/4): yo61/primary_db                                                                                                | 242 kB  00:00:00\r\n(4/4): updates/7/x86_64/primary_db                                                                                    | 6.6 MB  00:00:07\r\n(1/2): epel/x86_64/updateinfo                                                                                         | 288 kB  00:00:00\r\n(2/2): epel/x86_64/pkgtags                                                                                            | 1.4 MB  00:00:00\r\nLoading mirror speeds from cached hostfile\r\n * base: distro.ibiblio.org\r\n * epel: mirror.cogentco.com\r\n * extras: mirror.us.leaseweb.net\r\n * updates: mirror.steadfast.net\r\nResolving Dependencies\r\n--> Running transaction check\r\n---> Package ubnt-meta-nagios-plugins.noarch 0:1.0.0-1 will be installed\r\n--> Finished Dependency Resolution\r\n\r\nDependencies Resolved\r\n\r\n=============================================================================================================================================\r\n Package                                        Arch                         Version                        Repository                  Size\r\n=============================================================================================================================================\r\nInstalling:\r\n ubnt-meta-nagios-plugins                       noarch                       1.0.0-1                        yo61                       3.5 k\r\n\r\nTransaction Summary\r\n=============================================================================================================================================\r\nInstall  1 Package\r\n\r\nTotal download size: 3.5 k\r\nInstalled size: 0\r\nIs this ok [y/d/N]:\r\n{code}\r\n\r\nIt seems there is no way to install the package on this node without manually refreshing the cache in this way.', 'https://tickets.puppetlabs.com/browse/PUP-4039', 'https://github.com/puppetlabs/puppet/pull/5699', '2015-02-24T16:06:53.000-0800', '2021-01-08T09:46:45.000-0800', '2021-01-08T09:46:45.000-0800', 'Accepted', 'community;linux;package;platform-os;redhat;triaged;type_and_provider;yum', 28, '0', 2, 32, 3, 2, ''),
('puppet', 381915, 548590865, 8467, 'puppet apply creates warnings (since 7.x)', '*Puppet Version:* 7.1.0\r\n*Puppet Server Version:* -\r\n*OS Name/Version:* Windows 10 x64 20H2\r\n\r\nCreate a {{main.pp}} with the following contents (anywhere on your disk):\r\n\r\n{code:puppet}\r\nnode default {\r\n}\r\n{code}\r\n\r\nRun:\r\n\r\n{code}\r\npuppet apply main.pp\r\n{code}\r\n\r\n*Desired Behavior:*\r\n\r\nNo warnings should be shown.\r\n\r\n*Actual Behavior:*\r\n\r\nThe following warnings are displayed:\r\n\r\n{code}\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/pops/model/ast_transformer.rb:34: warning: Using the last argument as keyword parameters is deprecated; maybe ** should be added to the call\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/leaf.rb:29: warning: The called method `initialize'' is defined here\r\n{code}\r\n\r\nIf you guys need any additional information, I''d happy to provide them.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10845', 'https://github.com/puppetlabs/puppet/pull/8467', '2020-12-30T06:53:14.000-0800', '2021-01-13T06:05:07.000-0800', '2021-01-13T06:05:07.000-0800', 'Resolved', 'doc_reviewed', 3, '0', 1, 4, 3, 2, '9c2f45a910b70c1617fa7357449758b6f3eae4ac'),
('puppet', 381404, 542071555, 8465, 'Remove Pathname#cleanpath workaround', 'Ruby 1.9 Pathname#cleanpath did not work correctly on windows. https://bugs.ruby-lang.org/issues/9618 This was fixed in ruby 2.0. Puppet 6.x requires ruby 2.3 or greater, so we should remove our workaround.', 'https://tickets.puppetlabs.com/browse/PUP-10840', 'https://github.com/puppetlabs/puppet/pull/8465', '2020-12-17T11:14:04.000-0800', '2021-01-13T06:05:53.000-0800', '2021-01-13T06:05:53.000-0800', 'Resolved', 'doc_reviewed', 2, '0', 1, 5, 8, 2, '5dceb9c8671055b2b89921f315e91f532ffb20b0'),
('puppet', 377931, 0, 0, 'User resource is not idempotent on AIX', '*Puppet Version:* 6.17\r\n*Puppet Server Version:* 6.12.1\r\n*OS Name/Version:* AIX 7.2\r\n\r\nWhen using a user resource on AIX and setting the password, the password is updated every agent run. This happens when a user stanza contains a tab in the password line. \r\n\r\nThis is because the regex in https://github.com/puppetlabs/puppet/blob/main/lib/puppet/provider/user/aix.rb#L181 does not account for tabs or multiple spaces. \r\n\r\n*Reproduction:*\r\n\r\n1. In an AIX 7.2 node add a user resource.\r\n\r\n{code}\r\nuser{''testing'':\r\n  ensure => present,\r\n  password => ''test'',\r\n}\r\n{code}\r\n\r\n2. Edit the /etc/security/passwd file to add a tab to the password line.\r\n\r\n{code}\r\ntesting:\r\n        password        = test\r\n        lastupdate = 1605112051\r\n{code}\r\n\r\n3. Apply the user resource multiple times and confirm that the password it changed b every run.\r\n\r\n{code}\r\n[0] [AIX] root@aix72-9:~ # puppet apply user.pp \r\nNotice: Compiled catalog for aix72-9.delivery.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/User[testing]/password: changed [redacted] to [redacted]\r\nNotice: Applied catalog in 0.22 seconds\r\n[0] [AIX] root@aix72-9:~ # puppet apply user.pp \r\nNotice: Compiled catalog for aix72-9.delivery.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/User[testing]/password: changed [redacted] to [redacted]\r\nNotice: Applied catalog in 0.22 seconds\r\n[0] [AIX] root@aix72-9:~ # puppet apply user.pp \r\nNotice: Compiled catalog for aix72-9.delivery.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/User[testing]/password: changed [redacted] to [redacted]\r\nNotice: Applied catalog in 0.22 seconds\r\n{code}\r\n\r\n*Desired Behavior:*\r\nThe password should be set once unless the password changed.\r\n\r\n*Actual Behavior:*\r\n\r\nThe detection of the current password has an incorrect regex and  updates the password every agent run.\r\n\r\n*Proposed Fix*\r\nChange the regex in https://github.com/puppetlabs/puppet/blob/main/lib/puppet/provider/user/aix.rb#L181 to be {{/password\s+=\s+(\S+)/}}', 'https://tickets.puppetlabs.com/browse/PUP-10778', 'https://github.com/puppetlabs/puppet/commit/b534a99c401677531e3e4142e61fa2296af5fd1c', '2020-11-11T08:38:56.000-0800', '2021-01-13T06:09:33.000-0800', '2021-01-13T06:09:33.000-0800', 'Closed', 'doc_reviewed;jira_escalated', 3, '0', 0, 0, 0, 0, 'b534a99c401677531e3e4142e61fa2296af5fd1c'),
('puppet', 147758, 334947456, 7802, 'Apt package provider does not mark managed packages as manual', 'The apt package provider does not mark packages as manual. This means that if a package gets removed, some packages may get marked for deletion if nothing depends on them any longer - even though they should be installed according to Puppet. \r\n\r\nExample:\r\nPuppet purges a package depending on `ethtool`.\r\nNothing depends on `ethtool` any longer, so it gets marked for deletion, but is still installed.\r\nPuppet processes ''package {''ethtool'': ensure -> installed}'' and does nothing, since it''s already installed\r\nIf something or someone then runs `apt-get -y autoremove` the package ethtool will then be removed (in my case puppet does this later in the run). \r\n\r\nThis specific example makes it impossible for Puppet to rectify it in a later run, since the ethtool package is required to bring up the network interface.', 'https://tickets.puppetlabs.com/browse/PUP-6631', 'https://github.com/puppetlabs/puppet/pull/7802', '2016-08-18T03:06:13.000-0700', '2021-01-14T05:17:45.000-0800', '2021-01-14T05:17:45.000-0800', 'Resolved', 'debian;doc_reviewed;linux;package;type_and_provider;ubuntu', 7, '0', 3, 112, 0, 3, '69215f1497b46f602e77e21be4e7b0951b5be6e1'),
('puppet', 382201, 550445633, 8469, '"puppet facts show fact" output differs from "facter fact"', '*Puppet Version:* {{7.1}}\r\n*OS Name/Version:* macOS 11.1\r\n\r\nThe output of "{{puppet facts show _somefact_}}" is not the same as "{{facter _somefact_}}", as it returns JSON, which requires subsequent parsing to get the the fact value.\r\n\r\nWe use "{{facter --puppet _somefact_}}" quite a bit in non-puppet code, such as shell and python scripts and other internal management utilities. This is a strongly complicating issue in a migration from facter 3/puppet 6 to facter 4/puppet 7: "{{facter --puppet}}" no longer works in Facter 4, and I believe "{{puppet facts show _somefact_}}" only works in Puppet 7.\r\n\r\nThis will mean all the various places we use "{{facter --puppet _somefact_}}" will have to have a case on the puppet version and then call "{{facter --puppet _somefact_}}" or "{{puppet facts show _somefact_}}" as appropriate. And we''ll have to do extra processing on the output of "{{puppet facts show}}", as it sends JSON.\r\n\r\n*Desired Behavior:*\r\n{quote}\r\n$ puppet facts show facterversion\r\n4.0.47\r\n$ facter facterversion\r\n4.0.47\r\n{quote}\r\n\r\n*Actual Behavior:*\r\n{quote}\r\n$ puppet facts show facterversion\r\n\{\r\n  "facterversion": "4.0.47"\r\n}\r\n$ facter facterversion\r\n4.0.47\r\n{quote}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10847', 'https://github.com/puppetlabs/puppet/pull/8469', '2021-01-05T13:07:39.000-0800', '2021-01-20T02:22:06.000-0800', '2021-01-20T02:22:06.000-0800', 'Resolved', 'doc_reviewed', 3, '0', 1, 123, 1, 3, 'fdbcce0212bab85c41f11ff8736c520b041b57ca'),
('puppet', 358891, 423276142, 8174, 'sshkeys_core 2.0.0 cannot purge sshkey resources', '*Puppet Version:* 6.15.0\r\n *Puppet Server Version:* 6.11.0\r\n *OS Name/Version:* CentOS / Debian\r\n\r\nAfter updating the sshkeys_core module to 2.0.0 in our control repo, puppet is unable to purge sshkeys. We use the following configuration to export each host SSH keys and collect them on some of our nodes:\r\n\r\n{code:puppet}\r\n # in site.pp\r\nresources { ''sshkey'':\r\n  purge => true\r\n}\r\n{code}\r\n\r\n{code:puppet}\r\n# on each node ($host_aliases is an array of the names of the node)\r\n@@sshkey { "sshdsakey-${host_aliases[0]}":\r\n  host_aliases => $host_aliases,\r\n  type => ''ssh-dss'',\r\n  key => $facts[''ssh''][''dsa''][''key''],\r\n}\r\n{code}\r\n\r\n{code:puppet}\r\n # on some nodes\r\nSshkey <<| |>>\r\n{code}\r\n\r\nDowngrading to sshkeys_core 1.0.3 fix the issue.\r\n\r\n*Desired Behavior:*\r\n When a node is decomissioned, it''s SSH key should be removed from the known_hosts file of the node collecting the ssh keys.\r\n\r\n*Actual Behavior:*\r\n Puppet says it removes the key, but it''s not actually done. So the configuration never converge, at each run Puppet says it remove the key.', 'https://tickets.puppetlabs.com/browse/PUP-10510', 'https://github.com/puppetlabs/puppet/pull/8174', '2020-05-14T12:00:20.000-0700', '2021-01-20T06:17:09.000-0800', '2021-01-20T06:17:09.000-0800', 'Resolved', '', 2, '0', 1, 55, 4, 2, '105c71217050659b2f5bdd3fe6e74b22e4d1b177'),
('puppet', 382858, 554018394, 8482, 'Puppet facts show doesn''t have an option to opt out of legacy facts', '*Puppet Version: 7.0.1*\r\n *Puppet Server Version: -* \r\n *OS Name/Version: All*\r\n\r\nBy default\r\n{noformat}\r\npuppet facts show{noformat}\r\ndisplays legacy facts, there is an option (--show-legacy) that has no effect. There isn''t any way to indicate puppet to not retrieve legacy facts.\r\n\r\n*Desired Behavior:*\r\n\r\n By default {{puppet facts show}} does not display legacy facts, but they may be displayed using {{puppet facts show --show-legacy}}\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10850', 'https://github.com/puppetlabs/puppet/pull/8482', '2021-01-11T07:34:06.000-0800', '2021-01-21T15:15:36.000-0800', '2021-01-21T15:15:36.000-0800', 'Resolved', 'doc_reviewed', 5, '0', 1, 6, 10, 3, '8d2459a31292dc031a03d2348383b67070e9603b'),
('puppet', 18323, 91286893, 5350, 'Namevar over 1024 characters is not caught and results in invalid yaml with accompanying errors', 'Puppet resources with namevars over 1024 characters result in the generation of invalid yaml.\r\n\r\nFor example, this nonsense resource:\r\n\r\n	ssh_authorized_key { ''ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'':\r\n	ensure => present,\r\n	user => ''root'',\r\n	type => ''rsa'',\r\n	key => ''foo'',\r\n	}\r\n\r\nResults in the following: \r\n\r\n	[root@pe-301-master pe-301-master.puppetdebug.vlan]# puppet agent --test\r\n    ...\r\n	Info: Applying configuration version ''1380664174''\r\n	Notice: /Stage[main]//Ssh_authorized_key[ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff]/ensure: created\r\n	Info: Creating state file /var/opt/lib/pe-puppet/state/state.yaml\r\n	Notice: Finished catalog run in 8.37 seconds\r\n	Error: Could not send report: Error 400 on SERVER: (<unknown>): could not find expected '':'' while scanning a simple key at line 1314 column 5\r\n	\r\nAll future runs are prevented at that point, until you remove the state.yaml file:\r\n\r\n	[root@pe-301-master pe-301-master.puppetdebug.vlan]# puppet agent --test\r\n	Error: Could not run Puppet configuration client: (<unknown>): could not find expected '':'' while scanning a simple key at line 441 column 3\r\n	Error: Could not run: can''t convert Puppet::Util::Log into Integer\r\n	\r\nand then:\r\n\r\n	root@pe-301-master pe-301-master.puppetdebug.vlan]# rm /var/opt/lib/pe-puppet/state/state.yaml\r\n	rm: remove regular file `/var/opt/lib/pe-puppet/state/state.yaml''? y\r\n	[root@pe-301-master pe-301-master.puppetdebug.vlan]# /opt/puppet/bin/puppet agent --test\r\n	Info: Retrieving plugin\r\n	Info: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/pe_version.rb\r\n	Info: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/facter_dot_d.rb\r\n	Info: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/puppet_vardir.rb\r\n	Info: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/root_home.rb\r\n	…\r\n	Info: Caching catalog for pe-301-master.puppetdebug.vlan\r\n	Info: Applying configuration version ''1380664174''\r\n	Info: Creating state file /var/opt/lib/pe-puppet/state/state.yaml\r\n	Notice: Finished catalog run in 17.62 seconds\r\n	Error: Could not send report: Error 400 on SERVER: (<unknown>): could not find expected '':'' while scanning a simple key at line 1302 column 5\r\n	\r\nWhile obviously having a 1024+ character namevar is a bad idea, it shouldn''t be SO bad that it prevents all future puppet runs from proceeding. \r\n\r\nNote: The namevar actually needs to be slightly less than 1024 chars to trigger this, since it ends up padded a bit in the yaml key, and then breaks 1024, even if the namevar itself isn''t quite 1024 chars.\r\n\r\nOne real-world example of this is that the pe_accounts module we supply with PE has defined types that generate ssh trusted key resources, with the ssh keys themselves as the namevars. This results in very long namevars in some cases, with the above problem.\r\n\r\nThe issue is that the namevar gets set as the key of a hash in, for example, state.yaml, and the YAML spec restricts hash key length to 1024 chars.\r\n\r\nThis appears to have not been enforced in Ruby 1.8.7, but is in 1.9.3, and is now affecting users.', 'https://tickets.puppetlabs.com/browse/PUP-684', 'https://github.com/puppetlabs/puppet/pull/5350', '2013-11-06T11:41:29.000-0800', '2021-01-26T12:25:50.000-0800', '2021-01-26T12:25:50.000-0800', 'Closed', 'customer;redmine', 8, '0', 1, 1, 1, 1, '70426ea1effce8aaa545db911c3f340c09c25f56'),
('puppet', 381531, 554002077, 8481, 'Issue with puppet creating production folder when multiple environment paths are set', '*Tested on the below but likely occurs in every version since PUP-2519 was added*\r\n\r\n*Puppet Version:* 5.5.22**\r\n *Puppet Server Version: 2018.1.18*\r\n *OS Name/Version: centos7*\r\n\r\nAdd environmentpath setting to puppet.conf with multiple paths set.\r\n\r\nE.g:\r\n\r\nenvironmentpath = /home/puppet/projects:/etc/puppetlabs/code/environments\r\n\r\nPuppet will create an empty folder production under /home/puppet/projects resulting in /etc/puppetlabs/code/environments/production getting ignored and no classes getting picked up for production\r\n\r\n*Desired Behavior:*\r\n\r\nPuppet should check all environment paths for a production folder before creating one.\r\n\r\n*Actual Behavior:*\r\n\r\n Puppet creates a production folder the first environment path and ignores the 2nd', 'https://tickets.puppetlabs.com/browse/PUP-10842', 'https://github.com/puppetlabs/puppet/pull/8481', '2020-12-21T04:05:53.000-0800', '2021-01-26T22:50:44.000-0800', '2021-01-26T22:50:44.000-0800', 'Resolved', 'doc_reviewed;jira_escalated', 2, '0', 1, 163, 14, 2, 'fdc0cfa7f379fc1827f5bfeae8d17912d74d6bac'),
('puppet', 144507, 79775395, 5165, 'The `site:modules:$basemodulepath` pattern should be default', 'For a very long time, CS has been recommending and educating the\r\n`modulepath = site:modules:$basemodulepath` pattern via\r\n`environment.conf`. It''s now codified as a CS standard:\r\n\r\nhttps://github.com/puppetlabs/cs-standards/blob/master/control_repo_contents.md#directory-structure-and-contents\r\n\r\nIt''s always felt a bit weird to be explaining to people why the best\r\npractice wasn''t the Puppet default, so how about we make it the default?\r\nThis should not impact existing users unless they''re currently using\r\n`$environment/site` for other purposes, and I''d wager that percentage is\r\nrather low.', 'https://tickets.puppetlabs.com/browse/PUP-6572', 'https://github.com/puppetlabs/puppet/pull/5165', '2016-08-02T10:26:39.000-0700', '2021-01-27T10:17:10.000-0800', '2021-01-27T10:17:10.000-0800', 'Accepted', '', 0, '0', 1, 12, 8, 4, ''),
('puppet', 341316, 360086193, 7908, 'PObjectTypeExtension doesn''t implement implementation_class', '*Puppet Version:* 6.11.1\r\n*Puppet Server Version:*\r\n*OS Name/Version:* Ubuntu 16.04\r\n\r\nThe PObjectTypeExtension, which wraps PObjectType, does not implement the implementation_class method to get the underlying PObjectType implementation class. This raises an error when serializing Puppet::Datatypes::Error objects to pcore.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10221', 'https://github.com/puppetlabs/puppet/pull/7908', '2020-01-07T09:02:15.000-0800', '2021-01-27T10:43:10.000-0800', '2021-01-27T10:43:10.000-0800', 'Resolved', 'resolved-issue-added', 2, '0', 1, 16, 1, 2, 'd7093e2921e4f5e7870bf9c04e4b1e09034025c4'),
('puppet', 349628, 443802672, 8211, 'Checksums not validated when downloading file http(s):// sources', '*Puppet Version:* all\r\n*OS Name/Version:* all\r\n\r\nWhen using a File resource with an http(s) source type and a checksum_value, Puppet does not validate that the content it downloads and puts into place matches the mandated checksum. This can cause Puppet to repeatedly re-download the file on every run, constantly reporting success, when in fact it is failing to retrieve the expected content.\r\n\r\nAssume the following manifest.\r\n\r\n{code}\r\nfile { ''/tmp/file'':\r\n  ensure         => file,\r\n  source         => ''http://httpstat.us/200'',\r\n  checksum       => ''sha256'',\r\n  checksum_value => ''ea8fac7c65fb589b0d53560f5251f74f9e9b243478dcb6b3ea79b5e36449c8d9'',\r\n  #checksum_value => ''f9bafc82ba5f8fb02b25020d66f396860604f496ca919480147fa525cb505d88'',\r\n}\r\n{code}\r\n\r\nLet the commented-out f9bafc8 checksum be correct, and ea8fac7 be incorrect.\r\n\r\n*Desired Behavior:*\r\n\r\nWhen Puppet applies this manifest and downloads f9bafc8 from http://httpstat.us/200, it should report failure. The content does not match the checksum_value parameter ea8fac7.\r\n\r\n*Actual Behavior:*\r\n\r\nWhen Puppet applies this manifest, it saves the f9bafc8 file and reports success. On subsequent runs it observes that the f9bafc8 content is present, does not match the required ea8fac7, re-downloads the f9bafc8 content from http://httpstat.us/200, and reports a successful change. It incorrectly reports that it changed the file content to ea8fac7.\r\n\r\nThe current behavior for three consecutive Puppet runs is shown below.\r\n\r\n{code}\r\n[reidmv@reids-mbp:~/Workspace/tmp/puppet-code/] % puppet apply test.pp\r\nNotice: Compiled catalog for reids-macbook-pro.local in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/File[/tmp/file]/ensure: created\r\nNotice: Applied catalog in 0.50 seconds\r\n[reidmv@reids-mbp:~/Workspace/tmp/puppet-code/] % puppet apply test.pp\r\nNotice: Compiled catalog for reids-macbook-pro.local in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/File[/tmp/file]/checksum_value: checksum_value changed ''f9bafc8...'' to ''ea8fac7...''\r\nNotice: Applied catalog in 0.67 seconds\r\n[reidmv@reids-mbp:~/Workspace/tmp/puppet-code/] % puppet apply test.pp\r\nNotice: Compiled catalog for reids-macbook-pro.local in environment production in 0.02 seconds\r\nNotice: /Stage[main]/Main/File[/tmp/file]/checksum_value: checksum_value changed ''f9bafc8...'' to ''ea8fac7...''\r\nNotice: Applied catalog in 0.52 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10368', 'https://github.com/puppetlabs/puppet/pull/8211', '2020-03-13T09:08:57.000-0700', '2021-01-27T18:06:49.000-0800', '2021-01-27T18:06:49.000-0800', 'Resolved', 'doc_reviewed', 2, '0', 7, 156, 105, 2, 'fd12a28fcd7e4f168bc23b6164b72c5a57069037'),
('puppet', 219777, 563394374, 8498, 'Certificate signing request using sha384, sha512 spec test fail', 'We recently added support for following FIPS approved hash algorithms: SHA384, SHA512, SHA224. See PUP-8021\r\n\r\nRelevant spec tests were updated to exercise these new algorithms. However it was found that tests for signing certificate requests using either of sha384 or sha512 fail when run from within spec. Equivalent code when run as a ruby script works fine. \r\n\r\nThis currently is not an issue or is blocking any functionality or flows. However should be investigated and resolved. ', 'https://tickets.puppetlabs.com/browse/PUP-8110', 'https://github.com/puppetlabs/puppet/pull/8498', '2017-10-31T13:39:42.000-0700', '2021-02-01T08:29:07.000-0800', '2021-02-01T08:29:07.000-0800', 'Resolved', '', 2, '0', 1, 4, 10, 1, '5ac86b3375db6810efa09babd40eecf7b6f3b1e4'),
('puppet', 385148, 563634643, 8500, 'puppet facts show --value-only should not display a quoted value', 'When using --value-only to retrieve the value of a fact, the output is quoted:\r\n\r\n{noformat}\r\n[root@void-musicality ~]# puppet facts show os.name --value-only\r\n"RedHat"\r\n{noformat}\r\n\r\nIt should return the unquoted value so that the output can easily be consumed by external automation.', 'https://tickets.puppetlabs.com/browse/PUP-10861', 'https://github.com/puppetlabs/puppet/pull/8500', '2021-01-27T09:35:49.000-0800', '2021-02-05T01:07:31.000-0800', '2021-02-05T01:07:31.000-0800', 'Resolved', 'doc_reviewed', 3, '0', 2, 66, 9, 2, '3a8626fdb17db2a27fd0004418c1aa196d222800'),
('puppet', 383327, 563274414, 8497, 'Slower puppet agent run after agent upgrade to version 6', 'Puppet agent run after upgrading to v6 is taking longer. It’s consistent observation across our all environments. Puppet server was already at v6. So the agent version is the only change. ', 'https://tickets.puppetlabs.com/browse/PUP-10856', 'https://github.com/puppetlabs/puppet/pull/8497', '2021-01-14T23:56:53.000-0800', '2021-02-08T08:48:31.000-0800', '2021-02-08T08:48:31.000-0800', 'Resolved', 'doc_reviewed', 13, '0', 1, 9, 17, 3, '13f828fe0c9849d43b66ce7becf008845334b07a'),
('puppet', 386956, 571276308, 8512, 'Puppet users with forcelocal are no longer idempotent', '*Puppet Version:* 7.4.0 and 6.21.0\r\n*Puppet Server Version:* Masterless to demonstrate issue\r\n*OS Name/Version:* CentOS 7\r\n\r\nDefining a `forcelocal` user results in Puppet constantly wanting to change the GID for the user.\r\n\r\n*Desired Behavior:*\r\n\r\nIdempotent apply of forcelocal user.\r\n\r\n\r\n*Actual Behavior:*\r\n\r\n\r\n{noformat}\r\n[root@23aff6d4a202 /]# cat user-group.pp \r\nuser { ''keycloak'':\r\n  ensure     => ''present'',\r\n  name       => ''keycloak'',\r\n  forcelocal => true,\r\n  shell      => ''/sbin/nologin'',\r\n  gid        => ''keycloak'',\r\n  uid        => undef,\r\n  home       => ''/var/lib/keycloak'',\r\n  managehome => true,\r\n  system     => true,\r\n}\r\ngroup { ''keycloak'':\r\n  ensure     => ''present'',\r\n  name       => ''keycloak'',\r\n  forcelocal => true,\r\n  gid        => undef,\r\n  system     => true,\r\n}\r\n[root@23aff6d4a202 /]# puppet apply user-group.pp \r\nNotice: Compiled catalog for 23aff6d4a202 in environment production in 0.01 seconds\r\nNotice: /Stage[main]/Main/Group[keycloak]/ensure: created\r\nNotice: /Stage[main]/Main/User[keycloak]/ensure: created\r\nNotice: Applied catalog in 0.04 seconds\r\n[root@23aff6d4a202 /]# puppet apply user-group.pp \r\nNotice: Compiled catalog for 23aff6d4a202 in environment production in 0.01 seconds\r\nNotice: /Stage[main]/Main/User[keycloak]/gid: gid changed ''13'' to ''keycloak''\r\nNotice: Applied catalog in 0.02 seconds\r\n\r\n{noformat}\r\n\r\nI am fairly certain the issue resides in this change: https://tickets.puppetlabs.com/browse/PUP-10857', 'https://tickets.puppetlabs.com/browse/PUP-10896', 'https://github.com/puppetlabs/puppet/pull/8512', '2021-02-10T05:36:27.000-0800', '2021-02-15T17:16:19.000-0800', '2021-02-15T17:16:19.000-0800', 'Resolved', 'doc_reviewed', 6, '0', 1, 3, 3, 2, 'afcf284eca68ee10efc11f1a2946fc989c7dbd4c'),
('puppet', 203766, 422162147, 8170, 'HTTPS file sources with non-puppet-trusted certs can''t be used', 'In [PUP-1072] we added support for http and https URL schemes for {{file}} resources'' {{source}} attributes:\r\n\r\n{code}\r\nfile { ''/tmp/myfile'':\r\n  source => ''https://myserver/myfile''\r\n}\r\n{code}\r\n\r\n*UPDATED*\r\n\r\n1. The above works provided the CA certificate that issued the server''s certificate is in the [CA bundle distributed|https://github.com/puppetlabs/puppet-ca-bundle] in puppet-agent packages. There are workarounds to add certificates to puppet''s cert bundle, but those workarounds are lost when the puppet-agent package is updated.\r\n\r\n2. As of Puppet 6.15.0 puppet will trust the puppet CA in addition to puppet''s CA bundle when retrieving file metadata and content via https file sources. So the issue [~chuck] described with {{source => "https://${server_facts[''servername'']}:8140//puppet-ca/v1/certificate/ca?environment=production"}} will be resolved.\r\n\r\n3. This ticket is about a) creating a puppet setting referring to a directory or file containing system CA certs, and b) modifying the {{Puppet::SSL::SSLProvider#create_system_context}} method so that the system CA certs are added to the X509 store via {{OpenSSL::X509::Store#add_path}} (for a directory) or {{OpenSSL::X509::Store#add_file}} (for a file).\r\n\r\n*Original*\r\n\r\nSomehow we failed to realize that the implementation of this feature requires that the remote webserver present a certificate that is trusted by the puppet agent''s SSL configuration. In practice this is extremely unlikely and difficult to configure, and therefore the utility of this feature is pretty limited.\r\n\r\nIn the code, this is because the request ultimately uses the same routines (in {{Puppet::Util::HttpProxy.get_http_object}}) that the agent itself uses, where the SSL verification mode is hardcoded but the certificate store is not.\r\n\r\nThere should be some way to permit retrieval of these files. A couple of options that occured to me as I was tracing this down:\r\n\r\n1.  make the ssl verification mode configurable or disabled by default for file-source retrieval (equivalent to {{curl -k}})\r\n2. use the system-wide trust store instead of puppet''s store\r\n3. expose the certificate trust and verification mode as parameters on the file type (this is truly awful)\r\n\r\n... surely someone else has better ideas ...', 'https://tickets.puppetlabs.com/browse/PUP-7814', 'https://github.com/puppetlabs/puppet/pull/8170', '2017-08-02T14:51:11.000-0700', '2021-02-15T22:21:08.000-0800', '2021-02-15T22:21:08.000-0800', 'Resolved', 'doc_reviewed;jira_escalated', 14, '0', 1, 105, 1, 4, '5c722e8859afc016d9fb8238668ad36ddbf1a90d'),
('puppet', 324095, 316655408, 7713, 'pip provider doesn''t handle arbitrary equality', '*Puppet Version: 5.5.6*\r\n *Puppet Server Version: 5.3.5*\r\n *OS Name/Version: Ubuntu 18.04*\r\n\r\nThe current pip provider doesn''t support Python''s arbitrary equality [https://www.python.org/dev/peps/pep-0440/#arbitrary-equality]\r\n\r\nWhen encountering a python package specified with arbitrary equality via pip freeze, it fails to parse the package and keeps trying to install it\r\n\r\ne.g.\r\n\r\n$ pip freeze | grep pytz\r\n\r\npytz===2012f\r\n\r\n*Desired Behavior: Pip Provider correctly handles arbitrary equality*\r\n\r\n*Actual Behavior: Pip Provider incorrectly handles arbitrary equality*\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10015', 'https://github.com/puppetlabs/puppet/pull/7713', '2019-09-09T14:39:21.000-0700', '2021-02-16T12:24:50.000-0800', '2021-02-16T12:24:50.000-0800', 'Resolved', 'resolved-issue-added', 3, '0', 1, 10, 2, 2, 'c5160ee58ae431054838d89274d3fa785cb66655'),
('puppet', 360365, 426525865, 8183, 'Puppet windows package provider fails if there are garbage characters after an embedded NULL', 'Puppet scans the registry when retrieving the list of currently installed packages. If one of the registry values it scans contains an embedded null followed by garbage, then puppet will try to transcode from UTF-16LE to UTF-8 and may fail.\r\n\r\nA fix for the embedded NULL problem was made in PUP-9639. However, it only works if transcoding succeeds.\r\n\r\nWhen reading package names, versions, etc from the registry puppet should read up to the first wide null or the length of the string, whichever comes first, and remove the sanitize method.\r\n\r\nIf there is a problem reading one of the whitelisted keys, it should print the name of the key in the error message.\r\n\r\nTo reproduce, import the following registry file whose {{DisplayVersion}} is corrupt and try to run puppet:\r\n{noformat}C:\ProgramData\PuppetLabs>type C:\Users\Administrator\Documents\test.reg\r\nWindows Registry Editor Version 5.00\r\n\r\n[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\PUP10536]\r\n"DisplayName"="PUP10536"\r\n"DisplayVersion"=hex(2):31,0,36,0,2e,0,30,0,2e,0,31,0,30,0,33,0,35,0,37,0,2e,0,32,0,30,0,30,0,30,0,32,0,0,0,0,0,0,0,0,0,f3,23,8a,bc,fa,7f,0,0,10,65,74,b9,fa,7f,0,0,90,d8,55,6f,59,0,0,0\r\n\r\nC:\ProgramData\PuppetLabs>reg import C:\Users\Administrator\Documents\test.reg\r\nThe operation completed successfully.\r\n\r\nC:\ProgramData\PuppetLabs>puppet resource package --trace\r\nError: Could not run: "\x90\xD8" followed by "Uo" on UTF-16LE\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/api_types.rb:59:in `encode''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/api_types.rb:59:in `read_wide_string''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:237:in `block in read''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:281:in `block (3 levels) in query_value_ex''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:268:in `initialize''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:268:in `new''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:268:in `block (2 levels) in query_value_ex''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:263:in `initialize''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:263:in `new''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:263:in `block in query_value_ex''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:262:in `initialize''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:262:in `new''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:262:in `query_value_ex''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:225:in `read''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:81:in `block (2 levels) in values_by_name''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/api_types.rb:29:in `block in from_string_to_wide_string''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/api_types.rb:25:in `initialize''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/api_types.rb:25:in `new''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/api_types.rb:25:in `from_string_to_wide_string''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:79:in `block in values_by_name''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:78:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:78:in `values_by_name''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:49:in `block (5 levels) in with_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:28:in `block in open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/win32/registry.rb:439:in `open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/win32/registry.rb:546:in `open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:27:in `open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:48:in `block (4 levels) in with_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:51:in `block in each_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:49:in `loop''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:49:in `each_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:47:in `block (3 levels) in with_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:28:in `block in open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/win32/registry.rb:439:in `open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/2.5.0/win32/registry.rb:546:in `open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/windows/registry.rb:27:in `open''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:46:in `block (2 levels) in with_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:43:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:43:in `block in with_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:42:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:42:in `with_key''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows/package.rb:25:in `each''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows.rb:36:in `map''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/provider/package/windows.rb:36:in `instances''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/type.rb:1205:in `block in instances''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/type.rb:1204:in `collect''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/type.rb:1204:in `instances''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/indirector/resource/ral.rb:24:in `search''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:299:in `search''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/resource.rb:228:in `find_or_save_resources''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/resource.rb:142:in `block in main''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/context.rb:62:in `override''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet.rb:290:in `override''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application/resource.rb:137:in `main''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:390:in `run_command''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `block in run''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util.rb:710:in `exit_on_fail''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/application.rb:382:in `run''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:143:in `run''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:77:in `execute''\r\nC:/Program Files/Puppet Labs/Puppet/puppet/bin/puppet:4:in `<main>''\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10536', 'https://github.com/puppetlabs/puppet/pull/8183', '2020-05-28T12:54:12.000-0700', '2021-02-26T07:34:32.000-0800', '2021-02-26T07:34:32.000-0800', 'Closed', 'doc_reviewed;jira_escalated', 0, '0', 1, 20, 19, 4, '85efd39ec17d73ce9381ee1e551eb185b9ae60a2'),
('puppet', 125405, 116873224, 5814, 'Unable to install a Ruby gem to non-Puppet Ruby stack using the package resource type on Windows', 'Puppet is unable to install a Ruby gem into anything other than Puppet''s Ruby stack on Windows nodes.\r\n\r\nh2. Example of the issue\r\nFor example, say I want to install the {{puppet-lint}} gem so that I can validate Puppet code while writing modules. Normally, I''d install Ruby from http://rubyinstaller.org/ then run {{gem install puppet-lint}}. But, let''s say I wanted to automate that process using Puppet! First, I would install Chocolatey then use Chocolatey to install Ruby:\r\n{code}\r\ninclude chocolatey\r\npackage { ''ruby'':\r\n  ensure   => present,\r\n  provider => ''chocolatey'',\r\n  require  => Class[''chocolatey''],\r\n}\r\n{code}\r\n\r\nThen I''d use the gem provider to install puppet-lint:\r\n{code}\r\npackage { ''puppet-lint'':\r\n  ensure   => present,\r\n  provider => ''gem'',\r\n  require  => Package[''ruby''],\r\n}\r\n{code}\r\n\r\nA {{--debug}} log of that package installation looks like this:\r\n{code}\r\nC:\Users\Administrator>puppet resource package puppet-lint ensure=present provider=gem --debug\r\n(... removing Facter resolution messages ...)\r\nDebug: /Package[puppet-lint]: Provider gem does not support features virtual_packages; not managing attribute allow_virtual\r\nDebug: Loaded state in 0.03 seconds\r\nDebug: Evicting cache entry for environment ''production''\r\nDebug: Caching environment ''production'' (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment ''production''\r\nDebug: Caching environment ''production'' (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment ''production''\r\nDebug: Caching environment ''production'' (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment ''production''\r\nDebug: Caching environment ''production'' (ttl = 0 sec)\r\nDebug: Failed to load library ''selinux'' for feature ''selinux''\r\nDebug: Prefetching gem resources for package\r\nDebug: Executing: ''C:/Program Files/Puppet Labs/Puppet/sys/ruby/bin/gem.bat list --local''\r\nDebug: Finishing transaction 39019400\r\nDebug: Storing state\r\nDebug: Stored state in 0.05 seconds\r\npackage { ''puppet-lint'':\r\n  ensure => [''1.1.0''],\r\n}\r\n{code}\r\n\r\nAfter doing this, the {{puppet-lint}} executable is not available in %PATH%, and {{gem list}} doesn''t show puppet-lint as installed:\r\n{code}\r\nC:\Users\Administrator>puppet-lint\r\n''puppet-lint'' is not recognized as an internal or external command,\r\noperable program or batch file.\r\nC:\Users\Administrator>gem list\r\n\r\n*** LOCAL GEMS ***\r\n\r\nbigdecimal (1.2.6)\r\nio-console (0.4.3)\r\njson (1.8.1)\r\nminitest (5.4.3)\r\npower_assert (0.2.2)\r\npsych (2.0.8)\r\nrake (10.4.2)\r\nrdoc (4.2.0)\r\ntest-unit (3.0.8)\r\n\r\nC:\Users\Administrator>\r\n{code}\r\n\r\n*But*, if I use''s Puppet''s {{gem}} command, I see that puppet-lint got installed into Puppet''s Ruby stack:\r\n{code}\r\nC:\Users\Administrator>"C:\Program Files\Puppet Labs\Puppet\sys\ruby\bin\gem.bat" list\r\n\r\n*** LOCAL GEMS ***\r\n\r\nbigdecimal (1.2.4)\r\ndeep_merge (1.0.1)\r\nffi (1.9.10 x64-mingw32)\r\nio-console (0.4.3, 0.4.2)\r\njson (1.8.1)\r\nminitar (0.5.4)\r\nminitest (4.7.5)\r\npsych (2.0.5)\r\npuppet-lint (1.1.0)\r\nrake (10.1.0)\r\nrdoc (4.1.0)\r\nstomp (1.3.3)\r\ntest-unit (2.1.8.0, 2.1.7.0, 2.1.6.0, 2.1.5.0)\r\nwin32-dir (0.4.9)\r\nwin32-eventlog (0.6.2)\r\nwin32-process (0.7.4)\r\nwin32-security (0.2.5)\r\nwin32-service (0.8.6)\r\n{code}\r\n\r\nh2. Likely Cause\r\nPuppet is putting its bin directory at the start of %PATH% during all invocations of {{puppet}}, which causes the {{gem}} provider to find Puppet''s gem command rather than the gem command I installed via chocolatey.\r\nThis is happening in {{environment.bat}} which {{puppet.bat}} always invokes:\r\n{code}\r\n...\r\nSET PATH=%PUPPET_DIR%\bin;%FACTERDIR%\bin;%HIERA_DIR%\bin;%MCOLLECTIVE_DIR%\bin;%PL_BASEDIR%\bin;%PL_BASEDIR%\sys\ruby\bin;%PL_BASEDIR%\sys\tools\bin;%PATH%\r\n...\r\n{code}\r\n\r\nOn the command line, I can install gems into my Ruby stack from Chocolatey without issue:\r\n{code}\r\nC:\Users\Administrator>where gem\r\nC:\tools\ruby22\bin\gem\r\nC:\tools\ruby22\bin\gem.bat\r\n\r\nC:\Users\Administrator>gem install gist\r\nFetching: gist-4.5.0.gem (100%)\r\nSuccessfully installed gist-4.5.0\r\nParsing documentation for gist-4.5.0\r\nInstalling ri documentation for gist-4.5.0\r\nDone installing documentation for gist after 0 seconds\r\n1 gem installed\r\n\r\nC:\Users\Administrator>gem list --local\r\n\r\n*** LOCAL GEMS ***\r\n\r\nbigdecimal (1.2.6)\r\ngist (4.5.0)\r\nio-console (0.4.3)\r\njson (1.8.1)\r\nminitest (5.4.3)\r\npower_assert (0.2.2)\r\npsych (2.0.8)\r\nrake (10.4.2)\r\nrdoc (4.2.0)\r\ntest-unit (3.0.8)\r\n{code}\r\n\r\nBut when Puppet runs, the %PATH% gets re-written to have Puppet''s BIN dir at the start:\r\n{code}\r\nC:\Users\Administrator>echo %PATH%\r\nC:\ProgramData\chocolatey\bin;C:\tools\ruby22\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\Git\cmd;C:\Program Files (x86)\Git\bin;C:\Program Files\Puppet Labs\Puppet\bin\r\n\r\nC:\Users\Administrator>puppet apply -e "notice($::path)"\r\nNotice: Scope(Class[main]): C:/Program Files/Puppet Labs/Puppet/facter/bin;C:\Program Files\Puppet Labs\Puppet\puppet\bin;C:\Program Files\Puppet Labs\Puppet\facter\bin;C:\Program Files\Puppet Labs\Puppet\hiera\bin;C:\Program Files\Puppet Labs\Puppet\mcollective\bin;C:\Program Files\Puppet Labs\Puppet\bin;C:\Program Files\Puppet Labs\Puppet\sys\ruby\bin;C:\Progr\r\nam Files\Puppet Labs\Puppet\sys\tools\bin;C:\ProgramData\chocolatey\bin;C:\tools\ruby22\bin;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\Git\cmd;C:\Program Files (x86)\Git\bin;C:\Program Files\Puppet Labs\Puppet\bin\r\nNotice: Compiled catalog for pe-201533-agent-win2012 in environment production in 0.03 seconds\r\nNotice: Applied catalog in 0.09 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6134', 'https://github.com/puppetlabs/puppet/pull/5814', '2016-04-06T16:45:58.000-0700', '2021-03-01T15:11:24.000-0800', '2021-03-01T15:11:24.000-0800', 'Resolved', 'cs_pr_review;customer;gem;package;provider;windows', 22, '0', 1, 17, 1, 1, ''),
('puppet', 380551, 553833544, 8479, 'Cached catalog contains the result of deferred evaluation instead of the deferred function', 'The cached catalog contains the result of evaluating the deferred function, instead of the function. So if the agent applies a cached catalog, it will always apply the result of the deferred function when the cached catalog was saved instead of when the agent runs.\r\n\r\nTo reproduce, create:\r\n{code:puppet}cat /etc/puppetlabs/code/environments/production/manifests/site.pp\r\n$epp_var = {\r\n  ''deferred_function'' => Deferred(''to_yaml'', [{''test'' => ''foo''}])\r\n}\r\nfile { ''/tmp/deferred_function.txt'':\r\n  content => Deferred(''inline_epp'', [''<%= $deferred_function -%>'', $epp_var]),\r\n}\r\n{code}\r\nIn 6.11.0, we correctly cache the deferred function:\r\n{noformat}$ cat ~/.puppetlabs/opt/puppet/cache/client_data/catalog/$(facter fqdn).json| jq .\r\n...\r\n  {\r\n      "type": "File",\r\n      "title": "/tmp/deferred_function.txt",\r\n      "tags": [\r\n        "file",\r\n        "class"\r\n      ],\r\n      "file": "/etc/puppetlabs/code/environments/production/manifests/site.pp",\r\n      "line": 4,\r\n      "exported": false,\r\n      "parameters": {\r\n        "content": {\r\n          "__ptype": "Deferred",\r\n          "name": "inline_epp",\r\n          "arguments": [\r\n            "<%= $deferred_function -%>",\r\n            {\r\n              "deferred_function": {\r\n                "__ptype": "Deferred",\r\n                "name": "to_yaml",\r\n                "arguments": [\r\n                  {\r\n                    "test": "foo"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      }\r\n{noformat}\r\nand the file contains the result of evaluating the deferred function:\r\n{noformat}$ cat /tmp/deferred_function.txt\r\n ---\r\ntest: foo\r\n{noformat}\r\nIn 6.12.0 the cached catalog is incorrect:\r\n{noformat}    {\r\n      "type": "File",\r\n      "title": "/tmp/deferred_function.txt",\r\n      "tags": [\r\n        "file",\r\n        "class"\r\n      ],\r\n      "file": "/etc/puppetlabs/code/environments/production/manifests/site.pp",\r\n      "line": 4,\r\n      "exported": false,\r\n      "parameters": {\r\n        "content": "---\ntest: foo\n"\r\n      }\r\n    }\r\n{noformat}\r\nThe bug was introduced in a17761d60b2e5d42cc01a36e1d6ba3d790c9dcf8, as there was a semantic conflict due to the environment convergence changes in 5.5.x and the deferred functionality in 6.x.', 'https://tickets.puppetlabs.com/browse/PUP-10818', 'https://github.com/puppetlabs/puppet/pull/8479', '2020-12-09T11:29:11.000-0800', '2021-03-01T15:30:04.000-0800', '2021-03-01T15:30:04.000-0800', 'Resolved', 'doc_reviewed;jira_escalated', 2, '0', 1, 83, 9, 2, '408bf4e0f9c0cbe52c6b9b6027b2ac91ddd424ac'),
('puppet', 380575, 555286837, 8486, '3x functions cannot be called from deferred functions in puppet agent', '{{sprintf}} is a builtin 3x function. The following works when running {{puppet apply}}:\r\n\r\n{noformat}\r\n[root@keen-lecture ~]# cat /etc/puppetlabs/code/environments/production/manifests/site.pp\r\nnotify { "deferred": message => Deferred("sprintf", ["hello"]) }\r\n[root@keen-lecture ~]# puppet apply /etc/puppetlabs/code/environments/production/manifests/site.pp\r\nNotice: Compiled catalog for keen-lecture.delivery.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: hello\r\nNotice: /Stage[main]/Main/Notify[deferred]/message: defined ''message'' as ''hello''\r\nNotice: Applied catalog in 0.01 seconds\r\n{noformat}\r\n\r\nThe same code doesn''t work when running {{puppet agent}} and gives an unhelpful error:\r\n\r\n{noformat}\r\n[root@keen-lecture ~]# puppet agent -t --trace\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nError: Failed to apply catalog: Function sprintf not defined despite being loaded!\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:1044:in `method_missing''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions.rb:751:in `block in call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions.rb:748:in `catch''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/functions.rb:748:in `call''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:283:in `block in external_call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:282:in `external_call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:1101:in `call_function''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:119:in `resolve_future''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:89:in `resolve''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:71:in `block (2 levels) in resolve_futures''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:70:in `each_pair''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:70:in `block in resolve_futures''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:68:in `each''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:68:in `resolve_futures''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/deferred_resolver.rb:32:in `resolve_and_replace''\r\n{noformat}\r\n\r\nIt seems like we should either present a consistent error that 3x functions can''t be deferred, or allow the agent to load 3x functions in the same way the apply does.\r\n\r\nThe same problem also happens when using a 3x function from a module, eg bool2str from stdlib:\r\n\r\n{noformat}\r\nnotify { "deferred": message => Deferred("bool2str", [true]) }\r\n{noformat}\r\n\r\n{noformat}\r\n[root@keen-lecture ~]# puppet agent -t --trace\r\nInfo: Using configured environment ''production''\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Retrieving locales\r\nInfo: Loading facts\r\nError: Failed to apply catalog: Function bool2str not defined despite being loaded!\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10819', 'https://github.com/puppetlabs/puppet/pull/8486', '2020-12-09T16:35:22.000-0800', '2021-03-01T15:30:10.000-0800', '2021-03-01T15:30:10.000-0800', 'Resolved', 'doc_reviewed', 5, '0', 1, 21, 1, 2, '321f04b2d0fa9b7c7aa3ad63c830b3508c3ff574'),
('puppet', 388276, 585560373, 8530, 'Syntax error in previously valid puppet code due to removal of application orchestration keywords', '*Puppet Version:*\r\n\r\n7.4.1\r\n{noformat}\r\nclass foo (\r\n  $site,\r\n) {\r\n  notice $site\r\n}\r\n\r\nclass { foo:\r\n  site => ''bar'', # syntax error on this line in puppet 7\r\n}{noformat}\r\n \r\n\r\nThe above code works fine in Puppet 4, 5 and 6 despite `site` being on the list of reserved words here. https://puppet.com/docs/puppet/7.4/lang_reserved.html#lang_reserved_words\r\n\r\n*Actual Behavior:*\r\n{noformat}\r\nError: Could not parse for environment production: Syntax error at ''site'' (file: /home/halexfis/test.pp, line: 8, column: 3) on node test{noformat}\r\n[https://puppet.com/docs/puppet/7.4/lang_reserved.html#lang_reserved_words] doesn''t explicitly say you can''t use these words as parameter names, and other examples from that list continue to work fine. (eg. ''node'').\r\n\r\nIt looks like this regression was caused by https://tickets.puppetlabs.com/browse/PUP-10446\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10929', 'https://github.com/puppetlabs/puppet/pull/8530', '2021-02-22T07:15:41.000-0800', '2021-03-10T07:31:15.000-0800', '2021-03-10T07:31:15.000-0800', 'Resolved', 'community;doc_reviewed', 5, '0', 1, 20, 130, 6, '4afb5f0d32fed100f24dd83d181347564794f71e'),
('puppet', 390019, 588437866, 8535, 'The operator ''* =>'' in a Virtual Query is not supported.', 'On Puppet 7.4.1, I get "The operator ''* =>'' in a Virtual Query is not supported." from the following code:\r\n\r\n{noformat}\r\n  $services.each |$key, $value| {\r\n    if defined(Service[$key]) {\r\n      Service <| title == $key |> {\r\n        * => $value,\r\n      }\r\n    } else {\r\n      service { $key:\r\n        * => $value,\r\n      }\r\n    }\r\n  }\r\n{noformat}\r\n\r\nThis seemed to work fine with Puppet 5 and 6.', 'https://tickets.puppetlabs.com/browse/PUP-10951', 'https://github.com/puppetlabs/puppet/pull/8535', '2021-03-04T13:03:36.000-0800', '2021-03-10T12:15:27.000-0800', '2021-03-10T12:15:27.000-0800', 'Resolved', 'doc_reviewed', 5, '0', 1, 10, 1, 2, '916c5a2e9f2ed92f02ed9bfcc9226d9903089eb9'),
('puppet', 239960, 178168234, 6770, 'Puppet should have a way of defining properties or parameters for types as sensitive', 'Currently we have this lovely dance we need to go through if we need to define a parameter or property as sensitive. You can see examples of this in file.rb and exec.rb ([https://github.com/puppetlabs/puppet/commit/abd866a648a32d3895011d25af5d4b3d994669c8]) As it currently works, we can only set a specific instance as sensitive. We should be able to say all instances of a particular property/parameter are sensitive when defining it.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8514', 'https://github.com/puppetlabs/puppet/pull/6770', '2018-03-06T15:30:04.000-0800', '2021-03-11T10:53:09.000-0800', '2021-03-11T10:53:09.000-0800', 'Closed', '', 1, '0', 2, 2, 2, 1, 'f196a6fd6ad70bb1aa1fa28d8f0926e5b0a13305'),
('puppet', 281329, 299132703, 7618, 'Backport sensitive DSL method PUP-8514', 'To use the {{sensitive}} DSL method introduced in PUP-8514, you need to be on Puppet 6 or later. This is a problem if you''re a module author and want to support pre-6 agents. For example the {{puppet_agent}} module used to upgrade agents relies on the {{yumrepo}} resource type, but the {{yumrepo_core}} module cannot be run on pre-6 agents.\r\n\r\nThis ticket is to backport the PUP-8514 to 5.5.x.', 'https://tickets.puppetlabs.com/browse/PUP-9249', 'https://github.com/puppetlabs/puppet/pull/7618', '2018-10-18T17:07:12.000-0700', '2021-03-11T10:54:38.000-0800', '2021-03-11T10:54:38.000-0800', 'Resolved', '', 4, '0', 5, 103, 36, 8, '741604f35393e7ceab74e10b6e654121f88fb7b9'),
('puppet', 22652, 11224129, 2221, 'puppet gem does not include platform specific gem dependencies', 'The puppet gem on windows has dependencies on win32-dir, etc, but these are not expressed in the gemspec file. So if you are developing a module, and attempt to `bundle install`, the transitive dependencies are not satisfied. The same issue exists in facter and hiera.', 'https://tickets.puppetlabs.com/browse/PUP-1282', 'https://github.com/puppetlabs/puppet/pull/2221', '2013-12-30T10:28:53.000-0800', '2021-03-30T08:38:27.000-0700', '2021-03-30T08:38:27.000-0700', 'Closed', 'redmine;windows', 14, '0', 1, 30, 14, 2, '40193c53a4a0f497e6aadc41e9a85b07e9265e4e'),
('puppet', 390822, 598788071, 8550, 'unable to use package task to install gems with puppet_gem provider on Windows', '*Puppet Version: 7.0.0 - 7.5.0*\r\n *Puppet Server Version:* PE 2021\r\n *OS Name/Version: Windows agents*\r\n\r\nAfter the changes done in PUP-10677, the puppet_gem provider is no longer functional on Windows if the {{PUPPET_DIR}} environment variable is not present. The variable is set in environment.bat, which we source when executing puppet.bat and the puppet service.\r\nHowever, if Puppet is used without {{envionment.bat}}, or as a library in a ruby file, the variables may not be present. See https://github.com/puppetlabs/puppetlabs-package/blob/main/tasks/init.rb for an example.\r\n\r\n*Desired Behavior:*\r\n\r\nRunning the package task with the following parameters in PE passes:\r\n\r\nTask parameters:\r\naction: install\r\nname: pry\r\nprovider: puppet_gem\r\n\r\n*Actual Behavior:*\r\n\r\nRunning the task fails with the following:\r\n\r\n{code}\r\nError: Provider puppet_gem package command is not functional on this host\r\n\r\n{\r\n  "status" : "failure"\r\n}\r\n{code}\r\n\r\nNote that the package task has to be executed through PE/Orchestrator in order to be able to specify the {{provider}} parameter. When run on open source installations the task defaults to the powershell implementation which hardcodes choco and does not support setting a custom provider.\r\n\r\nSuggestion: {{Gem.default_bindir}} provides the path to {{gem.bat}}, but we don''t have the certainty that puppet is being run with the system ruby or the vendored ruby.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10964', 'https://github.com/puppetlabs/puppet/pull/8550', '2021-03-12T04:05:47.000-0800', '2021-04-12T08:29:38.000-0700', '2021-04-12T08:29:38.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 2, '0', 1, 40, 1, 2, '63814d6f3c458cfad5c7c91f379a6fb1495a25a9'),
('puppet', 390083, 599097412, 8552, 'Changing a Puppet setting in a catalog invalidates the env cache in multithreaded mode', 'While doing research on new loader architectures for SERVER-2860, I discovered the following:\r\n\r\nIn {{multithreaded}} mode in Puppetserver, we create a new settings object whenever a Puppet setting changes while a JRuby request is being processed. One example is if a Puppet function in a module calls {{Puppet[]=}}. In the process of initializing the new settings object with overrides (for thread safety), we resolve all settings. The {{rich_data}} setting [clears out the environment cache|https://github.com/puppetlabs/puppet/blob/main/lib/puppet/defaults.rb#L2162] when resolved.\r\n\r\nThis means if you are changing any Puppet settings in your catalog, in multithreaded mode environment caching is effectively disabled, because the cache will be invalidated on every compile of the offending environment.\r\n\r\nWe should find out why the hook is being called in the first place when [initializing|https://github.com/puppetlabs/puppetserver/blob/9ecd7fb18cd8e02edcfa9e2130c0b2053e0a3209/src/ruby/puppetserver-lib/puppet/server/settings.rb#L25-L31] the threadlocal settings object (we''re not altering that setting, and the default hook mode is "on_write_only"), and see if we can avoid it.', 'https://tickets.puppetlabs.com/browse/PUP-10952', 'https://github.com/puppetlabs/puppet/pull/8552', '2021-03-04T15:50:48.000-0800', '2021-04-13T05:32:07.000-0700', '2021-04-13T05:32:07.000-0700', 'Resolved', 'doc_reviewed', 2, '0', 2, 16, 9, 3, '40a6a15aa3e994d0da89af4430117dda230478c1'),
('puppet', 388736, 582193174, 8524, '''puppet facts diff'' logs error when apt module is installed', 'Platforms: OS X, Centos 7 (as tested by me), might be on all\r\npupptlabs-apt: 7.7.1(latest)\r\n\r\nStep to reproduce:\r\n- install latest puppet 6\r\n- install puppetlabs-apt module\r\n- run `puppet facts diff`\r\n\r\n\r\n{noformat}\r\n❯ puppet --version\r\n6.21.1\r\n❯ puppet facts diff\r\n{"hypervisors.vmware.version":{"new_value":"ESXi 6.7","old_value":""}}\r\n\r\n❯ puppet module install puppetlabs-stdlib\r\nNotice: Preparing to install into /etc/puppetlabs/code/environments/production/modules ...\r\nNotice: Downloading from https://forgeapi.puppet.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/etc/puppetlabs/code/environments/production/modules\r\n└── puppetlabs-stdlib (v6.6.0)\r\n\r\n❯ puppet facts diff\r\n{"hypervisors.vmware.version":{"new_value":"ESXi 6.7","old_value":""}}\r\n\r\n❯ puppet module install puppetlabs-apt\r\nNotice: Preparing to install into /etc/puppetlabs/code/environments/production/modules ...\r\nNotice: Downloading from https://forgeapi.puppet.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/etc/puppetlabs/code/environments/production/modules\r\n└─┬ puppetlabs-apt (v7.7.1)\r\n  ├── puppetlabs-stdlib (v6.6.0)\r\n  └── puppetlabs-translate (v2.2.0)\r\n\r\n❯ puppet facts diff\r\nE, [2021-02-17T07:14:34.049701 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_package_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.051667 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_package_dist_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.053433 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_package_security_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.055293 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_package_security_dist_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.057133 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.058807 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_dist_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.060489 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_security_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\nE, [2021-02-17T07:14:34.062122 #1797] ERROR -- : Facter - Error while resolving custom fact fact=''apt_security_dist_updates'', resolution=''<anonymous>'': undefined method `[]'' for nil:NilClass\r\n{"hypervisors.vmware.version":{"new_value":"ESXi 6.7","old_value":""}}\r\n\r\n{noformat}\r\n\r\n*/opt/puppetlabs/puppet/bin/facter-ng* does not log any error so most likely it happens when resolving the facts added in puppet form modules.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10940', 'https://github.com/puppetlabs/puppet/pull/8524', '2021-02-24T06:31:56.000-0800', '2021-04-23T11:09:17.000-0700', '2021-04-23T11:09:17.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 1, 9, 7, 2, 'c4cd83a46bef6bfe2bf189fcceeb341a6454961e'),
('puppet', 393433, 605642436, 8555, 'Race condition with agent_disabled_lockfile', '*Puppet Version: Affects all versions*\r\n *Puppet Server Version:*\r\n *OS Name/Version: CentOS 7*\r\n\r\nThis is essentially the same issue as seen in a an old PR which was lost over the years - [https://github.com/puppetlabs/puppet/pull/1158] where rapid or parallel puppet runs can cause an already existing {{agent_disabled_lockfile}} to get truncated \r\n\r\n*Desired Behavior:*\r\n\r\nI do not believe puppet actually needs to be creating a resource for this file, the {{agent_catalog_run_lockfile}} has a setting type of {{string}} for this reason ([https://github.com/puppetlabs/puppet/blob/main/lib/puppet/defaults.rb#L1669]) I''d like to apply the same setting type to {{agent_disabled_lockfile}}\r\n\r\n*Actual Behavior:*\r\n\r\nExamples:\r\n {{puppet agent --test --trace --debug --logdest /root/puppet-debug.log}}\r\n\r\nLockfile being created (grep agent_disabled puppet-debug.log):\r\n\r\nNote: {{File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]/ensure (debug): created}}\r\n{code:java}2021-03-31 10:49:33 +0000 Puppet (debug): Using settings: adding file resource ''agent_disabled_lockfile'': ''File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]{:path=>"/opt/puppetlabs/puppet/cache/state/agent_disabled.lock", :ensure=>:file, :loglevel=>:debug, :links=>:follow, :backup=>false}''\r\n2021-03-31 10:49:34 +0000 /File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]/seluser (debug): Found seluser default ''system_u'' for /opt/puppetlabs/puppet/cache/state/agent_disabled.lock\r\n2021-03-31 10:49:34 +0000 /File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]/selrole (debug): Found selrole default ''object_r'' for /opt/puppetlabs/puppet/cache/state/agent_disabled.lock\r\n2021-03-31 10:49:34 +0000 /File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]/seltype (debug): Found seltype default ''usr_t'' for /opt/puppetlabs/puppet/cache/state/agent_disabled.lock\r\n2021-03-31 10:49:34 +0000 /File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]/selrange (debug): Found selrange default ''s0'' for /opt/puppetlabs/puppet/cache/state/agent_disabled.lock\r\n2021-03-31 10:49:34 +0000 /File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock] (debug): Adding autorequire relationship with File[/opt/puppetlabs/puppet/cache/state]\r\n2021-03-31 10:49:34 +0000 /File[/opt/puppetlabs/puppet/cache/state/agent_disabled.lock]/ensure (debug): created\r\n{code}\r\n Strace from guilty {{puppet agent --test}}\r\n{code:java}428070 10:49:34.313537 open("/opt/puppetlabs/puppet/cache/state/agent_disabled.lock", O_WRONLY|O_CREAT|O_TRUNC|O_CLOEXEC, 0666) = 18</opt/puppetlabs/puppet/cache/state/agent_disabled.lock> <0.000076>\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-11000', 'https://github.com/puppetlabs/puppet/pull/8555', '2021-03-31T04:27:58.000-0700', '2021-04-23T11:09:18.000-0700', '2021-04-23T11:09:18.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 1, 1, 1, 1, '89f3f19c4c11e4a5c77e415cefbc4b7eb6814c60'),
('puppet', 388981, 581106309, 8523, 'Listing environments during code deploys can prevent environment cache invalidation', 'If environments are listed via the {{environment_classes}} REST API while a new environment directory is deployed, it''s possible for the default modulepath to be cached in settings, and cause future compilations with that environment to fail. It''s can also cause agents to randomly delete pluginsync''ed files (due to omissions in the file metadata response).\r\n\r\nOn the puppetserver node, allow access to the REST API to listing and delete environments:\r\n\r\n{code:hocon}\r\n   {\r\n            "allow": "ADD SERVER FQDN",\r\n            "match-request": {\r\n                "method": "delete",\r\n                "path": "/puppet-admin-api/v1/environment-cache",\r\n                "query-params": {},\r\n                "type": "path"\r\n            },\r\n            "name": "puppetlabs environment cache",\r\n            "sort-order": 500\r\n        },\r\n        {\r\n            "allow": "ADD SERVER FQDN",\r\n            "match-request": {\r\n                "method": "get",\r\n                "path": "/puppet/v3/environment_classes",\r\n                "query-params": {},\r\n                "type": "path"\r\n            },\r\n            "name": "puppetlabs environment classes",\r\n            "sort-order": 500\r\n        },\r\n{code}\r\n\r\nThen run:\r\n\r\n{code:bash}\r\n#!/bin/sh\r\n\r\nserver="ADD SERVER NAME HERE"\r\ncertname="${server}"\r\n\r\n# use server cert for privileged REST APIs\r\ncurl_opts="-kf --cert /etc/puppetlabs/puppet/ssl/certs/${server}.pem --key /etc/puppetlabs/puppet/ssl/private_keys/${server}.pem"\r\n\r\napi_environments="https://${server}:8140/puppet/v3/environments"\r\napi_classes="https://${server}:8140/puppet/v3/environment_classes"\r\napi_environment_cache="https://${server}:8140/puppet-admin-api/v1/environment-cache"\r\napi_catalog="https://${server}:8140/puppet/v3/catalog"\r\napi_catalog4="https://${server}:8140/puppet/v4/catalog"\r\n\r\nname="env_${RANDOM}"\r\nbasedir="/etc/puppetlabs/code/environments"\r\nenvdir="${basedir}/${name}"\r\nmkdir -p "${envdir}"\r\nchown puppet:puppet "${envdir}"\r\necho "create random environment: ${name}"\r\n\r\necho "list environments, cache modulepath"\r\ncurl ${curl_opts} -X GET -H ''Accept: application/json'' ${api_environments} | jq .environments.${name}\r\n\r\necho "finish deployment"\r\nenvconf="${envdir}/environment.conf"\r\ncat <<EOF > "${envconf}"\r\nmodulepath=site:dist:\$basemodulepath\r\nEOF\r\n\r\nmkdir "${envdir}/manifests"\r\ncat <<EOF > "${envdir}/manifests/init.pp"\r\ninclude role\r\nEOF\r\n\r\nmkdir "${envdir}/dist"\r\nmkdir -p "${envdir}/site/role/manifests"\r\ncat <<EOF > "${envdir}/site/role/manifests/init.pp"\r\nclass role {\r\n  notify { ''in role'': }\r\n}\r\nEOF\r\nchown -R puppet:puppet "${envdir}"\r\n\r\necho mark environments as expired\r\ncurl ${curl_opts} -X DELETE -H ''Accept: application/json'' ${api_environment_cache}\r\n\r\necho we see the modulepath from before the deploy finished\r\ncurl ${curl_opts} -X GET -H ''Accept: application/json'' ${api_environments} | jq .environments.${name}\r\n\r\necho compile v3 catalog fails\r\ncurl -kf \\r\n --cert "/etc/puppetlabs/puppet/ssl/certs/${certname}.pem" \\r\n --key "/etc/puppetlabs/puppet/ssl/private_keys/${certname}.pem" \\r\n -X POST \\r\n -d "%257B%2522facts_format%2522%253A%2522application%252Fjson%2522%252C%2522facts%2522%253A%257B%2522name%2522%253A%2522${certname}%2522%257D%257D" \\r\n -H ''Content-Type: application/x-www-form-urlencoded'' \\r\n -H ''Accept: application/json'' \\r\n ${api_catalog}/${certname}\?environment\=${name}\r\n{code}\r\n\r\nDue to the bug, we expire all environments, but still see the cached environment''s modulepath and compilation fails:\r\n\r\n{noformat}\r\n...\r\nmark environments as expired\r\nwe see the modulepath from before the deploy finished\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  6900  100  6900    0     0  87341      0 --:--:-- --:--:-- --:--:-- 87341\r\n{\r\n  "settings": {\r\n    "modulepath": [\r\n      "/etc/puppetlabs/code/environments/env_1077/modules",\r\n      "/etc/puppetlabs/code/modules",\r\n      "/opt/puppetlabs/puppet/modules"\r\n    ],\r\n    "manifest": "/etc/puppetlabs/code/environments/env_1077/manifests",\r\n    "environment_timeout": 0,\r\n    "config_version": ""\r\n  }\r\n}\r\ncompile v3 catalog fails\r\ncurl: (22) The requested URL returned error: 500 Server Error\r\n{noformat}\r\n\r\nAnd puppetserver.log contains:\r\n\r\n{noformat}\r\n2021-02-25T20:56:08.058Z ERROR [qtp1507614676-35] [puppetserver] Puppet Server Error: Evaluation Error: Error while evaluating a Function Call, Could not find class ::role for afferent-trot.delivery.puppetlabs.net (file: /etc/puppetlabs/code/environments/env_32225/manifests/init.pp, line: 1, column: 1) on node afferent-trot.delivery.puppetlabs.net\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:401:in `block in evaluate_classes''\r\norg/jruby/RubyArray.java:2572:in `collect''\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:400:in `evaluate_classes''\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-10942', 'https://github.com/puppetlabs/puppet/pull/8523', '2021-02-25T13:51:25.000-0800', '2021-04-23T11:09:18.000-0700', '2021-04-23T11:09:18.000-0700', 'Closed', 'customer0;doc_reviewed', 2, '0', 5, 190, 152, 7, '5c5e09e04da46126605865325b89a2bd235712e7'),
('puppet', 393085, 602531832, 8554, 'User resource with forcelocal and groups attributes set will fail if /etc/group contains empty lines', '*Puppet Version:* 7.4.0 and 6.21.0 (and later)\r\n*Puppet Server Version:* Masterless to demonstrate issue\r\n*OS Name/Version:* CentOS 7\r\n\r\nA user resource with {{forcelocal => true}} and {{groups}} attributes set will fail if {{/etc/group}} contains any empty/blank lines\r\n\r\n{code:bash}# egrep -n ''^$|testuser'' /etc/passwd /etc/group\r\n/etc/passwd:24:testuser:x:1001:1001:testuser:/home/testuser:/bin/bash\r\n/etc/group:41:centos:x:1000:testuser\r\n/etc/group:42:testuser:x:1001:\r\n/etc/group:43:\r\n# grpck -r\r\ninvalid group file entry\r\ndelete line ''''? No\r\ngrpck: no changes\r\n# bundle exec puppet apply -e "user { ''testuser'': groups => [''centos''], forcelocal => true}"\r\nNotice: Compiled catalog for [redacted] in environment production in 0.02 seconds\r\nError: undefined method `split'' for nil:NilClass\r\n#\r\n{code}\r\n\r\nThis is due to [this line|https://github.com/puppetlabs/puppet/blob/896bf34c5f5c3cdd410002490fce51ab45f03322/lib/puppet/provider/user/useradd.rb#L131] in {{localgroup}} method added for PUP-10857 in puppet 6.21.0 / puppet 7.4.0 and later\r\n\r\nThis does not occur in puppet 6.19.1 and earlier (example output from 6.16 agent)\r\n\r\n{code:bash}\r\n# puppet --version\r\n6.16.0\r\n# puppet apply -e "user { ''testuser'': groups => [''centos''], forcelocal => true}"\r\nNotice: Compiled catalog for [redacted] in environment production in 0.04 seconds\r\nNotice: Applied catalog in 0.06 seconds\r\n#\r\n{code}\r\n\r\nWhile empty lines in {{/etc/group}} are technically not valid configuration, the behaviour change is difficult to diagnose as it occurs when the catalog is applied/enforced, and does not return much detail in the error.\r\n\r\n*Desired Behavior:*\r\n\r\nIdeally do not fail when empty lines are encountered, or at least output more detailed failure message.\r\n\r\n*Actual Behavior:*\r\n\r\n{code:ruby}\r\nError: undefined method `split'' for nil:NilClass\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-10997', 'https://github.com/puppetlabs/puppet/pull/8554', '2021-03-29T00:44:43.000-0700', '2021-04-23T11:09:20.000-0700', '2021-04-23T11:09:20.000-0700', 'Resolved', 'doc_reviewed', 1, '0', 2, 19, 4, 2, '76ddcc8503d44e3983a27f296b0ae691c30f2200'),
('puppet', 395286, 614998836, 8569, 'Cannot ensure dnfmodule with no default profile', '*OS Name/Version:* CentOS/RedHat 8\r\n\r\nWhen we added the enable functionality to the dnfmodule provider, we made the following statement: DNF modules that have no default profile (and cannot be installed) will be enabled by default, so there is no need to add {{enable_only}}.\r\n\r\nHowever this does not work anymore with the latest versions of DNF (at least 4.2.23).\r\n Attempting to apply a resource like the following will fail, requiring the user to also add enable_only:\r\n{code}package { ''389-ds'': ensure => present, provider => dnfmodule }\r\n{code}\r\n*Desired Behavior:*\r\n\r\nPuppet should enable the module\r\n\r\n*Actual Behavior:*\r\n\r\nExecution fails and an error message is raised', 'https://tickets.puppetlabs.com/browse/PUP-11024', 'https://github.com/puppetlabs/puppet/pull/8569', '2021-04-14T00:20:06.000-0700', '2021-04-23T11:09:22.000-0700', '2021-04-23T11:09:22.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 1, 11, 2, 2, '3df685a39a5d2b06d4edd8ffb7475656962d5d53'),
('puppet', 389937, 0, 0, 'Puppet cannot parse systemd instances when list-unit-files output has an additional column', '*Puppet Version: 6.21.1/7.4.1*\r\n *Puppet Server Version:* n/a\r\n *OS Name/Version: Fedora 32/Ubuntu 20.04*\r\n\r\nSome time ago the output of {{systemctl list-unit-files}} changed to include an additional column. Previous output (on CentOS 8):\r\n{code}\r\nUNIT FILE                                   STATE          \r\narp-ethers.service                          disabled       \r\nauditd.service                              enabled        \r\nauth-rpcgss-module.service                  static         \r\n{code}\r\n\r\nCurrent output (on Fedora 32 and Ubuntu 20.04):\r\n{code}\r\nUNIT FILE                                  STATE           VENDOR PRESET\r\narp-ethers.service                         disabled        disabled     \r\nauditd.service                             enabled         enabled      \r\nauth-rpcgss-module.service                 static          disabled     \r\n{code}\r\n\r\n*Desired Behavior:*\r\n\r\n{{puppet resource service}} produces a list of services\r\n\r\n*Actual Behavior:*\r\n\r\n{{puppet resource service}} does not print anything\r\n\r\nThe following regex should be updated to allow for both types of output: https://github.com/puppetlabs/puppet/blob/3df444559245c3fd9e3e78f58ade40e256a756ba/lib/puppet/provider/service/systemd.rb#L33', 'https://tickets.puppetlabs.com/browse/PUP-10949', 'https://github.com/puppetlabs/puppet/commit/2f1d0026189964a2b19f94a4d8a3901f66a94ea7', '2021-03-04T07:53:29.000-0800', '2021-04-23T11:09:23.000-0700', '2021-04-23T11:09:23.000-0700', 'Resolved', 'doc_reviewed', 0, '0', 0, 0, 0, 0, '2f1d0026189964a2b19f94a4d8a3901f66a94ea7'),
('puppet', 385667, 0, 0, '''puppet facts show'' gives conversion error on 6.x agent', '*Puppet Version:* 6.20.0\r\n*Puppet Server Version:* 2019.8.x latest\r\n*OS Name/Version:* Centos 7\r\n\r\nWhen running ''puppet facts show <fact_name>'', it seems to always give a conversion error.\r\n{code}\r\n[root@cute-remainder ~]# puppet facts show operatingsystem\r\nError: no implicit conversion of Symbol into Integer\r\nError: Try ''puppet help facts find'' for usage\r\n{code}\r\nAppears to be limited to 6.x, as 7.x is still showing the appropriate fact.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10884', 'https://github.com/puppetlabs/puppet/commit/5c227c9eb264c5974fbce328303271874cbfb71e', '2021-02-01T09:26:38.000-0800', '2021-04-23T11:09:26.000-0700', '2021-04-23T11:09:26.000-0700', 'Resolved', 'doc_reviewed', 3, '0', 0, 0, 0, 0, '5c227c9eb264c5974fbce328303271874cbfb71e'),
('puppet', 88845, 40084463, 4091, 'PMT fails to install modules on Windows that have long paths', 'h1. Description\r\n\r\nIf a user attempts to install the DSC module from the Forge the installation will fail:\r\n\r\n{noformat}Notice: Preparing to install into C:/ProgramData/PuppetLabs/code/environments/production/modules ...\r\nNotice: Downloading from https://forgeapi.puppetlabs.com ...\r\nError: No such file or directory @ rb_sysopen - C:/ProgramData/PuppetLabs/puppet/cache/puppet-module/cache/tmp-unpacker20150713-2868-1k8nayj/puppetlabs-dsc-0.1.1-b20025-dd8e40f3/vendor/DSCResources/xRemoteDesktopSessionHost/DSCResources/MSFT_xRDSessionCollectionConfiguration/MSFT_xRDSessionCollectionConfiguration.schema.mof\r\nError: Try ''puppet help module install'' for usage{noformat}\r\n\r\nh2. Attachments\r\n\r\n* PMT Debug Log\r\n\r\nh2. Repro Steps\r\n\r\n# Install Puppet Agent 1.2.1 on agent node.\r\n# Install "puppetlabs-dsc" module on agent:\r\n{noformat}puppet module install puppetlabs-dsc --module_repository https://api-module-staging.puppetlabs.com{noformat}\r\n\r\nh2. Expect\r\n\r\nThe module should install successfully.\r\n\r\nh2. Actual\r\n\r\nThe module installation fails:\r\n\r\n{noformat}Notice: Preparing to install into C:/ProgramData/PuppetLabs/code/environments/production/modules ...\r\nNotice: Downloading from https://forgeapi.puppetlabs.com ...\r\nError: No such file or directory @ rb_sysopen - C:/ProgramData/PuppetLabs/puppet/cache/puppet-module/cache/tmp-unpacker20150713-2868-1k8nayj/puppetlabs-dsc-0.1.1-b20025-dd8e40f3/vendor/DSCResources/xRemoteDesktopSessionHost/DSCResources/MSFT_xRDSessionCollectionConfiguration/MSFT_xRDSessionCollectionConfiguration.schema.mof\r\nError: Try ''puppet help module install'' for usage{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4854', 'https://github.com/puppetlabs/puppet/pull/4091', '2015-07-13T13:35:16.000-0700', '2021-04-28T04:45:02.000-0700', '2021-04-28T04:45:02.000-0700', 'Closed', 'dsc;windows', 14, '0', 1, 17, 7, 1, '8d2798f9ab02b3ed981fbea2f875b301e70f2ef9'),
('puppet', 397752, 627755244, 8593, 'Systemd not recognized as service_provider on Ubuntu 17 +', '*Puppet Version: 4.10.12*\r\n *Puppet Server Version: 2.8.1*\r\n *OS Name/Version: Ubuntu 20.04 (Focal Fossa)*\r\n\r\nThe service_provider fact is resolved as `debian` on Ubuntu 20 and Puppet 4.10.x. This should be resolved as systemd. In more recent versions of Puppet this is resolved with the notdefaultfor function future-proofing. However for Puppet 4.10.x the versions need to be explicitly specified.\r\n\r\n*Desired Behavior:* \r\n\r\nThe service_provider should be recognized as systemd\r\n\r\n*Actual Behavior:*\r\n\r\nThe service_provider is recognized as debian\r\n\r\n*Examples:*\r\n\r\n$ puppet --version\r\n 4.10.12\r\n\r\n$ facter -p | grep service_provider\r\n service_provider => systemd\r\n\r\n$ hostnamectl | grep "Operating System"\r\n Operating System: Ubuntu 20.04.2 LTS\r\n\r\n \r\n\r\nA PR to fix this issue is available here: \r\n\r\n[https://github.com/puppetlabs/puppet/pull/8593]', 'https://tickets.puppetlabs.com/browse/PUP-11051', 'https://github.com/puppetlabs/puppet/pull/8593', '2021-04-30T09:52:06.000-0700', '2021-04-30T11:12:25.000-0700', '2021-04-30T11:12:25.000-0700', 'Closed', '', 1, '0', 1, 1, 1, 1, ''),
('puppet', 368658, 0, 0, 'Puppet::Util.uri_encode discards ''=''', 'The uri_encode method assumes ''='' characters are key/value delimiters in the query string, which is a problem if the query string contains a base64 encoded signature with trailing padding characters like the following. Note both URI and Addressable preserve the trailing ''='' but puppet does not:\r\n\r\n{noformat}\r\nirb(main):014:0> str = "http://a.com?sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c="\r\n=> "http://a.com?sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c="\r\nirb(main):015:0> Puppet::Util.uri_encode(str)\r\n=> "http://a.com?sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c"\r\nirb(main):016:0> URI.encode(str)\r\n=> "http://a.com?sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c="\r\nirb(main):017:0> Addressable::URI.encode("http://a.com/sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c=")\r\n=> "http://a.com/sig=JaZhcqxT4akJcOwUdUGrQB2m1geUoh89iL8WMag8a8c="\r\n{noformat}\r\n\r\nSee also PUP-10603', 'https://tickets.puppetlabs.com/browse/PUP-10613', 'https://github.com/puppetlabs/puppet/commit/e7887d6db253e0bb1c39b4a8d6a2d8e531a0e948', '2020-08-07T16:49:15.000-0700', '2021-05-03T10:11:41.000-0700', '2021-05-03T10:11:41.000-0700', 'Needs Information', '', 0, '0', 0, 0, 0, 0, 'e7887d6db253e0bb1c39b4a8d6a2d8e531a0e948'),
('puppet', 397685, 626608712, 8587, 'Ruby 3 reports cert hostname mismatch differently', 'If ruby-openssl detects the server''s hostname is mismatched, it passes {{preverify_ok=false}} but sets the X509Store error to {{V_ERR_OK}}. See https://github.com/ruby/openssl/issues/244\r\n\r\nThis was fixed in https://github.com/ruby/openssl/commit/035a04ece237105ba3c91a8db8f81dc81d2dc452 and released in ruby-openssl 2.2.0 which has only been released in Ruby 3.0. As a result, the X509Store error is now correctly set to X509_V_ERR_HOSTNAME_MISMATCH (in openssl 1.1 and up) or X509_V_ERR_CERT_REJECTED. This causes puppet to raise a generic "CertVerifyError" exception instead of the more specific hostname mismatch error.', 'https://tickets.puppetlabs.com/browse/PUP-11045', 'https://github.com/puppetlabs/puppet/pull/8587', '2021-04-29T15:16:46.000-0700', '2021-05-12T10:26:55.000-0700', '2021-05-12T10:26:55.000-0700', 'Resolved', '', 1, '0', 1, 8, 0, 2, 'fd4ee88e1e41abd037e8ebab3a2c0ec63d74bd1f'),
('puppet', 397709, 643565041, 8602, 'Ruby 3 freezes CHILD_STATUS, so it can''t be stubbed', 'Some of our provider tests add expectations to {{$CHILD_STATUS#exitstatus}}, but that is no longer possible in Ruby 3, because it is frozen, leading to:\r\n\r\n{noformat}\r\n       Cannot proxy frozen objects, rspec-mocks relies on proxies for method stubbing and expectations.\r\n{noformat}\r\n\r\nNow that {{Puppet::Util::Execution.execute}} returns a {{ProcessOutput}} containing the exitstatus, there is no reason to continue using {{CHILD_STATUS}}.', 'https://tickets.puppetlabs.com/browse/PUP-11048', 'https://github.com/puppetlabs/puppet/pull/8602', '2021-04-29T15:57:12.000-0700', '2021-05-18T06:54:49.000-0700', '2021-05-18T06:54:49.000-0700', 'Resolved', 'doc-reviewed', 3, '0', 1, 21, 3, 4, 'ab7ac0b9aa353366563276578626ca012e24c794'),
('puppet', 397686, 626613762, 8588, 'Ruby 3 removed URI.escape/unescape', 'Ruby deprecated URI.escape and unescape in 2.x and removed those methods in 3, because they rely on a deprecated URL parser (RFC2396). However, Puppet needs them to convert potentially unsafe characters, like file paths, into valid URLs.', 'https://tickets.puppetlabs.com/browse/PUP-11046', 'https://github.com/puppetlabs/puppet/pull/8588', '2021-04-29T15:29:35.000-0700', '2021-05-18T06:55:30.000-0700', '2021-05-18T06:55:30.000-0700', 'Resolved', 'doc-reviewed', 1, '0', 1, 26, 17, 1, '41dcae71c7d10b9cc3c190897d02c5082ddd2076'),
('puppet', 191580, 615476536, 8570, 'puppet doesn''t specify file type to get default selinux context', 'When creating a new file, puppet finds out the default selinux context with matchpathcon but it''s not specifying the file type what can lead to use the incorrect context (selinux default context depends on file type) and breaks idempotency.\r\n\r\nReproducer:\r\n\r\n{code}\r\n\r\n[root@vmname ~]# cat test.pp \r\nfile {\r\n    ''/etc/systemd/system/redis.service.d'':\r\n       ensure => directory\r\n}\r\n\r\n# puppet apply test.pp \r\nNotice: Compiled catalog for vmname.example.com in environment production in 0.15 seconds\r\nNotice: /Stage[main]/Main/File[/etc/systemd/system/redis.service.d]/ensure: created\r\nNotice: Applied catalog in 0.54 seconds\r\n# ll -Zd /etc/systemd/system/redis.service.d\r\ndrwxr-xr-x. root root system_u:object_r:redis_unit_file_t:s0 /etc/systemd/system/redis.service.d\r\n# puppet apply test.pp \r\nNotice: Compiled catalog for vmname.example.com in environment production in 0.15 seconds\r\nNotice: /Stage[main]/Main/File[/etc/systemd/system/redis.service.d]/seltype: seltype changed ''redis_unit_file_t'' to ''systemd_unit_file_t''\r\nNotice: Applied catalog in 0.51 seconds\r\n[root@vmname ~]# ll -Zd /etc/systemd/system/redis.service.d\r\ndrwxr-xr-x. root root system_u:object_r:systemd_unit_file_t:s0 /etc/systemd/system/redis.service.d\r\n\r\n\r\n{code}\r\n\r\nNote that first run used wrong selinux type for the just created directory.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7559', 'https://github.com/puppetlabs/puppet/pull/8570', '2017-05-17T10:02:27.000-0700', '2021-05-18T07:06:26.000-0700', '2021-05-18T07:06:26.000-0700', 'Resolved', 'doc-reviewed;file;linux;platform-os;selinux;type_and_provider', 6, '0', 2, 106, 12, 4, 'fe9b634f70a1d474ac53029ad9858c95740c80ae'),
('puppet', 397486, 625551717, 8584, 'Unable to ''mask'' a ''static'' systemd service', '*Puppet Version: 7.6.1*\r\n *Puppet Server Version: N/A*\r\n *OS Name/Version: CentOS 8.3*\r\n\r\nI''m trying to translate the following command into Puppet:\r\n{code:java}systemctl stop systemd-coredump.socket\r\nsystemctl mask systemd-coredump.socket{code}\r\nThe Puppet code i''ve written to do this is:\r\n{code:java}service { ''systemd-coredump.socket'':\r\n   ensure => ''stopped'',\r\n   enable => ''mask'',\r\n}{code}\r\n*Desired Behavior:*\r\n\r\nI would expect the service to be stopped and masked.\r\n\r\n*Actual Behavior:*\r\n\r\nThe service is a ''static'' service on the system and is resulting in a debug log being printed:\r\n{code:java}debug - Puppet - Executing: ''/bin/systemctl is-enabled -- systemd-coredump.socket''debug - Puppet - Unable to enable or disable static service systemd-coredump.socket\r\n{code}\r\nRunning the systemctl commands manually, works just fine.\r\n\r\nDoing a little digging, i found the following code:\r\n [https://github.com/puppetlabs/puppet/blob/main/lib/puppet/provider/service/systemd.rb#L42-L56]\r\n\r\nThe comment in the block is accurate, however a little misleading because ''static'' services are allowed to be ''masked''.\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-11034', 'https://github.com/puppetlabs/puppet/pull/8584', '2021-04-28T12:55:43.000-0700', '2021-05-19T05:52:17.000-0700', '2021-05-19T05:52:17.000-0700', 'Closed', 'community;doc-reviewed', 2, '0', 1, 37, 10, 2, '3bf639dc095502e0dbf493f0b21cae1e19c8ba03'),
('puppet', 393117, 614558290, 8566, 'Unable to update UserRightAssignment - Log on as service rights', '*Puppet Version: 2019.8.4*\r\n *Puppet Server Version:*\r\n *OS Name/Version:*\r\n\r\nWe are trying to add an account to the "UserRightAssignment - Log on as service rights" of a Windows agent using the DSC Modules:\r\n\r\ndsc-securitypolicydsc\r\n puppetlabs-pwshlib\r\n\r\nand, at the same time, set a service with the account that just got the "log on as service rights". The manifest code used is:\r\n\r\n \r\n\r\nclass windows_towers { \r\n     dsc_userrightsassignmen\r\n\r\n{ "add-jordi-to-logon-as-service":          dsc_ensure => ''present'',          dsc_policy => ''Log_on_as_a_service'',          dsc_identity => [''NT SERVICE\\ALL SERVICES'',''cloudbase-init'',''jordi''],     }\r\n\r\n    service\r\n\r\n{ ''PlexUpdateService'':          ensure => ''stopped'',          logonaccount => ''PE-201984-WIN2K\\jordi'',          logonpassword => ''puppetpuppet'',          enable => ''false'',          require => Dsc_userrightsassignment[''add-jordi-to-logon-as-service''], }\r\n\r\n}\r\n  \r\n\r\n*Desired Behavior:*\r\n\r\nUpdate the windows service with the new credentials that just got ** "log on as service rights" - Basically, the code above should work first time round.\r\n\r\n*Actual Behavior:*\r\n\r\n \r\n PS C:\Users\Administrator\tester> puppet agent -t\r\n [DEPRECATION] Struct layout is already defined for class Windows::ServiceStructs::SERVICE_STATUS_PROCESS. Redefinition as in C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/win32-service-0.8.8/lib/win32/windows/structs.rb:67:in `<class:SERVICE_STATUS_PROCESS>'' will be disallowed in ffi-2.0.\r\n Info: Using configured environment ''production''\r\n Info: Retrieving pluginfacts\r\n Info: Retrieving plugin\r\n Info: Retrieving locales\r\n Info: Loading facts\r\n Error: Failed to apply catalog: Parameter logonaccount failed on Service[PlexUpdateService]: "PE-201984-WIN2K\jordi" is missing the ''Log On As A Service'' right. (file: /etc/puppetlabs/code/environments/production/site/windows_towers/manifests/init.pp, line: 16)\r\n\r\nThe error is indicating that the account selected doesn''t have "log on as service rights" but, in fact, the account has not been added to the "log on as service rights" User Rights assignment and it is failing at compilation.\r\n\r\nAlternatively, if you comment out the service part of the code, the user gets added to the "log on as service rights" and, at this stage, the code will work as expected.\r\n class windows_towers { \r\n    dsc_userrightsassignment\r\n\r\n{ "add-jordi-to-logon-as-service":        dsc_ensure => ''present'',        dsc_policy => ''Log_on_as_a_service'',        dsc_identity => [''NT SERVICE\\ALL SERVICES'',''cloudbase-init'',''jordi''],    }\r\n\r\n   #service\r\n\r\n{ ''PlexUpdateService'':        # ensure => ''stopped'',        # logonaccount => ''PE-201984-WIN2K\\jordi'',        #logonpassword => ''puppetpuppet'',        # enable => ''false'',        # require => Dsc_userrightsassignment[''add-jordi-to-logon-as-service''],    #}\r\n\r\n}\r\n PS C:\Users\Administrator\tester> puppet agent -t\r\n [DEPRECATION] Struct layout is already defined for class Windows::ServiceStructs::SERVICE_STATUS_PROCESS. Redefinition as in C:/Ruby25-x64/lib/ruby/gems/2.5.0/gems/win32-service-0.8.8/lib/win32/windows/structs.rb:67:in `<class:SERVICE_STATUS_PROCESS>'' will be disallowed in ffi-2.0.\r\n Info: Using configured environment ''production''\r\n Info: Retrieving pluginfacts\r\n Info: Retrieving plugin\r\n Info: Retrieving locales\r\n Info: Loading facts\r\n Info: Caching catalog for pe-201984-win2k.platform9.puppet.net\r\n Info: Applying configuration version ''1617025583''\r\n Notice: /Stage[main]/Windows_towers/Dsc_userrightsassignment[add-jordi-to-logon-as-service]/dsc_identity: dsc_identity changed [''PE-201984-WIN2K\cloudbase-init'', ''NT SERVICE\ALL SERVICES''] to [''NT SERVICE\ALL SERVICES'', ''cloudbase-init'', ''jordi'']\r\n Notice: dsc_userrightsassignment[\\\\{:name=>"add-jordi-to-logon-as-service", :dsc_policy=>"Log_on_as_a_service"}|file://%7B:name%3D%3E%22add-jordi-to-logon-as-service%22%2C%20:dsc_policy%3D%3E%22log_on_as_a_service%22%7D/]: Updating: Finished in 2.36 seconds\r\n Notice: Applied catalog in 3.77 seconds\r\n\r\nI have worked with Michael Lombardi on https://tickets.puppetlabs.com/browse/MODULES-10969 created on the back of [https://puppetlabs.zendesk.com/agent/tickets/43304] that has determined that the error experienced is generated by [https://github.com/puppetlabs/puppet/blob/main/lib/puppet/type/service.rb#L152] and stops catalog compilation\r\n\r\nMichael has also suggested that the current validation be turned into a warning or placed in the provider and called during {{set method}}\r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-10999', 'https://github.com/puppetlabs/puppet/pull/8566', '2021-03-29T07:58:43.000-0700', '2021-05-19T05:53:01.000-0700', '2021-05-19T05:53:01.000-0700', 'Resolved', 'doc-reviewed;jira_escalated', 1, '0', 1, 292, 186, 5, '0fb5ec5bf1d4ec5e29cd291241b86043969cd49d'),
('puppet', 341249, 370176968, 7958, 'Puppet incorrectly detecting stale pidfile', '*Puppet Version: 6.11.1*\r\n*Puppet Server Version: 6.11.1*\r\n*OS Name/Version: CentOS 7*\r\n\r\nWhen Puppet agent is incorrectly terminated (eg. killed by KILL signal) it might have a problem in detecting stale PID file. The code in question is this:\r\n\r\n{code:ruby|title=puppet/lib/ruby/vendor_ruby/puppet/util/pidlock.rb}\r\ndef clear_if_stale\r\n    begin\r\n      Process.kill(0, lock_pid)\r\n    rescue *errors\r\n      return @lockfile.unlock\r\n    end\r\n\r\n    if Puppet.features.posix?\r\n      procname = Puppet::Util::Execution.execute(["ps", "-p", lock_pid, "-o", "comm="]).strip\r\n      args     = Puppet::Util::Execution.execute(["ps", "-p", lock_pid, "-o", "args="]).strip\r\n      @lockfile.unlock unless procname =~ /ruby/ && args =~ /puppet/ || procname =~ /puppet(-.*)?$/\r\n    elsif Puppet.features.microsoft_windows?\r\n      # On Windows, we''re checking if the filesystem path name of the running\r\n      # process is our vendored ruby:\r\n      exe_path = Puppet::Util::Windows::Process::get_process_image_name_by_pid(lock_pid)\r\n      @lockfile.unlock unless exe_path =~ /\\bin\\ruby.exe$/\r\n    end\r\n{code}\r\n\r\n*Process.kill(0, pid)* tries to find out if process with certain pid exists. The problem is that Process.kill checks regular processes as well as LightWeight Processes (LWP), so it will verify if certain process or lightweight process currently exists. If it exists it will try to find the name of the command for it. Unfortunately ps -p command only cares about processes and not LightWeight Processes, so if stale file contains PID of LWP Puppet will never be able to recover (unless we remove stale lock file) as LWP usually are spawned by long running daemons. Please find an attached patch (tested on CentOS7) which addresses the above issue: it makes sure ps command also considers LWPs otherwise you might run into error shown below. \r\n\r\n*Desired Behavior:*\r\n\r\nPuppet agent starts up and runs correctly.\r\n\r\n*Actual Behavior:*\r\n{noformat}\r\n# puppet agent --test\r\nError: Could not run Puppet configuration client: Execution of ''ps -p 2181 -o comm='' returned 1: \r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-10218', 'https://github.com/puppetlabs/puppet/pull/7958', '2020-01-07T00:44:36.000-0800', '2021-05-19T08:24:38.000-0700', '2021-05-19T08:24:38.000-0700', 'Resolved', 'resolved-issue-added', 5, '0', 1, 64, 22, 2, '3f9541c54f095706fcf4e02a432161159954a897'),
('puppet', 287004, 254796158, 7400, 'Puppet sets permissions for Puppet files every run', '*Puppet Version:* 2018.1.5, 2019.0.1\r\n*OS Name/Version:* Windows 2012 R2, 2016, 2019\r\n\r\nFile permissions for Puppet files are being set to the same value every run:\r\n\r\n{code}\r\nResource	Event	Changed from	Changed to\r\n\r\nFile[C:\ProgramData/PuppetLabs/puppet/cache/state/package_inventory_enabled] \r\nFile: /opt/puppetlabs/puppet/modules/puppet_enterprise/manifests/profile/agent.pp Line: 89 \r\nCorrective change	\r\n0674 \r\n664\r\n\r\nFile[C:\ProgramData/PuppetLabs/pxp-agent/etc/pxp-agent.conf] \r\nFile: /opt/puppetlabs/puppet/modules/puppet_enterprise/manifests/pxp_agent.pp Line: 105 \r\nCorrective change	\r\n0670 \r\n660\r\n{code}\r\n\r\n\r\nThis seems to target package_inventory_enabled most frequently. Every run the permission is set from 0674 to 0664, which would seem to correspond with documentation requirements (https://puppet.com/docs/puppet/6.0/resources_file_windows.html#how-nix-modes-map-to-windows-permissions):\r\n\r\n{panel}\r\nThe group can’t have higher permissions than the owner. Other users can’t have higher permissions than the owner or group. (That is, 0640 and 0755 are supported, but 0460 is not.)\r\n{panel}\r\n\r\n\r\nHowever the next agent run shows the value has reverted and needs to be set again. It appears that removing the file often - but not always - resolves the issue.', 'https://tickets.puppetlabs.com/browse/PUP-9337', 'https://github.com/puppetlabs/puppet/pull/7400', '2018-11-30T10:48:07.000-0800', '2021-05-23T20:13:50.000-0700', '2021-05-23T20:13:50.000-0700', 'Closed', 'escalation;jira_escalated;resolved-issue-added', 19, '0', 4, 246, 29, 5, '7bfb9de58aa5c8c120050e600c41bd22b9031c83'),
('puppet', 397708, 626620244, 8589, 'Ruby 3 removed webrick', 'Ruby 3 removed webrick and sorted set. We rely on the former in rspec tests and rely on the latter to keep track of resources during catalog application.', 'https://tickets.puppetlabs.com/browse/PUP-11047', 'https://github.com/puppetlabs/puppet/pull/8589', '2021-04-29T15:35:14.000-0700', '2021-06-01T18:45:20.000-0700', '2021-06-01T18:45:20.000-0700', 'Resolved', '', 2, '0', 3, 19, 9, 2, '2728508de029d87de417bb99f2c8232e42466f1f'),
('puppet', 388985, 587726996, 8533, 'Windows package provider continues to read DisplayVersion key after embedded NULL', 'When scanning for existing packages in Windows, Puppet reads uninstall listings in the "per-machine" and "current user" contexts, both 32 and 64 bit using the DisplayName or, more rarely, the QuietDisplayName keys. If these keys have an embedded Null, the package provider continues to read garbage data. It may attempt to decode these junk characters from UTF-16LE and fail.\r\n\r\nAn update was pushed out to fix this (PUP-10536), but a customer recently hit the bug again. This is a followup to that ticket.', 'https://tickets.puppetlabs.com/browse/PUP-10943', 'https://github.com/puppetlabs/puppet/pull/8533', '2021-02-25T14:38:59.000-0800', '2021-06-06T19:11:51.000-0700', '2021-06-06T19:11:51.000-0700', 'Resolved', 'doc_reviewed;jira_escalated', 1, '0', 1, 7, 1, 2, '8953b3b7044c093755cf889deb19522cd30fb3c4'),
('puppet', 22927, 562168930, 8494, 'Class names that match the node name are not evaluated', 'If I setup:\r\n\r\n{code:puppet}\r\nclass subversion {\r\n  warning("I am class subversion")\r\n}\r\n{code}\r\n\r\nand in my nodes.pp I have\r\n\r\n{code}\r\nnode subversion { include subversion }\r\n{code}\r\n\r\nWhen i run puppet in verbose mode on subversion, I never see that warning.  ', 'https://tickets.puppetlabs.com/browse/PUP-1357', 'https://github.com/puppetlabs/puppet/pull/8494', '2014-01-03T11:37:50.000-0800', '2021-06-09T13:20:34.000-0700', '2021-06-09T13:20:34.000-0700', 'Closed', 'redmine', 11, '0', 1, 14, 1, 2, ''),
('puppet', 30995, 649664288, 8607, 'FreeBSD service provider does not support rc.d files with profiles', 'Puppet freebsd service provider (lib/puppet/provider/service/freebsd.rb) doesn''t support FreeBSD start scripts with profiles. \r\n\r\nExample:\r\nNO PROFILES:\r\n{noformat}\r\n/usr/local/etc/rc.d/nagios rcvar\r\n# nagios\r\n#\r\nnagios_enable="YES"\r\n#   (default: "")\r\n{noformat}\r\n\r\nWITH PROFILES:\r\n{noformat}\r\n/usr/local/etc/rc.d/fcgiwrap  rcvar\r\n===> fcgiwrap profile: nagios\r\n# fcgiwrap\r\n#\r\nfcgiwrap_enable="YES"\r\n#   (default: "")\r\n{noformat}\r\n\r\nWITH *MULTIPLE* PROFILES (mockup):\r\n{noformat}\r\n/usr/local/etc/rc.d/fcgiwrap  rcvar\r\n===> fcgiwrap profile: nagios1\r\n# fcgiwrap\r\n#\r\nfcgiwrap_enable="YES"\r\n#   (default: "")\r\n\r\n===> fcgiwrap profile: nagios2\r\n# fcgiwrap\r\n#\r\nfcgiwrap_enable="YES"\r\n#   (default: "")\r\n\r\n===> fcgiwrap profile: nagios3\r\n# fcgiwrap\r\n#\r\nfcgiwrap_enable="YES"\r\n#   (default: "")\r\n\r\n{noformat}\r\n\r\nThe following puppet function will not work even with a single profile present, as it does not handle the "profile heading": ===> fcgiwrap profile: nagios\r\n\r\n{code}\r\n  # Executing an init script with the ''rcvar'' argument returns\r\n  # the service name, rcvar name and whether it''s enabled/disabled\r\n  def rcvar\r\n    rcvar = execute([self.initscript, :rcvar], :failonfail => true, :combine => false, :squelch => false)\r\n    rcvar = rcvar.split("\n")\r\n    rcvar.delete_if {|str| str =~ /^#\s*$/}\r\n    rcvar[1] = rcvar[1].gsub(/^\$/, '''')\r\n    rcvar\r\n  end\r\n{code}\r\n\r\nAdding {noformat}rcvar.delete_if {|str| str =~ /^===*$/}{noformat} will help a bit, but there is a case where it will get confused - if the first profile is set to not enabled in rc.conf.d/someservice file, regardless if any other is set to enabled, this function will determine that service should be disabled as it only checks the first "enable", and there will be multiple "enable" lines with multiple profiles. It should ideally check all occurrences of <someservice>_enable and, if at least one is set to "YES", enable the entire thing and let the actual start script handle what to start and what not to start. Or maybe it should just skip the entire process if rc.conf.d file is already a puppet managed resource? But it doesn''t have to be.\r\n\r\nI am using my own rc.conf.d/<service> file (obviously needed to configure profiles, but they could be configured in /etc/rc.conf file as well) and with freebsd provider I get this error: *Could not evaluate: rcvar value is empty*, as obviously it''s trying to check the first line and it happens to be the profile header starting with ===>, and there''s no <service>_enable string there.\r\n\r\nAs a "workaround" I use bsd service provider, that at least doesn''t error, but it seems to just skip the entire process if rc.conf.d/<service> file is already present. Which might or might not be the desired behavior.', 'https://tickets.puppetlabs.com/browse/PUP-2153', 'https://github.com/puppetlabs/puppet/pull/8607', '2014-04-03T17:45:17.000-0700', '2021-06-09T15:33:48.000-0700', '2021-06-09T15:33:48.000-0700', 'Ready for Merge', '', 3, '0', 1, 1, 0, 1, ''),
('puppet', 220019, 150330538, 6333, 'Service provider ''redhat'' does not correctly detect enabled state of ''boot.*'' services on SLES 11.', 'Service provider ''redhat'' does not correctly detect enabled state of ''boot.*'' services on SLES 11.\r\n\r\nPull request: https://github.com/puppetlabs/puppet/pull/6333\r\n\r\nSLES 11 has a list of Sys V services beginning with the string ''boot.'' that do not behave like other services when {{chkconfig}} is run against them. To illustrate:\r\n{code:bash}\r\n$ cat /etc/SuSE-release\r\nSUSE Linux Enterprise Server 11 (x86_64)\r\nVERSION = 11\r\nPATCHLEVEL = 3\r\n\r\n# Service is running\r\n$ /sbin/service boot.kdump status\r\nkdump kernel loaded\r\n                                                                                                                                                                                                                                 running\r\n\r\n# chkconfig shows ''B''\r\n$ /sbin/chkconfig boot.kdump\r\nboot.kdump  B\r\n\r\n# Only appears when --allservices is specified\r\n$ /sbin/chkconfig --list | grep kdump\r\n$ /sbin/chkconfig --list --allservices | grep kdump\r\nboot.kdump                0:off  1:off  2:off  3:off  4:off  5:off  6:off  B:on\r\n\r\n# Compare with "normal" service\r\n$ /sbin/service ntp status\r\n...\r\n\r\nChecking for network time protocol daemon (NTPD):                                                                                                                                                                                running\r\n\r\n# chkconfig shows ''on'', not ''B''\r\n$ /sbin/chkconfig ntp\r\nntp  on\r\n{code}\r\n\r\nThe provider script ({{puppet/lib/puppet/provider/service/redhat.rb}}) uses the following function to test whether a service is enabled.\r\n{code:ruby}\r\n  def enabled?\r\n    name = @resource[:name]\r\n\r\n    begin\r\n      output = chkconfig name\r\n    rescue Puppet::ExecutionFailure\r\n      return :false\r\n    end\r\n\r\n    # For Suse OS family, chkconfig returns 0 even if the service is disabled or non-existent\r\n    # Therefore, check the output for ''<name>  on'' to see if it is enabled\r\n    return :false unless Facter.value(:osfamily) != ''Suse'' || output =~ /^#{name}\s+on$/\r\n\r\n    :true\r\n  end\r\n{code}\r\n\r\nIt accounts for the fact that SLES, unlike RHEL, returns a zero return code in the event that a service is disabled or nonexistent:\r\n{code:bash}\r\n$ /sbin/chkconfig asdf\r\nasdf: unknown service\r\n$ echo $?\r\n0\r\n{code}\r\n\r\nThis doesn''t trigger the {{rescue}} block with its {{false}} return value as a disabled or nonexistent service would for RHEL.\r\n\r\nSo, if the OS family is not ''Suse'' and we didn''t hit the {{rescue}} block, it returns {{true}}. If the OS family is ''Suse'', {{output}} must contain the service name followed by {{''on''}} in order for it to return {{true}}. As we''ve seen above, the {{boot.*}} services print an output of {{<service_name> B}} and thus return {{false}} even when enabled.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8114', 'https://github.com/puppetlabs/puppet/pull/6333', '2017-11-02T01:55:44.000-0700', '2021-06-09T15:57:42.000-0700', '2021-06-09T15:57:42.000-0700', 'Closed', 'community', 7, '0', 1, 8, 2, 2, '71bde8d2260fbdbb5436f4c58f92ca7fede7fdd9'),
('puppet', 80006, 41377515, 4121, 'With a systemd masked service: ''enable=true ensure=running'' doesn''t work on CentOS with default selinux rules', 'See [~kurt.wall]''s comment in PUP-1253 for more details. This is a followon to that ticket.\r\n\r\nPing [~peiriannydd] who worked on the original feature, and [~melissa] who was looking into systemd issues on jessie/vivid (and has a patch that might tie in to this).\r\n\r\nAssigned to RelEng scrum team since Melissa is currently working those tickets. And guessed at 2 story points.', 'https://tickets.puppetlabs.com/browse/PUP-4605', 'https://github.com/puppetlabs/puppet/pull/4121', '2015-05-13T12:13:54.000-0700', '2021-06-09T16:12:52.000-0700', '2021-06-09T16:12:52.000-0700', 'Closed', 'linux;platform-os;service;systemd;type_and_provider', 6, '0', 1, 11, 2, 2, '65b6a894c5704414c8452976aef38cbe111e2888'),
('puppet', 81478, 262045198, 7429, 'systemd service provider starts/enables in the wrong order', 'The systemd provider for the service resource type seems to always start a service before enabling it. This behavior does not work for the rsyslog service. Enabling the rsyslog service must happen before starting it because enabling it creates symlinks for syslog.service to rsyslog.service. Those are necessary for the syslog.socket unit to work properly which is again required by rsyslog.service. Thus starting rsyslog.service is not possible, before it has been enabled.\r\n\r\nHow to reproduce:\r\n\r\n1. Prepare environment\r\n$ systemctl stop rsyslog.service\r\n$ systemctl stop syslog.socket\r\n$ systemctl disable rsyslog.service\r\n$ systemctl is-active rsyslog.service\r\nunknown\r\n$ systemctl is-enabled rsyslog.service\r\ndisabled\r\n\r\n2. Try to activate rsyslog through puppet (will fail)\r\n$  puppet apply --debug --execute ''service { "rsyslog.service": ensure => ''running'', enable => true, provider => ''systemd'' }''\r\n\r\n3. Activate rsyslog manually (how puppet should do it)\r\n$ systemctl enable rsyslog.service\r\n$ systemctl start rsyslog.service\r\n\r\nThe relevant log messages from step 2. are:\r\n\r\nDebug: Executing ''/bin/systemctl is-active rsyslog.service''\r\nDebug: Executing ''/bin/systemctl is-enabled rsyslog.service''\r\nDebug: Executing ''/bin/systemctl start rsyslog.service''\r\nError: Could not start Service[rsyslog.service]: Execution of ''/bin/systemctl start rsyslog.service'' returned 1: A dependency job for rsyslog.service failed. See ''journalctl -xn'' for details.\r\nError: /Stage[main]/Main/Service[rsyslog.service]/ensure: change from stopped to running failed: Could not start Service[rsyslog.service]: Execution of ''/bin/systemctl start rsyslog.service'' returned 1: A dependency job for rsyslog.service failed. See ''journalctl -xn'' for details.\r\n\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4651', 'https://github.com/puppetlabs/puppet/pull/7429', '2015-05-26T08:02:30.000-0700', '2021-06-09T18:36:00.000-0700', '2021-06-09T18:36:00.000-0700', 'Closed', 'help_wanted;linux;platform-os;service;systemd;type_and_provider', 5, '0', 1, 1, 3, 1, ''),
('puppet', 238529, 175055252, 6738, 'Ubuntu 16.10 _AND NEWER_ use systemd provider as default', '*Puppet Version:*\r\n *Puppet Server Version:*\r\n *OS Name/Version:*\r\n\r\nDetection of systemd fails on Ubuntu releases higher than 16.10\r\n\r\n*Desired Behavior:*\r\n\r\ndisabling/enabling services should work as normal also on Ubuntu 17.04 and up.\r\n\r\nAs one can see here:\r\n\r\n[https://github.com/puppetlabs/puppet/commit/ef342d4ced9bf7aa0489005119bf80a298d094f2]\r\n\r\nUbuntu is only supported up to 16.10 - why is this hardcoded in like this, instead of saying Ubuntu with releases from 15.04 and up use systemd, while those below use sysc-rc - the problem is now that puppet tries to use sysv-rc on Ubuntu 17.04 and up as well. \r\n\r\n*Actual Behavior:*\r\n\r\n \r\n\r\n \r\n\r\n{{ubuntu1710 ~ # puppet resource service ipmievd enable=''false''}}\r\n{{dpkg: error: --compare-versions takes three arguments: <version> <relation> <version>}}{{Type dpkg --help for help about installing and deinstalling packages [*];}}\r\n{{Use ''apt'' or ''aptitude'' for user-friendly package management;}}\r\n{{Type dpkg -Dhelp for a list of dpkg debug flag values;}}\r\n{{Type dpkg --force-help for a list of forcing options;}}\r\n{{Type dpkg-deb --help for help about manipulating *.deb files;}}{{Options marked [*] produce a lot of output - pipe it through ''less'' or ''more'' !}}\r\n{{Notice: /Service[ipmievd]/enable: enable changed ''true'' to ''false''}}\r\n{{service \{ ''ipmievd'':}}\r\n{{   enable => ''true'',}}\r\n{{}}}\r\n{{ubuntu1710 ~ # lsb_release -a}}\r\n{{No LSB modules are available.}}\r\n{{Distributor ID: Ubuntu}}\r\n{{Description: Ubuntu 17.10}}\r\n{{Release: 17.10}}\r\n{{Codename: artful}}\r\n{{ubuntu1710 ~ #}}\r\n\r\n \r\n\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-8495', 'https://github.com/puppetlabs/puppet/pull/6738', '2018-02-27T07:46:22.000-0800', '2021-06-09T19:03:06.000-0700', '2021-06-09T19:03:06.000-0700', 'Closed', 'community;type_and_provider', 11, '0', 1, 2, 2, 2, 'd47ec210fc28f8caac9c9c36d940c12cb8878ff4'),
('puppet', 394276, 614773205, 8567, 'Running `bundle exec rake/rspec spec` has failures on main branch', 'Running the Puppet specs using {{bundle exec rspec spec}} or {{bundle exec rake spec}} consistently produces these failures: https://gist.github.com/pcarlisle/42b9792d2f1d997d24c7f6736bfb8473. We can reproduce this in both a mac and a linux environment.\r\n\r\nWhen those files are run individually or when using the {{parallel_spec}} rake task, nothing fails. So it would appear there''s some kind of order dependent issue that''s not getting picked up by Travis, which uses {{parallel_spec}}.', 'https://tickets.puppetlabs.com/browse/PUP-11022', 'https://github.com/puppetlabs/puppet/pull/8567', '2021-04-06T12:32:17.000-0700', '2021-06-10T00:28:23.000-0700', '2021-06-10T00:28:23.000-0700', 'Resolved', 'tech-debt', 2, '0', 4, 49, 35, 6, 'f6c6fac000abf3a6346c23cfb0bc9bac0f1ccff2'),
('puppet', 96887, 0, 0, 'Remove Solaris 10 conditional logic from beaker tests', 'Tests tests/config/apply_file_metadata_specified_in_config.rb, tests/resource/file/symbolic_modes.rb, and acceptance/tests/ticket_9862_puppet_runs_without_service_user_or_group_present.rb are disabled on Solaris 10 in PR https://github.com/puppetlabs/puppet/pull/4219.\r\n\r\nThe simplest approach to fixing them is to install stat on the Solaris 10 test VMs.\r\n\r\nAlternatively, we could change the stat helper to\r\n{code}\r\n      def stat(host, path)\r\n        owner, group, mode =\r\n          if host[''platform''] =~ /solaris-10/\r\n            stats = on(host, "ls -ld #{path}").stdout.split\r\n            mode = (0..8).inject(0) do |m, i|\r\n              if stats[0][i+1] =~ /[rwxst]/\r\n                m + 2**(8-i)\r\n              else\r\n                m\r\n              end\r\n            end\r\n            if stats[0][3] == ''s''\r\n              mode += 04000\r\n            end\r\n            if stats[0][6] =~ /[lsS]/\r\n              mode += 02000\r\n            end\r\n            if stats[0] =~ /[tT]/\r\n              mode += 01000\r\n            end\r\n            [stats[2], stats[3], mode.to_s(8)]\r\n          else\r\n            stat_command = case host[''platform'']\r\n                           when /osx/\r\n                             "stat -f ''%Su:%Sg:%p''"\r\n                           else\r\n                             "stat --format ''%U:%G:%a''"\r\n                           end\r\n\r\n            permissions = on(host, "#{stat_command} #{path}").stdout.chomp\r\n            permissions.split('':'')\r\n          end\r\n\r\n        puts owner, group, mode\r\n        [owner, group, mode.to_i(8) & 07777]\r\n      end\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5200', 'https://github.com/puppetlabs/puppet/commit/9c072073a596dc4ac06a68e98367d5f56c69c560', '2015-09-04T11:01:51.000-0700', '2021-06-10T22:00:18.000-0700', '2021-06-10T22:00:18.000-0700', 'Closed', 'QA;platform-os', 2, '0', 0, 0, 0, 0, '9c072073a596dc4ac06a68e98367d5f56c69c560'),
('puppet', 85755, 38286710, 4043, '`puppet agent arg` silently eats arguments and runs the agent', 'In general, `puppet <thing> help` tends to provide help text. This seems to be entirely accidental, because `puppet <thing> help` calls `puppet thing` with the argument `help`, which is invalid in many cases.\r\n\r\n`puppet agent help` silently launches the agent in the background and provides no help text. If one accidentally types `puppet agent disable` instead of `puppet agent --disable`, the changes one wanted to avoid applying are instead immediately applied.\r\n\r\nIt would be awesome if `puppet agent` died, preferably loudly, if called with extra arguments.', 'https://tickets.puppetlabs.com/browse/PUP-4776', 'https://github.com/puppetlabs/puppet/pull/4043', '2015-06-22T15:11:38.000-0700', '2021-06-10T23:25:04.000-0700', '2021-06-10T23:25:04.000-0700', 'Closed', '', 5, '0', 1, 7, 0, 2, 'e9597443d34ad728e7de78283826137c99a90854');
