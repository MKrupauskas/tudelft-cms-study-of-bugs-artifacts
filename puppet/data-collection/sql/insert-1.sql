INSERT INTO `bugs_fixes` (`system`, `issue_id`, `pull_request_id`, `number`, `title`, `body`, `issue_url`, `pull_request_url`, `created_at`, `closed_at`, `updated_at`, `state`, `labels`, `comments`, `comments_url`, `commits`, `additions`, `deletions`, `changed_files`, `commits_data`, `bug_report_url`, `bug_fix_url`) VALUES
('puppet', 38559, 61644666, 4755, 'RHEL7 traditional services should have provider "redhat" not "init"', 'I"ve been digging through the catalog post-compile and I noticed the following pattern. For all services that are in systemd, they have the provider "systemd". However, all services that are in the legacy /etc/init.d space are registered with the "init" provider even though they are clearly registered in chkconfig.\r\n\r\nI"m a bit worried about this since it seems that something is potentially wrong with the provider load order which would be endemic of other issues.\r\n\r\n{code:yaml}\r\n!ruby/object:Puppet::Resource\r\n  type: Service\r\n  title: netconsole\r\n  tags: \r\n    - service\r\n    - netconsole\r\n  parameters: \r\n    !ruby/sym ensure: !ruby/sym stopped\r\n# This should be "redhat"!\r\n    !ruby/sym provider: !ruby/sym init\r\n    !ruby/sym hasstatus: !ruby/sym "true"\r\n    !ruby/sym path: \r\n      - /etc/init.d\r\n    !ruby/sym pattern: netconsole\r\n    !ruby/sym loglevel: !ruby/sym notice\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2744', 'https://github.com/puppetlabs/puppet/pull/4755', '2014-06-09T13:29:48.000-0700', '2016-07-26T15:53:19.000-0700', '2016-07-26T15:53:19.000-0700', 'Closed', 'catalog;compile;redhat7;service', 9, '0', 1, 4, 2, 1, 'd7470152d0b1c71f393e36475d5982078cc12a24', 'https://tickets.puppetlabs.com/browse/PUP-2744', 'https://github.com/puppetlabs/puppet/pull/4755'),
('puppet', 133541, 76421421, 5090, 'new function (String): not all string-based conversions respect width and precision', 'Certain conversions to {{String}} using the {{new}} function respect width and precision of the format argument while some others do not.\r\n\r\nExamples:\r\n\r\n{code}\r\nnotice String(undef, "%.1p")\r\nnotice String(undef, "%#.1p")\r\nnotice String(default, "%.1p")\r\nnotice String(true, "%.2s")\r\nnotice String(true, "%.2y")\r\n{code}\r\n\r\nThis outputs:\r\n\r\n{code}\r\nNotice: Scope(Class[main]): u\r\nNotice: Scope(Class[main]): "\r\nNotice: Scope(Class[main]): default\r\nNotice: Scope(Class[main]): true\r\nNotice: Scope(Class[main]): yes\r\n{code}\r\n\r\nExpected output:\r\n\r\n{code}\r\nNotice: Scope(Class[main]): u\r\nNotice: Scope(Class[main]): "\r\nNotice: Scope(Class[main]): d\r\nNotice: Scope(Class[main]): tr\r\nNotice: Scope(Class[main]): ye\r\n{code}\r\n\r\nThe width and precision in a format should be consistently respected.', 'https://tickets.puppetlabs.com/browse/PUP-6346', 'https://github.com/puppetlabs/puppet/pull/5090', '2016-05-24T00:04:32.000-0700', '2016-07-27T08:38:21.000-0700', '2016-07-27T08:38:21.000-0700', 'Closed', '', 2, '0', 1, 40, 21, 2, '174043a688e6b284e6cf75ab270a689e825e7e84', 'https://tickets.puppetlabs.com/browse/PUP-6346', 'https://github.com/puppetlabs/puppet/pull/5090'),
('puppet', 132014, 76399246, 5089, 'Numeric.new (and subtypes) does not accept whitespace between sign and leading digit', 'The following Puppet code:\r\n\r\n{code}\r\nnotice Integer.new("+ 1")\r\n{code}\r\n\r\nresults in the following error:\r\n\r\n{code}\r\nError while evaluating a Function Call, invalid value for Integer(): "+ 1"\r\n{code}\r\n\r\nExpected this to print:\r\n\r\n{code}\r\nNotice: Scope(Class[main]): 1\r\n{code}\r\n\r\nThe problem is the whitespace between the sign and the leading digit in the number; we support it for arithmetic {{String}} to {{Integer}} conversions (e.g. {{notice "+ 1" + "- 1"}} results in {{0}}), so I expect {{Integer.new}} to be consistent with that conversion.\r\n\r\n*Note: this also affects {{Float.new}} (and by extension {{Numeric.new}}).*', 'https://tickets.puppetlabs.com/browse/PUP-6314', 'https://github.com/puppetlabs/puppet/pull/5089', '2016-05-16T17:13:13.000-0700', '2016-07-27T08:38:21.000-0700', '2016-07-27T08:38:21.000-0700', 'Closed', '', 2, '0', 1, 79, 4, 3, 'f26634d7fbf554cf96bb7bd7f0367a4e8f7efd9b', 'https://tickets.puppetlabs.com/browse/PUP-6314', 'https://github.com/puppetlabs/puppet/pull/5089'),
('puppet', 133542, 76456666, 5091, 'new function (String): programmatic representation escapes for Ruby language and not Puppet', 'Conversions to {{String}} using the {{new}} function with the {{%p}} format escapes characters for the Ruby language and not the Puppet language.\r\n\r\n{code}\r\nnotice String("foo#{bar}", "%p")\r\nnotice String("\u{1b}", "%p")\r\nnotice String("$foobar", "%p")\r\n{code}\r\n\r\nOutputs:\r\n\r\n{code}\r\nNotice: Scope(Class[main]): "foo\#{bar}"\r\nNotice: Scope(Class[main]): "\e"\r\nNotice: Scope(Class[main]): "$foobar"\r\n{code}\r\n\r\nExpected output:\r\n\r\n{code}\r\nNotice: Scope(Class[main]): "foo#{bar}"\r\nNotice: Scope(Class[main]): "\u{1b}"\r\nNotice: Scope(Class[main]): "\$foobar"\r\n{code}\r\n\r\nIn the first example, {{#{...\}}} should not be escaped as has no semantic meaning in Puppet.\r\n\r\nIn the second example, {{\e}} is not a valid escape character in Puppet.  We should probably be outputting {{\u{...\}}} for ASCII control characters that do not already have an escape representation in Puppet.\r\n\r\nIn the third example, {{$}} needs to be escaped as it starts interpolation in Puppet (like {{#{...\}}} would need to be in Ruby).\r\n\r\nThis is a result of using {{Kernel#format}} to output the programmatic representation;  there needs to be an implementation that conforms to Puppet strings and not Ruby strings. \r\n', 'https://tickets.puppetlabs.com/browse/PUP-6347', 'https://github.com/puppetlabs/puppet/pull/5091', '2016-05-24T00:14:15.000-0700', '2016-07-27T08:38:21.000-0700', '2016-07-27T08:38:21.000-0700', 'Closed', '', 2, '0', 2, 143, 78, 5, '32cdaec209d669a41095b8e4bea433f3a33c23e9', 'https://tickets.puppetlabs.com/browse/PUP-6347', 'https://github.com/puppetlabs/puppet/pull/5091'),
('puppet', 139586, 75964809, 5078, 'Accessing a required parameter that is unassigned causes bad error message', 'I ran into this error trying to include a PE profile class that happened to inherit a class that was already defined in the PE console. This is the minimal repro of the root issue.\r\n\r\nGiven the following site.pp:\r\n\r\n{code:java}\r\nclass breaking (\r\n    String $first,\r\n    String $second = $first,\r\n){}\r\n\r\nnode default {\r\n  include breaking\r\n}\r\n{code}\r\n\r\nThe expected error would be that the required parameter is missing.  But instead the following error happens:\r\n\r\n{noformat}\r\nError: Could not retrieve catalog from remote server: Error 400 on SERVER: Evaluation Error: Error while evaluating a Resource Statement, default expression for $second tries to illegally access not yet evaluated $first at /etc/puppetlabs/code/environments/production/manifests/site.pp:31:3 on node master.puppetlabs.vm\r\n{noformat}\r\n\r\n\r\nTo repro the original issue, start with a stock PE master and add `include puppet_enterprise::profile::mcollective::peadmin` to the default node group. The unnecessary inheritance caused that issue, but the error message pointed to the root issue in puppet with the parameter evaluation order.', 'https://tickets.puppetlabs.com/browse/PUP-6463', 'https://github.com/puppetlabs/puppet/pull/5078', '2016-06-30T12:56:11.000-0700', '2016-07-27T08:42:07.000-0700', '2016-07-27T08:42:07.000-0700', 'Closed', '', 4, '0', 1, 32, 11, 5, 'cce1d5959de1c7c24a4845a9610768126ca6d3c2', 'https://tickets.puppetlabs.com/browse/PUP-6463', 'https://github.com/puppetlabs/puppet/pull/5078'),
('puppet', 75425, 33402677, 3825, 'Regression: Windows service provider fails to retrieve current state on 2003', 'As a result of this issue, using Live Management to return a list of services on 2003 will fail.\r\n\r\nUsing puppet-agent-1.0.0-x86.msi on win2003r2-i386:\r\n\r\n{noformat}\r\nC:\Program Files\Puppet Labs\Puppet\bin>puppet resource service --trace\r\nError: Could not run: The system call level is not correct. - QueryServiceConfig2: The system call level is not correct.\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/win32-service-0.8.6/lib/win32/windows/helper.rb:36:in `raise_windows_error"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/win32-service-0.8.6/lib/win32/service.rb:1380:in `get_config2_info"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/win32-service-0.8.6/lib/win32/service.rb:1092:in `block in services"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/win32-service-0.8.6/lib/win32/service.rb:1037:in `upto"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/win32-service-0.8.6/lib/win32/service.rb:1037:in `services"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/service/windows.rb:104:in `instances"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/type.rb:1143:in `block in instances"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/type.rb:1136:in `collect"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/type.rb:1136:in `instances"\r\n{noformat}\r\n\r\nStrangely, I can manage a single service resource, just not enumerate all services, or retrieve the current state for a single service:\r\n\r\n{noformat}\r\nC:\Program Files\Puppet Labs\Puppet\bin>puppet resource service wuauserv\r\nError: Could not run: The system call level is not correct. - QueryServiceConfig\r\n2: The system call level is not correct.\r\n\r\nC:\Program Files\Puppet Labs\Puppet\bin>puppet resource service wuauserv ensure=stopped\r\nNotice: /Service[wuauserv]/ensure: ensure changed "running" to "stopped"\r\nservice { "wuauserv":\r\n  ensure => "stopped",\r\n}\r\n\r\nC:\Program Files\Puppet Labs\Puppet\bin>puppet resource service wuauserv ensure=running\r\nNotice: /Service[wuauserv]/ensure: ensure changed "stopped" to "running"\r\nservice { "wuauserv":\r\n  ensure => "running",\r\n}\r\n{noformat}\r\n\r\nThis is not an issue on 2008r2-x86_64 with either puppet-agent-1.0.0-x86 or x64:\r\n\r\n{noformat}\r\nC:\Windows\system32>puppet resource service wuauserv\r\nservice { "wuauserv":\r\n  ensure => "running",\r\n  enable => "true",\r\n}\r\n\r\nC:\Windows\system32>ruby --version\r\nruby 2.1.5p273 (2014-11-13 revision 48405) [i386-mingw32]\r\n{noformat}\r\n\r\nh2. QA Risk Analysis\r\n| Probability | Medium (but how many sites are still running 2003?) |\r\n| Impact | High (invalid data in catalog)\r\n| Risk Level | Medium |\r\n| Test Level | Unit |', 'https://tickets.puppetlabs.com/browse/PUP-4390', 'https://github.com/puppetlabs/puppet/pull/3825', '2015-04-09T15:14:44.000-0700', '2016-07-29T14:06:29.000-0700', '2016-07-29T14:06:29.000-0700', 'Closed', 'windows', 13, '0', 1, 2, 2, 1, 'b9c6b9b5f471ab709858178d82c8af59d545714f', 'https://tickets.puppetlabs.com/browse/PUP-4390', 'https://github.com/puppetlabs/puppet/pull/3825'),
('puppet', 101668, 48301790, 4365, 'Evaluating instance match with Optional[T] and NotUndef[T] fails when T is a string value', '{{Optional[T]}} and {{NotUndef[T]}}, where T is a instance of a string, should behave like {{Optional[Enum[T]]}} and {{NotUndef[Enum[T]]}}, respectively.\r\n\r\nThe following evaluates to false as expected:\r\n\r\n{code}\r\nnotice(5 =~ Optional[Enum[foo]])\r\n{code}\r\n\r\nHowever, this produces an error:\r\n\r\n{code}\r\nnotice(5 =~ Optional[foo])\r\n{code}\r\n\r\nOutput:\r\n{code}\r\nError: Evaluation Error: Error while evaluating a "=~" expression, undefined method `instance?" for "foo":String at site.pp:1:10 on node peterhu-osx\r\n{code}\r\n\r\nThere may be other operations on {{Optional[string]}} and {{NotUndef[string]}} that result in similar exceptions.', 'https://tickets.puppetlabs.com/browse/PUP-5381', 'https://github.com/puppetlabs/puppet/pull/4365', '2015-10-14T14:27:44.000-0700', '2016-08-03T16:18:02.000-0700', '2016-08-03T16:18:02.000-0700', 'Closed', '', 3, '0', 1, 15, 5, 2, '78288e3cdbf2a1f102d352862e9748cf4255acec', 'https://tickets.puppetlabs.com/browse/PUP-5381', 'https://github.com/puppetlabs/puppet/pull/4365'),
('puppet', 21568, 777131565, 8810, 'Service Provider "init" does not detect correct location for script directory on AIX - Patch included', 'The correct directory for init scripts on aix is "/etc/rc.d/init.d"\r\n\r\nThis has not been implemented in the "init" service provider.\r\n\r\nThe fix is very simple (2 lines of code). The attached fix is derived from the github/puppetlabs/puppet master branch.', 'https://tickets.puppetlabs.com/browse/PUP-1134', 'https://github.com/puppetlabs/puppet/pull/8810', '2013-12-17T06:51:36.000-0800', '2016-08-11T09:56:35.000-0700', '2016-08-11T09:56:35.000-0700', 'Closed', 'client-onboarding;redmine', 1, '0', 3, 47, 17, 5, '34e45ab3f562d1029bfeaafe9a11757ea3b3e92c', 'https://tickets.puppetlabs.com/browse/PUP-1134', 'https://github.com/puppetlabs/puppet/pull/8810'),
('puppet', 24514, 74736435, 5046, 'Puppet help silently exits when an application fails to load', 'The help face-based application only rescues Puppet::Errors when trying to display help for each installed application. If an application, e.g. from a module, has a dependency on a gem that is not installed, then puppet help silently exits with 1:\r\n\r\n{noformat}\r\n0 ~/work/puppet (master)  $ be puppet module install msopentech-windowsazure\r\nNotice: Preparing to install into /Users/josh/.puppet/modules ...\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/Users/josh/.puppet/modules\r\n└── msopentech-windowsazure (v1.1.1)\r\n0 ~/work/puppet (master)  $ be puppet help\r\n1 ~/work/puppet (master)  $\r\n{noformat}\r\n\r\nSomething like this seems to fix the problem, though faces seems to only rescue Puppet::Errors in other places as well:\r\n\r\n{noformat}\r\ndiff --git a/lib/puppet/face/help.rb b/lib/puppet/face/help.rb\r\nindex 44380ab..713d57e 100644\r\n— a/lib/puppet/face/help.rb\r\n+++ b/lib/puppet/face/help.rb\r\n@@ -140,7 +140,9 @@ Detail: "#{detail.message}"\r\nbegin\r\nface = Puppet::Face[appname, :current]\r\nresult << [appname, face.summary]\r\nrescue Puppet::Error\r\n+ rescue SystemExit,NoMemoryError\r\n+ raise\r\n+ rescue Exception => e\r\nresult << [ "! # {appname}\r\n", "! Subcommand unavailable due to error. Check error logs."\r\nend\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-1512', 'https://github.com/puppetlabs/puppet/pull/5046', '2014-01-24T09:34:43.000-0800', '2016-08-11T09:56:37.000-0700', '2016-08-11T09:56:37.000-0700', 'Closed', '', 1, '0', 2, 72, 13, 2, '59bfb501b1d2965bcd91a05b6aba417741eff1df', 'https://tickets.puppetlabs.com/browse/PUP-1512', 'https://github.com/puppetlabs/puppet/pull/5046'),
('puppet', 32543, 74313660, 5029, 'Attributes attribute will not accept a single value for the User resource in AIX', 'This seems to be a bug specific to AIX. When you pass a single value within the attributes array in a User resource:\r\n\r\n{code}\r\nuser { "existinguser":\r\n  ensure     => present,\r\n  attributes => ["rlogin=false"],\r\n  home       => "/home/existinguser",\r\n}  \r\n{code}\r\n\r\n\r\nIt throws the following error upon applying the change:\r\n\r\n{code}\r\n"Error: /User[root]: Could not evaluate: undefined methodmap" for "rlogin=false":String"`\r\n{code}\r\n\r\nThe only workaround I have managed is to add another value to the attributes array.', 'https://tickets.puppetlabs.com/browse/PUP-2316', 'https://github.com/puppetlabs/puppet/pull/5029', '2014-04-21T21:41:50.000-0700', '2016-08-11T09:56:37.000-0700', '2016-08-11T09:56:37.000-0700', 'Closed', 'client-onboarding', 4, '0', 1, 8, 0, 2, '35ee154656da7e30b729afac5b014e6878ad5ce8', 'https://tickets.puppetlabs.com/browse/PUP-2316', 'https://github.com/puppetlabs/puppet/pull/5029'),
('puppet', 139496, 76990836, 5106, 'pip package provider with "ensure => latest" displays version change when there is none (problem parsing the output string in some cases)', 'When using \r\n  package {"virtualenv":\r\n    ensure   => latest,\r\n    provider => "pip",\r\n  }\r\n\r\nThe return string from " pip install --upgrade virtualenv " is """\r\nInstalled version (15.0.2) is most up-to-date (past versions: 15.0.2, 15.0.2, 15.0.1, 15.0.1, 15.0.0, 15.0.0, 14.0.6, 14.0.6, 14.0.5, 14.0.5, 14.0.4, 14.0.4, 14.0.3, 14.0.3, 14.0.2, 14.0.2, 14.0.1, 14.0.1, 14.0.0, 14.0.0, 13.1.2, 13.1.2, 13.1.1, 13.1.1, 13.1.0, 13.1.0, 13.0.3, 13.0.3, 13.0.2, 13.0.2, 13.0.1, 13.0.1, 13.0.0, 13.0.0, 12.1.1, 12.1.1, 12.1.0, 12.1.0, 12.0.7, 12.0.7, 12.0.6, 12.0.5, 12.0.5, 12.0.4, 12.0.4, 12.0.2, 12.0.2, 12.0.1, 12.0.1, 12.0, 12.0, 1.11.6, 1.11.6, 1.11.5, 1.11.4, 1.11.4, 1.11.3, 1.11.3, 1.11.2, 1.11.2, 1.11.1, 1.11.1, 1.11, 1.10.1, 1.10, 1.9.1, 1.9, 1.8.4, 1.8.3, 1.8.2, 1.8.1, 1.8, 1.7.2, 1.7.1.2, 1.7.1.1, 1.7.1, 1.7, 1.6.4, 1.6.3, 1.6.2, 1.6.1, 1.6, 1.5.2, 1.5.1, 1.5, 1.4.9, 1.4.8, 1.4.7, 1.4.6, 1.4.5, 1.4.4, 1.4.3, 1.4.2, 1.4.1, 1.4, 1.3.4, 1.3.3, 1.3.2, 1.3.1, 1.3, 1.2, 1.1, 1.0, 0.9.2, 0.9.1, 0.9, 0.8.4, 0.8.3, 0.8.2, 0.8.1, 0.8)\r\n"""\r\n\r\nThis makes package provider print this string every single time puppet runs: """\r\nensure changed "15.0.2" to "1.5"\r\n"""\r\n\r\nThough nothing actually changed on the server. I tracked the issue up to:\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/provider/package/pip.rb#L158\r\n\r\nWhere I guess for some reason the 1.5 version is taken instead of the 15.0.2, probably due to some sorting as "." is after "5".', 'https://tickets.puppetlabs.com/browse/PUP-6461', 'https://github.com/puppetlabs/puppet/pull/5106', '2016-06-30T07:14:28.000-0700', '2016-08-11T09:58:41.000-0700', '2016-08-11T09:58:41.000-0700', 'Closed', 'client-onboarding', 2, '0', 1, 18, 2, 2, '3ef997711cb3d0e16bc6f7871611be73e20e7cb4', 'https://tickets.puppetlabs.com/browse/PUP-6461', 'https://github.com/puppetlabs/puppet/pull/5106'),
('puppet', 132707, 70736794, 4975, 'Puppet module tool should handle invalid paths better', 'When you install a module that contains file paths valid on the platform that it was built on, but not the platform it"s being installed on, PMT fails with an inscrutable error. In hindsight, it"s obvious, but the error messaging could be better about what went wrong.\r\n\r\n{code}\r\nPS C:\Users\Administrator> puppet module install trlinkin/domain_membership\r\nNotice: Preparing to install into C:/ProgramData/PuppetLabs/code/environments/pr\r\noduction/modules ...\r\nNotice: Downloading from https://forgeapi.puppetlabs.com ...\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nFailed to add /C=US/O=GeoTrust Inc./CN=GeoTrust Global CA\r\nError: Could not install package\r\n  Package attempted to install file into\r\n  "trlinkin-domain_membership-1.1.0/:78" under "C:/Users/ADMINI~1/AppData/Local/\r\nTemp/cache/tmp20160519-2896-bnlxhg".\r\n{code}\r\n\r\nThe problem is that {{:78}} is an invalid filename. The actual error is something more like {{mkdir : The given path"s format is not supported.}}', 'https://tickets.puppetlabs.com/browse/PUP-6327', 'https://github.com/puppetlabs/puppet/pull/4975', '2016-05-19T10:46:12.000-0700', '2016-08-11T09:58:41.000-0700', '2016-08-11T09:58:41.000-0700', 'Closed', '', 0, '0', 1, 5, 5, 2, '0d003fb31d7090b28253e576a6363276e71dcb74', 'https://tickets.puppetlabs.com/browse/PUP-6327', 'https://github.com/puppetlabs/puppet/pull/4975'),
('puppet', 138588, 75143861, 5056, 'directoryservice user provider crashes if no ShadowHashData is found', 'Possibly related to [link PUP-6410|https://tickets.puppetlabs.com/browse/PUP-6410], if the {{user/directoryservice}} provider"s {{get_attribute_from_dscl}} method returns {{nil}} when trying to fetch {{ShadowHashData}}, the whole thing explodes.\r\n\r\nWe"ve only seen this rarely, and only when the provider"s trying to read an empty username (which is probably another bug that should be handled).\r\n\r\n{code}\r\nDebug: Prefetching directoryservice resources for user\r\nDebug: Executing: "/usr/bin/dscl -plist . readall /Users"\r\nDebug: Executing: "/usr/bin/dscl -plist . read /Users// ShadowHashData"\r\nDebug: Failed with NoMethodError on : #<NoMethodError: undefined method `elements" for nil:NilClass>\r\nDebug: Executing: "/usr/bin/dscl -plist . readall /Groups"\r\nDebug: Storing state\r\nDebug: Stored state in 0.00 seconds\r\nError: Failed to apply catalog: undefined method `empty?" for nil:NilClass\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/user/directoryservice.rb:144:in `generate_attribute_hash"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/user/directoryservice.rb:87:in `block in instances"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/user/directoryservice.rb:86:in `collect"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/user/directoryservice.rb:86:in `instances"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/user/directoryservice.rb:73:in `prefetch"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/transaction.rb:305:in `prefetch"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/transaction.rb:205:in `prefetch_if_necessary"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/transaction.rb:97:in `block in evaluate"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/graph/relationship_graph.rb:116:in `call"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/graph/relationship_graph.rb:116:in `traverse"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/transaction.rb:142:in `evaluate"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/resource/catalog.rb:222:in `block in apply"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/log.rb:155:in `with_destination"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/transaction/report.rb:118:in `as_logging_destination"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/resource/catalog.rb:221:in `apply"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/configurer.rb:171:in `block in apply_catalog"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util.rb:223:in `block in benchmark"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util.rb:222:in `benchmark"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/configurer.rb:170:in `apply_catalog"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/configurer.rb:315:in `run_internal"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/configurer.rb:186:in `block in run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/context.rb:65:in `override"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet.rb:240:in `override"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/configurer.rb:185:in `run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application/apply.rb:350:in `apply_catalog"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application/apply.rb:274:in `block in main"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/context.rb:65:in `override"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet.rb:240:in `override"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application/apply.rb:225:in `main"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application/apply.rb:170:in `run_command"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application.rb:344:in `block in run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util.rb:540:in `exit_on_fail"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application.rb:344:in `run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/command_line.rb:128:in `run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/Library/GoogleCorpSupport/bin/puppet:5:in `<main>"\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6437', 'https://github.com/puppetlabs/puppet/pull/5056', '2016-06-24T09:57:54.000-0700', '2016-08-11T09:58:42.000-0700', '2016-08-11T09:58:42.000-0700', 'Closed', '', 3, '0', 1, 28, 1, 2, '723e5b88b449b200ab4f52a45654b71a26041d85', 'https://tickets.puppetlabs.com/browse/PUP-6437', 'https://github.com/puppetlabs/puppet/pull/5056'),
('puppet', 137472, 74108174, 5026, 'static_compiler: symlinks in recursed directories don"t work', 'When using the {{static_compiler}} terminus with a resource definition like the following:\r\n\r\n{code}\r\n    file { "/tmp/somedir":\r\n        ensure  => directory,\r\n        owner   => "root",\r\n        group   => "root",\r\n        links   => "manage",\r\n        mode    => "0644",\r\n        recurse => true,\r\n        source  => "puppet:///modules/mymodule/somedir/",\r\n    }\r\n{code}\r\n\r\nWhen the source directory contains a symlink, catalog application aborts because the symlink has no target:\r\n\r\n{code}\r\nError: /Stage[main]/Mymodule::Myclass/File[/tmp/somedir/foo]/ensure: change from absent to link failed: Cannot create a symlink without a target\r\n{code}\r\n\r\nI have a patch for this bug that I will send in via GitHub shortly. Unfortunately, writing an rspec test to check for this condition is beyond my grasp of Ruby.', 'https://tickets.puppetlabs.com/browse/PUP-6415', 'https://github.com/puppetlabs/puppet/pull/5026', '2016-06-16T08:54:14.000-0700', '2016-08-11T09:58:43.000-0700', '2016-08-11T09:58:43.000-0700', 'Closed', '', 7, '0', 2, 5, 2, 1, 'a2c5e3f0f5c1e38d681f00a48bd806dc0c95617c', 'https://tickets.puppetlabs.com/browse/PUP-6415', 'https://github.com/puppetlabs/puppet/pull/5026'),
('puppet', 112835, 78138246, 5130, 'Poor error reporting when metadata.json is incorrect or incomplete', 'If you have a module with a misformed metadata.json file you will get the following error when doing:\r\n\r\n{code}\r\npuppet apply -e "include aptmirror"\r\nError: Evaluation Error: Error while evaluating a Function Call, Class[Aptmirror]: expects a value for parameter "nthreads"  at line 1:1 on node ubuntu.localdomain\r\n{code}\r\n\r\nIn this case I removed a comma from the metadata.json file. If I add a --debug I do get a debug message but it is not an error:\r\n{code}\r\nDebug: aptmirror has an invalid and unparsable metadata.json file.  The parse error: 757: unexpected token at\r\n{code}\r\n\r\nThe debug message when the metadata.json file is incomplete is also not helpful. The expectation is that I would get an error message saying that an expected paramater is missing rather then just failing.', 'https://tickets.puppetlabs.com/browse/PUP-5723', 'https://github.com/puppetlabs/puppet/pull/5130', '2016-01-19T06:38:24.000-0800', '2016-08-11T09:58:43.000-0700', '2016-08-11T09:58:43.000-0700', 'Closed', '', 9, '0', 1, 51, 1, 2, 'a0c79fe38dde4843e98a1572d945617727a12f45', 'https://tickets.puppetlabs.com/browse/PUP-5723', 'https://github.com/puppetlabs/puppet/pull/5130'),
('puppet', 134180, 79906617, 5170, 'trusted facts with apache/nginx and puppetmaster unicorn', 'I have gunicorn running behind nginx, but want to make use of trusted facts, but that doesn"t seem to work out of the box.\r\n\r\nSome debugging, I found the\r\nlib/puppet/network/http/rack/rest.rb, esp. the +ExportCertData\r\ncomment in it. This is only available in Apache, so switched to use\r\napache in front of unicorn, but still no luck.\r\n\r\nI figured that running unicorn behind apache reverse proxying, the\r\nenvironment variable is not available. Therefore I added an additionalheader that gets passed to unicorn: X-SSL-Client-Cert.\r\nHowever, that header is sent as single line from Apache to unicorn,\r\nand not as valid PEM encoded certificate. Therefore the gsub!\r\nmanipulations to restore a valid PEM certificate again. (see the attached patch)\r\n\r\nWith the attached patch, it works for Apache, just add this to the vhost configuration:\r\nRequestHeader set X-SSL-Client-Cert %{SSL_CLIENT_CERT}e\r\n\r\nWith nginx, there is a bit more trouble. Nginx has $ssl_client_cert variable aswell, but nginx passes that variable on as multi-line header. Doh!\r\nUnicorn doesn"t like that at all.\r\n\r\nTherefore have to use nginx lua module, and add this:\r\n\r\n location / {\r\n\r\nset_by_lua $client_cert "if gx.var.ssl_client_raw_cert then return ngx.var.ssl_client_raw_cert:gsub("\\n"," ") end";\r\n\r\nproxy_set_header X-SSL-Client-Cert $client_cert;\r\n\r\n}\r\n\r\nSo, that patch makes trusted facts available to the puppetmaster when running\r\nwith unicorn behind apache or nginx.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6366', 'https://github.com/puppetlabs/puppet/pull/5170', '2016-05-27T03:29:35.000-0700', '2016-08-11T09:58:44.000-0700', '2016-08-11T09:58:44.000-0700', 'Closed', '', 5, '0', 1, 15, 1, 1, '1d24fb816ceda2d2730431f918f56afe2ce3fe5c', 'https://tickets.puppetlabs.com/browse/PUP-6366', 'https://github.com/puppetlabs/puppet/pull/5170'),
('puppet', 140734, 76848951, 5105, 'Bundle install fails to find proper puppet version when source is path or vcs', 'When specifying the puppet gem in a gemfile with a local path source or a vcs source (such as github), the existing puppet gem"s version file is loaded instead of the version file from the target.  If the version of the previously installed gem does not match the target gem version, bundler fails with an error like:\r\n\r\n{noformat}\r\nCould not find gem "puppet (= 4.6.0)" in source at `/Users/peter.drake/workspace/puppet`.\r\nSource contains "puppet" at: 4.5.2\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6486', 'https://github.com/puppetlabs/puppet/pull/5105', '2016-07-09T08:03:20.000-0700', '2016-08-11T09:58:44.000-0700', '2016-08-11T09:58:44.000-0700', 'Closed', '', 0, '0', 1, 2, 6, 1, '0e9aac25407e52837668fe1d644eb62115088783', 'https://tickets.puppetlabs.com/browse/PUP-6486', 'https://github.com/puppetlabs/puppet/pull/5105'),
('puppet', 128348, 75384215, 5063, 'Serivce SMF restart should use -s', 'The restartcmd in smf.rb needs to add the -s flag to make sure that service restarts are synchronous', 'https://tickets.puppetlabs.com/browse/PUP-6233', 'https://github.com/puppetlabs/puppet/pull/5063', '2016-04-26T09:37:21.000-0700', '2016-08-11T09:58:44.000-0700', '2016-08-11T09:58:44.000-0700', 'Closed', '', 4, '0', 1, 9, 8, 2, 'f3f2aee5e774e93398027c430ffe2c3d6c94ea7b', 'https://tickets.puppetlabs.com/browse/PUP-6233', 'https://github.com/puppetlabs/puppet/pull/5063'),
('puppet', 138139, 74723944, 5045, 'Regression: puppet help errors out if any application raises while generating help', 'PUP-3521 (commit [eccd3b|https://github.com/puppetlabs/puppet/commit/eccd3b427e9463277c890966978ea5bdcd7eacba] modified puppet to not swallow errors silently, but it causes a regression because the {{result}} variable is not in scope. To reproduce, modify an app in lib/puppet/application/*.rb to raise an ArgumentError in its help method, then run:\r\n\r\n{noformat}\r\nbundle exec puppet help\r\nError: undefined local variable or method `result" for #<Puppet::Interface:0x007fab1b563218>\r\n...\r\n{noformat}\r\n\r\nThe problem line is:\r\n\r\n{code:ruby}\r\n    rescue StandardError\r\n      result << [ "! #{appname}", "! Subcommand unavailable due to error. Check error logs." ]\r\n    end\r\n{code}\r\n\r\nAlthough the reproduction steps are contrived, I ran into this problem when I had an application in a module and the application called Puppet.settings.initialize_settings twice, which causes puppet to raise an exception.', 'https://tickets.puppetlabs.com/browse/PUP-6425', 'https://github.com/puppetlabs/puppet/pull/5045', '2016-06-21T18:00:31.000-0700', '2016-08-11T09:58:45.000-0700', '2016-08-11T09:58:45.000-0700', 'Closed', '', 2, '0', 1, 7, 1, 2, 'aee12871b9ad3915bd0dbcdaa082a9b32e693da8', 'https://tickets.puppetlabs.com/browse/PUP-6425', 'https://github.com/puppetlabs/puppet/pull/5045'),
('puppet', 125119, 70960248, 4982, 'verbose agent runs result data being sent to console and syslog', 'The documentation states\r\n\r\n{quote}\r\n* --logdest:\r\n  Where to send log messages. Choose between "syslog" (the POSIX syslog\r\n  service), "eventlog" (the Windows Event Log), "console", or the path to a log\r\n  file. If debugging or verbosity is enabled, this defaults to "console".\r\n  Otherwise, it defaults to "syslog" on POSIX systems and "eventlog" on Windows.\r\n{quote}\r\n\r\n|| Flags || Syslog || Console ||\r\n| None | X | |\r\n| --logdest console | | X |\r\n| --logdest syslog | X | |\r\n| --verbose | X | X |\r\n| --verbose --logdest console | | X |\r\n| --test  | X | X |\r\n| --test --verbose | X | X |\r\n\r\nThis becomes a problem when the --test option is used. --test expands and sets --verbose which means diff output will get logged to syslog and the console.\r\n\r\nThe expected result - based on logdest"s documentation - is to send output only to the console, not syslog.\r\n\r\nThis is a concern, because --test enables show-diff, which can contain secrets (such as passwords) that should not be printed. As a default, this suggests we should not log show-diff and verbose/debug output to more permanent locations such as syslog/eventlog.', 'https://tickets.puppetlabs.com/browse/PUP-6125', 'https://github.com/puppetlabs/puppet/pull/4982', '2016-04-05T12:18:11.000-0700', '2016-08-11T09:58:45.000-0700', '2016-08-11T09:58:45.000-0700', 'Closed', '', 11, '0', 2, 4, 30, 6, 'b0823900db17116c86911bfff2e24337073f37bb', 'https://tickets.puppetlabs.com/browse/PUP-6125', 'https://github.com/puppetlabs/puppet/pull/4982'),
('puppet', 137225, 73964470, 5022, 'launchd service provider crashes if a zero-length file in the {System,}/Library/Launch{Daemon,Agent} directory exists', 'If a zero-length file exists in the standard locations for OS X LaunchAgent or LaunchDaemons exist, puppet will exit with an error:\r\n{code}\r\n# touch /Library/LaunchDaemons/foo\r\n# puppet resource service\r\nError: Could not run: undefined method `elements" for nil:NilClass\r\n{code}\r\n\r\nNot only does this cause {{puppet resource}} to fail, but {{puppet apply}} as well, causing failures.\r\n\r\nI discovered this by adding some logging to {{provider/service/launchd.plist}}, and saw the failure was when trying to read {{/Library/LaunchDaemons/<internal agent>.plist.puppettmp_9913}}, so it appears an interrupted puppet run left the {{.puppettmp_9913}} file, which then caused future runs to fail.\r\n\r\nPuppet 3 is not affected, so this is a regression of sorts. It appears there"s an unhandled exception down in {{cfpropertylist}}:\r\n{code}\r\n$ sudo /Library/GoogleCorpSupport/bin/puppet resource --trace service\r\nError: Could not run: undefined method `elements" for nil:NilClass\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/cfpropertylist/rbREXMLParser.rb:22:in `load"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/cfpropertylist/rbCFPropertyList.rb:312:in `load_str"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/cfpropertylist/rbCFPropertyList.rb:248:in `initialize"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/plist.rb:83:in `new"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/plist.rb:83:in `new_cfpropertylist"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/plist.rb:62:in `parse_plist"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/plist.rb:39:in `read_plist_file"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:196:in `read_plist"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:138:in `block (2 levels) in make_label_to_path_map"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:137:in `each"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:137:in `block in make_label_to_path_map"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:136:in `each"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:136:in `make_label_to_path_map"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:157:in `jobsearch"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/provider/service/launchd.rb:106:in `instances"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/type.rb:1162:in `block in instances"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/type.rb:1155:in `collect"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/type.rb:1155:in `instances"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/indirector/resource/ral.rb:24:in `search"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/indirector/indirection.rb:269:in `search"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application/resource.rb:225:in `find_or_save_resources"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application/resource.rb:140:in `main"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application.rb:352:in `run_command"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application.rb:344:in `block in run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util.rb:540:in `exit_on_fail"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/application.rb:344:in `run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/command_line.rb:128:in `run"\r\n/Library/GoogleCorpSupport/Ruby/lib/ruby/site_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/Library/GoogleCorpSupport/bin/puppet:5:in `<main>"\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6410', 'https://github.com/puppetlabs/puppet/pull/5022', '2016-06-15T09:42:48.000-0700', '2016-08-11T09:58:45.000-0700', '2016-08-11T09:58:45.000-0700', 'Closed', '', 7, '0', 1, 19, 2, 2, '89a5bbb283a7d2c1897761fcaf20ab4eb9ae98b3', 'https://tickets.puppetlabs.com/browse/PUP-6410', 'https://github.com/puppetlabs/puppet/pull/5022'),
('puppet', 87114, 75837486, 5075, 'Yumrepo type says uppercase values are allowed when they are not', '* CentOS 7 x86_64\r\n* Puppet 4.2.0 (Installed via puppetlabs-release-pc1-el-7 repository)\r\n\r\nApply the following configuration:\r\n\r\n{code}\r\nyumrepo { "mariadb" :\r\n  ensure   => present,\r\n  enabled  => True,\r\n  baseurl  => "http://yum.mariadb.org/10.0/centos7-amd64",\r\n  gpgcheck => True,\r\n  gpgkey   => "https://yum.mariadb.org/RPM-GPG-KEY-MariaDB",\r\n}\r\n{code}\r\n\r\nThis will produce the following error:\r\n\r\n{code}\r\nError: Parameter enabled failed on Yumrepo[mariadb]: Invalid value True[]{:name=>""}. Valid values are absent. Valid values match /^(True|False|0|1|No|Yes)$/i.\r\n{code}\r\n\r\nApply the following configuration:\r\n\r\n{code}\r\nyumrepo { "mariadb" :\r\n  ensure   => present,\r\n  enabled  => true,\r\n  baseurl  => "http://yum.mariadb.org/10.0/centos7-amd64",\r\n  gpgcheck => true,\r\n  gpgkey   => "https://yum.mariadb.org/RPM-GPG-KEY-MariaDB",\r\n}\r\n{code}\r\n\r\nThe configuration will apply successfully. \r\n\r\nThe issue here is that the error message indicates that valid values for the parameter include "True", when it will in fact not match on "True" (with a capital "T").', 'https://tickets.puppetlabs.com/browse/PUP-4809', 'https://github.com/puppetlabs/puppet/pull/5075', '2015-07-01T15:32:49.000-0700', '2016-08-11T09:58:45.000-0700', '2016-08-11T09:58:45.000-0700', 'Closed', 'client-onboarding', 2, '0', 1, 7, 8, 3, '019a00849fe8c35086040069eb58047a2b025df4', 'https://tickets.puppetlabs.com/browse/PUP-4809', 'https://github.com/puppetlabs/puppet/pull/5075'),
('puppet', 116318, 76762496, 5100, 'Interpolation in interpolation nested string does not work.', 'If you do this:\r\n{code}\r\nnotice "${"${foo}"}"\r\n{code}\r\nThere is a syntax error at the closing "\r\n\r\nIf doing this (i.e. no interpolation in inner string):\r\n{code}\r\nnotice "${ "\$foo" }"\r\n{code}\r\n\r\nThen it works.\r\n\r\nInterpolations are recursive - this looks like is a lexer bug.', 'https://tickets.puppetlabs.com/browse/PUP-5887', 'https://github.com/puppetlabs/puppet/pull/5100', '2016-02-11T12:20:51.000-0800', '2016-08-11T09:58:45.000-0700', '2016-08-11T09:58:45.000-0700', 'Closed', '', 10, '0', 2, 18, 3, 3, '57d78d65adead835419a5fb579c2ead30263b3ec', 'https://tickets.puppetlabs.com/browse/PUP-5887', 'https://github.com/puppetlabs/puppet/pull/5100'),
('puppet', 124367, 76622830, 5095, 'The instructions for cleaning a Windows node"s certificate are wrong', 'On a windows node, if there"s some problem with the node"s certificate during a puppet agent run (such as a cert already existing on the master with the same name) then instructions are printed to clean the cert on the master and the agent node.\r\n\r\nThe command to delete the certificate in Windows is wrong. See the following screenshot:\r\n!windows.png|thumbnail!\r\n\r\n*The 2 problems are:*\r\n# "certs" is missing from the path\r\n# Back slashes should be used rather than forward slashes.', 'https://tickets.puppetlabs.com/browse/PUP-6115', 'https://github.com/puppetlabs/puppet/pull/5095', '2016-03-31T10:53:55.000-0700', '2016-08-11T09:58:46.000-0700', '2016-08-11T09:58:46.000-0700', 'Closed', 'cspapercuts', 9, '0', 1, 1, 1, 1, '1f6956a1d38e37e35a50c18883be0d30e9ee0996', 'https://tickets.puppetlabs.com/browse/PUP-6115', 'https://github.com/puppetlabs/puppet/pull/5095'),
('puppet', 143799, 79728928, 5164, 'Regression: Puppet unable to load PE Trapperkeeper::Orchestrator type, breaking PE installation', '* tl;dr: Puppet commit [b6b7ae4|https://github.com/puppetlabs/puppet/commit/b6b7ae4e4ef96f4a5c16de58e08f7f56a5decc90] looks to have caused a regression in resource type loading, or uncovered an issue elsewhere in the PE stack.\r\n\r\nLast night, the [monolithic smoke integration pipeline|https://jenkins-enterprise.delivery.puppetlabs.net/job/enterprise_pe-acceptance-tests_integration-system_pe_smoke-monolithic_2016.3.x/LAYOUT=64mcd,LEGACY_AGENT_VERSION=NONE,PLATFORM=redhat6,UPGRADE_FROM=NONE,label=beaker-integration-smoke/150/consoleFull] failed on basic puppet enterprise installs with the following error:\r\n\r\n{code}\r\n 2016-07-27 01:38:19,124 - [Error]: Evaluation Error: Error while evaluating a Resource Statement, Evaluation Error: Resource type not found: Puppet_enterprise::Trapperkeeper::Orchestrator\r\n  at /opt/puppetlabs/server/data/enterprise/modules/puppet_enterprise/manifests/profile/orchestrator.pp:60:15\r\n  at /opt/puppetlabs/server/data/enterprise/modules/pe_install/manifests/install.pp:70\r\n  on node v0f4grv1uu3a2dt.delivery.puppetlabs.net\r\n    * /opt/puppetlabs/puppet/bin/puppet enterprise configure  --detailed-exitcodes --modulepath /opt/puppetlabs/server/data/enterprise/modules\r\n    * returned: 1\r\n{code}\r\n\r\nThis is easily reproducible by downloading and attempting to run the installer on [this build|http://enterprise.delivery.puppetlabs.net/2016.3/ci-ready/puppet-enterprise-2016.3.0-rc1-185-g5e0d3fd-el-6-x86_64.tar] of PE 2016.3.\r\n\r\nI ran the installer on this same build with Puppet commit [b6b7ae4|https://github.com/puppetlabs/puppet/commit/b6b7ae4e4ef96f4a5c16de58e08f7f56a5decc90] reverted, and the {{Trapperkeeper::Orchestrator}} type is loaded successfully. Thus, this  auto-loading of pp-defined resource types change seems to be the issue here.', 'https://tickets.puppetlabs.com/browse/PUP-6558', 'https://github.com/puppetlabs/puppet/pull/5164', '2016-07-27T11:40:05.000-0700', '2016-08-11T09:58:46.000-0700', '2016-08-11T09:58:46.000-0700', 'Closed', '', 15, '0', 1, 26, 12, 1, '18fb6b09c6b7ffc186548742615055a955840b82', 'https://tickets.puppetlabs.com/browse/PUP-6558', 'https://github.com/puppetlabs/puppet/pull/5164'),
('puppet', 117456, 69591208, 4956, 'launchd service provider doesn"t implement status override.', 'I"m seeing some odd behaviour when trying to override the status command of a service which seems to be being ignored.\r\n\r\nAccording to the docs, setting {{hasstatus}} to {{false}} and adding a custom command to the {{status}} attribute should allow me to fine tune how Puppet tries to determine if my service is running...\r\n\r\n{quote}\r\nIf a service’s init script does not support any kind of status command, you should set hasstatus to false and either provide a specific command using the status attribute or expect that Puppet will look for the service name in the process table.\r\n{quote}\r\n\r\nand for {{status}}...\r\n\r\n{quote}\r\nSpecify a status command manually. This command must return 0 if the service is running and a nonzero value otherwise.\r\n{quote}\r\n\r\nI"ve boiled my problem down to the following example code\r\n\r\n{code}\r\nservice { "fake_service":\r\n  ensure    => running,\r\n  start     => "/bin/echo start command",\r\n  status    => "/bin/true",\r\n  hasstatus => false,\r\n}\r\n{code}\r\n\r\nThe behaviour I would expect from this is that when evaluating the service, puppet will run {{ /bin/true }} to determine if the service is up, which will return 0, and then stop there since the service should always be deemed running.  However when I run the above code I see that the status command is never run and puppet insists on querying the service through systemctl....\r\n\r\n{code}\r\nDebug: Executing "/usr/bin/systemctl is-active fake_service"\r\nDebug: Executing "/bin/echo start command"\r\nNotice: /Stage[main]/Main/Service[fake_service]/ensure: ensure changed "stopped" to "running"\r\n{code}\r\n\r\nSo far I"ve seen this on Puppet 4.3.1 (MacOS) and Puppet 3.8.4 (Redhat 7.1)\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5926', 'https://github.com/puppetlabs/puppet/pull/4956', '2016-02-19T03:29:16.000-0800', '2016-08-11T09:58:47.000-0700', '2016-08-11T09:58:47.000-0700', 'Closed', '', 9, '0', 1, 44, 5, 2, 'b97333c49823956daf62169acf04c7354f78bc7b', 'https://tickets.puppetlabs.com/browse/PUP-5926', 'https://github.com/puppetlabs/puppet/pull/4956'),
('puppet', 132621, 75547598, 5070, 'Support tdnf package provider for VMware PhotonOS', 'PhotonOS is a RPM derivative OS from VMware. However it does not use yum, nor the newer DNF. It uses a DNF compatible application called TDNF (https://github.com/vmware/tdnf). Some details from http://www.vcritical.com/2015/06/quickly-update-to-docker-1-6-on-photon-by-using-tdnf/\r\n\r\n{quote}\r\nTDNF is a VMware innovation that offers DNF-compatible package management without a massive Python footprint.\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-6323', 'https://github.com/puppetlabs/puppet/pull/5070', '2016-05-19T00:55:06.000-0700', '2016-08-11T09:58:48.000-0700', '2016-08-11T09:58:48.000-0700', 'Closed', 'client-onboarding', 0, '0', 1, 50, 0, 3, '00e50b159427526d8e723fe2f2088d353eedaa26', 'https://tickets.puppetlabs.com/browse/PUP-6323', 'https://github.com/puppetlabs/puppet/pull/5070'),
('puppet', 137324, 73991680, 5024, 'Pip provider fails when using ensure => latest', 'Pypi changed behaviour today because of vulnerabilities in urrlib, which\r\nis used by pip.\r\n\r\nhttp://blog.blindspotsecurity.com/2016/06/advisory-http-header-injection-in.html\r\n\r\nPypi changed to denying http requests entirely instead of redirecting to\r\nhttps. (I guess? I don"t really understand)\r\n\r\nWithout this patch:\r\n\r\nroot@derpderp:~# cat foo.pp\r\npackage { "diskimage-builder":\r\nensure => latest,\r\nprovider => pip,\r\n}\r\n\r\nroot@derpderp:~# puppet apply foo.pp\r\nWarning: Setting templatedir is deprecated. See http://links.puppetlabs.com/env-settings-deprecations\r\n(at /usr/lib/ruby/vendor_ruby/puppet/settings.rb:1139:in `issue_deprecation_warning")\r\nNotice: Compiled catalog for derpderp in environment production in 0.14 seconds\r\nError: Could not get latest version: HTTP-Error: 403 Must access using HTTPS instead of HTTP\r\nError: /Stage[main]/Main/Package[diskimage-builder]/ensure: change from 1.17.0 to latest failed: Could not get latest version: HTTP-Error: 403 Must access using HTTPS instead of HTTP\r\nNotice: Finished catalog run in 0.67 seconds\r\n\r\nSo this breaks any puppet 3.x using the default pip provider.\r\n\r\nWith this patch, it just works.', 'https://tickets.puppetlabs.com/browse/PUP-6413', 'https://github.com/puppetlabs/puppet/pull/5024', '2016-06-15T15:06:27.000-0700', '2016-08-11T09:58:48.000-0700', '2016-08-11T09:58:48.000-0700', 'Closed', '', 2, '0', 1, 3, 3, 2, '2bc6b6e169a5ab9c5fd663486b9806e3ff9b9b4d', 'https://tickets.puppetlabs.com/browse/PUP-6413', 'https://github.com/puppetlabs/puppet/pull/5024'),
('puppet', 144366, 79639396, 5163, 'pe_acceptance tests fail in Non-English Windows', 'During the validation of MODULES-3636 it was found that some tests have hardcoded\r\nenglish-only tests e.g.\r\n\r\n{code}\r\nassert_match(/The Marionette Collective Server service was stopped successfully/, result.stdout, "Failed to stop MCollective service")\r\n{code}\r\nhttps://github.com/puppetlabs/pe_acceptance_tests/blob/2016.3.x/acceptance/tests/pe_checks/QA-563_windows_exit_mcollective.rb#L13\r\n\r\nhttps://github.com/puppetlabs/pe_acceptance_tests/blob/2016.3.x/acceptance/tests/pe_checks/QA-563_windows_exit_mcollective.rb#L13\r\n\r\nThis results in failures on French windows;\r\n{code}\r\n       Test Case ./acceptance/tests/pe_checks/QA-563_windows_exit_mcollective.rb reported: #<Minitest::Assertion: Failed to stop MCollective service.\r\n      Expected /The Marionette Collective Server service was stopped successfully/ to match "Le service Marionette Collective Server s"arrte.\nLe service Marionette Collective Server a t arrt.\n\n".>\r\n          Test line: ./acceptance/tests/pe_checks/QA-563_windows_exit_mcollective.rb:13:in `block (3 levels) in run_test"\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6570', 'https://github.com/puppetlabs/puppet/pull/5163', '2016-08-01T14:20:15.000-0700', '2016-08-12T13:14:11.000-0700', '2016-08-12T13:14:11.000-0700', 'Closed', '', 8, '0', 1, 2, 6, 1, '449aa2dc098b07c790b8dc845204f8ab4839477d', 'https://tickets.puppetlabs.com/browse/PUP-6570', 'https://github.com/puppetlabs/puppet/pull/5163'),
('puppet', 135299, 72580708, 5004, 'No title provided and "" is not a valid resource reference - caused by create_resources() not filtering out undefs', 'Since PUP-6028, catalog compilation now fails when a resource has the {{require}} or {{before}} metaparameters set to {{undef}}.\r\n\r\nThis behaviour was relied upon in the puppetlabs-postgresql module at https://github.com/puppetlabs/puppetlabs-postgresql/blob/4.7.1/manifests/server/extension.pp#L57-L58 where the value of the metaparams is worked out in the manifest and can be undef.\r\n\r\nA simple reproducer, at commit eff7ac6 or master:\r\n\r\n{code}\r\n$ bin/puppet apply -e "notify { "a": require => undef }" --trace\r\nError: No title provided and "" is not a valid resource reference on node cobalt\r\n/home/dcleal/code/puppet/puppet/lib/puppet/resource.rb:544:in `extract_type_and_title"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/resource.rb:529:in `type_and_title"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/resource/catalog.rb:353:in `resource"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:33:in `block in validate_relationship"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:32:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:32:in `validate_relationship"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:10:in `block (2 levels) in validate"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/resource.rb:51:in `block in eachparam"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/resource.rb:50:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/resource.rb:50:in `eachparam"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:8:in `block in validate"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:6:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:6:in `validate"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:217:in `block in validate_catalog"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:217:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:217:in `validate_catalog"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:205:in `block (2 levels) in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler.rb:51:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:204:in `block in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/context.rb:65:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet.rb:240:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:167:in `compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:35:in `compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:265:in `block (2 levels) in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler.rb:51:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:263:in `block in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util.rb:223:in `block in benchmark"\r\n/home/dcleal/.rvm/rubies/ruby-1.9.3-p448/lib/ruby/1.9.1/benchmark.rb:295:in `realtime"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util.rb:222:in `benchmark"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:261:in `compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:53:in `find"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/indirection.rb:194:in `find"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application/apply.rb:256:in `block in main"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/context.rb:65:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet.rb:240:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application/apply.rb:225:in `main"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application/apply.rb:170:in `run_command"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application.rb:344:in `block in run"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util.rb:540:in `exit_on_fail"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application.rb:344:in `run"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/command_line.rb:128:in `run"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/command_line.rb:72:in `execute"\r\n/home/dcleal/code/puppet/puppet/bin/puppet:5:in `<main>"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/resource.rb:544:in `extract_type_and_title"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/resource.rb:529:in `type_and_title"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/resource/catalog.rb:353:in `resource"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:33:in `block in validate_relationship"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:32:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:32:in `validate_relationship"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:10:in `block (2 levels) in validate"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/resource.rb:51:in `block in eachparam"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/resource.rb:50:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/resource.rb:50:in `eachparam"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:8:in `block in validate"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:6:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb:6:in `validate"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:217:in `block in validate_catalog"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:217:in `each"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:217:in `validate_catalog"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:205:in `block (2 levels) in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler.rb:51:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:204:in `block in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/context.rb:65:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet.rb:240:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:167:in `compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/parser/compiler.rb:35:in `compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:265:in `block (2 levels) in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/profiler.rb:51:in `profile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:263:in `block in compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util.rb:223:in `block in benchmark"\r\n/home/dcleal/.rvm/rubies/ruby-1.9.3-p448/lib/ruby/1.9.1/benchmark.rb:295:in `realtime"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util.rb:222:in `benchmark"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:261:in `compile"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/catalog/compiler.rb:53:in `find"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/indirector/indirection.rb:194:in `find"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application/apply.rb:256:in `block in main"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/context.rb:65:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet.rb:240:in `override"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application/apply.rb:225:in `main"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application/apply.rb:170:in `run_command"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application.rb:344:in `block in run"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util.rb:540:in `exit_on_fail"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/application.rb:344:in `run"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/command_line.rb:128:in `run"\r\n/home/dcleal/code/puppet/puppet/lib/puppet/util/command_line.rb:72:in `execute"\r\n/home/dcleal/code/puppet/puppet/bin/puppet:5:in `<main>"\r\n{code}\r\n\r\nPreviously this worked (commit f14b653):\r\n\r\n{code}\r\n$ bin/puppet apply -e "notify { "a": require => undef }" --trace\r\nNotice: Compiled catalog for cobalt in environment production in 0.06 seconds\r\nNotice: a\r\nNotice: /Stage[main]/Main/Notify[a]/message: defined "message" as "a"\r\nNotice: Applied catalog in 0.04 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6385', 'https://github.com/puppetlabs/puppet/pull/5004', '2016-06-03T11:17:57.000-0700', '2016-08-15T11:56:19.000-0700', '2016-08-15T11:56:19.000-0700', 'Closed', 'couch-ss', 14, '0', 1, 11, 1, 2, '317727dafff612cbdb489c98ed286c53c25f290d', 'https://tickets.puppetlabs.com/browse/PUP-6385', 'https://github.com/puppetlabs/puppet/pull/5004'),
('puppet', 22947, 63974011, 4811, 'Yum package arch and version ensuring failing', 'After lots of trial and error I found a bug in our current Puppet version\r\n\r\nHaving a package line like so:\r\n\r\n{noformat}\r\n package { "firefox.x86_64": ensure => "3.0.12-1.el5.centos", require => Package["xulrunner.x86_64"] }\r\n{noformat}\r\n\r\nWould fail with debug output:\r\n{noformat}\r\n*_\r\ndebug: //Node[om012274.drd.int]/workstation/workstation_centos53/mozillasuite53/Package[firefox.x86_64]: Changing ensure\r\ndebug: //Node[om012274.drd.int]/workstation/workstation_centos53/mozillasuite53/Package[firefox.x86_64]: 1 change(s)\r\ndebug: Package[firefox.x86_64](provider=yum): Ensuring => 3.0.12-1.el5.centos\r\ndebug: Puppet::Type::Package::ProviderYum: Executing "/usr/bin/yum -d 0 -e 0 -y install firefox.x86_64-3.0.12-1.el5.centos"\r\ndebug: Puppet::Type::Package::ProviderYum: Executing "/bin/rpm -q firefox.x86_64 --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE}\r\n%{ARCH}\r\n"\r\nerr: //Node[om012274.drd.int]/workstation/workstation_centos53/mozillasuite53/Package[firefox.x86_64]/ensure: change from absent to 3.0.12-1.el5.centos failed: Could\r\n not update: Could not find package firefox.x86_64 at /etc/puppet/manifests/CentOS.pp:149_*\r\n{noformat}\r\n\r\n\r\nIt didn"t matter if I listed ver-release or just ver, same sort of error; it appends the version-[release] to the package name and arch. Which obviously fails as yum packages must be referred to like so:\r\n\r\n{noformat}\r\n          name\r\n          name.arch\r\n          name-ver\r\n          name-ver-rel\r\n          name-ver-rel.arch\r\n          name-epoch:ver-rel.arch\r\n          epoch:name-ver-rel.arch\r\n{noformat}\r\n\r\nSo if I omitted the arch and changed the line to:\r\n{noformat}\r\n package { "firefox": ensure => "3.0.12-1.el5.centos", require => Package["xulrunner.x86_64"] }\r\n{noformat}\r\n\r\nWe would have more success with the 64bit version but it would try and bring the 32bit Firefox version too along with its dependencies. Not what I wanted.\r\n\r\n{noformat}\r\n*_debug: Package[firefox](provider=yum): Ensuring => 3.0.12-1.el5.centos.x86_64\r\ndebug: Puppet::Type::Package::ProviderYum: Executing "/usr/bin/yum -d 0 -e 0 -y install firefox-3.0.12-1.el5.centos.x86_64"\r\ndebug: Puppet::Type::Package::ProviderYum: Executing "/bin/rpm -q firefox --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\r\n"\r\nerr: //Node[om012274.drd.int]/workstation/workstation_centos53/mozillasuite53/Package[firefox]/ensure: change from 3.0.12-1.el5.centos to 3.0.12-1.el5.centos.x86_64 failed: Could not update: Failed to update to version 3.0.12-1.el5.centos.x86_64, got version 3.0.12-1.el5.centos instead at /etc/puppet/manifests/CentOS.pp:149_*\r\n{noformat}\r\n\r\nSo chatting on IRC and more trial and error I found this is the only way to get it to work:\r\n{noformat}\r\n package { "firefox-3.0.12-1.el5.centos.x86_64": ensure => "present", require => Package["xulrunner.x86_64"] }\r\n{noformat}\r\n\r\nSo this side-steps puppets version management though.\r\n\r\nThis may be fixed in a newer version. I haven"t tried yet.\r\n\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1364', 'https://github.com/puppetlabs/puppet/pull/4811', '2014-01-03T14:46:07.000-0800', '2016-08-15T12:02:45.000-0700', '2016-08-15T12:02:45.000-0700', 'Closed', 'customer;redmine;yum', 7, '0', 1, 54, 0, 2, '', 'https://tickets.puppetlabs.com/browse/PUP-1364', 'https://github.com/puppetlabs/puppet/pull/4811'),
('puppet', 143581, 78931783, 5146, 'Acceptance: systemd_enabling_masked_service test failing for Fedora 23 i386', 'The [ticket_5024_systemd_enabling_masked_service.rb|https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/resource/service/ticket_5024_systemd_enabling_masked_service.rb] test is failing in current CI runs for Fedora 23 i386.\r\n{noformat}\r\n    Test Case tests/resource/service/ticket_5024_systemd_enabling_masked_service.rb reported: #<Beaker::Host::CommandFailure: Host "e3cajbwa1ij5zlq.delivery.puppetlabs.net" exited with 4 running:\r\n   puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.27FMnl\r\n  Last 10 lines of output were:\r\n  	Notice: Compiled catalog for e3cajbwa1ij5zlq.delivery.puppetlabs.net in environment production in 0.22 seconds\r\n  	Info: Applying configuration version "1469553376"\r\n  	Error: Could not start Service[httpd]: Execution of "/usr/bin/systemctl start httpd" returned 1: Job for httpd.service failed because the control process exited with error code. See "systemctl status httpd.service" and "journalctl -xe" for details.\r\n  	Error: /Stage[main]/Main/Service[httpd]/ensure: change from stopped to running failed: Could not start Service[httpd]: Execution of "/usr/bin/systemctl start httpd" returned 1: Job for httpd.service failed because the control process exited with error code. See "systemctl status httpd.service" and "journalctl -xe" for details.\r\n  	Notice: Applied catalog in 0.18 seconds>\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-6549', 'https://github.com/puppetlabs/puppet/pull/5146', '2016-07-26T11:58:25.000-0700', '2016-08-17T16:05:20.000-0700', '2016-08-17T16:05:20.000-0700', 'Resolved', '', 1, '0', 1, 7, 0, 1, '446acd842cefda784154170c614e6274e654c72a', 'https://tickets.puppetlabs.com/browse/PUP-6549', 'https://github.com/puppetlabs/puppet/pull/5146'),
('puppet', 142647, 79864411, 5168, 'create_resources() doesn"t include the file or line reference in resources it creates', 'Given the following Puppet code:\r\n\r\n{code}\r\nclass system::hashadmins {\r\n  require mysql::server\r\n  ## Defaults\r\n  Mysql_user {\r\n    ensure               => present,\r\n    max_queries_per_hour => 700,\r\n  }\r\n  ## User Data\r\n  $users = {\r\n    "monica@localhost" => {},\r\n    "brad@localhost"   => {},\r\n    "luke@localhost"   => {},\r\n    "zack@localhost"   => {\r\n      "max_queries_per_hour" => 1300,\r\n    },\r\n    "ralph@localhost"  => {\r\n      "ensure" => "absent",\r\n    }\r\n  }\r\n  ## Call the function\r\n  create_resources("mysql_user", $users)\r\n}\r\n{code}\r\n\r\n...the resources that are queried look like this coming out of PuppetDB:\r\n\r\n{code: json}\r\n{\r\n        "certname": "gary.puppetlabs.vm",\r\n        "environment": "gary",\r\n        "exported": false,\r\n        "file": null,\r\n        "line": null,\r\n        "parameters": {\r\n            "ensure": "present",\r\n            "max_queries_per_hour": 1300\r\n        },\r\n        "resource": "964a8bb11e504402830b17f2818b2a848b5fe4ae",\r\n        "tags": [\r\n            "class",\r\n            "system::hashadmins",\r\n            "hashadmins",\r\n            "system",\r\n            "mysql_user",\r\n            "default",\r\n            "node"\r\n        ],\r\n        "title": "zack@localhost",\r\n        "type": "Mysql_user"\r\n    }\r\n{code}\r\n\r\nYou"ll note that the line and file keys are null.  This causes issues down the line with coverage reports like the issue that was posted here --> https://github.com/rodjek/rspec-puppet/issues/364\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6530', 'https://github.com/puppetlabs/puppet/pull/5168', '2016-07-21T07:46:28.000-0700', '2016-08-17T16:08:17.000-0700', '2016-08-17T16:08:17.000-0700', 'Closed', '', 5, '0', 1, 31, 0, 1, 'fc2db9ec77c27ecf703833a0d7a3dcc8c2aebcf9', 'https://tickets.puppetlabs.com/browse/PUP-6530', 'https://github.com/puppetlabs/puppet/pull/5168'),
('puppet', 138316, 0, 0, 'puppet parser validate stalls when run over SSH with no manifest specified', '{code}\r\n#works when you specify a manifest:\r\n$) ssh root@somehost "puppet parser --debug validate /tmp/parser_validate.r7iozi/parser_validate_exported.pp"\r\nDebug: Runtime environment: puppet_version=4.5.3, ruby_version=2.1.9, run_mode=user, default_encoding=UTF-8\r\n$) echo $?\r\n0\r\n# but not without a manifest (should go to default manifest, as when run on-host):\r\n$ ssh root@somehost "puppet parser --debug validate"\r\nDebug: Runtime environment: puppet_version=4.5.3, ruby_version=2.1.9, run_mode=user, default_encoding=UTF-8\r\n#stalls here for... a long time\r\n{code}\r\non the remote machine:\r\n{code}\r\nroot@somehost:~# ps aux | grep [p]uppet\r\nroot      6093  5.5  1.3 179964 53620 ?        Ssl  14:50   0:00 /opt/puppetlabs/puppet/bin/ruby /opt/puppetlabs/bin/puppet parser --debug validate\r\n{code}\r\nif you kill the process on the machine, ssh will return\r\nif you run the command on the machine, it works as expected.\r\n\r\nthis also does not work using beaker"s on() as it sends its commands over SSH\r\n\r\nOSX runner here, SSHing to both rhel7 and ubuntu1404\r\n\r\n\r\nthis ticket should also fix puppet parser"s test:\r\nhttps://github.com/puppetlabs/puppet/blob/5e16ae3f5d684c7c64b3737dd8b5d1c1e9912f11/acceptance/tests/face/parser_validate.rb#L24', 'https://tickets.puppetlabs.com/browse/PUP-6431', '', '2016-06-22T14:55:06.000-0700', '2016-08-22T15:35:51.000-0700', '2016-08-22T15:35:51.000-0700', 'Closed', '', 5, '0', 0, 0, 0, 0, '524dff2c2b5a89941e0a5be0278048d85d725317', 'https://tickets.puppetlabs.com/browse/PUP-6431', 'https://github.com/puppetlabs/puppet/commit/524dff2c2b5a89941e0a5be0278048d85d725317'),
('puppet', 147128, 81356990, 5200, 'regression: explicit undef cannot be used in create_resources', 'The following code works when evaluated from a manifest:\r\n{code:puppet}\r\npuppet apply -e "define foo($foo) {} foo { "FOO": foo => undef }"\r\n{code}\r\n\r\nBut not when done using {{create_resources}}.\r\n\r\nThe rule puppet should use is: if {{undef}} is given then use the default value if one exists, otherwise set an explicit undef. Now the {{create_resources}} function simply filters out all {{undef}} values. (If simply kept, there are other problems since relationships cannot handle undef entries.', 'https://tickets.puppetlabs.com/browse/PUP-6613', 'https://github.com/puppetlabs/puppet/pull/5200', '2016-08-15T05:35:20.000-0700', '2016-08-24T08:11:22.000-0700', '2016-08-24T08:11:22.000-0700', 'Closed', 'regression', 2, '0', 4, 40, 6, 6, '26af1815f839d8abae99bd35e15f531afd05ac2d', 'https://tickets.puppetlabs.com/browse/PUP-6613', 'https://github.com/puppetlabs/puppet/pull/5200'),
('puppet', 147642, 81708688, 5209, 'Puppet file `show_diff` setting leaks information', 'Because the sensitive data support in the transaction doesn"t propagate through all possible log points, types and providers can leak information by logging arbitrary information at arbitrary points. This is especially problematic because of the `show_diff` setting for files; files are the most common point where sensitive information may be leaked and `show_diff` bypasses this.\r\n\r\nIn the short term we should have special handling for diffing so that when a diff is potentially generated we check to see if the property being diffed is sensitive and redact it accordingly.', 'https://tickets.puppetlabs.com/browse/PUP-6627', 'https://github.com/puppetlabs/puppet/pull/5209', '2016-08-17T09:54:52.000-0700', '2016-08-24T08:11:22.000-0700', '2016-08-24T08:11:22.000-0700', 'Closed', '', 7, '0', 2, 96, 54, 8, 'c9bfa278b3c9a94c90ed3a760f9cdbb44a121745', 'https://tickets.puppetlabs.com/browse/PUP-6627', 'https://github.com/puppetlabs/puppet/pull/5209'),
('puppet', 144804, 80056906, 5172, 'Function call fails when using camel case for class names. It should be handled by puppet parser syntax validator', 'As we understand from the docs that capital letters are not allowed in class and module names but then it should be handled by parser while validating the syntax.', 'https://tickets.puppetlabs.com/browse/PUP-6574', 'https://github.com/puppetlabs/puppet/pull/5172', '2016-08-03T01:10:27.000-0700', '2016-08-24T08:11:24.000-0700', '2016-08-24T08:11:24.000-0700', 'Closed', 'learningVM;module', 9, '0', 3, 18, 6, 2, '0d33e8ccd2d0f99ec1a4e3c80a2eeddb45d55e0a', 'https://tickets.puppetlabs.com/browse/PUP-6574', 'https://github.com/puppetlabs/puppet/pull/5172'),
('puppet', 146469, 81284188, 5198, 'variable scoping change in Puppet 4.6.0', 'Variables defined in a class are not in scope after resource-like declaration of that class:\r\n\r\n{code}\r\n$ cat test.pp \r\nclass a($myvar = "hello") {}\r\nclass { "a": myvar => "goodbye" }\r\nnotify { $a::myvar: }\r\n\r\n$ puppet --version\r\n4.5.3\r\n$ puppet apply --strict_variables test.pp \r\nNotice: Compiled catalog for kvm-01.node.vagrant.consul in environment production in 0.03 seconds\r\nNotice: goodbye\r\nNotice: /Stage[main]/Main/Notify[goodbye]/message: defined "message" as "goodbye"\r\nNotice: Applied catalog in 0.02 seconds\r\n\r\n$ puppet --version\r\n4.6.0\r\n$ puppet apply --strict_variables test.pp \r\nError: Evaluation Error: Unknown variable: "a::myvar". at /home/vagrant/test.pp:3:10 on node kvm-01.node.vagrant.consul\r\n{code}\r\n\r\nWithout strict_variables it could be very dangerous.  Note that if you add an include, it works:\r\n\r\n{code}\r\n$ cat test.pp \r\nclass a($myvar = "hello") {}\r\nclass { "a": myvar => "goodbye" }\r\ninclude a\r\nnotify { $a::myvar: } \r\n\r\n$ puppet --version\r\n4.6.0\r\n$ puppet apply --strict_variables test.pp \r\nNotice: Compiled catalog for kvm-01.node.vagrant.consul in environment production in 0.09 seconds\r\nNotice: goodbye\r\nNotice: /Stage[main]/Main/Notify[goodbye]/message: defined "message" as "goodbye"\r\nNotice: Applied catalog in 0.02 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6608', 'https://github.com/puppetlabs/puppet/pull/5198', '2016-08-11T15:30:34.000-0700', '2016-08-24T08:33:37.000-0700', '2016-08-24T08:33:37.000-0700', 'Closed', 'regression', 12, '0', 1, 12, 4, 2, '25c946b253b857d579e818d9a4594cb698505902', 'https://tickets.puppetlabs.com/browse/PUP-6608', 'https://github.com/puppetlabs/puppet/pull/5198'),
('puppet', 147540, 81668053, 5205, 'Puppet function_loading benchmark performance degredation', 'On Windows 2008R2 / Ruby 2.1, commit https://github.com/puppetlabs/puppet/commit/01db61e24178a3baebbeaa1c58250fcbf447d8bc introduced a 10x performance degredation for the {{benchmark:function_loading}} micro-benchmark in the Puppet suite.  I used git bisect to identify that particular commit.\r\n\r\nh3. For {{2211c64}} (parent of {{01db61e}})\r\n\r\n{code}\r\nC:\source\puppet [(2211c64...) +68 ~0 -0 !]> bundle exec rake benchmark:function_loading\r\nDocument generation not available without yard. cannot load such file -- yard\r\nmkdir -p C:/Users/ADMINI~1/AppData/Local/Temp/function_loading20160816-3900-13bswjg\r\nDL is deprecated, please use Fiddle\r\n                 user     system      total        real\r\nRun 1       10.296000   2.125000  12.421000 ( 13.608853)\r\nRun 2        6.766000   1.031000   7.797000 (  8.749664)\r\nRun 3        8.078000   0.797000   8.875000 (  9.692987)\r\nRun 4        8.578000   0.891000   9.469000 ( 10.468348)\r\nRun 5        9.094000   0.844000   9.938000 ( 10.937080)\r\nRun 6        9.984000   0.844000  10.828000 ( 12.093286)\r\nRun 7       10.610000   0.844000  11.454000 ( 12.629397)\r\nRun 8       12.109000   0.843000  12.952000 ( 13.953529)\r\nRun 9       12.250000   1.032000  13.282000 ( 14.311859)\r\nRun 10      13.438000   0.828000  14.266000 ( 15.218068)\r\n> total:   101.203000  10.079000 111.282000 (121.663071)\r\n> avg:      10.120300   1.007900  11.128200 ( 12.166307)\r\n{code}\r\n\r\nh3. For {{01db61e}}\r\n\r\n{code}\r\nC:\source\puppet [(01db61e...) +68 ~0 -0 !]> bundle exec rake benchmark:function_loading\r\nDocument generation not available without yard. cannot load such file -- yard\r\nmkdir -p C:/Users/ADMINI~1/AppData/Local/Temp/function_loading20160816-49440-1miin4u\r\nDL is deprecated, please use Fiddle\r\n                 user     system      total        real\r\nRun 1      114.015000  14.797000 128.812000 (142.752140)\r\nRun 2      156.344000  14.547000 170.891000 (184.167353)\r\nRun 3      201.969000  13.188000 215.157000 (228.894914)\r\nRun 4      245.016000  12.828000 257.844000 (271.543842)\r\nRun 5      288.734000  13.312000 302.046000 (315.255168)\r\n{code}\r\n\r\nNOTE: The above was terminated prematurely given the obvious trend of a further decrease of performance on each run.\r\n\r\n\r\nh3. Current stable HEAD ({{13d208b2e935151c6b8cf77e8bf4ad1b45fc72c5}}) as of 8/16/2016\r\n\r\nSome corrective efforts appear to have already been taken to address this performance problem (and it"s compounding effect), but the current performance of latest code is still 3x slower than it was on versions of Puppet prior to {{4.6.0}}.\r\n\r\n{code}\r\nC:\source\puppet [stable...origin/stable +68 ~0 -0 !]> bundle exec rake benchmark:function_loading\r\nDocument generation not available without yard. cannot load such file -- yard\r\nmkdir -p C:/Users/ADMINI~1/AppData/Local/Temp/function_loading20160816-10824-x58pt6\r\nDL is deprecated, please use Fiddle\r\n                 user     system      total        real\r\nRun 1       29.266000   5.266000  34.532000 ( 35.654881)\r\nRun 2       24.453000   3.969000  28.422000 ( 29.694252)\r\nRun 3       25.563000   3.890000  29.453000 ( 30.420901)\r\nRun 4       26.453000   3.797000  30.250000 ( 31.485412)\r\nRun 5       27.219000   3.563000  30.782000 ( 31.846841)\r\nRun 6       30.390000   3.328000  33.718000 ( 34.311228)\r\nRun 7       29.047000   4.000000  33.047000 ( 33.956486)\r\nRun 8       28.938000   4.219000  33.157000 ( 34.445907)\r\nRun 9       36.890000   3.828000  40.718000 ( 42.357819)\r\nRun 10      59.438000   3.484000  62.922000 ( 64.077050)\r\n> total:   317.657000  39.344000 357.001000 (368.250777)\r\n> avg:      31.765700   3.934400  35.700100 ( 36.825078)\r\n{code}\r\n\r\nh3. Current master HEAD ({{50a20b2}} as of 8/16/2016\r\n\r\nMaster is also exhibiting the slow-down\r\n\r\n{code}\r\n:\source\puppet [master...origin/master +68 ~0 -0 !]> bundle exec rake benchmark:function_loading\r\nDocument generation not available without yard. cannot load such file -- yard\r\nmkdir -p C:/Users/ADMINI~1/AppData/Local/Temp/function_loading20160816-26064-1n6bwhd\r\nDL is deprecated, please use Fiddle\r\n                 user     system      total        real\r\nRun 1       29.563000   4.938000  34.501000 ( 35.829908)\r\nRun 2       24.343000   3.890000  28.233000 ( 29.436511)\r\nRun 3       25.782000   3.860000  29.642000 ( 30.963654)\r\nRun 4       25.609000   4.109000  29.718000 ( 30.983185)\r\nRun 5       26.328000   3.703000  30.031000 ( 31.282978)\r\nRun 6       28.610000   3.875000  32.485000 ( 33.677326)\r\nRun 7       26.296000   3.797000  30.093000 ( 31.264224)\r\nRun 8       28.157000   3.812000  31.969000 ( 33.066140)\r\nRun 9       53.203000   3.547000  56.750000 ( 58.190413)\r\nRun 10      53.531000   4.188000  57.719000 ( 58.727435)\r\n> total:   321.422000  39.719000 361.141000 (373.421774)\r\n> avg:      32.142200   3.971900  36.114100 ( 37.342177)\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6622', 'https://github.com/puppetlabs/puppet/pull/5205', '2016-08-16T13:44:23.000-0700', '2016-08-24T08:37:10.000-0700', '2016-08-24T08:37:10.000-0700', 'Closed', 'regression', 3, '0', 6, 81, 66, 7, 'ed11f972b6e8744c688e4e4d84b38321106450b1', 'https://tickets.puppetlabs.com/browse/PUP-6622', 'https://github.com/puppetlabs/puppet/pull/5205'),
('puppet', 147050, 81522768, 5203, 'Corrective Change in Puppet 4.6.0 incorrectly errors when custom types are incompatible with it', 'Puppet Agent 1.6.0 appears to break some of the cisco module functionality.  The results of the last test run show 15 of the 157  tests cases errored out with a "Could not evaluate" failure.\r\n\r\nEmail from Mike at Cisco\r\n{quote}\r\nHi Folks,\r\n\r\nWe actually discovered a problem with the new 1.6.0 rpm :(.  We have a few manifests that fail during application.  Here is an example.\r\n\r\nI tested this in the native bash shell\r\n\r\nroot@n9k-108#puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for n9k-108.cisco.com\r\nInfo: Applying configuration version "1471100275"\r\nNotice: /Stage[main]/Main/Node[default]/Cisco_tacacs_server[default]/ensure: created\r\nNotice: /Stage[main]/Main/Node[default]/Cisco_tacacs_server_host[1.1.1.1]/ensure: created\r\nNotice: /Stage[main]/Main/Node[default]/Cisco_aaa_group_tacacs[group1]/ensure: created\r\nError: Unknown failure comparing values [["group1"]] and [] using insync? on type: Cisco_aaa_authorization_login_exec_svc[test_exec] property: groups\r\nError: /Stage[main]/Main/Node[default]/Cisco_aaa_authorization_login_exec_svc[test_exec]: Could not evaluate: Validate method failed for class groups: undefined method `split" for ["group1"]:Array\r\nInfo: Node[default]: Unscheduling all events on Node[default]\r\nNotice: Applied catalog in 4.76 seconds\r\nroot@n9k-108#\r\n\r\nIf I use version 1.5.3 I don’t see the issue.\r\n\r\nHere is a full traceback of the issue:\r\n\r\nroot@n9k-108#puppet agent -t --trace\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for n9k-108.cisco.com\r\nInfo: Applying configuration version "1471100518"\r\nNotice: /Stage[main]/Main/Node[default]/Cisco_tacacs_server[default]/ensure: created\r\nNotice: /Stage[main]/Main/Node[default]/Cisco_tacacs_server_host[1.1.1.1]/ensure: created\r\nNotice: /Stage[main]/Main/Node[default]/Cisco_aaa_group_tacacs[group1]/ensure: created\r\nError: Unknown failure comparing values [["group1"]] and [] using insync? on type: Cisco_aaa_authorization_login_exec_svc[test_exec] property: groups\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/vendor/rgen/lib/rgen/array_extensions.rb:25:in `method_missing"\r\n/opt/puppetlabs/puppet/cache/lib/puppet/type/cisco_aaa_authorization_login_exec_svc.rb:77:in `block (3 levels) in <top (required)>"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parameter.rb:452:in `validate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:562:in `block in should="\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:562:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:562:in `should="\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:385:in `insync_values?"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/event.rb:112:in `calculate_corrective_change"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:161:in `sync_if_needed"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:88:in `block in perform_changes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:87:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:87:in `perform_changes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:21:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:224:in `apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:240:in `eval_resource"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:163:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:163:in `block (2 levels) in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:386:in `block in thinmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:385:in `thinmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:163:in `block in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:118:in `traverse"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:154:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:222:in `block in apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:155:in `with_destination"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/report.rb:137:in `as_logging_destination"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:221:in `apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:171:in `block in apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `block in benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:170:in `apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:343:in `run_internal"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:221:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:240:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:195:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:45:in `block (4 levels) in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:21:in `lock"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:45:in `block (3 levels) in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:98:in `with_client"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:42:in `block (2 levels) in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:65:in `run_in_fork"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:41:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:39:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:353:in `onetime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:331:in `run_command"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:540:in `exit_on_fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:132:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>"\r\nError: /Stage[main]/Main/Node[default]/Cisco_aaa_authorization_login_exec_svc[test_exec]: Could not evaluate: Validate method failed for class groups: undefined method `split" for ["group1"]:Array\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/vendor/rgen/lib/rgen/array_extensions.rb:25:in `method_missing"\r\n/opt/puppetlabs/puppet/cache/lib/puppet/type/cisco_aaa_authorization_login_exec_svc.rb:77:in `block (3 levels) in <top (required)>"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parameter.rb:452:in `validate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:562:in `block in should="\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:562:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:562:in `should="\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:396:in `insync_values?"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/event.rb:112:in `calculate_corrective_change"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:161:in `sync_if_needed"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:88:in `block in perform_changes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:87:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:87:in `perform_changes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:21:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:224:in `apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:240:in `eval_resource"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:163:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:163:in `block (2 levels) in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:386:in `block in thinmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:385:in `thinmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:163:in `block in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:118:in `traverse"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:154:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:222:in `block in apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:155:in `with_destination"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/report.rb:137:in `as_logging_destination"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:221:in `apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:171:in `block in apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `block in benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:170:in `apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:343:in `run_internal"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:221:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:240:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:195:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:45:in `block (4 levels) in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent/locker.rb:21:in `lock"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:45:in `block (3 levels) in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:98:in `with_client"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:42:in `block (2 levels) in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:65:in `run_in_fork"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:41:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:179:in `controlled_run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/agent.rb:39:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:353:in `onetime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/agent.rb:331:in `run_command"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:540:in `exit_on_fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:132:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>"\r\nInfo: Node[default]: Unscheduling all events on Node[default]\r\nNotice: Applied catalog in 4.84 seconds\r\nroot@n9k-108#\r\n{quote}\r\n\r\nI"m seeing the same error in the Cisco Module CI pipeline. ', 'https://tickets.puppetlabs.com/browse/PUP-6621', 'https://github.com/puppetlabs/puppet/pull/5203', '2016-08-13T10:31:06.000-0700', '2016-09-02T07:11:56.000-0700', '2016-09-02T07:11:56.000-0700', 'Closed', 'regression', 1, '0', 2, 2, 2, 2, 'fc9e5b02de9c3876abaafbf879b77423c4d74173', 'https://tickets.puppetlabs.com/browse/PUP-6621', 'https://github.com/puppetlabs/puppet/pull/5203'),
('puppet', 121207, 64043260, 4813, 'type mismatch error involving struct member should quote member name', 'With this function definitinon:\r\n{code:ruby}\r\n      local_types do\r\n        type "Radix       = Variant[Default, Integer[2,2], Integer[8,8], Integer[10,10], Integer[16,16]]"\r\n        type "Convertible = Variant[Undef, Integer, Float, Boolean, String]"\r\n        type "NamedArgs   = Struct[{from => Convertible, Optional[radix] => Radix}]"\r\n      end\r\n\r\n      dispatch :from_named_args do\r\n        param          "Convertible",  :from\r\n        optional_param "Radix",   :radix\r\n      end\r\n\r\n      dispatch :from_hash do\r\n        param          "NamedArgs",  :hash_args\r\n      end\r\n{code}\r\nAnd calling it with:\r\n{code:puppet}\r\nthe_function({from => 10, radix => 3})\r\n{code}\r\nThe error message is:\r\n{code}\r\nrejected: parameter "hash_args" struct member radix expects a value of type...\r\n{code}\r\nI expected the member name to be quoted like this:\r\n{code}\r\nrejected: parameter "hash_args" struct member "radix" expects a value of type...\r\n{code}\r\n\r\nIn this case it was readable without the quotes, but not when the struct  member name is\r\nsomething like "or",  "and", "struct", "expects", or "not rejected" :-)\r\n\r\nACCEPTANCE CRITERIA\r\n----\r\n* That the following example quotes the name {{"always"}}\r\n{code:puppet}\r\npuppet apply -e "function example(Struct[{always => Integer[100]}] $x) { }; example({always =>3})"\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6053', 'https://github.com/puppetlabs/puppet/pull/4813', '2016-03-13T16:42:15.000-0700', '2016-09-02T15:14:53.000-0700', '2016-09-02T15:14:53.000-0700', 'Closed', '', 3, '0', 1, 2, 2, 1, '5a940d98c4258c9ca5c99d4fc3b5f5377bcab64d', 'https://tickets.puppetlabs.com/browse/PUP-6053', 'https://github.com/puppetlabs/puppet/pull/4813'),
('puppet', 130546, 71934216, 5000, 'Cannot call type() function using postfix notation e.g 1.type() ', 'It does not work to call the {{type}} function using postfix /method call syntax.\r\n{code:puppet}\r\nnotice(1.type())\r\n{code}\r\nFails with a syntax error on "type".\r\n\r\nIt does however work when calling it as a function:\r\n{code:puppet}\r\nnotice(type(1))\r\n{code}\r\n ', 'https://tickets.puppetlabs.com/browse/PUP-6279', 'https://github.com/puppetlabs/puppet/pull/5000', '2016-05-09T09:24:15.000-0700', '2016-09-02T15:15:14.000-0700', '2016-09-02T15:15:14.000-0700', 'Closed', '', 1, '0', 1, 964, 942, 3, '7e6ea4aa61aa43f5483b5e7920f5457522e5acca', 'https://tickets.puppetlabs.com/browse/PUP-6279', 'https://github.com/puppetlabs/puppet/pull/5000'),
('puppet', 134104, 75483531, 5066, 'Validate and error if a class or define is given a name starting with ::', 'Update\r\n----\r\nIt is not allowed to use a a leading {{::}} (making a name absolute) when defining a class or a user defined resource type.\r\nNested definitions are named with a leading namespace from its container. It is not allowed to break out of that naming convention, and it is meaningless to use {{::}} before top level definitions.\r\n\r\nGiven that it also does not work to use definitions named with a leading {{::}} there is no backwards compatibility issue - only that error comes at compile time instead of when trying to use such a definition.\r\n\r\nOriginal\r\n----\r\nIf you create a class with a name that includes two colons, it appears (as it is difficult to ascertain) to generate a class with an illegal fully qualified name. You can then no longer reference the class because it is an illegal fully qualified name.\r\n\r\n{code}\r\n$ bundle exec puppet apply -e "class ::passwd {} include passwd"\r\nError: Evaluation Error: Error while evaluating a Function Call, Could not find class ::passwd for build03.nelson.va  at line 1:19 on node build03.nelson.va\r\n\r\n$ bundle exec puppet apply -e "class ::passwd {} include ::passwd"\r\nError: Evaluation Error: Error while evaluating a Function Call, Could not find class ::passwd for build03.nelson.va  at line 1:19 on node build03.nelson.va\r\n\r\n$ bundle exec puppet apply -e "class ::passwd {} include ::::passwd"\r\nError: Could not parse for environment production: Illegal fully qualified name  at line 1:29 on node build03.nelson.va\r\n\r\n$ bundle exec puppet apply -e "class passwd {} include passwd"\r\nNotice: Compiled catalog for build03.nelson.va in environment production in 0.05 seconds\r\nNotice: Applied catalog in 0.01 seconds\r\n\r\n$ bundle exec puppet apply -e "class passwd {} include ::passwd"\r\nNotice: Compiled catalog for build03.nelson.va in environment production in 0.05 seconds\r\nNotice: Applied catalog in 0.01 seconds\r\n\r\n$ bundle exec puppet --version\r\n4.5.0\r\n{code}\r\n\r\nI feel that attempting to define a class in a way that generates an illegal fully qualified name should generate an error during the definition, rather than during attempts to use it. This would be more clear to authors, earlier in their development process.', 'https://tickets.puppetlabs.com/browse/PUP-6361', 'https://github.com/puppetlabs/puppet/pull/5066', '2016-05-26T12:54:44.000-0700', '2016-09-02T15:15:24.000-0700', '2016-09-02T15:15:24.000-0700', 'Closed', '', 15, '0', 2, 31, 3, 3, 'b833fe8df7c353c3c777395caffe689d159d7ec7', 'https://tickets.puppetlabs.com/browse/PUP-6361', 'https://github.com/puppetlabs/puppet/pull/5066'),
('puppet', 148867, 82500130, 5229, 'Function dispatch taking zero arguments is incorrectly chosen', 'A Puppet function that is written in Ruby and has a dispatch that takes zero arguments will get a parameter tuple with no contents and no size. This means that the tuple is assignable from all other tuples which in turn means that the dispatch is chosen, no matter what actual parameters that was passed in the call.', 'https://tickets.puppetlabs.com/browse/PUP-6647', 'https://github.com/puppetlabs/puppet/pull/5229', '2016-08-24T00:55:36.000-0700', '2016-09-06T11:16:23.000-0700', '2016-09-06T11:16:23.000-0700', 'Closed', '', 2, '0', 1, 24, 1, 2, '21615ce8991206e62bc9918e903caf00bdc026ad', 'https://tickets.puppetlabs.com/browse/PUP-6647', 'https://github.com/puppetlabs/puppet/pull/5229'),
('puppet', 148939, 82672117, 5232, 'hiera_include doesn"t work when using environment catalogs and environment caching', 'To address PUP-6527, the environment compiler pre-defines a non-functional version of hiera_include at the start of compilation. This causes the "real" version, which will fail if used during environment compilation, to never be loaded. However, now that loaders are cached between compilations, there are a couple of serious issues with this behavior:\r\n\r\n• Environment catalog requests will fail if hiera_include is already present in the loader\r\n\r\nFor subsequent environment catalog requests, hiera_include has already either been loaded (if the previous request was for an agent catalog using hiera_include) in the loader or has been pre-loaded as a stub. Our attempt to explicitly define it causes a hard error, because it"s a redefinition. This happens whether hiera_include is being used or not; _multiple environment catalog requests will always fail if environment caching is enabled_.\r\n\r\n• hiera_include is non-functional during agent catalog requests following an environment catalog request\r\n\r\nIf the first request for a given process is for an environment catalog, a noop version of hiera_include is created. It will then persist through the lifetime of the environment cache, causing hiera_include in agent catalogs to do nothing. This happens with {{puppet job run}}, for instance.\r\n\r\nThe breaking change was [introduced in 4.6.1 in commit 95ff24739ce85c3b7ca5ca1bffee9247c0cc2c5e|https://github.com/puppetlabs/puppet/commit/95ff24739ce85c3b7ca5ca1bffee9247c0cc2c5e].', 'https://tickets.puppetlabs.com/browse/PUP-6650', 'https://github.com/puppetlabs/puppet/pull/5232', '2016-08-24T11:09:44.000-0700', '2016-09-07T13:20:08.000-0700', '2016-09-07T13:20:08.000-0700', 'Closed', 'regression', 6, '0', 1, 69, 23, 3, 'd471cde30e1173a19da09d78e2ac9ab0a21f5941', 'https://tickets.puppetlabs.com/browse/PUP-6650', 'https://github.com/puppetlabs/puppet/pull/5232'),
('puppet', 149711, 83361281, 5248, 'Sensitive values are not passed to 3.x user defined types and classes', 'When applying this:\r\n{code:puppet}\r\nclass toe(Sensitive[String] $x) {\r\n  notice $x\r\n}\r\nclass { toe: x => Sensitive("ouch") }\r\n{code}\r\nIt results in the error:\r\n{code}\r\nError while evaluating a Resource Statement, Class[Toe]: parameter "x" expects a Sensitive value, got String at /Users/henrik/git/puppet/sensitive.pp:4:1\r\n{code}\r\nThis is probably because of the transformation to 3.x values that only allows certain data types to pass into the 3.x compiler logic.', 'https://tickets.puppetlabs.com/browse/PUP-6662', 'https://github.com/puppetlabs/puppet/pull/5248', '2016-08-30T06:33:05.000-0700', '2016-09-07T13:21:15.000-0700', '2016-09-07T13:21:15.000-0700', 'Closed', '', 3, '0', 2, 64, 6, 4, '2eb69142e662f50ab819badf258d5f8893270af2', 'https://tickets.puppetlabs.com/browse/PUP-6662', 'https://github.com/puppetlabs/puppet/pull/5248'),
('puppet', 148235, 84571955, 5267, 'Integration test for Windows service fails on Windows 10', './spec/integration/provider/service/windows_spec.rb:33 uses the lmhosts service to test whether the service is enabled.\r\n\r\nHowever in Windows 10 the service startup type of lmhosts has changed to Manual (Trigger Start).  This means the test will fail because it expects the service to be of type Automatic.  This changed from Windows 8 to Windows 10.\r\n\r\nUnsure on the status for Windows Server.  I also believe that lmhosts will not be available on Nano Server (Could be wrong on that).\r\n\r\nThis test should be changed to not depend on the lmhosts having a startup type of Automatic.', 'https://tickets.puppetlabs.com/browse/PUP-6641', 'https://github.com/puppetlabs/puppet/pull/5267', '2016-08-19T14:06:13.000-0700', '2016-09-12T15:01:58.000-0700', '2016-09-12T15:01:58.000-0700', 'Resolved', '', 4, '0', 1, 3, 2, 1, 'eb1c0d45f0e875f30c4044ee85c6c0dd9bd93e93', 'https://tickets.puppetlabs.com/browse/PUP-6641', 'https://github.com/puppetlabs/puppet/pull/5267'),
('puppet', 11657, 23500825, 3252, 'Using the ENC with multiple environments can load classes that can"t be reloaded during a reparse of manifests', 'The ENC can specify a list of classes to load that may not be reachable if manifests are reparsed. If a manifest reparse is triggered (either through switching environments or because of a file change) any classes specified only by the ENC may be lost.\n\nWhen the catalog is being compiled, classes that are explicitly passed by an ENC are parsed first. Each class is explicitly loaded by name.\n\nDuring compilation all classes and related information is loaded into a TypeCollection instance. A number of circumstances can cause all of this to be dumped and reloaded. The code assumes that this is safe because after the information is dumped then an initial parse is triggered, starting with Puppet[:manifest]. When the ENC doesn’t supply an explicit list of classes then parsing the default manifest will find all manifests that can be reached.\n\nSince classes specified by the ENC are loaded by name, the assumption that all classes can by reached by parsing Puppet[:manifest] fails. If a reload is triggered then any classes explicitly loaded by the ENC will be permanently lost.\n\nThis is a copy of https://projects.puppetlabs.com/issues/21561', 'https://tickets.puppetlabs.com/browse/PUP-142', 'https://github.com/puppetlabs/puppet/pull/3252', '2013-07-02T19:22:30.000-0700', '2016-09-13T11:30:18.000-0700', '2016-09-13T11:30:18.000-0700', 'Closed', '', 1, '0', 1, 37, 4, 3, '14e257d6525ff1111b91ab5c18ac9a1d5d67d011', 'https://tickets.puppetlabs.com/browse/PUP-142', 'https://github.com/puppetlabs/puppet/pull/3252'),
('puppet', 11659, 11609927, 2267, 'Canonized type names and resource titles can only be looked up by creating a Puppet::Resource', 'When creating a new Puppet::Resource instance, the new object canonizes a number of values like the type and title for a given resource. Moreover the Puppet::Resource is the only class that can create these canonized values. This means that in a number of places we are forced to create a new Puppet resource with all the work that entails just to grab a single value and throw away everything else for the garbage collector.\n\nIn order to get a canonized type name, a new Puppet::Resource has to be created just to extract the canonized type, and that Puppet::Resource is then thrown away:\n\n  * https://github.com/puppetlabs/puppet/blob/3.2.2/lib/puppet/parser/ast/resource_defaults.rb#L15\n\n  * https://github.com/puppetlabs/puppet/blob/3.2.2/lib/puppet/parser/collector.rb#L77\n\n  * https://github.com/puppetlabs/puppet/blob/3.2.2/lib/puppet/transaction/report.rb#L339\n\nThe same problem occurs when trying to generate a resource reference.\n\nWhen the catalog needs to look up a resource by title, it has to create a new resource to determine the resource reference that’s being used to index the actual resource. The Puppet::Resource itself has a method to look up an identical resource in the catalog.\n\nThis is tangentially related to #15106 because Puppet::Resource::Catalog#resource generates a new resource every time that method is invoked, and inspecting the resource triggers #15106 in certain conditions.', 'https://tickets.puppetlabs.com/browse/PUP-144', 'https://github.com/puppetlabs/puppet/pull/2267', '2013-07-02T19:28:19.000-0700', '2016-09-13T11:33:05.000-0700', '2016-09-13T11:33:05.000-0700', 'Closed', '', 1, '0', 1, 189, 5, 2, '8408ac07970324df0a34ceaeeb50e9dbb08230b1', 'https://tickets.puppetlabs.com/browse/PUP-144', 'https://github.com/puppetlabs/puppet/pull/2267'),
('puppet', 140719, 76831150, 5103, '"puppet resource user", when run in Windows creates a login attempt. ', 'When running "puppet resource user" in Windows, the action results in a log entry in the Windows security log:\r\n\r\nLog Name:      Security\r\nSource:        Microsoft-Windows-Security-Auditing\r\nDate:          7/8/2016 10:26:11 PM\r\nEvent ID:      4625\r\nTask Category: Logon\r\nLevel:         Information\r\nKeywords:      Audit Failure\r\nUser:          N/A\r\nComputer:      pe-201612-agent-win2008\r\nDescription:\r\nAn account failed to log on.\r\n\r\nSubject:\r\n	Security ID:		PE-201612-AGENT\vagrant\r\n	Account Name:		vagrant\r\n	Account Domain:		PE-201612-AGENT\r\n	Logon ID:		0xf07a\r\n\r\nLogon Type:			3\r\n\r\nAccount For Which Logon Failed:\r\n	Security ID:		NULL SID\r\n	Account Name:		vagrant\r\n	Account Domain:		PE-201612-AGENT\r\n\r\nFailure Information:\r\n	Failure Reason:		Unknown user name or bad password.\r\n	Status:			0xc000006d\r\n	Sub Status:		0xc000006a\r\n\r\nProcess Information:\r\n	Caller Process ID:	0x538\r\n	Caller Process Name:	C:\Program Files\Puppet Labs\Puppet\sys\ruby\bin\ruby.exe\r\n\r\nNetwork Information:\r\n	Workstation Name:	PE-201612-AGENT\r\n	Source Network Address:	-\r\n	Source Port:		-\r\n\r\nDetailed Authentication Information:\r\n	Logon Process:		Advapi  \r\n	Authentication Package:	Negotiate\r\n	Transited Services:	-\r\n	Package Name (NTLM only):	-\r\n	Key Length:		0\r\n\r\nThis event is generated when a logon request fails. It is generated on the computer where access was attempted.\r\n\r\nThe Subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe Logon Type field indicates the kind of logon that was requested. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe Process Information fields indicate which account and process on the system requested the logon.\r\n\r\nThe Network Information fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n	- Transited services indicate which intermediate services have participated in this logon request.\r\n	- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n	- Key length indicates the length of the generated session key. This will be 0 if no session key was requested.\r\nEvent Xml:\r\n<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">\r\n  <System>\r\n    <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-A5BA-3E3B0328C30D}" />\r\n    <EventID>4625</EventID>\r\n    <Version>0</Version>\r\n    <Level>0</Level>\r\n    <Task>12544</Task>\r\n    <Opcode>0</Opcode>\r\n    <Keywords>0x8010000000000000</Keywords>\r\n    <TimeCreated SystemTime="2016-07-08T22:26:11.765645000Z" />\r\n    <EventRecordID>1682</EventRecordID>\r\n    <Correlation />\r\n    <Execution ProcessID="468" ThreadID="532" />\r\n    <Channel>Security</Channel>\r\n    <Computer>pe-201612-agent-win2008</Computer>\r\n    <Security />\r\n  </System>\r\n  <EventData>\r\n    <Data Name="SubjectUserSid">S-1-5-21-1860036329-3057280495-287023118-500</Data>\r\n    <Data Name="SubjectUserName">vagrant</Data>\r\n    <Data Name="SubjectDomainName">PE-201612-AGENT</Data>\r\n    <Data Name="SubjectLogonId">0xf07a</Data>\r\n    <Data Name="TargetUserSid">S-1-0-0</Data>\r\n    <Data Name="TargetUserName">vagrant</Data>\r\n    <Data Name="TargetDomainName">PE-201612-AGENT</Data>\r\n    <Data Name="Status">0xc000006d</Data>\r\n    <Data Name="FailureReason">%%2313</Data>\r\n    <Data Name="SubStatus">0xc000006a</Data>\r\n    <Data Name="LogonType">3</Data>\r\n    <Data Name="LogonProcessName">Advapi  </Data>\r\n    <Data Name="AuthenticationPackageName">Negotiate</Data>\r\n    <Data Name="WorkstationName">PE-201612-AGENT</Data>\r\n    <Data Name="TransmittedServices">-</Data>\r\n    <Data Name="LmPackageName">-</Data>\r\n    <Data Name="KeyLength">0</Data>\r\n    <Data Name="ProcessId">0x538</Data>\r\n    <Data Name="ProcessName">C:\Program Files\Puppet Labs\Puppet\sys\ruby\bin\ruby.exe</Data>\r\n    <Data Name="IpAddress">-</Data>\r\n    <Data Name="IpPort">-</Data>\r\n  </EventData>\r\n</Event>\r\n\r\nThis can result in inadvertent user lockouts.', 'https://tickets.puppetlabs.com/browse/PUP-6483', 'https://github.com/puppetlabs/puppet/pull/5103', '2016-07-08T15:39:40.000-0700', '2016-09-20T23:11:11.000-0700', '2016-09-20T23:11:11.000-0700', 'Closed', 'customer-escalation', 9, '0', 2, 52, 5, 6, 'fa2b3ea67feca21de27ea14e325e037f7a2af260', 'https://tickets.puppetlabs.com/browse/PUP-6483', 'https://github.com/puppetlabs/puppet/pull/5103'),
('puppet', 151938, 85326571, 5280, 'Minor improvement to agent failover test (originally PUP-6383)', 'On 9/14 we had a failed cell (spurious failure) in the matrix run for test {{acceptance/tests/reports/failover_master.rb}} due to a timeout sending the report to the master for the test "master_field should not appear when no master could be contacted". \r\n\r\nThat test currently uses two nonexistent servers in a server list and specifies a timeout of 3 seconds, and checks that the master does not show up in the report for the value `master_used`. \r\n\r\nThis ticket is to update that test to increase the timeout, but only check with one nonexistent master as a way to diminish the impact on overall test time of increasing the timeout. The fact that two masters are specified isn"t actually intrinsic to the test. ', 'https://tickets.puppetlabs.com/browse/PUP-6703', 'https://github.com/puppetlabs/puppet/pull/5280', '2016-09-14T16:11:15.000-0700', '2016-09-21T11:27:52.000-0700', '2016-09-21T11:27:52.000-0700', 'Resolved', 'ci', 2, '0', 1, 1, 1, 1, '43bc2eeb058ee14cdc529459033d020dc7b6e980', 'https://tickets.puppetlabs.com/browse/PUP-6703', 'https://github.com/puppetlabs/puppet/pull/5280'),
('puppet', 22949, 12618944, 2364, 'yum provider doesn"t respect items provided by a package, only the package name', 'A simple use case:\r\n\r\nIn EL5 and earlier, the curl development headers were included in a package called curl-devel.  In EL6 and later that package was renamed to libcurl-devel.  However, the libcurl-devel package still provides curl-devel.  \r\n\r\nWhen using something like \r\n\r\n    package { "curl-devel":\r\n      ensure => installed\r\n    }\r\n\r\npuppet looks for this package every time. \r\n\r\n    [root@centos6-32 ~]# puppet resource package libcurl-devel\r\n    warning: Package kernel found in both yum and yum; skipping the yum version\r\n    warning: Package gpg-pubkey found in both yum and yum; skipping the yum version\r\n    package { "libcurl-devel":\r\n      ensure => "7.19.7-26.el6_1.2",\r\n    }\r\n    [root@centos6-32 ~]# puppet resource package curl-devel\r\n    warning: Package kernel found in both yum and yum; skipping the yum version\r\n    warning: Package gpg-pubkey found in both yum and yum; skipping the yum version\r\n    package { "curl-devel":\r\n        ensure => "absent",\r\n    }\r\n    [root@centos6-32 ~]# rpm -q --whatprovides curl-devel\r\n    libcurl-devel-7.19.7-26.el6_1.2.i686\r\n    [root@centos6-32 ~]# \r\n\r\nThe yum provider should basically use the way yum work to make this happen.  If I do "yum install curl-devel" on EL6, it pulls in libcurl-devel.  If I then do an rpm -q --whatprovides curl-devel it shows that libcurl-devel provides that, and thus something does not need to be installed.  \r\n\r\nFixing this would likely have the side-benefit of being able to use the file installation methods on yum as well.  Such as\r\n    yum install /usr/bin/foo\r\n\r\nPuppet would be like\r\n  package { "/usr/bin/foo": \r\n     ensure => installed,\r\n  }\r\n\r\nThat would then install whatever package contains the file /usr/bin/foo, as yum from the CLI does.  \r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1366', 'https://github.com/puppetlabs/puppet/pull/2364', '2014-01-03T14:48:31.000-0800', '2016-09-22T15:17:31.000-0700', '2016-09-22T15:17:31.000-0700', 'Closed', 'redmine;yum', 3, '0', 1, 32, 5, 3, '', 'https://tickets.puppetlabs.com/browse/PUP-1366', 'https://github.com/puppetlabs/puppet/pull/2364'),
('puppet', 108831, 53392361, 4497, 'No error on duplicate parameters on classes and resources', 'I think that the following is a bug:\r\n\r\n{code:java}\r\nclass test (\r\n  $a = "first",\r\n  $a = "second",\r\n) {\r\n  notice($a)\r\n}\r\n\r\ninclude test\r\n{code}\r\n\r\nresults in:\r\n\r\n{code:java}\r\nNotice: Scope(Class[Test]): second\r\n{code}\r\n\r\nIf two parameters with the same name are added to a class or resource an error should be thrown in my opinion. This would also solve the problem, that this looks like it violates the no reassignment rule.', 'https://tickets.puppetlabs.com/browse/PUP-5590', 'https://github.com/puppetlabs/puppet/pull/4497', '2015-12-09T07:38:04.000-0800', '2016-09-26T05:26:18.000-0700', '2016-09-26T05:26:18.000-0700', 'Closed', 'puppethack', 4, '0', 1, 31, 0, 4, '8df197b7046bedad928c648dfcbf434c386a09df', 'https://tickets.puppetlabs.com/browse/PUP-5590', 'https://github.com/puppetlabs/puppet/pull/4497'),
('puppet', 147927, 85088991, 5275, 'Puppet"s fileserver seems to be unable to handle a path containing a directory called "environment"', 'I have the following in one of my manifest files (using the logstash module provided by elasticsearch):\r\n{code}  logstash::configfile { "environment_filters":\r\n    source => "puppet:///modules/zedcore/logstash/filters/environment/${::environment}.conf",\r\n    order  => 500,\r\n  }{code}\r\nThis boils down to a request for {{puppet:///modules/zedcore/logstash/filters/environment/${::environment}.conf}} from the fileserver.\r\n\r\nI was trying to apply this manifest in my environment "dev_chrisb", which I do have checked out to {{/etc/puppetlabs/code/environments/dev_chrisb}}. However, despite the file existing in the location {{modules/zedcore/files/logstash/filters/environment/dev_chrisb.conf}}, I am getting an error from the puppet agent:\r\n\r\n{code}Error: /Stage[main]/Logstash::Config/File_concat[ls-config]: Failed to generate additional resources using "eval_generate": Could not retrieve source(s) puppet:///modules/zedcore/logstash/filters/environment/dev_chrisb.conf{code}\r\n\r\nOn the puppet server the following is logged:\r\n{code}2016-08-18 16:55:27,924 INFO  [qtp955127719-13340] [puppetserver] Puppet Not Found: dev_chrisb.conf is not a known environment{code}\r\n\r\nand the access log:\r\n{code}192.168.0.113 - - [18/Aug/2016:16:55:27 +0100] "GET /puppet/v3/file_metadata/modules/zedcore/logstash/filters/environment/dev_chrisb.conf?environment=dev_chrisb& HTTP/1.1" 404 101 "-" "Ruby" 6{code}\r\n\r\nIt looks like Puppet is failing to parse the URL correctly because of the directory called {{environment}}. If I rename that directory to {{env}}, with no other changes to my manifests, it works perfectly fine.\r\n\r\nThis manifest worked in Puppet 3.7.2 before we upgraded to 4.', 'https://tickets.puppetlabs.com/browse/PUP-6636', 'https://github.com/puppetlabs/puppet/pull/5275', '2016-08-18T09:42:25.000-0700', '2016-09-28T05:24:51.000-0700', '2016-09-28T05:24:51.000-0700', 'Closed', '', 9, '0', 1, 16, 1, 2, '13f2c994c976b52ba01e2ffe975d2029066aba33', 'https://tickets.puppetlabs.com/browse/PUP-6636', 'https://github.com/puppetlabs/puppet/pull/5275'),
('puppet', 18018, 78945492, 5149, 'Solaris pkg package provider does not handle expiring certificates', 'When the {{pkg}} command issues a warning like\r\n\r\n{noformat}\r\nCertificate "/var/pkg/ssl/21c5ab9143663d2d698f6f3a7d41a81603cd1a6f" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "28" days.\r\n{noformat}\r\n\r\nThe pkg provider, when doing {{ensure => latest}} does not handle that response while determining the latest version and issues:\r\n\r\n{noformat}\r\nError: /Stage[main]//Package[mypkg]: Could not evaluate: Could not get latest version: Unknown line format pkg: Certificate "/var/pkg/ssl/21c5ab9143663d2d698f6f3a7d41a81603cd1a6f" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "28" days.\r\n{noformat}\r\n\r\nI expect that the provider handles the warning, issues a warning of its own so that the information is not lost, and then proceeds as normal.', 'https://tickets.puppetlabs.com/browse/PUP-643', 'https://github.com/puppetlabs/puppet/pull/5149', '2013-10-31T09:17:00.000-0700', '2016-09-30T09:56:56.000-0700', '2016-09-30T09:56:56.000-0700', 'Closed', '', 1, '0', 3, 139, 7, 6, 'd5b39c9001cdbc67d37ebb841c5fcbdad6f77d32', 'https://tickets.puppetlabs.com/browse/PUP-643', 'https://github.com/puppetlabs/puppet/pull/5149'),
('puppet', 18829, 751892927, 8783, 'Encoding mis-matches cause package prefetching to fail', 'One of our RPM packages has some UTF-8 characters in its description, leading to an exception ("Error: Could not prefetch package provider "yum": invalid byte sequence in US-ASCII")  in rpm.rb, causing no packages to be upgraded as the yumhelper.py invocation code raises that error.\r\n\r\nPriority=High because it breaks file { ensure => latest; }.', 'https://tickets.puppetlabs.com/browse/PUP-736', 'https://github.com/puppetlabs/puppet/pull/8783', '2013-11-13T11:28:58.000-0800', '2016-09-30T14:42:31.000-0700', '2016-09-30T14:42:31.000-0700', 'Closed', 'customer;encoding;i18n;redmine;utf-8', 12, '0', 1, 37, 4, 4, '9a354968f74607289aa3edacdc587f68c3bb5d4e', 'https://tickets.puppetlabs.com/browse/PUP-736', 'https://github.com/puppetlabs/puppet/pull/8783'),
('puppet', 21356, 476162094, 8303, 'puppet fails if template contains invalid utf-8', 'If you attempt to use a file resource with a "content" parameter pointing at a template, and the template contains binary content, you may get an error like this:\r\n\r\n{code}\r\n    Error: Failed to apply catalog: Parameter content failed: Munging failed for value ...\r\n    invalid byte sequence in UTF-8\r\n{code}\r\n\r\nI"ve reproduced the failure in 2.7.16 and 3.x, though the error messages differ slightly between the two (and also depending on whether you repro via "apply" or via master/agent run).\r\n\r\nI"m attaching the binary file that I"m using to repro.  Save it into a directory structure like this:\r\n\r\n{code}\r\n    modules/mymod/templates/mytemplate.erb\r\n{code}\r\n\r\nAdd the "modules" directory to your module path and then you can repro with the following manifest:\r\n\r\n{code}\r\n    file { "/tmp/myfile":\r\n        mode => 755,\r\n        content => template("mymod/mytemplate.erb"),\r\n    }\r\n{code}\r\n\r\nNote that if you use the "source" parameter rather than the "content" parameter (and avoid calling the template function), the manifest can be applied successfully; so the issue is when bringing in binary data as a string.', 'https://tickets.puppetlabs.com/browse/PUP-1038', 'https://github.com/puppetlabs/puppet/pull/8303', '2013-12-16T03:00:44.000-0800', '2016-09-30T15:34:18.000-0700', '2016-09-30T15:34:18.000-0700', 'Closed', 'i18n;redmine;utf-8', 5, '0', 1, 1, 352, 17, '63446562777bf9b4e2692d1f3ece0af53299ef33', 'https://tickets.puppetlabs.com/browse/PUP-1038', 'https://github.com/puppetlabs/puppet/pull/8303'),
('puppet', 80929, 36485956, 3977, 'User resource fails with UTF-8 comment on 2nd run', 'I"m seeing something similar to PUP-1473 but only on the 2nd and subsequent runs :\r\n\r\n{code}\r\n[root@marionette tmp]# cat pup-1473.pp \r\n# pup-1473.pp\r\n\r\nuser { "bubba" :\r\n  comment => "™",\r\n  ensure => present,\r\n}\r\n[root@marionette tmp]# puppet apply pup-1473.pp \r\nNotice: Compiled catalog for marionette.example.com in environment production in 0.40 seconds\r\nNotice: /Stage[main]/Main/User[bubba]/ensure: created\r\nNotice: Applied catalog in 0.05 seconds\r\n[root@marionette tmp]# grep bubba /etc/passwd\r\nbubba:x:1029:1029:™:/home/bubba:/bin/bash\r\n[root@marionette tmp]# puppet apply pup-1473.pp \r\nNotice: Compiled catalog for marionette.example.com in environment production in 0.39 seconds\r\nError: Could not convert change "comment" to string: incompatible character encodings: UTF-8 and ASCII-8BIT\r\nError: Could not convert change "comment" to string: incompatible character encodings: UTF-8 and ASCII-8BIT\r\nError: /Stage[main]/Main/User[bubba]: Could not evaluate: Puppet::Util::Log requires a message\r\nNotice: Applied catalog in 0.03 seconds\r\n[root@marionette tmp]# rpm -qa "*puppet*"\r\npuppet-agent-1.0.1-1.el7.x86_64\r\npuppetlabs-release-pc1-0.9.2-1.el7.noarch\r\npuppetserver-2.0.0-1.el7.noarch\r\npuppetdb-terminus-2.3.4-1.el7.noarch\r\npuppetdb-2.3.4-1.el7.noarch\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-4633', 'https://github.com/puppetlabs/puppet/pull/3977', '2015-05-20T03:59:56.000-0700', '2016-10-04T13:28:49.000-0700', '2016-10-04T13:28:49.000-0700', 'Closed', '', 4, '0', 1, 18, 9, 2, '302369f4c335ffb87983506dcac6679de22878cc', 'https://tickets.puppetlabs.com/browse/PUP-4633', 'https://github.com/puppetlabs/puppet/pull/3977'),
('puppet', 135139, 72394860, 5003, 'Cumulus Linux 3.0 default service provider should be systemd', 'With Cumulus Linux 3.0, the default service provider uses the debian default of init instead of systemd that ships with CL 3.0', 'https://tickets.puppetlabs.com/browse/PUP-6381', 'https://github.com/puppetlabs/puppet/pull/5003', '2016-06-02T11:26:16.000-0700', '2016-10-05T11:43:58.000-0700', '2016-10-05T11:43:58.000-0700', 'Closed', '', 2, '0', 1, 19, 8, 4, '686d5ca1b3e3390bc5f5e4c3665427ebe3620801', 'https://tickets.puppetlabs.com/browse/PUP-6381', 'https://github.com/puppetlabs/puppet/pull/5003'),
('puppet', 128474, 0, 0, 'Serivce SMF should set has_feature :refreshable', 'smf understands the concept of restart, the smf provider should set the refreshable feature', 'https://tickets.puppetlabs.com/browse/PUP-6238', '', '2016-04-26T17:00:09.000-0700', '2016-10-05T12:03:43.000-0700', '2016-10-05T12:03:43.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, 'f3f2aee5e774e93398027c430ffe2c3d6c94ea7b', 'https://tickets.puppetlabs.com/browse/PUP-6238', 'https://github.com/puppetlabs/puppet/commit/f3f2aee5e774e93398027c430ffe2c3d6c94ea7b'),
('puppet', 132637, 70714764, 4973, 'DNF provider cannot update packages (install command will not update)', 'tl;dr *dnf install* will not install a newer version of a package if it"s already installed:\r\n\r\n{code}\r\n[root@fedora-22-x64 vagrant]# /bin/dnf -y install cockpit\r\nLast metadata expiration check performed 0:18:07 ago on Thu May 19 13:40:06 2016.\r\nPackage cockpit-0.67-2.fc22.x86_64 is already installed, skipping.\r\nDependencies resolved.\r\nNothing to do.\r\nComplete!\r\n{code}\r\n\r\nFull log of proof:\r\n\r\n{code}\r\n[root@fedora-22-x64 vagrant]# rpm -qa cockpit\r\ncockpit-0.67-2.fc22.x86_64\r\n[root@fedora-22-x64 vagrant]# dnf list cockpit\r\nLast metadata expiration check performed 0:17:14 ago on Thu May 19 13:40:06 2016.\r\nInstalled Packages\r\ncockpit.x86_64                                     0.67-2.fc22                                       @System\r\nAvailable Packages\r\ncockpit.src                                        0.106-1.fc22                                      group_cockpit-cockpit-preview\r\ncockpit.x86_64                                     0.106-1.fc22                                      group_cockpit-cockpit-preview\r\n[root@fedora-22-x64 vagrant]# puppet resource package cockpit\r\npackage { "cockpit":\r\n  ensure => "0.67-2.fc22",\r\n}\r\n[root@fedora-22-x64 vagrant]# puppet resource package cockpit ensure=latest --debug\r\nDebug: Prefetching dnf resources for package\r\nDebug: Executing: "/bin/rpm --version"\r\nDebug: Executing "/bin/rpm -qa --nosignature --nodigest --qf "%{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n""\r\nDebug: Executing: "/bin/dnf check-update"\r\nDebug: /Package[cockpit]/ensure: cockpit "0.67-2.fc22" is installed, latest is "0:0.94-1.fc22"\r\nDebug: Package[cockpit](provider=dnf): Ensuring => latest\r\nDebug: Executing: "/bin/dnf -d 0 -e 1 -y install cockpit"\r\nNotice: /Package[cockpit]/ensure: ensure changed "0.67-2.fc22" to "0:0.94-1.fc22"\r\nDebug: Finishing transaction 36208880\r\nDebug: Storing state\r\nDebug: Stored state in 0.01 seconds\r\nDebug: Executing: "/bin/rpm -q cockpit --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n"\r\npackage { "cockpit":\r\n  ensure => "0.67-2.fc22",\r\n}\r\n[root@fedora-22-x64 vagrant]# /bin/dnf -y install cockpit\r\nLast metadata expiration check performed 0:18:07 ago on Thu May 19 13:40:06 2016.\r\nPackage cockpit-0.67-2.fc22.x86_64 is already installed, skipping.\r\nDependencies resolved.\r\nNothing to do.\r\nComplete!\r\n[root@fedora-22-x64 vagrant]# /bin/dnf -y upgrade cockpit\r\nLast metadata expiration check performed 0:18:26 ago on Thu May 19 13:40:06 2016.\r\nDependencies resolved.\r\n==================================================================================================================================\r\n Package                              Arch         Version                              Repository                           Size\r\n==================================================================================================================================\r\nInstalling:\r\n cockpit-networkmanager               noarch       0.106-1.fc22                         group_cockpit-cockpit-preview        42 k\r\n cockpit-storaged                     noarch       0.106-1.fc22                         group_cockpit-cockpit-preview        52 k\r\n device-mapper-multipath              x86_64       0.4.9-73.fc22                        fedora                              116 k\r\n device-mapper-multipath-libs         x86_64       0.4.9-73.fc22                        fedora                              215 k\r\n iscsi-initiator-utils                x86_64       6.2.0.873-25.gitc9d830b.fc22         fedora                              423 k\r\n iscsi-initiator-utils-iscsiuio       x86_64       6.2.0.873-25.gitc9d830b.fc22         fedora                               83 k\r\n libstoraged                          x86_64       2.1.2-1.fc22                         group_cockpit-cockpit-preview       119 k\r\n python3                              x86_64       3.4.2-6.fc22                         updates                              53 k\r\n python3-libs                         x86_64       3.4.2-6.fc22                         updates                             6.6 M\r\n python3-pip                          noarch       6.0.8-1.fc22                         fedora                              1.7 M\r\n python3-setuptools                   noarch       17.1.1-3.fc22                        updates                             406 k\r\n storaged                             x86_64       2.1.2-1.fc22                         group_cockpit-cockpit-preview       360 k\r\n storaged-lvm2                        x86_64       2.1.2-1.fc22                         group_cockpit-cockpit-preview        64 k\r\nUpgrading:\r\n cockpit                              x86_64       0.106-1.fc22                         group_cockpit-cockpit-preview        43 k\r\n cockpit-bridge                       x86_64       0.106-1.fc22                         group_cockpit-cockpit-preview       184 k\r\n cockpit-docker                       x86_64       0.106-1.fc22                         group_cockpit-cockpit-preview        51 k\r\n cockpit-shell                        noarch       0.106-1.fc22                         group_cockpit-cockpit-preview       727 k\r\n cockpit-ws                           x86_64       0.106-1.fc22                         group_cockpit-cockpit-preview       487 k\r\n\r\nTransaction Summary\r\n==========================================================================e\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6324', 'https://github.com/puppetlabs/puppet/pull/4973', '2016-05-19T07:12:04.000-0700', '2016-10-05T14:47:57.000-0700', '2016-10-05T14:47:57.000-0700', 'Resolved', '', 12, '0', 1, 375, 480, 6, '0fbce6530b47f9d723785cff7a2d7673cd1fe10e', 'https://tickets.puppetlabs.com/browse/PUP-6324', 'https://github.com/puppetlabs/puppet/pull/4973'),
('puppet', 156905, 89420730, 5331, 'Running beaker tests locally on Windows fails due to missing rubygems cert', 'On Windows, when adding the rubygems source to the vendored rubygems in puppet-agent, the gem command will fail with: \r\n\r\n{code}\r\nError fetching https://rubygems.org:\r\n                SSL_connect returned=1 errno=0 state=error: certificate verify failed (https://api.rubygems.org/specs.4.8.gz)>\r\n{code}\r\n\r\nWe can fix this by pointing the gem command helper at our packaged SSL cert file.', 'https://tickets.puppetlabs.com/browse/PUP-6819', 'https://github.com/puppetlabs/puppet/pull/5331', '2016-10-14T10:04:15.000-0700', '2016-10-17T10:03:48.000-0700', '2016-10-17T10:03:48.000-0700', 'Closed', '', 1, '0', 1, 5, 1, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-6819', 'https://github.com/puppetlabs/puppet/pull/5331'),
('puppet', 126195, 71640932, 4996, 'OSX Passwords not setting under Puppet 4.4.1', 'Managing the passwords for local users under OSX 10.9, 10.10 and 10.11 under puppet 4.4.1 fails when setting the salt, iterations and password. \r\n\r\nSteps to re-create:\r\n\r\nUsed the following command to generate a user definition and saved it to test.pp\r\n\r\n{code}\r\npuppet resource user test >> test.pp\r\n{code}\r\n\r\n{code:puppet}\r\nuser { "test":\r\n  ensure     => "present",\r\n  comment    => "test",\r\n  gid        => "20",\r\n  groups     => ["com.apple.sharepoint.group.2"],\r\n  home       => "/Users/test",\r\n  iterations => "46948",\r\n  password   => "9690da8dd8f90f6e3fed4f267c86110e29d75e8448efdacdee9bd5cc20f81a563c9e6c6c328694fac80910ba99508cc373525ac592b87fbec0ac1a1e26a51f01873c25f2450aa78e09c8498df0f11fa930c3f655e7aeed6bc61e8475ca84297b3a2273d31974ddd232e872d9b66be82d0246d094d60155c93c6b7a27ba1aa390",\r\n  salt       => "62133b77a7aeecf506ffe99d064b3f8c068344de0a619a573a871f2fd6fe9eaf",\r\n  shell      => "/bin/bash",\r\n  uid        => "503",\r\n}\r\n{code}\r\n\r\n\r\nWhen running puppet apply on the above definition I get the following errors:\r\n\r\n{code}\r\nError: "\x96" on UTF-8\r\nError: /Stage[main]/Main/User[test]/password: change from [old password hash redacted] to [new password hash redacted] failed: "\x96" on UTF-8\r\n\r\nError: "\xA7" on UTF-8\r\nError: /Stage[main]/Main/User[test]/salt: change from 6f13b4510093e89a0098eff8ee5d4bae3e1314ebf31064c101cd886ad8c2fab6 to 62133b77a7aeecf506ffe99d064b3f8c068344de0a619a573a871f2fd6fe9eaf failed: "\xA7" on UTF-8\r\n\r\nError: "\xD2" followed by "\x01" on UTF-8\r\nError: /Stage[main]/Main/User[test]/iterations: change from 43290 to 46948 failed: "\xD2" followed by "\x01" on UTF-8\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6159', 'https://github.com/puppetlabs/puppet/pull/4996', '2016-04-12T03:07:56.000-0700', '2016-10-17T14:17:37.000-0700', '2016-10-17T14:17:37.000-0700', 'Closed', '', 4, '0', 1, 34, 0, 1, '57dc7e6e88c396a15bddf54627973585550f78bc', 'https://tickets.puppetlabs.com/browse/PUP-6159', 'https://github.com/puppetlabs/puppet/pull/4996'),
('puppet', 19010, 407325833, 8110, 'FFI native windows root certs code', 'We"ve gotten reports of the windows agent crashing, and found a few issues with how we are calling native Win32 APIs, effectively using pointers encoded as ascii-8bit strings. We need to move to using FFI, which provides a number of "type-safe" benefits, e.g. pointer sizes on x86 vs x64 platforms, etc.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-766', 'https://github.com/puppetlabs/puppet/pull/8110', '2013-11-15T14:04:05.000-0800', '2016-10-19T10:46:58.000-0700', '2016-10-19T10:46:58.000-0700', 'Closed', 'redmine', 2, '0', 2, 47, 1, 3, '15b2e709b10e85b0ec95f85a47605f0f2f812a5a', 'https://tickets.puppetlabs.com/browse/PUP-766', 'https://github.com/puppetlabs/puppet/pull/8110'),
('puppet', 37610, 27735295, 3498, 'Puppet specs on windows triggers "Excluding C from search path. Fact file paths must be an absolute directory"', 'Per Josh in HipChat:\r\n\r\nwhen using as_platform => "posix" and running on windows\r\nwe switch File::PATH_SEPARATOR to ":", which confuses facter\r\non windows', 'https://tickets.puppetlabs.com/browse/PUP-2699', 'https://github.com/puppetlabs/puppet/pull/3498', '2014-05-29T13:29:10.000-0700', '2016-10-19T10:46:59.000-0700', '2016-10-19T10:46:59.000-0700', 'Closed', 'windows', 1, '0', 1, 19, 71, 13, 'ad54e56afab718a2f918960b80b2886fa9c823d1', 'https://tickets.puppetlabs.com/browse/PUP-2699', 'https://github.com/puppetlabs/puppet/pull/3498'),
('puppet', 24344, 74693071, 5042, 'scheduled_task won"t update command', 'if you update a scheduled_task"s command, Puppet does not make the change in the task scheduler. Other changes, e.g. the trigger, appear to work, but not the command.\r\n\r\nI"ve had to work around by deleting the old task and creating a new one with a different name.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1498', 'https://github.com/puppetlabs/puppet/pull/5042', '2014-01-23T07:24:57.000-0800', '2016-10-19T10:47:01.000-0700', '2016-10-19T10:47:01.000-0700', 'Closed', 'scheduled_task;windows', 13, '0', 1, 9, 3, 2, 'c05ad3e3a1398ded18ad687362dc84e810799366', 'https://tickets.puppetlabs.com/browse/PUP-1498', 'https://github.com/puppetlabs/puppet/pull/5042'),
('puppet', 22314, 18382232, 2872, 'puppet module tool on windows will (sometimes) create a PaxHeader directory', 'In Puppet 3.2 the module tool started using minitar when the tar executable is not present. It turns out that minitar does not understand the [PAX|http://en.wikipedia.org/wiki/Pax_(Unix)] format.\r\n\r\nAn example of a module that was created with this is [liamjbennet/win_facts v0.0.1|https://forge.puppetlabs.com/liamjbennett/win_facts/0.0.1]. When that module is installed the problem appears as follows.\r\n\r\n{noformat}\r\nC:\Program Files (x86)\Puppet Labs\Puppet\bin>puppet module install liamjbennett\r\n-win_facts\r\nNotice: Preparing to install into C:/ProgramData/PuppetLabs/puppet/etc/modules .\r\n..\r\nNotice: Downloading from https://forge.puppetlabs.com ...\r\nNotice: Installing -- do not interrupt ...\r\nC:/ProgramData/PuppetLabs/puppet/etc/modules\r\n└── liamjbennett-win_facts (v0.0.1)\r\n\r\nC:\Program Files (x86)\Puppet Labs\Puppet\bin>puppet apply -e "notice hello"\r\nError loading fact C:/ProgramData/PuppetLabs/puppet/etc/modules/win_facts/lib/fa\r\ncter/PaxHeader/operatingsystemversion.rb C:/ProgramData/PuppetLabs/puppet/etc/mo\r\ndules/win_facts/lib/facter/PaxHeader/operatingsystemversion.rb:1: syntax error,\r\nunexpected tIDENTIFIER, expecting $end\r\n17 gid=790807719\r\n      ^\r\nError loading fact C:/ProgramData/PuppetLabs/puppet/etc/modules/win_facts/lib/fa\r\ncter/PaxHeader/windows_productkey.rb C:/ProgramData/PuppetLabs/puppet/etc/module\r\ns/win_facts/lib/facter/PaxHeader/windows_productkey.rb:1: syntax error, unexpect\r\ned tIDENTIFIER, expecting $end\r\n17 gid=790807719\r\n      ^\r\nError loading fact C:/ProgramData/PuppetLabs/puppet/etc/modules/win_facts/lib/fa\r\ncter/PaxHeader/windows_sid.rb C:/ProgramData/PuppetLabs/puppet/etc/modules/win_f\r\nacts/lib/facter/PaxHeader/windows_sid.rb:1: syntax error, unexpected tIDENTIFIER\r\n, expecting $end\r\n17 gid=790807719\r\n      ^\r\n\r\n........\r\n{noformat}\r\n\r\nThe error is because those files are not ruby files:\r\n\r\n{noformat}\r\nC:\Program Files (x86)\Puppet Labs\Puppet\bin>type  C:\ProgramData\PuppetLabs\puppet\etc\modules\win_facts\lib\facter\PaxHeader\windows_systemtype.rb\r\n17 gid=790807719\r\n18 uid=2140070515\r\n20 ctime=1366908908\r\n20 atime=1366908908\r\n24 SCHILY.dev=234881026\r\n23 SCHILY.ino=78693886\r\n18 SCHILY.nlink=1\r\n{noformat}\r\n\r\nThere is a very good write up on the PaxHeader and problems of mixing tools that can be found at http://tickets.opscode.com/browse/CHEF-4107.\r\n\r\nIt doesn"t appear that these warnings actually cause problems, but they do clutter up the output and cause fright.', 'https://tickets.puppetlabs.com/browse/PUP-1186', 'https://github.com/puppetlabs/puppet/pull/2872', '2013-12-19T07:33:31.000-0800', '2016-10-19T10:47:02.000-0700', '2016-10-19T10:47:02.000-0700', 'Closed', 'redmine;windows', 11, '0', 1, 22, 3, 2, '0278cb28307a0b7c8660127b0795859f3e659825', 'https://tickets.puppetlabs.com/browse/PUP-1186', 'https://github.com/puppetlabs/puppet/pull/2872'),
('puppet', 41810, 19855294, 2979, 'Puppet searches disk for whit classes', 'Our Puppet instance has been pretty slow lately so we traced a puppet agent run to see what it was doing. In the trace we see a bunch of lines like this:\r\n\r\nstat("/opt/local/lib/ruby/site_ruby/2.0.0/puppet/vendor/semantic/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/etc/puppet/modules/admin/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/etc/puppet/modules/percona/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/etc/puppet/shared/modules/apt/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/etc/puppet/shared/modules/puppetlabs-stdlib/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/etc/puppet/external/modules/python/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/etc/puppet/external/modules/yum_puppet_plugin/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/var/lib/puppet/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/opt/local/lib/ruby/gems/2.0.0/gems/bigdecimal-1.2.0/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/opt/local/lib/ruby/gems/2.0.0/gems/bundler-1.5.3/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/opt/local/lib/ruby/gems/2.0.0/gems/byebug-3.1.2/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/opt/local/lib/ruby/gems/2.0.0/gems/columnize-0.8.9/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\nstat("/opt/local/lib/ruby/gems/2.0.0/gems/daemons-1.1.9/lib/puppet/type/completed_stage.rb", 0xFFFFFD7FFFDFE4A0) Err#2 ENOENT\r\n\r\nWhich means that Puppet is attempting to find a file in a bunch of different locations, which we believe is part of a process Puppet goes through when trying to find and load a class or function. In total, we see around 20,000 attempts to open files that fit the completed_ or admissible_ pattern.\r\n\r\nI dug in to what it was trying to find and found this: https://github.com/puppetlabs/puppet/blob/2350ed0db1264040864ad4dfc9908429d6298eb1/lib/puppet/type/whit.rb. My understanding is that a Whit is essentially a virtual graph node which appears before or after a regular graph node. I don"t find any cases of us calling these in our Puppet repo, so I"m assuming that its internal Puppet code of some kind that is asking for these.\r\n\r\nSo it appears to me that Puppet is defining a virtual class type then searching disk for it through some set of directories including every gem it sees, every time it is accessed, on every run of Puppet. Am I totally misunderstanding this or Is there something we as users could be doing to create this situation? Is this the default behavior? If so, it seems broken or insane to me. Please talk me off this ledge!', 'https://tickets.puppetlabs.com/browse/PUP-2924', 'https://github.com/puppetlabs/puppet/pull/2979', '2014-07-10T17:12:17.000-0700', '2016-10-19T10:47:04.000-0700', '2016-10-19T10:47:04.000-0700', 'Closed', '', 14, '0', 1, 34, 14, 2, '347144773b43ac0318a578679b83f064679b3a1e', 'https://tickets.puppetlabs.com/browse/PUP-2924', 'https://github.com/puppetlabs/puppet/pull/2979'),
('puppet', 14948, 30982687, 3704, 'Manage hidden windows packages', 'Currently, the windows package provider excludes hidden applications (those whose SystemComponent registry value is set to 1) from its {{instances}} method (both exe and msi). This is done so that puppet has parity with what is displayed in Add/Remove Programs, e.g. {{SQL Server 2008 R2 SP2 Common Files}} .\r\n\r\nBut it means if you install a hidden application, then puppet won"t know it"s installed, and try to reinstall it next time. For example, https://groups.google.com/d/topic/puppet-users/ftvvO51bX1U/discussion', 'https://tickets.puppetlabs.com/browse/PUP-400', 'https://github.com/puppetlabs/puppet/pull/3704', '2013-09-19T00:24:47.000-0700', '2016-10-19T10:47:04.000-0700', '2016-10-19T10:47:04.000-0700', 'Closed', 'windows', 8, '0', 1, 0, 4, 4, '52db5e25cf60a2f6bbcecc9b50faf765e581054d', 'https://tickets.puppetlabs.com/browse/PUP-400', 'https://github.com/puppetlabs/puppet/pull/3704'),
('puppet', 39921, 19817706, 2973, 'Solaris Zone properties ip, dataset and inherit are not set upon zone creation', 'The {{ip}}, {{dataset}} and {{inherit}} properties of the Zone type each have [insync methods|https://github.com/puppetlabs/puppet/blob/3.6.2/lib/puppet/type/zone.rb#L252-L253] that respond with {{true}} when passed a {{nil}} property value. When a zone resource is first created, the property hash looks like:\r\n\r\n{code}\r\n{\r\n  ensure => :absent\r\n}\r\n{code}\r\n\r\nThis means that every property value aside from {{ensure}} is {{nil}} which causes ip, dataset and inherit to be skipped during zone creation. After creation, {{:absent}} is used in the hash instead of {{nil}}.\r\n\r\nHowever, in the case of {{inherit}}, the inherited directories of a Solaris 10 zone cannot be changed after creation:\r\n\r\n{noformat}\r\necho "add inherit-pkg-dir\r\nset dir=/opt/puppet\r\nend\r\ncommit" | /usr/sbin/zonecfg -z test -f -\r\n\r\nOn line 1:\r\nZone test already installed; add inherit-pkg-dir not allowed.\r\nOn line 2:\r\nCannot set a resource-specific property from the global scope.\r\nOn line 3:\r\nThe end command only makes sense in the resource scope.\r\n{noformat}\r\n\r\nTo quote the official [Solaris 10 documentation|http://docs.oracle.com/cd/E19044-01/sol.containers/817-1592/z.conf.start-29/index.html]:\r\n\r\n{quote}\r\nThese resources cannot be modified or removed after the zone has been installed using zoneadm.\r\n{quote}\r\n\r\nSo, eventual consistency does no good for the {{inherit}} property.', 'https://tickets.puppetlabs.com/browse/PUP-2817', 'https://github.com/puppetlabs/puppet/pull/2973', '2014-06-20T14:59:13.000-0700', '2016-10-19T10:47:06.000-0700', '2016-10-19T10:47:06.000-0700', 'Closed', 'customer;solaris;support;type_zone', 24, '0', 1, 48, 8, 3, '86785e149d498cd13e5de484c17250a354610c3f', 'https://tickets.puppetlabs.com/browse/PUP-2817', 'https://github.com/puppetlabs/puppet/pull/2973'),
('puppet', 41062, 19636184, 2960, '`puppet resource service` not working for `cryptdisks-udev`', 'Issuing _puppet resource service cryptdisks-udev_ outputs \r\nbq. Error: Could not run: Execution of "/sbin/status cryptdisks-udev" returned 1: status: Unknown parameter: DEVNAME\r\n\r\nSince puppet stops there _puppet resource service_ won"t work as well.', 'https://tickets.puppetlabs.com/browse/PUP-2879', 'https://github.com/puppetlabs/puppet/pull/2960', '2014-07-02T10:43:06.000-0700', '2016-10-19T10:47:07.000-0700', '2016-10-19T10:47:07.000-0700', 'Closed', '', 6, '0', 1, 5, 1, 2, 'a061b76dcc18af982e4ff34b4a5b270fd918fe0d', 'https://tickets.puppetlabs.com/browse/PUP-2879', 'https://github.com/puppetlabs/puppet/pull/2960'),
('puppet', 41514, 19550798, 2955, 'Regression when pluginsyncing external facts on Windows', 'Ticket PUP-2705 restored the ability for pluginsync to preserve permissions for external facts synced to {{facts.d}}. However, on Windows, it generates a deprecation warning, which users cannot fix:\r\n\r\n{noformat}\r\nC:\work\puppet> bundle exec puppet agent -t\r\n...\r\nInfo: Retrieving pluginfacts\r\nWarning: Copying owner/mode/group from the source file on Windows is deprecated; use source_permissions => ignore.\r\n   (at C:/cygwin64/lib/ruby/site_ruby/1.9.1/puppet/type/file/source.rb:133:in `block in copy_source_values")\r\nNotice: /File[C:/ProgramData/PuppetLabs/puppet/var/facts.d]/mode: mode changed "0700" to "0755"\r\nInfo: Retrieving plugin\r\nInfo: Loading external facts from C:/ProgramData/PuppetLabs/puppet/var/facts.d\r\n{noformat}\r\n\r\nThe plugin_handler should specify {{:use}} on posix, and {{:ignore}} on windows.', 'https://tickets.puppetlabs.com/browse/PUP-2907', 'https://github.com/puppetlabs/puppet/pull/2955', '2014-07-08T09:50:00.000-0700', '2016-10-19T10:47:10.000-0700', '2016-10-19T10:47:10.000-0700', 'Closed', 'customer;support', 2, '0', 3, 170, 59, 7, '1888bc0ce9c5bd853f7197af1f2453b58cf82719', 'https://tickets.puppetlabs.com/browse/PUP-2907', 'https://github.com/puppetlabs/puppet/pull/2955'),
('puppet', 47592, 19751298, 2965, 'Fix cfacter integration to match recent cfacter changes', 'cfacter has changed its gem so that most of the implementation now lies in the C++ source.  This means we can entirely remove lib/facts.rb and change the cfacter option implementation to simply call a single method in the gem.', 'https://tickets.puppetlabs.com/browse/PUP-3050', 'https://github.com/puppetlabs/puppet/pull/2965', '2014-08-12T17:25:29.000-0700', '2016-10-19T10:47:11.000-0700', '2016-10-19T10:47:11.000-0700', 'Closed', '', 5, '0', 1, 7, 99, 5, 'a85d492ff5934a9ff0fb79f1542d4104ed4b80fc', 'https://tickets.puppetlabs.com/browse/PUP-3050', 'https://github.com/puppetlabs/puppet/pull/2965'),
('puppet', 47740, 19754685, 2967, 'Restore constants / deprecated call sites changed during x64 upgrade that impact ACL module', 'When {{Puppet::Util::Windows::File}} and {{Puppet::Util::Windows::Security}} were refactored, mixins from older versions of the {{windows-pr]} gem were removed.\r\n\r\nAt the time, we didn"t check downstream modules to see if they were consuming any of the mixed in methods or constants.\r\n\r\nA scan through the ACL module has revealed that some methods were not properly redirected with deprecation messages.  Furthermore, a few necessary constants were either moved, or not restored to the classes that were originally mixed into.\r\n\r\nConstants that need to be restored are\r\n\r\n{code}\r\nGENERIC_WRITE\r\nGENERIC_EXECUTE\r\nGENERIC_ALL\r\n\r\nDELETE\r\n{code}\r\n\r\nThe list of redirections includes\r\n\r\n{code}\r\n  Puppet::Util::ADSI::User -> Puppet::Util::Windows::ADSI::User\r\n\r\n  Windows::File::FILE_ALL_ACCESS -> Puppet::Util::Windows::File::FILE_ALL_ACCESS\r\n  Windows::File::FILE_EXECUTE -> Puppet::Util::Windows::File::FILE_EXECUTE\r\n  Windows::File::FILE_GENERIC_WRITE -> Puppet::Util::Windows::File::FILE_GENERIC_WRITE\r\n  Windows::File::FILE_GENERIC_READ -> Puppet::Util::Windows::File::FILE_GENERIC_READ\r\n  Windows::File::FILE_GENERIC_EXECUTE -> ?? Puppet::Util::Windows::File::FILE_GENERIC_EXECUTE\r\n  Windows::File::FILE_WRITE_DATA -> Puppet::Util::Windows::File::FILE_WRITE_DATA\r\n  Windows::File::FILE_WRITE_ATTRIBUTES -> Puppet::Util::Windows::File::FILE_WRITE_ATTRIBUTES\r\n  Windows::File::FILE_READ_DATA  -> Puppet::Util::Windows::File::FILE_READ_DATA\r\n  Windows::File::FILE_APPEND_DATA -> Puppet::Util::Windows::File::FILE_APPEND_DATA\r\n\r\n  Windows::File::GENERIC_ALL -> Puppet::Util::Windows::File::GENERIC_ALL\r\n  Windows::File::GENERIC_WRITE -> Puppet::Util::Windows::File::GENERIC_WRITE\r\n  Windows::File::GENERIC_READ -> Puppet::Util::Windows::File::GENERIC_READ\r\n  Windows::File::GENERIC_EXECUTE -> Puppet::Util::Windows::File::GENERIC_EXECUTE\r\n  \r\n  Windows::File::READ_CONTROL -> Puppet::Util::Windows::Security::READ_CONTROL\r\n  \r\n  Windows::File::DELETE -> Puppet::Util::Windows::Security::DELETE\r\n\r\n  Windows::Security::GENERIC_ALL -> Puppet::Util::Windows::File::GENERIC_ALL\r\n  \r\n  Puppet::Util::Windows::Security.valid_sid?() -> Puppet::Util::Windows::SID.valid_sid?()\r\n  Puppet::Util::Windows::Security.name_to_sid() -> Puppet::Util::Windows::SID.name_to_sid()\r\n  Puppet::Util::Windows::Security.sid_to_name() -> Puppet::Util::Windows::SID.sid_to_name()\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3056', 'https://github.com/puppetlabs/puppet/pull/2967', '2014-08-13T14:24:34.000-0700', '2016-10-19T10:47:11.000-0700', '2016-10-19T10:47:11.000-0700', 'Closed', 'windows', 2, '0', 1, 4, 0, 2, 'f7907307cb7eb5b8225a99ec0c8d42a50d5e1eb5', 'https://tickets.puppetlabs.com/browse/PUP-3056', 'https://github.com/puppetlabs/puppet/pull/2967'),
('puppet', 48386, 21818424, 3121, 'reported catalog run time is wildly inaccurate', 'The puppet client clearly does not actually use wallclock time to calculate how long a puppet run takes.\r\n\r\nHere are a few examples of puppet runs with the time command:\r\n\r\n# time puppet agent -t\r\n....\r\nNotice: Finished catalog run in 131.19 seconds\r\n\r\nreal    3m32.015s\r\nuser    1m48.207s\r\nsys     0m18.101s\r\n\r\n\r\n# time puppet agent -t\r\n....\r\n\r\nNotice: Finished catalog run in 89.43 seconds\r\n\r\nreal    2m52.423s\r\nuser    1m42.438s\r\nsys     0m15.805s\r\n\r\nOn a box that is much less busy:\r\n\r\n# time puppet agent -t\r\n....\r\nNotice: Finished catalog run in 8.97 seconds\r\n\r\nreal	0m14.911s\r\nuser	0m3.896s\r\nsys	0m1.640s\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3081', 'https://github.com/puppetlabs/puppet/pull/3121', '2014-08-19T08:07:51.000-0700', '2016-10-19T10:47:12.000-0700', '2016-10-19T10:47:12.000-0700', 'Closed', '', 4, '0', 1, 2, 2, 2, 'fbf42c143c6217916dbe423c3a7457ed238e716c', 'https://tickets.puppetlabs.com/browse/PUP-3081', 'https://github.com/puppetlabs/puppet/pull/3121'),
('puppet', 27602, 31982532, 3755, 'Puppet should execute ruby.exe not cmd.exe when running as a windows service', 'Currently, when puppet runs as a service on windows, it executes a batch script (in a cmd.exe process), which then invokes ruby.exe. The child process then calls back into the service control manager, and that causes the service control manager to issue a warning in the application event log that a different process registered as a service than the one it launched.\r\n\r\nIdeally, the service control manager should launch ruby.exe directly along with whatever arguments are necessary to do so.\r\n\r\nIf the puppet service is running when a new version is installed, or existing version repaired, Windows Installer may issue the warning, "The setup must update files or services that cannot be updated while the system is running. If you choose to continue, a reboot will be required to complete the setup." I believe this occurs because ruby.exe is not the executable associated with the service, so the installer just thinks the file is in use. This issue can be triggered easily by setting runinterval=5, e.g. run puppet every 5 seconds, and then trying to upgrade/repair.', 'https://tickets.puppetlabs.com/browse/PUP-1802', 'https://github.com/puppetlabs/puppet/pull/3755', '2014-02-27T15:52:42.000-0800', '2016-10-19T10:47:13.000-0700', '2016-10-19T10:47:13.000-0700', 'Closed', 'windows', 15, '0', 1, 1, 1, 1, '42fca520209fc9363f37f275df7f47e4a159a70f', 'https://tickets.puppetlabs.com/browse/PUP-1802', 'https://github.com/puppetlabs/puppet/pull/3755'),
('puppet', 35358, 25519212, 3379, 'Remove 1.8.7 support in the ruby code base', 'Starting with any reference to "1.8" in the codebase should be a decent guide to what to remove / purge. Don"t forget .travis.yml!\r\n\r\nAnd remove from the puppet-4 specs matrix when done.', 'https://tickets.puppetlabs.com/browse/PUP-2563', 'https://github.com/puppetlabs/puppet/pull/3379', '2014-05-13T12:05:49.000-0700', '2016-10-19T10:47:16.000-0700', '2016-10-19T10:47:16.000-0700', 'Closed', '', 14, '0', 1, 10, 2, 2, '6fe4743733c59c6749acffcc9b5bb23444131a0d', 'https://tickets.puppetlabs.com/browse/PUP-2563', 'https://github.com/puppetlabs/puppet/pull/3379'),
('puppet', 22646, 28086686, 3525, 'Tidy causes "Cannot alias" ArgumentError exception on Windows', 'This example:\r\n<pre>\r\nclass puppet-bug {\r\n\r\n  file { "C:\bug":\r\n    ensure => directory,\r\n  }\r\n\r\n  tidy { "C:\bug":\r\n    recurse => true,\r\n    backup  => false\r\n  }\r\n\r\n  file { "C:\bug\test.txt":\r\n    content => "Look, a bug!"\r\n  }\r\n\r\n}\r\n</pre>\r\n\r\nCauses this error:\r\n\r\n<pre>\r\nerr: Got an uncaught exception of type ArgumentError: Cannot alias File[C:\bug/test.txt] to ["C:/bug/test.txt"]; resource ["File", "C:/bug/test.txt"] already declared at /etc/puppet/modules/puppet-bug/manifests/init.pp:14\r\n</pre>\r\n\r\nIt appears to be due to the way slashes are handled on Windows. If you change the tidy to "C:/bug" it all works just fine and the duplicate resource is detected and excluded from the tidy as expected.  \r\n\r\nThat might be an acceptable fix, except when you"re using variables for File resources that are also used as msiexec parameters and thus can"t have Unix slashes. :)\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1276', 'https://github.com/puppetlabs/puppet/pull/3525', '2013-12-30T10:24:13.000-0800', '2016-10-19T10:47:18.000-0700', '2016-10-19T10:47:18.000-0700', 'Closed', 'redmine;windows', 4, '0', 1, 10, 0, 2, '9fe24dffa09ab2609cefa540b165d93905369966', 'https://tickets.puppetlabs.com/browse/PUP-1276', 'https://github.com/puppetlabs/puppet/pull/3525'),
('puppet', 54190, 22526515, 3174, 'Remove defunct code from Puppet::Util::Autoload', 'The Autoload class has quite a bit of code that serves no purpose and may falsely indicate functionality that does no longer exist. Once instance is the ability to wrap autoloaded code; Autoload instances can be created with {{:wrap => true}}, but that option is never passed to the code that actually performs the loading. In addition there is logic for storing and retrieving Autoload instances which has zero callers. This should all be torn out.', 'https://tickets.puppetlabs.com/browse/PUP-3433', 'https://github.com/puppetlabs/puppet/pull/3174', '2014-10-09T15:33:32.000-0700', '2016-10-19T10:47:20.000-0700', '2016-10-19T10:47:20.000-0700', 'Closed', '', 2, '0', 4, 7, 51, 8, '8812d0e081af51a86ddb8fdf6be816cf8474100e', 'https://tickets.puppetlabs.com/browse/PUP-3433', 'https://github.com/puppetlabs/puppet/pull/3174'),
('puppet', 53001, 23251724, 3230, 'Remove serialization of indirector requests', 'Commit https://github.com/puppetlabs/puppet/commit/1cbe2ad7 added the ability to serialize an indirector request so that requests could be transported over mcollective. This functionality was never implemented, and never will be. We need to remove this code.', 'https://tickets.puppetlabs.com/browse/PUP-3370', 'https://github.com/puppetlabs/puppet/pull/3230', '2014-09-30T09:52:27.000-0700', '2016-10-19T10:47:21.000-0700', '2016-10-19T10:47:21.000-0700', 'Closed', '', 2, '0', 1, 0, 138, 2, 'ac182a84b37396a2a290d353426127b4a3c2f709', 'https://tickets.puppetlabs.com/browse/PUP-3370', 'https://github.com/puppetlabs/puppet/pull/3230'),
('puppet', 20010, 216736911, 7102, 'expanded_relationship.dot should not have both containment and relationship edges', '# Overview #\r\n\r\nRunning against master (2.7.0rc3-135-g520cbc0) I notice that using --graph has obvious cycles in the graph when the catalog itself does not actually have cycles and applies cleanly.\r\n\r\nPlease see the attached screenshot.\r\n\r\nTalking with Daniel, the suspicion is that the graphing output is not drawing a distinction between containment edges and relationship edges and is displaying both in the graph output.\r\n\r\n# Desired Behavior #\r\n\r\nThe graph output should only display relationship edges between resources as it does with Puppet 2.6 and earlier.\r\n\r\n# Actual Behavior #\r\n\r\nVisible cycles are displayed in the graph output when there are no relationship edge cycles.\r\n\r\n# Steps to reproduce #\r\n\r\nA simple catalog should show some resources looping against themselves.  I can provide example manifests upon request.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-914', 'https://github.com/puppetlabs/puppet/pull/7102', '2013-12-03T08:59:22.000-0800', '2016-10-19T10:47:23.000-0700', '2016-10-19T10:47:23.000-0700', 'Closed', 'redmine', 18, '0', 2, 120, 1, 4, '3ebcc5e6c227ebe7221781d188afb37ea254c1bc', 'https://tickets.puppetlabs.com/browse/PUP-914', 'https://github.com/puppetlabs/puppet/pull/7102'),
('puppet', 19495, 261339781, 7428, 'upstart service operating system confine should include redhat and centos', 'RedHat EL 6 and Centos 6 both use upstart for init.  The upstart service type should be able to be used on those systems as well.\r\n\r\nI have done some very minor testing to make sure it at least works to ensure services are running and stopped.', 'https://tickets.puppetlabs.com/browse/PUP-876', 'https://github.com/puppetlabs/puppet/pull/7428', '2013-11-22T08:12:19.000-0800', '2016-10-19T10:47:25.000-0700', '2016-10-19T10:47:25.000-0700', 'Closed', 'customer;redmine', 17, '0', 1, 18, 10, 3, '20c3c014ea2990184579f0f4ea32e27ade3ddd60', 'https://tickets.puppetlabs.com/browse/PUP-876', 'https://github.com/puppetlabs/puppet/pull/7428'),
('puppet', 13656, 378548485, 7993, 'Mode is required when specifying the file owner & group', '', 'https://tickets.puppetlabs.com/browse/PUP-264', 'https://github.com/puppetlabs/puppet/pull/7993', '2013-08-26T15:28:21.000-0700', '2016-10-19T10:47:26.000-0700', '2016-10-19T10:47:26.000-0700', 'Closed', 'windows', 8, '0', 2, 95, 55, 2, 'fa796c9f8961298870c9a94b3e25f1869affd5e5', 'https://tickets.puppetlabs.com/browse/PUP-264', 'https://github.com/puppetlabs/puppet/pull/7993'),
('puppet', 13655, 36862940, 3996, 'Don"t remove access control entries for LocalSystem', 'The current windows file provider will remove access control entries for file/dir for the SYSTEM account unless explicitly specified as the user or group. This can cause problems. See https://projects.puppetlabs.com/issues/15559 for more info.', 'https://tickets.puppetlabs.com/browse/PUP-263', 'https://github.com/puppetlabs/puppet/pull/3996', '2013-08-26T15:25:45.000-0700', '2016-10-19T10:47:27.000-0700', '2016-10-19T10:47:27.000-0700', 'Closed', 'windows', 13, '0', 1, 26, 2, 5, 'd78ea2f11ba9ace812b0c90d45fb1086866e0fb3', 'https://tickets.puppetlabs.com/browse/PUP-263', 'https://github.com/puppetlabs/puppet/pull/3996'),
('puppet', 13657, 16830315, 2745, 'Don"t set owner/group/mode if none are specified', '', 'https://tickets.puppetlabs.com/browse/PUP-265', 'https://github.com/puppetlabs/puppet/pull/2745', '2013-08-26T15:36:21.000-0700', '2016-10-19T10:47:27.000-0700', '2016-10-19T10:47:27.000-0700', 'Closed', 'windows', 5, '0', 2, 26, 13, 5, 'bf6f5c4e67c527d97da2dd3ee692692c8b9a8981', 'https://tickets.puppetlabs.com/browse/PUP-265', 'https://github.com/puppetlabs/puppet/pull/2745'),
('puppet', 20946, 311982823, 7691, 'Update ACL armature', 'Review jcbollinger"s feedback and update armature, taking into account hiera, and the discussion about "data" objects.', 'https://tickets.puppetlabs.com/browse/PUP-995', 'https://github.com/puppetlabs/puppet/pull/7691', '2013-12-11T13:51:56.000-0800', '2016-10-19T10:47:28.000-0700', '2016-10-19T10:47:28.000-0700', 'Resolved', '', 1, '0', 1, 23, 6, 2, 'c1516b7e0f45f52e78f5717915ae47ad2309f6b1', 'https://tickets.puppetlabs.com/browse/PUP-995', 'https://github.com/puppetlabs/puppet/pull/7691'),
('puppet', 39118, 17807513, 2825, 'Support Bundler workflow on x64', 'Puppet expresses Windows gem dependencies, but it only applies to ruby x86. When running on x64, the gem dependencies do not apply, so you can"t use bundler to install gems, and run specs.\r\n\r\nCurrently, puppet"s Gemfile uses the bundler `mingw` platform identifier, effectively:\r\n\r\n{noformat}\r\nplatform :mingw do\r\n  gem "ffi"\r\n  ...\r\nend\r\n{noformat}\r\n\r\n{{Bundler::Dependency::PLATFORM_MAP}} maps that to the rubygems platform {{MINGW}}:\r\n\r\n{noformat}\r\n      :mingw    => Gem::Platform::MINGW,\r\n{noformat}\r\n\r\nWhen run on ruby 1.9.3 x86, the {{MINGW}} gem platform is a match:\r\n\r\n{noformat}\r\nirb(main):010:0> Gem::Platform.local.to_s\r\n=> "x86-mingw32"\r\nirb(main):011:0> Gem::Platform.match(Gem::Platform::MINGW)\r\n=> true\r\n{noformat}\r\n\r\nBut on ruby 2 x64, it is not:\r\n\r\n{noformat}\r\nirb(main):011:0> Gem::Platform.local.to_s\r\n=> "x64-mingw32"\r\nirb(main):012:0> Gem::Platform.match(Gem::Platform::MINGW)\r\n=> false\r\n{noformat}\r\n\r\nAs a result, dependencies that are currently expressed for x86-mingw, do not apply when run on ruby 2 x64.', 'https://tickets.puppetlabs.com/browse/PUP-2777', 'https://github.com/puppetlabs/puppet/pull/2825', '2014-06-13T13:52:34.000-0700', '2016-10-19T10:47:29.000-0700', '2016-10-19T10:47:29.000-0700', 'Closed', 'windows', 10, '0', 1, 1, 1, 1, 'f6eb2afe292902d1fccaeadb71425da9ee6d12be', 'https://tickets.puppetlabs.com/browse/PUP-2777', 'https://github.com/puppetlabs/puppet/pull/2825'),
('puppet', 30569, 14190521, 2490, 'Allow Inheritance when setting Deny ACEs', 'With Access Control Entries (ACEs) on Windows, we currently use [AddAccessDeniedAce|http://msdn.microsoft.com/en-us/library/windows/desktop/aa374962(v=vs.85).aspx] which does not include inheritance and/or propagation to child objects, but [AddAccessDeniedAceEx|http://msdn.microsoft.com/en-us/library/windows/desktop/aa374964(v=vs.85).aspx] does. We are already using AddAccessAllowedAceEx when setting access allowed ACEs and we should use the same behavior for denied ACEs.', 'https://tickets.puppetlabs.com/browse/PUP-2100', 'https://github.com/puppetlabs/puppet/pull/2490', '2014-03-31T09:54:46.000-0700', '2016-10-19T10:47:32.000-0700', '2016-10-19T10:47:32.000-0700', 'Closed', 'windows', 3, '0', 1, 22, 3, 2, '8eaa3b094622e6c0969ebb630477ae7c059f46a9', 'https://tickets.puppetlabs.com/browse/PUP-2100', 'https://github.com/puppetlabs/puppet/pull/2490'),
('puppet', 22832, 26926288, 3451, 'Service provider in RedHat will not create K?? stop scripts', 'When a service is set to be enabled the provider/service/redhat.rb provider will run "/sbin/chkconfig $name on" which will only create the links for starting the service but will not for stopping it. The correct command is "/sbin/chkconfig --add $name".\r\n\r\nThis is important for those services that require stopping cleanly before other services.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1343', 'https://github.com/puppetlabs/puppet/pull/3451', '2014-01-02T15:03:05.000-0800', '2016-10-19T10:47:34.000-0700', '2016-10-19T10:47:34.000-0700', 'Closed', 'redmine', 15, '0', 2, 64, 4, 3, 'fdfbcc06101d8b7bb9112321952ecbb01ee773b6', 'https://tickets.puppetlabs.com/browse/PUP-1343', 'https://github.com/puppetlabs/puppet/pull/3451'),
('puppet', 58433, 24400243, 3305, 'Replace "configtimeout" with separate HTTP connect and read timeout settings', 'There"s an agent setting "configtimeout" which purports to:\r\n\r\n{noformat}\r\n    :configtimeout => {\r\n      :default  => 120,\r\n      :desc     => "How long the client should wait for the configuration to be retrieved\r\n      before considering it a failure.  This can help reduce flapping if too\r\n      many clients contact the server at one time.",\r\n    },\r\n{noformat}\r\n\r\nThis is not correct though, as it"s actually used for all http connections.  The option should be renamed to reflect reality (perhaps to `httptimeout`?) and docs updated accordingly.\r\n\r\n----\r\n\r\nFinal decision:\r\n\r\n* New setting: {{http_connect_timeout}} — controls how long Puppet should attempt to make a connection. Normal to have a small value for this. \r\n* New setting: {{http_read_timeout}} — controls how long Puppet should allow transfers to continue. Normal to let this last a long time or be infinite, since some things just take a while to compile or download. \r\n* {{configtimeout}} is deprecated, and logs a warning if it"s set. \r\n', 'https://tickets.puppetlabs.com/browse/PUP-3666', 'https://github.com/puppetlabs/puppet/pull/3305', '2014-11-12T13:27:57.000-0800', '2016-10-19T10:47:34.000-0700', '2016-10-19T10:47:34.000-0700', 'Closed', 'docs_reviewed;redmine', 14, '0', 4, 62, 45, 7, 'd723728e72983a213db93bd464a768442610ce0b', 'https://tickets.puppetlabs.com/browse/PUP-3666', 'https://github.com/puppetlabs/puppet/pull/3305'),
('puppet', 59795, 25108565, 3351, 'zone provider should inherit /sbin on solaris10', '', 'https://tickets.puppetlabs.com/browse/PUP-3702', 'https://github.com/puppetlabs/puppet/pull/3351', '2014-11-25T16:09:04.000-0800', '2016-10-19T10:47:35.000-0700', '2016-10-19T10:47:35.000-0700', 'Closed', '', 5, '0', 1, 3, 2, 3, '09b650152fae76c7a87a371f9143c75cc0e15387', 'https://tickets.puppetlabs.com/browse/PUP-3702', 'https://github.com/puppetlabs/puppet/pull/3351'),
('puppet', 61486, 74474572, 5035, 'scheduled_task keeps reapplying', 'Every puppet run I have a scheduled task that gets re-applied even though there was no change.  After doing some digging, it looks like it applies correctly, but on the next run, it is only comparing a part of the argument string instead of the full string.\r\n\r\nIt looks like when doing the comparison, it is only reading in the first 256 characters instead of the entire string.\r\n\r\n\r\n    scheduled_task { "cloud_backup":\r\n      ensure    => present,\r\n      command   => "C:\Program Files\Duplicati\Duplicati.CommandLine.exe",\r\n      arguments => template("fdlic/duplicati/backup.erb"),\r\n      trigger   => {\r\n        schedule   => weekly,\r\n        start_time => "08:00:00",\r\n        start_date => "2014-05-08"\r\n      }\r\n      \r\n    }\r\n\r\n\r\narguments changed "backup --ftp-username=empty --ftp-password=empty --max-upload-pr-second=500kb --thread-priority=BelowNormal --use-ssl --passphrase=empty --aes-encryption-dont-allow-fallback=true --full-if-older-than=1M --exclude=*.wma --exclude=*.mp3 --exclu" to "backup --ftp-username=empty --ftp-password=empty --max-upload-pr-second=500kb --thread-priority=BelowNormal --use-ssl --passphrase=empty --aes-encryption-dont-allow-fallback=true --full-if-older-than=1M --exclude=*.wma --exclude=*.mp3 --exclude=*.acc" --exclude=*.mp4 --exclude=*.avi --exclude=*.3gp --exclude=*.mpg --exclude=*.mov ', 'https://tickets.puppetlabs.com/browse/PUP-3768', 'https://github.com/puppetlabs/puppet/pull/5035', '2014-12-15T13:26:21.000-0800', '2016-10-19T10:47:37.000-0700', '2016-10-19T10:47:37.000-0700', 'Closed', 'customer-escalation;scheduled_task;windows', 9, '0', 4, 211, 22, 3, '074d4d4cac18928ceaf53c24435ed2be9462149e', 'https://tickets.puppetlabs.com/browse/PUP-3768', 'https://github.com/puppetlabs/puppet/pull/5035'),
('puppet', 66182, 28405615, 3544, '(Regression) Redhat service provider is being used on systemd-based Fedora systems', 'In 3.7.4 we made changes to the Redhat service provider (PUP-1343) which cannot be run for systemd based services. The systemd provider is the default for redhat v7, but hasn"t been enabled for Fedora. This means that enabling services on Fedora will fail.\r\n\r\nThe fix for this should just be to enable the systemd provider for the relevant releases of Fedora. ', 'https://tickets.puppetlabs.com/browse/PUP-3927', 'https://github.com/puppetlabs/puppet/pull/3544', '2015-01-29T14:48:57.000-0800', '2016-10-19T10:47:39.000-0700', '2016-10-19T10:47:39.000-0700', 'Closed', '', 5, '0', 1, 63, 4, 3, '1b8737d5a4f6f79ad28d38b65245b825e94a7006', 'https://tickets.puppetlabs.com/browse/PUP-3927', 'https://github.com/puppetlabs/puppet/pull/3544'),
('puppet', 71518, 41269883, 4114, 'agent command line options ignored running under systemd', 'Command line options can be added to systemd start agent within \r\n*/etc/sysconfig/puppet* and it seemingly works however when \r\nthe agent starts all the options are silently ignored.\r\n\r\n{code}\r\nPUPPET_EXTRA_OPTS="--masterport=8150"\r\n{code}\r\n\r\nResults in systemd showing in the process table:\r\n\r\n{code}\r\n /usr/bin/ruby /usr/bin/puppet agent  --masterport=8150 --no-daemonize\r\n{code}\r\n\r\nHowever once running the --masterport (or any other option) is ignored.\r\n\r\n{quote}\r\npuppet-agent[15763]: Using cached connection for https://it-puppet-masters-public-b.cern.ch:8140\r\npuppet-agent[15763]: Caching connection for https://it-puppet-masters-public-b.cern.ch:8140\r\n{quote}\r\n\r\nThe port number above is wrong and was taken from puppet.conf file.\r\n\r\nThis seems to be related to environment. If \r\n\r\n{code}\r\n /usr/bin/ruby /usr/bin/puppet agent  --masterport=8150 --no-daemonize\r\n{code}\r\n\r\nis executed on the command line then everything works as expected\r\nand the puppet agent correctly talks to port 8150.\r\n\r\npuppet is so called simple service in systemd speak and systemd basically runs the above command as is.\r\n\r\n\r\nEnvironment of puppet agent running under systemd\r\n{code}\r\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin\r\nLANG=en_US.UTF-8\r\nPUPPET_EXTRA_OPTS=--ca_port=8140 --masterport=8150\r\n{code}\r\n\r\nRunning on the CLI.\r\n\r\n{code}\r\nBASH_FUNC_module()=() {  eval `/usr/bin/modulecmd bash $*`\r\nCVS_RSH=ssh\r\nGT_PROXY_MODE=old\r\nHISTCONTROL=ignoredups\r\nHISTSIZE=1000\r\nHOME=/root\r\nHOSTNAME=lxplus302.cern.ch\r\nKDEDIRS=/usr\r\nKRB5CCNAME=FILE:/tmp/krb5cc_0_brrMbMkoqi\r\nLANG=en_US.UTF-8\r\nLCG_GFAL_INFOSYS=lcg-bdii.cern.ch:2170\r\nLESSOPEN=||/usr/bin/lesspipe.sh %s\r\nLOADEDMODULES=\r\nLOGNAME=root\r\nMAIL=/var/spool/mail/root\r\nMODULEPATH=/usr/share/Modules/modulefiles:/etc/modulefiles\r\nMODULESHOME=/usr/share/Modules\r\nMYPROXY_SERVER=myproxy.cern.ch\r\nPATH=/usr/sue/sbin:/usr/sue/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin\r\nPWD=/root\r\nQT_GRAPHICSSYSTEM_CHECKED=1\r\nQT_GRAPHICSSYSTEM=native\r\nQT_PLUGIN_PATH=/usr/lib64/kde4/plugins:/usr/lib/kde4/plugins\r\nSELINUX_LEVEL_REQUESTED=\r\nSHELL=/bin/bash\r\nSHLVL=1\r\nSSH_ASKPASS=/usr/libexec/openssh/gnome-ssh-askpass\r\nSSH_AUTH_SOCK=/tmp/ssh-oUvgH7Tp7L/agent.26480\r\nSSH_CLIENT=188.184.66.232 52945 22\r\nSSH_CONNECTION=188.184.66.232 52945 188.184.68.74 22\r\nSSH_TTY=/dev/pts/0\r\nTERM=screen-256color\r\nUSER=root\r\n_=/usr/bin/ruby\r\nVIRTUALENVWRAPPER_HOOK_DIR=/root/.virtualenvs\r\nVIRTUALENVWRAPPER_PROJECT_FILENAME=.project\r\nVIRTUALENVWRAPPER_SCRIPT=/etc/profile.d/virtualenvwrapper.sh\r\nWORKON_HOME=/root/.virtualenvs\r\nXDG_RUNTIME_DIR=/run/user/0\r\nXDG_SESSION_ID=131\r\nXMODIFIERS=@im=ibus\r\n{code}\r\n\r\n\r\n\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4196', 'https://github.com/puppetlabs/puppet/pull/4114', '2015-03-13T04:37:20.000-0700', '2016-10-19T10:47:40.000-0700', '2016-10-19T10:47:40.000-0700', 'Closed', 'systemd', 7, '0', 1, 2, 2, 2, 'b1a6d5b7ce99e171bc153d8791a29c2aefe11d42', 'https://tickets.puppetlabs.com/browse/PUP-4196', 'https://github.com/puppetlabs/puppet/pull/4114'),
('puppet', 74794, 32779651, 3792, 'Test to retrieve version of latest of pkgng package is broken', 'When changing the rspec syntax from {{should}} syntax into {{expect().to}} syntax in spec/unit/provider/package/pkgng_spec.rb I discovered that one of the tests were broken. The code for the broken test was:\n{code}\n     it "should retrieve the correct version of the latest package" do\n      provider.latest.should_not nil\n    end\n{code}\nIt"s missing {{==}} after {{should_not}} and when adding that (or when changing to expect syntax) the test fails. It"s currently commented out.', 'https://tickets.puppetlabs.com/browse/PUP-4382', 'https://github.com/puppetlabs/puppet/pull/3792', '2015-04-07T06:34:55.000-0700', '2016-10-19T10:47:41.000-0700', '2016-10-19T10:47:41.000-0700', 'Closed', '', 1, '0', 2, 15, 25, 2, '1b2fa6d54c3927cde0b40068868d8486271fe6c5', 'https://tickets.puppetlabs.com/browse/PUP-4382', 'https://github.com/puppetlabs/puppet/pull/3792'),
('puppet', 80043, 35378992, 3933, 'External facts no longer load from pluginsync"ed directory', 'PUP-4359 broke loading external facts from puppet"s pluginsync directories.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4607', 'https://github.com/puppetlabs/puppet/pull/3933', '2015-05-13T14:42:29.000-0700', '2016-10-19T10:47:43.000-0700', '2016-10-19T10:47:43.000-0700', 'Closed', '', 1, '0', 1, 58, 3, 2, '90d021062fdeefacf686a1c9e0d5e450c838c8f2', 'https://tickets.puppetlabs.com/browse/PUP-4607', 'https://github.com/puppetlabs/puppet/pull/3933'),
('puppet', 81167, 42731059, 4171, 'Refreshing a LaunchDaemon leaves it disabled', 'If a LanchDaemon is refreshed, it will end up disabled due to the way the refresh is being run.\r\n\r\nPuppet runs "launchctl unload -w" and then just "launchctl load" when it should be running "launchctl load -w".\r\n\r\nBecause it has the -w when it stops it, the service becomes disabled.  The -w flag is required to reenable the service.\r\n\r\nExample is below.\r\n\r\nThe current workaround is to do a refreshonly exec after the service to ensure it is actually running with a "launchctl load -w" command.\r\n---\r\n```\r\nInfo: /Stage[main]/example/File[example]: Scheduling refresh of Service[com.example.daemon]\r\nDebug: /Stage[main]/example/File[example]: The container Class[example] will propagate my refresh event\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: A restart has been triggered for the com.example.daemon service\r\nDebug: Stopping the com.example.daemon service\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Executing "launchctl unload -w /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Starting the com.example.daemon service\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Executing "/usr/bin/plutil -convert xml1 -o /dev/stdout /Library/LaunchDaemons/com.example.daemon.plist"\r\nDebug: Executing "launchctl load /Library/LaunchDaemons/com.example.daemon.plist"\r\nNotice: /Stage[main]/example/Service[com.example.daemon]: Triggered "refresh" from 1 events\r\n```', 'https://tickets.puppetlabs.com/browse/PUP-4639', 'https://github.com/puppetlabs/puppet/pull/4171', '2015-05-21T10:47:58.000-0700', '2016-10-19T10:47:43.000-0700', '2016-10-19T10:47:43.000-0700', 'Closed', '', 4, '0', 1, 5, 3, 2, '80d077a47fc02b639a8b2af8d0763b2c9338fd16', 'https://tickets.puppetlabs.com/browse/PUP-4639', 'https://github.com/puppetlabs/puppet/pull/4171'),
('puppet', 81511, 36325025, 3964, '4420_pluginfacts test fails with multiple agent nodes', 'The new "4420_pluginfacts_should_be_resolvable_on_agent.rb" test references "agent" without extracting it from iterating over "agents" here:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/c7b1fdb63497015f0ebf7b894a33a08ef3a96d0d/acceptance/tests/pluginsync/4420_pluginfacts_should_be_resolvable_on_agent.rb#L29\r\n\r\nThis looks like a bug in the test and fails on the Puppet Server pipeline.  For example, see:\r\n\r\nhttps://jenkins.puppetlabs.com/view/Puppet%20Server/view/All/job/platform_puppet-server_integration-system_no-conditional_full-master/59/LAYOUT=redhat6-64ma-64a,LDAP_TYPE=,PLATFORM=,label=beaker/testReport/junit/(root)/ruby_puppet_acceptance_tests_pluginsync/4420_pluginfacts_should_be_resolvable_on_agent_rb/\r\n\r\nNot sure why this appears to be passing iun the Puppet AIO acceptance test pipeline.', 'https://tickets.puppetlabs.com/browse/PUP-4652', 'https://github.com/puppetlabs/puppet/pull/3964', '2015-05-26T11:08:11.000-0700', '2016-10-19T10:47:43.000-0700', '2016-10-19T10:47:43.000-0700', 'Closed', '', 4, '0', 1, 9, 11, 1, 'b6575c393c3aa20f48014e7049b2cd80f7025137', 'https://tickets.puppetlabs.com/browse/PUP-4652', 'https://github.com/puppetlabs/puppet/pull/3964'),
('puppet', 83149, 36950781, 4004, 'The pw provider for users and groups should be confined to freeBSD', 'If the {{pw}} provider is only intended for use on BSD operating systems, then it should use {{confine}} to prevent accidental activation on non-BSD systems. Linux is particularly susceptible to this as there are no default providers declared for that platform (PUP-4692).\r\n\r\nSee PUP-4491 for similar reasoning in the case of OpenBSD providers.', 'https://tickets.puppetlabs.com/browse/PUP-4693', 'https://github.com/puppetlabs/puppet/pull/4004', '2015-06-03T18:15:21.000-0700', '2016-10-19T10:47:43.000-0700', '2016-10-19T10:47:43.000-0700', 'Closed', 'customer;support', 1, '0', 1, 2, 0, 2, '4b03ac03573c0c791a6d6fa93e89f72bb1a646e4', 'https://tickets.puppetlabs.com/browse/PUP-4693', 'https://github.com/puppetlabs/puppet/pull/4004'),
('puppet', 84286, 54036005, 4517, 'Yumrepo doesn"t recognize whitespace delimited reposdir settings in /etc/yum.conf', 'The {{inifile}} provider for the Yumrepo type searches various directories when deciding where to create repository definitions. One source of directories is the {{reposdir}} setting of {{/etc/yum.conf}}. Yum allows this setting to contain a list of directories [delimited by either commas or whitespace|http://yum.baseurl.org/gitweb?p=yum.git;a=blob;f=yum/config.py;h=97e5e3d3b063294a96227a67cce43a9655cd3aa6;hb=30c993c19b8b85f44e7cec436484862ab55a6961#l171], however Puppet [only uses commas|https://github.com/puppetlabs/puppet/blob/3.8.1/lib/puppet/provider/yumrepo/inifile.rb#L77] when parsing the setting.\r\n\r\nIf the {{reposdir}} setting contains a whitespace delimited list of directories, then Puppet will almost silently (a DEBUG level message is logged) fall back to creating definitions directly in {{/etc/yum.conf}}.\r\n\r\nh2. Reproduction Case\r\n\r\n*  Install Puppet on a Red Hat system.\r\n*  Add a {{reposdir}} setting to {{/etc/yum.conf}} which contains a whitespace-delimited list:\r\n\r\n{code:bash}\r\n  echo "reposdir=/etc/yum.conf.d /tmp" >> /etc/yum.conf\r\n{code}\r\n\r\n\r\n*  Attempt to create a new repo definition.\r\n\r\nh3. Outcome\r\n\r\nThe definition is added to {{/etc/yum.conf}} instead of a new file under {{/tmp/}}:\r\n\r\n{noformat}\r\n# /opt/puppet/bin/puppet resource yumrepo foo ensure=present descr="foo repo"\r\nNotice: /Yumrepo[foo]/ensure: created\r\nyumrepo { "foo":\r\n  ensure => "present",\r\n  descr  => "foo repo",\r\n}\r\n\r\n# ls /etc/yum.repos.d/foo.repo\r\nls: cannot access /etc/yum.repos.d/foo.repo: No such file or directory\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe definition is created under {{/tmp/}} as it"s the last {{reposdir}} specified\r\n\r\n{noformat}\r\n# /opt/puppet/bin/puppet resource yumrepo foo ensure=present descr="foo repo"\r\nNotice: /Yumrepo[foo]/ensure: created\r\nyumrepo { "foo":\r\n  ensure => "present",\r\n  descr  => "foo repo",\r\n}\r\n\r\n# ls /tmp/foo.repo \r\n/tmp/foo.repo\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-4744', 'https://github.com/puppetlabs/puppet/pull/4517', '2015-06-11T13:24:56.000-0700', '2016-10-19T10:47:44.000-0700', '2016-10-19T10:47:44.000-0700', 'Closed', 'customer;puppethack;support', 6, '0', 1, 22, 3, 2, 'd073dcb5e01e8cd6cd918e7dae145a7dbbed7f48', 'https://tickets.puppetlabs.com/browse/PUP-4744', 'https://github.com/puppetlabs/puppet/pull/4517'),
('puppet', 101085, 60770242, 4720, 'Tag fields in reports accidentally changed to Puppet::Util::TagSet objects', 'Puppet reports contain `tags` fields in each Puppet::Util::Log and Puppet::Resource::Status object; these fields are supposed to be arrays of strings. \r\n\r\nIn Puppet 4.0.0, the tags fields in a YAML-dumped Puppet::Transaction::Report object changed from arrays to Puppet::Util::TagSets, as described in DOCUMENT-436. This was a side-effect of:\r\n\r\n{code}\r\ncommit 7b0eed2b52bad0d5c3fc3a9fbe37d097eabc9fc2\r\nAuthor: Britt Gresham <britt@puppetlabs.com>\r\nDate:   Wed Nov 12 09:17:30 2014 -0800\r\n\r\n    (PUP-1019) Remove ZAML\r\n\r\n    Before this commit we were using ZAML by monkey patching the `to_yaml`\r\n    function to use ZAML.dump instead of YAML.dump. After removing `zaml.rb`\r\n    tests started failing because of the way that ZAML serialized YAML so\r\n    assertions in those tests were changed.\r\n\r\n    This commit also adds in a patch to YAML.Psych to handle the cases where\r\n    ruby objects were being encoded improperly.\r\n\r\n    This commit removes the use of ZAML in puppet as part of the Puppet 4.x\r\n    code removal efforts.\r\n{code}\r\n\r\n{code}\r\ndiff --git a/lib/puppet/util/tag_set.rb b/lib/puppet/util/tag_set.rb\r\nindex e74f228..613859d 100644\r\n--- a/lib/puppet/util/tag_set.rb\r\n+++ b/lib/puppet/util/tag_set.rb\r\n@@ -24,12 +24,6 @@ class Puppet::Util::TagSet < Set\r\n     to_data_hash.to_pson\r\n   end\r\n\r\n-  # this makes puppet serialize it as an array for backwards\r\n-  # compatibility\r\n-  def to_zaml(z)\r\n-    to_data_hash.to_zaml(z)\r\n-  end\r\n-\r\n   def join(*args)\r\n     to_a.join(*args)\r\n   end\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5341', 'https://github.com/puppetlabs/puppet/pull/4720', '2015-10-07T14:55:18.000-0700', '2016-10-19T10:47:47.000-0700', '2016-10-19T10:47:47.000-0700', 'Closed', '', 7, '0', 1, 29, 2, 3, '751f662a309380dc072698c09e3b00ac83e7a184', 'https://tickets.puppetlabs.com/browse/PUP-5341', 'https://github.com/puppetlabs/puppet/pull/4720'),
('puppet', 106285, 51565428, 4460, 'blank line in ssh_known_hosts file causes error', 'If there is a blank line in an existing /etc/ssh/ssh_known_hosts file, "puppet agent -t" fails with:\r\n\r\nError: Failed to apply catalog: undefined method `split" for :absent:Symbol\r\n\r\nExample /etc/ssh/ssh_known_hosts that triggers this issue:\r\n{code:none}\r\n# Comment 1\r\n\r\n# Comment 2\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5513', 'https://github.com/puppetlabs/puppet/pull/4460', '2015-11-18T11:46:34.000-0800', '2016-10-19T10:47:48.000-0700', '2016-10-19T10:47:48.000-0700', 'Closed', '', 4, '0', 1, 29, 20, 3, '2d8976fde09f06ff51a677947bb518fcda101417', 'https://tickets.puppetlabs.com/browse/PUP-5513', 'https://github.com/puppetlabs/puppet/pull/4460'),
('puppet', 115355, 62293249, 4770, 'systemd service provider always enables service in chroot', 'The systemd service provider is using the following command to determine its enabled state\r\n\r\n{code:sh}\r\nsystemctl show autofs --property LoadState --property UnitFileState\r\n{code}\r\n\r\nNormally this returns\r\n{code}\r\n# systemctl show autofs --property LoadState --property UnitFileState\r\nLoadState=loaded\r\nUnitFileState=enabled\r\n{code}\r\n\r\nIn a chroot\r\n{code}\r\n# systemctl show autofs --property LoadState --property UnitFileState\r\nRunning in a chroot, ignoring request.\r\n{code}\r\n\r\nTherefore, the provider always enables the autofs service.\r\n\r\nThis can be overcome by using "systemctl is-enabled"\r\n\r\nIn a chroot\r\n{code}\r\n# systemctl is-enabled autofs\r\nenabled\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5825', 'https://github.com/puppetlabs/puppet/pull/4770', '2016-02-05T09:10:13.000-0800', '2016-10-19T10:47:49.000-0700', '2016-10-19T10:47:49.000-0700', 'Closed', '', 7, '0', 1, 35, 78, 2, '7a5176c88f261402a8e73d926034e390f189a1d0', 'https://tickets.puppetlabs.com/browse/PUP-5825', 'https://github.com/puppetlabs/puppet/pull/4770'),
('puppet', 122121, 63772602, 4804, 'LaunchDaemons/LaunchAgents with line continuations break puppet', 'When puppet encounters a valid (if rare) plist with a backslash line continuation, it will fail:\r\n{{Error: Could not prefetch service provider "launchd": undefined method `to_ruby" for nil:NilClass}}\r\n\r\nI expect this is due to the plist-handling code in 3.8; if you catch {{NoMethodError}} and have the provider fall through to {{plutil -convert}}, it works.', 'https://tickets.puppetlabs.com/browse/PUP-6073', 'https://github.com/puppetlabs/puppet/pull/4804', '2016-03-18T09:10:52.000-0700', '2016-10-19T10:47:50.000-0700', '2016-10-19T10:47:50.000-0700', 'Closed', '', 6, '0', 1, 1, 1, 1, '26a988120cc87c55e301f1e07e055cb01ea4c0ea', 'https://tickets.puppetlabs.com/browse/PUP-6073', 'https://github.com/puppetlabs/puppet/pull/4804'),
('puppet', 117701, 78556254, 5137, 'windows, user to groupassign to local administrators failed', 'Trying to add an user to local Administrator Group fails with an error message\r\n\r\n{code}\r\nC:\Temp>puppet apply  --verbose -e "user { "bla": ensure  => "present", comment\r\n=> "bla", groups  => ["S-1-5-32-544",], }"\r\n{code}\r\n\r\nor also following version\r\n\r\n{code}\r\nC:\Temp>puppet apply  --verbose -e "user { "bla": ensure  => "present", comment\r\n=> "bla", groups  => ["VORDEFINIERT\Administratoren",], }"\r\nInfo: Loading facts\r\nNotice: Compiled catalog for xxxx in environment production in 0.14 seconds\r\nInfo: Applying configuration version "1456004269"\r\nError: ADSI connection error: failed to parse display name of moniker `WinNT://VORDEFINIERT/Administratoren,group"\r\n    HRESULT error code:0x80070035\r\n      Der Netzwerkpfad wurde nicht gefunden.\r\nWrapped exception:\r\nfailed to parse display name of moniker `WinNT://VORDEFINIERT/Administratoren,group"\r\n    HRESULT error code:0x80070035\r\n      Der Netzwerkpfad wurde nicht gefunden.\r\nError: /Stage[main]/Main/User[bla]/ensure: change from absent to present failed:\r\n ADSI connection error: failed to parse display name of moniker `WinNT://VORDEFINIERT/Administratoren,group"\r\n    HRESULT error code:0x80070035\r\n      Der Netzwerkpfad wurde nicht gefunden.\r\n{code}\r\n\r\nI"ve also tried following names Administratoren and hostname\Administratoren\r\nYes I"ve to use the german group names, BUILTIN\Administrators and the other english names are not found.', 'https://tickets.puppetlabs.com/browse/PUP-5938', 'https://github.com/puppetlabs/puppet/pull/5137', '2016-02-20T13:54:14.000-0800', '2016-10-19T10:47:50.000-0700', '2016-10-19T10:47:50.000-0700', 'Closed', 'user;windows', 12, '0', 1, 7, 2, 3, '05d1ca22e625e7bb073166c289745a3b4c533a14', 'https://tickets.puppetlabs.com/browse/PUP-5938', 'https://github.com/puppetlabs/puppet/pull/5137'),
('puppet', 103820, 78108356, 5128, 'undef not usable in collector search', 'The documentation for collector search expressions states that, for the equality search {{==}}, *undef* is a valid right operand.\r\n\r\nHowever, when I try to use it, I get an *Error: Evaluation Error: Error while evaluating a Virtual Query, Cannot transform object of class Puppet::Pops::Model::LiteralUndef* error.\r\n\r\nSample code:\r\n\r\n{code:puppet}\r\ndefine foo (\r\n  $x = undef ,\r\n  $y = undef ,\r\n) {\r\n  notify { "foo::${x}::${y}": }\r\n}\r\n\r\nfoo { "bar": y => "quux" }\r\nFoo <| x == undef |> { x => "baz" }\r\n{code}\r\n\r\nThis is the result:\r\n{noformat}\r\n$ puppet apply -t test.pp\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nError: Evaluation Error: Error while evaluating a Virtual Query, Cannot transform object of class Puppet::Pops::Model::LiteralUndef at …/test.pp:9:1 on node …\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5463', 'https://github.com/puppetlabs/puppet/pull/5128', '2015-11-02T07:36:55.000-0800', '2016-10-27T14:09:51.000-0700', '2016-10-27T14:09:51.000-0700', 'Closed', '', 3, '0', 1, 18, 0, 2, '4950173d2d6303ef03f5a38a0be3b94ef21cbcc2', 'https://tickets.puppetlabs.com/browse/PUP-5463', 'https://github.com/puppetlabs/puppet/pull/5128'),
('puppet', 18322, 96369626, 5406, 'Puppet yum provider for package resource does not appear to use "release" tag to ensure latest', 'Puppet"s yum provider for the package resource does not appear to offer complete support for RPM naming/versioning.\r\n\r\nYum compares RPMs using the RPM naming convention (e.g name-version-release.arch.rpm).  Our snapshot RPMs make use of this convention and rely upon the fact that yum can distinguish between RPMs based on the release components.  \r\n\r\nFor example, in our yum snapshot repo we have;\r\n\r\n<pre>\r\nmds-2.0.1-SNAPSHOT20120418213747.noarch.rpm\r\nmds-2.0.1-SNAPSHOT20120418220425.noarch.rpm\r\nmds-2.0.1-SNAPSHOT20120418221358.noarch.rpm\r\nmds-2.0.1-SNAPSHOT20120418223400.noarch.rpm\r\n</pre>\r\n\r\nWhen we run "yum install mds-2.0.1", yum will select the rpm with release = SNAPSHOT20120418223400 as the latest version of mds-2.0.1.  \r\n\r\nWhen we attempt to use Puppet"s package resource to perform the same operation with\r\n\r\n<pre>\r\npackage { "mds-2.0.1":\r\n    ensure => latest\r\n}\r\n</pre>\r\n\r\nPuppet appears to use rpm to gather information about the local install but then does not compare the result to what the yum repo can provide (.i.e. compare release tags).  Instead it simply ensures that an rpm with a matching name-version has been installed.\r\n\r\nTo workaround this issue we"re currently calling yum directly using,\r\n\r\n<pre>\r\nexec { "install mds-${meter_data_service_version}":\r\n    command => "yum -d 1 -e 1 install mds-${meter_data_service_version} -y",\r\n    path    => "/usr/bin/",\r\n}\r\n</pre>\r\n\r\nThis is functional but couples us to yum and is not recommended practice in Puppet.', 'https://tickets.puppetlabs.com/browse/PUP-683', 'https://github.com/puppetlabs/puppet/pull/5406', '2013-11-06T11:41:04.000-0800', '2016-10-31T13:06:24.000-0700', '2016-10-31T13:06:24.000-0700', 'Closed', 'customer;redmine;yum', 1, '0', 2, 5, 5, 5, 'b95d747b5e46acef7879f6d28ba67d55ef06dcae', 'https://tickets.puppetlabs.com/browse/PUP-683', 'https://github.com/puppetlabs/puppet/pull/5406'),
('puppet', 21485, 683698284, 8678, 'Puppet --version calls external facts', '** Reproduction **\r\n\r\n* Drop script /etc/facter/facts.d/test.sh:\r\n<pre><code class="bash">\r\n#!/bin/bash\r\necho "SCRIPT CALLED" >&2\r\necho "test=value"\r\n</code></pre>\r\n* Make script executeable\r\n<pre><code class="bash">\r\nchmod +x /etc/facter/facts.d/test.sh\r\n</code></pre>\r\n* Call "puppet --version", the following output is shown:\r\n<pre><code class="bash">\r\nroot@puppet:~# puppet --version\r\nSCRIPT CALLED\r\nSCRIPT CALLED\r\nSCRIPT CALLED\r\nSCRIPT CALLED\r\nSCRIPT CALLED\r\n3.3.1\r\n</code></pre>\r\n\r\nAs far as i"m aware, there is no reason for calling the external facts when i"m just requesting the puppet version.\r\n\r\n** System information **\r\n\r\n* Ubuntu 12.04.3\r\n* Facter 1.7.3', 'https://tickets.puppetlabs.com/browse/PUP-1111', 'https://github.com/puppetlabs/puppet/pull/8678', '2013-12-16T12:57:56.000-0800', '2016-10-31T13:31:20.000-0700', '2016-10-31T13:31:20.000-0700', 'Closed', 'redmine', 1, '0', 1, 2, 0, 2, '282010614e14748e9ea760ec4fe29b3979051304', 'https://tickets.puppetlabs.com/browse/PUP-1111', 'https://github.com/puppetlabs/puppet/pull/8678'),
('puppet', 21463, 679963194, 8662, 'Class inheritance and stages act weirdly', 'Given the code:\r\n\r\n{code}\r\nstage { "first": before => Stage[main] }\r\n\r\nclass foo { \r\n   package{"zsh": \r\n      ensure => present\r\n   } \r\n}\r\n\r\nclass bar inherits foo { \r\n   notify{"/usr/bin/cowsay "hello world"": \r\n      require => Package["zsh"] \r\n   } \r\n}\r\n\r\nclass{"bar": stage => "first"}\r\n{code}\r\n\r\nThis produce\r\n\r\n{code}\r\nerr: Could not apply complete catalog: Found dependency cycles in the following relationships: Package[zsh] => Notify[/usr/bin/cowsay "hello world"], Notify[/usr/bin/cowsay "hello world"] => Package[zsh], Notify[/usr/bin/cowsay "hello world"] => Class[main]; try using the "--graph" option and open the ".dot" files in OmniGraffle or GraphViz\r\n{code}\r\n\r\nIf I add:\r\n\r\n{code}\r\nclass{"foo": stage => "first"}\r\n{code}\r\n\r\nIt sorts itself out.  \r\n\r\nI am not sure what the correct behavior would be, at first I think we should just pull the inherited class into the "first" stage as well but I can imagine that causing weird issues too?\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1108', 'https://github.com/puppetlabs/puppet/pull/8662', '2013-12-16T11:51:39.000-0800', '2016-10-31T13:31:22.000-0700', '2016-10-31T13:31:22.000-0700', 'Closed', 'redmine', 2, '0', 1, 235, 0, 3, 'f54f464521263536cd2a63e452b4275bc9387de7', 'https://tickets.puppetlabs.com/browse/PUP-1108', 'https://github.com/puppetlabs/puppet/pull/8662'),
('puppet', 21457, 666320205, 8626, 'Confusing logging when onlyif prevents an exec from running', 'Given the code in:\r\n\r\n{code}\r\nexec{"/bin/true": }\r\n\r\nexec{"/usr/bin/cowthink meh":\r\n    logoutput => true,\r\n    onlyif    => "/bin/true",\r\n    subscribe => Exec["/bin/true"],\r\n    refreshonly => true\r\n}\r\n{code}\r\n\r\nI get the output \r\n\r\n{noformat}\r\nnotice: /Stage[main]//Exec[/bin/true]/returns: executed successfully\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:  _____ \r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns: ( meh )\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:  ----- \r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:         o   ^__^\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:          o  (oo)\_______\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:             (__)\       )\/\\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:                 ||----w |\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]/returns:                 ||     ||\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]: Triggered "refresh" from 1 events\r\nnotice: Finished catalog run in 0.21 seconds\r\n{noformat}\r\n\r\nwhich is all fine,\r\n\r\nif I change the onlyif to:\r\n\r\n{code}\r\nonlyif    => "/bin/false",\r\n{code}\r\n\r\nThis prevents the exec from actually running but the logging I would get is:\r\n\r\n{noformat}\r\nnotice: /Stage[main]//Exec[/bin/true]/returns: executed successfully\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]: Triggered "refresh" from 1 events\r\n{noformat}\r\n\r\nThe "Triggered "refresh" from 1 events" suggests that the exec is being run, when actually its being skipped due to the onlyif condition.\r\n\r\nIf I removed the logoutput from the first bit of code here the output from both runs would be identical:\r\n\r\nWith onlyif => "/bin/true" and no logoutput:\r\n\r\n{noformat}\r\nnotice: /Stage[main]//Exec[/bin/true]/returns: executed successfully\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]: Triggered "refresh" from 1 events\r\n{noformat}\r\n\r\nWith onlyif => "/bin/false" and no logoutput:\r\n\r\n{noformat}\r\nnotice: /Stage[main]//Exec[/bin/true]/returns: executed successfully\r\nnotice: /Stage[main]//Exec[/usr/bin/cowthink meh]: Triggered "refresh" from 1 events\r\n{noformat}\r\n\r\nThey"re identical and don"t actually tell the user what is happening', 'https://tickets.puppetlabs.com/browse/PUP-1104', 'https://github.com/puppetlabs/puppet/pull/8626', '2013-12-16T11:48:50.000-0800', '2016-10-31T13:31:23.000-0700', '2016-10-31T13:31:23.000-0700', 'Closed', 'redmine', 1, '0', 2, 3, 16, 4, 'fd4ee88e1e41abd037e8ebab3a2c0ec63d74bd1f', 'https://tickets.puppetlabs.com/browse/PUP-1104', 'https://github.com/puppetlabs/puppet/pull/8626'),
('puppet', 15829, 37176145, 4010, 'reportdir gets permissions of root owner when running puppet apply', 'If you enable the `store` report handler, then run `puppet apply <file>`, then the reportdir gets created as root, meaning that subsequent puppet runs fail to write out reports.', 'https://tickets.puppetlabs.com/browse/PUP-438', 'https://github.com/puppetlabs/puppet/pull/4010', '2013-09-30T15:22:13.000-0700', '2016-10-31T13:31:23.000-0700', '2016-10-31T13:31:23.000-0700', 'Closed', '', 2, '0', 1, 13, 1, 3, '1b2fa6d54c3927cde0b40068868d8486271fe6c5', 'https://tickets.puppetlabs.com/browse/PUP-438', 'https://github.com/puppetlabs/puppet/pull/4010'),
('puppet', 21421, 563634643, 8500, 'Puppet not building proper Nagios configs with Exported Resources', 'I"m trying to get Puppet set up to build our nagios configs using Exported Resources. This seems to be one of the very test cases that Exported Resources was developed for (it"s in the documentation), so I don"t feel I"ve stepped too far outside of Puppet"s intended operation parameters here. Yet, I can"t seem to have any luck at all getting proper configs generated. \r\n\r\nI have two issues, and I"m uncertain whether or not they"re related. I suspect they are, but I could very well be wrong. If they are separate, I apologize, and will be willing to split out a separate ticket. \r\n\r\nHere"s my setup, which is almost directly ported from the documentation. \r\n\r\nIn my base class, I have the following: \r\n\r\n    @@nagios_host { $fqdn:\r\n        ensure => present,\r\n        alias => $hostname,\r\n        address => $ipaddress,\r\n        use => "default",\r\n        tag => "site${sitecode}",\r\n    }\r\n\r\nLater, in my nagios server class, I have: \r\n\r\n    Nagios_host <<| tag == "site${sitecode}" |>> {\r\n      target => "/etc/nagios/puppet/dynamic/host.cfg",\r\n      notify => Service["nagios"],\r\n      require => File["/etc/nagios/puppet/dynamic"],\r\n    }\r\n\r\nSo far, so good.\r\n\r\nNow, this is in my testing environment, so right now I have a limited number of nodes. They are: \r\n\r\nxxdnstest01, xxdnstest02, xxdnstest03, lvpuppetdev01, xxis5, xxnagios01. \r\n\r\nThe only one of note right now is xxnagios01, which is our nagios server. \r\n\r\nWhen I run puppet for the first time, the following host config is generated: \r\n\r\n\r\n    # HEADER: This file was autogenerated at 2012-01-12 11:20:01 -0600\r\n    # HEADER: by puppet.  While it can still be managed manually, it\r\n    # HEADER: is definitely not recommended.\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest02\r\n    address                        172.24.29.68\r\n    host_name                      xxdnstest02.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest01\r\n    address                        172.24.29.67\r\n    host_name                      xxdnstest01.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest03\r\n    address                        172.24.29.69\r\n    host_name                      xxdnstest03.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          lvpuppetdev01\r\n    address                        172.24.20.56\r\n    host_name                      lvpuppetdev01.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxis5\r\n    address                        172.24.29.66\r\n    host_name                      xxis5.lightningsource.com\r\n    }\r\n    \r\n\r\n\r\nThis is almost right... but for some reason xxnagios01 isn"t making an appearance! This isn"t just happening for the host entry itself, but I can"t get any services for xxnagios01 to show up, either. \r\n\r\nI don"t know if this is specific to naginator, or if it"s generally a bug in Exported Resources. I suspect the latter. It seems like maybe a node can"t import resources that it *itself* exports. \r\n\r\nI have verified that the entry does in fact appear in the database: \r\n\r\n\r\n    mysql> select * from resources where restype = "Nagios_host";                                                                                                                                                                          \r\n    +----+-----------------------------------+-------------+---------+----------------+----------+------+---------------------+---------------------+                                                                                            \r\n    | id | title                             | restype     | host_id | source_file_id | exported | line | updated_at          | created_at          |                                                                                            \r\n    +----+-----------------------------------+-------------+---------+----------------+----------+------+---------------------+---------------------+                                                                                            \r\n    |  5 | lvpuppetdev01.lightningsource.com | Nagios_host |       3 |              1 |        1 |   64 | 2012-01-12 10:50:12 | 2012-01-12 00:50:13 |                                                                                            \r\n    |  9 | xxdnstest01.lightningsource.com   | Nagios_host |       5 |              1 |        1 |   64 | 2012-01-12 10:50:17 | 2012-01-12 00:50:19 |\r\n    | 13 | xxdnstest02.lightningsource.com   | Nagios_host |       7 |              1 |        1 |   64 | 2012-01-12 10:50:21 | 2012-01-12 00:50:30 |\r\n    | 17 | xxdnstest03.lightningsource.com   | Nagios_host |       9 |              1 |        1 |   64 | 2012-01-12 10:50:33 | 2012-01-12 00:50:40 |\r\n    |  1 | xxnagios01.lightningsource.com    | Nagios_host |       1 |              1 |        1 |   64 | 2012-01-12 10:39:56 | 2012-01-12 00:45:56 |\r\n    | 21 | xxis5.lightningsource.com         | Nagios_host |      11 |              1 |        1 |   64 | 2012-01-12 10:50:50 | 2012-01-12 00:51:02 |\r\n    +----+-----------------------------------+-------------+---------+----------------+----------+------+---------------------+---------------------+\r\n    6 rows in set (0.00 sec)\r\n    \r\n\r\nSo I"ve got 6 resource entries here in the database, but only five are making it into the file. I"m one short. \r\n\r\nSo now, it gets really weird. \r\n\r\nWhen I run Puppet *again*, I get the following config file: \r\n\r\n    # HEADER: This file was autogenerated at 2012-01-12 11:20:01 -0600\r\n    # HEADER: by puppet.  While it can still be managed manually, it\r\n    # HEADER: is definitely not recommended.\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest02\r\n    address                        172.24.29.68\r\n    host_name                      xxdnstest02.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest01\r\n    address                        172.24.29.67\r\n    host_name                      xxdnstest01.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest03\r\n    address                        172.24.29.69\r\n    host_name                      xxdnstest03.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          lvpuppetdev01\r\n    address                        172.24.20.56\r\n    host_name                      lvpuppetdev01.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxis5\r\n    address                        172.24.29.66\r\n    host_name                      xxis5.lightningsource.com\r\n    }\r\n    define host {\r\n    use                            default\r\n    alias                          xxdnstest02\r\n    address                        172.24.29.68\r\n    host_name                      xxdnstest02.lightningsource.com\r\n    }\r\n\r\nNotice that the first entry of the file, xxdnstest02, has now been duplicated to the bottom of the file inexplicably. No matter what I do, Puppet wants to enforce this. I did some tracing back through Puppet"s internals, and inserted some debug statements, and it appears that Puppet is *parsing* the file correctly. My first suspicion was that the comments at the top were causing it to be unable to see the first entry, but that"s not the case. It"s in the @records variable correctly before it tries to insert the new node. \r\n\r\nThis is the issue that I suspect is related, but may not be. My current suspicion is that Puppet is somehow "noticing" that xxnagios01 is absent, and so it then attempts to add xxnagios01 to the file. However, due to whatever the first bug is, it fails to do so, and somehow just winds up copying the first node. \r\n\r\nHowever... on the third run, the config file is unchanged. This is somewhat surprising to me. If Puppet *was* trying to add xxnagios01, and failed, I would expect it to add it again every time, and for the first entry to be reproduced on each subsequent run. As it is, Puppet seems to be happy once the first entry and the last entry are the same, and then it stops trying to add more. \r\n\r\nThis leaves me with a couple of fairly major problems. \r\n\r\n1. I cannot get resources exported from my nagios server to show up in my nagios configs\r\n2. Puppet is ultimately generating *broken* configs. Nagios will not start up when there are duplicate definitions like this, so overall... the feature is failing me. =/ \r\n\r\nI"m running Puppet 2.7.9, with Ruby 1.9.2p290. If I can provide any additional information, please don"t hesitate to ask.', 'https://tickets.puppetlabs.com/browse/PUP-1086', 'https://github.com/puppetlabs/puppet/pull/8500', '2013-12-16T11:19:49.000-0800', '2016-10-31T13:31:24.000-0700', '2016-10-31T13:31:24.000-0700', 'Closed', 'nagios;redmine', 2, '0', 2, 66, 9, 2, '3a8626fdb17db2a27fd0004418c1aa196d222800', 'https://tickets.puppetlabs.com/browse/PUP-1086', 'https://github.com/puppetlabs/puppet/pull/8500'),
('puppet', 15647, 32425347, 3780, 'httplog and masterhttplog can be created with incorrect permissions when using WEBrick', 'When setting up logging for the WEBrick server (either running a master on WEBrick or an agent with `\--listen`), the log file is created with default permissions. This happens because the sections that define those settings are "used" immediately before the files are created, so if the files don"t exist, their permissions don"t get managed until the next time Puppet starts. This also causes the master to fail to start if the agent has run with `\--listen` once but hasn"t run again (because the mode of httplog is wrong, but the master running as puppet isn"t allowed to fix it).', 'https://tickets.puppetlabs.com/browse/PUP-436', 'https://github.com/puppetlabs/puppet/pull/3780', '2013-09-30T10:42:03.000-0700', '2016-10-31T13:31:25.000-0700', '2016-10-31T13:31:25.000-0700', 'Closed', '', 1, '0', 2, 79, 57, 6, '00550ad5f8b7687c7a7f2b001bc13e438b947e6a', 'https://tickets.puppetlabs.com/browse/PUP-436', 'https://github.com/puppetlabs/puppet/pull/3780'),
('puppet', 21434, 695877384, 8710, 'puppet agent spawns a shell that gets defunc/zombie', 'puppet agent spawns a shell that gets defunc/zombie and gets stuck there.\r\n\r\nIssue exists in both 2.7.6 and 2.7.11.\r\n\r\nI have activated debug.\r\n\r\nA successful run looks like this:\r\n    Mar  6 01:27:02 srzarnsas007 puppet-agent[492]: Retrieving plugin\r\n    Mar  6 01:27:03 srzarnsas007 puppet-agent[492]: Loading facts in /var/lib/puppet/lib/facter/facter_dot_d.rb\r\n    Mar  6 01:27:04 srzarnsas007 puppet-agent[492]: Loading facts in /var/lib/puppet/lib/facter/root_home.rb\r\n    Mar  6 01:27:04 srzarnsas007 puppet-agent[492]: Loading facts in /var/lib/puppet/lib/facter/operatingsystemmajor.rb\r\n    Mar  6 01:27:04 srzarnsas007 puppet-agent[492]: Loading facts in /var/lib/puppet/lib/facter/hpov.rb\r\n    Mar  6 01:27:11 srzarnsas007 puppet-agent[492]: Caching catalog for srzarnsas007.srz.se.tconet.net\r\n    Mar  6 01:27:12 srzarnsas007 puppet-agent[492]: Applying configuration version "1330976728"\r\n    Mar  6 01:27:24 srzarnsas007 puppet-agent[492]: Finished catalog run in 12.18 seconds\r\n    \r\nA unsuccessful run looks like this:\r\n    Mar  6 01:57:27 srzarnsas007 puppet-agent[492]: Retrieving plugin\r\n\r\n# ps aux --forest\r\n    root       492  0.1  3.6 236172 142776 ?       Ss   Mar05   4:27 /opt/tc-puppet/bin/ruby /opt/tc-puppet/sbin/puppetd --verbose\r\n    root     29210  0.0  0.0      0     0 ?        Z    Mar06   0:00  \_ [sh] <defunct>\r\n\r\n\r\n# /opt/tc-puppet/bin/ruby --version\r\nruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1094', 'https://github.com/puppetlabs/puppet/pull/8710', '2013-12-16T11:26:01.000-0800', '2016-10-31T13:31:26.000-0700', '2016-10-31T13:31:26.000-0700', 'Closed', 'redmine', 4, '0', 1, 24, 1, 2, 'c4cd83a46bef6bfe2bf189fcceeb341a6454961e', 'https://tickets.puppetlabs.com/browse/PUP-1094', 'https://github.com/puppetlabs/puppet/pull/8710'),
('puppet', 140732, 76832934, 5104, 'Windows gem install requires quotes around versions with ~> while linux does not', 'If I pass ensure => "~>0.7.0" to gem (or in this case, puppet_gem) provider on windows I"ll get this:\r\n\r\nError: Could not update: Execution of "C:/Program Files/Puppet Labs/Puppet/sys/ruby/bin/gem.bat install -v ~>0.7.0 --no-rdoc --no-ri azure" returned 1: ERROR:  While executing gem ... (Gem::Requirement::BadRequirementError)\r\n    Illformed requirement ["~"]\r\n\r\nTo work I need to pass ensure => ""~0.7.0"".  However if I do that, on linux I get: Illformed requirement ["\"~>1.0.0\""]\r\n\r\nI could put logic in my puppet code to deal with this, but seems like logic in the gem provider would be better.  I"ve created a pull request for this:\r\nhttps://github.com/puppetlabs/puppet/pull/5104', 'https://tickets.puppetlabs.com/browse/PUP-6563', 'https://github.com/puppetlabs/puppet/pull/5104', '2016-07-08T18:00:30.000-0700', '2016-11-02T06:32:53.000-0700', '2016-11-02T06:32:53.000-0700', 'Closed', '', 1, '0', 1, 6, 1, 1, '01bcb3c87123dc35021881a91e303fe83972514a', 'https://tickets.puppetlabs.com/browse/PUP-6563', 'https://github.com/puppetlabs/puppet/pull/5104'),
('puppet', 150171, 83777833, 5253, 'Puppet should return better errors for Enum mismatches', 'given the following code:\r\n\r\n{code}\r\ndefine foo (\r\n  Optional[Enum["foo", "bar"]] $x\r\n){\r\n  notify { $x: }\r\n}\r\nfoo { "lolnope":\r\n  x => "baz",\r\n}\r\n{code}\r\n\r\nPuppet will return this Error:\r\n\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Resource Statement, Foo[lolnope]:\r\n  parameter "x" expects a match for Enum["bar", "baz"], got String  at /tmp/foo.pp:6 on node levix\r\n{code}\r\n\r\n(note the suspicious additional blank)\r\n\r\nmy naïve patch:\r\n{code}\r\ndiff --git a/lib/puppet/pops/types/type_mismatch_describer.rb b/lib/puppet/pops/types/type_mismatch_describer.rb\r\nindex 98763ad..3f11e96 100644\r\n--- a/lib/puppet/pops/types/type_mismatch_describer.rb\r\n+++ b/lib/puppet/pops/types/type_mismatch_describer.rb\r\n@@ -578,7 +578,7 @@ module Types\r\n         value = param_hash[name]\r\n         value_type = elem.value_type\r\n         if param_hash.include?(name)\r\n-          result << describe(value_type, TypeCalculator.singleton.infer_set(value).generalize, [ParameterPathElement.new(name)]) unless value_type.instance?(value)\r\n+          result << describe(value_type, TypeCalculator.singleton.infer_set(value), [ParameterPathElement.new(name)]) unless value_type.instance?(value)\r\n         else\r\n           result << MissingParameter.new(nil, name) unless elem.key_type.assignable?(PUndefType::DEFAULT) unless missing_ok\r\n         end\r\n{code}\r\n\r\nworks for this case:\r\n\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Resource Statement, Foo[lolnope]:\r\n  parameter "x" expects a match for Enum["bar", "baz"], got String "baz" at /tmp/foo.pp:6 on node levix\r\n{code}\r\n\r\n but breaks other types — in particular the new Sensitive type.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6669', 'https://github.com/puppetlabs/puppet/pull/5253', '2016-09-01T05:47:42.000-0700', '2016-11-02T06:32:53.000-0700', '2016-11-02T06:32:53.000-0700', 'Closed', '', 4, '0', 1, 37, 1, 2, '25ff8f20c5d6b57eddb7e074b28a21ace5d2bd28', 'https://tickets.puppetlabs.com/browse/PUP-6669', 'https://github.com/puppetlabs/puppet/pull/5253'),
('puppet', 154565, 87758267, 5311, 'calling_all_functions test fails on master', 'The full error output:\r\n\r\n{code}\r\n16:49:29 Failed Tests Cases:\r\n16:49:29   Test Case tests/parser_functions/calling_all_functions.rb reported: #<Minitest::Assertion: map output didn"t match expected value.\r\n16:49:29 Expected /Map:\ Scope\(Class\[main\]\):\ \[7,\ 8,\ 9\]/ to match "\e[mNotice: Scope(Class[main]): sayeth Assert_type: Scope(Class[main]): Valar morghulis\e[0m\n\e[mNotice: Scope(Class[main]): 1\e[0m\n\e[mNotice: Scope(Class[main]): 2\e[0m\n\e[mNotice: Scope(Class[main]): 3\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Each: Scope(Class[main]): [1, 2, 3]\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Epp: Scope(Class[main]): This is the droid you are looking for!\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Filter: Scope(Class[main]): [4, 5, 6]\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Inline_epp: Scope(Class[main]): 10\e[0m\n\e[mNotice: Scope(Class[main]): 7\e[0m\n\e[mNotice: Scope(Class[main]): 8\e[0m\n\e[mNotice: Scope(Class[main]): 9\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Map: Scope(Class[main]): [, , ]\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Match: Scope(Class[main]): [b]\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Reduce: Scope(Class[main]): 15\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Slice: Scope(Class[main]): [[1, 2], [3, 4], [5, 6]]\e[0m\n\e[mNotice: Scope(Class[main]): sayeth Strftime: Scope(Class[main]): 42\e[0m\n\e[mNotice: Scope(Class[main]): [1, Catelyn]\e[0m\n\e[mNotice: Scope(Class[main]): sayeth With: Scope(Class[main]): \e[0m\n\e[mNotice: Compiled catalog for j98z11kw650x3fl.delivery.puppetlabs.net in environment production in 0.11 seconds\e[0m\n\e[0;32mInfo: Applying configuration version "1475278825"\e[0m\n\e[mNotice: Applied catalog in 0.02 seconds\e[0m\n".>\r\n16:49:29     Test line: tests/parser_functions/calling_all_functions.rb:176:in `block (4 levels) in run_test"\r\n{code}\r\n\r\nThe specific bit that failed was:\r\nhttps://github.com/puppetlabs/puppet/blob/832d27d4d745bbc8e65b2433020f3c2e15acedf2/acceptance/tests/parser_functions/calling_all_functions.rb#L95\r\n\r\n{code}\r\nExpected /Map:\ Scope\(Class\[main\]\):\ \[7,\ 8,\ 9\]/ to match sayeth Map: Scope(Class[main]): [, , ]\e[0m\n\e[mNotice: Scope(Class[main]):\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6766', 'https://github.com/puppetlabs/puppet/pull/5311', '2016-09-30T16:57:43.000-0700', '2016-11-02T06:32:53.000-0700', '2016-11-02T06:32:53.000-0700', 'Closed', '', 1, '0', 1, 3, 3, 1, '774c5b150854018f2562431637c54f657813a2d4', 'https://tickets.puppetlabs.com/browse/PUP-6766', 'https://github.com/puppetlabs/puppet/pull/5311'),
('puppet', 137716, 74339858, 5032, 'Regex of ssh_authorized_keys can"t match lines with multi spaces as field separator', 'Regex for authorized_keys can"t match lines with multi spaces as field separator. The regex in type ssh_authorized_keys is:\r\n\r\n{code:ruby}\r\nREGEX = /^(?:(.+) )?(ssh-dss|ssh-ed25519|ssh-rsa|ecdsa-sha2-nistp256|ecdsa-sha2-nistp384|ecdsa-sha2-nistp521) ([^ ]+) ?(.*)$/\r\n{code}\r\n\r\nThis regext can"t match lines with multi spaces as field separator like:\r\n\r\n{code:bash}\r\n$ cat ~/.ssh/authorized_keys\r\nssh-rsa    PUBLIC_KEY_CONTENT    COMMENT    # This line is separated by multi spaces\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6417', 'https://github.com/puppetlabs/puppet/pull/5032', '2016-06-18T07:47:33.000-0700', '2016-11-02T06:32:54.000-0700', '2016-11-02T06:32:54.000-0700', 'Closed', '', 3, '0', 1, 5, 4, 1, '6a459bae8c625abd3babbac40556d64084a7fd6d', 'https://tickets.puppetlabs.com/browse/PUP-6417', 'https://github.com/puppetlabs/puppet/pull/5032'),
('puppet', 153807, 87034712, 5301, 'race condition smf and manifest-import', 'by default pkg install/update does not wait for smf actuators to finish before continuing \r\n\r\nReported Problem:\r\n\r\nI"ve observed several instances of puppet installing a package and then \r\ntrying to start a service or modify service properties, resulting in failures \r\nnoting that the service doesn"t exist.\r\n\r\nFor example:\r\n\r\nsvcadm enable -rs nova-conductor:default claims that nova-conductor:upgrade \r\ndoesn"t exist as s service.\r\n\r\nsvccfg -s keystone:default setprop claims that keystone:default doesn"t \r\nexist.\r\n\r\nIf you go look at the system later, they do exist.\r\n\r\nI"ve caught it in action several times and this is the problem:\r\n{code}\r\nroot@lilcloud-controller:~# svcs -x\r\nsvc:/system/manifest-import:default (service manifest import)\r\n State: offline* transitioning to online since Thu Apr 14 13:07:43 2016\r\nReason: Start method is running.\r\n   See: http://support.oracle.com/msg/SMF-8000-C4\r\n   See: smf_bootstrap(7)\r\n   See: /var/svc/log/system-manifest-import:default.log\r\nImpact: This service is not running.\r\n{code}\r\n\r\nThe system is restarting and sometimes it has 15-20 manifests to import, so \r\nit is taking some time.\r\n\r\nThe puppet provider needs to wait for this service to quiesce before it \r\nconsiders the package actually installed.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6749', 'https://github.com/puppetlabs/puppet/pull/5301', '2016-09-27T16:32:51.000-0700', '2016-11-02T06:32:55.000-0700', '2016-11-02T06:32:55.000-0700', 'Closed', 'maintenance', 6, '0', 1, 114, 100, 2, '5001b17528bfdc8d1285d8ff2d1b0097740265b4', 'https://tickets.puppetlabs.com/browse/PUP-6749', 'https://github.com/puppetlabs/puppet/pull/5301'),
('puppet', 155327, 88165156, 5318, 'Ensuring latest does not use upgrade command in DNF', 'tl;dr using ensure latest with a previous install will use the install command in dnf, which does not upgrade the package:\r\n\r\n{code}\r\nDebug: /Stage[main]/Main/Package[cockpit]/ensure: cockpit "0.55-1.fc22" is installed, latest is "0:0.67-2.fc22"\r\n  Debug: Package[cockpit](provider=dnf_update): Ensuring => latest\r\n  Debug: Executing: "/usr/bin/dnf -d 0 -e 1 -y install cockpit"\r\n  Notice: /Stage[main]/Main/Package[cockpit]/ensure: ensure changed "0.55-1.fc22" to "0:0.67-2.fc22"\r\n  Debug: /Stage[main]/Main/Package[cockpit]: The container Class[Main] will propagate my refresh event\r\n{code}\r\n\r\nThe original issue of failing to update when a new version is specified was fixed in https://tickets.puppetlabs.com/browse/PUP-6324, but the code doesn"t cover the case of a package that is installed, then later attempted to update with ensure => latest. ', 'https://tickets.puppetlabs.com/browse/PUP-6798', 'https://github.com/puppetlabs/puppet/pull/5318', '2016-10-05T14:47:15.000-0700', '2016-11-02T06:32:55.000-0700', '2016-11-02T06:32:55.000-0700', 'Closed', 'maintenance', 1, '0', 1, 26, 0, 2, '6180983117126e8d9ecc84ea09369bd1c53c5aec', 'https://tickets.puppetlabs.com/browse/PUP-6798', 'https://github.com/puppetlabs/puppet/pull/5318'),
('puppet', 144326, 79626416, 5162, 'launchd service provider crashes if a non-text or binary plist file in {System,}/Library/Launch{Daemons,Agents} directory exists', 'If a file in the LaunchAgents or LaunchDaemons paths is encountered that"s not:\r\n* a plain text file (plist or not)\r\n* a binary plist file (magic "bplist00")\r\n\r\nthen Puppet will crash with an error.\r\n\r\nTo reproduce:\r\n{code}\r\n# cp /bin/ls /Library/LaunchDaemons\r\n# puppet resource service\r\nError: Could not run: invalid byte sequence in UTF-8\r\n{code}\r\n\r\nIn [plist.rb line 34|https://github.com/puppetlabs/puppet/blob/ed209118fceb6433b51c88c10883cb7415b36adb/lib/puppet/util/plist.rb#L34] there"s a check if it’s a binary plist or not.\r\n\r\nIn the case of a binary blob that"s on a binary plist, this will fail, and fall through to [parse_plist on line 55|https://github.com/puppetlabs/puppet/blob/ed209118fceb6433b51c88c10883cb7415b36adb/lib/puppet/util/plist.rb#L55], which tries to check the file"s contents against the {{bad_xml_doctype]} regex.\r\n\r\nThis fails because of the encoding.\r\n\r\nI expect the correct course of action is to handle the {{ArgumentError}} and return {{nil}}', 'https://tickets.puppetlabs.com/browse/PUP-6568', 'https://github.com/puppetlabs/puppet/pull/5162', '2016-08-01T12:25:23.000-0700', '2016-11-02T06:32:55.000-0700', '2016-11-02T06:32:55.000-0700', 'Closed', '', 2, '0', 2, 23, 5, 3, '5495168ea5cfc2e7c1ae0c91e26776cea225cf7f', 'https://tickets.puppetlabs.com/browse/PUP-6568', 'https://github.com/puppetlabs/puppet/pull/5162'),
('puppet', 141775, 77643466, 5121, 'Multiple tidy resources with same path but different matches causes an error', 'Having multiple {{tidy}} resources with the same {{path}} but different {{matches}} parameters causes an error:\r\n{code}\r\n$ puppet apply -e "\r\n> tidy { "test1":\r\n>   path => "/tmp/tidy",\r\n>   matches => "some-regex.*",\r\n>   recurse => true,\r\n> }\r\n> tidy { "test2":\r\n>   path => "/tmp/tidy",\r\n>   matches => "some-other-regex.*",\r\n>   recurse => true,\r\n> }\r\n> "\r\nNotice: Compiled catalog for derezzed.roam.corp.google.com in environment production in 0.05 seconds\r\nError: Cannot alias Tidy[test2] to ["/tmp/tidy"]; resource ["Tidy", "/tmp/tidy"] already declared\r\n{code}\r\n\r\nThe error is thrown during [catalog generation|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/resource/catalog.rb#L189], the key passed into that alias method comes from the resource"s [{{uniqueness_key}}|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/resource/catalog.rb#L161] and class. The {{uniqueness_key}} is [generated|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/type.rb#L436] from the type"s {{key_attributes}} which are all parameters that are [marked "isnamevar" or are called name|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/type.rb#L377]. The parameter Tidy declares {{isnamevar}} is [{{path}}|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/type/tidy.rb#L22], so having multiple Tidy resources with the same {{path}} will fail even if they have different {{matches}} parameters.', 'https://tickets.puppetlabs.com/browse/PUP-6508', 'https://github.com/puppetlabs/puppet/pull/5121', '2016-07-15T07:53:57.000-0700', '2016-11-02T06:32:55.000-0700', '2016-11-02T06:32:55.000-0700', 'Closed', '', 5, '0', 1, 3, 0, 1, 'caeb6513244c320bb1076430ae83b0d2af0f022a', 'https://tickets.puppetlabs.com/browse/PUP-6508', 'https://github.com/puppetlabs/puppet/pull/5121'),
('puppet', 148349, 81735685, 5213, 'Puppet::Agent class accepts Report but no way to use correct transaction_uuid', 'The {{Puppet::Agent}} class provides a way to pass client options, that can be used to pass in a Report and then access the Report after the Agent run has finished. However, if the Report is initialized outside of Configurer, it can"t have the correct transaction_uuid.\r\n\r\nProvide a way to access the Report after an Agent run, with the correct data in the Report.', 'https://tickets.puppetlabs.com/browse/PUP-6642', 'https://github.com/puppetlabs/puppet/pull/5213', '2016-08-22T09:13:06.000-0700', '2016-11-02T06:32:56.000-0700', '2016-11-02T06:32:56.000-0700', 'Closed', '', 0, '0', 1, 24, 5, 4, 'ed7c7953ae4d771e1fbb4a1b9c654cf4bcd62441', 'https://tickets.puppetlabs.com/browse/PUP-6642', 'https://github.com/puppetlabs/puppet/pull/5213'),
('puppet', 151091, 84644845, 5268, 'Warn/error if $trusted_server_data is assigned if not in --trusted_server_facts mode and --strict is on', 'We are planning to throw the switch on {{\--trusted_server_data}} in Puppet 5.0.0 (PUP-6612). The current implementation does however not issue a deprecation warning for an assignment to {{$server_facts}} and it would then simply error on 5.0.0.\r\n\r\nTo make that better, we can use {{\--strict}} to control if assignment to {{$server_facts}} should be a warning, error, or be ignored. That gives users a chance to fix this before they upgrade.', 'https://tickets.puppetlabs.com/browse/PUP-6693', 'https://github.com/puppetlabs/puppet/pull/5268', '2016-09-09T05:20:24.000-0700', '2016-11-02T06:32:56.000-0700', '2016-11-02T06:32:56.000-0700', 'Closed', '', 1, '0', 1, 19, 2, 2, 'f377ed761cff1d8e3c8682ea8c647ad28f687b4f', 'https://tickets.puppetlabs.com/browse/PUP-6693', 'https://github.com/puppetlabs/puppet/pull/5268'),
('puppet', 150545, 84553214, 5265, '$settings leaks symbols into manifests', '{code}\r\n% puppet apply -e "$be = $settings::storeconfigs_backend notice(inline_template("<%= @be.class %>"))"\r\nNotice: Scope(Class[main]): Symbol\r\n{code}\r\n\r\nand therefore\r\n\r\n{code}\r\n% puppet apply -e "notice($settings::storeconfigs_backend == "puppetdb")"\r\nNotice: Scope(Class[main]): false\r\n{code}\r\n\r\nThis stuff should be stringified I guess, and in general $settings is just horrible and should be a hash.', 'https://tickets.puppetlabs.com/browse/PUP-6682', 'https://github.com/puppetlabs/puppet/pull/5265', '2016-09-06T06:49:40.000-0700', '2016-11-02T06:32:56.000-0700', '2016-11-02T06:32:56.000-0700', 'Closed', '', 8, '0', 2, 35, 1, 2, '9dacf0d24c3c9ddb4479b6e3606bf3e048cdd6a0', 'https://tickets.puppetlabs.com/browse/PUP-6682', 'https://github.com/puppetlabs/puppet/pull/5265'),
('puppet', 153936, 87292776, 5307, 'Puppet log functions should return Undef rather than a Puppet::Util::Log object', 'Currently, the log functions (like {{lib/puppet/functions/alert.rb}}) return an instance of a {{Puppet::Util::Log}} object. Some context from Henrik:\r\n\r\n[9:26 AM] Henrik Lindberg: so, it returns some kind of Log object, which is not good when these functions are called from puppet as that object leaks into the puppet world\r\n[9:27 AM] Henrik Lindberg: when they were 3x functions there is a general mechanism where all "non r-value" type functions always are made to return nil to puppet\r\n[9:27 AM] Henrik Lindberg: there is no such thing in 4.x, all functions are rvalue functions, only that they return nil if they have nothing meaningful to return\r\n[9:29 AM] Henrik Lindberg: now, we may not be able to change the return to Undef actually - because people may call the puppet functions from Ruby and expect to get a Log object\r\n[9:33 AM] Henrik Lindberg: Problem: if we document it as Undef, it is correct from a spec standoint, and thus it is a bug that it actually returns Log sometimes\r\n[9:34 AM] Henrik Lindberg: if we document it what it really is {{Optional[Runtime["ruby", "Puppet::Util::Log"]]}}, that is really confusing, and you cannot really do much with that value\r\n[9:34 AM] Henrik Lindberg: I think it is best to document it as Undef, and add a ticket that logging functions should return undef and never the log object instance.\r\nThose that code in ruby and need the Util::Log object should instead do the logging themselves and not call the puppet functions\r\n\r\nThese functions now use a log helper in {{lib/puppet/util/log.rb}}. They end up returning:\r\n\r\n{code}\r\nPuppet::Util::Log.create({:level => level, :source => scope, :message => vals.join(" ")})\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6753', 'https://github.com/puppetlabs/puppet/pull/5307', '2016-09-28T09:57:12.000-0700', '2016-11-02T06:32:56.000-0700', '2016-11-02T06:32:56.000-0700', 'Closed', '', 1, '0', 1, 16, 0, 10, 'e6c31d09cd616faed4ed37a8c3ff58297dca94f7', 'https://tickets.puppetlabs.com/browse/PUP-6753', 'https://github.com/puppetlabs/puppet/pull/5307'),
('puppet', 155561, 88350384, 5319, 'PEZ 2016.5.x mono smoke integration fails with Unable to serialize non-Data type parameters unless a serializer is provided', 'https://jenkins.puppetlabs.com/job/enterprise_pe-acceptance-tests-feature-branch_integration-system_pe_fb_smoke-monolithic_2016.5.x/LAYOUT=64mcd,LEGACY_AGENT_VERSION=NONE,PLATFORM=redhat7,UPGRADE_FROM=NONE,label=beaker/7/console\r\n\r\nPEZ fails with the following in setup:\r\n\r\n{code}\r\n19:50:16     	Error: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Unable to serialize non-Data type parameters unless a serializer is provided\r\n{code}\r\n\r\nThis was likely caused by this series of commits (part of PUP-5834): https://github.com/puppetlabs/puppet/commit/375bdeefef79e3984f1d53db04e14c94e5a3d30c', 'https://tickets.puppetlabs.com/browse/PUP-6799', 'https://github.com/puppetlabs/puppet/pull/5319', '2016-10-06T13:22:53.000-0700', '2016-11-02T06:32:57.000-0700', '2016-11-02T06:32:57.000-0700', 'Closed', '', 1, '0', 1, 46, 2, 2, '7bfe935c68aba1e256572565f11ca6f728dedc87', 'https://tickets.puppetlabs.com/browse/PUP-6799', 'https://github.com/puppetlabs/puppet/pull/5319'),
('puppet', 141582, 81883449, 5217, 'puppet calls dscl pathologically often', 'A typical macOS puppet run triggers around 125 executions of {{/usr/bin/dscl}}; most of these are the user directoryservices provider calling {{/usr/bin/dscl -plist . read /Users/<username> ShadowHashData}} for every user on the system.\r\n\r\nThe provider already calls {{/usr/bin/dscl -plist . -readall /Users}}, however, and this plist contains the {{ShadowHashData}} for all the users.\r\n\r\nI think with some better memoization we can reduce the number of execs dramatically.', 'https://tickets.puppetlabs.com/browse/PUP-6502', 'https://github.com/puppetlabs/puppet/pull/5217', '2016-07-13T14:45:54.000-0700', '2016-11-02T06:32:57.000-0700', '2016-11-02T06:32:57.000-0700', 'Closed', '', 4, '0', 1, 7, 1, 1, '77d4dd2cdf0a359295f0c2f5ae5c4f6afa0c4cc6', 'https://tickets.puppetlabs.com/browse/PUP-6502', 'https://github.com/puppetlabs/puppet/pull/5217'),
('puppet', 150928, 84487745, 5263, 'Timespan and Timestamp should inherit from Scalar, not from Numeric', 'Timespan and Timestamp currently inherits from Numeric. This is incorrect since they break the Numeric contract. They should instead inherit directly from Scalar.', 'https://tickets.puppetlabs.com/browse/PUP-6689', 'https://github.com/puppetlabs/puppet/pull/5263', '2016-09-08T06:15:35.000-0700', '2016-11-02T06:32:57.000-0700', '2016-11-02T06:32:57.000-0700', 'Closed', '', 0, '0', 1, 31, 19, 4, '92493e59cfc00b0d5f25f2369780d3726833e008', 'https://tickets.puppetlabs.com/browse/PUP-6689', 'https://github.com/puppetlabs/puppet/pull/5263'),
('puppet', 154526, 87600436, 5310, 'Using produce/consume results in "Attempt to redefine entity" errors', 'Using generated pcore resource types in combination with app management produce/consume\r\ndeclarations fails with "Attempt to redefine entity" errors.', 'https://tickets.puppetlabs.com/browse/PUP-6765', 'https://github.com/puppetlabs/puppet/pull/5310', '2016-09-30T15:45:14.000-0700', '2016-11-02T06:32:57.000-0700', '2016-11-02T06:32:57.000-0700', 'Closed', '', 2, '0', 2, 89, 10, 5, '626f6855426b365b4c108f0ffc99e54a7f3c2c59', 'https://tickets.puppetlabs.com/browse/PUP-6765', 'https://github.com/puppetlabs/puppet/pull/5310'),
('puppet', 152535, 86710456, 5298, 'PCore generation omits information about capability types', 'Given a capability resource type definition:\r\n\r\n{code}\r\nPuppet::Type.newtype :cap, :is_capability => true do\r\n  newparam :name, :is_namevar => true\r\n  newparam :value\r\nend\r\n{code}\r\n\r\nthe generated PCore looks something like:\r\n\r\n{code}\r\n# This file was automatically generated on 2016-09-19 13:38:35 -0700.\r\n# Use the "puppet generate types" command to regenerate this file.\r\n\r\nPuppet::Resource::ResourceType3.new(\r\n  "cap",\r\n  [\r\n\r\n  ],\r\n  [\r\n    Puppet::Resource::Param(Any, "name"),\r\n\r\n    Puppet::Resource::Param(Any, "value")\r\n  ],\r\n  {\r\n    /(.*)/ => ["name"]\r\n  },\r\n  true)\r\n{code}\r\n\r\nThe PCore version has lost the {{:is_capability => true}} flag, causing the resource type to behave like any other type. Since there"s special handling of capabilities with regard to how/when they"re validated and looked up from PuppetDB, this effectively breaks the app management features when using {{puppet generate}}.', 'https://tickets.puppetlabs.com/browse/PUP-6714', 'https://github.com/puppetlabs/puppet/pull/5298', '2016-09-19T13:42:52.000-0700', '2016-11-02T06:32:58.000-0700', '2016-11-02T06:32:58.000-0700', 'Closed', '', 5, '0', 2, 59, 11, 7, '5a890c47e4093176031333aeb4cb9490cd46ab72', 'https://tickets.puppetlabs.com/browse/PUP-6714', 'https://github.com/puppetlabs/puppet/pull/5298'),
('puppet', 153124, 86504112, 5292, 'The new strftime function is not compatible with the strftime function in stdlib.', 'The {{strftime}} function in [puppetlabs-stdlib|https://github.com/puppetlabs/puppetlabs-stdlib/blob/72f6e379a647396c276d7f216b307361ac76f376/lib/puppet/parser/functions/strftime.rb] and the new {{strftime}} function added as part of PUP-5871 are not compatible. The one from stdlib has the following API:\r\n{code:puppet}\r\nString strftime(String format, String timezone = undef)\r\n{code}\r\nwhereas the API of the new function is:\r\n{code:puppet}\r\nString strftime(Variant[Timespan,Timestamp], String format)\r\n{code}\r\n\r\nAs part of this change, a third optional timezone argument should also be added, to allow the given time to be formatted in accordance with that timezone.', 'https://tickets.puppetlabs.com/browse/PUP-6724', 'https://github.com/puppetlabs/puppet/pull/5292', '2016-09-22T02:10:37.000-0700', '2016-11-02T19:15:58.000-0700', '2016-11-02T19:15:58.000-0700', 'Closed', '', 6, '0', 2, 252, 26, 7, '71bc03c5cb0e9402a886f2fb447b1edd3175a406', 'https://tickets.puppetlabs.com/browse/PUP-6724', 'https://github.com/puppetlabs/puppet/pull/5292'),
('puppet', 126561, 93699587, 5379, 'Mount resources could handle invalid options better', 'If I specify in a manifest:\r\n\r\n{code:java}\r\nmount { "/var/tmp":\r\n      ensure      => "mounted",\r\n      device      => "/dev/sdb1",\r\n      fstype      => "ext4",\r\n      options     => "ro,nosuid,noexec,foo,bar",\r\n      atboot      => true,\r\n      dump        => "0",\r\n      pass        => "0",\r\n      remounts => true,\r\n    }\r\n{code}\r\n\r\n...puppet will add an entry to /etc/fstab:\r\n\r\n{code:java}\r\n# cat /etc/fstab | grep /var/tmp\r\n/dev/sdb1	/var/tmp	ext4	ro,nosuid,noexec,foo,bar	  0	0\r\n{code}\r\n\r\n...and the remount attempt will spawn an error:\r\n\r\n{code:java}\r\nError: /Stage[main]/Mounts/Mount[/var/tmp]: Execution of "/bin/mount -o remount /var/tmp" returned 32: mount: /var/tmp not mounted already, or bad option\r\n{code}\r\n\r\n...however subsequent runs will not reattempt the remount and will ignore the discrepancy between /etc/fstab and the actual mounted volume.\r\n\r\nCould there be output in subsequent puppet runs that points out the discrepancy?', 'https://tickets.puppetlabs.com/browse/PUP-6457', 'https://github.com/puppetlabs/puppet/pull/5379', '2016-04-13T17:27:41.000-0700', '2016-11-04T00:16:18.000-0700', '2016-11-04T00:16:18.000-0700', 'Closed', '', 15, '0', 1, 34, 116, 5, '59cb02950c2d77e13aac6aeda8ce6dd8f1f7238e', 'https://tickets.puppetlabs.com/browse/PUP-6457', 'https://github.com/puppetlabs/puppet/pull/5379'),
('puppet', 119284, 61490952, 4745, 'Stray UTF-8 character in manifest corrupts parsed parameters', 'If I have the {{Puppet::InfoService::ClassInformationService}} or {{resource_types}} endpoint parse a manifest which includes a special UTF-8 character, the resulting default values parsed for parameters appear to be corrupted.\r\n\r\nHere is the manifest file I used for this test, also attached as "parse.pp":\r\n\r\n{code:puppet}\r\nclass myclass (\r\n   String $a_string = "this is a Ѐ string",\r\n   Integer $an_integer = 3,\r\n) {}\r\n{code}\r\n\r\nNote that the character at the end of the comment line is a Cyrillic Capital letter Ye with grave, Unicode code point of U+0400, hex representation of 0xD080 in UTF-8 in the file.\r\n \r\nRunning the following code...\r\n\r\n{code:ruby}\r\nrequire "puppet"\r\nrequire "puppet/info_service"\r\n\r\nfiles_to_parse = { "production" => [ "./parse.pp" ] }\r\n\r\nputs Puppet::InfoService::ClassInformationService.new.classes_per_environment(files_to_parse)\r\n{code}\r\n\r\n... produces the following output:\r\n\r\n{noformat}\r\n{"production"=>{"./parse.pp"=>{:classes=>[{:name=>"myclass", :params=>[{:name=>"a_string", :type=>"String", :default_literal=>"this is a Ѐ string", :default_source=>"\"this is a Ѐ string\","}, {:name=>"an_integer", :type=>"Integer", :default_literal=>3, :default_source=>","}]}]}}}\r\n{noformat}\r\n\r\nThe `:default_literal` values for each parameter appear to be correct but the `:default_source` values do not.  Instead of "\"this is a Ѐ string\",", I would have expected "\"this is a Ѐ string\"".  Instead of ",", I would have expected "3".\r\n\r\nThis problem does not appear to be unique to the {{ClassInformationService}}.  I get the same error when I use the "resource_types" endpoint to query for this data.  For a query to "https://localhost:8140/puppet/v3/resource_types/*?kind=class&environment=production" where the "parse.pp" file is stored under the "<code-dir>/environments/production/modules/mymodule/manifests" directory, I get the following response (pretty-printed for display):\r\n\r\n{noformat}\r\n[\r\n    {\r\n        "kind": "class",\r\n        "line": 2,\r\n        "name": "myclass",\r\n        "parameters": {\r\n            "a_string": "\"this is a Ѐ string\",",\r\n            "an_integer": ","\r\n        }\r\n    }\r\n]\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5995', 'https://github.com/puppetlabs/puppet/pull/4745', '2016-03-01T10:38:42.000-0800', '2016-11-04T15:11:20.000-0700', '2016-11-04T15:11:20.000-0700', 'Closed', 'utf-8', 9, '0', 6, 98, 7, 5, '825286af892495e5fb4ea5fef809829d1d3c922d', 'https://tickets.puppetlabs.com/browse/PUP-5995', 'https://github.com/puppetlabs/puppet/pull/4745'),
('puppet', 160528, 93241016, 5373, 'Spec tests fail when run on a windows host whose name exceeds 15 characters', 'Our windows jenkins agents in CI.Next have hostnames (not fqdn) longer than 15 characters. As a result {{Socket.gethostname}} and Win32 {{GetComputerName}} return different results (the former is a truncated version of the latter), e.g. {{jenkins-slave-w}}  vs {{jenkins-slave-win2012r2-...}}\r\n\r\nTwo tests in {{spec/integration/util/windows/principal_spec.rb}} fail because they are using {{Socket.gethostname}} when they instead need to use {{GetComputerName}} in subsequent calls to {{LookupAccountNameW}}.\r\n\r\n{noformat}\r\n07:11:29   1) Puppet::Util::Windows::SID::Principal.lookup_account_name should create an instance from a local account prefixed with hostname\r\n07:11:29      Failure/Error: Puppet::Util::Windows::SID.sid_to_name(computer_sid.sid + "-500").split("\\").last :\r\n07:11:29      NoMethodError:\r\n07:11:29        undefined method `sid" for nil:NilClass\r\n07:11:29      # ./spec/integration/util/windows/principal_spec.rb:58:in `block (3 levels) in <top (required)>"\r\n07:11:29 \r\n07:11:29   2) Puppet::Util::Windows::SID::Principal.lookup_account_sid should create an instance from a user SID\r\n07:11:29      Failure/Error: bytes = (computer_sid.sid_bytes + [245, 1, 0, 0])\r\n07:11:29      NoMethodError:\r\n07:11:29        undefined method `sid_bytes" for nil:NilClass\r\n07:11:29      # ./spec/integration/util/windows/principal_spec.rb:125:in `block (3 levels) in <top (required)>"\r\n07:11:32 \r\n07:11:32 Finished in 22 minutes 37 seconds\r\n07:11:32 21740 examples, 2 failures, 67 pending\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-6913', 'https://github.com/puppetlabs/puppet/pull/5373', '2016-11-10T13:57:28.000-0800', '2016-11-22T14:58:50.000-0800', '2016-11-22T14:58:50.000-0800', 'Closed', '', 1, '0', 1, 2, 2, 1, 'c6155f6de975690555f16abc6b2650a8bbfafe26', 'https://tickets.puppetlabs.com/browse/PUP-6913', 'https://github.com/puppetlabs/puppet/pull/5373'),
('puppet', 159671, 92416410, 5361, 'Puppet::Settings::IniFile doesn"t handle Unicode keys / sections properly - can cause `config set` / `config print` failures', 'While working on PUP-6188, it was discovered that {{puppet config set}} and {{puppet config print}} did not behave properly when using UTF-8 characters in the {{puppet.conf}} INI file.\r\n\r\nThis was traced back to a problem in {{Puppet::Settings::IniFile}} and it"s ability to properly parse key / value pairs.  In particular, RegEx {{\w}} character class doesn"t work for Unicode, but {{[[:word:]]}} does - see more details in PUP-6875\r\n\r\nNote that there might be 2 separate INI file parsers inside Puppet itself, and another in the INI module that might be worth investigating here.', 'https://tickets.puppetlabs.com/browse/PUP-6876', 'https://github.com/puppetlabs/puppet/pull/5361', '2016-11-03T14:43:19.000-0700', '2016-11-22T14:58:51.000-0800', '2016-11-22T14:58:51.000-0800', 'Closed', '', 7, '0', 5, 188, 4, 5, '409a839cee651b21885577ec9b5d0582ff1891dc', 'https://tickets.puppetlabs.com/browse/PUP-6876', 'https://github.com/puppetlabs/puppet/pull/5361'),
('puppet', 142789, 92209417, 5359, 'Windows parallel specs fail', 'PUP-5938 added some spec tests which fail when using the parallel spec runner on windows\r\n\r\n{code}\r\nFailures:\r\n\r\n  1) Puppet::Type::Group::ProviderWindows_adsi should be able to test whether a group exists\r\n     Failure/Error: expect(provider).to be_exists\r\n       expected `Group[testers](provider=windows_adsi).exists?` to return true, got false\r\n     # ./spec/unit/provider/group/windows_adsi_spec.rb:250:in `block (2 levels) in <top (required)>"\r\n     # util/rspec_runner:39:in `run"\r\n     # util/rspec_runner:53:in `<main>"\r\n  2) Puppet::Type::User::ProviderWindows_adsi should be able to test whether a user exists\r\n     Failure/Error: expect(provider).to be_exists\r\n       expected `User[testuser](provider=windows_adsi).exists?` to return true, got false\r\n     # ./spec/unit/provider/user/windows_adsi_spec.rb:253:in `block (2 levels) in <top (required)>"\r\n     # util/rspec_runner:39:in `run"\r\n     # util/rspec_runner:53:in `<main>"\r\nFinished in 33.82 seconds (files took 5.88 seconds to load)\r\n\r\nFinished in 5 minutes 57 seconds\r\n21401 examples, 2 failures, 62 pending\r\n\r\nFailed examples:\r\nrspec ./spec/unit/provider/group/windows_adsi_spec.rb:247 # Puppet::Type::Group::ProviderWindows_adsi should be able to test whether a group exists\r\nrspec ./spec/unit/provider/user/windows_adsi_spec.rb:250 # Puppet::Type::User::ProviderWindows_adsi should be able to test whether a user exists\r\n{code}\r\n\r\nThis is occuring in local dev environment and on Appveyor', 'https://tickets.puppetlabs.com/browse/PUP-6534', 'https://github.com/puppetlabs/puppet/pull/5359', '2016-07-21T16:23:06.000-0700', '2016-11-22T14:58:51.000-0800', '2016-11-22T14:58:51.000-0800', 'Closed', '', 5, '0', 1, 1, 1, 1, '491c0ffa7052d7d5f2bbf59c9663e31b67c2395e', 'https://tickets.puppetlabs.com/browse/PUP-6534', 'https://github.com/puppetlabs/puppet/pull/5359'),
('puppet', 159344, 93699587, 5379, '[regression] Mount options not idempotent', 'After upgrading to Puppet 4.8.0, I keep seeing Puppet reports along the following lines:\r\n\r\n{noformat}\r\n2016-11-02 09:32:16 +0100 /Stage[main]/Mount[/]/options (notice): options changed "defaults,acl,user_xattr" to "defaults,acl,user_xattr"\r\n2016-11-02 09:32:16 +0100 /Stage[main]/Mount[/] (notice): Triggered "refresh" from 1 events\r\n2016-11-02 09:32:17 +0100 /Stage[main]/Mount[/var/redacted]/options (notice): options changed "rw,bind,acl" to "rw,bind,acl"\r\n2016-11-02 09:32:17 +0100 /Stage[main]/Mount[/var/redacted] (notice): Triggered "refresh" from 1 events\r\n{noformat}\r\n\r\nEven though the actual mount options are identical to the desired state, Puppet keeps thinking they are out-of-sync and re-mounting the mount point. This worked fine with Puppet 4.7.x.', 'https://tickets.puppetlabs.com/browse/PUP-6861', 'https://github.com/puppetlabs/puppet/pull/5379', '2016-11-02T02:01:27.000-0700', '2016-11-22T14:58:52.000-0800', '2016-11-22T14:58:52.000-0800', 'Closed', 'regression', 27, '0', 1, 34, 116, 5, 'ac6709f2e76cbb68639bb626b6481b743cd9b56b', 'https://tickets.puppetlabs.com/browse/PUP-6861', 'https://github.com/puppetlabs/puppet/pull/5379'),
('puppet', 108376, 52621942, 4481, 'confine :exists => "/run/systemd/system" breaks chroot installation', 'The line\r\n\r\n{code:puppet}\r\nconfine :exists => "/run/systemd/system" \r\n{code}\r\n\r\nwas added with [1] but breaks running puppet within a chroot environment that doesn"t have /run mounted.  When puppet doesn"t see this directory, it assumes systemd isn"t there and ends up falling back to "chkconfig" for service enablement which is quite confusing\r\n\r\n[1] https://github.com/puppetlabs/puppet/commit/7fe61647f23650fc4c93cd6b54c654a20ff7c9f9', 'https://tickets.puppetlabs.com/browse/PUP-5577', 'https://github.com/puppetlabs/puppet/pull/4481', '2015-12-03T18:12:09.000-0800', '2016-11-23T11:09:54.000-0800', '2016-11-23T11:09:54.000-0800', 'Closed', '', 3, '0', 1, 8, 1, 1, 'c36f1e9e6c61dad042cd5827f816a570bc71cc6b', 'https://tickets.puppetlabs.com/browse/PUP-5577', 'https://github.com/puppetlabs/puppet/pull/4481'),
('puppet', 24066, 0, 0, 'resources using parsedfile providers quietly move resources from default file to target', 'use the host resource and puppet resource:\r\n\r\nI expect the following to fail:\r\n\r\n{noformat}\r\n# puppet resource host test1 ensure=present target="/tmp/host" host_aliases=alias1\r\nnotice: /Host[test1]/ensure: created\r\nerr: /Host[test1]: Could not evaluate: ip is a required attribute for hosts\r\nhost { "test1":\r\n    host_aliases => ["alias1"],\r\n    target => "/tmp/host",\r\n    ensure => "present"\r\n}\r\n{noformat}\r\n\r\nIf there is already an entry for this host in /etc/hosts (the default target), puppet will use the ip address of that host and move it to the new target location.\r\n\r\n{noformat}\r\n# echo "127.0.0.2 test1"> /etc/hosts\r\n[root@puppet2 puppet_spec]# puppet resource host test1 ensure=present target="/tmp/host" host_aliases=alias1\r\nnotice: /Host[test1]/host_aliases: host_aliases changed "" to "alias1"\r\nnotice: /Host[test1]/target: target changed "/etc/hosts" to "/tmp/host"\r\nhost { "test1":\r\n    host_aliases => ["alias1"],\r\n    target => "/tmp/host",\r\n    ensure => "present"\r\n}\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1479', '', '2014-01-21T06:40:15.000-0800', '2016-11-28T13:44:45.000-0800', '2016-11-28T13:44:45.000-0800', 'Closed', 'redmine', 3, '0', 0, 0, 0, 0, '3f8bb6b892047a4b1cffc80c246b8b81670a857c', 'https://tickets.puppetlabs.com/browse/PUP-1479', 'https://github.com/puppetlabs/puppet/commit/3f8bb6b892047a4b1cffc80c246b8b81670a857c'),
('puppet', 147668, 81693080, 5208, 'Corrective change should use property values directly, bypassing any munging', 'Currently, corrective change uses the "correct" should readers/writers for property values. Unfortunately, properties may have {{munge}} and {{unmunge}} implementations that are not symmetrical, and in some cases this can cause both {{should=}} and {{validate}} to fail for those types.\r\n\r\nIf we update corrective_change to be a bit more aggressive when inspecting property values, we can avoid the entire munge/unmunge/validate dance, and simply inject data directly into the property in exactly the same form that we pull it out.\r\n\r\nThis may causes issues if internal representations of data change between versions of properties, but corrective change reporting is already likely to be flaky in those cases.', 'https://tickets.puppetlabs.com/browse/PUP-6628', 'https://github.com/puppetlabs/puppet/pull/5208', '2016-08-17T11:23:06.000-0700', '2016-11-30T21:30:37.000-0800', '2016-11-30T21:30:37.000-0800', 'Closed', '', 5, '0', 1, 18, 14, 2, 'e521c3aaf2fa2939106dabba3e401c917a8e5f88', 'https://tickets.puppetlabs.com/browse/PUP-6628', 'https://github.com/puppetlabs/puppet/pull/5208'),
('puppet', 139455, 79306294, 5159, 'puppet resource service fails on Windows 10 Pro (x64)', 'Running {{puppet resource service}} on Windows 10 fails with\r\n{code}\r\nWARNING: Failed to retreive description for the pvhdparser service.\r\nError: Could not run: No such device or address - QueryServiceConfig2: The handle is invalid.\r\n{code}\r\n\r\nThis seems to originate in the win32/service gem:\r\n{code}\r\nirb(main):001:0> require "win32/service"\r\n=> true\r\nirb(main):002:0> Win32::Service.services\r\nWARNING: Failed to retreive description for the pvhdparser service.\r\nErrno::ENXIO: No such device or address - QueryServiceConfig2: The handle is invalid.{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6459', 'https://github.com/puppetlabs/puppet/pull/5159', '2016-06-29T16:44:05.000-0700', '2016-12-05T04:26:02.000-0800', '2016-12-05T04:26:02.000-0800', 'Closed', '', 17, '0', 1, 2, 2, 1, 'e18e35bb0312fe5e4d0f9ed005bcf72d4c0211b6', 'https://tickets.puppetlabs.com/browse/PUP-6459', 'https://github.com/puppetlabs/puppet/pull/5159'),
('puppet', 92995, 68908677, 4940, 'Package resource showing notice when ensure attribute contains Epoch tag', '{{package}} resources do not behave properly when their {{ensure}} attribute is set to a version number containing an Epoch tag.\r\n\r\n+Example+:\r\n\r\nOn Fedora 22, the current version of the {{tomcat}} package is "1:7.0.59-4.fc22".\r\n\r\n* With {{ensure => "7.0.59-4.fc22"}} yum/dnf exits with error "package not found" and Puppet fails\r\n* With {{ensure => "1:7.0.59-4.fc22"}} Puppet runs but shows a notice {{package tomcat changed from version 7.0.59-4.fc22 to 1:7.0.59-4.fc22}} on every run', 'https://tickets.puppetlabs.com/browse/PUP-5025', 'https://github.com/puppetlabs/puppet/pull/4940', '2015-08-11T15:20:45.000-0700', '2016-12-08T11:58:01.000-0800', '2016-12-08T11:58:01.000-0800', 'Closed', '', 5, '0', 2, 6, 9, 3, '1fdaeae9fa4f18c1c96da3d6fd84613dab6024f8', 'https://tickets.puppetlabs.com/browse/PUP-5025', 'https://github.com/puppetlabs/puppet/pull/4940'),
('puppet', 18797, 667313064, 8628, 'Masters cannot reliably distinguish between multiple versions of a type/function/plugin used in different environments', 'Quoted from a previous ticket, #4409\r\n\r\nThe key problem is that a master can’t reliably distinguish between two versions of the same native type that are used in different environments (or between an environment which uses a native type and an environment which doesn’t). This is due to the fact that native types are defined using ruby code, which the master loads into Ruby classes via “require”. Since there can only be one Ruby class with a given name at a time, this prevents the master from being able to have two different versions of the same type in two different environments. This makes life difficult for people who are trying to use a “test” environment to try out a new version of a native type on a limited set of nodes before deploying it to all nodes.\r\n\r\nA secondary problem is that the location where the master looks for the definition of native types is not the same as the location of plug-in files that the master distributes to agents. This leads to confusion even for people who are not using a “test” environment, because it means that they have to put their type definitions in two places, one where they can be picked up by the master and one where they can be sent as plug-ins to agents.', 'https://tickets.puppetlabs.com/browse/PUP-731', 'https://github.com/puppetlabs/puppet/pull/8628', '2013-11-13T07:56:42.000-0800', '2016-12-12T13:41:10.000-0800', '2016-12-12T13:41:10.000-0800', 'Closed', 'customer;redmine', 35, '0', 1, 23, 0, 1, 'e7d6096e8601f32b904331701a5d946750aac311', 'https://tickets.puppetlabs.com/browse/PUP-731', 'https://github.com/puppetlabs/puppet/pull/8628'),
('puppet', 158713, 91415388, 5351, 'Remove "commit" check task from travis ci', 'CI now routinely fails against pull requests, because we haven"t figured out a fully accurate way to only get the commit listing in a PR and check the commit format.\r\n\r\nStrictly speaking, having this check hasn"t prevented commits that are incorrectly formatted from being added to the repo anyway, ie:\r\n{code}\r\n6e79498 Delete file commited to wrong repo\r\n80af5ac ;lkajsd\r\n35dd8ef Update MAINTAINERS\r\n{code}\r\n\r\nIMO we should back out the check until we figure out how to do it with complete accuracy, rather than have it consistently cause PR CI failures', 'https://tickets.puppetlabs.com/browse/PUP-6849', 'https://github.com/puppetlabs/puppet/pull/5351', '2016-10-28T09:37:36.000-0700', '2016-12-12T22:17:23.000-0800', '2016-12-12T22:17:23.000-0800', 'Closed', 'maintenance', 1, '0', 1, 0, 9, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-6849', 'https://github.com/puppetlabs/puppet/pull/5351'),
('puppet', 29632, 82047580, 5222, '`puppet certificate generate` Generates Two CSRs in One Run', 'When I run the following on my Puppet Master:\r\n\r\n`puppet certificate generate --verbose --ca-location remote HOSTNAME`\r\n\r\nI receive the following:\r\n\r\nhttp://pastie.org/private/ackais1tdrc0lyjyekozxq\r\n\r\nThe remote Puppet CA does successfully sign the request (autosign is configured), but the command will always exit 1 because of the second CSR creation (which is unnecessary).\r\n\r\nI have noticed that if the Puppet Master already has a CSR in its "*/ssl/certificate_requests/" directory, the command runs as expected:\r\n\r\nhttp://pastie.org/private/iueobgf93b8q0k4edmi56q', 'https://tickets.puppetlabs.com/browse/PUP-2018', 'https://github.com/puppetlabs/puppet/pull/5222', '2014-03-22T18:31:12.000-0700', '2016-12-16T11:38:08.000-0800', '2016-12-16T11:38:08.000-0800', 'Closed', 'support', 5, '0', 1, 8, 3, 3, '21f4a28d6612c5152439cb5d6846efcf64428bc4', 'https://tickets.puppetlabs.com/browse/PUP-2018', 'https://github.com/puppetlabs/puppet/pull/5222'),
('puppet', 141397, 77297586, 5113, '`puppet resource user` does not work on Windows French edition', 'Some basic functionality appears to be broken on a default French Windows that uses code page 850 by default.   This uncovered two errors within Puppets logging and output emission at the console - Puppet is trying to use / combine incompatible strings in CP850 and UTF-8.\r\n\r\nNote that the problem only impacts {{puppet resource user}} and not {{puppet resource group}} - so some investigation should be done to fully understand the problem since those should behave similarly.  Note also that no other {{puppet resource}} commands have been tested.  \r\n\r\nThis was discovered while attempting to replicate PUP-5938 - the first attempt to use {{puppet resource user}} also failed on Puppet 4.3.0, but with a different error.  Not sure if it"s worth investing any time in understanding that issue as well.', 'https://tickets.puppetlabs.com/browse/PUP-6499', 'https://github.com/puppetlabs/puppet/pull/5113', '2016-07-13T07:13:35.000-0700', '2016-12-21T16:20:03.000-0800', '2016-12-21T16:20:03.000-0800', 'Closed', 'i18n;utf-8', 9, '0', 6, 339, 99, 12, '95ec444c4f260ed1530a32385f48a93dee6bbb96', 'https://tickets.puppetlabs.com/browse/PUP-6499', 'https://github.com/puppetlabs/puppet/pull/5113'),
('puppet', 150188, 86581672, 5293, 'Newlines break Puppet tag validation', 'The Puppet compiler uses the following regex to determine whether or not a tag\\r\nis valid:\r\n\r\n{code}\r\n^[0-9A-Za-z_][0-9A-Za-z_:.-]*$\r\n{code}\r\n\r\nThis regex has an issue in that validation will stop at the first newline character in a tag. PuppetDB uses a stricter regex that will reject any tag containing newlines:\r\n\r\n{code}\r\n\A[a-z0-9_][a-z0-9_:\-.]*\Z\r\n{code}\r\n\r\nThis rejection causes PuppetDB to discard catalogs containing resources tagged with strings containing newlines.\r\n\r\nh2. Reproduction Case\r\n\r\nInstall PE 2016.2.1 and add the following resource to the default node declaration in {{/etc/puppetlabs/code/environments/production/manifests/site.pp}}:\r\n\r\n{code:puppet}\r\nnotify {"two\nlines": }\r\n{code}\r\n\r\nRun {{puppet agent -t}}.\r\n\r\nh3. Outcome\r\n\r\nThe catalog compiles and applies just fine:\r\n\r\n{noformat}\r\n# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201621-master.puppetdebug.vlan\r\nInfo: Applying configuration version "1472744920"\r\nNotice: two\r\nlines\r\n{noformat}\r\n\r\nHowever, errors are present in the PuppetDB log:\r\n\r\n{noformat}\r\n2016-09-01 08:48:49,635 ERROR [p.p.mq-listener] [a7244661-f9cd-469c-bfac-ca35be92db5c] [replace catalog] Fatal error on attempt 0 for pe-201621-master.puppetdebug.vlan\r\njava.lang.IllegalArgumentException: Resource "{:type "Notify", :title "two\nlines"}" has an invalid tag "two\r\nlines". Tags must match the pattern /\A[a-z0-9_][a-z0-9_:\-.]*\Z/.\r\n  at puppetlabs.puppetdb.catalogs$validate_resources.invokeStatic(catalogs.clj:303) ~[na:na]\r\n  at puppetlabs.puppetdb.catalogs$validate_resources.invoke(catalogs.clj:294) ~[na:na]\r\n  ...\r\n{noformat}\r\n\r\nAnd a query to the PuppetDB node endpoint shows that a new set of facts was stored along with a new report, but the catlog is out of date:\r\n\r\n{noformat}\r\n# curl http://127.0.0.1:8080/pdb/query/v4/nodes/$(hostname -f)f)\r\n{\r\n  "deactivated" : null,\r\n  "latest_report_hash" : "221e50f615f0320d22c276dd4c4cc01634ba0841",\r\n  "facts_environment" : "production",\r\n  "cached_catalog_status" : "not_used",\r\n  "report_environment" : "production",\r\n  "catalog_environment" : "production",\r\n  "facts_timestamp" : "2016-09-01T15:56:58.329Z",\r\n  "latest_report_noop" : false,\r\n  "expired" : null,\r\n  "report_timestamp" : "2016-09-01T15:57:14.151Z",\r\n  "certname" : "pe-201621-master.puppetdebug.vlan",\r\n  "catalog_timestamp" : "2016-09-01T01:57:03.472Z",\r\n  "latest_report_status" : "changed"\r\n}\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe Puppet compiler uses {{/A}} and {{/Z}} to validate tags so that newlines don"t break validation.', 'https://tickets.puppetlabs.com/browse/PUP-6670', 'https://github.com/puppetlabs/puppet/pull/5293', '2016-09-01T09:03:19.000-0700', '2017-01-11T22:14:49.000-0800', '2017-01-11T22:14:49.000-0800', 'Closed', 'compiler', 20, '0', 1, 5, 1, 2, '668533e72488b98d00fcd059debd636b0b4d9434', 'https://tickets.puppetlabs.com/browse/PUP-6670', 'https://github.com/puppetlabs/puppet/pull/5293'),
('puppet', 150828, 0, 0, 'lest and then functions not well referenced in the documentation', 'I have seen 2 problems in this page https://docs.puppet.com/puppet/latest/reference/function.html.\r\n\r\n1. In the table of content, "lest" function is mentioned but not "then".\r\n2. In the section of "lest" (https://docs.puppet.com/puppet/latest/reference/function.html#lest) it"s the explanation of the "then" function.\r\n\r\nRegards.', 'https://tickets.puppetlabs.com/browse/PUP-6687', '', '2016-09-07T12:42:24.000-0700', '2017-01-11T22:22:29.000-0800', '2017-01-11T22:22:29.000-0800', 'Closed', 'docs_reviewed;maintenance', 3, '0', 0, 0, 0, 0, 'efef4a90bbd5d14c318e76eebe8e905ff235d59e', 'https://tickets.puppetlabs.com/browse/PUP-6687', 'https://github.com/puppetlabs/puppet/commit/efef4a90bbd5d14c318e76eebe8e905ff235d59e'),
('puppet', 157228, 90101086, 5341, 'Address puppet acceptance test failures on windows server 2016', 'When running the puppet aio test suite there were two failures during the run.\r\n\r\nThe first is during tests/ticket_13948_lib_dir_hook_should_be_called_on_initialization.rb. It appears there was a connection failure during the test:\r\n\r\n{code}\r\n* verify that the application shows up in help\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) 10:07:00$ cmd.exe /c puppet help --vardir="C:/cygwin64/tmp/ticket_13948_lib_dir_hook_should_be_called_on_initialization.SB3COc/agent_var"\r\n    Warning: ssh channel on windows2016-64-1 received exception post command execution Errno::ETIMEDOUT - Operation timed out - recvfrom(2)\r\n    Warning: Attemped ssh.close, (caught Net::SSH::Disconnect - connection closed by remote host).\r\n    ssh connection to windows2016-64-1 has been terminated\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) executed in 318.63 seconds\r\n  Beaker::Host::CommandFailure: Host "pyjb322f9rtg4lp.delivery.puppetlabs.net" connection failure running:\r\n   cmd.exe /c puppet help --vardir="C:/cygwin64/tmp/ticket_13948_lib_dir_hook_should_be_called_on_initialization.SB3COc/agent_var"\r\n  Last 10 lines of output were:\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/host.rb:348\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/helpers/host_helpers.rb:83\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/shared/host_manager.rb:127\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/patterns.rb:37\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/helpers/host_helpers.rb:63\r\n  /Users/aileen/puppet/acceptance/tests/ticket_13948_lib_dir_hook_should_be_called_on_initialization.rb:137\r\n  /Users/aileen/puppet/acceptance/tests/ticket_13948_lib_dir_hook_should_be_called_on_initialization.rb:136\r\n  /Users/aileen/puppet/acceptance/tests/ticket_13948_lib_dir_hook_should_be_called_on_initialization.rb:136\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/structure.rb:43\r\n  /Users/aileen/puppet/acceptance/tests/ticket_13948_lib_dir_hook_should_be_called_on_initialization.rb:135\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_case.rb:133\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_case.rb:133\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/2.3.0/benchmark.rb:308\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_case.rb:130\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:325\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:322\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:322\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:371\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/cli.rb:174\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/cli.rb:100\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/bin/beaker:6\r\n  /Users/aileen/.rbenv/versions/2.3.0/bin/beaker:23\r\n  /Users/aileen/.rbenv/versions/2.3.0/bin/beaker:23\r\n  Begin teardown\r\n  End teardown\r\n  Warning: tests/ticket_13948_lib_dir_hook_should_be_called_on_initialization.rb errored in 371.72 seconds\r\n{code}\r\n\r\n\r\nThe second is tests/ticket_6857_password-disclosure-when-changing-a-users-password.rb. On initial review it appears the test is failing because the setup of a user that is tested against fails, causing a later test step to fail.\r\n{code}\r\n  Begin tests/ticket_6857_password-disclosure-when-changing-a-users-password.rb\r\n  \r\n  #6857: redact password hashes when applying in noop mode\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) 10:18:41$ cygpath -m $(mktemp -t apply_manifest.pp.XXXXXX)\r\n    C:/cygwin64/tmp/apply_manifest.pp.sWZPmc\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) executed in 0.11 seconds\r\n  localhost $ scp /var/folders/3r/k7hzxdmn0ps9bdqd623lpcmh0000gq/T/beaker20161014-60474-y0k87n windows2016-64-1:C:/cygwin64/tmp/apply_manifest.pp.sWZPmc {:ignore => }\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) 10:18:42$ cmd.exe /c puppet apply --verbose C:/cygwin64/tmp/apply_manifest.pp.sWZPmc\r\n    Notice: Compiled catalog for pyjb322f9rtg4lp.delivery.puppetlabs.net in environment production in 0.12 seconds\r\n    Info: Applying configuration version "1476465524"\r\n    Error: User update failed: (in OLE method `SetInfo": )\r\n        OLE error code:800708C5 in Active Directory\r\n          The password does not meet the password policy requirements. Check the minimum password length, password complexity and password history requirements.\r\n    \r\n        HRESULT error code:0x80020009\r\n          Exception occurred.\r\n    Wrapped exception:\r\n    (in OLE method `SetInfo": )\r\n        OLE error code:800708C5 in Active Directory\r\n          The password does not meet the password policy requirements. Check the minimum password length, password complexity and password history requirements.\r\n    \r\n        HRESULT error code:0x80020009\r\n          Exception occurred.\r\n    Error: /Stage[main]/Main/User[pl49160]/ensure: change from absent to present failed: User update failed: (in OLE method `SetInfo": )\r\n        OLE error code:800708C5 in Active Directory\r\n          The password does not meet the password policy requirements. Check the minimum password length, password complexity and password history requirements.\r\n    \r\n        HRESULT error code:0x80020009\r\n          Exception occurred.\r\n    Notice: Applied catalog in 0.10 seconds\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) executed in 10.27 seconds\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) 10:18:52$ cygpath -m $(mktemp -t apply_manifest.pp.XXXXXX)\r\n    C:/cygwin64/tmp/apply_manifest.pp.QJxNOj\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) executed in 0.11 seconds\r\n  localhost $ scp /var/folders/3r/k7hzxdmn0ps9bdqd623lpcmh0000gq/T/beaker20161014-60474-1oaqlmv windows2016-64-1:C:/cygwin64/tmp/apply_manifest.pp.QJxNOj {:ignore => }\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) 10:18:52$ cmd.exe /c puppet apply --verbose C:/cygwin64/tmp/apply_manifest.pp.QJxNOj\r\n    Notice: Compiled catalog for pyjb322f9rtg4lp.delivery.puppetlabs.net in environment production in 0.11 seconds\r\n    Info: Applying configuration version "1476465535"\r\n    Notice: /Stage[main]/Main/User[pl49160]/ensure: current_value absent, should be present (noop)\r\n    Notice: Class[Main]: Would have triggered "refresh" from 1 events\r\n    Notice: Stage[main]: Would have triggered "refresh" from 1 events\r\n    Notice: Applied catalog in 0.07 seconds\r\n  \r\n  pyjb322f9rtg4lp.delivery.puppetlabs.net (windows2016-64-1) executed in 10.69 seconds\r\n  Minitest::Assertion: Expected /current_value \[old password hash redacted\], should be \[new password hash redacted\]/ to match "windows2016-64-1: \e[mNotice: Compiled catalog for pyjb322f9rtg4lp.delivery.puppetlabs.net in environment production in 0.11 seconds\e[0m\n\e[0;32mInfo: Applying configuration version "1476465535"\e[0m\n\e[mNotice: /Stage[main]/Main/User[pl49160]/ensure: current_value absent, should be present (noop)\e[0m\n\e[mNotice: Class[Main]: Would have triggered "refresh" from 1 events\e[0m\n\e[mNotice: Stage[main]: Would have triggered "refresh" from 1 events\e[0m\n\e[mNotice: Applied catalog in 0.07 seconds\e[0m\n".\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/minitest-5.9.1/lib/minitest/assertions.rb:139\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/minitest-5.9.1/lib/minitest/assertions.rb:238\r\n  /Users/aileen/puppet/acceptance/tests/ticket_6857_password-disclosure-when-changing-a-users-password.rb:45\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/helpers/host_helpers.rb:93\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/shared/host_manager.rb:127\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/patterns.rb:37\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/helpers/host_helpers.rb:63\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/helpers/puppet_helpers.rb:481\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/shared/host_manager.rb:127\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/shared/host_manager.rb:115\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/shared/host_manager.rb:114\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/shared/host_manager.rb:114\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/patterns.rb:37\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/dsl/helpers/puppet_helpers.rb:410\r\n  /Users/aileen/puppet/acceptance/tests/ticket_6857_password-disclosure-when-changing-a-users-password.rb:44\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_case.rb:133\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_case.rb:133\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/2.3.0/benchmark.rb:308\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_case.rb:130\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:325\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:322\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:322\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/test_suite.rb:371\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/cli.rb:174\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/lib/beaker/cli.rb:100\r\n  /Users/aileen/.rbenv/versions/2.3.0/lib/ruby/gems/2.3.0/gems/beaker-3.1.0/bin/beaker:6\r\n  /Users/aileen/.rbenv/versions/2.3.0/bin/beaker:23\r\n  /Users/aileen/.rbenv/versions/2.3.0/bin/beaker:23\r\n  Begin teardown\r\n  \r\n  * Teardown: Ensure test user is removed\r\n{code}\r\n\r\nh2: In scope for Agent team\r\n* Reproduce issue\r\n* Solve the problem', 'https://tickets.puppetlabs.com/browse/PUP-6827', 'https://github.com/puppetlabs/puppet/pull/5341', '2016-10-17T13:34:52.000-0700', '2017-01-11T22:24:16.000-0800', '2017-01-11T22:24:16.000-0800', 'Closed', '', 3, '0', 1, 2, 2, 1, '7afb055d65e9baecf2ab7d54b8453d7bef647896', 'https://tickets.puppetlabs.com/browse/PUP-6827', 'https://github.com/puppetlabs/puppet/pull/5341'),
('puppet', 159651, 92235522, 5360, 'spec/unit/transaction/persistence_spec.rb includes a spec test that fails on non-US English Windows platforms', 'https://github.com/puppetlabs/puppet/commit/277c90871c6870b689f40e535c0c6d2063176a95 introduced a test at https://github.com/puppetlabs/puppet/blob/master/spec/unit/transaction/persistence_spec.rb#L151 which uses English to detect and Access Denied error.  However on localised versions of Windows this error text is different, e.g. on French Windows it is {{Accès refusé}}\r\n\r\nThe unit test should be modified to not depend on English', 'https://tickets.puppetlabs.com/browse/PUP-6871', 'https://github.com/puppetlabs/puppet/pull/5360', '2016-11-03T13:32:48.000-0700', '2017-01-11T22:25:38.000-0800', '2017-01-11T22:25:38.000-0800', 'Closed', '', 3, '0', 1, 6, 1, 1, '86df03925a4a542ddae755f64a7b231c49b45ea7', 'https://tickets.puppetlabs.com/browse/PUP-6871', 'https://github.com/puppetlabs/puppet/pull/5360'),
('puppet', 122564, 64639921, 4825, 'Remove support for --unpack-arrays option from lookup function and CLI', 'Remove the {{\--unpack-array}} option from lookup function and lookup command line.\n\nThis option did not work at all when it was first introduced. While fixed to "work" in 4.4.1, its functionality is so odd that no one really can explain what it is supposed to do. It also unexpectedly behaves differently in different data configurations.\n\nIt was therefore decided IN PUP-6050 that support for it should be removed.\n\nACCEPTANCE CRITERA\n----\n* An error is raised if the option --unpack-arrays or --unpack_arrays is given to the lookup CLI\n* An error is raised if the option "unpack_arrays" is given to the lookup function\n* The documentation does not mention "unpack arrays" in any form.', 'https://tickets.puppetlabs.com/browse/PUP-6074', 'https://github.com/puppetlabs/puppet/pull/4825', '2016-03-18T16:19:57.000-0700', '2017-01-11T23:57:16.000-0800', '2017-01-11T23:57:16.000-0800', 'Closed', '', 3, '0', 1, 4, 32, 5, '1b7ea91be1763ba9310b0735f67f46a2d52d562b', 'https://tickets.puppetlabs.com/browse/PUP-6074', 'https://github.com/puppetlabs/puppet/pull/4825'),
('puppet', 168800, 100200831, 5464, 'Intermittent Windows registry spec failure with parallel runs', 'https://jenkins-master-prod-1.delivery.puppetlabs.net/job/platform_puppet_unit-ruby-win_master/86/ failed with\r\n{code}\r\n12:57:42   1) Puppet::Util::Windows::Registry#values when reading values should return REG_DWORD values\r\n12:57:42      Failure/Error: subject.delete_key(reg, subkey_name)\r\n12:57:42      Puppet::Util::Windows::Error:\r\n12:57:42        Failed to delete registry key PuppetRegistryTest at SOFTWARE\Puppet Labs:  The system cannot find the file specified. \r\n12:57:42      # ./lib/puppet/util/windows/registry.rb:284:in `block in reg_delete_key_ex"\r\n12:57:42      # ./lib/puppet/util/windows/api_types.rb:29:in `block in from_string_to_wide_string"\r\n12:57:42      # ./lib/puppet/util/windows/api_types.rb:25:in `initialize"\r\n12:57:42      # ./lib/puppet/util/windows/api_types.rb:25:in `new"\r\n12:57:42      # ./lib/puppet/util/windows/api_types.rb:25:in `from_string_to_wide_string"\r\n12:57:42      # ./lib/puppet/util/windows/registry.rb:279:in `reg_delete_key_ex"\r\n12:57:42      # ./lib/puppet/util/windows/registry.rb:59:in `delete_key"\r\n12:57:42      # ./spec/integration/util/windows/registry_spec.rb:195:in `block (5 levels) in <top (required)>"\r\n12:57:42      # ./spec/integration/util/windows/registry_spec.rb:194:in `block (4 levels) in <top (required)>"\r\n{code}\r\n\r\nThis is likely due to poor isolation in those specs, like https://github.com/puppetlabs/puppet/blob/master/spec/integration/util/windows/registry_spec.rb#L136-L145, https://github.com/puppetlabs/puppet/blob/master/spec/integration/util/windows/registry_spec.rb#L193-L197, and https://github.com/puppetlabs/puppet/blob/master/spec/integration/util/windows/registry_spec.rb#L240-L244.\r\n\r\nThis can likely be fixed easily by using a unique subkey_name for each test.', 'https://tickets.puppetlabs.com/browse/PUP-7064', 'https://github.com/puppetlabs/puppet/pull/5464', '2017-01-04T14:11:03.000-0800', '2017-01-18T07:46:59.000-0800', '2017-01-18T07:46:59.000-0800', 'Closed', '', 1, '0', 1, 4, 4, 1, 'f1eb49127168fae2bcb5365c5b01cf98a0a2adea', 'https://tickets.puppetlabs.com/browse/PUP-7064', 'https://github.com/puppetlabs/puppet/pull/5464'),
('puppet', 158727, 96366511, 5405, 'Make commit formatting check robust', 'PUP-6849 proposes removal of the commit format check, as it is failing consistently on PRs due to commits unrelated to those PRs.\r\n\r\nUnfortunately, despite a range of attempts to make this work\r\ncorrectly/completely, including:\r\n\r\ne1efdebf\r\n4d5afd57\r\n1ed7c7ce\r\n\r\n...we still haven"t gotten it quite right. The most challenging aspect is to accurately get a list of commits that exist _only_ in the pull request and check those. Failure to do so was causing consistent CI failures for many PRs, as commits unrelated to this PR would trigger failure. This then meant lost time investigating and spurious red in hipchat rooms - more effort than the check is worth in IMO.\r\n\r\nWe need to make the check more robust so that it can correctly detect only the commits in a PR.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6850', 'https://github.com/puppetlabs/puppet/pull/5405', '2016-10-28T09:50:37.000-0700', '2017-01-18T07:46:59.000-0800', '2017-01-18T07:46:59.000-0800', 'Closed', 'maintenance', 6, '0', 2, 2, 2, 1, 'c6a75fc1419fc2ff4a4a85233ea2018bc3dab8b0', 'https://tickets.puppetlabs.com/browse/PUP-6850', 'https://github.com/puppetlabs/puppet/pull/5405'),
('puppet', 164807, 99003082, 5448, 'Reload puppetserver in puppet acceptance tests', 'We spend ~30 mins starting puppetserver across the full acceptance test suite. Now that BKR-703 is fixed, we should update our beaker dependency and use reload.', 'https://tickets.puppetlabs.com/browse/PUP-6967', 'https://github.com/puppetlabs/puppet/pull/5448', '2016-12-01T16:52:26.000-0800', '2017-01-18T07:47:01.000-0800', '2017-01-18T07:47:01.000-0800', 'Closed', 'maintenance', 6, '0', 1, 4, 8, 5, '1b8be42f6cf8c4b359843c632ba3cdb391e99084', 'https://tickets.puppetlabs.com/browse/PUP-6967', 'https://github.com/puppetlabs/puppet/pull/5448'),
('puppet', 165846, 97400346, 5418, 'Puppet acceptance test failures for Japanese Windows', 'Noted in IMAGES-390 at https://tickets.puppetlabs.com/browse/IMAGES-390?focusedCommentId=374916&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-374916 there were issues running the full acceptance suite for Puppet against the Japanese Windows 2012R2 template {{win-2012r2-ja-x86_64}}\r\n\r\nThis ticket tracks failures in the Puppet suite that do not properly accommodate non-ASCII output during tests (where https://gist.github.com/Iristyle/771b6ec052570e34f02009da531aed4a has all the test failures in detail).  The identified problems are:\r\n\r\n* BKR-1008 - user_get failure - https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/resource/user/should_modify.rb\r\n* BKR-1008 - user_get failure - https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/resource/user/should_create.rb\r\n* BKR-1011 - group_get failure - https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/resource/group/should_create.rb\r\n* This ticket - failure in test code - https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/windows/eventlog.rb\r\n* This ticket - failure in test heleprs -  https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/modules/install/with_version.rb\r\n* This ticket - failure in test heleprs - https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/modules/install/basic_install.rb\r\n* Likely a point in time failure - unrelated to UTF-8 work -  https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/parser_functions/puppet_lookup_cmd.rb#L2385-L2389\r\n\r\n\r\nTo reproduce the failures, using the following {{hosts.yaml}}:\r\n\r\n{code}\r\n---\r\nHOSTS:\r\n  centos6-64-1:\r\n    pe_dir:\r\n    pe_ver:\r\n    pe_upgrade_dir:\r\n    pe_upgrade_ver:\r\n    hypervisor: vmpooler\r\n    platform: el-6-x86_64\r\n    template: centos-6-x86_64\r\n    roles:\r\n    - agent\r\n    - master\r\n    - database\r\n    - dashboard\r\n  windows2012r2-64-1:\r\n    pe_dir:\r\n    pe_ver:\r\n    pe_upgrade_dir:\r\n    pe_upgrade_ver:\r\n    hypervisor: vmpooler\r\n    platform: windows-2012r2-64\r\n    ruby_arch: x64\r\n    template: win-2012r2-ja-x86_64\r\n    # template: win-2012r2-x86_64\r\n    roles:\r\n    - agent\r\nCONFIG:\r\n  nfs_server: none\r\n  consoleport: 443\r\n  pooling_api: http://vmpooler.delivery.puppetlabs.net/\r\n{code}\r\n\r\nAnd execute:\r\n\r\n{code}\r\nGEM_SOURCE=http://rubygems.delivery.puppetlabs.net/ bundle exec rake ci:test:aio BEAKER_HOSTS=hosts.yaml SHA="1.8.1" SERVER_VERSION="2.7.1"\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6993', 'https://github.com/puppetlabs/puppet/pull/5418', '2016-12-09T11:23:32.000-0800', '2017-01-20T07:02:22.000-0800', '2017-01-20T07:02:22.000-0800', 'Closed', 'i18n;utf-8', 2, '0', 2, 5, 3, 2, 'b304481dca29c4268b851acf97a3fe4979d840bc', 'https://tickets.puppetlabs.com/browse/PUP-6993', 'https://github.com/puppetlabs/puppet/pull/5418'),
('puppet', 165040, 96614162, 5409, 'Looking up a "false" value in hiera.yaml when using data in modules does not return a result.', 'Using the following {{hiera.yaml}} with data in modules, the resolution of a {{false}} value does not allow us to look up materials in a {{false.yaml}} file. Instead, the entry is non-existent. This requires us to use a hack to have a file that can be found with the {{false}} value returning as an empty string.\r\n\r\n{code}\r\n---\r\nversion: 4\r\ndatadir: data\r\nhierarchy:\r\n  - name: "my_fact"\r\n    backend: yaml\r\n    path: "my_fact/is_%{facts.my_fact}"\r\n{code}\r\n\r\nWe should be able to have {{my_fact/is_true.yaml}} and {{my_fact/is_false.yaml}}. However, with this bug, we have to have {{my_fact/is_.yaml}} and symlink that to {{my_facts/is_false.yaml}} for when this issue gets fixed.', 'https://tickets.puppetlabs.com/browse/PUP-6974', 'https://github.com/puppetlabs/puppet/pull/5409', '2016-12-05T07:45:27.000-0800', '2017-01-20T07:02:23.000-0800', '2017-01-20T07:02:23.000-0800', 'Closed', '', 2, '0', 1, 13, 1, 2, '2ba6b73626f890908437b8a7cb3995c6d6aa864a', 'https://tickets.puppetlabs.com/browse/PUP-6974', 'https://github.com/puppetlabs/puppet/pull/5409'),
('puppet', 168612, 100432684, 5469, 'Multiple hiera functions in one string does not work with hiera v4', 'After moving to hiera v4 and per environment hiera config files, I got this error  while running puppet:\r\n\r\n{code:java}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Function Call, undefined method `pop" for nil:NilClass at /etc/puppetlabs/code/environments/production/site.pp:37:11 on node \r\n{code}\r\n\r\npuppet server:\r\n\r\n\r\n{code:java}\r\n2017-01-04 03:48:07,181 ERROR [qtp870122728-64] [puppetserver] Puppet Evaluation Error: Error while evaluating a Function Call, undefined method `pop" for nil:NilClass at /etc/puppetlabs/code/environments/production/site.pp:37:11 on node \r\n2017-01-04 03:48:07,182 ERROR [qtp870122728-64] [puppetserver] Puppet Server Error: Evaluation Error: Error while evaluating a Function Call, undefined method `pop" for nil:NilClass at /etc/puppetlabs/code/environments/production/site.pp:37:11 on node \r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:79:in `with"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/data_providers/lookup_adapter.rb:149:in `do_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/data_providers/lookup_adapter.rb:72:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:77:in `search_and_merge"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:32:in `lookup"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:32:in `lookup"\r\norg/jruby/RubyArray.java:1613:in `each"\r\norg/jruby/RubyEnumerable.java:852:in `inject"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:30:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/lookup.rb:209:in `do_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/lookup.rb:193:in `lookup_2"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:47:in `invoke"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:36:in `dispatch"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:35:in `dispatch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `call"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call"\r\n/etc/puppetlabs/code/environments/production/site.pp:37:in `call_function"\r\norg/jruby/RubyKernel.java:1079:in `eval"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:284:in `call_function"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:282:in `call_function"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:941:in `call_function_with_block"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:910:in `eval_CallNamedFunctionExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:359:in `eval_AssignmentExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:638:in `eval_BlockExpression"\r\norg/jruby/RubyArray.java:1613:in `each"\r\norg/jruby/RubyEnumerable.java:852:in `inject"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:638:in `eval_BlockExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/etc/puppetlabs/code/environments/production/site.pp:0:in `stack"\r\norg/jruby/RubyKernel.java:1079:in `eval"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:30:in `stack"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:715:in `eval_Program"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:132:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:184:in `evaluate_code"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:81:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:73:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:639:in `evaluate_main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:174:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:174:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:241:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:162:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:266:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:264:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `benchmark"\r\n/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/1.9/benchmark.rb:295:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:262:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:53:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:121:in `do_find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:48:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:241:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:47:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:82:in `process"\r\norg/jruby/RubyArray.java:1613:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:81:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:87:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:87:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:60:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:58:in `process"\r\nfile:/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/puppetserver-lib/puppet/server/master.rb:42:in `handleRequest"\r\nPuppet$$Server$$Master_1866731659.gen:13:in `handleRequest"\r\nrequest_handler_core.clj:273:in `invoke"\r\njruby_request.clj:46:in `invoke"\r\njruby_request.clj:31:in `invoke"\r\nrequest_handler_service.clj:34:in `handle_request"\r\nrequest_handler.clj:3:in `invoke"\r\nrequest_handler.clj:3:in `invoke"\r\ncore.clj:2515:in `invoke"\r\nring_middleware.clj:284:in `invoke"\r\ncore.clj:168:in `invoke"\r\ncore.clj:211:in `invoke"\r\ncore.clj:45:in `invoke"\r\ncore.clj:343:in `invoke"\r\ncore.clj:51:in `invoke"\r\nringutils.clj:83:in `invoke"\r\nmaster_core.clj:428:in `invoke"\r\nring.clj:21:in `invoke"\r\nring.clj:12:in `invoke"\r\ncomidi.clj:249:in `invoke"\r\njetty9_core.clj:424:in `invoke"\r\nnormalized_uri_helpers.clj:80:in `invoke"\r\n{code}\r\n\r\nRemoving this line in my common.yaml \r\n\r\n{code:java}\r\nprofile::proxy::url: "http://%{hiera("profile::proxy::host")}:%{hiera("profile::proxy::port")}"\r\n{code}\r\n\r\nthe error does not appears anymore.', 'https://tickets.puppetlabs.com/browse/PUP-7061', 'https://github.com/puppetlabs/puppet/pull/5469', '2017-01-03T18:53:18.000-0800', '2017-01-20T07:02:23.000-0800', '2017-01-20T07:02:23.000-0800', 'Closed', '', 10, '0', 1, 27, 6, 4, '20c94c539c15c757e0cdc99bb30d024fe7f115cd', 'https://tickets.puppetlabs.com/browse/PUP-7061', 'https://github.com/puppetlabs/puppet/pull/5469'),
('puppet', 105544, 78939653, 5148, 'basic_install.rb and with_version.rb module tests fail in AIX', 'With the puppet-ca-bundle, the module acceptance tests should all now pass in Solaris and AIX. While they do for Solaris, two are still failing in AIX:\r\n\r\n{noformat}\r\n  Test Case ./tests/modules/install/basic_install.rb reported: #<Beaker::Host::CommandFailure: Host "pe-aix-71-acceptance" exited with 1 running:\r\n puppet module install pmtacceptance-nginx\r\nLast 10 lines of output were:\r\n	Notice: Preparing to install into /etc/puppetlabs/code/environments/production/modules ...\r\n	Notice: Downloading from https://forgeapi.puppetlabs.com ...\r\n	Error: Could not install "pmtacceptance-nginx" (latest)\r\n	  No releases are available from https://forgeapi.puppetlabs.com\r\n	    Does "pmtacceptance-nginx" have at least one published release?>\r\n  Test Case ./tests/modules/install/with_version.rb reported: #<Beaker::Host::CommandFailure: Host "pe-aix-71-acceptance" exited with 1 running:\r\n puppet module install --version "< 1.7.0" pmtacceptance-java\r\nLast 10 lines of output were:\r\n	Notice: Preparing to install into /etc/puppetlabs/code/environments/production/modules ...\r\n	Notice: Downloading from https://forgeapi.puppetlabs.com ...\r\n	Error: Could not install "pmtacceptance-java" (< 1.7.0)\r\n	  No releases matching "< 1.7.0" are available from https://forgeapi.puppetlabs.com>\r\nSkipped Tests Cases:\r\n  Test Case ./tests/modules/upgrade/that_was_installed_twice.rb skip\r\n  Test Case ./tests/modules/upgrade/with_scattered_dependencies.rb skip\r\nPending Tests Cases:\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5501', 'https://github.com/puppetlabs/puppet/pull/5148', '2015-11-12T15:06:27.000-0800', '2017-01-30T11:47:55.000-0800', '2017-01-30T11:47:55.000-0800', 'Resolved', '', 7, '0', 1, 0, 2, 2, '846ecc7f6d1a356d00a59db3b5e1222454e740cc', 'https://tickets.puppetlabs.com/browse/PUP-5501', 'https://github.com/puppetlabs/puppet/pull/5148'),
('puppet', 46744, 0, 0, 'Puppet does not respect the path setting when set in the agent section of puppet.conf', 'When I set the path setting in the [agent] section of puppet.conf it does not seem to be respected.  If I move it to the [main] section then it is respected.  \r\n\r\nI"m using the attached test module which outputs the path that the agent is using during an exec statement.  \r\n\r\nI"ve tested on both solaris 10 and centos 6.4 with the same result.  \r\n\r\nReproduction Steps using PE3.3.0:\r\n\r\n1. Classify the node with the test module\r\n2. View the contents of {{/tmp/path_test.out}}\r\n3. {{rm /tmp/path_test.out}} (to make sure you know when it"s been written again)\r\n4. Edit puppet.conf on your agent \r\n  - Set path to {{/usr/bin:/usr/sbin:/tmp}} in the [agent] section\r\n\r\n5. {{service pe-puppet restart}} to cause the change to be taken and cause a daemonized run to start\r\n6. View the contents of {{/tmp/path_test.out}}\r\n  - The contents should be the same as in test 2 because the setting isn"t respected. \r\n\r\n7. {{rm /tmp/path_test.out}} again\r\n8.  Edit puppet.conf on your agent \r\n  - Set path to {{/usr/bin:/usr/sbin:/tmp}} in the [main] section this time\r\n\r\n9. {{service pe-puppet restart}} to cause the change to be taken and cause a daemonized run to start\r\n10. View the contents of {{/tmp/path_test.out}}\r\n  - The contents should now be {{/usr/bin:/usr/sbin:/tmp:/sbin}} \r\n\r\nAnother interesting thing to note is that I get this warning upon restart of pe-puppet when path is set in the [main] section but not when it"s in the [agent] section which also makes me thing the path is ignored when it"s in the [agent] section. \r\n\r\n{noformat}\r\nStarting puppet: /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/defaults.rb:182: warning: Insecure world writable dir /tmp in PATH, mode 041777\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3023', '', '2014-08-06T14:04:49.000-0700', '2017-01-30T17:58:33.000-0800', '2017-01-30T17:58:33.000-0800', 'Closed', 'customer;support', 3, '0', 0, 0, 0, 0, 'cbeaef368c2d8e8fcbd2feb02c862d064243b955', 'https://tickets.puppetlabs.com/browse/PUP-3023', 'https://github.com/puppetlabs/puppet/commit/cbeaef368c2d8e8fcbd2feb02c862d064243b955'),
('puppet', 134253, 73834213, 5019, 'systemd provider does not honor documented enabled states', 'The systemd provider considers too many states as "disabled" and should probably just simply track the return value of "is-enabled" instead of capturing stdout and comparing it to a static list of knows states.  This has the added benefit of us not having to externally track new states added to systemd over time.\r\n\r\nThis issue was found in puppet-nova"s CI where we found that the virtlockd and virtlogd services attempt to be enabled on every run; their "is-enabled" state is "indirect".\r\n\r\nhttps://www.freedesktop.org/software/systemd/man/systemctl.html\r\nhttp://logs.openstack.org/30/308530/24/experimental/gate-puppet-openstack-integration-4-scenario001-tempest-ubuntu-xenial/e209217/console.html#_2016-05-26_22_48_06_290', 'https://tickets.puppetlabs.com/browse/PUP-6370', 'https://github.com/puppetlabs/puppet/pull/5019', '2016-05-27T13:32:04.000-0700', '2017-02-01T20:04:12.000-0800', '2017-02-01T20:04:12.000-0800', 'Closed', '', 2, '0', 1, 5, 3, 2, 'c759d6e9f478f28f21949d50dd9c1226c4c81525', 'https://tickets.puppetlabs.com/browse/PUP-6370', 'https://github.com/puppetlabs/puppet/pull/5019'),
('puppet', 165806, 99942495, 5455, 'Fix inconsistent autoload of environment functions and pcore types.', 'When a *ruby* function is declared in a _func_name.rb_ file under the directory _<env_root>/lib/puppet/functions_, the auto-loader makes it accessible using the global name "func_name". Declaring a *puppet* function in _func_name.pp_ under _<env_root>/functions_ does, however, not work. The function is not found unless the name of the function is prefixed with "environment::". In contrast, if the *ruby* function is prefixed the same way, the function is no longer found unless it is also moved to _<env_root>/lib/puppet/functions/environment_.\r\n\r\nFor the sake of consistency, functions using global names should reside under:\r\n_<env_root>/lib/puppet/functions_ # ruby\r\n_<env_root>/functions_ # puppet\r\n\r\nand functions prefixed with "environment::" should reside under:\r\n_<env_root>/lib/puppet/functions/environment_ # ruby\r\n_<env_root>/functions/environment_ # puppet\r\n\r\nThe same scheme should be used for auto-loading pcore types that are declared in the environment (but beneath the _types_ directory instead of _functions_).', 'https://tickets.puppetlabs.com/browse/PUP-6992', 'https://github.com/puppetlabs/puppet/pull/5455', '2016-12-09T03:12:38.000-0800', '2017-02-02T06:19:45.000-0800', '2017-02-02T06:19:45.000-0800', 'Closed', '', 11, '0', 1, 211, 16, 7, 'dcad982d52a3ea265754e466f984ae228e3fef91', 'https://tickets.puppetlabs.com/browse/PUP-6992', 'https://github.com/puppetlabs/puppet/pull/5455'),
('puppet', 166099, 97765891, 5425, 'Lookup recursion guard should use different namespace for scope and normal lookups', 'A lookup of a key that results in a value that contains an interpolation expression with the same key (this time referring to the global scope) should not result in a recursion error. The lookup namespace is different from the global scope namespace.', 'https://tickets.puppetlabs.com/browse/PUP-7003', 'https://github.com/puppetlabs/puppet/pull/5425', '2016-12-13T06:34:32.000-0800', '2017-02-02T06:19:45.000-0800', '2017-02-02T06:19:45.000-0800', 'Closed', '', 1, '0', 1, 18, 10, 3, '04da63af006816d54aa66baee235109ff5e70ca1', 'https://tickets.puppetlabs.com/browse/PUP-7003', 'https://github.com/puppetlabs/puppet/pull/5425'),
('puppet', 166982, 124025303, 5947, 'dnf provider does not support Fedora 25', 'The dnf provider uses a static list of release numbers and must be updated for each Fedora release.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7029', 'https://github.com/puppetlabs/puppet/pull/5947', '2016-12-16T13:43:44.000-0800', '2017-02-02T06:19:46.000-0800', '2017-02-02T06:19:46.000-0800', 'Closed', '', 4, '0', 1, 2, 2, 1, 'df5441e22154ebb603e5f5f9ac14b528e15b47e3', 'https://tickets.puppetlabs.com/browse/PUP-7029', 'https://github.com/puppetlabs/puppet/pull/5947'),
('puppet', 164673, 96147173, 5402, 'Puppet doesn"t detect systemd as default service provider on CoreOS', 'CoreOS is correctly identified by facter (https://github.com/puppetlabs/facter/blob/11288d2a33caec577fe696bd02e4bed12e5ac12d/lib/inc/internal/facts/linux/os_coreos.hpp) but when trying to manage services Puppet detects both init.d and systemd and defaults to init.d. In reality CoreOS uses systemd for all service management.\r\n\r\nExpected behaviour: The service provider should use systemd as the default provider for CoreOS', 'https://tickets.puppetlabs.com/browse/PUP-6963', 'https://github.com/puppetlabs/puppet/pull/5402', '2016-12-01T10:44:21.000-0800', '2017-02-02T06:19:47.000-0800', '2017-02-02T06:19:47.000-0800', 'Closed', 'maintenance', 7, '0', 1, 2, 1, 2, '17b79d6bddd15dbe857cfbc8c9f9c2ab450e2110', 'https://tickets.puppetlabs.com/browse/PUP-6963', 'https://github.com/puppetlabs/puppet/pull/5402'),
('puppet', 167104, 97406771, 5419, 'Unicode characters in "comment" don"t round-trip on Windows', 'Given `puppet apply` this manifest:\r\n{code}\r\n  user { "foo" :\r\n    comment => "\u2603",\r\n    ensure => present,\r\n  }\r\n{code}\r\n\r\nThe following change happens on every puppet run:\r\n{code}\r\nNotice: /Stage[main]/Main/User[foo]/comment: comment changed "?" to "☃"\r\n{code}\r\n\r\nDifferent unicode characters have the same result:\r\n{code}\r\n...\r\ncomment => "\u{2070E}"\r\n...\r\n{code}\r\n\r\nresults in:\r\n{code}\r\nNotice: /Stage[main]/Main/User[foo]/comment: comment changed "??" to "𠜎"\r\n{code}\r\n\r\nA quick investigation makes it appear we"re failing to correctly round-trip the unicode to/from Windows in https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/adsi.rb#L197-L206:\r\n\r\n{code}\r\nFrom: C:/Users/moses/development/puppet/lib/puppet/util/windows/adsi.rb @ line 207 Puppet::Util::Windows::ADSI::User#[]=:\r\n\r\n    205: def []=(attribute, value)\r\n    206:   require "pry";binding.pry\r\n => 207:   native_user.Put(attribute, value)\r\n    208: end\r\n\r\n[18] pry(#<Puppet::Util::Windows::ADSI::User>)> attribute\r\n=> "Description"\r\n[19] pry(#<Puppet::Util::Windows::ADSI::User>)> value\r\n=> "\u{2070E}"\r\n[20] pry(#<Puppet::Util::Windows::ADSI::User>)> value.bytes\r\n=> [240, 160, 156, 142]\r\n[21] pry(#<Puppet::Util::Windows::ADSI::User>)> native_user.Put(attribute, value)\r\n=> nil\r\n[22] pry(#<Puppet::Util::Windows::ADSI::User>)> is = native_user.Get(attribute)\r\n=> "??"\r\n[23] pry(#<Puppet::Util::Windows::ADSI::User>)> is.bytes\r\n=> [63, 63]\r\n[24] pry(#<Puppet::Util::Windows::ADSI::User>)> Encoding.default_external\r\n=> #<Encoding:IBM437>\r\n[25] pry(#<Puppet::Util::Windows::ADSI::User>)> value.encoding\r\n=> #<Encoding:UTF-8>\r\n[26] pry(#<Puppet::Util::Windows::ADSI::User>)> is.encoding\r\n=> #<Encoding:IBM437>\r\n{code}\r\n\r\nNote that the bytes read back via `Get` are not the same as the value we `Put`', 'https://tickets.puppetlabs.com/browse/PUP-7031', 'https://github.com/puppetlabs/puppet/pull/5419', '2016-12-18T14:39:20.000-0800', '2017-02-02T06:19:47.000-0800', '2017-02-02T06:19:47.000-0800', 'Closed', '', 8, '0', 2, 304, 23, 7, '276af8db8b5a0eda60e11ea455a4185f169ebc89', 'https://tickets.puppetlabs.com/browse/PUP-7031', 'https://github.com/puppetlabs/puppet/pull/5419'),
('puppet', 167102, 98547784, 5446, 'Parser - Illegal Unicode warning and extra escape on legal string?', 'In working on support for unicode characters in the value of the "comment" property, I noticed this warning in the output:\r\n{code}\r\n...\r\nWarning: Unicode escape "\u" was not followed by 4 hex digits or 1-6 hex digits in {} or was > 10ffff at /Users/moses/foo/unicode_comment.pp:3:38\r\n...\r\n{code}\r\n\r\nThe manifest in question is:\r\n{code}\r\nuser { "foo" :\r\n  ensure => present,\r\n  comment => "A\u06FF\u16A0\u{2070E}",\r\n}\r\n{code}\r\n\r\nI.e., the value of the comment field is made up of these characters:\r\n"A" : http://www.fileformat.info/info/unicode/char/0041/index.htm\r\n"\u06FF" : http://www.fileformat.info/info/unicode/char/06FF/index.htm\r\n"\u16A0": http://www.fileformat.info/info/unicode/char/16a0/index.htm\r\n"\u{2070E}" : http://www.fileformat.info/info/unicode/char/2070e/index.htm\r\n\r\nI believe this string is legal unicode - is it misrepresented in the manifest in some way?\r\n\r\nGiven a user with name "foo" and comment "bar", if I apply this manifest, (in addition to the warning above) this is the change notice:\r\n{code}\r\nNotice: /Stage[main]/Main/User[foo]/comment: comment changed "bar" to "Aۿ\u16A0𠜎"\r\n{code}\r\n\r\nIt appears that "\u16A0" has been escaped and subsequently treated literally?\r\nThe error is being raised here: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/parser/slurp_support.rb#L94-L95', 'https://tickets.puppetlabs.com/browse/PUP-7030', 'https://github.com/puppetlabs/puppet/pull/5446', '2016-12-18T14:17:23.000-0800', '2017-02-02T06:19:47.000-0800', '2017-02-02T06:19:47.000-0800', 'Closed', '', 5, '0', 1, 13, 4, 2, '43aebbdadc35446fe27a5f410041b99c6844015c', 'https://tickets.puppetlabs.com/browse/PUP-7030', 'https://github.com/puppetlabs/puppet/pull/5446'),
('puppet', 165599, 97415416, 5420, 'Acceptance testing using TYPE=git and preserved hosts is broken', 'I tried to use the acceptance tests with TYPE=git today and ran into several problems.\r\n* All tests using the latest master fails on missing _semantic_puppet_. This is because it is missing from the _config/git/options.rb_ and also from the _install.rb_.\r\n* Adding _semantic_puppet_ to _install.rb_ doesn"t work because it lacks an _install.rb_ of its own.\r\n* The Rake command {{ci:list_preserved}} is broken. It looks for files directly under the _log_ directory. The files however, resides one level down, under _log_/<config>.\r\n* Once I got {{ci:list_preserved working}}, I found that the {{ci:test_against_preserved_hosts}} is also broken. It does not propagate preserved hosts correctly (a variable named {{config}} is assumed to be present at line 123, but it isn"t and instead a method is called that picks a host seemingly at random). I used the temporary fix of setting {{config = final_options\[:hosts_file\]}} to get around this but then it breaks with other commands.\r\n \r\nWithout this functionality working, it"s very hard to assert that changes made to the code will not break once the reach the CI-pipeline.', 'https://tickets.puppetlabs.com/browse/PUP-6989', 'https://github.com/puppetlabs/puppet/pull/5420', '2016-12-08T08:00:30.000-0800', '2017-02-02T06:19:49.000-0800', '2017-02-02T06:19:49.000-0800', 'Closed', 'maintenance', 6, '0', 7, 46, 14, 10, 'e41107ed9ac967c2a34085e872846e1020b8f135', 'https://tickets.puppetlabs.com/browse/PUP-6989', 'https://github.com/puppetlabs/puppet/pull/5420'),
('puppet', 166314, 98041100, 5436, 'Type error in function parameter is reported on wrong parameter', 'While writing a new puppet language function I ran into a wrong type error.\r\n\r\nThe error\r\n\r\n{noformat}\r\n Error while evaluating a Function Call, "saltnetwork::iptables::is_builtin_chain" parameter "table" expects a match for SaltNetwork::IPTables::Table = Enum["filter", "mangle", "nat", "raw", "security"], got "filter"\r\n{noformat}\r\n\r\noccurred when calling\r\n\r\n{code:puppet}\r\nsaltnetwork::iptables::is_builtin_chain("filter", "INPUT")\r\n{code}\r\n\r\nwith the function in this form (parameter type of the second parameter is wrong and does not match INPUT, see type aliases below). I would expect an error about the second parameter, not the perfectly fine first one.\r\n\r\n{code:puppet}\r\nfunction saltnetwork::iptables::is_builtin_chain(\r\n    SaltNetwork::IPTables::Table $table\r\n  , SaltNetwork::IPTables::Custom_Chain_Name $chain\r\n  ) {\r\n\r\n  $chain in saltnetwork::iptables::builtin_chains_for_table($table)\r\n}\r\n{code}\r\n\r\nwith the type aliases\r\n\r\n{code:puppet}\r\ntype SaltNetwork::IPTables::Table = Enum["filter","nat","mangle","raw","security"]\r\n{code}\r\n\r\n{code:puppet}\r\ntype SaltNetwork::IPTables::Custom_Chain_Name = Pattern[/^(?!(PREROUTING|INPUT|FORWARD|OUTPUT|POSTROUTING))[a-zA-Z][a-zA-Z0-9-]{0,31}$/]\r\n{code}\r\n\r\nand the function used in the body\r\n\r\n{code:puppet}\r\nfunction saltnetwork::iptables::builtin_chains_for_table(\r\n    SaltNetwork::IPTables::Table $table\r\n  ) {\r\n  case($table) {\r\n  "filter": {\r\n    ["INPUT","FORWARD","OUTPUT"]\r\n  }\r\n  "nat": {\r\n    ["PREROUTING","INPUT","OUTPUT","POSTROUTING"]\r\n  }\r\n  "mangle": {\r\n    ["PREROUTING","INPUT","FORWARD","OUTPUT","POSTROUTING"]\r\n  }\r\n  "raw": {\r\n    ["PREROUTING","OUTPUT"]\r\n  }\r\n  "security": {\r\n    ["INPUT","FORWARD","OUTPUT"]\r\n  }\r\n  default: {\r\n    fail("Unknown table ${table}, you need to adjust SaltNetwork::IPTables::Table and this function")\r\n  }\r\n  }\r\n}\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7012', 'https://github.com/puppetlabs/puppet/pull/5436', '2016-12-14T04:27:47.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 2, '0', 1, 15, 2, 2, '71c46dfc78dd9ad7a166b3e2f110e617be0a6aa3', 'https://tickets.puppetlabs.com/browse/PUP-7012', 'https://github.com/puppetlabs/puppet/pull/5436'),
('puppet', 170101, 101436466, 5503, 'Hiera lookup_key functions crash when using a location', 'A typo in the {{LookupKeyFunctionProvider}} makes it impossible to write a lookup_key function that uses a path.', 'https://tickets.puppetlabs.com/browse/PUP-7099', 'https://github.com/puppetlabs/puppet/pull/5503', '2017-01-13T03:31:29.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 1, '0', 3, 44, 6, 3, 'cbe9f6a2cf1436184d477645ae5b4a3d5b575c0c', 'https://tickets.puppetlabs.com/browse/PUP-7099', 'https://github.com/puppetlabs/puppet/pull/5503'),
('puppet', 169602, 101234847, 5496, 'deep merge options in hiera v3 config not honored', 'it appears deep_merge_options are being picked up in the config file, but somehow not understood or honored:\r\n{code}\r\n[root@tcqscrr9nhig5nu v3_config_and_data_jmfzk9h3]# pwd\r\n/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3\r\n[root@tcqscrr9nhig5nu v3_config_and_data_jmfzk9h3]# cat hieradata/somesuch.*\r\n{\r\n  "environment_key4" : ["jsonval", "4"]\r\n}\r\n---\r\nenvironment_key4:\r\n  - val\r\n  - 4\r\n[root@tcqscrr9nhig5nu v3_config_and_data_jmfzk9h3]# cat /etc/puppetlabs/puppet/hiera.yaml\r\n---\r\n:backends:\r\n  - "yaml"\r\n  - "json"\r\n:hierarchy:\r\n  - "somesuch"\r\n  - "common"\r\n:merge_behavior: deeper\r\n:deep_merge_options:\r\n  :overwrite_arrays: true\r\n[root@tcqscrr9nhig5nu v3_config_and_data_jmfzk9h3]# puppet lookup --environment v3_config_and_data_jmfzk9h3 environment_key4 --explain\r\nWarning: /etc/puppetlabs/puppet/hiera.yaml: Use of "hiera.yaml" version 3 is deprecated. It should be converted to version 5\r\n   (in /etc/puppetlabs/puppet/hiera.yaml)\r\nWarning: /etc/puppetlabs/puppet/hiera.yaml: merge_option "overwrite_arrays" is not recognized. Option is ignored\r\nSearching for "lookup_options"\r\n  Global Data Provider (hiera configuration version 3)\r\n    Using configuration "/etc/puppetlabs/puppet/hiera.yaml"\r\n    Merge strategy hash\r\n      Hierarchy entry "yaml"\r\n        Merge strategy hash\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/somesuch.yaml"\r\n            Original path: "somesuch"\r\n            No such key: "lookup_options"\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/common.yaml"\r\n            Original path: "common"\r\n            Path not found\r\n      Hierarchy entry "json"\r\n        Merge strategy hash\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/somesuch.json"\r\n            Original path: "somesuch"\r\n            No such key: "lookup_options"\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/common.json"\r\n            Original path: "common"\r\n            Path not found\r\nSearching for "environment_key4"\r\n  Global Data Provider (hiera configuration version 3)\r\n    Using configuration "/etc/puppetlabs/puppet/hiera.yaml"\r\n    Merge strategy deep\r\n      Hierarchy entry "yaml"\r\n        Merge strategy deep\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/somesuch.yaml"\r\n            Original path: "somesuch"\r\n            Found key: "environment_key4" value: [\r\n              "val",\r\n              4\r\n            ]\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/common.yaml"\r\n            Original path: "common"\r\n            Path not found\r\n          Merged result: [\r\n            "val",\r\n            4\r\n          ]\r\n      Hierarchy entry "json"\r\n        Merge strategy deep\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/somesuch.json"\r\n            Original path: "somesuch"\r\n            Found key: "environment_key4" value: [\r\n              "jsonval",\r\n              "4"\r\n            ]\r\n          Path "/etc/puppetlabs/code/environments/v3_config_and_data_jmfzk9h3/hieradata/common.json"\r\n            Original path: "common"\r\n            Path not found\r\n          Merged result: [\r\n            "jsonval",\r\n            "4"\r\n          ]\r\n      Merged result: [\r\n        "jsonval",\r\n        "4",\r\n        "val",\r\n        4\r\n      ]\r\n[root@tcqscrr9nhig5nu v3_config_and_data_jmfzk9h3]# puppet lookup --environment v3_config_and_data_jmfzk9h3 environment_key4\r\nWarning: /etc/puppetlabs/puppet/hiera.yaml: Use of "hiera.yaml" version 3 is deprecated. It should be converted to version 5\r\n   (in /etc/puppetlabs/puppet/hiera.yaml)\r\nWarning: /etc/puppetlabs/puppet/hiera.yaml: merge_option "overwrite_arrays" is not recognized. Option is ignored\r\n---\r\n- jsonval\r\n- "4"\r\n- val\r\n- 4\r\n{code}\r\n\r\nalso when using --explain the value doesn"t pop out in the same format.  maybe this is ok.\r\ni also find it somewhat strange that the value is presented in yaml, in particular because i"m not only using a yaml backend here.\r\ni kinda expect it in puppet pp format', 'https://tickets.puppetlabs.com/browse/PUP-7088', 'https://github.com/puppetlabs/puppet/pull/5496', '2017-01-10T16:44:29.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 16, '0', 1, 61, 12, 3, 'b44cf92f5d7391488741d27a4e45985428b2c354', 'https://tickets.puppetlabs.com/browse/PUP-7088', 'https://github.com/puppetlabs/puppet/pull/5496'),
('puppet', 166102, 97969756, 5434, 'Remove the "verbatim" option (added in PUP-6781)', 'After additional discussion the "verbatim" feature did not turn out to be so great as it just introduces complexity and it we may block having a different interpolation format in the future. For that reason, we will remove the "verbatim" feature. \r\n\r\nThus, the {{data_hash}} function always interpolates the values at the point in time when the value is produced. The other functions does not provide automatic interpolation but can opt in to interpolation the hiera way via the context object given to them. It is therefore up to the implementors of data providing functions to decide how they work.\r\n\r\nIn this ticket, the added "verbatim" option should be removed. (The PUP-6781 cannot simply be reverted as it does not contain all of the implementation, but what it does contain may be).', 'https://tickets.puppetlabs.com/browse/PUP-7004', 'https://github.com/puppetlabs/puppet/pull/5434', '2016-12-13T06:42:10.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 3, '0', 1, 1, 22, 2, '9572b5688d92c1f0a544ceba34fd50c8578fc52a', 'https://tickets.puppetlabs.com/browse/PUP-7004', 'https://github.com/puppetlabs/puppet/pull/5434'),
('puppet', 168854, 100309848, 5466, 'hiera: YAML.load_file("/dev/null") returns `false`, instead of a hash', '331778e from  PUP-6980 caused hiera to call YAML.load_file("/dev/null") in some situations, which returns `false`, instead of a hash, leading to failures. This e.g. breaks rspec-puppet"s setup shenanigans: https://github.com/rodjek/rspec-puppet/issues/434\r\n\r\nThat link also has a stack-trace and travis log showing the problem.', 'https://tickets.puppetlabs.com/browse/PUP-7067', 'https://github.com/puppetlabs/puppet/pull/5466', '2017-01-05T02:38:52.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 2, '0', 2, 76, 21, 2, '51c39758906629b3cc22519d72f3386dc9babde0', 'https://tickets.puppetlabs.com/browse/PUP-7067', 'https://github.com/puppetlabs/puppet/pull/5466'),
('puppet', 170203, 101580500, 5507, 'Serialization of Sensitive with rich data is incorrect', 'The current implementation of {{Sensitive}} serialization is broken. It assumes that the same packer can be used for both normal data and extension data. As a consequence, it attempts to write rich data directly into the extension buffer. While fine for JSON, this approach doesn"t work at all for MessagePack.\r\n\r\nThe fix for this was originally included in a PR for PUP-5908. That ticket is however stalled and since the fix changes the actual format, it"s important that it gets included in the next release.', 'https://tickets.puppetlabs.com/browse/PUP-7104', 'https://github.com/puppetlabs/puppet/pull/5507', '2017-01-14T16:01:14.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 5, '0', 4, 71, 56, 12, '931819a2be54133328cb43dadfc13a4e09714418', 'https://tickets.puppetlabs.com/browse/PUP-7104', 'https://github.com/puppetlabs/puppet/pull/5507'),
('puppet', 171650, 102954168, 5534, 'hiera.yaml version 5 format must reserve the built in options', 'The built in options "path" and "uri" are reserved, users should not be able to set them as an option since they are set by the hiera 5 feature if paths/globs or uri/uris are used in the level configuration.\r\n\r\nIf user sets path or uri as an option in the options hash an error should be raised.', 'https://tickets.puppetlabs.com/browse/PUP-7128', 'https://github.com/puppetlabs/puppet/pull/5534', '2017-01-24T07:23:56.000-0800', '2017-02-02T06:19:50.000-0800', '2017-02-02T06:19:50.000-0800', 'Closed', '', 0, '0', 1, 53, 0, 2, '4da14834f0208697d5aac521adc29ec123a7b238', 'https://tickets.puppetlabs.com/browse/PUP-7128', 'https://github.com/puppetlabs/puppet/pull/5534'),
('puppet', 161910, 94471813, 5391, 'Puppet tests fail with "environment env2 enviroment_key lookup failed"', 'All cells in the puppet acceptance tests (from the puppet agent pipeline) are failing with:\r\n\r\n{code}\r\n11:57:37   jr2mzdotr1mti5b.delivery.puppetlabs.net (redhat7-64-1) executed in 1.50 seconds\r\n11:57:37   Beaker::DSL::Outcomes::FailTest: \r\n11:57:37   environment env2 enviroment_key lookup failed, expected /FunctionEnvDataProvider.* *.*env-env2-ruby-function/.\r\n11:57:37   Expected /FunctionEnvDataProvider.*\s*.*env-env2-ruby-function/ to match "Searching for \"lookup_options\"\n  Data Binding \"hiera\"\n    No such key: \"lookup_options\"\n  Environment Data Provider (lookup version 5)\n    deprecated API function \"environment::data\"\n      No such key: \"lookup_options\"\nSearching for \"environment_key\"\n  Data Binding \"hiera\"\n    No such key: \"environment_key\"\n  Environment Data Provider (lookup version 5)\n    deprecated API function \"environment::data\"\n      Found key: \"environment_key\" value: \"env-env2-ruby-function data() provided value\"\n".\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/dsl/outcomes.rb:44\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/dsl/helpers/puppet_helpers.rb:184\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/dsl/helpers/puppet_helpers.rb:224\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/tests/parser_functions/puppet_lookup_cmd.rb:2159\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_case.rb:133\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_case.rb:133\r\n11:57:37   /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_case.rb:130\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_suite.rb:325\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_suite.rb:322\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_suite.rb:322\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/test_suite.rb:371\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/cli.rb:174\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/lib/beaker/cli.rb:100\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/gems/beaker-3.1.0/bin/beaker:6\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n11:57:37   /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/SLAVE_LABEL/beaker/TEST_TARGET/redhat5-64a/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n11:57:37   Begin teardown\r\n11:57:37   End teardown\r\n11:57:37   tests/parser_functions/puppet_lookup_cmd.rb failed in 100.23 seconds\r\n{code}\r\n\r\nLink to full failing output: https://jenkins.puppetlabs.com/view/puppet-agent/view/master/view/puppet-agent/job/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master/lastCompletedBuild/SLAVE_LABEL=beaker,TEST_TARGET=redhat5-64a/consoleFull\r\n\r\nNote that the puppet acceptance tests..\r\n(https://jenkins.puppetlabs.com/view/puppet-agent/view/master/view/puppet-agent/job/platform_puppet-agent_intn-van-sys_suite-daily-puppet-master)\r\n\r\n..have not had a passing run since November 10th so perhaps we should get a green run before further merges?', 'https://tickets.puppetlabs.com/browse/PUP-6933', 'https://github.com/puppetlabs/puppet/pull/5391', '2016-11-18T13:47:45.000-0800', '2017-02-02T06:19:51.000-0800', '2017-02-02T06:19:51.000-0800', 'Closed', '', 5, '0', 1, 10, 10, 1, 'fb83094b010b43fa591677d86c491d702df6b772', 'https://tickets.puppetlabs.com/browse/PUP-6933', 'https://github.com/puppetlabs/puppet/pull/5391'),
('puppet', 157639, 92790607, 5368, 'lookup explain shows found data incorrectly', '{code}\r\n# data/nodes/dev3.devco.net.yaml\r\nusers::local:\r\n  rip:\r\n    email: "arri.pienaar@example.net"\r\n{code}\r\n\r\n{code}\r\n# data/common.yaml\r\nusers::local:\r\n  rip:\r\n    email: "rip@devco.net"\r\n    comment: "R.I.Pienaar"\r\n    sudoer: true\r\n    shell: "/bin/zsh"\r\n{code}\r\n\r\nWhen I run explain with a hash merge above I see the following:\r\n\r\n{code}\r\n$ puppet lookup --environmentpath `pwd` users::local --merge deep --explain\r\nMerge strategy deep\r\n  Options: {\r\n    "sort_merge_arrays" => false,\r\n    "merge_hash_arrays" => false\r\n  }\r\n  Data Binding "hiera"\r\n    No such key: "users::local"\r\n  Data Provider "Hiera Data Provider, version 4"\r\n    ConfigurationPath "/home/rip/temp/preso/environments/production/hiera.yaml"\r\n    Merge strategy deep\r\n      Options: {\r\n        "sort_merge_arrays" => false,\r\n        "merge_hash_arrays" => false\r\n      }\r\n      Interpolation on "nodes/%{trusted.certname}"\r\n        Global Scope\r\n          Found key: "trusted" value: {\r\n            "authenticated" => "local",\r\n            "certname" => "dev3.devco.net",\r\n            "extensions" => {},\r\n            "hostname" => "dev3",\r\n            "domain" => "devco.net"\r\n          }\r\n        Sub key: "certname"\r\n          Found key: "certname" value: "dev3.devco.net"\r\n      Data Provider "Nodes"\r\n        Path "/home/rip/temp/preso/environments/production/data/nodes/dev3.devco.net.yaml"\r\n          Original path: "nodes/%{trusted.certname}"\r\n          Found key: "users::local" value: {\r\n            "rip" => {\r\n              "email" => "arri.pienaar@example.net"\r\n            }\r\n          }\r\n      Data Provider "common"\r\n        Path "/home/rip/temp/preso/environments/production/data/common.yaml"\r\n          Original path: "common"\r\n          Found key: "users::local" value: {\r\n            "rip" => {\r\n              "email" => "arri.pienaar@example.net",\r\n              "comment" => "R.I.Pienaar",\r\n              "sudoer" => true,\r\n              "shell" => "/bin/zsh"\r\n            }\r\n          }\r\n      Merged result: {\r\n        "rip" => {\r\n          "email" => "arri.pienaar@example.net",\r\n          "comment" => "R.I.Pienaar",\r\n          "sudoer" => true,\r\n          "shell" => "/bin/zsh"\r\n        }\r\n      }\r\n  Module "users"\r\n    Module not found\r\n  Merged result: {\r\n    "rip" => {\r\n      "email" => "arri.pienaar@example.net",\r\n      "comment" => "R.I.Pienaar",\r\n      "sudoer" => true,\r\n      "shell" => "/bin/zsh"\r\n    }\r\n  }\r\n{code}\r\n\r\nThe end result is correct, but note the following:\r\n\r\n{code}\r\n      Data Provider "common"\r\n        Path "/home/rip/temp/preso/environments/production/data/common.yaml"\r\n          Original path: "common"\r\n          Found key: "users::local" value: {\r\n            "rip" => {\r\n              "email" => "arri.pienaar@example.net",\r\n              "comment" => "R.I.Pienaar",\r\n              "sudoer" => true,\r\n              "shell" => "/bin/zsh"\r\n            }\r\n          }\r\n      Merged result: {\r\n        "rip" => {\r\n          "email" => "arri.pienaar@example.net",\r\n          "comment" => "R.I.Pienaar",\r\n          "sudoer" => true,\r\n          "shell" => "/bin/zsh"\r\n        }\r\n      }\r\n{code}\r\n\r\nI would expect the _Found key: "users::local" value_ to show email _rip@devco.net_ and the Merged Result to show _arri.pienaar@example.net_\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6834', 'https://github.com/puppetlabs/puppet/pull/5368', '2016-10-19T15:25:27.000-0700', '2017-02-02T06:20:50.000-0800', '2017-02-02T06:20:50.000-0800', 'Closed', '', 2, '0', 1, 34, 6, 3, '4805238af5cabdf6c3326d5085054dd71e77a32c', 'https://tickets.puppetlabs.com/browse/PUP-6834', 'https://github.com/puppetlabs/puppet/pull/5368'),
('puppet', 155259, 0, 0, 'pkg provider should be default for Solaris 12', 'pkg provider should also be default for Solaris 12', 'https://tickets.puppetlabs.com/browse/PUP-6793', '', '2016-10-05T12:10:38.000-0700', '2017-02-02T06:20:50.000-0800', '2017-02-02T06:20:50.000-0800', 'Closed', 'maintenance', 4, '0', 0, 0, 0, 0, 'e3651df15cced8e0ce87ed1f3da30f1df4cd8c2f', 'https://tickets.puppetlabs.com/browse/PUP-6793', 'https://github.com/puppetlabs/puppet/commit/e3651df15cced8e0ce87ed1f3da30f1df4cd8c2f'),
('puppet', 157011, 94174333, 5386, 'binary_file() file not found: error message unclear', '{code}\r\n[root@veba8457upz4cbq ~]# puppet apply -e "$urlsafe = Binary(binary_file("motd/README.md")) notify{ "$urlsafe": }"\r\nError: Evaluation Error: Error while evaluating a Function Call, binary_file(): The given file "" does not exist  at line 1:19 on node veba8457upz4cbq.delivery.puppetlabs.net\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6821', 'https://github.com/puppetlabs/puppet/pull/5386', '2016-10-14T16:31:36.000-0700', '2017-02-02T06:20:53.000-0800', '2017-02-02T06:20:53.000-0800', 'Closed', 'maintenance', 4, '0', 1, 5, 11, 2, '37b03f6baecbbd205b9909fffcb6dfecfbcc08b5', 'https://tickets.puppetlabs.com/browse/PUP-6821', 'https://github.com/puppetlabs/puppet/pull/5386'),
('puppet', 114464, 0, 0, 'Whits don"t copy tags from the containers they replace', 'When the agent converts containers (classes, defined types, etc) into Whits, tags that were present on the containers are not copied over to the Whits. This causes events generated by contained resources to be excluded by tag filters even though the container had the appropriate tags.\r\n\r\nh2. Reproduction Case\r\n\r\n*  Install Puppet 4.3.2\r\n*  Create the following test manifest which passes a resource event to a refreshonly exec via a class:\r\n\r\n{code:puppet}\r\nclass foo {\r\n  tag "emitter"\r\n\r\n  notify{"generating event in foo":}\r\n}\r\n\r\nclass receiver {\r\n  exec{"receiver exec":\r\n    command     => "/bin/echo received event",\r\n    logoutput   => true,\r\n    refreshonly => true,\r\n    subscribe   => Class["foo"]\r\n  }\r\n}\r\n\r\ninclude foo\r\ninclude receiver\r\n{code}\r\n\r\n*  Apply the manifest with {{--tags=emitter,receiver}}.\r\n\r\nh3. Outcome\r\n\r\nAll events for Class\[foo\] are de-scheduled, even though it is tagged with emitter:\r\n\r\n{noformat}\r\n# /usr/local/bin/puppet apply --verbose --tags=emitter,receiver --client_datadir=$PWD --catalog_cache_terminus=json tag_test.pp\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nNotice: Compiled catalog for pe-201531-master.puppetdebug.vlan in environment production in 0.09 seconds\r\nInfo: Applying configuration version "1454105744"\r\nNotice: generating event in foo\r\nNotice: /Stage[main]/Foo/Notify[generating event in foo]/message: defined "message" as "generating event in foo"\r\nInfo: Class[Foo]: Unscheduling all events on Class[Foo]\r\nNotice: Applied catalog in 0.16 seconds\r\n\r\n# cat catalog/$(hostname -f).json | python -c "import sys, json; print [ c["tags"] for c in json.load(sys.stdin)["resources"] if c["title"] == "Foo" ]"\r\n[[u"class", u"foo", u"emitter"]]\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe refresh event is delivered to the exec via Class\[foo\]:\r\n\r\n{noformat}\r\n# /usr/local/bin/puppet apply --verbose --tags=emitter,receiver tag_test.pp\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nNotice: Compiled catalog for pe-201531-master.puppetdebug.vlan in environment production in 0.08 seconds\r\nInfo: Applying configuration version "1454105856"\r\nNotice: generating event in foo\r\nNotice: /Stage[main]/Foo/Notify[generating event in foo]/message: defined "message" as "generating event in foo"\r\nInfo: Class[Foo]: Scheduling refresh of Exec[receiver exec]\r\nNotice: /Stage[main]/Receiver/Exec[receiver exec]/returns: received event\r\nNotice: /Stage[main]/Receiver/Exec[receiver exec]: Triggered "refresh" from 1 events\r\nInfo: Stage[main]: Unscheduling all events on Stage[main]\r\nNotice: Applied catalog in 0.18 seconds\r\n{noformat}\r\n\r\nh3. Root Cause\r\n\r\nWhen the agent [replaces Puppet containers (Classes, Stages, Defined Types) with Whits|https://github.com/puppetlabs/puppet/blob/4.3.2/lib/puppet/graph/relationship_graph.rb#L244-L250], tags are not copied from the container objects.', 'https://tickets.puppetlabs.com/browse/PUP-5777', '', '2016-01-29T14:44:39.000-0800', '2017-02-02T06:20:53.000-0800', '2017-02-02T06:20:53.000-0800', 'Closed', 'customer;support', 3, '0', 0, 0, 0, 0, '13daab496e75718a53e5bfd26924b5e0c77b2a1b', 'https://tickets.puppetlabs.com/browse/PUP-5777', 'https://github.com/puppetlabs/puppet/commit/13daab496e75718a53e5bfd26924b5e0c77b2a1b'),
('puppet', 161253, 93986644, 5383, 'Fix issues with bad separation of concern between Array, Hash and Collection types', 'This ticket is about Puppet Type internals and what"s proposed here does not affect how the types are declared or represented.\r\n\r\nIn the current implementation, the {{Collection}} type has both a _size_type_ and an _element_type_ attribute. This, despite the fact that only the _size_type_ is present in the specification. The _element_type_ cannot be declared as a parameter and it is also never included in the string representation of the type. The only reason for it being present in the {{Collection}} is to provide some common functionality shared between the {{Array}} _element_type_ and the {{Hash}} _value_type_.\r\n\r\nThe current design has several negative consequences.\r\n# The code is unclean. It"s hard to understand why and when the _element_type_ is significant in the {{Collection}} type logic.\r\n# It makes the {{Collection}} type carry an unnecessary attribute.\r\n# It imposes the name _element_type_ on the {{Hash}} type although the name there really should be _value_type_ (to correspond with _key_type_).\r\n# It has a negative impact on serialization of the {{Collection}} type since special logic must be added to understand that the _element_type_ shouldn"t be included. This must be fixed (hence the bug status rather than improvement in this ticket).\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6924', 'https://github.com/puppetlabs/puppet/pull/5383', '2016-11-16T07:08:00.000-0800', '2017-02-02T06:20:54.000-0800', '2017-02-02T06:20:54.000-0800', 'Closed', 'maintenance', 1, '0', 1, 170, 98, 14, '25fd778506d14e9fddb5649a4dd300af18b98c50', 'https://tickets.puppetlabs.com/browse/PUP-6924', 'https://github.com/puppetlabs/puppet/pull/5383'),
('puppet', 159181, 92769839, 5367, 'data-in-modules: missing facts during building of the hierarchy fails the lookup completely and silently', 'When building the hierarchy for looking up data in modules, {{lib/puppet/data_providers/hiera_config.rb}} the interpolation around https://github.com/puppetlabs/puppet/blob/4.7.0/lib/puppet/data_providers/hiera_config.rb#L101 does weird things causing the whole lookup to fail, instead of\r\n\r\n* ignoring that hierarchy level\r\n* reporting a specific error\r\n\r\nThis can easily be reproduced by adding the following code to {{spec/classes/test_spec.rb}} into https://github.com/puppetlabs/puppetlabs-ntp/tree/c4f586c8eabc879837942febbb70d30dc4d614ac and running\r\n{code}\r\nbundle install --without system_tests\r\nbundle exec rake spec_prep\r\nbundle exec rspec spec/classes/test_spec.rb\r\n{code}\r\n\r\n{code}\r\nrequire "spec_helper"\r\n\r\ndescribe "ntp" do\r\n  before :each do\r\n    Puppet[:trace]= true\r\n  end\r\n  context "false negatives" do\r\n    context "without facts" do\r\n      # "restrict" is the only reqired parameter with only OS defaults.\r\n      it { is_expected.to compile.and_raise_error(/expects a value for parameter "restrict" at line 1/) }\r\n    end\r\n\r\n    context "with only the required fact" do\r\n      # hiera.yaml uses os.family to locate data/Debian.yaml,\r\n      # which contains a ntp::restrict value\r\n      let :facts do\r\n        {\r\n          os: {\r\n            family: "Debian",\r\n          }\r\n        }\r\n      end\r\n\r\n      it { is_expected.to compile }\r\n    end\r\n  end\r\n\r\n  context "passing tests" do\r\n    context "with any facts" do\r\n      # these facts do not match any of the existing data files\r\n      # only common.yaml is used\r\n      let :facts do\r\n        {\r\n          os: {\r\n            name: "foo",\r\n            family: "foo",\r\n            release: { major: "foo", full: "foo" }\r\n          },\r\n          operatingsystem: "foo"\r\n        }\r\n      end\r\n\r\n      it { is_expected.to compile.and_raise_error(/expects a value for parameter "restrict" at line 1/) }\r\n    end\r\n\r\n    context "with full facts" do\r\n      # all facts provided\r\n      let :facts do\r\n        {\r\n          os: {\r\n            name: "Debian",\r\n            family: "Debian",\r\n            release: { major: "stretch/sid", full: "stretch/sid" }\r\n          },\r\n          operatingsystem: "foo"\r\n        }\r\n      end\r\n\r\n      it { is_expected.to compile }\r\n    end\r\n  end\r\nend\r\n{code}\r\n\r\nExpected Outcome: all these tests pass.\r\n\r\nActual outcome:\r\n\r\n{code}\r\ndavid@zion:~/git/puppetlabs-ntp$ bundle exec rspec spec/classes/test_spec.rb \r\n\r\nntp\r\n  false negatives\r\n    without facts\r\n      should fail to compile and raise an error matching /expects a value for parameter "restrict" at line 1/ (FAILED - 1)\r\n    with only the required fact\r\n      should compile into a catalogue without dependency cycles (FAILED - 2)\r\n  passing tests\r\n    with any facts\r\n      should fail to compile and raise an error matching /expects a value for parameter "restrict" at line 1/\r\n    with full facts\r\n      should compile into a catalogue without dependency cycles\r\n\r\nFailures:\r\n\r\n  1) ntp false negatives without facts should fail to compile and raise an error matching /expects a value for parameter "restrict" at line 1/\r\n     Failure/Error: it { is_expected.to compile.and_raise_error(/expects a value for parameter "restrict" at line 1/) }\r\n     \r\n       error during compilation: Evaluation Error: Error while evaluating a Function Call, Class[Ntp]:\r\n         expects a value for parameter "broadcastclient"\r\n         expects a value for parameter "config"\r\n         expects a value for parameter "config_dir"\r\n         expects a value for parameter "config_file_mode"\r\n         expects a value for parameter "config_epp"\r\n         expects a value for parameter "config_template"\r\n         expects a value for parameter "disable_auth"\r\n         expects a value for parameter "disable_dhclient"\r\n         expects a value for parameter "disable_kernel"\r\n         expects a value for parameter "disable_monitor"\r\n         expects a value for parameter "fudge"\r\n         expects a value for parameter "driftfile"\r\n         expects a value for parameter "leapfile"\r\n         expects a value for parameter "logfile"\r\n         expects a value for parameter "iburst_enable"\r\n         expects a value for parameter "keys"\r\n         expects a value for parameter "keys_enable"\r\n         expects a value for parameter "keys_file"\r\n         expects a value for parameter "keys_controlkey"\r\n         expects a value for parameter "keys_requestkey"\r\n         expects a value for parameter "keys_trusted"\r\n         expects a value for parameter "minpoll"\r\n         expects a value for parameter "maxpoll"\r\n         expects a value for parameter "package_ensure"\r\n         expects a value for parameter "package_manage"\r\n         expects a value for parameter "package_name"\r\n         expects a value for parameter "panic"\r\n         expects a value for parameter "peers"\r\n         expects a value for parameter "preferred_servers"\r\n         expects a value for parameter "restrict"\r\n         expects a value for parameter "interfaces"\r\n         expects a value for parameter "interfaces_ignore"\r\n         expects a value for parameter "servers"\r\n         expects a value for parameter "service_enable"\r\n         expects a value for parameter "service_ensure"\r\n         expects a value for parameter "service_manage"\r\n         expects a value for parameter "service_name"\r\n         expects a value for parameter "service_provider"\r\n         expects a value for parameter "stepout"\r\n         expects a value for parameter "step_tickers_file"\r\n         expects a value for parameter "step_tickers_epp"\r\n         expects a value for parameter "step_tickers_template"\r\n         expects a value for parameter "tinker"\r\n         expects a value for parameter "tos"\r\n         expects a value for parameter "tos_minclock"\r\n         expects a value for parameter "tos_minsane"\r\n         expects a value for parameter "tos_floor"\r\n         expects a value for parameter "tos_ceiling"\r\n         expects a value for parameter "tos_cohort"\r\n         expects a value for parameter "udlc"\r\n         expects a value for parameter "udlc_stratum"\r\n         expects a value for parameter "ntpsigndsocket"\r\n         expects a value for parameter "authprov" at line 1:1 on node zion.black.co.at\r\n     # ./spec/classes/test_spec.rb:10:in `block (4 levels) in <top (required)>"\r\n\r\n  2) ntp false negatives with only the required fact should compile into a catalogue without dependency cycles\r\n     Failure/Error: it { is_expected.to compile }\r\n     \r\n       error during compilation: Evaluation Error: Error while evaluating a Function Call, Class[Ntp]:\r\n         expects a value for parameter "broadcastclient"\r\n         expects a value for parameter "config"\r\n         expects a value for parameter "config_dir"\r\n         expects a value for parameter "config_file_mode"\r\n         expects a value for parameter "config_epp"\r\n         expects a value for parameter "config_template"\r\n         expects a value for parameter "disable_auth"\r\n         expects a value for parameter "disable_dhclient"\r\n         expects a value for parameter "disable_kernel"\r\n         expects a value for parameter "disable_monitor"\r\n         expects a value for parameter "fudge"\r\n         expects a value for parameter "driftfile"\r\n         expects a value for parameter "leapfile"\r\n         expects a value for parameter "logfile"\r\n         expects a value for parameter "iburst_enable"\r\n         expects a value for parameter "keys"\r\n         expects a value for parameter "keys_enable"\r\n         expects a value for parameter "keys_file"\r\n         expects a value for parameter "keys_controlkey"\r\n         expects a value for parameter "keys_requestkey"\r\n         expects a value for parameter "keys_trusted"\r\n         expects a value for parameter "minpoll"\r\n         expects a value for parameter "maxpoll"\r\n         expects a value for parameter "package_ensure"\r\n         expects a value for parameter "package_manage"\r\n         expects a value for parameter "package_name"\r\n         expects a value for parameter "panic"\r\n         expects a value for parameter "peers"\r\n         expects a value for parameter "preferred_servers"\r\n         expects a value for parameter "restrict"\r\n         expects a value for parameter "interfaces"\r\n         expects a value for parameter "interfaces_ignore"\r\n         expects a value for parameter "servers"\r\n         expects a value for parameter "service_enable"\r\n         expects a value for parameter "service_ensure"\r\n         expects a value for parameter "service_manage"\r\n         expects a value for parameter "service_name"\r\n         expects a value for parameter "service_provider"\r\n         expects a value for parameter "stepout"\r\n         expects a value for parameter "step_tickers_file"\r\n         expects a value for parameter "step_tickers_epp"\r\n         expects a value for parameter "step_tickers_template"\r\n         expects a value for parameter "tinker"\r\n         expects a value for parameter "tos"\r\n         expects a value for parameter "tos_minclock"\r\n         expects a value for parameter "tos_minsane"\r\n         expects a value for parameter "tos_floor"\r\n         expects a value for parameter "tos_ceiling"\r\n         expects a value for parameter "tos_cohort"\r\n         expects a value for parameter "udlc"\r\n         expects a value for parameter "udlc_stratum"\r\n         expects a value for parameter "ntpsigndsocket"\r\n         expects a value for parameter "authprov" at line 1:1 on node zion.black.co.at\r\n     # ./spec/classes/test_spec.rb:24:in `block (4 levels) in <top (required)>"\r\n\r\nFinished in 2.14 seconds (files took 0.719 seconds to load)\r\n4 examples, 2 failures\r\n\r\nFailed examples:\r\n\r\nrspec ./spec/classes/test_spec.rb:10 # ntp false negatives without facts should fail to compile and raise an error matching /expects a value for parameter "restrict" at line 1/\r\nrspec ./spec/classes/test_spec.rb:24 # ntp false negatives with only the required fact should compile into a catalogue without dependency cycles\r\n\r\ndavid@zion:~/git/puppetlabs-ntp$ \r\n{code}\r\n\r\nThe first two tests ("without facts", and "with only the required fact") fail with none of the values with default values in common.yaml being applied. The "with full facts" one has all the facts for the hierarchy and suddenly works, although only the os.family should be required. The last one ("with any facts") shows that even specifying nonsensical values is sufficient to make the tests pass.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6856', 'https://github.com/puppetlabs/puppet/pull/5367', '2016-11-01T09:14:36.000-0700', '2017-02-02T06:20:54.000-0800', '2017-02-02T06:20:54.000-0800', 'Closed', '', 7, '0', 1, 9, 1, 2, 'fd7cc0e8dc3531347a62019822fbca75c3d1cdb2', 'https://tickets.puppetlabs.com/browse/PUP-6856', 'https://github.com/puppetlabs/puppet/pull/5367'),
('puppet', 155262, 96839183, 5413, 'Support setting/checking shell in user_role_add ', 'Support setting/checking shell in user_role_add ', 'https://tickets.puppetlabs.com/browse/PUP-6796', 'https://github.com/puppetlabs/puppet/pull/5413', '2016-10-05T12:24:38.000-0700', '2017-02-02T06:20:55.000-0800', '2017-02-02T06:20:55.000-0800', 'Closed', 'maintenance', 3, '0', 2, 17, 131, 5, '6dea400f5244aad9415b6aa81d2e26c3b00b09a5', 'https://tickets.puppetlabs.com/browse/PUP-6796', 'https://github.com/puppetlabs/puppet/pull/5413'),
('puppet', 155258, 88715813, 5322, 'SMF should recursively enable services', 'SMF should recursively enable services by passing the -r flag to svcadm enable', 'https://tickets.puppetlabs.com/browse/PUP-6792', 'https://github.com/puppetlabs/puppet/pull/5322', '2016-10-05T12:08:46.000-0700', '2017-02-02T06:20:56.000-0800', '2017-02-02T06:20:56.000-0800', 'Closed', 'maintenance', 2, '0', 6, 62, 18, 7, '79ad282b3e07510890e5226bc76c1c922b8b18e6', 'https://tickets.puppetlabs.com/browse/PUP-6792', 'https://github.com/puppetlabs/puppet/pull/5322'),
('puppet', 155261, 0, 0, 'Solaris does not support gzipped man pages', 'Solaris does not support gzipped man pages', 'https://tickets.puppetlabs.com/browse/PUP-6795', '', '2016-10-05T12:11:53.000-0700', '2017-02-02T06:20:57.000-0800', '2017-02-02T06:20:57.000-0800', 'Closed', 'maintenance', 2, '0', 0, 0, 0, 0, '7243ee0bbacf0ac36001203f28aae4c0167ba417', 'https://tickets.puppetlabs.com/browse/PUP-6795', 'https://github.com/puppetlabs/puppet/commit/7243ee0bbacf0ac36001203f28aae4c0167ba417'),
('puppet', 154948, 99475638, 5453, 'regression: incompatible character encodings: UTF-8 and ASCII-8BIT', 'This bug - seemingly fixed in https://github.com/puppetlabs/puppet/pull/3977#issuecomment-251466761 seems to have cropped up again:\r\nhttps://bugs.debian.org/cgi-bin/bugreport.cgi?bug=782494\r\n\r\nThis bug has cropped up again in puppet-4.6.1 (puppet-agent 1.6.1) - since we upgraded from puppet-3.7.1 on an agent. it only happens when we run puppet in cron - and the workaround LANG=en_US.utf8 in front of puppet agent -t - works.', 'https://tickets.puppetlabs.com/browse/PUP-6777', 'https://github.com/puppetlabs/puppet/pull/5453', '2016-10-04T12:21:13.000-0700', '2017-02-02T06:20:57.000-0800', '2017-02-02T06:20:57.000-0800', 'Closed', 'i18n;utf-8', 8, '0', 1, 3, 0, 1, '5b974716411afabc1a80d992b28506f4aaf74c79', 'https://tickets.puppetlabs.com/browse/PUP-6777', 'https://github.com/puppetlabs/puppet/pull/5453'),
('puppet', 154177, 85840917, 5285, 'Fix pkgng provider', 'The pkgng package provider fails badly if calls to pkg(8) fails such a way as to prevent Puppet from fixing the issue.\r\n\r\nLink to the PR is here: https://github.com/puppetlabs/puppet/pull/5285\r\n\r\nThe fix here is to return an empty array of package instances in the event of a non-zero exit call to pkg(8) during instances enumeration of the existing packages.  This might happen for a variety of reasons, one of which would be an empty list of repositories.', 'https://tickets.puppetlabs.com/browse/PUP-6758', 'https://github.com/puppetlabs/puppet/pull/5285', '2016-09-29T11:38:11.000-0700', '2017-02-02T06:20:58.000-0800', '2017-02-02T06:20:58.000-0800', 'Closed', '', 3, '0', 1, 13, 1, 2, '4a52931db1ed1ed162f4f5eba1528515b5406dd0', 'https://tickets.puppetlabs.com/browse/PUP-6758', 'https://github.com/puppetlabs/puppet/pull/5285'),
('puppet', 161020, 94373671, 5390, 'the "site" keyword cannot be used as an attribute name when app_management is on', 'The attribute name "site" cannot be used as an attribute name when app_management is turned on. It works when app_management is turned off.\r\n\r\nThis is because the grammar does not list "SITE" as a {{keyword}}, while handling the "SITE_R" (app managment is off) token.\r\n\r\nThis affects some existing modules as they cannot be used with application managment (or PE where app_management is on by default).', 'https://tickets.puppetlabs.com/browse/PUP-6917', 'https://github.com/puppetlabs/puppet/pull/5390', '2016-11-14T15:14:44.000-0800', '2017-02-02T06:20:58.000-0800', '2017-02-02T06:20:58.000-0800', 'Closed', 'DSL;maintenance', 2, '0', 1, 822, 808, 3, '52ff5258a9ce5bc3038f20c913823d370448a7c0', 'https://tickets.puppetlabs.com/browse/PUP-6917', 'https://github.com/puppetlabs/puppet/pull/5390'),
('puppet', 161233, 93907230, 5381, 'SSL - Improve CSR to local public key mismatch handling', 'Assume the following sequence of events:\r\n\r\n* Agent has generated public / private key pair and a CSR\r\n* Agent has sent a CSR to the master (by way of a `puppet agent` run)\r\n* Master has not yet signed the CSR\r\n\r\nNote that the agents CSR includes the agents public key.  Now perform the following:\r\n\r\n* Delete the agents entire SSL directory - including the public / private key pair, CA and CSR\r\n* Re-run `puppet agent -t`\r\n\r\nThe agent will regenerate all the SSL files.\r\n\r\nHowever, instead of using the new CSR that has been created locally (that matches the newly generated public / private key pair), the agent will download the previously submitted CSR from the master.  Despite there being no way of using the previously submitted CSR since the local agent no longer has a matching public key, Puppet will proceed without an error describing the circumstances.\r\n\r\nThe agent should perform a comparison of the local public key to the downloaded CSR to ensure they are a match.  When they are not a match, an error should be presented to the user advising them that their master has a mismatched CSR that must be cleaned.', 'https://tickets.puppetlabs.com/browse/PUP-6918', 'https://github.com/puppetlabs/puppet/pull/5381', '2016-11-15T21:41:10.000-0800', '2017-02-02T06:20:59.000-0800', '2017-02-02T06:20:59.000-0800', 'Closed', 'maintenance;ssl', 4, '0', 1, 23, 1, 1, '0dc1525fd3d40045e6e42d84bbb3af76ce4cc32c', 'https://tickets.puppetlabs.com/browse/PUP-6918', 'https://github.com/puppetlabs/puppet/pull/5381'),
('puppet', 159701, 94369116, 5389, 'Incorrect handling of escape sequence precedence', 'Since Puppet 4 one can use Unicode escape sequences, which work fine:\r\n\r\n{noformat}\r\n$ puppet apply -e "notify { "\uFFFF": }"\r\nNotice: Compiled catalog for example.com in environment production in 0.11 seconds\r\nNotice: ￿\r\nNotice: /Stage[main]/Main/Notify[￿]/message: defined "message" as "￿"\r\nNotice: Applied catalog in 0.10 seconds\r\n{noformat}\r\n\r\nHowever, if I now want to escape the unicode escape sequence by doubling the backslash and print the literal string {{\uFFFF}} it seems like Puppet applies the {{\u}} escape before the double backslash escape:\r\n\r\n{noformat}\r\n$ puppet apply -e "notify { "\\uFFFF": }"\r\nWarning: Unrecognized escape sequence "\￿"  at line 1:21\r\nNotice: Compiled catalog for example.com in environment production in 0.13 seconds\r\nNotice: \￿\r\nNotice: /Stage[main]/Main/Notify[\￿]/message: defined "message" as "\￿"\r\nNotice: Applied catalog in 0.10 seconds\r\n{noformat}\r\n\r\nI think this is the wrong way around, and certainly not what one would expect from other languages.', 'https://tickets.puppetlabs.com/browse/PUP-6882', 'https://github.com/puppetlabs/puppet/pull/5389', '2016-11-04T00:48:26.000-0700', '2017-02-02T06:20:59.000-0800', '2017-02-02T06:20:59.000-0800', 'Closed', 'maintenance', 3, '0', 1, 9, 2, 2, '523266caad1645db9661885ddf2f04718aaad71a', 'https://tickets.puppetlabs.com/browse/PUP-6882', 'https://github.com/puppetlabs/puppet/pull/5389'),
('puppet', 159325, 0, 0, 'puppet on solaris 11 should support exists? for services', 'The smf provider for solaris is currently incapable of removing a service or understanding that a service does not exist.\r\n\r\nThis means puppet cannot distinguish between a service that exists and is stopped/disabled from a nonexistent service. \r\n\r\nIe. this (current output):\r\n{code}\r\n-bash-4.1# puppet resource service foo\r\nservice { "foo":\r\n  ensure => "stopped",\r\n  enable => "false",\r\n}\r\n{code}\r\n\r\nShould be this (desired output):\r\n{code}\r\n-bash-4.1# puppet resource service foo\r\nservice { "foo":\r\n  ensure => "absent",\r\n}\r\n{code}\r\n\r\nI should be able to do this, but can"t:\r\n{code}\r\n-bash-4.1# puppet resource service foo ensure=absent\r\nError: Could not run: Parameter ensure failed on Service[foo]: Invalid value "absent". Valid values are stopped, running.\r\n{code}\r\n\r\n*Update*\r\n* Per comment below, it does not make sense to ensure => absent on a service with SMF\r\n* Instead, just going with correcting the output for a non-existent service, so now it returns "ensure => absent" instead of "ensure => stopped"', 'https://tickets.puppetlabs.com/browse/PUP-6860', '', '2016-11-01T17:01:18.000-0700', '2017-02-02T09:17:36.000-0800', '2017-02-02T09:17:36.000-0800', 'Closed', 'maintenance', 2, '0', 0, 0, 0, 0, 'dd30a54c9ff5fba9f980147b4a7af80442e009ed', 'https://tickets.puppetlabs.com/browse/PUP-6860', 'https://github.com/puppetlabs/puppet/commit/dd30a54c9ff5fba9f980147b4a7af80442e009ed'),
('puppet', 171348, 102555255, 5526, 'Options should be passed to hiera 3 backend when declared in Hiera v5 config', 'Hiera 5 must ensure that a newly added {{hiera3_backend}} entry in the Hiera 5 configuration takes declared options into account and propagates them to the backend.', 'https://tickets.puppetlabs.com/browse/PUP-7124', 'https://github.com/puppetlabs/puppet/pull/5526', '2017-01-20T14:04:29.000-0800', '2017-02-06T07:14:43.000-0800', '2017-02-06T07:14:43.000-0800', 'Closed', '', 4, '0', 1, 61, 5, 2, 'fe33cc186e4942f0df50fca27f2f7888bf5c7ce7', 'https://tickets.puppetlabs.com/browse/PUP-7124', 'https://github.com/puppetlabs/puppet/pull/5526'),
('puppet', 173273, 0, 0, 'Puppet 4.9.0 removes vendored `semantic` gem, used publicly', 'In Puppet 4.9.0, we removed the vendored `semantic` gem, replacing it with `semantic_puppet`. Per the twitter thread at https://twitter.com/rnelson0/status/826584129818984451, this causes issues with any module based on https://github.com/garethr/puppet-module-skeleton/. The Skeleton loads the `semantic` gem from Puppet"s vendor dir to validate a module"s metadata.json.\r\n\r\nA cursory github search shows a distressing number of instances of the string "puppet/vendor/semantic/lib/semantic", although this is probably over-representing usage https://github.com/search?q=puppet%2Fvendor%2Fsemantic%2Flib%2Fsemantic&type=Code&utf8=%E2%9C%93\r\n\r\nSome good news: Recent versions of the skeleton use a pure ruby validator for metadata.json, and the requirement on Puppet"s vendored semantic is vestigal. Removing that line is an easy fix for those using recent versions"s of the skeleton. Unfortunately, we don"t yet know how widespread older versions are.\r\n\r\n*Additional Notes*\r\n* This change was introduced via https://github.com/puppetlabs/puppet/pull/5400\r\n\r\n*In Scope*\r\n* introduces a shim redirecting "semantic" to "semantic_puppet" so that modules / CI will not break as a result of requiring the non-existing "semantic" library.', 'https://tickets.puppetlabs.com/browse/PUP-7156', '', '2017-02-01T09:43:36.000-0800', '2017-02-08T13:35:53.000-0800', '2017-02-08T13:35:53.000-0800', 'Closed', '', 6, '0', 0, 0, 0, 0, '11157ab92c491be35ff587f26070fd5ea011281c', 'https://tickets.puppetlabs.com/browse/PUP-7156', 'https://github.com/puppetlabs/puppet/commit/11157ab92c491be35ff587f26070fd5ea011281c'),
('puppet', 155090, 88087206, 5316, 'http_proxy specs fail if proxy is defined in test env', 'If http_proxy is defined in the test environment specs fail due to precedence of http_proxy over HTTP_PROXY. \r\n\r\n...\r\n\r\n{code:java}\r\n  16) Puppet::Util::HttpProxy.http_proxy_password should use environment variable before puppet settings\r\n      Failure/Error: expect(subject.http_proxy_password).to eq(password)\r\n\r\n        expected: "pAssw0rd"\r\n             got: nil\r\n\r\n        (compared using ==)\r\n      # ./spec/unit/util/http_proxy_spec.rb:120:in `block (4 levels) in <top (required)>"\r\n      # ./lib/puppet/util.rb:128:in `withenv"\r\n      # ./spec/unit/util/http_proxy_spec.rb:118:in `block (3 levels) in <top (required)>"\r\n      # ./spec/spec_helper.rb:211:in `block (2 levels) in <top (required)>"\r\n\r\nFinished in 0.08603 seconds (files took 1.21 seconds to load)\r\n30 examples, 16 failures\r\n\r\n....\r\nrspec spec/unit/forge/repository_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n..FFFF...FFFFF.F\r\n  1) Puppet::Forge::Repository making a request returns the result object from the request\r\n     Failure/Error: proxy_class = Net::HTTP::Proxy(self.http_proxy_host, self.http_proxy_port, self.http_proxy_user, self.http_proxy_password)\r\n\r\n     Mocha::ExpectationError:\r\n       unexpected invocation: Net::HTTP.Proxy("...\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6784', 'https://github.com/puppetlabs/puppet/pull/5316', '2016-10-05T06:52:04.000-0700', '2017-02-08T13:38:12.000-0800', '2017-02-08T13:38:12.000-0800', 'Resolved', 'maintenance', 6, '0', 1, 13, 0, 3, '5ec4a45b66606f2b3533ca53b905f02f77b50c91', 'https://tickets.puppetlabs.com/browse/PUP-6784', 'https://github.com/puppetlabs/puppet/pull/5316'),
('puppet', 173933, 104635177, 5612, 'Undefined Variable trusted.certname', 'After the update to 4.9.0 and a restart of the Puppet Server all nodes produce errors\r\n\r\n{noformat}\r\n Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Resource Statement, Undefined variable "trusted.certname";  at /etc/puppetlabs/code/environments/production/modules20/saltmail/manifests/init.pp:676:5 on node ...\r\n{noformat}\r\n\r\nThe trusted hash is not used in any of our manifests. In all our environments the first time the error occurs is the "include sudo" line in our global manifest. If this is commented out another random location shows the error (depicted above), in this case the error message is right in the middle of an else line.\r\n\r\nThe error occurs on one Puppet Master on Debian wheezy and an independent Puppet Master (sharing some but not all manifest code) on Debian jessie.\r\n\r\nThe string "trusted" never appears in our manifests or Ruby code in any modules.\r\nThe string certname appears twice as parameter name in certificate related modules but nowhere near the source location indicated.\r\n\r\nThe line 676 in the error above looks like this\r\n\r\n{code:puppet}\r\n  } else {\r\n{code}\r\n\r\nThe error with the sudo module occurs once on a simple "include sudo" line and once on the first line of a\r\n\r\n{code:puppet}\r\nclass { "sudo":\r\n    autoupgrade => false\r\n}\r\n{code}\r\n\r\nThe puppetserver.log contains errors like this one\r\n\r\n\r\n{noformat}\r\n2017-02-03 17:01:20,335 ERROR [qtp1680176683-3570] [puppetserver] Puppet Evaluation Error: Error while evaluating a Resource Statement, Undefined variable "trusted.certname";  at /etc/puppetlabs/code/environments\r\n/production/modules20/saltmail/manifests/init.pp:676:5 on node ...\r\n2017-02-03 17:01:20,335 ERROR [qtp1680176683-3570] [puppetserver] Puppet Server Error: Evaluation Error: Error while evaluating a Resource Statement, Undefined variable "trusted.certname";  at /etc/puppetlabs/cod\r\ne/environments/production/modules20/saltmail/manifests/init.pp:676:5 on node...\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:531:in `variable_not_found"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:504:in `lookupvar"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:607:in `lookup_qualified_variable"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:493:in `lookupvar"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/hiera/scope.rb:25:in `[]"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/hiera_config.rb:171:in `scope_interpolations_stable?"\r\norg/jruby/RubyHash.java:1342:in `each"\r\norg/jruby/RubyEnumerable.java:1414:in `all?"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/hiera_config.rb:171:in `scope_interpolations_stable?"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:83:in `data_providers"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:49:in `unchecked_key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:116:in `with"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:42:in `unchecked_key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/global_data_provider.rb:26:in `unchecked_key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb:45:in `key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:73:in `check"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb:45:in `key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:72:in `lookup_global"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:263:in `global_lookup_options"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:263:in `global_lookup_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:272:in `env_lookup_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:242:in `retrieve_lookup_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:116:in `with"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:238:in `retrieve_lookup_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:58:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:237:in `retrieve_lookup_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:139:in `lookup_lookup_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:124:in `lookup_merge_options"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:58:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:58:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:50:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:76:in `search_and_merge"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:401:in `inject_external_parameters"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:400:in `inject_external_parameters"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:396:in `inject_external_parameters"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:363:in `set_resource_parameters"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:171:in `evaluate_code"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:81:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:73:in `evaluate"\r\norg/jruby/RubyArray.java:1613:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:395:in `evaluate_classes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:61:in `create_resources"\r\norg/jruby/RubyArray.java:2414:in `map"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:37:in `create_resources"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:321:in `create_resources"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:842:in `eval_ResourceExpression"\r\norg/jruby/RubyArray.java:2414:in `map"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:839:in `eval_ResourceExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1007:in `eval_IfExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:938:in `with_guarded_scope"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1003:in `eval_IfExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:638:in `eval_BlockExpression"\r\norg/jruby/RubyArray.java:1613:in `each"\r\norg/jruby/RubyEnumerable.java:852:in `inject"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:638:in `eval_BlockExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:32:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:72:in `evaluate"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:71:in `evaluate"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:70:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:184:in `evaluate_code"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:81:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:73:in `evaluate"\r\norg/jruby/RubyArray.java:1613:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:395:in `evaluate_classes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/include.rb:16:in `include"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:47:in `invoke"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:36:in `dispatch"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:35:in `dispatch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `call"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call"\r\n/etc/puppetlabs/code/environments/production/manifests/10_global.pp:60:in `call_function"\r\norg/jruby/RubyKernel.java:1079:in `eval"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:284:in `call_function"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:282:in `call_function"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:941:in `call_function_with_block"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:910:in `eval_CallNamedFunctionExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1005:in `eval_IfExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/scope.rb:938:in `with_guarded_scope"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:1003:in `eval_IfExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:638:in `eval_BlockExpression"\r\norg/jruby/RubyArray.java:1613:in `each"\r\norg/jruby/RubyEnumerable.java:852:in `inject"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:638:in `eval_BlockExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:69:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/etc/puppetlabs/code/environments/production/manifests/10_global.pp:0:in `stack"\r\norg/jruby/RubyKernel.java:1079:in `eval"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:30:in `stack"\r\n{noformat}\r\n\r\nWe do not make any use of Hiera.\r\n\r\n(node names in errors and log omitted on purpose)', 'https://tickets.puppetlabs.com/browse/PUP-7171', 'https://github.com/puppetlabs/puppet/pull/5612', '2017-02-03T08:29:37.000-0800', '2017-02-10T14:41:56.000-0800', '2017-02-10T14:41:56.000-0800', 'Closed', '', 24, '0', 1, 27, 13, 4, 'ee2bf9a430e658d6f018b2786e58133ddfe1c014', 'https://tickets.puppetlabs.com/browse/PUP-7171', 'https://github.com/puppetlabs/puppet/pull/5612'),
('puppet', 145505, 104236089, 5600, 'Allow context path in http_proxy', 'tried `export http_proxy=http://10.60.1.94:8080/artifactory/Puppet`\r\n\r\nThen \r\n`puppet module --debug search apache`\r\nDebug: Runtime environment: puppet_version=4.5.2, ruby_version=2.1.9, run_mode=user, default_encoding=UTF-8\r\nNotice: Searching https://forgeapi.puppetlabs.com ...\r\nDebug: HTTP GET https://forgeapi.puppetlabs.com/v3/modules?query=apache&module_groups=base+pe_only\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nError: Could not connect to https://forgeapi.puppetlabs.com\r\n  There was a network communications problem\r\n    The error we caught said "404 "Not Found""\r\n    Check your network connection and try again\r\nError: Try "puppet help module search" for usage\r\n\r\n\r\nIt tries to search module only from http://Host:Port  it ignores context path\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6588', 'https://github.com/puppetlabs/puppet/pull/5600', '2016-08-05T14:39:58.000-0700', '2017-02-10T14:41:56.000-0800', '2017-02-10T14:41:56.000-0800', 'Closed', '', 9, '0', 1, 24, 2, 3, '5ce0917cf8b63dc682987aab9e93976509dd284f', 'https://tickets.puppetlabs.com/browse/PUP-6588', 'https://github.com/puppetlabs/puppet/pull/5600'),
('puppet', 173761, 104492985, 5607, 'Hiera interpolation on key changed', 'On the latest puppet agent, with the new Hiera the a (yaml) key is not interpolated to its name.\r\nYaml snippet:\r\n\r\n{code}\r\nsssd::config:\r\n  "sssd":\r\n    "domains": "%{profile::defaults::krb5realm}"\r\n<snip>\r\n  "domain/%{profile::defaults::krb5realm}":\r\n    "cache_credentials": true\r\n<snip>\r\n{code}\r\n\r\nPrevious release this compiled to sssd.conf:\r\n{code}\r\n[sssd]\r\ndomains = FULL_KRB5_REALM\r\n<snip>\r\n[domain/FULL_KRB5_REALM]\r\ncache_credentials = true\r\n<snip>\r\n{code}\r\n\r\nHowever, since puppet agent 1.9.0 this happens:\r\n{code}\r\n[sssd]\r\ndomains = FULL_KRB5_REALM\r\n<snip>\r\n[domain/%{profile::defaults::krb5realm}]\r\ncache_credentials = true\r\n<snip>\r\n{code}\r\n\r\nThe variable is available, since it is used before, but it is not interpolated.', 'https://tickets.puppetlabs.com/browse/PUP-7167', 'https://github.com/puppetlabs/puppet/pull/5607', '2017-02-02T07:43:23.000-0800', '2017-02-10T14:41:57.000-0800', '2017-02-10T14:41:57.000-0800', 'Closed', '', 12, '0', 1, 47, 3, 2, '6791b7ed6a0dc28ef0a8870fc316e0177cad8a0e', 'https://tickets.puppetlabs.com/browse/PUP-7167', 'https://github.com/puppetlabs/puppet/pull/5607'),
('puppet', 173865, 104616647, 5611, 'Automatic parameter lookup expects Array/Hash instead of String with deeper merging', 'Automatic parameter lookup stopped working after updating Puppet Server. Now I get:\r\n{code}\r\nInfo: Using configured environment "local"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nWarning: Found multiple default providers for service: debian, runit; using debian\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Function Call, Lookup of key "zabbix::server" failed: The first element of the merge has wrong type, expects a value of type Array or Hash, got String in The first element of the merge has wrong type, expects a value of type Array or Hash, got String at /etc/puppetlabs/code/environments/local/site.pp:1:1 on node puppet2.example.net\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{code}\r\n\r\nIn my Hiera hierarchy, I have set "zabbix::server" to string in 2 layers. It should pick only one string. Instead, it tries to merge it as a hash and fails.\r\n\r\nhiera.yaml: http://pastebin.com/raw/N8NCTG6i\r\npuppet.conf: http://pastebin.com/raw/iuEN99na \r\nzabbix/manifests/init.pp: http://pastebin.com/raw/D5dA4T0t\r\n"zabbix::server" lines in hiera datadir: http://pastebin.com/raw/ri5fUtGa\r\nthe error and site.pp: http://pastebin.com/raw/24F3YhZa', 'https://tickets.puppetlabs.com/browse/PUP-7176', 'https://github.com/puppetlabs/puppet/pull/5611', '2017-02-02T13:02:17.000-0800', '2017-02-10T14:41:57.000-0800', '2017-02-10T14:41:57.000-0800', 'Closed', '', 5, '0', 1, 21, 3, 2, '7a2c4ed432f995ff35a74b187632d597f83e613d', 'https://tickets.puppetlabs.com/browse/PUP-7176', 'https://github.com/puppetlabs/puppet/pull/5611'),
('puppet', 173850, 104445374, 5605, 'a hiera.yaml v3 in the root of an env should be under control of --strict', 'Many people use a pattern of having a hiera.yaml (v3) in the root of their control repo for the purpose of symlinking it to the global hiera.yaml location setting path.\r\n\r\nPuppet 4.9.0 takes a hiera.yaml in an environment root as an error if the file is of version 3.\r\nThis means that users upgrading to puppet 4.9.0 may have a large number of environments to clean up before they can run puppet 4.9.0.\r\n\r\nWe should fix this problem by letting the {{\--strict}} flag control the behavior. When it is set to {{error}} it should behave as it is currently doing in 4.9.0. When set to {{warning}} it should log a warning, and continue as if the file was not there.', 'https://tickets.puppetlabs.com/browse/PUP-7165', 'https://github.com/puppetlabs/puppet/pull/5605', '2017-02-02T11:21:16.000-0800', '2017-02-10T14:41:58.000-0800', '2017-02-10T14:41:58.000-0800', 'Closed', '', 8, '0', 1, 47, 7, 3, '35a61b52348adc00aa17c1209ee6bcff62e6f4a4', 'https://tickets.puppetlabs.com/browse/PUP-7165', 'https://github.com/puppetlabs/puppet/pull/5605'),
('puppet', 174050, 104659440, 5613, 'Hiera custom backends cannot find data in other backends using "hiera" interpolation function', 'A hiera custom backend will run under control of classic Hiera. That Hiera is however not fully configured to handled nested lookups using the {{hiera}} interpolation function.\r\n\r\nWhile such nested lookups should be confined to the global layer (since classic Hiera is unaware of environment and module data providers), it must still find all other "backends" in that layer, even if they no longer are classic Hiera backends. This doesn"t happen today, which means that a\r\n{code}\r\n%{hiera("some_key")}\r\n{code}\r\nwhere _"some_key"_ appoints something from another data provider will fail.', 'https://tickets.puppetlabs.com/browse/PUP-7178', 'https://github.com/puppetlabs/puppet/pull/5613', '2017-02-04T03:06:17.000-0800', '2017-02-10T14:41:58.000-0800', '2017-02-10T14:41:58.000-0800', 'Closed', '', 0, '0', 1, 173, 2, 3, '8ca7c17a24a16899ffac95f2d4db6ff48e860cce', 'https://tickets.puppetlabs.com/browse/PUP-7178', 'https://github.com/puppetlabs/puppet/pull/5613'),
('puppet', 174564, 105254696, 5627, 'CI failure: tests/utf8.utf8-in-function-args.rb', 'This tested failed on multiple platforms:\r\n\r\nhttps://jenkins.puppetlabs.com/view/puppet-agent/view/manual/view/stable/job/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/107/testReport/\r\n\r\naix-53-power:\r\nhttps://jenkins.puppetlabs.com/view/puppet-agent/view/manual/view/stable/job/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/107/SLAVE_LABEL=beaker,TEST_TARGET=aix-53-power/testReport/junit/(root)/tests_utf8/utf8_in_function_args_rb/\r\n\r\nzpbw2rxembwqls.delivery.puppetlabs.net (master) 00:44:06$ service puppetserver reload\r\n          Redirecting to /bin/systemctl reload  puppetserver.service\r\n        \r\n        jzpbw2rxembwqls.delivery.puppetlabs.net (master) executed in 5.27 seconds\r\n        RuntimeError: PuppetAcceptance::DSL::Helpers.with_puppet_running_on failed (check backtrace for location) because: Host "pe-aix-53-acceptance.delivery.puppetlabs.net" exited with 1 running:\r\n         env LANG="en_US.UTF-8" puppet apply -e "notice(hiera("array_key_with_utf8_€‰ㄘ万竹ÜÖ"))"\r\n        Last 10 lines of output were:\r\n        	Warning: The function "hiera" is deprecated in favor of using "lookup". See https://docs.puppet.com/puppet/4.9.1/reference/deprecated_language.html\r\n        	   (file & line not available)\r\n        	Warning: /tmp/lookup_test_dir.28779/hiera.yaml: Use of "hiera.yaml" version 3 is deprecated. It should be converted to version 5\r\n        	   (in /tmp/lookup_test_dir.28779/hiera.yaml)\r\n        	Error: Function lookup() did not find a value for the name "array_key_with_utf8_€‰ㄘ万竹ÜÖ"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/host.rb:373:in `exec"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/helpers/host_helpers.rb:83:in `block in on"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/shared/host_manager.rb:127:in `run_block_on"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/patterns.rb:37:in `block_on"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/helpers/host_helpers.rb:63:in `on"\r\n        tests/utf8/utf8-in-function-args.rb:213:in `block (5 levels) in run_test"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/structure.rb:43:in `step"\r\n        tests/utf8/utf8-in-function-args.rb:212:in `block (4 levels) in run_test"\r\n        tests/utf8/utf8-in-function-args.rb:18:in `each"\r\n        tests/utf8/utf8-in-function-args.rb:18:in `block (3 levels) in run_test"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/helpers/puppet_helpers.rb:188:in `with_puppet_running_on"\r\n        tests/utf8/utf8-in-function-args.rb:17:in `block (2 levels) in run_test"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/structure.rb:58:in `test_name"\r\n        tests/utf8/utf8-in-function-args.rb:1:in `block in run_test"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_case.rb:133:in `eval"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_case.rb:133:in `block in run_test"\r\n        /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308:in `realtime"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_case.rb:130:in `run_test"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:325:in `block in run"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:322:in `each"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:322:in `run"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:371:in `run_and_raise_on_failure"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/cli.rb:178:in `run_suite"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/cli.rb:104:in `execute!"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/bin/beaker:9:in `<top (required)>"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/bin/beaker:23:in `load"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/bin/beaker:23:in `<main>"\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/helpers/puppet_helpers.rb:204\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/helpers/puppet_helpers.rb:241\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/tests/utf8/utf8-in-function-args.rb:17\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/dsl/structure.rb:58\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/tests/utf8/utf8-in-function-args.rb:1\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_case.rb:133\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_case.rb:133\r\n        /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_case.rb:130\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:325\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:322\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:322\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/test_suite.rb:371\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/cli.rb:178\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/lib/beaker/cli.rb:104\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/gems/beaker-3.10.0/bin/beaker:9\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n        /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/aix-53-power/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n        Begin teardown\r\n        End teardown\r\n        Warning: tests/utf8/utf8-in-function-args.rb errored in 82.55 seconds\r\n\r\n\r\nThe failures are basically the same on the other systems as well.', 'https://tickets.puppetlabs.com/browse/PUP-7190', 'https://github.com/puppetlabs/puppet/pull/5627', '2017-02-08T08:30:33.000-0800', '2017-02-10T14:41:59.000-0800', '2017-02-10T14:41:59.000-0800', 'Closed', '', 1, '0', 1, 3, 0, 1, 'eac89d3ed1fb0f08d50b877f3d9f3606a19a56c0', 'https://tickets.puppetlabs.com/browse/PUP-7190', 'https://github.com/puppetlabs/puppet/pull/5627'),
('puppet', 138985, 80153440, 5176, 'UTF-8 source files for File resource cause failures', 'h1. Background\r\nThis ticket is raise in relation to UTF-8 support in Puppet and Puppet Enterprise.\r\n\r\nh1. Environment\r\n\r\nPE2016.2.0 for all nodes\r\nThe environment used for this test was https://github.com/beergeek/utf_8_env\r\nControl repo was https://github.com/beergeek/utf_8_test\r\nThe component module was https://github.com/beergeek/utf_8\r\nThe nodes were Windows 2012r2, CentOS 6 & 7, and Ubuntu 16.04 with locale set to {ja_JP.ut8}}, Ubu the master"s locale was en_US.utf8\r\n\r\nh1. Test\r\nAll non-master nodes belong to the ウェブ・グループ Node Group, which has the class of {{role::base}}.  This calls a component module {{https://github.com/beergeek/utf_8}} instantiating several resources with UTF-8 characters.\r\n\r\nWhen using a file resource with the {{source}} attribute set to a UTF-8 filename the Puppet run will fail.\r\n\r\n{code}\r\nfile { "${dir0}${file_name}":\r\n  ensure => file,\r\n  source => "puppet://modules/utf_8/静的",\r\n}\r\n{code}\r\n\r\nPuppet run:\r\n{code}\r\nError: /Stage[main]/Utf_8/File[/メインディレクトリ/ファイル＿3]: Could not evaluate: Could not retrieve file metadata for puppet://modules/utf_8/静的: invalid byte sequence in US-ASCII\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:302:in `=~"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:302:in `absolute_path?"\r\n{code}\r\n\r\nThis appears to be related to PUP-6426', 'https://tickets.puppetlabs.com/browse/PUP-6448', 'https://github.com/puppetlabs/puppet/pull/5176', '2016-06-27T16:29:38.000-0700', '2017-02-10T14:48:29.000-0800', '2017-02-10T14:48:29.000-0800', 'Closed', '', 20, '0', 1, 14, 1, 2, '9c89ed2f596e67f860cddb645acca7f1c5da8893', 'https://tickets.puppetlabs.com/browse/PUP-6448', 'https://github.com/puppetlabs/puppet/pull/5176'),
('puppet', 121944, 63277844, 4795, 'Pip3 provider does not include features from Pip', 'The Pip3 provider was introduced in Puppet 4.2.0. The implementation was incomplete, as it doesn"t specify the features provided by Pip, and using {{:parent}} doesn"t inherit features.\r\n\r\nThat should only be a problem for people trying to use the Pip3 provider, but due to chance that provider is selected when no more appropriate providers are available (which happens often in module spec testing). The result is module spec tests trying to use many package features start failing in Puppet 4.2.0. See https://github.com/cdenneen/puppet-test/ for a simple example instantiating {{*package {"foo": ensure => "1.0.0-1"\}*}}.', 'https://tickets.puppetlabs.com/browse/PUP-6067', 'https://github.com/puppetlabs/puppet/pull/4795', '2016-03-17T12:05:54.000-0700', '2017-02-13T09:54:45.000-0800', '2017-02-13T09:54:45.000-0800', 'Closed', '', 8, '0', 2, 18, 0, 3, '45c2656d2dfe72eb640198ebc474b4f5d9332113', 'https://tickets.puppetlabs.com/browse/PUP-6067', 'https://github.com/puppetlabs/puppet/pull/4795'),
('puppet', 173920, 104523036, 5608, 'puppet 4.9.0 breaks hiera-eyaml ', 'Hello, \r\nwhen having hiera-eyaml installed and enabled (encrypted datastore), puppet 4.8.1 works like a charm on puppet 4.9.0 I get this error: \r\n\r\nError message: \r\n{noformat}\r\nError: Evaluation Error: Error while evaluating a Resource Statement, Lookup of key "puppetserver::version" failed: Unrecognized value for request "merge" parameter: "unconstrained_deep" at /tmp/muh.pp:1:1 on node SERVER\r\n{noformat}\r\n\r\nNote: alreay opened a bug in HIERA https://tickets.puppetlabs.com/browse/HI-552\r\n\r\nEnvironment: \r\n\r\n{noformat}\r\n[root@server]# puppet -V\r\n4.9.0\r\n[root@server]# hiera -v\r\n3.3.0\r\n{noformat}\r\n\r\nHiera config:\r\n{noformat}\r\n---\r\n:backends:\r\n  - eyaml\r\n  - yaml\r\n\r\n:hierarchy:\r\n  - "certname/%{::clientcert}"\r\n  - "cluster/%{::cluster}"\r\n  - "role/%{::role}"\r\n  - "topic/%{::topic}"\r\n  - "location/%{::location}"\r\n  - "common"\r\n\r\n:yaml:\r\n  :datadir: /opt/provision/hiera\r\n\r\n:eyaml:\r\n  :datadir: /opt/provision/hiera\r\n  :pkcs7_private_key: /opt/provision/hiera_keys/private_key.pkcs7.pem\r\n  :pkcs7_public_key: /opt/provision/hiera_keys/public_key.pkcs7.pem\r\n  :extension: "yaml"\r\n\r\n# options are native, deep, deeper\r\n:merge_behavior: deeper\r\n:deep_merge_options:\r\n  :knockout_prefix: "--"\r\n{noformat}\r\n\r\nGems: \r\n{noformat}\r\n[root@SERVER]# /opt/puppetlabs/puppet/bin/gem list\r\n\r\n*** LOCAL GEMS ***\r\n\r\nbigdecimal (1.2.4)\r\ndeep_merge (1.0.1)\r\nfacter (3.6.0)\r\nfast_gettext (1.1.0)\r\ngettext (3.2.2)\r\ngettext-setup (0.10)\r\nhiera (3.3.0)\r\nhiera-eyaml (2.1.0)\r\nhighline (1.6.21)\r\nhocon (1.1.3)\r\nio-console (0.4.3)\r\njson (1.8.1)\r\nlocale (2.1.2)\r\nminitest (4.7.5)\r\nnet-ssh (2.9.2)\r\npsych (2.0.5)\r\npuppet (4.9.0)\r\nrake (10.1.0)\r\nrdoc (4.1.0)\r\nsemantic_puppet (0.1.2)\r\nstomp (1.3.3)\r\ntest-unit (2.1.9.0)\r\ntext (1.3.1)\r\ntrollop (2.1.2)\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7169', 'https://github.com/puppetlabs/puppet/pull/5608', '2017-02-03T01:04:10.000-0800', '2017-02-15T04:51:41.000-0800', '2017-02-15T04:51:41.000-0800', 'Closed', '', 13, '0', 1, 84, 36, 2, '06d30c2a89303e816f2246d6adbfaa874e414e64', 'https://tickets.puppetlabs.com/browse/PUP-7169', 'https://github.com/puppetlabs/puppet/pull/5608'),
('puppet', 16444, 74828919, 5049, 'RPM provider query method returns leading quote in package names', 'Due to the change in e96ac6b6abb9f387e9b8cd097b024aaa4bc656ee, the query method of the RPM provider now includes single quotes in the format passed to rpm. This causes the name of packages to be determined to have the leading quote (such as `"pe-puppet`). In particular, this causes strange output from the MCollective package agent (and thus Live Management).\r\n\r\nThe instances method (and thus `puppet resource`) works correctly. The difference seems to be the use of `execpipe` (which takes a verbatim string, where the quotes are assumed to be a grouping) vs. the `rpm` command helper (which takes an array, where the quotes are used as part of the format string). ', 'https://tickets.puppetlabs.com/browse/PUP-535', 'https://github.com/puppetlabs/puppet/pull/5049', '2013-10-08T16:16:06.000-0700', '2017-02-21T10:23:56.000-0800', '2017-02-21T10:23:56.000-0800', 'Closed', 'regression', 1, '0', 1, 1, 0, 1, '3dea1ad0a1129169a91a753f3974a4cfb2135e53', 'https://tickets.puppetlabs.com/browse/PUP-535', 'https://github.com/puppetlabs/puppet/pull/5049'),
('puppet', 149854, 105956510, 5639, 'Large volumes of RPM queries leave stale locks on the rpm database', 'When running large volumes of rpm queries as the root user to determine package state, locks are placed on the rpm database that can become stale and prevent package installation/removal through either the rpm or yum providers. \r\n\r\nWorking directly with Red Hat, it was determined that this isn"t an issue when executed as non-root users since no attempt is made to access the /var/lib/rpm/__db.[nnn] files. Obviously this isn"t the normal scenario as typically puppet is run as root.\r\n\r\nExample:\r\n\r\n// Non-root user strace of an "rpm -qa"\r\n# grep db.00 /tmp/rpm.non-root.strace \r\n#\r\n\r\n\r\n// root user strace of an "rpm -qa"\r\n# grep db.00 /tmp/rpm.root.strace \r\naccess("/var/lib/rpm/__db.001", F_OK)   = 0\r\nopen("/var/lib/rpm/__db.001", O_RDWR)   = 3\r\nopen("/var/lib/rpm/__db.001", O_RDWR)   = 3\r\nopen("/var/lib/rpm/__db.002", O_RDWR)   = 3\r\nopen("/var/lib/rpm/__db.003", O_RDWR)   = 3\r\nopen("/var/lib/rpm/__db.004", O_RDWR)   = 3\r\naccess("/var/lib/rpm/__db.001", F_OK)   = 0\r\n\r\nThe fix to prevent stale locks from occurring in situations of large query volumes appears to be properly quoting the query format string (represented as NEVRA_FORMAT) in the rpm provider.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6663', 'https://github.com/puppetlabs/puppet/pull/5639', '2016-08-30T14:21:23.000-0700', '2017-02-21T10:24:12.000-0800', '2017-02-21T10:24:12.000-0800', 'Closed', 'maintenance', 1, '0', 1, 3, 2, 2, 'e3040c4d9ffb5d8960de764f707e0dc90aa5ace3', 'https://tickets.puppetlabs.com/browse/PUP-6663', 'https://github.com/puppetlabs/puppet/pull/5639'),
('puppet', 64021, 27487221, 3488, 'Two User provider spec tests fail on RedHat systems', 'The command line option -M is added when executing the useradd command on RedHat systems. Two provider tests for the User resource does not take this into account:\r\n\r\nspec/unit/provider/user/openbsd_spec.rb (#addcmd at line 50)\r\nspec/unit/provider/user/useradd_spec.rb (#creaete at line 57)\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3850', 'https://github.com/puppetlabs/puppet/pull/3488', '2015-01-14T14:04:38.000-0800', '2017-02-23T14:15:12.000-0800', '2017-02-23T14:15:12.000-0800', 'Closed', '', 5, '0', 5, 51, 12, 8, '733b3a5c7cc74c51c08e775df2cff7d5cc9c03d9', 'https://tickets.puppetlabs.com/browse/PUP-3850', 'https://github.com/puppetlabs/puppet/pull/3488'),
('puppet', 174054, 104700282, 5614, 'Type aliases defined across multiple levels of modules', 'I have three modules; A, B and C.\r\n\r\n# Module C defines some type aliases.\r\n# Module B lists module C in `metadata.json` and defines some type aliases in terms of the ones in C, (`Variant`, `Array`, etc.).\r\n# Module A lists module B in `metadata.json` and uses the type aliases defined in B for parameter types.\r\n\r\nWhen I try and use module A I get errors similar to:\r\n\r\n{noformat}\r\nClass[A]: parameter "myparam" references an unresolved type "C::MyType"\r\n{noformat}\r\n\r\n`myparam` is defined in the class of type "B::SomeType".\r\n\r\nThe workaround is to also add module C to module A"s `metadata.json` even though it is installed on the host by virtue of installing module B. I would argue it should just work without this as I"m not explicitly using any of C"s resources; it"s a dependency of B"s and that module is free to change it"s dependencies as it sees fit.', 'https://tickets.puppetlabs.com/browse/PUP-7179', 'https://github.com/puppetlabs/puppet/pull/5614', '2017-02-04T09:56:41.000-0800', '2017-02-24T14:07:36.000-0800', '2017-02-24T14:07:36.000-0800', 'Closed', '', 7, '0', 1, 216, 123, 16, '1ae93e52878082507ed52bf5cd2337d56d7d1dad', 'https://tickets.puppetlabs.com/browse/PUP-7179', 'https://github.com/puppetlabs/puppet/pull/5614'),
('puppet', 120492, 66958673, 4895, 'Windows GetFileAttributes calls fail / symlink? may return false for a valid symlink', 'While using windbg to debug PUP-5768, I triggered an issue in Puppet affecting Windows that has flown under the radar based on how the code paths are exercised, but that is certainly causing performance degradations on Windows.\r\n\r\nThe problematic code was introduced in https://github.com/puppetlabs/puppet/commit/c64fa0749f673cc75c09b986f3e50a80c7237314 with the addition of calls to the Windows API {{GetFileAttributes}}.  These calls were added as they were necessary to implement symlink support on Windows.  When this code was introduced, we were unfortunately in the position of monkey patching broken file stats in Ruby on Windows or else write a whole new File class, replace all the calls across the codebase and hope to use it everywhere rather than the core Ruby file system.  Since that was turtles all the way down, we opted to make a tiny patch to Ruby itself.\r\n\r\nOf course, that decision had a penalty that is a bit more clear now, given the implementation of {{get_file_attributes}} has been discovered as errant.  Whether this was an initial testing oversight, or a change in Ruby behavior, I"m not certain just yet.\r\n\r\nAny time a file is stat"d, the {{symlink?}} detection codepath is triggered.  Unfortunately, it would appear that paths are being fed to {{get_file_attributes}} that have forward slashes / instead of the backslashes \ that the Windows API expects.  Because the {{symlink?}} code eats exceptions and returns {{false}} when the {{GetFileAttributes}} API is called at https://github.com/puppetlabs/puppet/commit/c64fa0749f673cc75c09b986f3e50a80c7237314#diff-a91b066f285a8fe7ccfa4162399d458fR162, improperly setup calls to {{GetFileAttributes}} are silently / expensively swallowed.\r\n\r\nThe net result here is that for a trivial puppet apply, I logged 925 exceptions silently swallowed (mostly Puppet looking through subdirs for code):\r\n\r\n{code}\r\npuppet apply -e "notify { "hi": }"\r\n{code}\r\n\r\nA couple of ideas come to mind on how to fix this:\r\n\r\n* See if Ruby itself has fixed the underlying stats to support symlinks properly - re-examine if the Puppet implementation is necessary anymore on 2.1.x\r\n* Canonicalize all paths entering the {{get_file_attributes}} code path\r\n* Attempt to delay load the resolution if possible\r\n\r\nThe method is now called {{get_attributes}} and logging of the exceptions can be trivially added for demonstrative purposes by adding the following code at https://github.com/puppetlabs/puppet/blob/0c32e9d5e7aa87f2bcd9f8a5002c2400b6076456/lib/puppet/util/windows/file.rb#L97\r\n\r\n{code}\r\nopen("c:/attrib-fail.txt", "a") { |f| f << "#{file_name}\n" }}\r\n{code}\r\n\r\n\r\nAn excerpt of the complete output is:\r\n\r\n{noformat}\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/bigdecimal-1.2.4/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/deep_merge-1.0.1/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/ffi-1.9.6-x64-mingw32/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/io-console-0.4.3/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/json-1.8.1/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/minitar-0.5.4/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/minitest-4.7.5/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/psych-2.0.5/lib/puppet/indirector/resource/ral.rb\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.1.0/gems/rake-10.1.0/lib/puppet/indirector/resource/ral.rb\r\n\r\n...\r\n\r\nC:/ProgramData/PuppetLabs/puppet/cache/lib/puppet/type/filebucket.rb\r\nC:/ProgramData/PuppetLabs/puppet/etc/csr_attributes.yaml\r\nC:/ProgramData/PuppetLabs/puppet/etc/ssl/private/password\r\nC:/ProgramData/PuppetLabs/puppet/etc/ssl/csr_vagrant-2008r2.pem\r\nC:/ProgramData/PuppetLabs/puppet/etc/ssl/certs/vagrant-2008r2.pem\r\nC:/ProgramData/PuppetLabs/puppet/etc/ssl/private_keys/vagrant-2008r2.pem\r\nC:/ProgramData/PuppetLabs/puppet/etc/ssl/public_keys/vagrant-2008r2.pem\r\nC:/ProgramData/PuppetLabs/puppet/cache/lib/puppet/reports/store.rb\r\nC:/ProgramData/PuppetLabs/puppet/cache/reports/vagrant-2008r2/201603090411.yaml\r\n{noformat}\r\n\r\nComplete Log: [^GetFileAttributes-fails.txt]\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6025', 'https://github.com/puppetlabs/puppet/pull/4895', '2016-03-08T20:42:10.000-0800', '2017-02-24T15:58:23.000-0800', '2017-02-24T15:58:23.000-0800', 'Closed', 'windows', 10, '0', 1, 137, 25, 5, '7a5e7d99a8969b072f3c0b7fc8b38217df4fae1e', 'https://tickets.puppetlabs.com/browse/PUP-6025', 'https://github.com/puppetlabs/puppet/pull/4895'),
('puppet', 84382, 37700962, 4033, 'cannot call 4.x functions from 3.x function ERB templates', 'It is not possible to call a 4.x function from a 3.x function or ERB template because that logic does not have ready access to a mechanism to perform such a call correctly.\r\n\r\nWe should add a new method of scope that works the same way as how the puppet language evaluator performs the call. i.e.:\r\n* The call is made with arguments using ruby/4.x semantics (no funny undef stuff)\r\n* If a 4.x function is found it wins\r\n* If a 3.x function is found the arguments are transformed to the 3.x convention (i.e. undef funny stuff).\r\n* in a 3.x version, 4.x. functions are only found if parser==future.\r\n\r\nThe solution is to add a method {{call_function}} on Scope. It accepts the name of a function as its first argument, followed by all arguments in an Array. It also accepts a Ruby block (as a lambda).\r\n\r\nORIGINAL REPORT\r\n----\r\nescaped and reported from outside:\r\nhttps://groups.google.com/forum/#!msg/puppet-users/Ht_5d2Wb6VA/v1lVtw031DkJ\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4753', 'https://github.com/puppetlabs/puppet/pull/4033', '2015-06-12T08:31:19.000-0700', '2017-02-28T14:06:12.000-0800', '2017-02-28T14:06:12.000-0800', 'Closed', '', 11, '0', 4, 84, 0, 3, 'e738bda05b9dd870a7bc118e850dc56f0c32236f', 'https://tickets.puppetlabs.com/browse/PUP-4753', 'https://github.com/puppetlabs/puppet/pull/4033'),
('puppet', 88926, 69513089, 4953, 'Overriding attributes of defined types doesn"t work through the ENC', 'Consider the following setup, with a defined type and two classes:\r\n\r\n{noformat}\r\ndefine defined_type_test($value) {\r\n  notify { "message_${title}":\r\n    message => $value,\r\n  }\r\n}\r\n\r\nclass base {\r\n  defined_type_test { "foo":\r\n    value => "Original Message",\r\n  }\r\n}\r\n\r\nclass override {\r\n  Defined_type_test <| title == "foo" |> {\r\n    value => "Overridden Message",\r\n  }\r\n}\r\n{noformat}\r\n\r\nWhen both classes are called via "node default", it works as expected -- The "message_foo" notify emits "Overridden Message".\r\n\r\nHowever, when the class "base" is called via "node default", and the class "override" is called via the ENC, "message_foo" emits "Original Message".  The "override" class is definitely being executed; other resources added to the class are applied without issues.\r\n\r\nLikewise, only resources that are instances of defined types are affected.  Overriding an attribute of a "real" type works fine from a class called via the ENC.\r\n\r\nAs best I can tell, this only occurs when all of the following are true:\r\n* You"re attempting to override an attribute on a resource that is an instance of a defined type\r\n* The resource is created in a class that is called via manifests/site.pp\r\n* The collector to override the attribute is in a class that is called via the ENC (not necessarily directly; this also holds if an intermediate class is called from the ENC, which in turn calls the class containing the override)', 'https://tickets.puppetlabs.com/browse/PUP-4856', 'https://github.com/puppetlabs/puppet/pull/4953', '2015-07-13T18:58:32.000-0700', '2017-03-01T16:19:19.000-0800', '2017-03-01T16:19:19.000-0800', 'Closed', '', 18, '0', 1, 38, 1, 2, '', 'https://tickets.puppetlabs.com/browse/PUP-4856', 'https://github.com/puppetlabs/puppet/pull/4953'),
('puppet', 176004, 107335668, 5657, 'fix configuration_interpolation test', 'the configuration_interpolation test removes the global hiera.yaml. \r\n\r\nThis is bad, because other tests must use that file. we need to fix the test to no longer remove the global file.', 'https://tickets.puppetlabs.com/browse/PUP-7245', 'https://github.com/puppetlabs/puppet/pull/5657', '2017-02-21T19:35:56.000-0800', '2017-03-01T19:50:20.000-0800', '2017-03-01T19:50:20.000-0800', 'Resolved', '', 2, '0', 2, 11, 9, 1, '0556f4d86be9246990437944853f93bf9ffcca93', 'https://tickets.puppetlabs.com/browse/PUP-7245', 'https://github.com/puppetlabs/puppet/pull/5657'),
('puppet', 175270, 105956510, 5639, 'PUP-6663 causes a regression of PUP-535', 'As exemplified in the output of the two beaker runs here: [https://gitlab.com/simp/pupmod-simp-rsync/pipelines/6452666], one with agent 1.7.1 and one with agent 1.9.1, when attempting to execute the following manifest:\r\n\r\n{noformat}\r\npackage { "rsyslog.x86_64": ensure => absent, provider => rpm }\r\n{noformat}\r\n\r\nwhen you attempt to run on a rhel7 vm:\r\n\r\n{noformat}\r\nError: Execution of "/bin/rpm -e --nodeps "rsyslog-5.8.10-10.el6_6.x86_64" returned 1: error: package "rsyslog-5.8.10-10.el6_6.x86_64 is not installed\r\n  Error: /Stage[main]/Rsyslog::Install/Package[rsyslog.x86_64]/ensure: change from 5.8.10-10.el6_6 to absent failed: Execution of "/bin/rpm -e --nodeps "rsyslog-5.8.10-10.el6_6.x86_64" returned 1: error: package "rsyslog-5.8.10-10.el6_6.x86_64 is not installed\r\n  Notice: /Stage[main]/Rsyslog::Install/Package[rsyslog7.x86_64]: Dependency Package[rsyslog.x86_64] has failures: true\r\n{noformat}\r\n\r\nwhen running a debugging session, I can confirm the error is during the self.class.nevra_to_hash(output) on line 124:\r\n{noformat}\r\n[2] pry(#<Puppet::Type::Package::ProviderYum>)> output\r\n=> ""rsyslog 0 7.4.7 16.el7 x86_64\n""\r\n[3] pry(#<Puppet::Type::Package::ProviderYum>)> self.class.nevra_to_hash(output)\r\n=> {:name=>""rsyslog", :epoch=>"0", :version=>"7.4.7", :release=>"16.el7", :arch=>"x86_64", :provider=>:yum, :ensure=>"7.4.7-16.el7"}\r\n[4] pry(#<Puppet::Type::Package::ProviderYum>)>\r\n{noformat}\r\n\r\nThis seems to have been introduced in PUP-6663 where single quotes were added around the version.', 'https://tickets.puppetlabs.com/browse/PUP-7214', 'https://github.com/puppetlabs/puppet/pull/5639', '2017-02-13T10:25:16.000-0800', '2017-03-02T17:21:45.000-0800', '2017-03-02T17:21:45.000-0800', 'Closed', 'flanders-ss', 7, '0', 1, 3, 2, 2, '624e19ffb510f4d3f539a0ad843c28de534e56fd', 'https://tickets.puppetlabs.com/browse/PUP-7214', 'https://github.com/puppetlabs/puppet/pull/5639'),
('puppet', 175738, 107150561, 5652, 'glob/globs in hiera 5 does not work (no implicit conversion of String into Integer)', 'Hi,\r\n\r\ni"m currently migrate from hiera 3 to hiera 5. I want to use new features like glob/globs. hiere is my test hiera config:\r\n\r\n\r\n{code:java}\r\n---\r\nversion: 5\r\n\r\ndefaults:\r\n  datadir: "/etc/puppetlabs/code/environments/"\r\n  data_hash: yaml_data\r\n\r\nhierarchy:\r\n  - name: "Puppet Common"\r\n    globs:\r\n      - "%{environment}/hiera/common/*.yaml"\r\n\r\n  - name: "Puppet Common"\r\n    paths:\r\n      - "%{environment}/hiera/common.yaml"\r\n{code}\r\n\r\nAny lookup related calls will result into an error:\r\n\r\n\r\n{code:java}\r\npuppet lookup --hiera_config /etc/puppetlabs/puppet/hiera.yaml.glob profile::yumrepo::groups --environment fix_puppet --merge unique  --trace\r\nError: Could not run: no implicit conversion of String into Integer\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/location_resolver.rb:39:in `glob"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/location_resolver.rb:39:in `glob"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/location_resolver.rb:39:in `block in expand_globs"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/location_resolver.rb:37:in `map"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/location_resolver.rb:37:in `expand_globs"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/hiera_config.rb:518:in `block in create_configured_data_providers"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/hiera_config.rb:499:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/hiera_config.rb:499:in `create_configured_data_providers"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/hiera_config.rb:163:in `configured_data_providers"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:83:in `data_providers"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:44:in `block in unchecked_key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:112:in `with"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/configured_data_provider.rb:42:in `unchecked_key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/global_data_provider.rb:26:in `unchecked_key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb:45:in `block in key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:73:in `check"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/data_provider.rb:45:in `key_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:72:in `lookup_global"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:227:in `block in do_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:129:in `block (3 levels) in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:128:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:128:in `block (2 levels) in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:126:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:126:in `reduce"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:126:in `block in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:112:in `with"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/merge_strategy.rb:125:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:227:in `do_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:61:in `block (2 levels) in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:112:in `with"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:61:in `block in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/invocation.rb:58:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup/lookup_adapter.rb:50:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:76:in `search_and_merge"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `block (2 levels) in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:31:in `block in lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `reduce"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:29:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/lookup.rb:298:in `block in main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/lookup.rb:342:in `block in generate_scope"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:204:in `block in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:293:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:162:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/lookup.rb:342:in `generate_scope"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/lookup.rb:294:in `main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:352:in `run_command"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:541:in `exit_on_fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:132:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>"\r\n{code}\r\n\r\n--compile does not matter here. If I remove the glob setting, the lookup will work again.', 'https://tickets.puppetlabs.com/browse/PUP-7235', 'https://github.com/puppetlabs/puppet/pull/5652', '2017-02-20T10:51:55.000-0800', '2017-03-03T10:36:24.000-0800', '2017-03-03T10:36:24.000-0800', 'Closed', 'flanders-ss', 2, '0', 1, 68, 3, 2, 'acac28c52932797e77c6e967a19c45d65d7f2e08', 'https://tickets.puppetlabs.com/browse/PUP-7235', 'https://github.com/puppetlabs/puppet/pull/5652'),
('puppet', 153533, 95099239, 5394, 'When `recurse => true` is used in a file resource, tags are not applied to all recursive objects.', 'In the case where `recurse => true" is added to a file resource which is actually a directory with a whole bunch of files in it, it appears that not all these files get tagged with either the default tags for the class/resource or with custom tags specified in the resource declaration.\n\nIf these tags are then used later in a puppet run using --tags, the resource is not included.\n\nAs an example, the following code will create a number of files in a directory, where the directory is marked as {{recurse => true}} and the resource is tagged with a tag {{sometag}}:\n\n{code} \nclass abc::component::ao { \ntag "sometag" \nfile { "/tmp/somefiles": \ntag => "sometag", \nensure => directory, \nsource => "puppet:///static/somefiles", \nrecurse => true, \npurge => true, \nowner => "root", \ngroup => "root", \n} \nexec { "do something": \ntag => "sometag", \ncommand => "/bin/echo do something", # 20 lines script \nrefreshonly => true, \nsubscribe => [ \nFile["/tmp/somefiles"], \n], \n} \n} \n{code}\n\nHowever, when {{puppet agent -t --tags sometag}} is run, the following is noted in the output:\n\n{code}\nNotice: /Stage[main]/Abc::Component::Ao/File[/ao/basescripts/su_stop.ksh]/ensure: defined content as "{md5}1fd97a2fc03e639946d960ebd13bebd8"\nDebug: /Stage[main]/Abc::Component::Ao/File[/ao/basescripts/su_stop.ksh]: The container /ao/basescripts will propagate my refresh event\nDebug: /ao/basescripts: Not tagged with sometag\nDebug: /ao/basescripts: Resource is being skipped, unscheduling all events\nInfo: /ao/basescripts: Unscheduling all events on /ao/basescripts\n{code}\n\nThis suggests that the tag was not set correctly on all files when the recurse was set and so the Exec is not refreshed.\n\nThe exact same code without the `recurse => true` works exactly as expected.\n\nIs this a bug, and is there a workaround for this issue?\n\nStefan', 'https://tickets.puppetlabs.com/browse/PUP-6741', 'https://github.com/puppetlabs/puppet/pull/5394', '2016-09-26T07:39:39.000-0700', '2017-03-07T14:27:25.000-0800', '2017-03-07T14:27:25.000-0800', 'Closed', '', 5, '0', 1, 92, 0, 3, '13daab496e75718a53e5bfd26924b5e0c77b2a1b', 'https://tickets.puppetlabs.com/browse/PUP-6741', 'https://github.com/puppetlabs/puppet/pull/5394'),
('puppet', 175422, 106290569, 5644, 'hiera_hash doesn"t use deeper merge', 'Apache modules which shall be used are defined with hiera files.\r\n\r\nModules which shall be used by all webservers are defined in the file Ubuntu.yaml.\r\nIn addition modules which are in the individual server configs (hostxyz.yaml) shall be used.\r\n\r\nUntil upgrade to 4.9.x everything worked fine.\r\nSince the upgrade the infomation from Ubuntu.yaml gets ignored if modules in a node.yaml are defined.\r\nThis causes that puppet removes the default modules and the webserver stops working.\r\n\r\nI could confirm, that deeper merge is basically working, but since the upgrade it seems it cannot handle this structured data.\r\n\r\n{code:java}\r\nprofiles:\r\n  webserver:\r\n    apache:\r\n      httpd:\r\n        modules:\r\n          - mpm_prefork\r\n          - php\r\n          - ssl\r\n{code}\r\n\r\nIf no modules are defined in nodexyz.yaml I get in this basic demonstrator class (init.pp):\r\n{code:java}\r\nsudo puppet agent -t -v\r\nNotice: Apache mod: auth_kerb\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: auth_kerb]/message: defined "message" as "Apache mod: auth_kerb"\r\nNotice: Apache mod: authnz_ldap\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: authnz_ldap]/message: defined "message" as "Apache mod: authnz_ldap"\r\nNotice: Apache mod: cgid\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: cgid]/message: defined "message" as "Apache mod: cgid"\r\nNotice: Apache mod: status\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: status]/message: defined "message" as "Apache mod: status"\r\nNotice: Applied catalog in 3.65 seconds\r\n{code}\r\n\r\nAs soon as I enable a module in nodexyz.yaml I get:\r\n\r\n{code:java}\r\nNotice: Apache mod: mpm_prefork\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: mpm_prefork]/message: defined "message" as "Apache mod: mpm_prefork"\r\nNotice: Apache mod: php\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: php]/message: defined "message" as "Apache mod: php"\r\nNotice: Apache mod: ssl\r\nNotice: /Stage[main]/Testmodule/Notify[Apache mod: ssl]/message: defined "message" as "Apache mod: ssl"\r\nNotice: Applied catalog in 3.46 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7216', 'https://github.com/puppetlabs/puppet/pull/5644', '2017-02-14T02:21:50.000-0800', '2017-03-08T07:22:36.000-0800', '2017-03-08T07:22:36.000-0800', 'Closed', 'flanders-ss', 7, '0', 1, 215, 99, 6, '0650a59ed544546aacc137eb1d4b680288853eaa', 'https://tickets.puppetlabs.com/browse/PUP-7216', 'https://github.com/puppetlabs/puppet/pull/5644'),
('puppet', 115228, 58369250, 4635, 'Lexer should raise a better error when loading manifest files containing a UTF-8 BOM (Byte Order Mark)', 'The current error message that Puppet propagates when lexing files that contain a leading UTF-8 BOM ({{0xFEFF}}) is {{Syntax error at "" at line 1:1}}.\r\n\r\nSaving a file with a UTF-8 BOM is rather common on Windows, and Puppet should be able to report a better error during the parsing phase that helps inform users of the appropriate action to take, given the parser cannot handle a BOM.  {{spec/unit/face/parser_spec.rb}} currently contains a test documenting the current behavior as part of https://github.com/puppetlabs/puppet/pull/4585/files\r\n\r\n\r\nNote - this does not impact loading of Ruby code from puppet modules.  Such loading uses the Ruby {{eval}} method after reading files from disk, and even if the content contains a leading BOM, Ruby does not have a problem parsing / executing the code.', 'https://tickets.puppetlabs.com/browse/PUP-5819', 'https://github.com/puppetlabs/puppet/pull/4635', '2016-02-04T09:42:45.000-0800', '2017-03-08T11:14:56.000-0800', '2017-03-08T11:14:56.000-0800', 'Closed', 'i18n;parser;utf-8;windows', 7, '0', 2, 117, 0, 4, 'baaf31de81c6c9cc692290ff54d8dca2c2f11e59', 'https://tickets.puppetlabs.com/browse/PUP-5819', 'https://github.com/puppetlabs/puppet/pull/4635'),
('puppet', 89917, 75492031, 5067, 'puppet describe -s ssh_authorized_key output is really bad', '{code}\r\nroot@master:~ # puppet describe -s ssh_authorized_key\r\n\r\nssh_authorized_key\r\n==================\r\nManages SSH authorized keys. Currently only type 2 keys are supported.\r\nIn their native habitat, SSH keys usually appear as a single long line. This\r\nresource type requires you to split that line into several attributes. Thus,\r\na\r\nkey that appears in your `~/.ssh/id_rsa.pub` file like this...\r\n    ssh-rsa\r\n...would translate to the following resource:\r\n...would translate to the following resource:\r\n...would translate to the following resource:\r\n...would translate to the following resource:\r\n...would translate to the following resource:\r\n...would translate to the following resource:\r\n...would translate to the following resource:\r\neMue6b3FtUdTDeyAYoTxrsRo/WnDkS6Pa3YhrFwjtUqXfdaQ==\r\nnick@magpie.puppetlabs.lan\r\n...would translate to the following resource:\r\n    ssh_authorized_key { "nick@magpie.puppetlabs.lan":\r\n      user => "nick",\r\n      type => "ssh-rsa",\r\n      key  =>\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\n    }\r\nBmuvPF1Mn3FwaFLjVsMT3GQeMue6b3FtUdTDeyAYoTxrsRo/WnDkS6Pa3YhrFwjtUqXfdaQ==",\r\n    }\r\nTo ensure that only the currently approved keys are present, you can purge\r\nunmanaged SSH keys on a per-user basis. Do this with the `user` resource\r\ntype"s `purge_ssh_keys` attribute:\r\n    user { "nick":\r\n      ensure         => present,\r\n      purge_ssh_keys => true,\r\n    }\r\nThis will remove any keys in `~/.ssh/authorized_keys` that aren"t being\r\nmanaged with `ssh_authorized_key` resources. See the documentation of the\r\n`user` type for more details.\r\n**Autorequires:** If Puppet is managing the user account in which this\r\nSSH key should be installed, the `ssh_authorized_key` resource will\r\nautorequire\r\nthat user.\r\n\r\n\r\nParameters\r\n----------\r\n    ensure, key, name, options, target, type, user\r\n\r\nProviders\r\n---------\r\n    parsed\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-4904', 'https://github.com/puppetlabs/puppet/pull/5067', '2015-07-20T10:00:13.000-0700', '2017-03-09T08:59:22.000-0800', '2017-03-09T08:59:22.000-0800', 'Closed', '', 1, '0', 1, 91, 1, 2, '85f7226e4239b395c89d4cc936fb05bf1209ce83', 'https://tickets.puppetlabs.com/browse/PUP-4904', 'https://github.com/puppetlabs/puppet/pull/5067'),
('puppet', 178229, 108908028, 5682, 'The eyaml lookup_key function does not evaluate interpolated hash keys', 'The eyaml backend, when finding an unencrypted hash, will only evaluate interpolations in the values of that hash. The keys are not evaluated. This is wrong. Both keys and values must be evaluated.', 'https://tickets.puppetlabs.com/browse/PUP-7296', 'https://github.com/puppetlabs/puppet/pull/5682', '2017-03-02T20:51:19.000-0800', '2017-03-10T06:29:49.000-0800', '2017-03-10T06:29:49.000-0800', 'Closed', '', 4, '0', 1, 8, 3, 2, '8d136e64da3506c8d47f661f32d2effbb7f618f2', 'https://tickets.puppetlabs.com/browse/PUP-7296', 'https://github.com/puppetlabs/puppet/pull/5682'),
('puppet', 178005, 109070490, 5684, 'no hiera class parameter lookup debug information', 'With puppet 4.9.x hiera class parameter lookups are no longer explained when debug is enabled. Explicit lookup calls are explained still.', 'https://tickets.puppetlabs.com/browse/PUP-7291', 'https://github.com/puppetlabs/puppet/pull/5684', '2017-03-02T02:16:05.000-0800', '2017-03-10T06:29:50.000-0800', '2017-03-10T06:29:50.000-0800', 'Closed', '', 5, '0', 1, 37, 1, 2, '39d4a9bf761ddd5247ff1b78d60ba752825b5dd4', 'https://tickets.puppetlabs.com/browse/PUP-7291', 'https://github.com/puppetlabs/puppet/pull/5684'),
('puppet', 177802, 108595271, 5672, 'Mute explain output during check for stable Hiera configuration', 'The internal scope lookups, made by the logic that checks if a Hiera configuration is stable, generates unwanted explain output if explain or debug logging is enabled. It only happens for interpolations using dotted keys.', 'https://tickets.puppetlabs.com/browse/PUP-7287', 'https://github.com/puppetlabs/puppet/pull/5672', '2017-03-01T09:17:51.000-0800', '2017-03-10T06:29:50.000-0800', '2017-03-10T06:29:50.000-0800', 'Closed', '', 2, '0', 2, 37, 7, 3, 'cfafca3cf421bb19f5b50c3425a6c740fb84fb0f', 'https://tickets.puppetlabs.com/browse/PUP-7287', 'https://github.com/puppetlabs/puppet/pull/5672'),
('puppet', 178019, 108777445, 5679, 'hiera 5 regression in puppet 4.9.0 causes interpolation in options to stop working', 'Hiera 5 in Puppet 4.9.0-4.9.3 has a regression for hiera.yaml (all versions) where interpolation of values into options stopped working.', 'https://tickets.puppetlabs.com/browse/PUP-7293', 'https://github.com/puppetlabs/puppet/pull/5679', '2017-03-02T05:48:53.000-0800', '2017-03-10T06:29:51.000-0800', '2017-03-10T06:29:51.000-0800', 'Closed', 'regression', 4, '0', 3, 39, 6, 2, 'd426fec78aac3788dbbb85b76c4a5eeb92631fb6', 'https://tickets.puppetlabs.com/browse/PUP-7293', 'https://github.com/puppetlabs/puppet/pull/5679'),
('puppet', 177653, 108494879, 5669, 'hiera-eyaml option "extension" is ignored', 'The option _:extension: "yaml"_ from the hiera eyaml backend is ignored with puppet 4.9.x and files with the extension "eyaml" are searched during key lookups. Worked without problems with puppet 4.8.x', 'https://tickets.puppetlabs.com/browse/PUP-7284', 'https://github.com/puppetlabs/puppet/pull/5669', '2017-02-28T13:32:19.000-0800', '2017-03-10T06:29:51.000-0800', '2017-03-10T06:29:51.000-0800', 'Closed', '', 10, '0', 1, 52, 14, 2, '239c2e9f31b3ba20eafbf902f6ff45413df506fc', 'https://tickets.puppetlabs.com/browse/PUP-7284', 'https://github.com/puppetlabs/puppet/pull/5669'),
('puppet', 177773, 108741578, 5677, 'hiera array merge behaviour changed', 'We still use the hiera version 3 (i.e. unversioned/classic) hiera.yaml format.\r\n\r\nWith puppet 4.8.x and older versions class parameter lookups in hiera had the default merge behavior "first", even if the option "merge_behavior" "deep" was active. With puppet 4.9.x class parameters of type array are now merged if the option "merge_behavior" "deep" is active.\r\n\r\nA simple reproducer:\r\n\r\n{code:title=hiera.yaml}\r\n---\r\n:backends:\r\n  - yaml\r\n:hierarchy:\r\n  - lvl1\r\n  - lvl2\r\n\r\n:yaml:\r\n  :datadir: "."\r\n\r\n:merge_behavior: deep\r\n{code}\r\n\r\n{code:title=lvl1.yaml}\r\ntclass::test:\r\n  - lvl1\r\n{code}\r\n\r\n{code:title=lvl2.yaml}\r\ntclass::test:\r\n  - lvl2\r\n{code}\r\n\r\n{code:title=test.pp}\r\nclass tclass (\r\n  $test = false,\r\n) {\r\n  notice($test)\r\n}\r\n\r\ninclude tclass\r\n{code}\r\n\r\nwith puppet 4.9.3:\r\n{noformat}\r\npuppet apply --hiera_config=hiera.yaml test.pp\r\nNotice: Scope(Class[Tclass]): [lvl1, lvl2]\r\n{noformat}\r\n\r\nwith puppet 4.8.0:\r\n{noformat}\r\npuppet apply --hiera_config=hiera.yaml test.pp\r\nNotice: Scope(Class[Tclass]): [lvl1]\r\n{noformat}\r\n\r\nif merge_behavior deep is removed from hiera.yaml, then puppet 4.9.3 behaves like puppet 4.8.0.', 'https://tickets.puppetlabs.com/browse/PUP-7286', 'https://github.com/puppetlabs/puppet/pull/5677', '2017-03-01T08:03:25.000-0800', '2017-03-10T06:29:51.000-0800', '2017-03-10T06:29:51.000-0800', 'Closed', '', 7, '0', 1, 128, 74, 4, 'c6cf8d8cf7a9534062a04046f9bc1870febb1fb8', 'https://tickets.puppetlabs.com/browse/PUP-7286', 'https://github.com/puppetlabs/puppet/pull/5677'),
('puppet', 127903, 67553894, 4907, 'Acceptance: netconsole symlink validation fails on Scientific 6', 'On Scientific Linux 6, the following test fails because the test assumes that the generated run order number will be "50".\r\n\r\nThe test needs to be refactored to accommodate other run orders than "50".\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/3.x/acceptance/tests/resource/service/ticket_1343_should_add_and_remove_symlinks.rb\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6228', 'https://github.com/puppetlabs/puppet/pull/4907', '2016-04-22T10:55:31.000-0700', '2017-03-10T06:50:09.000-0800', '2017-03-10T06:50:09.000-0800', 'Closed', '', 1, '0', 1, 2, 4, 1, '438214c285d9318fcab050a1d20fc7cdd95918d5', 'https://tickets.puppetlabs.com/browse/PUP-6228', 'https://github.com/puppetlabs/puppet/pull/4907'),
('puppet', 24035, 12576110, 2360, 'user resource fails on UTF-8 comment', 'Setting the gecos/comment field in a local user on debian wheezy with puppet 3.4.2-1puppetlabs1 fails with an ugly error about utf-8 encodings.\r\n\r\nAs this system is completely utf-8 there is no reason that this should be an invalid value, as can be seen by "puppet resource" and "getent passwd" displaying the value without problems.\r\n\r\n{code}\r\nroot@puppetmaster:~# echo ü | od -ab\r\n0000000   C   <  nl\r\n        303 274 012\r\n0000003\r\nroot@puppetmaster:~# getent passwd david | od -ab\r\n0000000   d   a   v   i   d   :   x   :   1   0   0   1   :   1   0   0\r\n        144 141 166 151 144 072 170 072 061 060 060 061 072 061 060 060\r\n0000020   2   :   D   a   v   i   d  sp   S   c   h   m   i   t   t  sp\r\n        062 072 104 141 166 151 144 040 123 143 150 155 151 164 164 040\r\n0000040   w   i   t   h  sp   C   <   :   /   h   o   m   e   /   d   a\r\n        167 151 164 150 040 303 274 072 057 150 157 155 145 057 144 141\r\n0000060   v   i   d   :   /   b   i   n   /   b   a   s   h  nl\r\n        166 151 144 072 057 142 151 156 057 142 141 163 150 012\r\n0000076\r\nroot@puppetmaster:~# puppet resource user david | grep comment | od -ab\r\n0000000  sp  sp   c   o   m   m   e   n   t  sp  sp  sp  sp  sp  sp  sp\r\n        040 040 143 157 155 155 145 156 164 040 040 040 040 040 040 040\r\n0000020  sp  sp  sp   =   >  sp   "   D   a   v   i   d  sp   S   c   h\r\n        040 040 040 075 076 040 047 104 141 166 151 144 040 123 143 150\r\n0000040   m   i   t   t  sp   w   i   t   h  sp   C   <   "   ,  nl\r\n        155 151 164 164 040 167 151 164 150 040 303 274 047 054 012\r\n0000057\r\nroot@puppetmaster:~# echo "user {foo: comment => "ü"}" | od -ab\r\n0000000   u   s   e   r  sp   {   f   o   o   :  sp   c   o   m   m   e\r\n        165 163 145 162 040 173 146 157 157 072 040 143 157 155 155 145\r\n0000020   n   t  sp   =   >  sp   "   C   <   "   }  nl\r\n        156 164 040 075 076 040 042 303 274 042 175 012\r\n0000034\r\nroot@puppetmaster:~# echo "user {foo: comment => "ü"}" | puppet apply\r\nNotice: Compiled catalog for puppetmaster.example.org in environment production in 0.07 seconds\r\nError: Parameter comment failed on User[foo]: Munging failed for value "ü" in class comment: U+00FC from UTF-8 to ASCII-8BIT at line 1\r\nWrapped exception:\r\nMunging failed for value "ü" in class comment: U+00FC from UTF-8 to ASCII-8BIT\r\nroot@puppetmaster:~# locale\r\nLANG=en_US.UTF-8\r\nLANGUAGE=en_US:en\r\nLC_CTYPE="en_US.UTF-8"\r\nLC_NUMERIC="en_US.UTF-8"\r\nLC_TIME="en_US.UTF-8"\r\nLC_COLLATE="en_US.UTF-8"\r\nLC_MONETARY="en_US.UTF-8"\r\nLC_MESSAGES="en_US.UTF-8"\r\nLC_PAPER="en_US.UTF-8"\r\nLC_NAME="en_US.UTF-8"\r\nLC_ADDRESS="en_US.UTF-8"\r\nLC_TELEPHONE="en_US.UTF-8"\r\nLC_MEASUREMENT="en_US.UTF-8"\r\nLC_IDENTIFICATION="en_US.UTF-8"\r\nLC_ALL=\r\nroot@puppetmaster:~#\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1473', 'https://github.com/puppetlabs/puppet/pull/2360', '2014-01-20T00:31:08.000-0800', '2017-03-13T11:07:37.000-0700', '2017-03-13T11:07:37.000-0700', 'Closed', '', 18, '0', 2, 8, 6, 2, '065c4f5b5c78ca8f16c189b55051681beb1c5052', 'https://tickets.puppetlabs.com/browse/PUP-1473', 'https://github.com/puppetlabs/puppet/pull/2360'),
('puppet', 177829, 108659346, 5674, 'PUP 4.9.3 interpolation in hiera.yaml datadir stopped working', 'After the latest upgrade Hiera support does NOT work at all. \r\n\r\nConfigured as follows: \r\n{{/etc/puppetlabs/puppet/hiera.yaml}} (v3):\r\n{code:java}\r\n---\r\n:backends:\r\n  - yaml\r\n:hierarchy:\r\n  - "nodes/%{::trusted.certname}"\r\n  - "roles/%{::role}"\r\n  - "virtual_%{::is_virtual}"\r\n  - "os_%{::operatingsystem}"\r\n  - "env_%{environment}"\r\n  - common\r\n\r\n:logger: console\r\n# options are native, deep, deeper\r\n:merge_behavior: deeper\r\n:deep_merge_options:\r\n  :merge_hash_arrays: true\r\n  :unpack_arrays: true\r\n#  :preserve_unmergeables: true\r\n#  :knockout_prefix: "--"\r\n\r\n:yaml:\r\n# datadir is empty here, so hiera uses its defaults:\r\n# - /etc/puppetlabs/code/environments/%{environment}/hieradata on *nix\r\n# - %CommonAppData%\PuppetLabs\code\environments\%{environment}\hieradata on Windows\r\n# When specifying a datadir, make sure the directory exists.\r\n  :datadir: /etc/puppetlabs/code/environments/%{environment}/hieradata\r\n{code}\r\n\r\n{{/etc/puppetlabs/code/hiera.yaml}} (v5):\r\n{code:java}\r\n---\r\nversion: 5\r\n\r\ndefaults:\r\n  #  datadir: /etc/puppetlabs/code/environments/%{environment}/hieradata\r\n  datadir: data\r\n  data_hash: yaml_data\r\n\r\nhierarchy:\r\n  - name: "Nodes"\r\n    path: "nodes/%{::trusted.certname}.yaml"\r\n  - name: "Roles"\r\n    path: "roles/%{::role}.yaml"\r\n  - name: "Vurtual"\r\n    path: "virtual_%{::is_virtual}.yaml"\r\n  - name: "OS"\r\n    path: "os_%{::operatingsystem}.yaml"\r\n  - name: "Environment"\r\n    path: "env_%{environment}.yaml"\r\n  - name: "Common Defaults"\r\n    path: "common.yaml"\r\n{code}\r\n\r\n\r\n{{/etc/puppetlabs/code/environments/corporate/manifests/site.pp}}:\r\n\r\nBefore the upgrade it had only one line and everything was fine:\r\n{code:java}\r\nhiera_include("classes")\r\n{code}\r\n\r\nAs per documentation, tried the following after the upgrade ("either or" and both blocks):\r\n{code:java}\r\ninclude lookup("classes", { "merge" => "deep" })\r\n{code}\r\n\r\n{code}\r\nlookup("classes", Array[String], "deep").include\r\nlookup({ "name"  => "classes",\r\n         "merge" => {\r\n            "strategy"          => "deep",\r\n            "merge_hash_arrays" => true,\r\n        },\r\n})\r\n{code}\r\n\r\n\r\nWhen running agent getting:\r\n\r\n{code:java}\r\n> sudo puppet agent -t\r\nInfo: Using configured environment "corporate"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Function lookup() did not find a value for the name "classes" on node <host>\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{code}\r\n\r\nand more in {{/var/log/puppetlabs/puppetserver/puppetserver.log}}:\r\n{code:java}\r\n2017-03-01 11:01:42,365 ERROR [qtp1371536656-79] [puppetserver] Puppet Function lookup() did not find a value for the name "classes"\r\n2017-03-01 11:01:42,365 ERROR [qtp1371536656-79] [puppetserver] Puppet Function lookup() did not find a value for the name "classes" on node <host>\r\n2017-03-01 11:01:42,365 ERROR [qtp1371536656-79] [puppetserver] Puppet Server Error: Function lookup() did not find a value for the name "classes" on node <host>\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:86:in `fail_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/lookup.rb:57:in `lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/lookup.rb:209:in `do_lookup"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/loader/../../../puppet/functions/lookup.rb:205:in `lookup_5"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatch.rb:47:in `invoke"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:36:in `dispatch"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/dispatcher.rb:35:in `dispatch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:46:in `call"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/functions/function.rb:45:in `call"\r\n/etc/puppetlabs/code/environments/corporate/manifests/site.pp:1:in `call_function"\r\n{code}\r\n\r\n\r\nPlease advise. ', 'https://tickets.puppetlabs.com/browse/PUP-7289', 'https://github.com/puppetlabs/puppet/pull/5674', '2017-03-01T10:24:39.000-0800', '2017-03-14T10:53:23.000-0700', '2017-03-14T10:53:23.000-0700', 'Closed', 'flanders-ss;regression', 34, '0', 1, 3, 1, 2, '4c2b823aed131387059e444a0bdcf62244916fd7', 'https://tickets.puppetlabs.com/browse/PUP-7289', 'https://github.com/puppetlabs/puppet/pull/5674'),
('puppet', 180216, 110536767, 5715, 'Create acceptance test for PUP-5058', 'Create an acceptance test confirming that Puppet can manage SSH keys on OS X 10.9, 10.10, and 10.11 -- the location of ssh_known_hosts moved from /etc/ to /etc/ssh in OS X 10.11.', 'https://tickets.puppetlabs.com/browse/PUP-7342', 'https://github.com/puppetlabs/puppet/pull/5715', '2017-03-13T09:33:13.000-0700', '2017-03-16T09:26:44.000-0700', '2017-03-16T09:26:44.000-0700', 'Closed', '', 0, '0', 1, 72, 0, 1, '801542e53b6f7e7d5edcaea46590139cb42a2949', 'https://tickets.puppetlabs.com/browse/PUP-7342', 'https://github.com/puppetlabs/puppet/pull/5715'),
('puppet', 168203, 99768330, 5454, 'Test utf8_user_comments.rb fails to create user with UTF-8 comment on AIX', 'The user provider on AIX (5.3 at least) fails to create user with a UTF-8 GECOS string. The complaint is that the user name is too long. From tests/resource/user/utf8_user_comments.rb:\r\n{code}\r\n            pe-aix-53-acceptance.delivery.puppetlabs.net (pe-aix-53-acceptance) 02:48:42$ env LANG="POSIX" puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.7956\r\n              Notice: Compiled catalog for pe-aix-53-acceptance.delivery.puppetlabs.net in environment production in 0.11 seconds\r\n              Info: Applying configuration version "1483094925"\r\n              Error: Could not create user quux94122: Execution of "/usr/bin/mkuser gecos=Aۿ quux94122" returned 86: Error adding "quux94122" : Name is too long.\r\n              Error: /Stage[main]/Main/User[quux94122]/ensure: change from absent to present failed: Could not create user quux94122: Execution of "/usr/bin/mkuser gecos=Aۿ quux94122" returned 86: Error adding "quux94122" : Name is too long.\r\n              Notice: Applied catalog in 0.48 seconds\r\n            \r\n            pe-aix-53-acceptance.delivery.puppetlabs.net (pe-aix-53-acceptance) executed in 4.13 seconds\r\n            Exited: 4\r\n            Beaker::Host::CommandFailure: Host "pe-aix-53-acceptance.delivery.puppetlabs.net" exited with 4 running:\r\n             env LANG="POSIX" puppet apply --verbose --detailed-exitcodes /tmp/apply_manifest.pp.7956\r\n{code}\r\nSee\r\n* https://jenkins.puppetlabs.com/user/kurt.wall/my-views/view/puppet-agent%20master%20Manual%20Pipeline/job/platform_puppet-agent_intn-van-sys_suite-manual-puppet-master/SLAVE_LABEL=beaker,TEST_TARGET=aix-53-power/66/ \r\n* https://jenkins.puppetlabs.com/user/kurt.wall/my-views/view/puppet-agent%20master%20Manual%20Pipeline/job/platform_puppet-agent_intn-van-sys_suite-manual-puppet-master/SLAVE_LABEL=beaker,TEST_TARGET=aix-71-power/66/', 'https://tickets.puppetlabs.com/browse/PUP-7053', 'https://github.com/puppetlabs/puppet/pull/5454', '2016-12-30T06:05:37.000-0800', '2017-03-22T10:58:22.000-0700', '2017-03-22T10:58:22.000-0700', 'Closed', '', 8, '0', 1, 1, 1, 1, '69808e4b97a3564bb15e5cdbc41c0f359d7d0f13', 'https://tickets.puppetlabs.com/browse/PUP-7053', 'https://github.com/puppetlabs/puppet/pull/5454'),
('puppet', 70686, 0, 0, 'Investigate Debian 6 32 bit AIO acceptance failure', 'When testing the new Debian puppet-agent packages, I ran into a single acceptance failure when running against Debian 6 32 bit:\r\n\r\n{noformat}\r\n              - Test Case Summary for suite "tests" -\r\n       Total Suite Time: 9743.20 seconds\r\n      Average Test Time: 32.16 seconds\r\n              Attempted: 303\r\n                 Passed: 250\r\n                 Failed: 1\r\n                Errored: 0\r\n                Skipped: 51\r\n                Pending: 1\r\n                  Total: 303\r\n\r\n      - Specific Test Case Status -\r\n\r\nFailed Tests Cases:\r\n  Test Case ./tests/resource/file/source_attribute.rb reported: #<Beaker::DSL::Outcomes::FailTest:\r\nShould have updated files.\r\nExpected /File\[\/tmp\/source_attr_testctime\]\/content: content changed/ to match "\e[0;32mInfo: Retrieving pluginfacts\e[0m\n\e[0;32mInfo:\r\nRetrieving plugin\e[0m\n\e[0;32mInfo: Caching catalog for l5pmpgvrigmnw4g.delivery.puppetlabs.net\e[0m\n\e[0;32mInfo: Applying\r\nconfiguration version "1425684660"\e[0m\n\e[mNotice: Applied catalog in 0.62 seconds\e[0m\n".\r\n>\r\n{noformat}\r\n\r\nThis was using the following config:\r\n\r\n{noformat}\r\nHOSTS:\r\n  master:\r\n    roles:\r\n      - master\r\n      - agent\r\n    platform: el-7-x86_64\r\n    hypervisor: vcloud\r\n    template: redhat-7-x86_64\r\n    puppetcodedir: /etc/puppetlabs/code\r\n    distmoduledir: /etc/puppetlabs/code/modules\r\n    hieraconf:     /etc/puppetlabs/code/hiera.yaml\r\n    puppetconfdir: /etc/puppetlabs/puppet\r\n    puppetserver-confdir: /etc/puppetlabs/puppetserver/conf.d\r\n    puppetbindir:  /opt/puppetlabs/puppet/bin\r\n    puppetvardir:  /opt/puppetlabs/puppet/cache\r\n    sitemoduledir: /opt/puppetlabs/puppet/modules\r\n  agent:\r\n    roles:\r\n      - agent\r\n    platform: debian-squeeze-i386\r\n    hypervisor: vcloud\r\n    template: debian-6-i386\r\n    puppetcodedir: /etc/puppetlabs/code\r\n    distmoduledir: /etc/puppetlabs/code/modules\r\n    hieraconf:     /etc/puppetlabs/code/hiera.yaml\r\n    puppetconfdir: /etc/puppetlabs/puppet\r\n    puppetbindir:  /opt/puppetlabs/puppet/bin\r\n    puppetvardir:  /opt/puppetlabs/puppet/cache\r\n    sitemoduledir: /opt/puppetlabs/puppet/modules\r\nCONFIG:\r\n  datastore: instance0\r\n  resourcepool: delivery/Quality Assurance/FOSS/Dynamic\r\n  folder: Delivery/Quality Assurance/FOSS/Dynamic\r\n  pooling_api: http://vmpooler.delivery.puppetlabs.net/\r\n{noformat}\r\n\r\nwith:\r\n\r\n{{bundle exec rake ci:test:aio SHA=2980644d9cc4d70ba042c74624f2bfd9b1e26af2 TESTS=./tests CONFIG=./config/nodes/squeeze32.yaml}}', 'https://tickets.puppetlabs.com/browse/PUP-4115', '', '2015-03-06T21:56:54.000-0800', '2017-03-23T15:26:15.000-0700', '2017-03-23T15:26:15.000-0700', 'Resolved', 'AIO', 8, '0', 0, 0, 0, 0, '8e30846ca58afa8ab6f732e037efc193fb10bca3', 'https://tickets.puppetlabs.com/browse/PUP-4115', 'https://github.com/puppetlabs/puppet/commit/8e30846ca58afa8ab6f732e037efc193fb10bca3'),
('puppet', 45732, 19300326, 2936, 'Puppet service hangs when attempting to stop on Windows', 'There is a race condition in the Puppet service code that prevents it from properly stopping.\r\n\r\nGenerally speaking this can be reproduced by installing from the MSI, then attempting to upgrade / remove the MSI shortly thereafter.\r\n\r\nIn the wild, we"ve noticed it can be either {{puppet}} / {{pe-puppet}} or {{mcollective}} / {{pe-mcollective}}, so the service code for puppet and mcollective should both be addressed.\r\n\r\nThis has also been experienced in the Azure environment, where the Azure extension handler code addresses this by force stopping the service process by PID if the service doesn"t exit gracefully.\r\nhttps://github.com/puppetlabs/azure-extension-handler/blob/master/installer/windows.ps1#L137-L149', 'https://tickets.puppetlabs.com/browse/PUP-2987', 'https://github.com/puppetlabs/puppet/pull/2936', '2014-07-29T10:55:54.000-0700', '2017-03-24T13:47:19.000-0700', '2017-03-24T13:47:19.000-0700', 'Closed', 'windows', 7, '0', 2, 37, 22, 1, '3ec567300ef18d04fc2cb3a62297705aae4ce07e', 'https://tickets.puppetlabs.com/browse/PUP-2987', 'https://github.com/puppetlabs/puppet/pull/2936'),
('puppet', 182310, 112357313, 5759, 'Acceptance: Create test verifying that stopping the puppet service on Windows does', 'PUP-2987 fixed a set of corner cases in the puppet service on Windows in which the service would hang instead of stopping. This ticket tracks creating an acceptance test to verify this behavior.', 'https://tickets.puppetlabs.com/browse/PUP-7392', 'https://github.com/puppetlabs/puppet/pull/5759', '2017-03-23T11:32:41.000-0700', '2017-03-24T14:07:12.000-0700', '2017-03-24T14:07:12.000-0700', 'Closed', '', 0, '0', 1, 47, 0, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-7392', 'https://github.com/puppetlabs/puppet/pull/5759'),
('puppet', 42858, 18611270, 2890, 'OS X package is broken on Ruby 1.8', 'This is an issue in the PUP project to track an issue currently residing in the Community Package Repository project. See the linked ticket.', 'https://tickets.puppetlabs.com/browse/PUP-2956', 'https://github.com/puppetlabs/puppet/pull/2890', '2014-07-18T14:59:13.000-0700', '2017-03-30T23:16:26.000-0700', '2017-03-30T23:16:26.000-0700', 'Closed', '', 0, '0', 1, 20, 0, 2, '', 'https://tickets.puppetlabs.com/browse/PUP-2956', 'https://github.com/puppetlabs/puppet/pull/2890'),
('puppet', 123396, 0, 0, 'Lookup should parse dot in key consistently throughout', 'Lookup and Hiera treats dotted keys differently. While hiera will recognize them everywhere (except when they are quoted), the Puppet lookup will only recognized them within interpolations that in turn, are only recognized by the Hiera Data Provider. For the sake of consistency, lookup should instead do what Hiera does.\r\n\r\nThis means that:\r\n* the command line {{lookup}} should be made consistent with hiera and facter tools as they take unquoted input as sub-lookup, and handles quoted input as verbatim.\r\n* interpolation expressions should be recognized by all data providers, not just the Hiera data provider\r\n* dotted keys that are not quoted, should be parsed at all times, not just in interpolations', 'https://tickets.puppetlabs.com/browse/PUP-6091', '', '2016-03-24T07:26:44.000-0700', '2017-03-31T13:42:27.000-0700', '2017-03-31T13:42:27.000-0700', 'Closed', '', 17, '0', 0, 0, 0, 0, '087312f99e1e45733bec09f5a61f9fa7f1b70874', 'https://tickets.puppetlabs.com/browse/PUP-6091', 'https://github.com/puppetlabs/puppet/commit/087312f99e1e45733bec09f5a61f9fa7f1b70874'),
('puppet', 27566, 78028149, 5126, 'File resource fails for root(/) directory.', 'I know this is probably an extreme edge case, but I recently noticed that this fails:\r\n\r\n{code}\r\nfile { "/": ensure => directory }\r\n\r\nwith the error:  Parameter path failed: File paths must be fully qualified, not "" at /tmp/test.pp:1\r\n{code}\r\n\r\nA little background, This comes from a larger module that I have which uses the lvm module to create additional or grow existing filesystems on a server. The file resource is used to make sure the mount point exists before using the mount resource to manage /etc/fstab and mount the filesystem. I noticed that if I tried to use my custom module to grow the root\(/) filesystem that I got the error above. Is the / being removed to make it an empty path as a result of some code to try and remove trailing slashes from paths?', 'https://tickets.puppetlabs.com/browse/PUP-1796', 'https://github.com/puppetlabs/puppet/pull/5126', '2014-02-27T14:30:04.000-0800', '2017-03-31T15:20:38.000-0700', '2017-03-31T15:20:38.000-0700', 'Closed', 'puppethack;redmine;type_file', 6, '0', 1, 15, 1, 2, '76a60ac544b3b5d9d0ebac3009e1a3a3e3912d6a', 'https://tickets.puppetlabs.com/browse/PUP-1796', 'https://github.com/puppetlabs/puppet/pull/5126'),
('puppet', 120580, 62308162, 4771, 'Recursive file resource in static catalog creates empty directory when source has trailing "/"', 'The agent strips trailing slashes when normalizing the source parameter, which causes it to not find the metadata in the catalog. ', 'https://tickets.puppetlabs.com/browse/PUP-6033', 'https://github.com/puppetlabs/puppet/pull/4771', '2016-03-09T12:14:56.000-0800', '2017-03-31T15:20:39.000-0700', '2017-03-31T15:20:39.000-0700', 'Closed', 'burnside-ss', 2, '0', 2, 56, 1, 3, 'c787a1ea9a559f6799a8675fd1b39222350584d6', 'https://tickets.puppetlabs.com/browse/PUP-6033', 'https://github.com/puppetlabs/puppet/pull/4771'),
('puppet', 153877, 87883989, 5312, 'regression: Code that doesn"t compile with app_management=false does with app_management=true', '[app_management|https://docs.puppet.com/puppet/latest/reference/configuration.html#appmanagement] defaults to false, but when set to true, code that didn"t compile previously now does.\r\n\r\ntest.pp\r\n{code:puppet}\r\n$dir="/tmp/test"\r\n$same_dir="/tmp/test/"\r\n\r\nfile {$dir:\r\n  ensure => directory\r\n}\r\n\r\nif !defined(File["${same_dir}"]) {\r\n  file { $same_dir:\r\n    ensure => directory\r\n  }\r\n}\r\n{code}\r\n\r\n{code}\r\nalex@alex-VirtualBox:~$ puppet --version\r\n4.7.0\r\n{code}\r\n\r\nRuns as expected:\r\n{code}\r\nalex@alex-VirtualBox:~$ puppet apply test.pp --noop\r\nNotice: Compiled catalog for alex-virtualbox.example.com in environment production in 0.09 seconds\r\nError: Cannot alias File[/tmp/test/] to ["/tmp/test"] at /home/alex/test.pp:9; resource ["File", "/tmp/test"] already declared at /home/alex/test.pp:4\r\n{code}\r\n\r\nRuns as expected:\r\n{code}\r\nalex@alex-VirtualBox:~$ puppet apply --no-app_management test.pp --noop\r\nNotice: Compiled catalog for alex-virtualbox.example.com in environment production in 0.09 seconds\r\nError: Cannot alias File[/tmp/test/] to ["/tmp/test"] at /home/alex/test.pp:9; resource ["File", "/tmp/test"] already declared at /home/alex/test.pp:4\r\n{code}\r\n\r\nFails by not flagging the error:\r\n{code}\r\nalex@alex-VirtualBox:~$ puppet apply --app_management test.pp --noop\r\nNotice: Compiled catalog for alex-virtualbox.example.com in environment production in 0.09 seconds\r\nNotice: /Stage[main]/Main/File[/tmp/test]/ensure: current_value absent, should be directory (noop)\r\nNotice: Class[Main]: Would have triggered "refresh" from 1 events\r\nNotice: Stage[main]: Would have triggered "refresh" from 1 events\r\n{code}\r\n\r\nThis is problematic as rspec-puppet now turns on this option even though most users will have it turned off.  Code that should fail for most users passes spec testing.\r\n\r\nSee https://github.com/rodjek/rspec-puppet/issues/417 and https://github.com/voxpupuli/puppet-staging/pull/113\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6752', 'https://github.com/puppetlabs/puppet/pull/5312', '2016-09-28T08:26:36.000-0700', '2017-03-31T15:20:39.000-0700', '2017-03-31T15:20:39.000-0700', 'Closed', 'maintenance', 9, '0', 1, 31, 4, 2, '0dbd5465ef9fe69f13503fd0949f0ba5e95466b4', 'https://tickets.puppetlabs.com/browse/PUP-6752', 'https://github.com/puppetlabs/puppet/pull/5312'),
('puppet', 173904, 104810629, 5615, 'PCore object default equality not working', 'When using [~thomas.hallgren]"s rich-data-wip [branch|https://github.com/thallgren/puppet/tree/rich-data-wip] PCore objects are not being properly checked for default equality:\r\n\r\n{noformat}\r\n17:43 $ DEVICE_IP=10.32.166.100 DEVICE_USER=root DEVICE_PASSWORD=lab bundle exec puppet apply 28.pp --modulepath ~/workspace/\r\nNotice: Compiled catalog for w541.shermdog.local in environment production in 0.20 seconds\r\nNotice: /Stage[main]/Main/Xe_ietf_diffserv_policy_pcore[prm-DSCP#QUEUING_O_1]/policy_entry: policy_entry changed "Vanilla_ice::Diffserv_policy::Policy_entry({\r\n  "policy_name" => "prm-DSCP#QUEUING_O_1",\r\n  "classifier_entry" => [\r\n    Vanilla_ice::Diffserv_policy::Classifier_entry({\r\n      "classifier_entry_name" => "class-default",\r\n      "classifier_action_entry_cfg" => [\r\n        Vanilla_ice::Diffserv_policy::Classifier_action_entry_cfg({\r\n          "action_type" => "action:min-rate",\r\n          "min_rate_cfg" => Vanilla_ice::Diffserv_policy::Min_rate_cfg({\r\n            "absolute_rate_metric" => "none",\r\n            "absolute_rate_units" => "bps",\r\n            "bw_excess_share_cfg" => Vanilla_ice::Diffserv_policy::Bw_excess_share_cfg({\r\n              "value" => 28,\r\n              "absolute_rate_metric" => "none",\r\n              "absolute_rate_units" => "perc"\r\n            })\r\n          })\r\n        })\r\n      ]\r\n    })\r\n  ]\r\n})" to "Vanilla_ice::Diffserv_policy::Policy_entry({\r\n  "policy_name" => "prm-DSCP#QUEUING_O_1",\r\n  "classifier_entry" => [\r\n    Vanilla_ice::Diffserv_policy::Classifier_entry({\r\n      "classifier_entry_name" => "class-default",\r\n      "classifier_action_entry_cfg" => [\r\n        Vanilla_ice::Diffserv_policy::Classifier_action_entry_cfg({\r\n          "action_type" => "action:min-rate",\r\n          "min_rate_cfg" => Vanilla_ice::Diffserv_policy::Min_rate_cfg({\r\n            "absolute_rate_metric" => "none",\r\n            "absolute_rate_units" => "bps",\r\n            "bw_excess_share_cfg" => Vanilla_ice::Diffserv_policy::Bw_excess_share_cfg({\r\n              "value" => 28,\r\n              "absolute_rate_metric" => "none",\r\n              "absolute_rate_units" => "perc"\r\n            })\r\n          })\r\n        })\r\n      ]\r\n    })\r\n  ]\r\n})"\r\nNotice: Applied catalog in 9.34 seconds\r\n{noformat}\r\n\r\nSample manifest and branch https://github.com/puppetlabs/vanilla_ice/blob/pcore/28.pp', 'https://tickets.puppetlabs.com/browse/PUP-7168', 'https://github.com/puppetlabs/puppet/pull/5615', '2017-02-02T15:45:06.000-0800', '2017-04-06T07:11:47.000-0700', '2017-04-06T07:11:47.000-0700', 'Closed', '', 0, '0', 1, 50, 2, 2, '36d98197a60d388cd47055ed3e413e77319dc37b', 'https://tickets.puppetlabs.com/browse/PUP-7168', 'https://github.com/puppetlabs/puppet/pull/5615'),
('puppet', 179398, 112119881, 5752, 'Duplication errors on Puppet Class "settings".', 'A user reports strange duplication errors for the "settings" class in PUP-6339. An investigation reveals that the errors stem from when the compiler initializes its scope. The fact that the actual scope is created from scratch during this initialization, combined with that several conflicts occur within milliseconds, seems to suggest that several threads are executing in in the same ruby runtime.\r\n\r\nThe conflicts go away if environment_timeout is set to 0.\r\n\r\nFrom the log:\r\n{code}\r\n2017-03-09 13:29:39,720 ERROR [qtp182348184-67 - /puppet/v3/catalog/lxserv940.smhi.se?environment=production] [puppetserver] Puppet Class "settings" is already defined; cannot redefine on node lxserv940.smhi.se\r\n2017-03-09 13:29:39,733 ERROR [qtp182348184-67 - /puppet/v3/catalog/lxserv940.smhi.se?environment=production] [puppetserver] Puppet Class "settings" is already defined; cannot redefine on node lxserv940.smhi.se\r\n2017-03-09 13:29:39,734 ERROR [qtp182348184-67 - /puppet/v3/catalog/lxserv940.smhi.se?environment=production] [puppetserver] Puppet Server Error: Class "settings" is already defined; cannot redefine on node lxserv940.smhi.se\r\n{code}\r\nHere is a stack backgrace (generated with {{strict=error}}).\r\n{code}\r\n2017-03-09 13:29:39,720 ERROR [qtp182348184-67 - /puppet/v3/catalog/lxserv940.smhi.se?environment=production] [puppetserver] Puppet Class "settings" is already defined; cannot redefine on node lxserv940.smhi.se\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/errors.rb:106:in `fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type_collection.rb:248:in `dupe_check"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type_collection.rb:68:in `add_hostclass"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type_collection.rb:60:in `add"\r\norg/jruby/RubyKernel.java:1242:in `catch"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type_collection.rb:59:in `add"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:857:in `create_settings_scope"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:168:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:168:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:293:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:162:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:266:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:264:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `benchmark"\r\n/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/META-INF/jruby.home/lib/ruby/1.9/benchmark.rb:295:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:262:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:53:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:121:in `do_find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:48:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:293:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/api/indirected_routes.rb:47:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:82:in `process"\r\norg/jruby/RubyArray.java:1613:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:81:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:87:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/route.rb:87:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:60:in `process"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/network/http/handler.rb:58:in `process"\r\nfile:/opt/puppetlabs/server/apps/puppetserver/puppet-server-release.jar!/puppetserver-lib/puppet/server/master.rb:42:in `handleRequest"\r\nPuppet$$Server$$Master_2107036556.gen:13:in `handleRequest"\r\nrequest_handler_core.clj:273:in `invoke"\r\njruby_request.clj:46:in `invoke"\r\njruby_request.clj:31:in `invoke"\r\nrequest_handler_service.clj:34:in `handle_request"\r\nrequest_handler.clj:3:in `invoke"\r\nrequest_handler.clj:3:in `invoke"\r\ncore.clj:2515:in `invoke"\r\nring_middleware.clj:284:in `invoke"\r\ncore.clj:168:in `invoke"\r\ncore.clj:211:in `invoke"\r\ncore.clj:45:in `invoke"\r\ncore.clj:343:in `invoke"\r\ncore.clj:51:in `invoke"\r\nringutils.clj:83:in `invoke"\r\nmaster_core.clj:428:in `invoke"\r\nring.clj:21:in `invoke"\r\nring.clj:12:in `invoke"\r\ncomidi.clj:249:in `invoke"\r\njetty9_core.clj:424:in `invoke"\r\nnormalized_uri_helpers.clj:80:in `invoke"\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7328', 'https://github.com/puppetlabs/puppet/pull/5752', '2017-03-09T06:20:03.000-0800', '2017-04-06T07:11:48.000-0700', '2017-04-06T07:11:48.000-0700', 'Closed', '', 5, '0', 2, 23, 3, 2, '9c0f6c60c9ebf0c4bf0f1123ff5ea211ac635528', 'https://tickets.puppetlabs.com/browse/PUP-7328', 'https://github.com/puppetlabs/puppet/pull/5752'),
('puppet', 174574, 105344308, 5632, 'Puppet errors when managing non-existent service on AIX', 'Related to support escalation PE-19526\r\n\r\nWhen managing a non-existent service on AIX, get something like:\r\n{code}\r\nError: /Stage[main]/Main/Service[nothere]: Could not evaluate: Cannot get status of nothere, error was: Execution of "/usr/bin/lssrc -s nothere" returned 1: 0513-085 The nothere Subsystem is not on file.\r\nWrapped exception:\r\nExecution of "/usr/bin/lssrc -s nothere" returned 1: 0513-085 The nothere Subsystem is not on file.\r\n{code}\r\n\r\nThe behavior of puppet with respect to managing non-existent services is non-standard across various OSes.\r\n\r\nOn Ubuntu (systemd), a non-existent service raises no error, and does not even report its non-existence via ral:\r\n{code}\r\n☂ : puppet apply -e " service { "foo" : ensure => stopped } "\r\nNotice: Compiled catalog for ubuntu16.localdomain in environment production in 0.06 seconds\r\nNotice: Applied catalog in 0.05 seconds\r\n☂ : puppet resource service foobar ensure=stopped\r\nservice { "foobar":\r\n  ensure => "stopped",\r\n}\r\n{code}\r\n\r\nOn OSX (launchctl), it reports an error:\r\n{code}\r\n☂ : be puppet apply -e " service { "foo" : ensure => stopped } "\r\nNotice: Compiled catalog for macbook-pro-2.local in environment production in 0.34 seconds\r\nError: Unable to find launchd plist for job: foo\r\nError: /Stage[main]/Main/Service[foo]/ensure: change from absent to stopped failed: Unable to find launchd plist for job: foo\r\nNotice: Applied catalog in 2.14 seconds\r\n☂ : be puppet resource service foo ensure=stopped\r\nError: Unable to find launchd plist for job: foo\r\nError: /Service[foo]/ensure: change from absent to stopped failed: Unable to find launchd plist for job: foo\r\nservice { "foo":\r\n  ensure => "absent",\r\n}\r\n{code}\r\n\r\nOn Centos 7 (also systemd), same as ubuntu - no errors:\r\n{code}\r\n[root@centos7 ~]# puppet apply -e " service { "foo" : ensure => stopped } "\r\nNotice: Compiled catalog for centos7.localdomain in environment production in 0.07 seconds\r\nNotice: Applied catalog in 0.35 seconds\r\n[root@centos7 ~]# puppet resource service foo ensure=stopped\r\nservice { "foo":\r\n  ensure => "stopped",\r\n}\r\n{code}\r\n\r\nSince AIX is primarily an RPM based system, it seems to make sense to go the route of not erroring when a service is not present (perhaps issuing a debug message if this is the case).', 'https://tickets.puppetlabs.com/browse/PUP-7191', 'https://github.com/puppetlabs/puppet/pull/5632', '2017-02-08T09:07:42.000-0800', '2017-04-06T07:11:49.000-0700', '2017-04-06T07:11:49.000-0700', 'Closed', '', 14, '0', 4, 74, 39, 3, '55a67e6b1b6d7246cba921b6d8514fb381dab83c', 'https://tickets.puppetlabs.com/browse/PUP-7191', 'https://github.com/puppetlabs/puppet/pull/5632'),
('puppet', 180111, 110439697, 5709, 'Regex Lookup isn"t working with Puppet 4.9', 'UPDATE\r\n-----\r\nWhen regular expression keys are using in lookup_options an error is raised if all of the lookup_option keys are regular expression.\r\nA work around until this is fixed is to add a dummy, non regular expression key.\r\n\r\nORIGINAL\r\n----\r\n{code:java}\r\nroot@mbaur-hieradebug:/etc/puppetlabs/code/environments/production# cat hiera.yaml\r\nversion: 5\r\ndefaults:\r\n  datadir: hieradata\r\n  data_hash: yaml_data\r\nhierarchy:\r\n  - name: "Per-node data (yaml version)"\r\n    path: "nodes/%{trusted.certname}.yaml" # Add file extension.\r\n    # Omitting datadir and data_hash to use defaults.\r\n\r\n  - name: "Other YAML hierarchy levels"\r\n    paths: # Can specify an array of paths instead of one.\r\n      - "location/%{facts.whereami}/%{facts.group}.yaml"\r\n      - "groups/%{facts.group}.yaml"\r\n      - "os/%{facts.os.family}.yaml"\r\n      - "common.yaml"\r\nroot@mbaur-hieradebug:/etc/puppetlabs/code/environments/production# cat hieradata/common.yaml\r\n---\r\nclasses:\r\n  - foobar\r\nlookup_options:\r\n  "^profile::(.*)::users$": # Regexp: `$users` parameter of any profile class\r\n    merge:          # Merge behavior as a hash\r\n      strategy: deep\r\n      merge_hash_arrays: true\r\nroot@mbaur-hieradebug:/etc/puppetlabs/code/environments/production# puppet lookup classes\r\nError: Could not run: undefined method `[]" for nil:NilClass\r\n{code}\r\n\r\n\r\nThe following things has been changed compared to an pure puppet-agent installation:\r\n- /etc/puppetlabs/puppet/hiera.yaml deleted\r\n- /etc/puppetlabs/code/environments/production/hiera.yaml created with code from https://docs.puppet.com/puppet/4.9/hiera_migrate_v3_yaml.html#translating-built-in-backends . Only the datadir was changed to hieradata\r\n- /etc/puppetlabs/code/environments/production/hieradata/common.yaml was created. For code see above.', 'https://tickets.puppetlabs.com/browse/PUP-7341', 'https://github.com/puppetlabs/puppet/pull/5709', '2017-03-13T02:39:59.000-0700', '2017-04-06T07:11:49.000-0700', '2017-04-06T07:11:49.000-0700', 'Closed', '', 5, '0', 1, 75, 50, 2, 'f87e42fe7aca84d58f0dc4259ad2aa5ff49be644', 'https://tickets.puppetlabs.com/browse/PUP-7341', 'https://github.com/puppetlabs/puppet/pull/5709'),
('puppet', 179490, 111844420, 5742, 'Puppet::LookupKey and Puppet::LookupValue types are unavailable to Hiera backend functions', 'Pre-docs for hiera 5 stated that backend functions can use Puppet::LookupKey and Puppet::LookupValue to validate arguments and return types. This is false. If you try to use them in a function signature, you get:\r\n\r\n{code}\r\nError: Could not run: Lookup of key "lookup_options" failed: value returned from function "yaml_data" has wrong type, references an unresolved type "Puppet::LookupKey"\r\n{code}\r\n\r\nPer the pre-docs, these types should be available for use. Alternately, maybe they aren"t needed? ', 'https://tickets.puppetlabs.com/browse/PUP-7330', 'https://github.com/puppetlabs/puppet/pull/5742', '2017-03-09T13:45:58.000-0800', '2017-04-06T07:11:50.000-0700', '2017-04-06T07:11:50.000-0700', 'Closed', 'docs_reviewed', 2, '0', 1, 9, 10, 3, '174cba08331681578a26e4f49b1b4c104f20641e', 'https://tickets.puppetlabs.com/browse/PUP-7330', 'https://github.com/puppetlabs/puppet/pull/5742'),
('puppet', 179396, 109947905, 5700, 'Hiera 5 doesn"t call lookup_with_segments method on hiera3_backend', 'We use a custom Hiera backend we call {{file_eyaml}}. It is based on the {{hiera-file}} backend from https://github.com/voxpupuli/hiera-file, which allows looking up file contents with Hiera. Our backend goes one step further and allows for the file contents to be Eyaml encrypted. Looking up a file this way decrypts the contents if they are encrypted or just returns them if they are not. The backend code is not really public but I"ve created a gist here (please don"t judge, it is rather hackish and not that pretty): https://gist.github.com/antaflos/f4cb8844efa27d60d5179c77ad5b83ce\r\n\r\nThe problem here is that the files in question (and thus the lookup keys) very often have periods in their filenames, so we implemented the {{lookup_with_segments}} method in our backend as discussed in https://tickets.puppetlabs.com/browse/HI-496. This works fine in Hiera 3 and Puppet 4.8.x (and Hiera 1 and Puppet 3.8.x)\r\n\r\nIn Puppet 4.9.3 and Hiera 5 the {{lookup_with_segments}} method doesn"t seem to get called at all.\r\n\r\nSee below for the {{hiera.yaml}} file used and the defined hierarchy.\r\n\r\nIn this example I have a file {{/etc/puppetlabs/code/environments/production/hierafiles/ssldata/common.d/example_ca.crt.pem}} that contains an unencrypted, regular base64-encoded X509 certificate.\r\n\r\nRunning {{/opt/puppetlabs/bin/puppet lookup --debug --explain example_ca.crt.pem}} fails to get the contents of this file, saying it cannot find a value for the name, which is understandable since it seems to only look for {{example_ca}} (no such file exists), instead of {{example_ca.crt.pem}}.\r\n\r\nThe full output is here: https://gist.github.com/antaflos/d4553a3a0a46b9a0514266d2f1244090\r\n\r\nI have added {{Hiera.debug()}} statements to the {{lookup}} and {{lookup_with_segments}} methods in our file_eyaml backend and can see from the debug output of the above command that {{lookup_with_segments}} is never called.\r\n\r\nhiera.yaml:\r\n\r\n{code:yaml}\r\n---\r\nversion: 5\r\n\r\nhierarchy:\r\n  - name: Eyaml encrypted data\r\n    hiera3_backend: eyaml\r\n    datadir: "/etc/puppetlabs/code/environments/%{::environment}/hieradata"\r\n    options:\r\n      extension: yaml\r\n      encrypt_method: gpg\r\n      gpg_gnupghome: "/etc/puppetlabs/puppet/keys/gpg"\r\n      gpg_always_trust: true\r\n    paths:\r\n      - "nodes/%{::trusted.certname}"\r\n      - "os/%{::facts.os.name}/%{::facts.os.distro.codename}"\r\n      - common\r\n      - users\r\n      - repos\r\n      - ssldata/common\r\n\r\n  - name: File_eyaml encrypted data\r\n    hiera3_backend: file_eyaml\r\n    datadir: "/etc/puppetlabs/code/environments/%{::environment}/hierafiles"\r\n    options:\r\n      interpolate: false\r\n    paths:\r\n      - "nodes/%{::trusted.certname}"\r\n      - "os/%{::facts.os.name}/%{::facts.os.distro.codename}"\r\n      - common\r\n      - users\r\n      - repos\r\n      - ssldata/common\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7327', 'https://github.com/puppetlabs/puppet/pull/5700', '2017-03-09T06:08:01.000-0800', '2017-04-06T07:11:50.000-0700', '2017-04-06T07:11:50.000-0700', 'Closed', '', 4, '0', 3, 107, 96, 5, '23939e4706db9c2b48a1090eddb2e86dd1334f85', 'https://tickets.puppetlabs.com/browse/PUP-7327', 'https://github.com/puppetlabs/puppet/pull/5700'),
('puppet', 181870, 112260733, 5755, 'Acceptance: Cisco eXR 6.1.3 VM fails to run augeus test successfully', 'The new Cisco eXR VM is significantly faster that the previous version due to it no longer emulating the backplane.   This "Control Plane only" version provides a significant improvement to test execution time and a nice reduction to VMpooler CPU resource usage.  Testing has shown that we have one issue with this VM.  While running puppet acceptance, one of augeus test fails.\r\n\r\nWe have decided it"s worth skipping this test to take advantage of the performance increase.', 'https://tickets.puppetlabs.com/browse/PUP-7380', 'https://github.com/puppetlabs/puppet/pull/5755', '2017-03-21T16:41:37.000-0700', '2017-04-06T07:11:50.000-0700', '2017-04-06T07:11:50.000-0700', 'Closed', '', 1, '0', 1, 4, 1, 1, '838c8c8d2b0bb017fa0c7063fd2522e98be63e0e', 'https://tickets.puppetlabs.com/browse/PUP-7380', 'https://github.com/puppetlabs/puppet/pull/5755'),
('puppet', 173436, 105320356, 5630, 'CI acceptance: solaris 11 tests/resource/zfs/basic_tests.rb tests/resource/zfs/should_be_idempotent.rb failures', 'While running stable SHA e32d6bf85e912c78a8b4f4d3266710666b972aba on the manual CI acceptance pipeline 2 tests failed in what appears to be the same way on the Solaris 11 Sparc system.\r\n\r\nhttps://jenkins.puppetlabs.com/view/puppet-agent/view/manual/view/stable/job/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/lastCompletedBuild/SLAVE_LABEL=beaker,TEST_TARGET=solaris-11-sparc/testReport/\r\n\r\ntests/resource/zfs.basic_tests.rb\r\ntests/resource/zfs.should_be_idempotent.rb\r\n\r\nHere is the test failure:\r\n\r\n{noformat}\r\nBegin tests/resource/zfs/basic_tests.rb\r\n      \r\n      ZFS: configuration\r\n      \r\n      * ZFS: cleanup\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:12$ zfs destroy -r tstpool/tstfs ||:\r\n        cannot open "tstpool/tstfs": filesystem does not exist\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.75 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:13$ zpool destroy tstpool ||:\r\n        cannot open "tstpool": no such pool\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.63 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:13$ rm -rf /ztstpool ||:\r\n        rm: Unable to remove directory /ztstpool/mnt: Device busy\r\n        rm: Unable to remove directory /ztstpool: Directory not empty\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.70 seconds\r\n      \r\n      * ZFS: setup\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:14$ mkdir -p /ztstpool/mnt\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.67 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:15$ mkdir -p /ztstpool/mnt2\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.66 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:15$ mkfile 64m /ztstpool/dsk\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 1.30 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:17$ zpool create tstpool /ztstpool/dsk\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 1.67 seconds\r\n      \r\n      * ZFS: ensure clean slate\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:18$ mktemp -t apply_manifest.pp.XXXXXX\r\n        /tmp/apply_manifest.pp.GMaWzN\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.67 seconds\r\n      localhost $ scp /tmp/beaker20170201-15269-rkag8e solaris-11-sparc:/tmp/apply_manifest.pp.GMaWzN {:ignore => }\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:21$ puppet apply --verbose /tmp/apply_manifest.pp.GMaWzN\r\n        Notice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.88 seconds\r\n        Info: Applying configuration version "1485939945"\r\n        Notice: Applied catalog in 1.02 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 27.77 seconds\r\n      \r\n      * ZFS: basic - ensure it is created\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:48$ mktemp -t apply_manifest.pp.XXXXXX\r\n        /tmp/apply_manifest.pp.c8aWDN\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.77 seconds\r\n      localhost $ scp /tmp/beaker20170201-15269-7zhwfv solaris-11-sparc:/tmp/apply_manifest.pp.c8aWDN {:ignore => }\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:05:51$ puppet apply --verbose /tmp/apply_manifest.pp.c8aWDN\r\n        Notice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.90 seconds\r\n        Info: Applying configuration version "1485939976"\r\n        Notice: /Stage[main]/Main/Zfs[tstpool/tstfs]/ensure: created\r\n        Notice: Applied catalog in 1.40 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 28.55 seconds\r\n      \r\n      * ZFS: idempotence - create\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:06:19$ mktemp -t apply_manifest.pp.XXXXXX\r\n        /tmp/apply_manifest.pp.eDaiIN\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.42 seconds\r\n      localhost $ scp /tmp/beaker20170201-15269-n1ov41 solaris-11-sparc:/tmp/apply_manifest.pp.eDaiIN {:ignore => }\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:06:21$ puppet apply --verbose /tmp/apply_manifest.pp.eDaiIN\r\n        Notice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.89 seconds\r\n        Info: Applying configuration version "1485940005"\r\n        Notice: Applied catalog in 1.03 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 27.81 seconds\r\n      \r\n      * ZFS: cleanup for next test\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:06:49$ mktemp -t apply_manifest.pp.XXXXXX\r\n        /tmp/apply_manifest.pp.vOaiMN\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.48 seconds\r\n      localhost $ scp /tmp/beaker20170201-15269-10v96tb solaris-11-sparc:/tmp/apply_manifest.pp.vOaiMN {:ignore => }\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:06:50$ puppet apply --verbose /tmp/apply_manifest.pp.vOaiMN\r\n        Notice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.89 seconds\r\n        Info: Applying configuration version "1485940035"\r\n        Notice: /Stage[main]/Main/Zfs[tstpool/tstfs]/ensure: removed\r\n        Notice: Applied catalog in 1.48 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 28.16 seconds\r\n      \r\n      * ZFS: create with a mount point\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:18$ mktemp -t apply_manifest.pp.XXXXXX\r\n        /tmp/apply_manifest.pp.c3aqQN\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.42 seconds\r\n      localhost $ scp /tmp/beaker20170201-15269-1qlki5h solaris-11-sparc:/tmp/apply_manifest.pp.c3aqQN {:ignore => }\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:20$ puppet apply --verbose /tmp/apply_manifest.pp.c3aqQN\r\n        Notice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.95 seconds\r\n        Info: Applying configuration version "1485940064"\r\n        Error: Execution of "/usr/sbin/zfs create -o mountpoint=/ztstpool/mnt tstpool/tstfs" returned 1: cannot mount "tstpool/tstfs" on "/ztstpool/mnt": mountpoint or dataset is busy\r\n        filesystem successfully created, but not mounted\r\n        Error: /Stage[main]/Main/Zfs[tstpool/tstfs]/ensure: change from absent to present failed: Execution of "/usr/sbin/zfs create -o mountpoint=/ztstpool/mnt tstpool/tstfs" returned 1: cannot mount "tstpool/tstfs" on "/ztstpool/mnt": mountpoint or dataset is busy\r\n        filesystem successfully created, but not mounted\r\n        Notice: Applied catalog in 1.29 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 27.69 seconds\r\n      Minitest::Assertion: err: sol11a.delivery.puppetlabs.net.\r\n      Expected /ensure: created/ to match "\e[mNotice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.95 seconds\e[0m\n\e[0;32mInfo: Applying configuration version "1485940064"\e[0m\n\e[mNotice: Applied catalog in 1.29 seconds\e[0m\n".\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/minitest-5.10.1/lib/minitest/assertions.rb:139\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/minitest-5.10.1/lib/minitest/assertions.rb:248\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/basic_tests.rb:42\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/host_helpers.rb:90\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/shared/host_manager.rb:127\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/patterns.rb:37\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/host_helpers.rb:63\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/puppet_helpers.rb:487\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/shared/host_manager.rb:127\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/patterns.rb:37\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/puppet_helpers.rb:416\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/basic_tests.rb:41\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/basic_tests.rb:15\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/basic_tests.rb:15\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_case.rb:133\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_case.rb:133\r\n      /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_case.rb:130\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:325\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:322\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:322\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:371\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/cli.rb:180\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/cli.rb:106\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/bin/beaker:6\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n      Begin teardown\r\n      \r\n      * ZFS: cleanup\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:47$ zfs destroy -r tstpool/tstfs ||:\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.79 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:48$ zpool destroy tstpool ||:\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.75 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:49$ rm -rf /ztstpool ||:\r\n        rm: Unable to remove directory /ztstpool/mnt: Device busy\r\n        rm: Unable to remove directory /ztstpool:         Directory not empty\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.45 seconds\r\n      End teardown\r\ntests/resource/zfs/basic_tests.rb failed in 157.50 seconds\r\n      Begin tests/resource/zfs/should_be_idempotent.rb\r\n      \r\n      ZFS: configuration\r\n      \r\n      * ZFS: setup\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:49$ mkdir -p /ztstpool/mnt\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.49 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:50$ mkdir -p /ztstpool/mnt2\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.52 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:50$ mkfile 64m /ztstpool/dsk\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.61 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:51$ zpool create tstpool /ztstpool/dsk\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 1.98 seconds\r\n      \r\n      * ZFS: create with a mount point\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:53$ mktemp -t apply_manifest.pp.XXXXXX\r\n        /tmp/apply_manifest.pp.9uaWVN\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.45 seconds\r\n      localhost $ scp /tmp/beaker20170201-15269-1xgzywl solaris-11-sparc:/tmp/apply_manifest.pp.9uaWVN {:ignore => }\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:07:54$ puppet apply --verbose /tmp/apply_manifest.pp.9uaWVN\r\n        Notice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.90 seconds\r\n        Info: Applying configuration version "1485940099"\r\n        Error: Execution of "/usr/sbin/zfs create -o mountpoint=/ztstpool/mnt tstpool/tstfs" returned 1: cannot mount "tstpool/tstfs" on "/ztstpool/mnt": mountpoint or dataset is busy\r\n        filesystem successfully created, but not mounted\r\n        Error: /Stage[main]/Main/Zfs[tstpool/tstfs]/ensure: change from absent to present failed: Execution of "/usr/sbin/zfs create -o mountpoint=/ztstpool/mnt tstpool/tstfs" returned 1: cannot mount "tstpool/tstfs" on "/ztstpool/mnt": mountpoint or dataset is busy\r\n        filesystem successfully created, but not mounted\r\n        Notice: Applied catalog in 1.29 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 28.05 seconds\r\n      Minitest::Assertion: err: sol11a.delivery.puppetlabs.net.\r\n      Expected /ensure: created/ to match "\e[mNotice: Compiled catalog for sol11a.delivery.puppetlabs.net in environment production in 0.90 seconds\e[0m\n\e[0;32mInfo: Applying configuration version "1485940099"\e[0m\n\e[mNotice: Applied catalog in 1.29 seconds\e[0m\n".\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/minitest-5.10.1/lib/minitest/assertions.rb:139\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/minitest-5.10.1/lib/minitest/assertions.rb:248\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/should_be_idempotent.rb:20\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/host_helpers.rb:90\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/shared/host_manager.rb:127\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/patterns.rb:37\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/host_helpers.rb:63\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/puppet_helpers.rb:487\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/shared/host_manager.rb:127\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/patterns.rb:37\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/dsl/helpers/puppet_helpers.rb:416\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/should_be_idempotent.rb:19\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/should_be_idempotent.rb:15\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/tests/resource/zfs/should_be_idempotent.rb:15\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_case.rb:133\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_case.rb:133\r\n      /usr/local/rvm/rubies/ruby-2.3.1/lib/ruby/2.3.0/benchmark.rb:308\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_case.rb:130\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:325\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:322\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:322\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/test_suite.rb:371\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/cli.rb:180\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/lib/beaker/cli.rb:106\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/gems/beaker-3.5.0/bin/beaker:6\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n      /var/lib/jenkins/workspace/platform_puppet-agent_intn-van-sys_suite-manual-puppet-stable/SLAVE_LABEL/beaker/TEST_TARGET/solaris-11-sparc/puppet/acceptance/.bundle/gems/bin/beaker:23\r\n      Begin teardown\r\n      \r\n      * ZFS: cleanup\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:08:23$ zfs destroy -r tstpool/tstfs ||:\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.72 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:08:23$ zpool destroy tstpool ||:\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.72 seconds\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) 01:08:24$ rm -rf /ztstpool ||:\r\n        rm: Unable to remove directory /ztstpool/mnt: Device busy\r\n        rm: Unable to remove directory /ztstpool:         Directory not empty\r\n      \r\n      sol11a.delivery.puppetlabs.net (solaris-11-sparc) executed in 0.49 seconds\r\n      End teardown\r\n      tests/resource/zfs/should_be_idempotent.rb failed in 35.11 seconds\r\n{noformat}\r\n\r\nIt looks like it was mounted before the test run, maybe we"re not handling clean up somewhere?\r\n\r\n"/ztstpool/mnt"=>{"available"=>"13.23 GiB", "available_bytes"=>1315864576, "capacity"=>"0.00%", "device"=>"rpool/tstfs", "filesystem"=>"zfs", "options"=>["rw", "devices", "setuid", "nonbmand", "exec", "rstchown", "xattr", "atime", "dev=4950009"], "size"=>"13.23 GiB", "size_bytes"=>1316175872, "used"=>"304.00 KiB", "used_bytes"=>311296}}" ', 'https://tickets.puppetlabs.com/browse/PUP-7159', 'https://github.com/puppetlabs/puppet/pull/5630', '2017-02-01T13:59:56.000-0800', '2017-04-06T07:11:50.000-0700', '2017-04-06T07:11:50.000-0700', 'Closed', '', 4, '0', 1, 4, 4, 1, '055cb452ead024af9789c03d3d88dcfb7ea9786c', 'https://tickets.puppetlabs.com/browse/PUP-7159', 'https://github.com/puppetlabs/puppet/pull/5630'),
('puppet', 169376, 112068724, 5751, 'Puppet::Util::Windows::File.replace_file fails on UNC paths', 'A user report was received that {{Puppet::Util::Windows::File.replace_file}} was traced as a problem in file writes to UNC paths. The original code lives at https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/file.rb#L51-L69\r\n\r\nNote that the current code calls [ReplaceFile|https://msdn.microsoft.com/en-us/library/windows/desktop/aa365512(v=vs.85).aspx] and specifies {{REPLACEFILE_WRITE_THROUGH}} (0x01) as the {{dwReplaceFlags}} despite MSDN documentation listing that value as unsupported.\r\n\r\nThe original code dates back to 2012 and probably wasn"t sufficiently tested in UNC path scenarios - https://github.com/puppetlabs/puppet/commit/73e302bbf5ab4a6c5513a39070e2c907542775ae#diff-a91b066f285a8fe7ccfa4162399d458fR11\r\n\r\n\r\nFrom the user report, given a manifest:\r\n\r\n{code}\r\n file { "puppettestfile":\r\n    path    => "\\\\server\path\Puppet_Test_File.txt",\r\n    ensure  => "file",\r\n    content => "This is a puppet test file with content loaded from manifest",\r\n}\r\n{code}\r\n\r\nDifferent errors propagated depending on different circumstances:\r\n\r\nh4. When the file does not exist\r\n\r\n{code}\r\nError: ReplaceFile(//server/path/Puppet_Test_File.txt, //server/path/Puppet_Test_File.txt20170106-6416-1fqt5cr):  Access is denied.\r\nError: /Stage[main]/Acurityconfig/File[puppettestfile]/ensure: change from absent to file failed: ReplaceFile(//sacuts16/TS16/TS16/Puppet_Test_File.txt, //sacuts16/TS16/TS16/Puppet_Test_File.txt20170106-6416-1fqt5cr):  Access is denied.\r\n{code}\r\n\r\n*NOTE*: This results in a 0 byte file being created\r\n\r\nh4. When the content of the file does not match\r\n\r\n{code}\r\nError: ReplaceFile(//server/path/Puppet_Test_File.txt, //server/path/Puppet_Test_File.txt20170106-11576-wsevbb):  Access is denied.\r\nNotice: /Stage[main]/ModuleName/File[puppettestfile]/content:\r\n \r\nError: /Stage[main]/ModuleName/File[puppettestfile]/content: change from {md5}058755754b4ac17664d\r\n7a8eba995a8d1 to {md5}3568af3a5598f2998d60a5e92af55fd6 failed: ReplaceFile(//server/path/Puppet_Test_File.txt, //server/path/Puppet_Test_File.txt20170106-11576-wsevbb):  Access is denied\r\n{code}\r\n\r\nThe user was able to use an {{exec}} coupled with {{cmd.exe /c echo}} to successfully write files to the destination UNC path - so clearly the account Puppet running under has appropriate permission to do so.\r\n\r\nThe user ultimately was able to work around the issue by passing {{REPLACEFILE_IGNORE_MERGE_ERRORS}} (0x02) as the value for {{dwReplaceFlags}}.  It"s possible the Puppet code can have that change made right away given the current value being passed is allegedly unsupported.  Some additional tests may need to be written.\r\n\r\nThe only concern here is whether or not the ACL can be set as desired.  It may be necessary to add some documentation that managing files on UNC paths may not result in the expected {{mode}} being set.\r\n\r\nCallers of {{replace_file}} should also be audited to understand its current use in the Puppet codebase - https://github.com/puppetlabs/puppet/search?p=1&q=replace_file&utf8=%E2%9C%93\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7077', 'https://github.com/puppetlabs/puppet/pull/5751', '2017-01-09T14:06:32.000-0800', '2017-04-06T07:11:51.000-0700', '2017-04-06T07:11:51.000-0700', 'Closed', 'acl;windows', 9, '0', 1, 5, 1, 1, 'a6e8b291ebe76326185d6cb281f90d27cb912c22', 'https://tickets.puppetlabs.com/browse/PUP-7077', 'https://github.com/puppetlabs/puppet/pull/5751'),
('puppet', 177104, 111322438, 5729, 'Hiera 5: strange error unless path is defined', 'Potential bug filed as requested by [~henrik.lindberg] on slack. \r\n\r\nPlease consider following snippet:\r\n\r\n{code:java}\r\n---\r\nversion: 5\r\n\r\ndefaults:\r\n  datadir: hieradata\r\n  data_hash: yaml_data\r\n\r\nhierarchy:\r\n  - name: "Nodes"\r\n    data_hash: yaml_data\r\n    path: "nodes/%{::trusted.certname}"\r\n\r\n  - name: "Common"\r\n    data_hash: yaml_data\r\n    path: common.yaml\r\n{code}\r\n\r\nUnless "data_hash: yaml_data" is provided for each level I get the following error:\r\n\r\n{code:java}\r\nError while evaluating a Function Call, "yaml_data" parameter "options" expects size to be 1, got 0\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7273', 'https://github.com/puppetlabs/puppet/pull/5729', '2017-02-27T02:23:34.000-0800', '2017-04-06T07:11:51.000-0700', '2017-04-06T07:11:51.000-0700', 'Closed', 'docs_reviewed', 24, '0', 1, 88, 0, 5, '610bc218a72fb321ab1cf68af2510784861e98d5', 'https://tickets.puppetlabs.com/browse/PUP-7273', 'https://github.com/puppetlabs/puppet/pull/5729'),
('puppet', 181364, 111604014, 5734, 'Type mismatches for variants with undef are incorrectly reported', 'A reported mismatch for a type that does not conform to a {{Variant}} where one of the types is {{Undef}} is incorrectly reported. The {{Undef}} is missing from the description.', 'https://tickets.puppetlabs.com/browse/PUP-7371', 'https://github.com/puppetlabs/puppet/pull/5734', '2017-03-20T06:24:38.000-0700', '2017-04-06T07:11:53.000-0700', '2017-04-06T07:11:53.000-0700', 'Closed', '', 0, '0', 1, 60, 43, 5, '6a063b6fd7b62ccd2edafbff3c343080e86d393c', 'https://tickets.puppetlabs.com/browse/PUP-7371', 'https://github.com/puppetlabs/puppet/pull/5734'),
('puppet', 175924, 108524398, 5670, 'A custom LookupAdapter provided to a Puppet::Pops::Lookup::Invocation is ignored if a parent_invocation exists.', 'This is blocking meep in pe-modules-next using Thomas"s patch: https://github.com/puppetlabs/puppetlabs-pe_infrastructure/pull/24.  (Using Puppet 4.9.0-135-gb78a4cc in puppet-agent 1.9.0.111.g0089107 in glisan, 2017.2.0-rc1-15-g5d7b7a1)\r\n\r\nIf the master is compiling an agent catalog, then the compiler has registered a Puppet::Pops::Lookup::LookupAdapter pointing to the standard hiera config as soon as it begins looking up parameter defaults.  But the pe_infrastructure module has a data function: [pe_infrastructure::data|https://github.com/puppetlabs/puppetlabs-pe_infrastructure/blob/next/lib/puppet/functions/pe_infrastructure/data.rb] which makes use of meep library functions to determine defaults from pe.conf.  In this case, the lookup invocation comes from here: https://github.com/thallgren/puppetlabs-pe_infrastructure/blob/2451b8d67bb621ecc37d88d1ba07ee75babb813d/lib/puppet_x/puppetlabs/meep/config.rb#L131-L136. However, there is a previous lookup invocation cached in Puppet::Pops::Lookup::Invocation@current from looking up "lookup_options" which invokes the pe_infrastructure::data() function.\r\n\r\nIt appears that https://github.com/thallgren/puppetlabs-pe_infrastructure/blob/2451b8d67bb621ecc37d88d1ba07ee75babb813d/lib/puppet_x/puppetlabs/meep/config.rb#L131-L136 causes the lookup seeking pe.conf data to ignore the MeepLookupAdapter in preference to the Adapter in the cached @current invocation.\r\n\r\nExpectation for meep, at least, would be that the pe_* functions are able to read data from pe.conf.  I"m not entirely certain yet if this is an artifact of my use of the meep functions in a module data_hash function, or if it would also occur just as part of the process of looking up defaults regardless.', 'https://tickets.puppetlabs.com/browse/PUP-7240', 'https://github.com/puppetlabs/puppet/pull/5670', '2017-02-21T14:55:12.000-0800', '2017-04-06T07:11:54.000-0700', '2017-04-06T07:11:54.000-0700', 'Closed', '', 19, '0', 2, 47, 11, 3, '5273e89b2181da9bb4af07df557367a0ccfe9796', 'https://tickets.puppetlabs.com/browse/PUP-7240', 'https://github.com/puppetlabs/puppet/pull/5670'),
('puppet', 173405, 104246370, 5601, 'pkg_spec.rb failure on individual execution starting c5d97e ', 'Reproduced by [~matthaus] on master.\r\n\r\nProblem is not present when all specs are run or even if limited to all of spec/unit/provider/package/\r\n\r\n{noformat}\r\nrspec ./spec/unit/provider/package/pkg_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n.....................FFFFFFFFFFFFFFFFFFFFFFFFFFFF\r\n\r\nFailures:\r\n\r\n  1) Puppet::Type::Package::ProviderPkg#methods :latest should work correctly for ensure latest on solaris 11(known UFOXI)\r\n     Got 0 failures and 2 other errors:\r\n\r\n     1.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n          RuntimeError:\r\n            can"t modify frozen NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n          # ./spec/unit/provider/package/pkg_spec.rb:114:in `block (4 levels) in <top (required)>"\r\n\r\n     1.2) Failure/Error: @mocha ||= Mocha::Mockery.instance.mock_impersonating(self)\r\n\r\n          RuntimeError:\r\n            can"t modify frozen NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:29:in `mock"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:22:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  2) Puppet::Type::Package::ProviderPkg#methods :latest should work correctly for ensure latest on solaris 11 (IFO)\r\n     Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n     NameError:\r\n       method `exitstatus" not defined in NilClass\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n     # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  3) Puppet::Type::Package::ProviderPkg#methods :latest should work correctly for ensure latest on solaris 11(known IFO)\r\n     Got 0 failures and 2 other errors:\r\n\r\n     3.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n          RuntimeError:\r\n            can"t modify frozen NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n          # ./spec/unit/provider/package/pkg_spec.rb:127:in `block (4 levels) in <top (required)>"\r\n\r\n     3.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  4) Puppet::Type::Package::ProviderPkg#methods :latest issues a warning when the certificate has expired\r\n     Got 0 failures and 2 other errors:\r\n\r\n     4.1) Failure/Error: Puppet::Util::Execution.expects(:execute).with(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true}).returns ""\r\n\r\n          Mocha::ExpectationError:\r\n            not all expectations were satisfied\r\n            unsatisfied expectations:\r\n            - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true})\r\n            satisfied expectations:\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet.warning("pkg warning: Certificate "/var/pkg/ssl/871b4ed0ade09926e6adf95f86bf17535f987684" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "29" days.")\r\n          # ./spec/unit/provider/package/pkg_spec.rb:126:in `block (4 levels) in <top (required)>"\r\n\r\n     4.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  5) Puppet::Type::Package::ProviderPkg#methods :latest doesn"t issue a warning when the certificate hasn"t expired\r\n     Got 0 failures and 2 other errors:\r\n\r\n     5.1) Failure/Error: Puppet::Util::Execution.expects(:execute).with(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true}).returns ""\r\n\r\n          Mocha::ExpectationError:\r\n            not all expectations were satisfied\r\n            unsatisfied expectations:\r\n            - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true})\r\n            satisfied expectations:\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected never, not yet invoked: Puppet.warning(/pkg warning/)\r\n            - expected exactly once, invoked once: Puppet.warning("pkg warning: Certificate "/var/pkg/ssl/871b4ed0ade09926e6adf95f86bf17535f987684" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "29" days.")\r\n          # ./spec/unit/provider/package/pkg_spec.rb:126:in `block (4 levels) in <top (required)>"\r\n\r\n     5.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  6) Puppet::Type::Package::ProviderPkg#methods :instances should correctly parse lines on solaris 11\r\n     Got 0 failures and 2 other errors:\r\n\r\n     6.1) Failure/Error: Puppet::Util::Execution.expects(:execute).with(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true}).returns ""\r\n\r\n          Mocha::ExpectationError:\r\n            not all expectations were satisfied\r\n            unsatisfied expectations:\r\n            - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true})\r\n            satisfied expectations:\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - expected never, not yet invoked: Puppet::Type::Package::ProviderPkg.warning(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hv")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected never, not yet invoked: Puppet.warning(/pkg warning/)\r\n            - expected exactly once, invoked once: Puppet.warning("pkg warning: Certificate "/var/pkg/ssl/871b4ed0ade09926e6adf95f86bf17535f987684" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "29" days.")\r\n          # ./spec/unit/provider/package/pkg_spec.rb:126:in `block (4 levels) in <top (required)>"\r\n\r\n     6.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  7) Puppet::Type::Package::ProviderPkg#methods :instances should fail on incorrect lines\r\n     Got 0 failures and 2 other errors:\r\n\r\n     7.1) Failure/Error: Puppet::Util::Execution.expects(:execute).with(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true}).returns ""\r\n\r\n          Mocha::ExpectationError:\r\n            not all expectations were satisfied\r\n            unsatisfied expectations:\r\n            - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true})\r\n            satisfied expectations:\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hv")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected never, not yet invoked: Puppet::Type::Package::ProviderPkg.warning(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hv")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected never, not yet invoked: Puppet.warning(/pkg warning/)\r\n            - expected exactly once, invoked once: Puppet.warning("pkg warning: Certificate "/var/pkg/ssl/871b4ed0ade09926e6adf95f86bf17535f987684" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "29" days.")\r\n          # ./spec/unit/provider/package/pkg_spec.rb:126:in `block (4 levels) in <top (required)>"\r\n\r\n     7.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  8) Puppet::Type::Package::ProviderPkg#methods :instances should fail on unknown package status\r\n     Got 0 failures and 2 other errors:\r\n\r\n     8.1) Failure/Error: Puppet::Util::Execution.expects(:execute).with(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true}).returns ""\r\n\r\n          Mocha::ExpectationError:\r\n            not all expectations were satisfied\r\n            unsatisfied expectations:\r\n            - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true})\r\n            satisfied expectations:\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hv")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hv")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected never, not yet invoked: Puppet::Type::Package::ProviderPkg.warning(any_parameters)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hv")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected exactly once, invoked once: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvn", "dummy")\r\n            - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n            - expected never, not yet invoked: Puppet.warning(/pkg warning/)\r\n            - expected exactly once, invoked once: Puppet.warning("pkg warning: Certificate "/var/pkg/ssl/871b4ed0ade09926e6adf95f86bf17535f987684" for publisher "solarisstudio", needed to access "https://pkg.oracle.com/solarisstudio/release/", will expire in "29" days.")\r\n          # ./spec/unit/provider/package/pkg_spec.rb:126:in `block (4 levels) in <top (required)>"\r\n\r\n     8.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  9) Puppet::Type::Package::ProviderPkg#methods :query should return fail when the packageline cannot be parsed\r\n     Got 0 failures and 2 other errors:\r\n\r\n     9.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n          RuntimeError:\r\n            can"t modify frozen NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n          # ./spec/unit/provider/package/pkg_spec.rb:218:in `block (4 levels) in <top (required)>"\r\n\r\n     9.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n          NameError:\r\n            method `exitstatus" not defined in NilClass\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n          # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  10) Puppet::Type::Package::ProviderPkg#methods :query on solaris 10 should find the package\r\n      Got 0 failures and 2 other errors:\r\n\r\n      10.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:179:in `block (5 levels) in <top (required)>"\r\n\r\n      10.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  11) Puppet::Type::Package::ProviderPkg#methods :query on solaris 10 should return :absent when the package is not found\r\n      Got 0 failures and 2 other errors:\r\n\r\n      11.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 1\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:191:in `block (5 levels) in <top (required)>"\r\n\r\n      11.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  12) Puppet::Type::Package::ProviderPkg#methods :query on solaris 11 should find the package\r\n      Got 0 failures and 2 other errors:\r\n\r\n      12.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:198:in `block (5 levels) in <top (required)>"\r\n\r\n      12.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  13) Puppet::Type::Package::ProviderPkg#methods :query on solaris 11 should return :absent when the package is not found\r\n      Got 0 failures and 2 other errors:\r\n\r\n      13.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 1\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:211:in `block (5 levels) in <top (required)>"\r\n\r\n      13.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  14) Puppet::Type::Package::ProviderPkg#methods :install should accept all licenses\r\n      Got 0 failures and 2 other errors:\r\n\r\n      14.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:230:in `block (4 levels) in <top (required)>"\r\n\r\n      14.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  15) Puppet::Type::Package::ProviderPkg#methods :install should install specific version(1)\r\n      Got 0 failures and 2 other errors:\r\n\r\n      15.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:237:in `block (4 levels) in <top (required)>"\r\n\r\n      15.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  16) Puppet::Type::Package::ProviderPkg#methods :install should install specific version(2)\r\n      Got 0 failures and 2 other errors:\r\n\r\n      16.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:249:in `block (4 levels) in <top (required)>"\r\n\r\n      16.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  17) Puppet::Type::Package::ProviderPkg#methods :install should downgrade to specific version\r\n      Got 0 failures and 2 other errors:\r\n\r\n      17.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:256:in `block (4 levels) in <top (required)>"\r\n\r\n      17.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  18) Puppet::Type::Package::ProviderPkg#methods :install should install any if version is not specified\r\n      Got 0 failures and 2 other errors:\r\n\r\n      18.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:267:in `block (4 levels) in <top (required)>"\r\n\r\n      18.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  19) Puppet::Type::Package::ProviderPkg#methods :install should install if no version was previously installed, and a specific version was requested\r\n      Got 0 failures and 2 other errors:\r\n\r\n      19.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:276:in `block (4 levels) in <top (required)>"\r\n\r\n      19.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  20) Puppet::Type::Package::ProviderPkg#methods :install installs the latest matching version when given implicit version, and none are installed\r\n      Got 0 failures and 2 other errors:\r\n\r\n      20.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:288:in `block (4 levels) in <top (required)>"\r\n\r\n      20.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  21) Puppet::Type::Package::ProviderPkg#methods :install updates to the latest matching version when given implicit version\r\n      Got 0 failures and 2 other errors:\r\n\r\n      21.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:301:in `block (4 levels) in <top (required)>"\r\n\r\n      21.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  22) Puppet::Type::Package::ProviderPkg#methods :install issues a warning when an implicit version number is used, and in sync\r\n      Got 0 failures and 2 other errors:\r\n\r\n      22.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 4\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:312:in `block (4 levels) in <top (required)>"\r\n\r\n      22.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  23) Puppet::Type::Package::ProviderPkg#methods :install issues a warning when choosing a version number for an implicit match\r\n      Got 0 failures and 2 other errors:\r\n\r\n      23.1) Failure/Error: $CHILD_STATUS.stubs(:exitstatus).returns 0\r\n\r\n            RuntimeError:\r\n              can"t modify frozen NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:16:in `mocha"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:102:in `block in stubs"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `call"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/argument_iterator.rb:15:in `each"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/object.rb:97:in `stubs"\r\n            # ./spec/unit/provider/package/pkg_spec.rb:323:in `block (4 levels) in <top (required)>"\r\n\r\n      23.2) Failure/Error: stubbee.__metaclass__.send(:remove_method, method)\r\n\r\n            NameError:\r\n              method `exitstatus" not defined in NilClass\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:55:in `remove_new_method"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/class_method.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:20:in `unstub"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/central.rb:27:in `unstub_all"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/mockery.rb:65:in `teardown"\r\n            # /usr/local/opt/rbenv/versions/2.2.3/gemsets/puppet-45/gems/mocha-0.10.5/lib/mocha/api.rb:160:in `mocha_teardown"\r\n\r\n  24) Puppet::Type::Package::ProviderPkg#methods :update should not raise error if not necessary\r\n      Got 0 failures and 2 other errors:\r\n\r\n      24.1) Failure/Error: described_class.expects(:pkg).with(:list, "-Hvfa", "dummy@1.0-0.151006").returns File.read(my_fixture("dummy_implicit_version"))\r\n\r\n            Mocha::ExpectationError:\r\n              not all expectations were satisfied\r\n              unsatisfied expectations:\r\n              - expected exactly once, not yet invoked: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvfa", "dummy@1.0-0.151006")\r\n              - expected exactly once, not yet invoked: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvfa", "dummy@1.0-0.151006")\r\n              - expected exactly once, not yet invoked: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvfa", "dummy@1.0-0.151006")\r\n              - expected exactly once, not yet invoked: Puppet::Type::Package::ProviderPkg.pkg(:list, "-Hvfa", "dummy@1.0-0.151006")\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "install", "-n", "dummy@1.0,5.11-0.151006:20140220T084443Z"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy@1.0,5.11-0.151006:20140220T084443Z"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "--accept", "dummy@1.0,5.11-0.151006:20140220T084443Z"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy@1.0,5.11-0.151006:20140220T084443Z"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "install", "--accept", "dummy@1.0,5.11-0.151006:20140220T084443Z"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "install", "-n", "dummy@1.0,5.11-0.151006:20140220T084443Z"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "install", "--accept", "dummy@0.0.7"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "unfreeze", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "unfreeze", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "install", "--accept", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "--accept", "dummy@0.0.8"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "list", "-Hv", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "unfreeze", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "unfreeze", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "install", "--accept", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "list", "-Hv", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "list", "-Hv", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "list", "-Hv", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "list", "-Hv", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Puppet::Util::Execution.execute(["/bin/pkg", "update", "-n", "dummy"], {:failonfail => false, :combine => true})\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).query()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).query()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).query()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).query()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).unhold()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).query()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).unhold()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).query()\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).warning("Implicit version 1.0-0.151006 has 3 possible matches")\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).warning("Selecting version "1.0,5.11-0.151006:20140220T084443Z" for implicit "1.0-0.151006"")\r\n              - expected exactly once, not yet invoked: Package[dummy](provider=pkg).warning("Implicit version 1.0-0.151006 has 3 possible matches")\r\n              satisfied expectations:\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Signal.trap(any_parameters)\r\n              - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n              - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n              - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n              - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n              - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:pkg)\r\n              - allowed any number of times, not yet invoked: Puppet::Type::Package::ProviderPkg.command(:', 'https://tickets.puppetlabs.com/browse/PUP-7158', 'https://github.com/puppetlabs/puppet/pull/5601', '2017-02-01T13:30:02.000-0800', '2017-04-06T07:11:54.000-0700', '2017-04-06T07:11:54.000-0700', 'Closed', 'maintenance', 5, '0', 1, 2, 0, 1, 'bece7d96b1311cac68cea983736b7b510c935033', 'https://tickets.puppetlabs.com/browse/PUP-7158', 'https://github.com/puppetlabs/puppet/pull/5601'),
('puppet', 180778, 110997658, 5720, 'Apparently a Puppet Hiera error message points to a 404', 'The new Puppet version is pointing Hiera users to a 404 page.\r\n\r\n{quote}\r\n[21:58:28]  <golgy>	This is an upgrade of PE 2016.5.1 -> 2017.1 \r\n[21:58:31]  <golgy>	if it matters\r\n[21:58:53]  <golgy>	2017-03-16 04:01:12,660 - [Warning]: /etc/puppetlabs/enterprise/hiera.yaml: Use of "hiera.yaml" version 3 is deprecated. It should be converted to version 5\r\n[21:58:55]  <golgy>	   (in /etc/puppetlabs/enterprise/hiera.yaml)\r\n[21:58:57]  <golgy>	2017-03-16 04:01:12,833 - [Warning]: The function "hiera" is deprecated in favor of using "lookup". See https://docs.puppet.com/puppet/4.9.4/reference/deprecated_language.html\r\n[21:58:59]  <golgy>	   (file & line not available)\r\n[21:59:02]  <golgy>	And puppet 4.9.4\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-7360', 'https://github.com/puppetlabs/puppet/pull/5720', '2017-03-15T22:01:03.000-0700', '2017-04-06T07:11:54.000-0700', '2017-04-06T07:11:54.000-0700', 'Closed', '', 8, '0', 1, 14, 6, 7, '41e899a205ff5389d01d32233b0f54d07748858b', 'https://tickets.puppetlabs.com/browse/PUP-7360', 'https://github.com/puppetlabs/puppet/pull/5720'),
('puppet', 179716, 110729252, 5718, 'context_spec.rb fails when run in isolation', 'Getting an error when running context_spec.rb in isolation on 4.9.4 and later:\r\n\r\n{noformat}\r\n$ bundle exec rspec spec/unit/pops/lookup/context_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n.................F...\r\n\r\nFailures:\r\n\r\n  1) Puppet::Pops::Lookup::Context an instance with cached_file_data and multiple compilations will invalidate cache if file changes\r\n     Failure/Error: expect(logs).to eql(["{parsed => a: value a\n}", "{parsed => b: value b\n}"])\r\n\r\n       expected: ["{parsed => a: value a\n}", "{parsed => b: value b\n}"]\r\n            got: ["{parsed => a: value a\n}", "{parsed => a: value a\n}"]\r\n\r\n       (compared using eql?)\r\n\r\n       Diff:\r\n       @@ -1,3 +1,3 @@\r\n        {parsed => a: value a\n}\r\n       -{parsed => b: value b\n}\r\n       +{parsed => a: value a\n}\r\n\r\n     # ./spec/unit/pops/lookup/context_spec.rb:228:in `block (5 levels) in <module:Lookup>"\r\n{noformat}\r\n\r\nThe error doesn"t show up in travis/appveyor, so guessing it"s order dependent failure.\r\n\r\nSee c150f76f540b89b8eeef27aee36caf7564e829de and PUP-7305,', 'https://tickets.puppetlabs.com/browse/PUP-7340', 'https://github.com/puppetlabs/puppet/pull/5718', '2017-03-10T15:43:25.000-0800', '2017-04-06T07:11:55.000-0700', '2017-04-06T07:11:55.000-0700', 'Closed', '', 2, '0', 4, 55, 8, 2, 'a163cdb2ed0938c7991bf8a276b5a26780d525b9', 'https://tickets.puppetlabs.com/browse/PUP-7340', 'https://github.com/puppetlabs/puppet/pull/5718'),
('puppet', 181027, 111301177, 5728, 'Hashes with dots in hiera will no longer fail a puppetrun', 'We are in tihe process of moving to puppet 4. One of the issues we encountered with puppet 4.8.2 (puppet-agent 1.8.3) was that when trying to read a hash from hiera that contained a dot in the name. We used 4.8.2 first as 4.9.3 was giving us a lot of issues. However, with the release of 4.9.4, most were fixed so we switched to that. However, I noticed a regression has slipped in where hashes with dots in the name are no longer failing a puppetrun. In fact, they are silently ignored (leaving your resources unmanaged!). The puppetserver also doesn"t print any warning about using illegal hash names.\r\n\r\nExample hash that should fail:\r\n{code}\r\nmy.hash:\r\n  some: value\r\n  another: value\r\n{code}\r\n\r\nWith puppet 4.8.x, reading this hash with hiera_hash fails the run with:\r\n{quote}\r\nEvaluation Error: Error while evaluating a Function Call, Resolution type :hash is illegal when accessing values using dotted keys. Offending key was ....\r\n{quote}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7366', 'https://github.com/puppetlabs/puppet/pull/5728', '2017-03-17T01:06:41.000-0700', '2017-04-06T07:11:55.000-0700', '2017-04-06T07:11:55.000-0700', 'Closed', '', 1, '0', 1, 51, 4, 2, 'b2a6329b003eb979a1c1acf3a14638895f96475e', 'https://tickets.puppetlabs.com/browse/PUP-7366', 'https://github.com/puppetlabs/puppet/pull/5728'),
('puppet', 181306, 111525201, 5733, 'Ensure that returned value from data provider is type checked only once.', 'The values returned from a data provider are type checked by the lookup framework. Currently, this means that if the function that is backing the provider has a declared return type, then the value will be checked twice. This needs to change so that the lookup framework relies on the type check performed by the function when it is known to always check its returned value.\r\n\r\nWe need a mechanism that checks if all dispatchers of a function are declared with a return type, and if so, checks that they are all assignable to the {{Puppet::LookupValue}}, or if it is a {{data_hash}}, to the type {{Hash[Puppet::LookupKey,Puppet::LookupValue]}}. If it isn"t assignable, an error should be raised.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7370', 'https://github.com/puppetlabs/puppet/pull/5733', '2017-03-20T01:28:37.000-0700', '2017-04-06T07:11:55.000-0700', '2017-04-06T07:11:55.000-0700', 'Closed', '', 0, '0', 3, 107, 57, 6, '9a9d7dd35fb8f309992a3a5f7caefdb449b68d0b', 'https://tickets.puppetlabs.com/browse/PUP-7370', 'https://github.com/puppetlabs/puppet/pull/5733'),
('puppet', 182261, 112350120, 5758, 'Fix problem with "Attempt to redefine entity" when using type aliases as class parameter', 'If a function parameter declaration or return type, references a type that has not yet been loaded, and that type is prefixed with the name of a module that has not yet been loaded, then the loaders will first make an attempt to load the files in the modules manifests directory. If such a file, in turn, also references the same type, then that triggers a recursive load. When the recursive call returns, the loader will still try to add the type, which results in an "Attempt to redefine entity" error.', 'https://tickets.puppetlabs.com/browse/PUP-7391', 'https://github.com/puppetlabs/puppet/pull/5758', '2017-03-23T07:16:38.000-0700', '2017-04-06T07:11:55.000-0700', '2017-04-06T07:11:55.000-0700', 'Closed', '', 0, '0', 2, 74, 5, 2, '3aeda73a089932a76003c320bb98cd634253510d', 'https://tickets.puppetlabs.com/browse/PUP-7391', 'https://github.com/puppetlabs/puppet/pull/5758'),
('puppet', 179607, 110263742, 5706, 'Interpolation behavior in hiera.yaml changed between Puppet version 4.9.3 and 4.9.4', 'When using an array in hiera.yaml changes of global variables are ignored in puppet 4.9.4.\r\nExample environments/development/hiera.yaml:\r\n{code:yaml}\r\n---\r\nversion: 5\r\n\r\ndefaults:\r\n  datadir: "data"\r\n  data_hash: yaml_data\r\n\r\nhierarchy:\r\n  - name: "Global settings"\r\n    path: "global.yaml"\r\n  - name: "Role specific settings"\r\n    paths:\r\n      - "roles/%{::roles.0}.yaml"\r\n{code}\r\nExample test.pp:\r\n{code:puppet}\r\n$roles = lookup("roles")\r\n$data = lookup("data", Array[String], "unique")\r\nnotify{"data: ${data}":}\r\n{code}\r\nExample environments/development/data/global.yaml:\r\n{code:yaml}\r\nroles:\r\n        - test1\r\n\r\ndata:\r\n        - "from global"\r\n{code}\r\nExample environments/development/data/roles/test1.yaml:\r\n{code:yaml}\r\ndata:\r\n        - "from test1"\r\n{code}\r\nWhen running "puppet apply --environment=development test.pp" this results in:\r\n{code}\r\nWarning: Undefined variable "::roles"; \r\n   (file & line not available)\r\nNotice: Compiled catalog for hostname in environment development in 0.07 seconds\r\nNotice: data: [from global]\r\nNotice: /Stage[main]/Main/Notify[data: [from global]]/message: defined "message" as "data: [from global]"\r\nNotice: Applied catalog in 0.17 seconds\r\n\r\n{code}\r\nWhen changing \r\n{code}\r\n"roles/%{::roles.0}.yaml"\r\n{code}\r\n to \r\n{code}\r\n"roles/%{roles.0}.yaml"\r\n{code}\r\n puppet apply returns:\r\n{code}\r\nWarning: Undefined variable "roles"; \r\n   (file & line not available)\r\nNotice: Compiled catalog for hostname in environment development in 0.07 seconds\r\nNotice: data: [from global, from test1]\r\nNotice: /Stage[main]/Main/Notify[data: [from global, from test1]]/message: defined "message" as "data: [from global, from test1]"\r\nNotice: Applied catalog in 0.17 seconds\r\n{code}\r\nIn Puppet 4.9.3 both versions return the same result. This bug is probably related to PUP-7303.', 'https://tickets.puppetlabs.com/browse/PUP-7336', 'https://github.com/puppetlabs/puppet/pull/5706', '2017-03-10T08:19:14.000-0800', '2017-04-07T02:17:00.000-0700', '2017-04-07T02:17:00.000-0700', 'Closed', 'regression', 10, '0', 2, 61, 29, 3, '75c8a5fed056def1f8548ed36b2cdea3aa41277f', 'https://tickets.puppetlabs.com/browse/PUP-7336', 'https://github.com/puppetlabs/puppet/pull/5706'),
('puppet', 128101, 67666299, 4911, 'Data in modules interpret nil as {}', 'Given data in a module class:\r\n\r\n{code}\r\nclass ntp (\r\n  Optional[String] $ticker_file\r\n) {\r\n...\r\n}\r\n{code}\r\n\r\nand hiera data in the module:\r\n\r\n{code}\r\nntp::ticker_file: ~\r\n{code}\r\n\r\nThe nil is interpreted as a hash:\r\n\r\n{code}\r\n% puppet lookup --explain --modulepath `pwd` ntp::ticker_file\r\nMerge strategy first\r\n  Data Binding "hiera"\r\n    No such key: "ntp::ticker_file"\r\n  Data Provider "EnvironmentDataProvider"\r\n    No such key: "ntp::ticker_file"\r\n  Module "ntp" using Data Provider "Hiera Data Provider, version 4"\r\n    ConfigurationPath "/example/ntp/hiera.yaml"\r\n    Merge strategy first\r\n      Data Provider "OS family"\r\n        Path "/example/ntp/data/os/RedHat.yaml"\r\n          Original path: "os/%{facts.os.family}"\r\n          Path not found\r\n      Data Provider "defaults"\r\n        Path "/example/ntp/data/defaults.yaml"\r\n          Original path: "defaults"\r\n          Found key: "ntp::ticker_file" value: {}\r\n      Merged result: {}\r\n  Merged result: {}\r\n{code}\r\n\r\nWhile the YAML is correctly interpreted by ruby as a nil:\r\n\r\n{code}\r\n% /opt/puppetlabs/puppet/bin/ruby -r yaml -e "p YAML.load(File.read("ntp/data/defaults.yaml"))["ntp::ticker_file"]"\r\nnil\r\n{code}\r\n\r\nAnd to be clear its puppet the error is:\r\n\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Function Call, Class[Ntp]: parameter "ticker_file" expects a String value, got Hash\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6230', 'https://github.com/puppetlabs/puppet/pull/4911', '2016-04-24T01:13:20.000-0700', '2017-04-07T11:45:01.000-0700', '2017-04-07T11:45:01.000-0700', 'Closed', '', 7, '0', 1, 89, 3, 12, '41a73a1618dcfc6101e9b0efdceb6a686d431a65', 'https://tickets.puppetlabs.com/browse/PUP-6230', 'https://github.com/puppetlabs/puppet/pull/4911'),
('puppet', 113655, 0, 0, 'Replace win32-process calls with internal API implementations that are wide-string compatible', 'win32-process has some ANSI API calls that may cause problems in a non-US language environment - some of this is captured in PUP-5736\r\n\r\nThis ticket should involve replacing API calls internally where applicable, and PUP-5736 involves the mechanics of removing the gems from puppet-win32-ruby, etc.', 'https://tickets.puppetlabs.com/browse/PUP-5752', '', '2016-01-25T13:31:25.000-0800', '2017-04-12T10:50:08.000-0700', '2017-04-12T10:50:08.000-0700', 'Resolved', 'i18n;utf-8', 3, '0', 0, 0, 0, 0, 'a92de447d2ac728fb3865ca2ae18a7aedc8ccc81', 'https://tickets.puppetlabs.com/browse/PUP-5752', 'https://github.com/puppetlabs/puppet/commit/a92de447d2ac728fb3865ca2ae18a7aedc8ccc81'),
('puppet', 180770, 111022304, 5721, 'hiera5 doesn"t interpolate in encrypted eyaml data', '{code}\r\n[root@vi3cckc8ez3nwsu environments]# cat eyaml_backend2_1jvdmn6q/hieradata/common.yaml\r\n---\r\nenclair: "i see you"\r\ntest_hiera: ENC[PKCS7,MIIBmQYJKoZIhvcNAQcDoIIBijCCAYYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAhv8GjtqL4qmKoLp7QMuc6gdLaDa44rbedyiS+2WPfjG2c9rJ5tQBVmfCHw/Q/gSLCiKSwU9N5XfJ7o8iPAU9MciB5ZraZ90lbbTA8N+7ooor+DabwHEPyd6FfohndSmnphUfriDv9UWpoK9dAX0VULOUEA/t3j7GrXpiskNlzHaYyM/eKmbAgu4CSF5EyNLFf4Erj/Qxmn+lb0EkWPebIzfFZQzIm4BVhwOjww9/eJ4ydWW76GgTJTOGqmp/YM3eS8QJ6TzXAGBKQV3P4FSvDWFyZbBAnqBZPc6C00gxBNAgqEa64+1PVAtFaDqx/LTZmKdprGOjoLWut9WSlkngmjBcBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDCJwtT7eIr5Z0ESO8wfIYmgDBoP+U3GbwDlc38aHfFKiAEZDUX0pde8xlZOhmBZGoj7ds9nvhtGD6x1b90HwTBGh4=]\r\ntest_lookup: ENC[PKCS7,MIIBqQYJKoZIhvcNAQcDoIIBmjCCAZYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAlNuG340KhfR4SODMIztaMUH9BF7a44KTboiNugYNWhesdGRDwc0Hj4Au+YZa0EnNpG70MmIEjdAOqMijGudv6cRR2sixI0NGdryVv2Hc8b9yQtNYKCTwHp5I2k2sTyJF+Eppjmy6h268rYERrQpIEqP8Ia1/4dDo/M7sWsKfyP/BUTzgjBEcrjRGFUgsGKKJEr6gQId32KS3dWH8/+/L+WXrVp979Fp0TrdvYCEKJgFIuWSMXrxyE+RWQ2qt4+y03npbcgoBpVUTSWfeJlAhao5N3Z7va9/uOc/oEqZdv3TDQK6fsaixJsKwo+1UV0LUiKy+f1FX2w1Jn6Z76y0L6DBsBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDC33gi3AidF28icqddIiVFgECtXrSPeJKV7LcSGP4NH6RDqCAGYKBjCySD46SJuo4BszlQeWCayLj8cJXvshHXOBB9WtkQZ2bdJ0e9sCG2+t6Y]\r\na: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEACimJBAyaj5U4p759lk3ue8hVznTER71LvGxW/BANhXJYpp2WpEPmPU1btVnpL4LrB91gajnDbX9CxR+W3kIUzJfbhnTmJug+oiOwZMtiTVxNx/NEslTbWSthue8WoVe56xQqbA7t9JZK3GHmui7yRKYMzUc7gs9zX6cSizmIsqt8qn8RaRmzMTF2BDYbZ0hlBjWqM/7/g8Ci0PsyKJcDdJRov7bQWZVZDbrUqs9oQqUiter0oHVyG7Y35N8gek8bOnKEXkr9KhsQhCTV2UQckehWj0vBZRAkFElHU61b+mABT1VtoF/62ke0ao0xREN+CINBaskD1cU+qMOl75s81jA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAWHhUsXVnc+3xsjgcbMoi6gBBe/zpK1VWLh4AGOa7hqLGs]\r\n[root@vi3cckc8ez3nwsu environments]# puppet lookup a --environment eyaml_backend2_1jvdmn6q\r\n--- a_value\r\n...\r\n[root@vi3cckc8ez3nwsu environments]# puppet lookup test_hiera --environment eyaml_backend2_1jvdmn6q\r\n--- test value with hiera interpolation %{hiera(a)}\r\n...\r\n[root@vi3cckc8ez3nwsu environments]# ls /tmp/keys/private_key.pkcs7.pem\r\nls: cannot access /tmp/keys/private_key.pkcs7.pem: No such file or directory\r\n[root@vi3cckc8ez3nwsu environments]# cat eyaml_backend2_hzxytfvi/hieradata/common.yaml\r\n---\r\nenclair: "i see you"\r\ntest_hiera: ENC[PKCS7,MIIBqQYJKoZIhvcNAQcDoIIBmjCCAZYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAob9W0b/BMfa2JYZhXrTxHXsM++YgvCqungx7nlqxY+2WtnVnpSZf6UaNAOrWD+etXGGVqO7cLBlkEEOU7mfNGbE6eu6uIu6hTdX6w9NtY3rEKT8Wjbgzs+Ig7FP1/5KR4rrCv6nEkhlmopK2fxKJZ8H5fZDZvl4Y1y7ozWN/YwRjWNx2dJjpjsM8/COsWkQykclvsTTgUQwFFkP/NWph8+0umV/UhbEBrYtcWLdEHyQ+gCNlGJFQ1eeB9EZd0bnr46vD49Icb6HpP3u5MofxTS6HbbmJPCjYW4hfzXTs6lrMiuggeFI2M3jSLZpsfcghf6OmVPb3EHlVEuKb7ohosTBsBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBApsllLIrkTZPJaEcQ+vsXkgEDhHvGIJXk+Wy4Ie0HkBCF6XukUY+zUY9f4JTXucCT2AP2aMAP71t464sz/SRQR2F1dTii/OBtgpF17E9xfajM3]\r\ntest_lookup: ENC[PKCS7,MIIBqQYJKoZIhvcNAQcDoIIBmjCCAZYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAAqJSNWSGlC/nFUU+gZIylGjF2QWrFYnxv7wJAugp0CBULaCyuoE5jhFpSyxq51BuM7ZP+LM4noeLDOycl7LbmMpBWR7YPKNmuTb4Tn7eQyfgVOW4gn2HbJWWidZgGTjRl+hNGrlOGvFOJdwqZ9c7J5eZfs3xkkJUFclVHYylr9nbIEtCW0VynxWB5pCwNnvBz4iYRclbIq2Rr1kq7qngagahavQ9oHrVFHaA5ndcVHPZzuNo8KwY+cXhYmmxDe25odkPSfIVJTJlFNarckxroaYhdNhozEktllnQ9F8vuDQfmhjjbiD0r8+a2QqdGkafToLALrigAA2lqUE3+heStzBsBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBCpsGEnaV6kS8fEfOW5R+2xgECgXyVAMVvOdtqKX15SHjZADzTOxx7ZC2GEx0r6OtEEDASc2ys8iMAJbRZEL0tRW5auWVGV2BhTgBnEYh79f+wV]\r\na: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEATrH/t1PCki/fRmncjSP1ZIEWORtfAVDGfKyRfBb30Y0TpVbGWDW1bOz0N9aHDKSf5EuaPQiL47BjBLZhSFiL0xWHltT7ttXO0hTwuCAq8uu397MrnI2WvNkFVE5f3QGb8+Wt45yWiGUYrp3YWIRo9C04FeJNtqxCnJC6pr43GTAJxHz+NRZTwZQNMCb6TAB6FDJJSzfgNGZqxoTTFmERzajZ2wIG4D1g2qBXHSmASUYHP6KLDBajVlZQUkQGTGo3mOP9LDi1Ui7WPTRslQXfyPcCNRRzLxEb0aU/mUVXzPoxFjg9UaMa8ej+lHRtROfHEz6BV6WOvJpML5N0+rt2+DA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBBZD2lwDoR6ohoBSorOnzr0gBB+cgnAJ6RQTXZ4nuIh5PEU]\r\n[root@vi3cckc8ez3nwsu environments]#\r\n[root@vi3cckc8ez3nwsu environments]# cat eyaml_backend2_kvc8fyx4/hiera.yaml\r\n---\r\nversion: 5\r\nhierarchy:\r\n  - name: "common"\r\n    lookup_key: eyaml_lookup_key\r\n    datadir: hieradata\r\n    path: "common.yaml"\r\n    options:\r\n      pkcs7_private_key: "/tmp/keys/private_key.pkcs7.pem"\r\n      pkcs7_public_key: "/tmp/keys/public_key.pkcs7.pem"\r\n[root@vi3cckc8ez3nwsu environments]# cat eyaml_backend2_kvc8fyx4/hieradata/common.yaml\r\n---\r\nenclair: "i see you"\r\ntest_hiera: ENC[PKCS7,MIIBqQYJKoZIhvcNAQcDoIIBmjCCAZYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAVAvZnONpBjO1PeLEeoGBvnHgHqeaBau7IINXjpSSbMIBFzBUmHGChVxl6NIfnxJeZSf3c6sgUhphh67cPFQSXOreuWyWoxutD71++yP1rQlg8SEgTKbRtm9OeFfzXP4abAnIodmbVM2tvrcp9YtVJIoj4cEtbeI5kCgAaZc88eQt9oG8H3HxkvmJkkn/BG/BXQMIOWPXL23DMfTMfpdyS2naIcVC7IP2bUkXrA/gwjSDo5L5n+xmszmgW67Jvdj5oac9Aj3MdsP15x5xt7pyyFFgp9n78cqeZuW4jqRJKtIrQojiOY1cCAQxHboomjdUzksBDF8eVxIB4mhRWdhbLjBsBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBDI3EXpPE7LvjxTKbbQH4NZgEDxumxiA6Rh/AjccpmQ+FG2aw6GBMd2HKV7n2Z1hX+L9l9/mjNlSgBL5SjiUzcp8izSb57dJ70lilyJZQsjyXMl]\r\ntest_lookup: ENC[PKCS7,MIIBqQYJKoZIhvcNAQcDoIIBmjCCAZYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAZSShL7CtKW0fLbRDvM74EB0FOmdV4YNDzq8U7tHm5YGPLQn+5ZLfhe0BvHZSUW95DCgSiJiwSMq9kBe6mBxx2U70Jbu87w7Kv3QzbN1c6GW8BavJitATs6dYYY3byfmrvvPv7MC5TswNJvhPx1Os3jE+R4z0gWTgOF+QwXOua4Z1no4bpGOHjrtxWowLwdktDmGESvs/g/H8rpA3CO873bjzRj33NaKRFNraA2by9K2/nkfRNHCeMP5K/z0t8OBZXoqR9HtVVvwcIeM5HUMfmAg1hjsuAXrwY+I3Q9M2PgebzX4orC8XOMIp9n3e4bpkimSP211+ot++FJiiUzB4GTBsBgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAt5SN7oOgZRaFWbIdRohungED3mpE5hvHd+2nECGMXlJxPjp2730ip+mcrMA271rWEHIeBvQMzmWPLIDHhQDVYAN+f4ZXomUPfxTw/Z6ItUMVl]\r\na: ENC[PKCS7,MIIBeQYJKoZIhvcNAQcDoIIBajCCAWYCAQAxggEhMIIBHQIBADAFMAACAQEwDQYJKoZIhvcNAQEBBQAEggEAGAYLe28feCFW8z8IdYyU3aws0S7caZgKP9xw47bOnETEmTLAyEbSRgz/c9WKmDVGb66l10wiVT4reCcENPHTQBgDLhRmLqFdcNIRWhkZIuCV2lddJbnsc/r33lIwJ8y88hfnGWJOhHPIoT6foucdId8oS/40qlGaZAY0ylz2hvQHxk+vmCMVOnk59DXCToMqdBM8YFKGiHzqJx9+HR+gE/A6zTDBQo8WD4W7D/SBWdNc6p2VRLamXWlphifp9xIr11vvWrwq5IdZblKzKLa762zcN3YYTvyfPAQwFC++KCm8TpKFjCP9VLNKTZrBY75TTvFpA5XeVr33XPXwwOBrwzA8BgkqhkiG9w0BBwEwHQYJYIZIAWUDBAEqBBAXv3L3YJj57cyLPcAylQiUgBBhGu5F0uJbrYByZ7PdiMiE]\r\n[root@vi3cckc8ez3nwsu environments]# puppet lookup a --environment eyaml_backend2_kvc8fyx4\r\n--- a_value\r\n...\r\n[root@vi3cckc8ez3nwsu environments]# puppet lookup test_hiera --environment eyaml_backend2_kvc8fyx4\r\n--- test value with hiera interpolation %{hiera("a")}\r\n...\r\n[root@vi3cckc8ez3nwsu environments]# puppet lookup test_lookup --environment eyaml_backend2_kvc8fyx4\r\n--- test value with hiera interpolation %{lookup("a")}\r\n...\r\n[root@vi3cckc8ez3nwsu environments]# cat eyaml_backend2_kvc8fyx4/manifests/site.pp\r\nnotify { "lookup_clair2: ${lookup("enclair")}": }\r\nnotify { "a2: ${lookup("a")}": }\r\nnotify { "lookup2: ${lookup("test_lookup")}": }\r\nnotify { "hiera2: ${hiera("test_hiera")}": }\r\nnotify { "lookup_hiera2: ${lookup("test_hiera")}": }\r\nnotify { "hiera_lookup2: ${hiera("test_lookup")}": }\r\n[root@vi3cckc8ez3nwsu environments]# puppet agent -t --environment eyaml_backend2_kvc8fyx4 --server $(hostname -f)\r\nInfo: Using configured environment "eyaml_backend2_kvc8fyx4"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Caching catalog for vi3cckc8ez3nwsu.delivery.puppetlabs.net\r\nInfo: Applying configuration version "1489622729"\r\nNotice: lookup_clair2: i see you\r\nNotice: /Stage[main]/Main/Notify[lookup_clair2: i see you]/message: defined "message" as "lookup_clair2: i see you"\r\nNotice: a2: a_value\r\nNotice: /Stage[main]/Main/Notify[a2: a_value]/message: defined "message" as "a2: a_value"\r\nNotice: lookup2: test value with hiera interpolation %{lookup("a")}\r\nNotice: /Stage[main]/Main/Notify[lookup2: test value with hiera interpolation %{lookup("a")}]/message: defined "message" as "lookup2: test value with hiera interpolation %{lookup("a")}"\r\nNotice: hiera2: test value with hiera interpolation %{hiera("a")}\r\nNotice: /Stage[main]/Main/Notify[hiera2: test value with hiera interpolation %{hiera("a")}]/message: defined "message" as "hiera2: test value with hiera interpolation %{hiera("a")}"\r\nNotice: lookup_hiera2: test value with hiera interpolation %{hiera("a")}\r\nNotice: /Stage[main]/Main/Notify[lookup_hiera2: test value with hiera interpolation %{hiera("a")}]/message: defined "message" as "lookup_hiera2: test value with hiera interpolation %{hiera("a")}"\r\nNotice: hiera_lookup2: test value with hiera interpolation %{lookup("a")}\r\nNotice: /Stage[main]/Main/Notify[hiera_lookup2: test value with hiera interpolation %{lookup("a")}]/message: defined "message" as "hiera_lookup2: test value with hiera interpolation %{lookup("a")}"\r\nNotice: Applied catalog in 0.02 seconds\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7359', 'https://github.com/puppetlabs/puppet/pull/5721', '2017-03-15T17:07:57.000-0700', '2017-04-13T00:21:05.000-0700', '2017-04-13T00:21:05.000-0700', 'Closed', 'docs_reviewed', 4, '0', 1, 24, 3, 2, 'e4512066582245cca6a9a722e4519d8716c0c7a9', 'https://tickets.puppetlabs.com/browse/PUP-7359', 'https://github.com/puppetlabs/puppet/pull/5721'),
('puppet', 183700, 113814089, 5774, 'Lookups are logged as both lookup and APL when using log-level debug', 'When using log-level debug, a call to lookup will output the information from the lookup explainer.  This happens twice when the lookup originates from a call to the lookup function. The second time, the lookup appears to be an APL (Automatic Parameter Lookup).\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7420', 'https://github.com/puppetlabs/puppet/pull/5774', '2017-04-02T03:31:08.000-0700', '2017-05-11T07:04:45.000-0700', '2017-05-11T07:04:45.000-0700', 'Closed', '', 1, '0', 3, 38, 10, 3, '06a1a6deda679c092628d41d357f37e6ed181f32', 'https://tickets.puppetlabs.com/browse/PUP-7420', 'https://github.com/puppetlabs/puppet/pull/5774'),
('puppet', 184369, 114480036, 5783, 'Fix inconsistent Regexp to String conversion in StringConverter', 'The StringConverter currently converts a Regexp to a string that starts and end with a slash by default. This is inconsistent with how a Regexp is created from a string. The constructor does not expect the slashes.\r\n\r\nThe default format (denoted by "%s") should produce a string without the slash delimiters. The alternate format (denoted with "%#s") should remain as is, and produce a string that is quoted.\r\n\r\nThe output with slash delimiters can be still be achieved (as before) using the "%p" format.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7429', 'https://github.com/puppetlabs/puppet/pull/5783', '2017-04-05T13:25:14.000-0700', '2017-05-11T07:04:46.000-0700', '2017-05-11T07:04:46.000-0700', 'Closed', '', 3, '0', 4, 69, 15, 5, 'bfb07a1cb89095ed2157b6c1b225b8c27dc151fa', 'https://tickets.puppetlabs.com/browse/PUP-7429', 'https://github.com/puppetlabs/puppet/pull/5783'),
('puppet', 183528, 113807185, 5773, 'Deep merge regression when a value of subkey is an alias or an hiera interpolation', 'Hi,\r\n\r\nHere is the function which provides default data of my {{test}} module:\r\n\r\n{code:puppet}\r\nfunction test::data (\r\n  Hash                  $options,\r\n  Puppet::LookupContext $context,\r\n) {\r\n\r\n  {\r\n    test::param => { "a" => "a", "b" => "b" },\r\n\r\n    lookup_options => {\r\n       test::param => { merge => "deep", },\r\n    },\r\n\r\n  }\r\n\r\n}\r\n{code}\r\n\r\nHere is the my {{common.yaml}} file:\r\n\r\n{code:yaml}\r\n---\r\nfoo: "123456"\r\n{code}\r\n\r\nand here is my {{fqdn/$fqdn.yaml}} file:\r\n\r\n{code:yaml}\r\n---\r\ntest::param:\r\n  a: "specific-a"\r\n  c: "specific-c"\r\n{code}\r\n\r\nI"m using Hiera 5 with Puppet 4.9.4.\r\n\r\nWith this config, I have the expected behavior:\r\n\r\n{code:bash}\r\n~# puppet lookup "test::param" \r\n---\r\na: specific-a\r\nb: b\r\nc: specific-c\r\n{code}\r\n\r\nNow I change my {{fqdn/$fqdn.yaml}} file to:\r\n\r\n{code:yaml}\r\n---\r\n# I insert an alias() interpolation in the value of the subkey "c".\r\ntest::param:\r\n  a: "specific-a"\r\n  c: "%{alias("foo")}"\r\n{code}\r\n\r\nAnd now the deep merge works no longer:\r\n\r\n{code:bash}\r\n~# puppet lookup "test::param" \r\n---\r\na: specific-a\r\nc: "123456"\r\n{code}\r\n\r\nIt seems to be the result with the {{first}} merge policy, not {{deep}}.\r\n\r\n1. If I insert a {{hiera()}} interpolation, I have the same problem.\r\n2. I have tested with the eyaml backend _and_ the standard yaml_data backend, same problem.\r\n3. I"m sure it worked with puppet-agent 1.8.2 ie Puppet version 4.8.1 because it was the case in my production server.\r\n\r\nRegards.\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7418', 'https://github.com/puppetlabs/puppet/pull/5773', '2017-03-31T12:21:11.000-0700', '2017-05-11T07:04:47.000-0700', '2017-05-11T07:04:47.000-0700', 'Closed', 'regression', 14, '0', 2, 73, 20, 5, '64db179f3259b7d1be13ae7715098631dde2128a', 'https://tickets.puppetlabs.com/browse/PUP-7418', 'https://github.com/puppetlabs/puppet/pull/5773'),
('puppet', 93953, 43233651, 4190, 'launchd enable/disable on OS X 10.10', 'Similar to PUP-4738, the proper overrides plist is not used on 10.10.  This prevents services from being properly enabled or disabled on 10.10.', 'https://tickets.puppetlabs.com/browse/PUP-5044', 'https://github.com/puppetlabs/puppet/pull/4190', '2015-08-17T16:43:19.000-0700', '2017-05-15T11:22:55.000-0700', '2017-05-15T11:22:55.000-0700', 'Closed', '', 4, '0', 1, 69, 20, 1, 'c50195d7ac36bc974316094766f10aa2e523d2db', 'https://tickets.puppetlabs.com/browse/PUP-5044', 'https://github.com/puppetlabs/puppet/pull/4190'),
('puppet', 120880, 68956950, 4941, 'improve getting nested keys from hash', 'In a blog post, [~ripienaar] writes:\r\n{quote}\r\nThis \[structured facts] makes everything better. It’s also structured data but this is still a bit awkward in Puppet:\r\n\r\n{code:puppet}\r\n$x = $facts["foo"]["bar"]["baz"]\r\n{code}\r\n\r\nThere seems to be no elegant way to handle a missing ‘foo’ or ‘bar’ key, things just fail badly in ways you can’t catch or recover from. On the CLI you can do facter foo.bar.baz so we’re already careful to not have “.” in a key. \r\n{quote}\r\n\r\nWe can actually use multiple keys in an access operator (you can directly slice an array with two arguments (from, to). We could use this for hash as well to mean a progression of key lookups producing undef if one key produces undef.\r\n\r\nThe example would then be written:\r\n{quote:puppet}\r\n$x = $facts[foo, bar, baz]\r\n{quote}\r\nit would also allow getting a value from an array in by using a numeric key. Slicing can also be supported if the key is an array. Example, "baz" is an array and we want the last 2 elements.\r\n{quote:puppet}\r\n$x = $facts[foo, bar, baz, [-2, 2]]\r\n{quote}\r\n\r\nUPDATE\r\n----\r\nThe original proposal would only work for hashes, as the access operator for array (and string) performs a slicing operation.\r\nA better solution is therefore to add a "dig" function that performs a series of access operations and that stops with {{undef}} result if one access in the chain produces {{undef}}.\r\n\r\nTo complete the support for "chain of operations" the accompanying functions "then" and "lest" round out the functionality. \r\nThe PR for this ticket therefore contains the three functions "dig", "then" and "lest".\r\n\r\nThe *dig* function performs a sequence of access operations on a complex collection similar to the "dot-notation" used in hiera and facter.\r\nFor example:\r\n{code:puppet}\r\n$some_data.dig(somekey, 1, otherkey)\r\n{code}\r\n\r\nIf, at any point, the intermediate result is {{undef}} the operation stops and returns {{undef}}. It is an error to attempt to access something in a value that is neither Array nor Hash.\r\n\r\nThe *then* function, accepts a single argument, and if it is not {{undef}} if calls a given block with the value. If given {{undef}} the block is not called and {{undef}} is returned.\r\n\r\nThe *lest* function is the reverse of *then*. If given {{undef}} it calls the given block (without arguments), and returns what the block produced. If given something that is not {{undef}} it returns that value.\r\n\r\nExample:\r\n{code:puppet}\r\n$some_structure.process()\r\n  .then |$x| { $x.process_some_more() }\r\n  .then |$x| { $x.process_further() }\r\n  .lest || { fail("processing of structure resulted in undef value") }\r\n{code}\r\n\r\nOr if a default value is wanted - in the middle of the chain if {{undef}} was the temporary result:\r\n{code:puppet}\r\n$some_structure.process()\r\n  .then |$x| { $x. process_some_more() }\r\n  .lest || { 42 }\r\n  .then |$x| { $x.process_further() }\r\n{code}\r\n\r\nNaturally, for simple cases, a regular if/then/else expression or case expression is clearer - but for any chain of lookups, transformations, etc. where intermediate results are obtained and those can be {{undef}} the functional composition chain is a valuable tool as it results in more readable logic.\r\n\r\nIn practice, the "dig" function can produce the entire chain of access operations unless something needs to be done to a value in the middle of the chain (such as using it to lookup in hiera) before continuing. These are the cases when "then" and "lest" come into play.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6046', 'https://github.com/puppetlabs/puppet/pull/4941', '2016-03-11T08:25:10.000-0800', '2017-05-15T15:11:53.000-0700', '2017-05-15T15:11:53.000-0700', 'Closed', 'DSL', 7, '0', 12, 299, 1, 7, 'd99c47018c3c3867ba7e84f67f8fb6653522a5ee', 'https://tickets.puppetlabs.com/browse/PUP-6046', 'https://github.com/puppetlabs/puppet/pull/4941'),
('puppet', 74750, 32852415, 3798, 'Resource collectors can be assigned to variables by abusing chaining statements', 'The 4x parser generally refuses to produce values from resource collectors, and errors if you put one where a value is expected. But since the value of a chaining statement is just the final term of the statement (regardless of arrow direction) and _they_ accept collectors as operands:\r\n\r\n{code}\r\nnotify {"I go last.":}\r\n$myweirdchain = (file {"/tmp/thing": ensure => file,} -> Notify <| |>)\r\nnotice( $myweirdchain )\r\n{code}\r\n\r\n{code}\r\nNotice: Scope(Class[main]): [#<Puppet::Pops::Evaluator::Collectors::CatalogCollector:0x007fe33da72c90>]\r\n{code}\r\n\r\nI don"t really have anything to add, and probably no one will ever try to do that. But it does seem unintended. \r\n\r\nrisk: medium (manual validate only for now)\r\nprobability: low\r\nseverity: medium (confusion, possible abuse?)\r\ntest layer: unit (no unit tests added in PR. [~henrik.lindberg] can you comment on if you think this needs testing, and at what layer?)', 'https://tickets.puppetlabs.com/browse/PUP-4378', 'https://github.com/puppetlabs/puppet/pull/3798', '2015-04-06T15:53:51.000-0700', '2017-05-15T16:40:50.000-0700', '2017-05-15T16:40:50.000-0700', 'Closed', '', 8, '0', 1, 10, 0, 3, '0b451dcb4ab6ed1842a84a6082fd9f2bd37628ed', 'https://tickets.puppetlabs.com/browse/PUP-4378', 'https://github.com/puppetlabs/puppet/pull/3798'),
('puppet', 21407, 511778815, 8425, 'Support common package name in two different providers', 'I have a common package name, that"s in two different package managers\r\n(one with yum the other with gem)\r\n\r\n{code}\r\n        package { "remove-mysql":\r\n                name     => "mysql",\r\n                provider => "yum",\r\n                ensure   => absent,\r\n        }\r\n{code}\r\n---------------------------------------------------------\r\n{code}\r\n        package { "gem-mysql":\r\n                name    => "mysql",\r\n                ensure   => "2.7",\r\n                provider => gem,\r\n        }\r\n{code}\r\n---------------------------------------------------------\r\n\r\nI get this error.\r\n\r\n{noformat}\r\nJul  3 08:43:34 puppetd[11872]: Could not retrieve catalog:\r\nPuppet::Parser::AST::Resource failed with error ArgumentError: Cannot\r\nalias Package[gem-mysql] to mysql; resource Package[mysql] already\r\nexists at /etc/puppet/modules/ruby-mysql/manifests/init.pp:11 on node \r\n{noformat}\r\n\r\n----\r\n\r\nThe solution to this was to generate a uniqueness key based on {{\[name, provider\]}}, as mentioned by [~andy]. That allows the example above to work, but doesn"t resolve when multiple providers manage the same package. Several changes were needed:\r\n# Set {{paramclass(:provider).isnamevar}} on the Package type, so the {{:provider}} parameter is recognized as part of the namevar.\r\n# Overloaded the {{title_patterns}} method on the Package type, so the {{title}} could be parsed into namevars (it only sets {{:name}}, not {{:provider}}).\r\n# The {{catalog}} assumed that isomorphic resources only needed to be aliased if the {{title}} and {{name}} didn"t match. An alias is automatically created for a resource"s {{title}}; if {{titles}} don"t match but the {{namevar}} does they should still refer to the same thing. However, {{name}} is not equivalent to {{namevar}} for a {{composite namevar}}, so the test for whether to create an alias uses the {{uniqueness_key}} (an array containing all {{namevars}}). The impact of this change is to correctly identify when a resource with a {{composite namevar}} has already been created, as in\r\n{code}\r\npackage { "add-mysql":\r\n  name   => "mysql",\r\n  ensure => present,\r\n}\r\n\r\npackage { "mysql":\r\n  ensure => present,\r\n}\r\n{code}\r\n# The change to {{catalog}} means that creating aliases now depends on the {{uniqueness_key}}. That implementation in {{resource}} type could end up returning an array without the name specified if the {{:name}} parameter wasn"t specifically specified. This change was made so conflicts between implicit and explicit default provider are detected at catalog compilation instead of trying to apply the manifest.\r\n\r\nChanges (1) and (2) are required for any provider that uses a composite namevar.\r\n\r\nImpact of this change:\r\n* Querying resources by name on the command-line when multiple packages from different providers are specified only returns the package with the default provider (PUP-3721).\r\n* Referring to Package resources by {{Package[$namevar]}} in Puppet code doesn"t work for a {{composite namevar}}, so it no longer works for Package. Querying by {{Package[$title]}} still works. This is a breaking change in Puppet 4.', 'https://tickets.puppetlabs.com/browse/PUP-1073', 'https://github.com/puppetlabs/puppet/pull/8425', '2013-12-16T10:51:34.000-0800', '2017-05-17T10:39:46.000-0700', '2017-05-17T10:39:46.000-0700', 'Closed', 'redmine', 30, '0', 6, 158, 87, 21, '3ebdccffe65396d5b87f6f1dc5e3454a0e59ea64', 'https://tickets.puppetlabs.com/browse/PUP-1073', 'https://github.com/puppetlabs/puppet/pull/8425'),
('puppet', 92434, 41910656, 4142, 'Fix acceptance tests for ubuntu-1504', 'Running the acceptance test suite from a git installation of puppet stable at SHA 7b8372d624 on ubuntu-1504-x86_64.yaml results in failing tests.\r\n\r\nh3. Method of test execution\r\n{code}\r\ncd acceptance\r\nbundle install\r\nSHA="7b8372d624" CONFIG=config/nodes/ubuntu-1504-x86_64.yaml TESTS=tests  bundle exec rake ci:test:git\r\n{code}\r\n\r\nh3. Tests with errors or failures\r\n{code}\r\ntests/config/puppet_manages_own_configuration_in_robust_manner.rb errored in 22.92 seconds    # exits with 1 rather than 74\r\n\r\ntests/ensure_puppet-agent_paths.rb failed in 1.49 seconds    # fails due to non-aio environment\r\n\r\ntests/resource/service/ticket_14297_handle_upstart.rb errored in 3.04 seconds\r\n\r\ntests/modules/uninstall/using_directory_name.rb errored in 2.45 seconds     # PMT failure\r\ntests/modules/uninstall/using_version_filter.rb errored in 4.87 seconds     # PMT failure\r\ntests/modules/uninstall/with_module_installed.rb errored in 2.51 seconds     # PMT failure\r\ntests/modules/upgrade/in_a_secondary_directory.rb errored in 6.88 seconds     # PMT failure\r\ntests/modules/install/already_installed_elsewhere.rb failed in 10.49 seconds     # PMT failure\r\ntests/modules/list/with_circular_dependencies.rb failed in 2.46 seconds     # PMT failure\r\ntests/modules/list/with_invalid_dependencies.rb failed in 2.70 seconds     # PMT failure\r\ntests/modules/list/with_missing_dependencies.rb failed in 2.71 seconds     # PMT failure\r\ntests/modules/list/with_repeated_dependencies.rb failed in 3.95 seconds     # PMT failure\r\ntests/modules/uninstall/with_active_dependency.rb failed in 2.58 seconds     # PMT failure\r\n{code}\r\n\r\nh3. Common failures using ubuntu-1404-x86_64\r\nSuspecting that the environment rather than the code or tests may be the issue, I ran the same suite using the ubuntu-1404-x86_64 node configuration. The following tests resulted in errors or failures\r\n{code}\r\ntests/config/puppet_manages_own_configuration_in_robust_manner.rb\r\n\r\ntests/ensure_puppet-agent_paths.rb\r\n\r\ntests/modules/install/already_installed_elsewhere.rb\r\ntests/modules/list/with_circular_dependencies.rb\r\ntests/modules/list/with_invalid_dependencies.rb\r\ntests/modules/list/with_missing_dependencies.rb\r\ntests/modules/list/with_repeated_dependencies.rb\r\ntests/modules/uninstall/with_active_dependency.rb\r\ntests/modules/uninstall/using_directory_name.rb\r\ntests/modules/uninstall/using_version_filter.rb\r\ntests/modules/uninstall/with_module_installed.rb\r\ntests/modules/upgrade/in_a_secondary_directory.rb\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5010', 'https://github.com/puppetlabs/puppet/pull/4142', '2015-08-06T17:33:47.000-0700', '2017-05-17T16:13:12.000-0700', '2017-05-17T16:13:12.000-0700', 'Closed', '', 2, '0', 1, 2, 0, 1, '7fc469c3fce725fba1a0b8b947b0654433528df8', 'https://tickets.puppetlabs.com/browse/PUP-5010', 'https://github.com/puppetlabs/puppet/pull/4142'),
('puppet', 92433, 41928803, 4143, 'Fix "git" acceptance tests', 'Running the acceptance test suite from a git installation of puppet stable at SHA 7b8372d624 on fedora-22-x86_64.yaml results in failing tests.\r\n\r\nh3. Method of test execution\r\n{code}\r\ncd acceptance\r\nbundle install\r\nSHA="7b8372d624" CONFIG=config/nodes/fedora-22-x86_64.yaml TESTS=tests  bundle exec rake ci:test:git\r\n{code}\r\n\r\nh3. Tests with errors or failures\r\n{code}\r\ntests/config/puppet_manages_own_configuration_in_robust_manner.rb errored in 22.68 seconds    # exits with 1 rather than 74\r\n\r\ntests/ensure_puppet-agent_paths.rb failed in 1.56 seconds    # fails due to non-aio environment\r\n\r\ntests/resource/package/common_package_name_in_different_providers.rb failed in 48.36 seconds   # PUP-4055\r\ntests/resource/package/yum.rb failed in 6.44 seconds  # PUP-4055\r\n\r\ntests/modules/uninstall/using_directory_name.rb errored in 2.50 seconds    # PMT Failure\r\ntests/modules/uninstall/using_version_filter.rb errored in 4.61 seconds    # PMT Failure\r\ntests/modules/uninstall/with_module_installed.rb errored in 2.55 seconds    # PMT Failure\r\ntests/modules/upgrade/in_a_secondary_directory.rb errored in 7.26 seconds    # PMT Failure\r\ntests/modules/install/already_installed_elsewhere.rb failed in 8.09 seconds    # PMT Failure\r\ntests/modules/list/with_circular_dependencies.rb failed in 2.46 seconds    # PMT Failure\r\ntests/modules/list/with_invalid_dependencies.rb failed in 2.59 seconds    # PMT Failure\r\ntests/modules/list/with_missing_dependencies.rb failed in 2.56 seconds    # PMT Failure\r\ntests/modules/list/with_repeated_dependencies.rb failed in 3.51 seconds    # PMT Failure\r\ntests/modules/uninstall/with_active_dependency.rb failed in 2.55 seconds    # PMT Failure\r\n{code}\r\n\r\nh3. Common failures using ubuntu-1404-x86_64\r\nSuspecting that the environment rather than the code or tests may be the issue, I ran the same suite using the ubuntu-1404-x86_64 node configuration. The following tests resulted in errors or failures\r\n{code}\r\ntests/config/puppet_manages_own_configuration_in_robust_manner.rb\r\n\r\ntests/ensure_puppet-agent_paths.rb\r\n\r\ntests/modules/install/already_installed_elsewhere.rb\r\ntests/modules/list/with_circular_dependencies.rb\r\ntests/modules/list/with_invalid_dependencies.rb\r\ntests/modules/list/with_missing_dependencies.rb\r\ntests/modules/list/with_repeated_dependencies.rb\r\ntests/modules/uninstall/with_active_dependency.rb\r\ntests/modules/uninstall/using_directory_name.rb\r\ntests/modules/uninstall/using_version_filter.rb\r\ntests/modules/uninstall/with_module_installed.rb\r\ntests/modules/upgrade/in_a_secondary_directory.rb\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5009', 'https://github.com/puppetlabs/puppet/pull/4143', '2015-08-06T17:27:09.000-0700', '2017-05-17T16:13:12.000-0700', '2017-05-17T16:13:12.000-0700', 'Closed', '', 15, '0', 2, 27, 5, 2, '3a28534ea9a175cd2f01348bdb0f4dbb4cbf568d', 'https://tickets.puppetlabs.com/browse/PUP-5009', 'https://github.com/puppetlabs/puppet/pull/4143'),
('puppet', 51983, 42849373, 4177, 'Puppet prints warning when "environment" is set using classifier rather than local puppet.conf ', 'We set the environment in the external node classifier and don"t have one set locally.\r\n\r\nPuppet seems to default to the "production" environment in case you don"t have one set and it turns into:\r\n\r\n{noformat}\r\nWarning: Local environment: "production" doesn"t match server specified node environment "devel", switching agent to "devel".\r\n{noformat}\r\n\r\n"devel" is the environment currently set for this node.\r\nWe didn"t specify "production" anywhere manually.\r\n\r\nI think that when a user DOESN"T specify any environment in the puppet.conf file but sets it in the classifier, this warning seems superfluous.\r\n\r\nThis is the local puppet.conf:\r\n{noformat}\r\n[main]\r\nlogdir=/var/log/puppet\r\nvardir=/var/lib/puppet\r\nssldir=/var/lib/puppet/ssl\r\nrundir=/var/run/puppet\r\n\r\nhttp_compression = true\r\n\r\n[agent]\r\n server = master.e.some.thing.com\r\n certname = srv-13.some.thing.com\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3318', 'https://github.com/puppetlabs/puppet/pull/4177', '2014-09-19T11:24:06.000-0700', '2017-05-17T16:13:12.000-0700', '2017-05-17T16:13:12.000-0700', 'Closed', '', 2, '0', 1, 2, 2, 1, '42f7de3f2213c7bef7a8988e9b8684e281d8380d', 'https://tickets.puppetlabs.com/browse/PUP-3318', 'https://github.com/puppetlabs/puppet/pull/4177'),
('puppet', 16556, 49055152, 4385, 'bad permissions on autosign.conf blow up the master', 'If the ownership of autosign.conf doesn"t allow the master to fix permissions, it blows up and returns a passenger HTML stack trace to the agent. And a DB migration??\r\n\r\n{code}\r\n# /var/log/messages:\r\nOct  4 18:02:17 classroom puppet-master[7204]: Could not prepare for execution: Got 2 failure(s) while initializing: failed to set mode 666 on /etc/puppetlabs/puppet/autosign.conf: Operation not permitted - /etc/puppetlabs/puppet/autosign.conf; change from 0666 to 0644 failed: failed to set mode 666 on /etc/puppetlabs/puppet/autosign.conf: Operation not permitted - /etc/puppetlabs/puppet/autosign.conf\r\n{code}\r\n\r\n{code}\r\n# /var/log/pe-httpd/error.log\r\n[ 2013-10-04 17:53:48.6164 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6070 stdout]\r\n[ 2013-10-04 17:53:50.3167 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:53:50.3169 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:53:51.0771 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6109 stdout]\r\n[ 2013-10-04 17:53:52.4259 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:53:52.4260 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:53:52.4335 4322/b22f8b70 apache2/Hooks.cpp:758 ]: Unexpected error in mod_passenger: write() failed: Broken pipe (errno=32)\r\n  Backtrace:\r\n     (empty)\r\n[ 2013-10-04 17:55:47.4024 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6208 stdout]\r\n[ 2013-10-04 17:55:48.6929 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:55:48.6931 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:55:49.1003 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6232 stdout]\r\n[ 2013-10-04 17:55:50.3623 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:55:50.3625 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:55:50.5541 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6255 stdout]\r\n[ 2013-10-04 17:55:51.8690 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:55:51.8693 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:55:53.0011 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6457 stdout]\r\n[ 2013-10-04 17:55:54.3904 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:55:54.3906 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:55:54.7162 4304/b62beb70 Pool2/Spawner.h:738 ]: [App 6480 stdout]\r\n[ 2013-10-04 17:55:56.1644 4304/b62beb70 Pool2/Implementation.cpp:777 ]: Could not spawn process for group /var/opt/lib/pe-puppetmaster#default: An error occured while starting up the preloader.\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::handleErrorResponse(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:455)\r\n     in "std::string Passenger::ApplicationPool2::SmartSpawner::negotiatePreloaderStartup(Passenger::ApplicationPool2::SmartSpawner::StartupDetails&)" (SmartSpawner.h:558)\r\n     in "void Passenger::ApplicationPool2::SmartSpawner::startPreloader()" (SmartSpawner.h:206)\r\n     in "virtual Passenger::ApplicationPool2::ProcessPtr Passenger::ApplicationPool2::SmartSpawner::spawn(const Passenger::ApplicationPool2::Options&)" (SmartSpawner.h:744)\r\n     in "void Passenger::ApplicationPool2::Group::spawnThreadRealMain(const Passenger::ApplicationPool2::SpawnerPtr&, const Passenger::ApplicationPool2::Options&, unsigned int)" (Implementation.cpp:710)\r\n\r\n[ 2013-10-04 17:55:56.1646 4304/b60ffb70 agents/HelperAgent/RequestHandler.h:1892 ]: [Client 20] Cannot checkout session. An error occured while starting up the preloader.\r\nError page:\r\nexit (SystemExit)\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `exit"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:518:in `rescue in exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util.rb:504:in `exit_on_fail"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/application.rb:362:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:132:in `run"\r\n  /opt/puppet/lib/ruby/site_ruby/1.9.1/puppet/util/command_line.rb:86:in `execute"\r\n  config.ru:28:in `block in <main>"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval"\r\n  /opt/puppet/lib/ruby/gems/1.9.1/gems/rack-1.4.5/lib/rack/builder.rb:51:in `initialize"\r\n  config.ru:1:in `new"\r\n  config.ru:1:in `<main>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `eval"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:82:in `preload_app"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:127:in `<module:App>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>"\r\n  /opt/puppet/share/phusion_passenger/helper-scripts/rack-preloader.rb:5:in `<main>"\r\n\r\n[ 2013-10-04 17:55:56.1662 4323/b0ef6b70 apache2/Hooks.cpp:758 ]: Unexpected error in mod_passenger: write() failed: Broken pipe (errno=32)\r\n  Backtrace:\r\n     (empty)\r\n[ 2013-10-04 17:56:31.4204 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:32.9585 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:32.9586 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] >>> Redirecting RubyCAS-Server log to /var/log/pe-console-auth/cas.log\r\n[ 2013-10-04 17:56:32.9586 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.0011 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.0012 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] >>> Running migrations to make sure your database schema is up to date...\r\n[ 2013-10-04 17:56:33.0012 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.0614 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (1.0ms)  SELECT "schema_migrations"."version" FROM "schema_migrations"\r\n[ 2013-10-04 17:56:33.0615 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] Migrating to CreateInitialStructure (1)\r\n[ 2013-10-04 17:56:33.0621 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.2ms)  BEGIN\r\n[ 2013-10-04 17:56:33.0691 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  CreateInitialStructure: migrating =========================================\r\n[ 2013-10-04 17:56:33.0692 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- create_table("casserver_lt", {:force=>true})\r\n[ 2013-10-04 17:56:33.0712 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE will create implicit sequence "casserver_lt_id_seq" for serial column "casserver_lt.id"\r\n[ 2013-10-04 17:56:33.0977 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "casserver_lt_pkey" for table "casserver_lt"\r\n[ 2013-10-04 17:56:33.1040 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (32.7ms)  CREATE TABLE "casserver_lt" ("id" serial primary key, "ticket" character varying(255) NOT NULL, "created_on" timestamp NOT NULL, "consumed" timestamp, "client_hostname" character varying(255) NOT NULL)\r\n[ 2013-10-04 17:56:33.1041 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0341s\r\n[ 2013-10-04 17:56:33.1041 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- create_table("casserver_st", {:force=>true})\r\n[ 2013-10-04 17:56:33.1050 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE will create implicit sequence "casserver_st_id_seq" for serial column "casserver_st.id"\r\n[ 2013-10-04 17:56:33.1090 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "casserver_st_pkey" for table "casserver_st"\r\n[ 2013-10-04 17:56:33.1121 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (6.1ms)  CREATE TABLE "casserver_st" ("id" serial primary key, "ticket" character varying(255) NOT NULL, "service" text NOT NULL, "created_on" timestamp NOT NULL, "consumed" timestamp, "client_hostname" character varying(255) NOT NULL, "username" character varying(255) NOT NULL, "type" character varying(255) NOT NULL, "granted_by_pgt_id" integer, "granted_by_tgt_id" integer)\r\n[ 2013-10-04 17:56:33.1122 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0077s\r\n[ 2013-10-04 17:56:33.1122 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- create_table("casserver_tgt", {:force=>true})\r\n[ 2013-10-04 17:56:33.1134 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE will create implicit sequence "casserver_tgt_id_seq" for serial column "casserver_tgt.id"\r\n[ 2013-10-04 17:56:33.1178 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "casserver_tgt_pkey" for table "casserver_tgt"\r\n[ 2013-10-04 17:56:33.1200 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (6.0ms)  CREATE TABLE "casserver_tgt" ("id" serial primary key, "ticket" character varying(255) NOT NULL, "created_on" timestamp NOT NULL, "client_hostname" character varying(255) NOT NULL, "username" character varying(255) NOT NULL, "extra_attributes" text)\r\n[ 2013-10-04 17:56:33.1200 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0081s\r\n[ 2013-10-04 17:56:33.1201 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- create_table("casserver_pgt", {:force=>true})\r\n[ 2013-10-04 17:56:33.1210 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE will create implicit sequence "casserver_pgt_id_seq" for serial column "casserver_pgt.id"\r\n[ 2013-10-04 17:56:33.1269 4304/b6413b70 Pool2/Spawner.h:159 ]: [App 6528 stderr] NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "casserver_pgt_pkey" for table "casserver_pgt"\r\n[ 2013-10-04 17:56:33.1292 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (7.6ms)  CREATE TABLE "casserver_pgt" ("id" serial primary key, "ticket" character varying(255) NOT NULL, "created_on" timestamp NOT NULL, "client_hostname" character varying(255) NOT NULL, "iou" character varying(255) NOT NULL, "service_ticket_id" integer NOT NULL)\r\n[ 2013-10-04 17:56:33.1292 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0092s\r\n[ 2013-10-04 17:56:33.1292 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  CreateInitialStructure: migrated (0.0595s) ================================\r\n[ 2013-10-04 17:56:33.1292 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.1320 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (1.6ms)  INSERT INTO "schema_migrations" ("version") VALUES ("1")\r\n[ 2013-10-04 17:56:33.1370 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (4.8ms)  COMMIT\r\n[ 2013-10-04 17:56:33.1371 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] Migrating to TrackAuthenticatorInTgt (2)\r\n[ 2013-10-04 17:56:33.1378 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.3ms)  BEGIN\r\n[ 2013-10-04 17:56:33.1388 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  TrackAuthenticatorInTgt: migrating ========================================\r\n[ 2013-10-04 17:56:33.1388 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- add_column("casserver_tgt", "authenticator", :string, {:limit=>64, :null=>false, :default=>""})\r\n[ 2013-10-04 17:56:33.1533 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (13.9ms)  ALTER TABLE "casserver_tgt" ADD COLUMN "authenticator" character varying(64) DEFAULT "" NOT NULL\r\n[ 2013-10-04 17:56:33.1533 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0144s\r\n[ 2013-10-04 17:56:33.1533 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  TrackAuthenticatorInTgt: migrated (0.0145s) ===============================\r\n[ 2013-10-04 17:56:33.1533 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.1542 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.1ms)  INSERT INTO "schema_migrations" ("version") VALUES ("2")\r\n[ 2013-10-04 17:56:33.1575 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (3.0ms)  COMMIT\r\n[ 2013-10-04 17:56:33.1576 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] Migrating to SetDefaultAuthenticatorInTgt (3)\r\n[ 2013-10-04 17:56:33.1586 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.2ms)  BEGIN\r\n[ 2013-10-04 17:56:33.1590 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  SetDefaultAuthenticatorInTgt: migrating ===================================\r\n[ 2013-10-04 17:56:33.1592 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- change_column("casserver_tgt", "authenticator", :string, {:limit=>64, :null=>false, :default=>"CASServer::Authenticators::SQLEncrypted"})\r\n[ 2013-10-04 17:56:33.1600 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.5ms)  ALTER TABLE "casserver_tgt" ALTER COLUMN "authenticator" TYPE character varying(64)\r\n[ 2013-10-04 17:56:33.1604 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.2ms)  ALTER TABLE "casserver_tgt" ALTER COLUMN "authenticator" SET DEFAULT "CASServer::Authenticators::SQLEncrypted"\r\n[ 2013-10-04 17:56:33.1609 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.3ms)  UPDATE "casserver_tgt" SET "authenticator"="CASServer::Authenticators::SQLEncrypted" WHERE "authenticator" IS NULL\r\n[ 2013-10-04 17:56:33.1611 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.1ms)  ALTER TABLE "casserver_tgt" ALTER "authenticator" SET NOT NULL\r\n[ 2013-10-04 17:56:33.1612 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0019s\r\n[ 2013-10-04 17:56:33.1613 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- execute("UPDATE \"casserver_tgt\" SET \"authenticator\" =  "CASServer::Authenticators::SQLEncrypted" WHERE \"authenticator\" = "";")\r\n[ 2013-10-04 17:56:33.1628 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (1.1ms)  UPDATE "casserver_tgt" SET "authenticator" = "CASServer::Authenticators::SQLEncrypted" WHERE "authenticator" = "";\r\n[ 2013-10-04 17:56:33.1629 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0012s\r\n[ 2013-10-04 17:56:33.1629 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  SetDefaultAuthenticatorInTgt: migrated (0.0034s) ==========================\r\n[ 2013-10-04 17:56:33.1629 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.1635 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.1ms)  INSERT INTO "schema_migrations" ("version") VALUES ("3")\r\n[ 2013-10-04 17:56:33.1642 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.4ms)  COMMIT\r\n[ 2013-10-04 17:56:33.1642 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] Migrating to AddIndexesForPerformance (4)\r\n[ 2013-10-04 17:56:33.1643 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.1ms)  BEGIN\r\n[ 2013-10-04 17:56:33.1655 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  AddIndexesForPerformance: migrating =======================================\r\n[ 2013-10-04 17:56:33.1656 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- add_index(:casserver_lt, :ticket)\r\n[ 2013-10-04 17:56:33.1718 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (2.4ms)  CREATE INDEX "index_casserver_lt_on_ticket" ON "casserver_lt" ("ticket")\r\n[ 2013-10-04 17:56:33.1718 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0059s\r\n[ 2013-10-04 17:56:33.1718 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- add_index(:casserver_st, :ticket)\r\n[ 2013-10-04 17:56:33.1747 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (1.7ms)  CREATE INDEX "index_casserver_st_on_ticket" ON "casserver_st" ("ticket")\r\n[ 2013-10-04 17:56:33.1748 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0029s\r\n[ 2013-10-04 17:56:33.1748 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- add_index(:casserver_tgt, :ticket)\r\n[ 2013-10-04 17:56:33.1779 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (1.8ms)  CREATE INDEX "index_casserver_tgt_on_ticket" ON "casserver_tgt" ("ticket")\r\n[ 2013-10-04 17:56:33.1779 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0031s\r\n[ 2013-10-04 17:56:33.1779 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] -- add_index(:casserver_pgt, :ticket)\r\n[ 2013-10-04 17:56:33.1815 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (2.0ms)  CREATE INDEX "index_casserver_pgt_on_ticket" ON "casserver_pgt" ("ticket")\r\n[ 2013-10-04 17:56:33.1816 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    -> 0.0035s\r\n[ 2013-10-04 17:56:33.1816 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] ==  AddIndexesForPerformance: migrated (0.0157s) ==============================\r\n[ 2013-10-04 17:56:33.1816 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.1823 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.1ms)  INSERT INTO "schema_migrations" ("version") VALUES ("4")\r\n[ 2013-10-04 17:56:33.1851 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]    (0.6ms)  COMMIT\r\n[ 2013-10-04 17:56:33.1851 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.1851 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout] >>> Your database is now up to date.\r\n[ 2013-10-04 17:56:33.1851 4304/b62ffb70 Pool2/Spawner.h:738 ]: [App 6528 stdout]\r\n[ 2013-10-04 17:56:33.2737 4304/b62ffb70 Pool2/SmartSpawner.h:301 ]: Preloader for /opt/puppet/share/puppet-dashboard/public/../../rubycas-server started on PID 6528, listening on unix:/tmp/passenger.1.0.4289/generation-0/backends/preloader.6528\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-545', 'https://github.com/puppetlabs/puppet/pull/4385', '2013-10-10T11:33:28.000-0700', '2017-05-17T16:13:13.000-0700', '2017-05-17T16:13:13.000-0700', 'Closed', '', 1, '0', 1, 2, 1, 2, 'e4b1e0c3f3f6ec3aab042432c42d2c3a079b2dbb', 'https://tickets.puppetlabs.com/browse/PUP-545', 'https://github.com/puppetlabs/puppet/pull/4385'),
('puppet', 15343, 35182340, 3917, 'Puppet does not accurately capture exit codes from exec resources on Windows', 'The exit code from a windows program is not returned correctly to due to a ruby bug which can be seen here:\r\n\r\nhttps://bugs.ruby-lang.org/issues/8083\r\n\r\nSo, the exitcode that is returned follows the formula: exitcode % 256 \r\n\r\n   exitcode = 255 and puppet returns 255\r\n   exitcode = 256 and puppet returns 0\r\n   exitcode =257 and puppet returns 1\r\n   ...\r\n\r\nThe issue can be reproduced by making a bat file that contains just the following `exit %1` and using the following puppet code:\r\n\r\n    exec { "testBat":\r\n      command => "c:\Windows\System32\cmd.exe /c c:\users\nick\documents\test.bat 257",\r\n      logoutput => true,\r\n      returns => [0,2000,3010],\r\n    }\r\n\r\n[~josh] helped track down some of the issue and said the following.\r\n\r\n"we actually go through the trouble of capturing the exit code, but due some craziness we end up returning the exit status from ruby"s CHILD_STATUS, we could fix the windows exec provider to not do that. Please file a ticket, so we can track this.\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/windows/process.rb#L22-L24\r\nis where we capture the real 32-bit value, but then we end up returning\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/suidmanager.rb#L195\r\nas the exit code\r\nso due to the ruby bug, the value is truncated"', 'https://tickets.puppetlabs.com/browse/PUP-434', 'https://github.com/puppetlabs/puppet/pull/3917', '2013-09-26T19:28:38.000-0700', '2017-05-17T16:13:14.000-0700', '2017-05-17T16:13:14.000-0700', 'Closed', 'customer;support', 13, '0', 1, 173, 0, 1, 'fa0b9b0a915d510b2c137625ae230c43691ee2f3', 'https://tickets.puppetlabs.com/browse/PUP-434', 'https://github.com/puppetlabs/puppet/pull/3917'),
('puppet', 23085, 14248099, 2492, 'cron type and provider only return resources for ENV["USER"] or "root", not all users', '*NOTE*: This ticket now only tracks the adding of a warning about the upcoming fix. There will be a separate ticket to track the fix itself.\r\n\r\nOriginal report below.\r\n----\r\n\r\nWhen using \r\n\r\n{code}resources { cron: purge => true }{code} \r\n\r\nonly the root users crontab is purged. This works:\r\n{code}\r\ncron {"foo":\r\n        command => "ls",\r\n        ensure => present,\r\n        user => root,\r\n}\r\n{code}\r\n\r\n(and then proceed to comment the above out):\r\n{code}\r\nnotice: /Cron[foo]/ensure: removed\r\n{code}\r\n\r\nThis does not work:\r\n{code}\r\ncron {"bar":\r\n        command => "ls",\r\n        ensure => present,\r\n        user => nick,\r\n}\r\n{code}\r\n\r\nThis crontab will still exist if commented out.\r\n\r\nBroken in 2.6 and latest stable.', 'https://tickets.puppetlabs.com/browse/PUP-1381', 'https://github.com/puppetlabs/puppet/pull/2492', '2014-01-06T18:15:59.000-0800', '2017-05-17T16:13:14.000-0700', '2017-05-17T16:13:14.000-0700', 'Closed', 'redmine', 4, '0', 3, 29, 2, 5, '7d7b7017587e8b8acbf9ee7e99d103bd882b853c', 'https://tickets.puppetlabs.com/browse/PUP-1381', 'https://github.com/puppetlabs/puppet/pull/2492'),
('puppet', 25484, 12290015, 2331, 'Cron endlessly makes futile attempts to create empty crontab entries', 'When applying this manifest {code} puppet apply -e "cron { "simple": minute => "5"; "complex": minute => 0, hour => 3, command => "/bin/huge-script" }" {code} puppet fails to write the crontab because the "simple" task is invalid due to the lack of a command. The incomplete resource should fail gracefully and allow puppt to write a partial crontab to the system.', 'https://tickets.puppetlabs.com/browse/PUP-1587', 'https://github.com/puppetlabs/puppet/pull/2331', '2014-02-05T00:37:28.000-0800', '2017-05-17T16:13:15.000-0700', '2017-05-17T16:13:15.000-0700', 'Closed', '', 1, '0', 3, 47, 6, 5, '5af17f01c4d6099a471dd7849a159e1ca244e3be', 'https://tickets.puppetlabs.com/browse/PUP-1587', 'https://github.com/puppetlabs/puppet/pull/2331'),
('puppet', 25468, 12205424, 2327, 'PR (2331) Cron Type sanity check for the command parameter is broken', 'When there is a crontab like this\r\n\r\n{code}\r\n2 4 * * * /sbin/foobar\r\n# Puppet Name: hourlytask\r\n7 * * * * /usr/local/bin/kick-idlers\r\n{code}\r\nand I apply this manifest:\r\n{code}\r\ncron { "hourlytask": minute => 4 }\r\n{code}\r\npuppet should change the minute field of the "hourlytask" to 4 and do nothing else.\r\n\r\nInstead, it fails to identify the existing job and tries to create a new one:\r\n{code}\r\nRUBYLIB=lib puppet apply -e"cron { "hourlytask": minute => 4 }" \r\n\r\nNotice: Compiled catalog for geras.localdomain in environment production in 0.13 seconds\r\nError: Could not prefetch cron provider "crontab": No command, somehow at line 1\r\nNotice: /Stage[main]/Main/Cron[hourlytask]/ensure: created\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-1586', 'https://github.com/puppetlabs/puppet/pull/2327', '2014-02-04T16:49:06.000-0800', '2017-05-17T16:13:15.000-0700', '2017-05-17T16:13:15.000-0700', 'Closed', 'type_cron', 8, '0', 2, 15, 6, 3, 'cc056e9a573bce9dfc9d32625383a9382732287b', 'https://tickets.puppetlabs.com/browse/PUP-1586', 'https://github.com/puppetlabs/puppet/pull/2327'),
('puppet', 21377, 484784389, 8325, 'puppet apply loading facts twice', 'given the site.pp with:\r\n\r\n{code}\r\nnode default {\r\n  notice("Busy compiling catalog")\r\n}\r\n{code}\r\n\r\nand a module dir setup like:\r\n\r\n{code}\r\n% mkdir modules\r\n% puppet module install ripienaar-concat --modulepath=`pwd`/modules\r\n{code}\r\n\r\nI have no config so its all defaults:\r\n\r\n{code}\r\n% puppet apply --configprint config\r\n/home/rip/.puppet/puppet.conf\r\n% cat /home/rip/.puppet/puppet.conf\r\ncat: /home/rip/.puppet/puppet.conf: No such file or directory\r\n{code}\r\n\r\nRunning puppet 3.0.0rc7 will load facts twice:\r\n\r\n{code}\r\n% puppet apply --modulepath=`pwd`/modules `pwd`/site.pp --verbose\r\nInfo: Loading facts in /home/rip/temp/modules/concat/lib/facter/concat_basedir.rb\r\nScope(Node[dev1.devco.net]): Compiling catalog\r\nInfo: Loading facts in /home/rip/temp/modules/concat/lib/facter/concat_basedir.rb\r\nInfo: Applying configuration version "1348574505"\r\nFinished catalog run in 0.17 seconds\r\n{code}\r\n\r\nBut puppet 2.7.17 with the same code does:\r\n\r\n{code}\r\ninfo: Loading facts in /home/rip/temp/modules/concat/lib/facter/concat_basedir.rb\r\nnotice: Scope(Node[default]): Compiling catalog\r\ninfo: Applying configuration version "1348574599"\r\ninfo: Creating state file /home/rip/.puppet/var/state/state.yaml\r\nnotice: Finished catalog run in 0.05 seconds\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1058', 'https://github.com/puppetlabs/puppet/pull/8325', '2013-12-16T07:52:10.000-0800', '2017-05-17T16:13:16.000-0700', '2017-05-17T16:13:16.000-0700', 'Closed', 'redmine', 3, '0', 1, 28, 52, 6, '0d96de3e1464790f8aa940a4e7472bce700418d5', 'https://tickets.puppetlabs.com/browse/PUP-1058', 'https://github.com/puppetlabs/puppet/pull/8325'),
('puppet', 16607, 53763782, 4504, '(#22847): Windows Puppet::Util::ADSI::User and Puppet::Util::ADSI::Group issues WMI queries that hang Puppet in a domain environment', '', 'https://tickets.puppetlabs.com/browse/PUP-555', 'https://github.com/puppetlabs/puppet/pull/4504', '2013-10-11T12:18:30.000-0700', '2017-05-17T16:13:17.000-0700', '2017-05-17T16:13:17.000-0700', 'Resolved', '', 1, '0', 2, 19, 13, 2, '50f94912cfb23de4ca851063c136f8af5eac7e6a', 'https://tickets.puppetlabs.com/browse/PUP-555', 'https://github.com/puppetlabs/puppet/pull/4504'),
('puppet', 121201, 62667747, 4788, 'error running puppet with non existing and non default environment ', 'Running:\r\n\r\n{noformat}\r\npuppet facts --environment=test\r\n{noformat}\r\n\r\nthrows the following error if the environment directory don"t exists:\r\n\r\n{noformat}\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/environments.rb:38:in `get!": Could not find a directory environment named "test" anywhere in the path: /etc/puppetlabs/code/environments. Does the directory exist? (Puppet::Environments::EnvironmentNotFound)\r\n{noformat}\r\n\r\nBut if you remove /etc/puppetlabs/code/environments/production it still works for production because in puppet.rb a basic default environment is only created if the environment is named production:\r\n \r\n{code:java}\r\n      # in case the configured environment (used for the default sometimes)\r\n      # doesn"t exist\r\n      default_environment = Puppet[:environment].to_sym\r\n      if default_environment == :production\r\n        loaders << Puppet::Environments::StaticPrivate.new(\r\n          Puppet::Node::Environment.create(default_environment,\r\n                                           basemodulepath,\r\n                                           Puppet::Node::Environment::NO_MANIFEST))\r\n      end\r\n{code}\r\n\r\nI"m no expert on the puppet code, so I could miss something, but in my opinion a basic default environment should be created in every case.', 'https://tickets.puppetlabs.com/browse/PUP-6048', 'https://github.com/puppetlabs/puppet/pull/4788', '2016-03-13T03:26:34.000-0700', '2017-05-18T10:39:55.000-0700', '2017-05-18T10:39:55.000-0700', 'Closed', '', 28, '0', 1, 4, 6, 1, '83f577b3cf093bd90c2df614b8f7eb1c6aff25d8', 'https://tickets.puppetlabs.com/browse/PUP-6048', 'https://github.com/puppetlabs/puppet/pull/4788'),
('puppet', 119772, 0, 0, 'spec/integration/type/package_spec isn"t run on all platforms', 'This spec is really an integration test, but because it"s a spec it"s not run on all platforms. Change it to an integration test.', 'https://tickets.puppetlabs.com/browse/PUP-6003', '', '2016-03-03T10:41:46.000-0800', '2017-05-18T10:40:00.000-0700', '2017-05-18T10:40:00.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, 'ee7a1bbf48359f0ed88873dc3a01ace24201bb9d', 'https://tickets.puppetlabs.com/browse/PUP-6003', 'https://github.com/puppetlabs/puppet/commit/ee7a1bbf48359f0ed88873dc3a01ace24201bb9d'),
('puppet', 97627, 0, 0, 'PMT fails to install a module on Centos 4', 'On Centos 4, when trying to install a module, we unpack it and try to reset permissions. Note due to PUP-5225 you have to download a module out of band, and try to install the tar.gz directly:\r\n \r\n{noformat}\r\n[root@sb1nht6p15drgb1 ~]# puppet module install puppetlabs-stdlib-4.9.0.tar.gz --trace\r\nNotice: Preparing to install into /etc/puppetlabs/code/environments/production/modules ...\r\nError: Could not extract contents of module archive: Execution of "find . -type d -exec chmod 755 {} +" returned 1: find: missing argument to `-exec"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/module_tool/applications/unpacker.rb:58:in `rescue in unpack"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/module_tool/applications/unpacker.rb:55:in `unpack"\r\n{noformat}\r\n\r\nThe problem can be reproduced using:\r\n\r\n{noformat}\r\n[root@sb1nht6p15drgb1 ~]# find . -type d -exec chmod 755 {} +\r\nfind: missing argument to `-exec"\r\n[root@sb1nht6p15drgb1 ~]# find --version\r\nGNU find version 4.1.20\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5226', '', '2015-09-11T11:50:23.000-0700', '2017-05-18T10:40:19.000-0700', '2017-05-18T10:40:19.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, 'a7bf44b64ba8e56eb981c6b0044e3fc90549c437', 'https://tickets.puppetlabs.com/browse/PUP-5226', 'https://github.com/puppetlabs/puppet/commit/a7bf44b64ba8e56eb981c6b0044e3fc90549c437'),
('puppet', 136540, 81178687, 5196, 'package resource does not install packages on OpenBSD if bare hostname is used as installpath in pkg.conf', '{code}\r\n# # puppet --version\r\n4.5.1\r\n\r\n# uname -a\r\nOpenBSD bsd1.lan 5.9 GENERIC#1761 amd64\r\n\r\n# cat pkg_test.pp                                                                                          \r\npackage {"vim-7.4.900-no_x11":\r\n  ensure => present\r\n}\r\n\r\n# puppet apply --debug pkg_test.pp                                                                         \r\nDebug: Runtime environment: puppet_version=4.5.1, ruby_version=2.3.0, run_mode=user, default_encoding=US-ASCII\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Loading external facts from /opt/puppetlabs/puppet/cache/facts.d\r\nInfo: Loading facts\r\nDebug: Loading facts from /etc/puppetlabs/code/modules/stdlib/lib/facter/facter_dot_d.rb\r\nDebug: Loading facts from /etc/puppetlabs/code/modules/stdlib/lib/facter/package_provider.rb\r\nDebug: Loading facts from /etc/puppetlabs/code/modules/stdlib/lib/facter/pe_version.rb\r\nDebug: Loading facts from /etc/puppetlabs/code/modules/stdlib/lib/facter/puppet_vardir.rb\r\nDebug: Loading facts from /etc/puppetlabs/code/modules/stdlib/lib/facter/root_home.rb\r\nDebug: Loading facts from /etc/puppetlabs/code/modules/stdlib/lib/facter/service_provider.rb\r\nDebug: Facter: Found no suitable resolves of 1 for ec2_metadata\r\nDebug: Facter: value for ec2_metadata is still nil\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Failed to load library "cfpropertylist" for feature "cfpropertylist"\r\nDebug: Failed to load library "cfpropertylist" for feature "cfpropertylist"\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Failed to load library "cfpropertylist" for feature "cfpropertylist"\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Facter: value for agent_specified_environment is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbmajdistrelease\r\nDebug: Facter: value for lsbmajdistrelease is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for dhcp_servers\r\nDebug: Facter: value for dhcp_servers is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for system32\r\nDebug: Facter: value for system32 is still nil\r\nDebug: Facter: ruby-augeas not available\r\nDebug: Facter: value for augeasversion is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbdistrelease\r\nDebug: Facter: value for lsbdistrelease is still nil\r\nDebug: Facter: value for zfs_version is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbdistdescription\r\nDebug: Facter: value for lsbdistdescription is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbrelease\r\nDebug: Facter: value for lsbrelease is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux\r\nDebug: Facter: value for selinux is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux\r\nDebug: Facter: value for selinux is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux_enforced\r\nDebug: Facter: value for selinux_enforced is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux\r\nDebug: Facter: value for selinux is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux_policyversion\r\nDebug: Facter: value for selinux_policyversion is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux\r\nDebug: Facter: value for selinux is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux_current_mode\r\nDebug: Facter: value for selinux_current_mode is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux\r\nDebug: Facter: value for selinux is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux_config_mode\r\nDebug: Facter: value for selinux_config_mode is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux\r\nDebug: Facter: value for selinux is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for selinux_config_policy\r\nDebug: Facter: value for selinux_config_policy is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for gce\r\nDebug: Facter: value for gce is still nil\r\nDebug: Facter: value for ipaddress6_lo0 is still nil\r\nDebug: Facter: value for macaddress_lo0 is still nil\r\nDebug: Facter: value for ipaddress6_em0 is still nil\r\nDebug: Facter: value for ipaddress_enc0 is still nil\r\nDebug: Facter: value for ipaddress6_enc0 is still nil\r\nDebug: Facter: value for macaddress_enc0 is still nil\r\nDebug: Facter: value for netmask_enc0 is still nil\r\nDebug: Facter: value for ipaddress_pflog0 is still nil\r\nDebug: Facter: value for ipaddress6_pflog0 is still nil\r\nDebug: Facter: value for macaddress_pflog0 is still nil\r\nDebug: Facter: value for netmask_pflog0 is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for vlans\r\nDebug: Facter: value for vlans is still nil\r\nDebug: Facter: value for cfkey is still nil\r\nDebug: Facter: value for ipaddress6 is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbdistcodename\r\nDebug: Facter: value for lsbdistcodename is still nil\r\nDebug: Facter: value for zpool_version is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for xendomains\r\nDebug: Facter: value for xendomains is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for zonename\r\nDebug: Facter: value for zonename is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbdistid\r\nDebug: Facter: value for lsbdistid is still nil\r\nDebug: Facter: value for network_enc0 is still nil\r\nDebug: Facter: value for network_pflog0 is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for lsbminordistrelease\r\nDebug: Facter: value for lsbminordistrelease is still nil\r\nDebug: Facter: Found no suitable resolves of 2 for iphostnumber\r\nDebug: Facter: value for iphostnumber is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for filesystems\r\nDebug: Facter: value for filesystems is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for uniqueid\r\nDebug: Facter: value for uniqueid is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for ec2_metadata\r\nDebug: Facter: value for ec2_metadata is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for ec2_userdata\r\nDebug: Facter: value for ec2_userdata is still nil\r\nDebug: Facter: value for is_rsc is still nil\r\nDebug: Facter: value for is_rsc is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for rsc_region\r\nDebug: Facter: value for rsc_region is still nil\r\nDebug: Facter: value for is_rsc is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for rsc_instance_id\r\nDebug: Facter: value for rsc_instance_id is still nil\r\nDebug: Puppet::Type::Package::ProviderOpkg: file opkg does not exist\r\nDebug: Puppet::Type::Package::ProviderDpkg: file /usr/bin/dpkg does not exist\r\nDebug: Puppet::Type::Package::ProviderApt: file /usr/bin/apt-get does not exist\r\nDebug: Puppet::Type::Package::ProviderAptitude: file /usr/bin/aptitude does not exist\r\nDebug: Puppet::Type::Package::ProviderSun: file /usr/bin/pkginfo does not exist\r\nDebug: Puppet::Type::Package::ProviderSunfreeware: file pkg-get does not exist\r\nDebug: Puppet::Type::Package::ProviderPkg: file /usr/bin/pkg does not exist\r\nDebug: Puppet::Type::Package::ProviderPortage: file /usr/bin/emerge does not exist\r\nDebug: Puppet::Type::Package::ProviderHpux: file /usr/sbin/swinstall does not exist\r\nDebug: Puppet::Type::Package::ProviderRpm: file rpm does not exist\r\nDebug: Puppet::Type::Package::ProviderAptrpm: file apt-get does not exist\r\nDebug: Puppet::Type::Package::ProviderPuppet_gem: file /opt/puppetlabs/puppet/bin/gem does not exist\r\nDebug: Puppet::Type::Package::ProviderAix: file /usr/bin/lslpp does not exist\r\nDebug: Puppet::Type::Package::ProviderYum: file yum does not exist\r\nDebug: Puppet::Type::Package::ProviderPkgng: file /usr/local/sbin/pkg does not exist\r\nDebug: Puppet::Type::Package::ProviderPkgin: file pkgin does not exist\r\nDebug: Puppet::Type::Package::ProviderZypper: file /usr/bin/zypper does not exist\r\nDebug: Puppet::Type::Package::ProviderDnf: file dnf does not exist\r\nDebug: Puppet::Type::Package::ProviderPortupgrade: file /usr/local/sbin/portupgrade does not exist\r\nDebug: Puppet::Type::Package::ProviderFink: file /sw/bin/fink does not exist\r\nDebug: Puppet::Type::Package::ProviderUp2date: file /usr/sbin/up2date-nox does not exist\r\nDebug: Puppet::Type::Package::ProviderPacman: file /usr/bin/pacman does not exist\r\nDebug: Puppet::Type::Package::ProviderNim: file /usr/sbin/nimclient does not exist\r\nDebug: Puppet::Type::Package::ProviderPorts: file /usr/local/sbin/portupgrade does not exist\r\nDebug: Puppet::Type::Package::ProviderUrpmi: file urpmi does not exist\r\nDebug: Puppet::Type::Package::ProviderRug: file /usr/bin/rug does not exist\r\nDebug: /Package[dummy]: Provider openbsd does not support features virtual_packages; not managing attribute allow_virtual\r\nDebug: Facter: value for pe_version is still nil\r\nDebug: Facter: value for pe_version is still nil\r\nDebug: Facter: value for pe_version is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for pe_major_version\r\nDebug: Facter: value for pe_major_version is still nil\r\nDebug: Facter: value for pe_version is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for pe_minor_version\r\nDebug: Facter: value for pe_minor_version is still nil\r\nDebug: Facter: value for pe_version is still nil\r\nDebug: Facter: Found no suitable resolves of 1 for pe_patch_version\r\nDebug: Facter: value for pe_patch_version is still nil\r\nDebug: Puppet::Type::Service::ProviderSystemd: file systemctl does not exist\r\nDebug: Puppet::Type::Service::ProviderRedhat: file /sbin/chkconfig does not exist\r\nDebug: Puppet::Type::Service::ProviderDaemontools: file /usr/bin/svc does not exist\r\nDebug: Puppet::Type::Service::ProviderLaunchd: file /bin/launchctl does not exist\r\nDebug: Puppet::Type::Service::ProviderOpenrc: file /bin/rc-status does not exist\r\nDebug: Puppet::Type::Service::ProviderRunit: file /usr/bin/sv does not exist\r\nDebug: Puppet::Type::Service::ProviderGentoo: file /sbin/rc-update does not exist\r\nDebug: Puppet::Type::Service::ProviderDebian: file /usr/sbin/update-rc.d does not exist\r\nDebug: Puppet::Type::Service::ProviderUpstart: 0 confines (of 4) were true\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nNotice: Compiled catalog for bsd1.lan in environment production in 0.05 seconds\r\nDebug: /Package[vim-7.4.900-no_x11]: Provider openbsd does not support features virtual_packages; not managing attribute allow_virtual\r\nDebug: Creating default schedules\r\nDebug: Loaded state in 0.00 seconds\r\nDebug: Loaded state in 0.00 seconds\r\nInfo: Applying configuration version "1465634392"\r\nDebug: Prefetching openbsd resources for package\r\nDebug: Executing "/usr/sbin/pkg_info -a"\r\nDebug: Executing: "/usr/sbin/pkg_info vim-7.4.900-no_x11"\r\nDebug: Executing: "/usr/sbin/pkg_add ftp.aso.ee"\r\nNotice: /Stage[main]/Main/Package[vim-7.4.900-no_x11]/ensure: created\r\nDebug: /Package[vim-7.4.900-no_x11]: The container Class[Main] will propagate my refresh event\r\nDebug: Class[Main]: The container Stage[main] will propagate my refresh event\r\nDebug: Finishing transaction 4767578812320\r\nDebug: Storing state\r\nDebug: Stored state in 0.01 seconds\r\nNotice: Applied catalog in 2.99 seconds\r\nDebug: Applying settings catalog for sections reporting, metrics\r\nDebug: Finishing transaction 4767530408360\r\nDebug: Received report to process from bsd1.lan\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nDebug: Processing report from bsd1.lan with processor Puppet::Reports::Store\r\n\r\n# pkg_info |grep vim\r\n(no output, since the package is not actually installed.)\r\n{code}\r\n\r\n\r\nNote this part:\r\n\r\nMirror address is passed to pkg_add as a parameter, instead of package name:\r\n\r\nDebug: Executing: "/usr/sbin/pkg_add ftp.aso.ee"\r\n\r\nInstallation is reported as successful:\r\nNotice: /Stage[main]/Main/Package[vim-7.4.900-no_x11]/ensure: created', 'https://tickets.puppetlabs.com/browse/PUP-6402', 'https://github.com/puppetlabs/puppet/pull/5196', '2016-06-11T01:43:36.000-0700', '2017-05-18T10:40:31.000-0700', '2017-05-18T10:40:31.000-0700', 'Closed', '', 4, '0', 1, 1, 1, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-6402', 'https://github.com/puppetlabs/puppet/pull/5196'),
('puppet', 133523, 71142804, 4988, 'Configuration reference reports wacky default for hiera_config setting', 'Docs team relies on {{puppet doc -r configuration}} to build the [configuration reference|https://docs.puppet.com/puppet/latest/reference/configuration.html]. If you run that command with Puppet 4.5, it reports the default location of hiera_config as something like {{/Users/nick/.puppetlabs/etc/code/hiera.yaml}}. \r\n\r\na. It should be reporting the default in terms of variables like $confdir, not printing a user-specific path.\r\nb. Even $confdir/hiera.yaml isn"t the whole story, because of the try-codedir-first behavior to preserve backward compatibility. That kind of dynamic behavior is really hard to introspect, and we rely on being able to introspect. \r\n\r\nI think I know how to fix this, but I"m filing it as a real ticket to raise awareness: \r\n\r\n* When we add dynamic behaviors for auto-documented objects, we also need to make sure we don"t break the docs. \r\n* Plain old introspection is brittle, and it would be really nice to have a way, in the settings themselves, to provide a _descriptive_ default value. We probably won"t get this for oldskool puppet settings, but it"d be nice to take into account for whatever"s next. We"ve been burned by this sort of thing before, in several places. ', 'https://tickets.puppetlabs.com/browse/PUP-6345', 'https://github.com/puppetlabs/puppet/pull/4988', '2016-05-23T17:42:02.000-0700', '2017-05-18T10:40:53.000-0700', '2017-05-18T10:40:53.000-0700', 'Closed', '', 0, '0', 1, 2, 0, 1, 'f9df9c4a2055601d178d4d3a9201514c9b586c40', 'https://tickets.puppetlabs.com/browse/PUP-6345', 'https://github.com/puppetlabs/puppet/pull/4988'),
('puppet', 167869, 0, 0, 'Arista user provider cannot determine a user is absent', 'In debugging a test failure related to PUP-6777, I discovered strange behavior from puppet on our Arista test hosts. It appears that puppet cannot tell that a user does not exist - or, conversely, thinks any user you supply exists:\r\n{code}\r\n-bash-4.1# puppet resource user foo75181\r\nuser { "foo75181":\r\n  ensure  => "present",\r\n  comment => "Unknown User (foo75181)",\r\n  gid     => "88",\r\n  home    => "/home/foo75181",\r\n  shell   => "/usr/bin/RunCli",\r\n  uid     => "102341648",\r\n}\r\n-bash-4.1# puppet resource user foobar\r\nuser { "foobar":\r\n  ensure  => "present",\r\n  comment => "Unknown User (foobar)",\r\n  gid     => "88",\r\n  home    => "/home/foobar",\r\n  shell   => "/usr/bin/RunCli",\r\n  uid     => "43894025",\r\n}\r\n-bash-4.1# puppet resource user foobazbarqux\r\nuser { "foobazbarqux":\r\n  ensure  => "present",\r\n  comment => "Unknown User (foobazbarqux)",\r\n  gid     => "88",\r\n  home    => "/home/foobazbarqux",\r\n  shell   => "/usr/bin/RunCli",\r\n  uid     => "97032648",\r\n}\r\n{quote}\r\n\r\nNone of these are actually users on the system. For PUP-6777, this means that rather than run `useradd` to create a user with a comment, on arista puppet is running `usermod` (as if the user already existed) ', 'https://tickets.puppetlabs.com/browse/PUP-7049', '', '2016-12-27T11:06:40.000-0800', '2017-05-18T10:40:55.000-0700', '2017-05-18T10:40:55.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, '094760d9262c7fbf2afd86e6cf0a88b29a468fa9', 'https://tickets.puppetlabs.com/browse/PUP-7049', 'https://github.com/puppetlabs/puppet/commit/094760d9262c7fbf2afd86e6cf0a88b29a468fa9'),
('puppet', 129635, 68775461, 4938, 'File resource no_proxy behavior is ignored', 'I have a file resource:\r\n{code:puppet}\r\nfile {"/var/opt/foo/client.config":\r\n  ensure  => present,\r\n  mode    => "0644",\r\n  owner   => "root",\r\n  group   => "root",\r\n  source  => "https://files.internal/client.config",\r\n  require => File["/var/opt/foo"],\r\n  replace => false\r\n}\r\n{code}\r\n\r\nIn my machine environment, I have the following env vars set globally:\r\n{code}\r\nhttp_proxy="http://172.22.252.1:8080\r\nhttps_proxy="http://172.22.252.1:8080\r\nno_proxy=127.0.0.1,localhost,.internal\r\n{code}\r\n\r\nWhen Puppet tries to reach out to https://files.internal/client.config, I get:\r\n{code}\r\nError: /Stage[main]/Module::Blah/File[/var/opt/foo/client.config]: Could not evaluate: Could not retrieve file metadata for https://files.internal/client.config: SSL_connect returned=1 errno=0 state=error: certificate verify failed\r\n{code}\r\n\r\nAfter enabling http_debug, I noticed that despite {{no_proxy}} having {{.internal}} in it, Net::HTTP wanted to toss it through the proxy anyways, so my internal proxy was getting in the way (and presenting its untrusted MITM cert so that it could tell me that internal hosts cant be proxied). According to the Ruby 2.1.8 Docs, Net::HTTP::Proxy has been deprecated and proxy settings just specified in Net::HTTP.new. Updating {{lib/puppet/util/http_proxy.rb}} with the new initializer seemed to fix the issue.', 'https://tickets.puppetlabs.com/browse/PUP-6259', 'https://github.com/puppetlabs/puppet/pull/4938', '2016-05-03T13:45:43.000-0700', '2017-05-18T10:41:00.000-0700', '2017-05-18T10:41:00.000-0700', 'Closed', '', 7, '0', 1, 4, 6, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-6259', 'https://github.com/puppetlabs/puppet/pull/4938'),
('puppet', 166266, 114267977, 5781, 'Git acceptance broken on Windows', 'Git acceptance will be restored in PUP-6989, however, additional work is needed to support Windows agents.\r\n\r\n* Need Git on Windows installed on the VM, see IMAGES-431\r\n* The {{ci:test:git}} task clones {{puppet-win32-ruby}} which can"t connect to rubygems due to its new SSL cert. We should install our vanagon built ruby instead.\r\n* Bundler on Windows does not create binstubs correctly, see https://github.com/bundler/bundler/issues/4512. We could work-around that by creating our own *.bat wrapper.', 'https://tickets.puppetlabs.com/browse/PUP-7009', 'https://github.com/puppetlabs/puppet/pull/5781', '2016-12-13T16:57:51.000-0800', '2017-05-18T10:41:14.000-0700', '2017-05-18T10:41:14.000-0700', 'Resolved', '', 3, '0', 3, 33, 3, 3, 'ebbeca72ed025c31bc0d53538b74fa48e76074fc', 'https://tickets.puppetlabs.com/browse/PUP-7009', 'https://github.com/puppetlabs/puppet/pull/5781'),
('puppet', 21557, 734897392, 8767, 'Zypper package provider needs $HOME set to access username/password-protected repos', 'zypper, the command used to install packages on SUSE distributions, supports package repositories that requires a username and a password to be accessed. Unlike other comparable utilities for other distributions, zypper stores such credentials information in a file in {{$HOME, $HOME/.zypp/credentials.cat}} to be precise. However, this requires the environment variable $HOME to be set, which is currently not the case, rendering the zypper package provider unable to access a required password.\r\n\r\nThe attached patch fixes this by explicitly defining a HOME environment variable set to "/root". This is correct, because the zypper command requires root permissions for both configuring software repositories and installing software.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1124', 'https://github.com/puppetlabs/puppet/pull/8767', '2013-12-17T00:48:16.000-0800', '2017-05-18T10:43:43.000-0700', '2017-05-18T10:43:43.000-0700', 'Closed', 'help_wanted;manage-package;redmine', 4, '0', 2, 60, 0, 2, 'be821fb32d741a21feecaee29fa745e0be1696a0', 'https://tickets.puppetlabs.com/browse/PUP-1124', 'https://github.com/puppetlabs/puppet/pull/8767'),
('puppet', 75837, 33244590, 3818, 'Vim indentation: chaining arrows', '{{ext/vim/indent/puppet.vim}} doesn"t recognize the chaining arrows syntax', 'https://tickets.puppetlabs.com/browse/PUP-4407', 'https://github.com/puppetlabs/puppet/pull/3818', '2015-04-14T03:07:31.000-0700', '2017-05-18T10:43:58.000-0700', '2017-05-18T10:43:58.000-0700', 'Closed', '', 2, '0', 1, 1, 1, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-4407', 'https://github.com/puppetlabs/puppet/pull/3818'),
('puppet', 35226, 15831767, 2643, 'Redhat service enable does not honour chkconfig or LSB Headers.', 'Using chkconfig <service> on blindly sets the service on in runlevel 2,3,4,5. puppet should use chkconfig <service> resetpriorities. when enabling services so that it honours the settings in the chkconfig and LSB Headers.', 'https://tickets.puppetlabs.com/browse/PUP-2553', 'https://github.com/puppetlabs/puppet/pull/2643', '2014-05-13T09:08:08.000-0700', '2017-05-18T10:44:00.000-0700', '2017-05-18T10:44:00.000-0700', 'Closed', '', 2, '0', 4, 4, 4, 2, '', 'https://tickets.puppetlabs.com/browse/PUP-2553', 'https://github.com/puppetlabs/puppet/pull/2643'),
('puppet', 30203, 14038391, 2478, 'resourses type attribute unless_uid depends on unless_system_user', 'PUP-594 implemented "unless_uid" as an attribute to resources however it looks as though its use is dependant on "unless_system_user" being true.', 'https://tickets.puppetlabs.com/browse/PUP-2074', 'https://github.com/puppetlabs/puppet/pull/2478', '2014-03-26T18:04:14.000-0700', '2017-05-18T10:44:04.000-0700', '2017-05-18T10:44:04.000-0700', 'Closed', '', 2, '0', 1, 6, 2, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-2074', 'https://github.com/puppetlabs/puppet/pull/2478'),
('puppet', 48008, 19843100, 2978, 'Services are started before flags are set', 'The OpenBSD service provider is marked `flaggable` which means that `flags` may be passed which are written into `/etc/rc.conf.local`. These flags control the behaviour of the service when they"re started.\r\n\r\nHowever it seems there"s an issue in the ordering, the flags are written out to disk (flushed) _after_ the service is started. This means that the service is started without the flags that have been set:\r\n\r\n$ ps ax | grep apmd\r\n26569 p6  R+      0:00.00 grep apmd\r\n$ grep apmd /etc/rc.conf.local\r\n$ sudo puppet apply -e "service {"apmd": ensure => running, enable => true, flags => "-C"}"\r\nNotice: Compiled catalog for obsidian.office.jasper.la in environment production in 0.81 seconds\r\nNotice: /Stage[main]/Main/Service[apmd]/ensure: ensure changed "stopped" to "running"\r\nNotice: Finished catalog run in 1.31 seconds\r\n$ grep apmd /etc/rc.conf.local\r\napmd_flags=-C\r\n$ ps ax | grep apmd\r\n25277 ??  Ss      0:00.01 /usr/sbin/apmd\r\n27678 p6  R+      0:00.00 grep apmd\r\n$\r\n\r\nThe expected behaviour would be:\r\n$ grep apmd /etc/rc.conf.local\r\napmd_flags=-C\r\n$ ps ax | grep apmd\r\n25277 ??  Ss      0:00.01 /usr/sbin/apmd -C\r\n27678 p6  R+      0:00.00 grep apmd\r\n$', 'https://tickets.puppetlabs.com/browse/PUP-3066', 'https://github.com/puppetlabs/puppet/pull/2978', '2014-08-15T06:09:23.000-0700', '2017-05-18T10:44:21.000-0700', '2017-05-18T10:44:21.000-0700', 'Closed', '', 4, '0', 1, 3, 0, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-3066', 'https://github.com/puppetlabs/puppet/pull/2978'),
('puppet', 14947, 666418595, 8627, 'Warn if DisplayName or DisplayVersion is wrong', 'Perhaps puppet should compare the list of installed package “displaynames” before and after each package install – so it can figure out what the Displayname of the just installed package is – and then compare that against the “name” given in the manifest – and complain to the user, if it’s wrong – as to catch these problems ? (which I got caught by myself)', 'https://tickets.puppetlabs.com/browse/PUP-399', 'https://github.com/puppetlabs/puppet/pull/8627', '2013-09-19T00:23:34.000-0700', '2017-05-18T10:44:24.000-0700', '2017-05-18T10:44:24.000-0700', 'Closed', 'windows', 1, '0', 1, 49, 2, 4, 'b292359eb2eccf4cfe187f6e00dbb989e887268c', 'https://tickets.puppetlabs.com/browse/PUP-399', 'https://github.com/puppetlabs/puppet/pull/8627'),
('puppet', 28994, 0, 0, 'Uppercase tags in exported resource', 'Hi!\r\n\r\nAs already mentioned in this 4 years old bug https://projects.puppetlabs.com/issues/3045 (for some reason it"s not possible to export it to Jira), it"s still not possible to use tags with uppercase characters with exported resources.\r\n\r\nYou can test this easily by applying the following class to multiple nodes - if the tag contains uppercase characters, the exporting node will never realize it"s own exported file.\r\n\r\nclass test {\r\n\r\n  @@file { "/tmp/export-${fqdn}": \r\n    content => "a",\r\n    tag => "tEst",\r\n  }\r\n\r\n  File <<| tag == "tEst" |>>\r\n\r\n}', 'https://tickets.puppetlabs.com/browse/PUP-1980', '', '2014-03-18T12:38:06.000-0700', '2017-05-18T10:44:36.000-0700', '2017-05-18T10:44:36.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, 'cab727367bbf155c638704fd94496ac655f3392c', 'https://tickets.puppetlabs.com/browse/PUP-1980', 'https://github.com/puppetlabs/puppet/commit/cab727367bbf155c638704fd94496ac655f3392c'),
('puppet', 69154, 29912892, 3645, 'The user type should autorequire the home directory', '', 'https://tickets.puppetlabs.com/browse/PUP-4036', 'https://github.com/puppetlabs/puppet/pull/3645', '2015-02-24T08:34:53.000-0800', '2017-05-18T10:44:40.000-0700', '2017-05-18T10:44:40.000-0700', 'Closed', '', 2, '0', 1, 16, 0, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-4036', 'https://github.com/puppetlabs/puppet/pull/3645'),
('puppet', 39372, 19649104, 2961, 'if initctl --version doesn"t list a matching string, upstart service provider fails badly.', 'We are running puppet during the installation process, using Debian installers late_command option.\r\nAt this point, calling "status avahi-daemon" returns:\r\n----- cut here -----\r\n\r\nWarning: Fake initctl called, doing nothing.\r\n----- cut here -----\r\n(As does any other call to initctl, such as "initctl list")\r\nUnfortunately, I was unable to determine if this was on STDOUT or (partially) on STDERR, because it was replaced in the meantime by the standard initctl from upstart.\r\n\r\nHowever, that output causes this:\r\n\r\n17 Jun 2014 14:32:00 puppet.py:1289 DEBUG    PUPPET: Debug: Executing "/sbin/status avahi-daemon"\r\n17 Jun 2014 14:32:00 puppet.py:1289 DEBUG    PUPPET: Error: /Stage[main]/Avahi_daemon/Service[avahi-daemon]: Could not evaluate: undefined method `[]" for nil:NilClass\r\n\r\nHere is the backtrace (from simulating the error on my machine):\r\n\r\nError: /Stage[main]/Avahi_daemon/Service[avahi-daemon]: Could not evaluate: undefined method `[]" for nil:NilClass\r\n/usr/lib/ruby/vendor_ruby/puppet/provider/service/upstart.rb:60:in `upstart_version"\r\n/usr/lib/ruby/vendor_ruby/puppet/provider/service/upstart.rb:155:in `version_is_pre_0_6_7"\r\n/usr/lib/ruby/vendor_ruby/puppet/provider/service/upstart.rb:89:in `enabled?"\r\n/usr/lib/ruby/vendor_ruby/puppet/type/service.rb:56:in `retrieve"\r\n/usr/lib/ruby/vendor_ruby/puppet/type.rb:1045:in `block in retrieve"\r\n/usr/lib/ruby/vendor_ruby/puppet/type.rb:1040:in `each"\r\n/usr/lib/ruby/vendor_ruby/puppet/type.rb:1040:in `retrieve"\r\n/usr/lib/ruby/vendor_ruby/puppet/type.rb:1063:in `retrieve_resource"\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:223:in `from_resource"\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:17:in `evaluate"\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:174:in `apply"\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:187:in `eval_resource"\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:117:in `call"\r\n/usr/lib/ruby/vendor_ruby/puppet/transaction.rb:117:in `block (2 levels) in evaluate"\r\n/usr/lib/ruby/vendor_ruby/puppet/util.rb:327:in `block in thinmark"\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2790', 'https://github.com/puppetlabs/puppet/pull/2961', '2014-06-17T09:26:56.000-0700', '2017-05-18T10:44:57.000-0700', '2017-05-18T10:44:57.000-0700', 'Closed', 'manage-service', 7, '0', 3, 0, 0, 0, '', 'https://tickets.puppetlabs.com/browse/PUP-2790', 'https://github.com/puppetlabs/puppet/pull/2961'),
('puppet', 60200, 0, 0, 'zone provider should not allow inherit parameter on solaris11', 'the configuration step for solaris zones differs between solaris11 and 10.\r\n\r\n1. to make a bootable zone on solaris 10 the configuration step should default to inheriting /sbin.\r\n\r\n2. inherit-pkg-dir was removed in solaris11 because it is not compatible with IPS.\r\nuses of :inherit=> parameter should be ignored and warn on solaris11\r\n\r\n3. re-enable the zone acceptance tests on solaris10', 'https://tickets.puppetlabs.com/browse/PUP-3722', '', '2014-12-02T11:44:36.000-0800', '2017-05-18T10:45:03.000-0700', '2017-05-18T10:45:03.000-0700', 'Closed', '', 1, '0', 0, 0, 0, 0, '13d516abaa28a67e4992c36c2d9089e1497dea64', 'https://tickets.puppetlabs.com/browse/PUP-3722', 'https://github.com/puppetlabs/puppet/commit/13d516abaa28a67e4992c36c2d9089e1497dea64'),
('puppet', 21587, 875674883, 8892, 'mailalias doesn"t run newalias', 'This is probably actually a bug in the alias provider, at least on Centos/Redhat - when adding aliases, the alias database is not regenerated by running newaliases.  The workaround is to notify Exec["newaliases"], but that seems to get run every time puppet runs.  Even if I"m doing that part wrong, it still seems like the provider should be smart enough to do it right without the notify hack...  This was the case in 2.7.9 and is still so in 3.2.3.', 'https://tickets.puppetlabs.com/browse/PUP-1143', 'https://github.com/puppetlabs/puppet/pull/8892', '2013-12-17T09:21:22.000-0800', '2017-05-18T10:45:03.000-0700', '2017-05-18T10:45:03.000-0700', 'Closed', 'redmine', 5, '0', 1, 43, 37, 3, 'dfae0cfb92e19d078fec629bc015d2a5f9332b98', 'https://tickets.puppetlabs.com/browse/PUP-1143', 'https://github.com/puppetlabs/puppet/pull/8892'),
('puppet', 21412, 524157126, 8445, 'Exported resources are hard to collect by environment', 'I noticed today that {{Foo <<| |>>}} collects all Foo resources regardless of environment. Doing {{Foo <<| environment == ... |>>}} would be cool, but I don"t think that works.\r\n\r\nWhy was this a problem? I have multiple deployments; some of which cannot see each other on the network (outside of the storeconfigs db). As a result of this behavior (collect all resources in all environments), I have nagios instances that try to monitor machines they can"t see and thus all checks fail and pager goes beep beep. ;)\r\n\r\nI found a work around using tags.\r\n\r\n{code}\r\nnode default {\r\n  # Globally apply an environment-based tag to all resources on each node.\r\n  tag("deployment::$environment")\r\n  ...\r\n}\r\n\r\n# And later ...\r\n\r\nSomeResource <<| tag == "deployment::$environment" |>> \r\n{code}\r\n\r\nThe above workaround is sufficient for me to continue deploying exported resources (not a blocker).\r\n\r\nI was expecting collectors of exported resources would only, by default, get resources from the same environment. Barring that, I think a query of {{<<| environment == ... |>>}} would be quite useful rather than resorting to tagging.', 'https://tickets.puppetlabs.com/browse/PUP-1078', 'https://github.com/puppetlabs/puppet/pull/8445', '2013-12-16T11:02:23.000-0800', '2017-05-18T10:45:04.000-0700', '2017-05-18T10:45:04.000-0700', 'Needs Information', 'customer;needs_decision;redmine', 5, '0', 1, 23, 3, 3, '8e054afba2643218049b8711069264e4d9c311ae', 'https://tickets.puppetlabs.com/browse/PUP-1078', 'https://github.com/puppetlabs/puppet/pull/8445'),
('puppet', 113143, 56687708, 4585, 'Change default parsing of manifest files to UTF-8', 'As part of PUP-2564, we changed our language to state that manifest files must be in UTF-8.  However, this is not enforced when we actually lex files with the parser, and it causes a host of issues on Windows in particular.\r\n\r\nhttps://docs.puppetlabs.com/puppet/latest/reference/lang_summary.html#files\r\n\r\nAs [~josh] alluded to, Windows will read the file then treat it as whatever the current codepage is, and this carries a number of issues.\r\n\r\nFor instance, take the manifest \r\n\r\n{code}\r\nuser { "Umlautä":\r\n  ensure => present,\r\n  password => "password"\r\n}\r\n{code}\r\n\r\nIf running with the codepage 437, the string produced by {{Puppet::FileSystem.read}} is incorrect for subsequent usage as {{ä}} gets turned into {{\xC3\xA4}}:\r\n\r\n{code}\r\n"user { "Umlaut\xC3\xA4":\n  ensure => present,\n  password => "password"\n}\n"\r\n{code}\r\n\r\nSo while the user is created, the name is {{Umlaut├ñ}} instead of {{Umlautä}} due to the way the converted bytes are represented when making the appropriate conversions (i.e calling {{.encode("utf-8")}} on the above string produces:\r\n\r\n{code}\r\n"user { "Umlaut\u251C\u00F1":\n  ensure => present,\n  password => "password"\n}\n"\r\n{code}\r\n\r\nIf instead the local codepage is set to {{65001}}, which is Unicode... then the behavior is correct.  However, this is not something we should expect users to do, and we should treat the incoming file as UTF-8 as that"s what our documentation specifies / and what we claim to expect.\r\n\r\nThe prior PUP-2564 ticket mentioned the inability of specifying an encoding during file reading at https://tickets.puppetlabs.com/browse/PUP-2564?focusedCommentId=125526&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-125526.  I think that"s a problem that can be easily fixed, at least in this narrow use case to start.\r\n\r\n\r\n\r\nI spiked a very quick solution to this problem for the sake of discussion.  With the change, the parsed string is now represents {{ä}} correct as {{\u00E4}}:\r\n\r\n{code}\r\n"user { "Umlaut\u00E4":\n  ensure => present,\n  password => "password"\n}\n"\r\n{code}\r\n\r\nI know that it fixes the problem with the manifest above (i.e. you can run any local codepage and the correct user name is used during creation based on the UTF8 file contents).  However, there could be some additional fallout, and there are certainly other places where files are read that could take similar tacts.', 'https://tickets.puppetlabs.com/browse/PUP-5728', 'https://github.com/puppetlabs/puppet/pull/4585', '2016-01-20T16:08:54.000-0800', '2017-05-24T11:01:17.000-0700', '2017-05-24T11:01:17.000-0700', 'Closed', 'i18n;utf-8', 15, '0', 1, 145, 17, 15, '8c6eda9d678b2d3e2e998cb4d9a27b52d59c1f60', 'https://tickets.puppetlabs.com/browse/PUP-5728', 'https://github.com/puppetlabs/puppet/pull/4585'),
('puppet', 79337, 0, 0, 'Ruby and irb on Windows can"t find "puppet", "facter", etc.', 'We don"t install our Ruby libraries into Ruby"s default library paths, so all our tools have batch files that set RUBYLIB. We didn"t do the same for Ruby binaries, so anyone trying to use Ruby from the MSI with Puppet will have problems. See PUP-735 for a case that came up in acceptance tests.\r\n\r\nWe should install our libraries into the normal Ruby library paths, as we do on other platforms, so Ruby things just work.', 'https://tickets.puppetlabs.com/browse/PUP-4547', '', '2015-05-08T11:14:31.000-0700', '2017-05-24T16:40:02.000-0700', '2017-05-24T16:40:02.000-0700', 'Closed', '', 12, '0', 0, 0, 0, 0, '77127d3580ed6b00d940fb05fcfb649689c4bb13', 'https://tickets.puppetlabs.com/browse/PUP-4547', 'https://github.com/puppetlabs/puppet/commit/77127d3580ed6b00d940fb05fcfb649689c4bb13'),
('puppet', 158631, 91286893, 5350, 'The network_device configuration parser should not accept trailing whitespace', 'If one inadvertently adds an additional space or carriage return to the end of their device configuration file (for example, for the f5 module), the `puppet device` command will fail with a somewhat cryptic message:\r\n\r\n{noformat}\r\n# puppet device -v --user=root\r\nInfo: starting applying configuration to some.hostname.com at https://myipaddress:443/\r\n/deviceCould not run: cannot load such file -- puppet/util/network_device/f5\r\n{noformat}\r\n\r\nThe problem is that the whitespace at the end of the line is included in the provider name when parsing the configuration file at https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/network_device/config.rb#L62, which then gets included in a require statement at https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/network_device.rb#L7.  \r\n\r\nThe regex needs to be updated to leave out any trailing whitespace to avoid this issue.', 'https://tickets.puppetlabs.com/browse/PUP-6847', 'https://github.com/puppetlabs/puppet/pull/5350', '2016-10-27T14:30:20.000-0700', '2017-05-25T15:53:07.000-0700', '2017-05-25T15:53:07.000-0700', 'Resolved', '', 5, '0', 1, 1, 1, 1, '00c13e4170323bac750c75f495f53325fe61c424', 'https://tickets.puppetlabs.com/browse/PUP-6847', 'https://github.com/puppetlabs/puppet/pull/5350'),
('puppet', 138264, 74849759, 5051, 'Package resource gem provider should preserve HOME env var', 'When the gem provider for the package resource is used, it will automatically look for its gemrc file in "/.gemrc" rather than the expected "/root/.gemrc" because the HOME environment variable is automatically cleared during the execution of the command at https://github.com/puppetlabs/puppet/blob/98d22be27447bcb34c33aa4a44610ab8768390f5/lib/puppet/util/execution.rb#L289-L294.  \r\n\r\nThe gem command uses the HOME environment variable in order to locate the user"s gemrc file, so clearing that variable forces it to fall back to the root of the filesystem.  This is not intuitive considering Puppet runs as root on the system.', 'https://tickets.puppetlabs.com/browse/PUP-6428', 'https://github.com/puppetlabs/puppet/pull/5051', '2016-06-22T11:39:47.000-0700', '2017-05-25T15:56:29.000-0700', '2017-05-25T15:56:29.000-0700', 'Closed', 'cspapercuts', 3, '0', 4, 8, 8, 2, '', 'https://tickets.puppetlabs.com/browse/PUP-6428', 'https://github.com/puppetlabs/puppet/pull/5051'),
('puppet', 193445, 123264147, 5929, 'catalog.resource() doesn"t accept "main" as a title parameter', 'When calling catalog.resource(type, title) with the string "main" as the title parameter, it doesn"t return a resource in the catalog with that title. It appears that title is getting passed through resource.munge_type_name(), which had a special case for :main that doesn"t kick in now we"re using the stringified data from to_hash. \r\n\r\nThis is triggered by PUP commit 7bbe36774; this returns title as a string in to_data_hash, where it used to be a symbol somtimes. The PDB terminus in turns calls catalog_resource with this, which then returns nil.', 'https://tickets.puppetlabs.com/browse/PUP-7605', 'https://github.com/puppetlabs/puppet/pull/5929', '2017-05-30T12:10:44.000-0700', '2017-06-07T14:59:15.000-0700', '2017-06-07T14:59:15.000-0700', 'Closed', '', 7, '0', 4, 53, 49, 14, '', 'https://tickets.puppetlabs.com/browse/PUP-7605', 'https://github.com/puppetlabs/puppet/pull/5929'),
('puppet', 194815, 124540602, 5958, 'CreateSymbolicLinkW returns the wrong data type', 'I was investigating why [~david.schmitt] and I were getting different results from `Puppet::FileSystem.symlink` on Windows. His VM was correctly reporting an error and mine was silently failing.\r\n\r\nWhen run as a non-administrator user on my VM, `CreateSymbolicLinkW` would return non-zero (success for this function) when it should have failed. Going through the MSDN docs, I noticed that it returns a 1 byte `BOOLEAN` rather than the 4 byte `BOOL` that it is currently prototyped for with FFI (so I was getting a value with random data in the 3 upper bytes).\r\n\r\nChanging the FFI prototype for the function over to returning an `int8` resolved the problem for me (see linked PR).', 'https://tickets.puppetlabs.com/browse/PUP-7627', 'https://github.com/puppetlabs/puppet/pull/5958', '2017-06-07T01:52:43.000-0700', '2017-06-14T06:18:42.000-0700', '2017-06-14T06:18:42.000-0700', 'Closed', 'resolved-issue-added;windows', 5, '0', 1, 5, 2, 3, 'e20cc78ff3f972ef3f6e68d0ec6bef3e92c0eaca', 'https://tickets.puppetlabs.com/browse/PUP-7627', 'https://github.com/puppetlabs/puppet/pull/5958'),
('puppet', 188601, 118537073, 5837, 'Top-scope Puppet function behavior is inconsistent with documentation', 'Per https://docs.puppet.com/puppet/4.10/lang_write_functions_in_puppet.html it is possible to write Puppet-language functions in the main manifest (top-scope). The warning in the documentation indicates that the behavior, as with other top-scope items, would be to have the function accessible to all modules.\r\n\r\nHowever, if you define a function in the main manifest and then try to call it from a module you will receive an error such as: "Error: Evaluation Error: Unknown function: "testfunc"". It works fine when called from the main manifest. Calling it with the leading "::" indicating top-scope has no change in behavior.\r\n\r\nThe expected behavior is that top-scope Puppet language functions would work per the documentation and similarly to their Ruby counterparts.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7485', 'https://github.com/puppetlabs/puppet/pull/5837', '2017-04-30T06:48:06.000-0700', '2017-06-14T06:18:42.000-0700', '2017-06-14T06:18:42.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 3, 150, 98, 5, '6fd687cf7c304182b6c44943c0384e7e1029a99a', 'https://tickets.puppetlabs.com/browse/PUP-7485', 'https://github.com/puppetlabs/puppet/pull/5837'),
('puppet', 187835, 117591928, 5823, 'Add tests for StringConverter#string_PRuntimeType', 'Commit [3107b59|https://github.com/puppetlabs/puppet/commit/3107b59] landed in puppet#stable, but the ticket PUP-7224 is marked as fixed in 5.0.\r\n\r\n*Updated*\r\n\r\nWe need to add tests for {{string_PRuntimeType}}. Commit 3107b59 was intentionally cherry-picked back to stable, but due to the ticket number fixVersion mismatch, it is flagged during ticket reconciliation. The important thing is that the old code in stable was broken, and the cherry-pick was correct. So now we just need tests, which the linked PR does.\r\n\r\n*Original*\r\n\r\nIt appears the {{StringConverter#string_PRuntimeType}} method is dead code, or at least is supposed to be called, but isn"t. I commented the method out, and all of the rspec tests pass.\r\n\r\nIf I enter a bogus format string, then the error is raised in {{string_PType}}, not {{string_PRuntimeType}}:\r\n\r\n{noformat}\r\nirb(main):012:0> Puppet::Pops::Types::StringConverter.convert(Puppet::Pops::Types::PRuntimeType::RUBY, "%s")\r\n=> "Runtime[ruby, ?]"\r\nirb(main):013:0> Puppet::Pops::Types::StringConverter.convert(Puppet::Pops::Types::PRuntimeType::RUBY, "%bogus")\r\nPuppet::Pops::Types::StringConverter::FormatError: Illegal format "b" specified for value of Type type - expected one of the characters "sp"\r\n        from /Users/josh/work/puppet/lib/puppet/pops/types/string_converter.rb:1025:in `string_PType" \r\n{noformat}\r\n\r\nSo this ticket is to:\r\n\r\n# Verify commit 3107b59 was supposed to land in stable, and revert it if not\r\n# Add tests\r\n# Ensure string_PRuntimeType gets called when it"s supposed to, or delete the method if it"s not needed\r\n\r\n/cc [~henrik.lindberg], [~kenn], [~geoff.nichols]', 'https://tickets.puppetlabs.com/browse/PUP-7469', 'https://github.com/puppetlabs/puppet/pull/5823', '2017-04-25T14:12:31.000-0700', '2017-06-14T06:18:42.000-0700', '2017-06-14T06:18:42.000-0700', 'Closed', '', 6, '0', 1, 18, 15, 2, '9d09f2df59f3a5daf873cc9257f228d2941b1cd9', 'https://tickets.puppetlabs.com/browse/PUP-7469', 'https://github.com/puppetlabs/puppet/pull/5823'),
('puppet', 192932, 123455714, 5934, 'Hiera hash keys are being converted to strings recursively', 'Puppet 4.9+ currently converts hiera hash elements into strings unconditiionally. YAML.load_file() will deserialize say an Integer to a ruby Fixnum, but the function symkeys_to_string converts every key to a string, regardless of whether it is a symbol.\r\n\r\nHere is a simple example:\r\n{code}\r\n$ports = lookup("ports")\r\n\r\n$ports.each |$port, $options | {\r\n	$port_type = type(Integer.new($port), "generalized")\r\n	notify { "${port} = ${port_type}":}\r\n}\r\n{code}\r\ncommon.yaml:\r\n{code}\r\nports:\r\n  80:\r\n    test: test\r\n  443:\r\n    test: test\r\n{code}\r\nAnd the output:\r\n{code}\r\nNotice: 80 = String\r\nNotice: /Stage[main]/Main/Notify[80 = String]/message: defined "message" as "80 = String"\r\nNotice: 443 = String\r\nNotice: /Stage[main]/Main/Notify[443 = String]/message: defined "message" as "443 = String"\r\nNotice: Applied catalog in 0.02 seconds\r\n{code}\r\n\r\nThis is also a regression in functionality from Puppet <4.8. PR uploaded to https://github.com/puppetlabs/puppet/pull/5912', 'https://tickets.puppetlabs.com/browse/PUP-7594', 'https://github.com/puppetlabs/puppet/pull/5934', '2017-05-24T18:09:40.000-0700', '2017-06-14T06:18:43.000-0700', '2017-06-14T06:18:43.000-0700', 'Closed', 'regression;resolved-issue-added', 7, '0', 1, 37, 19, 3, '6dd67c3bd7622aae65da22cf093fafadb755bdc4', 'https://tickets.puppetlabs.com/browse/PUP-7594', 'https://github.com/puppetlabs/puppet/pull/5934'),
('puppet', 191347, 121386103, 5887, 'Puppet runs fail when hiera.yaml version 3 detected in a module', 'This is a regression when upgrading from the 2016.4.x LTS to 2016.4.5. Puppet version 4.10.1 runs fail when an hiera.yaml version 3 file is found in the module. For a number of reasons, customers may have hiera.yaml files in modules and the environment. There should be a warning about the version and it should be ignores instead of causing a failure. \r\n\r\n*Impact*\r\nCustomers that upgrade to the latest LTS which have hiera.yaml 3 files in their modules will have failures. The upgrade should allow for customers to migrate into a hiera 5 type environment without failures. \r\n', 'https://tickets.puppetlabs.com/browse/PUP-7554', 'https://github.com/puppetlabs/puppet/pull/5887', '2017-05-16T15:21:50.000-0700', '2017-06-14T06:18:43.000-0700', '2017-06-14T06:18:43.000-0700', 'Closed', 'regression;resolved-issue-added', 10, '0', 1, 13, 4, 2, 'c13641f61e162c3808b5b15dde683fb2e172c415', 'https://tickets.puppetlabs.com/browse/PUP-7554', 'https://github.com/puppetlabs/puppet/pull/5887'),
('puppet', 56830, 0, 0, 'Update documentation regarding throw :undefined_variable for Scope [] and lookupvar', 'Using lookupvar within a function is throwing an evaluation error and not properly throwing Puppet::Error\r\nExample usage [STDLIB has_interface_with|https://github.com/puppetlabs/puppetlabs-stdlib/blob/master/lib/puppet/parser/functions/has_interface_with.rb#L48]\r\nError originates at [Scope.variable_not_found|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/parser/scope.rb#L404-L406]\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Function Call, uncaught throw :undefined_variable at /Users/travisfields/repos/puppetlabs/stdlib/network_test.pp:2:4 on node traviss-mbp.delivery.puppetlabs.net\r\n/Library/Ruby/Site/puppet/parser/scope.rb:405:in `throw"\r\n/Library/Ruby/Site/puppet/parser/scope.rb:405:in `variable_not_found"\r\n/Library/Ruby/Site/puppet/parser/scope.rb:397:in `lookupvar"\r\n/Users/travisfields/.puppet/modules/stdlib/lib/puppet/parser/functions/has_interface_with.rb:38:in `block in <module:Functions>"\r\n/Library/Ruby/Site/puppet/parser/functions.rb:164:in `block (2 levels) in newfunction"\r\n/Library/Ruby/Site/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/Library/Ruby/Site/puppet/util/profiler.rb:51:in `profile"\r\n/Library/Ruby/Site/puppet/parser/functions.rb:157:in `block in newfunction"\r\n/Users/travisfields/.puppet/modules/stdlib/lib/puppet/parser/functions/has_ip_network.rb:20:in `block in <module:Functions>"\r\n/Library/Ruby/Site/puppet/parser/functions.rb:164:in `block (2 levels) in newfunction"\r\n/Library/Ruby/Site/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/Library/Ruby/Site/puppet/util/profiler.rb:51:in `profile"\r\n/Library/Ruby/Site/puppet/parser/functions.rb:157:in `block in newfunction"\r\n/Library/Ruby/Site/puppet/pops/evaluator/runtime3_support.rb:248:in `call_function"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:785:in `eval_CallNamedFunctionExpression"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:43:in `block in visit_this"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:39:in `each"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:39:in `visit_this"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:66:in `visit_this_1"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:77:in `evaluate"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:857:in `block in eval_IfExpression"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:1090:in `with_guarded_scope"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:856:in `eval_IfExpression"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:43:in `block in visit_this"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:39:in `each"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:39:in `visit_this"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:66:in `visit_this_1"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:77:in `evaluate"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:521:in `block in eval_BlockExpression"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:521:in `each"\r\n/Library/Ruby/Site/puppet/pops/evaluator/evaluator_impl.rb:521:in `eval_BlockExpression"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:43:in `block in visit_this"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:39:in `each"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:39:in `visit_this"\r\n/Library/Ruby/Site/puppet/pops/visitor.rb:66:in `visit_this_1"\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-3597', '', '2014-10-30T17:43:03.000-0700', '2017-06-14T06:18:43.000-0700', '2017-06-14T06:18:43.000-0700', 'Closed', 'resolved-issue-added', 5, '0', 0, 0, 0, 0, '4d11441944b3a996499f3e1464449a6f1d49a1ba', 'https://tickets.puppetlabs.com/browse/PUP-3597', 'https://github.com/puppetlabs/puppet/commit/4d11441944b3a996499f3e1464449a6f1d49a1ba'),
('puppet', 181892, 120942937, 5877, 'Puppet with openssl 1.1 fails', 'Updating from openssl 1.0 to 1.1 breaks puppet:\r\n\r\n# puppet --version\r\n/usr/lib/ruby/vendor_ruby/2.4.0/puppet/util/monkey_patches.rb:104:in `<class:SSLContext>": undefined method `<<" for nil:NilClass (NoMethodError)\r\n	from /usr/lib/ruby/vendor_ruby/2.4.0/puppet/util/monkey_patches.rb:98:in `<top (required)>"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/vendor_ruby/2.4.0/puppet/util.rb:16:in `<module:Util>"\r\n	from /usr/lib/ruby/vendor_ruby/2.4.0/puppet/util.rb:15:in `<module:Puppet>"\r\n	from /usr/lib/ruby/vendor_ruby/2.4.0/puppet/util.rb:14:in `<top (required)>"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/vendor_ruby/2.4.0/puppet.rb:14:in `<top (required)>"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/vendor_ruby/2.4.0/puppet/util/command_line.rb:12:in `<top (required)>"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/lib/ruby/2.4.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /usr/bin/puppet:4:in `<main>"\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7383', 'https://github.com/puppetlabs/puppet/pull/5877', '2017-03-22T02:29:03.000-0700', '2017-06-14T06:18:43.000-0700', '2017-06-14T06:18:43.000-0700', 'Closed', 'needs_epic;resolved-issue-added', 10, '0', 1, 3, 1, 1, '578687a00195191185f44d8cb38f4b7716d99c31', 'https://tickets.puppetlabs.com/browse/PUP-7383', 'https://github.com/puppetlabs/puppet/pull/5877'),
('puppet', 187714, 117445835, 5819, 'Pcore ResourceType cannot handle title pattern with multiple entries', 'The Puppet generator, when generating a .pp file that contains a definition of a {{Puppet::Resource::ResourceType3}}, will emit a hash that corresponds to the {{title_patterns}} of the original {{ResourceType}}. Each value in this hash is an array of strings. In the original type, it was an array of one element arrays (a two element array where the second element is a Proc is possible but it is not supported by the generator, hence the simplification).\r\n\r\nThe problem is that when the generated resource is instantiated. Instead of wrapping each string into an array, the whole array of strings is mapped into an array. This entry:\r\n{code:ruby}\r\n/^((.+)\/(.*))$/ => ["name", "top_level", "lower_level"]\r\n{code}\r\nbecomes\r\n{code:ruby}\r\n/^((.+)\/(.*))$/ => [ ["name", "top_level", "lower_level"] ]\r\n{code}\r\ninstead of\r\n{code:ruby}\r\n/^((.+)\/(.*))$/ => [ ["name"], ["top_level"], ["lower_level"] ]\r\n{code}\r\nSubsequent attemtps to use this resource type crashes with:\r\n{code}\r\nError: undefined method `call" for :top_level:Symbol\r\n{code}\r\nsince it things that an array with more than one element contains a {{Proc}}.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7465', 'https://github.com/puppetlabs/puppet/pull/5819', '2017-04-25T01:30:24.000-0700', '2017-06-14T06:18:44.000-0700', '2017-06-14T06:18:44.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 4, 32, 10, 6, '61f7a991bd7b6a16d12fdce8a9509c1ed9a032ae', 'https://tickets.puppetlabs.com/browse/PUP-7465', 'https://github.com/puppetlabs/puppet/pull/5819'),
('puppet', 190628, 120224769, 5863, 'Can"t gem install puppet with some versions of bundler and ruby 1.9.3', 'Running {{puppet --version}} on ruby 1.9.3 and ubuntu 14.04 fails due to https://github.com/bundler/bundler/issues/3187\r\n\r\n{noformat}\r\nroot@cb37bnfmc142c5l:~# puppet --version\r\n/usr/lib/ruby/1.9.1/rubygems/version.rb:191:in `strip!": can"t modify frozen String (RuntimeError)\r\n	from /usr/lib/ruby/1.9.1/rubygems/version.rb:191:in `initialize"\r\n	from /var/lib/gems/1.9.1/gems/puppet-4.10.1/lib/puppet.rb:3:in `new"\r\n	from /var/lib/gems/1.9.1/gems/puppet-4.10.1/lib/puppet.rb:3:in `<top (required)>"\r\n	from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require"\r\n	from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require"\r\n	from /var/lib/gems/1.9.1/gems/puppet-4.10.1/lib/puppet/util/command_line.rb:12:in `<top (required)>"\r\n{noformat}\r\n\r\nThe problem is {{Gem::Version.new(RUBY_VERSION)}}, which apparently tries to {{strip!}} a frozen string.\r\n\r\nA common pattern is to {{dup}} the string.', 'https://tickets.puppetlabs.com/browse/PUP-7523', 'https://github.com/puppetlabs/puppet/pull/5863', '2017-05-11T16:37:51.000-0700', '2017-06-14T06:18:44.000-0700', '2017-06-14T06:18:44.000-0700', 'Closed', 'resolved-issue-added', 3, '0', 1, 4, 4, 3, 'fb9995da521269c17755c15dcb2d19afa7932501', 'https://tickets.puppetlabs.com/browse/PUP-7523', 'https://github.com/puppetlabs/puppet/pull/5863'),
('puppet', 188174, 118040084, 5832, 'A regex literal for matching backslashes causes a lexer error', 'Attempting to declare a regex literal for matching a single backslash results in a lexer error when the manifest is parsed.\r\n\r\n\r\nh2. Reproduction Case\r\n\r\nApply the following manifest which multiplies backslashes within a windows path:\r\n\r\n{code:puppet}\r\n$win_path = "c:\\some\\path"\r\n$backslash = /\\/\r\n\r\n$escaped_path = regsubst($win_path, $backslash, "\\\\\\\\", "G")\r\n\r\n\r\nnotice("Escaped path is: ${escaped_path}")\r\n{code}\r\n\r\n\r\nh3. Outcome\r\n\r\nApplying the manifest results in a parser error coming from the lexer code.\r\n\r\n{noformat}\r\n# puppet apply regex_test.pp --trace\r\nError: Could not parse for environment production: no implicit conversion of nil into String on node pe-201643-master.puppetdebug.vlan\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/lexer2.rb:380:in `+"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/lexer2.rb:380:in `block in initialize"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/lexer2.rb:710:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/lexer2.rb:710:in `scan"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/racc/parser.rb:319:in `_racc_yyparse_c"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/racc/parser.rb:319:in `yyparse"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/parser_support.rb:240:in `_parse"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/parser_support.rb:84:in `parse_file"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:41:in `parse_file"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/e4_parser_adapter.rb:31:in `parse"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/node/environment.rb:512:in `perform_initial_import"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/node/environment.rb:236:in `known_resource_types"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:762:in `block in initvars"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:241:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:760:in `initvars"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:422:in `initialize"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `new"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:266:in `block (2 levels) in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:264:in `block in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `block in benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:262:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:53:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:256:in `block in main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:241:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:225:in `main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:170:in `run_command"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:540:in `exit_on_fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:132:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>"\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\n{noformat}\r\nNotice: Scope(Class[main]): Escaped path is: c:\\some\\path\r\n{noformat}\r\n\r\nh3. Recommended Workaround\r\n\r\nEnclosing the backslashes in a capture group allows a regex literal to be constructed:\r\n\r\n{code:puppet}\r\n$backslash = /(\\)/\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7475', 'https://github.com/puppetlabs/puppet/pull/5832', '2017-04-26T18:50:53.000-0700', '2017-06-14T06:18:45.000-0700', '2017-06-14T06:18:45.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 1, 48, 3, 2, 'f8c731797da3ceaef921f61f4e652e813b9f4280', 'https://tickets.puppetlabs.com/browse/PUP-7475', 'https://github.com/puppetlabs/puppet/pull/5832'),
('puppet', 184802, 117002735, 5816, 'regression: epp parameter with default expression = undef  does not take', 'with puppet 4.8.3 and older versions the following code generated an empty notice:\r\n\r\n{code:java}\r\nnotice(inline_epp("<%- | Optional[String] $path = undef, | -%><%= $path %>", {}))\r\n{code}\r\n\r\nwith 4.10.0 and at least 4.9.4 the value of the fact "path" is returned.', 'https://tickets.puppetlabs.com/browse/PUP-7436', 'https://github.com/puppetlabs/puppet/pull/5816', '2017-04-07T08:34:34.000-0700', '2017-06-14T06:18:45.000-0700', '2017-06-14T06:18:45.000-0700', 'Closed', 'regression;resolved-issue-added', 1, '0', 1, 9, 1, 2, '9243ebb9088ed3447134059df1cf31748e2904cb', 'https://tickets.puppetlabs.com/browse/PUP-7436', 'https://github.com/puppetlabs/puppet/pull/5816'),
('puppet', 149231, 106210527, 5643, 'ensure => latest doesn"t work with enablerepo install_options for package resource', 'Consider the following situation:\r\n\r\nI want to update nodejs package to the latest version with Puppet. I have two repos - {{epel}} and {{nodesource}} - that contain the package. I want it to update using the {{nodesource}} repo.\r\n\r\nThis is the manifest that I used:\r\n\r\n{code}\r\npackage { "nodejs":\r\n  ensure          => "latest",\r\n  install_options => [ {"--disablerepo" => "*", "--enablerepo" => "nodesource"}],\r\n}\r\n{code} \r\n\r\nI ran this manifest and it did nothing - doesn"t work. The package was not updated. It works if I just do {{yum --disablerepo=* --enablerepo=nodesource update nodejs}}\r\n\r\n{code}\r\n\r\n========================================================================================\r\n Package        Arch           Version                         Repository          Size\r\n========================================================================================\r\nUpdating:\r\n nodejs         x86_64         1:4.5.0-1nodesource.el6         nodesource         8.7 M\r\n\r\nTransaction Summary\r\n========================================================================================\r\nUpgrade       1 Package(s)\r\n\r\nTotal download size: 8.7 M\r\nIs this ok [y/N]:\r\n\r\n\r\n{code}\r\n\r\nIs this a normal behavior when using {{enablerepo}} with {{ensure => latest}} or is this a bug?\r\n\r\nThanks.', 'https://tickets.puppetlabs.com/browse/PUP-6656', 'https://github.com/puppetlabs/puppet/pull/5643', '2016-08-25T18:22:48.000-0700', '2017-06-14T06:18:45.000-0700', '2017-06-14T06:18:45.000-0700', 'Closed', 'resolved-issue-added', 11, '0', 1, 18, 19, 2, '60738625cf68ddbaf76fa050282e0b8733e32abd', 'https://tickets.puppetlabs.com/browse/PUP-6656', 'https://github.com/puppetlabs/puppet/pull/5643'),
('puppet', 193934, 123587662, 5936, 'It is impossible to navigate an integer keyed Hiera hash using dotted keys', 'With the fix of PUP-7594, it is now possible to use hashes with integer keys in Hiera. Those keys can however not be navigated using a dotted key with integer numbers in it. I.e.\r\n{code:yaml}\r\nports:\r\n  80:\r\n    test: test\r\n{code}\r\ncannot be navigated using the key "ports.80". This is because integers in dotted keys are presumed to be positional indexes in arrays, not keys in hashes.\r\n\r\nIt should be possible to navigate a hash containing integer keys. A hash containing strings that represent integers should also be possible to navigate, but then, the integer in the dotted key must be quoted. E.g.\r\n{code:yaml}\r\nports:\r\n  "80":\r\n    test: test\r\n{code}\r\nshould not be found by key {{ports.80}}. Instead, {{ports."80"}} must be used.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7612', 'https://github.com/puppetlabs/puppet/pull/5936', '2017-06-01T00:45:37.000-0700', '2017-06-14T06:18:46.000-0700', '2017-06-14T06:18:46.000-0700', 'Closed', 'resolved-issue-added', 18, '0', 1, 35, 18, 3, 'de420764ca18a8145f9a10adc277259ed8af01ca', 'https://tickets.puppetlabs.com/browse/PUP-7612', 'https://github.com/puppetlabs/puppet/pull/5936'),
('puppet', 194232, 123807407, 5941, 'Leftover /opt/puppet contents cause upgrades to fail on locale/config.yaml', 'If there happens to be any leftover files from older PE installations, it will cause the PE 2017.2.1 installation to fail because Puppet will end up pulling the wrong locale path:\r\n\r\n\r\n{code:java}\r\n2017-05-29 14:42:51,320 Running command: /opt/puppetlabs/puppet/bin/puppet infrastructure configure  --detailed-exitcodes --modulepath /opt/puppetlabs/server/data/enterprise/modules \r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/psych.rb:464:in `initialize": No such file or directory @ rb_sysopen - /opt/puppet/share/locale/config.yaml (Errno::ENOENT)\r\n	from /opt/puppetlabs/puppet/lib/ruby/2.1.0/psych.rb:464:in `open"\r\n	from /opt/puppetlabs/puppet/lib/ruby/2.1.0/psych.rb:464:in `load_file"\r\n	from /opt/puppetlabs/puppet/lib/ruby/gems/2.1.0/gems/gettext-setup-0.20/lib/gettext-setup/gettext_setup.rb:21:in `initialize"\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:80:in `singleton class"\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:55:in `<module:Puppet>"\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:49:in `<top (required)>"\r\n	from /opt/puppetlabs/puppet/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /opt/puppetlabs/puppet/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:12:in `<top (required)>"\r\n	from /opt/puppetlabs/puppet/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /opt/puppetlabs/puppet/lib/ruby/2.1.0/rubygems/core_ext/kernel_require.rb:55:in `require"\r\n	from /opt/puppetlabs/puppet/bin/puppet:4:in `<main>"\r\n* /opt/puppetlabs/puppet/bin/puppet infrastructure configure  --detailed-exitcodes --modulepath /opt/puppetlabs/server/data/enterprise/modules \r\n* returned: 1\r\n{code}\r\n\r\nThis appears to be due to how Puppet searches for the locale directory in https://github.com/puppetlabs/puppet/blob/4.10.1/lib/puppet.rb#L56-L73.  https://github.com/puppetlabs/puppet/blob/4.10.1/lib/puppet.rb#L60 will set {{posix_system_locale_path}} to {{/opt/puppetlabs/puppet/share/locale}}, which is the correct path.  The problem is that https://github.com/puppetlabs/puppet/blob/4.10.1/lib/puppet.rb#L62 runs regardless of the Puppet master not being a Windows machine and sets {{win32_system_locale_path}} to {{/opt/puppet/share/locale/config.yaml}} (because that would be /opt/puppetlabs/puppet/lib/ruby/vendor_ruby/../../../../../puppet/share/locale).\r\n\r\nSince {{win32_system_locale_path}} is checked before {{posix_system_locale_path}} in the if/else block at https://github.com/puppetlabs/puppet/blob/4.10.1/lib/puppet.rb#L64-L73, the "windows" path will be used.  If the old directory still exists, this path gets passed to GettextSetup, which leads to the failure.\r\n\r\nI"d think the fix would be to add logic to https://github.com/puppetlabs/puppet/blob/4.10.1/lib/puppet.rb#L68 to check if we are actually on a Windows system \r\n\r\nor\r\n\r\nMove the {{posix_system_locale_path}} check above the {{win32_system_locale_path}} one in the if/else block.', 'https://tickets.puppetlabs.com/browse/PUP-7617', 'https://github.com/puppetlabs/puppet/pull/5941', '2017-06-02T14:25:00.000-0700', '2017-06-14T06:18:46.000-0700', '2017-06-14T06:18:46.000-0700', 'Closed', 'maintenance;triage', 2, '0', 1, 2, 2, 1, '3269f11fc68a518070fdc608aabe3af7317a5f97', 'https://tickets.puppetlabs.com/browse/PUP-7617', 'https://github.com/puppetlabs/puppet/pull/5941'),
('puppet', 187950, 118969360, 5843, 'lookups within hiera data values break %{literal("%")}', 'consider the hiera data fragment:\r\n{code}\r\n---\r\nsome_text: "%{alias("label_format")}"\r\nlabel_format: "%{literal("%")}{vpc}_pub%{literal("%")}{az}"\r\n{code}\r\n---\r\nWhen you lookup the value "label_format" you correctly obtain the string\r\n{code}\r\n"%{vpc}_pub%{az}"\r\n{code}\r\nas the value.  However, if you lookup the value "some_text" then the result depends on whether\r\n{code}\r\n%{vpc}\r\n{code}\r\nand\r\n{code}\r\n%{az}\r\n{code}\r\nhave valid substitutions.  Without facts or variables, the current result from the lookup is the string "_pub"\r\n \r\nUntil this bug is fixed, the utility of the %{literal("%")} function is limited to being used in values that are only directly requested.', 'https://tickets.puppetlabs.com/browse/PUP-7492', 'https://github.com/puppetlabs/puppet/pull/5843', '2017-04-26T08:15:06.000-0700', '2017-06-14T06:18:46.000-0700', '2017-06-14T06:18:46.000-0700', 'Closed', 'resolved-issue-added', 7, '0', 2, 51, 10, 2, 'e55391e9d144f59b2bd70f4f0e89bc28d817a251', 'https://tickets.puppetlabs.com/browse/PUP-7492', 'https://github.com/puppetlabs/puppet/pull/5843'),
('puppet', 191244, 123360597, 5933, 'Hiera 5 eyaml_lookup_key options gets overwritten when multiple entries are used.', 'When using Hiera 5 with the same Hierarchy file name at the global and environment level, lookups fail to use the options associated with the global level It appears that the global file path is used, but the environment options are used. When using eyaml, this results in using the wrong keys on the eyaml file.\r\n\r\n*Example*\r\n\r\nGlobal hiera.yaml\r\n{code}\r\n---\r\nversion: 5\r\ndefaults:\r\n  datadir: data\r\n\r\nhierarchy:\r\n  - name: "Global secrets"\r\n    lookup_key: eyaml_lookup_key\r\n    path: "secrets.eyaml"\r\n    options:\r\n      pkcs7_private_key: /etc/puppetlabs/puppet/keys/private_key.pkcs7.pem\r\n      pkcs7_public_key: /etc/puppetlabs/puppet/keys/public_key.pkcs7.pem\r\n{code}\r\n\r\nEnvironment hiera.yaml\r\n{code}\r\n---\r\nversion: 5\r\ndefaults:\r\n  datadir: data\r\n\r\nhierarchy:\r\n  - name: "Environment secrets"\r\n    lookup_key: eyaml_lookup_key\r\n    path: "secrets.eyaml"\r\n    options:\r\n      pkcs7_private_key: /etc/puppetlabs/code/environments/production/keys/private_key.pkcs7.pem\r\n      pkcs7_public_key: /etc/puppetlabs/code/environments/production/keys/public_key.pkcs7.pem\r\n{code}\r\n\r\nLooking up a key which is both the environment and global secrets.eyaml\r\n{code}\r\n# puppet lookup secret --explain\r\nError: Could not run: bad decrypt\r\n{code}\r\n\r\nLooking up a nonexistent key\r\n{code}\r\n# puppet lookup doesnotexist --explain\r\nSearching for "doesnotexist"\r\n  Global Data Provider (hiera configuration version 5)\r\n    Using configuration "/etc/puppetlabs/puppet/hiera.yaml"\r\n    Hierarchy entry "Global secrets"\r\n      Path "/etc/puppetlabs/puppet/data/secrets.eyaml"\r\n        Original path: "secrets.eyaml"\r\n        No such key: "doesnotexist"\r\n  Environment Data Provider (hiera configuration version 5)\r\n    Using configuration "/etc/puppetlabs/code/environments/production/hiera.yaml"\r\n    Hierarchy entry "Environment secrets"\r\n      Path "/etc/puppetlabs/code/environments/production/data/secrets.eyaml"\r\n        Original path: "secrets.eyaml"\r\n        No such key: "doesnotexist"\r\nFunction lookup() did not find a value for the name "doesnotexist"\r\n{code}\r\n\r\nAn environment specific key works when not defined in the global eyaml file. \r\n{code}\r\n# puppet lookup envsecret --explain\r\nWarning: Unknown variable: "creates_path". at /opt/puppetlabs/puppet/modules/pe_staging/manifests/extract.pp:56:22\r\nSearching for "envsecret"\r\n  Global Data Provider (hiera configuration version 5)\r\n    Using configuration "/etc/puppetlabs/puppet/hiera.yaml"\r\n    Hierarchy entry "Global secrets"\r\n      Path "/etc/puppetlabs/puppet/data/secrets.eyaml"\r\n        Original path: "secrets.eyaml"\r\n        No such key: "envsecret"\r\n  Environment Data Provider (hiera configuration version 5)\r\n    Using configuration "/etc/puppetlabs/code/environments/production/hiera.yaml"\r\n    Hierarchy entry "Environment secrets"\r\n      Path "/etc/puppetlabs/code/environments/production/data/secrets.eyaml"\r\n        Original path: "secrets.eyaml"\r\n        Found key: "envsecret" value: "environmentsecret"\r\n{code}\r\n\r\nA global specific key fails\r\n{code}\r\n# puppet lookup globalsecret --explain\r\nError: Could not run: bad decrypt\r\n{code}\r\n\r\n\r\n*Steps to Reproduce*\r\n# Install 2017.2.1\r\n# Install eyaml\r\n# Configure the global hiera.yaml as above\r\n# Create eyaml keys for the global eyaml\r\n# Create encrypted keys in the global data/secrets.eyaml\r\n# Configure the environment hiera.yaml as above\r\n# Create eyaml keys for the environment eyaml\r\n# Create encrypted keys in the environment data/secrets.eyaml\r\n# Lookup keys defined in the global secrets.eyaml\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7543', 'https://github.com/puppetlabs/puppet/pull/5933', '2017-05-16T09:28:44.000-0700', '2017-06-14T06:18:46.000-0700', '2017-06-14T06:18:46.000-0700', 'Closed', 'resolved-issue-added', 4, '0', 2, 127, 12, 2, 'aa5e6bc9d5fee2b2545da1647a86a8b4e653b1d8', 'https://tickets.puppetlabs.com/browse/PUP-7543', 'https://github.com/puppetlabs/puppet/pull/5933'),
('puppet', 71272, 0, 0, 'Backport Weekly tasks always notify "trigger changed" to Puppet 3.8', '', 'https://tickets.puppetlabs.com/browse/PUP-4186', '', '2015-03-11T13:35:01.000-0700', '2017-06-15T09:09:03.000-0700', '2017-06-15T09:09:03.000-0700', 'Resolved', 'windows', 1, '0', 0, 0, 0, 0, '304255e61152b366e733b72639ef87a5ba8661eb', 'https://tickets.puppetlabs.com/browse/PUP-4186', 'https://github.com/puppetlabs/puppet/commit/304255e61152b366e733b72639ef87a5ba8661eb'),
('puppet', 74031, 32469808, 3782, 'Port PUP-3388 "Issue Creating Multiple Mirrors in Zpool Resource" to PUP 3.8', 'This is a new ticket to port the fixes done for PUP-3388 to release PUP 3.8.0\r\n\r\nBug in the mirror property under zpool resource\r\n\r\nhttps://docs.puppetlabs.com/references/latest/type.html#zpool-attribute-mirror\r\n\r\nmirror => ["disk1 disk2", "disk3 disk4"],\r\n\r\nIn the Previous version It took that string value as a single array and tried to find a drive named "disk1 disk2" and also wouldn"t attach the word mirror to "disk3 disk4"\r\n\r\nrisk: medium\r\nprobability: medium (zpool mirror array)\r\nseverity: low (work arounds are fairly obvious)\r\ntest layer: acceptance', 'https://tickets.puppetlabs.com/browse/PUP-4345', 'https://github.com/puppetlabs/puppet/pull/3782', '2015-03-31T09:44:14.000-0700', '2017-06-19T16:35:00.000-0700', '2017-06-19T16:35:00.000-0700', 'Resolved', '', 2, '0', 3, 145, 34, 3, '', 'https://tickets.puppetlabs.com/browse/PUP-4345', 'https://github.com/puppetlabs/puppet/pull/3782'),
('puppet', 94494, 110536767, 5715, 'The sshkey Type"s Default Target for Mac OS X 10.11 (El Capitan) is Incorrect', 'I"m using exported resources to manage the ssh_known_hosts file on a mixed network of Mac OS X and RHEL systems. Previously, Mac OS X stored SSH files at the top level of /etc/, so the previous default target value of /etc/ssh_known_hosts was correct. However, in El Capitan, SSH configuration files are now stored in /etc/ssh. It seems unlikely that this will change in the final release. The workaround is to specify the value "/etc/ssh/ssh_known_hosts" as the target attribute for the sshkey type on each host. This is a little awkward, since I have to set it differently for my existing Yosemite systems that still use /etc/ssh_known_hosts. I"m using something that looks a little like this right now in my test environment, which is propagating through my system as we speak:\r\n\r\n{noformat}\r\n        @@sshkey {\r\n                $fqdn:\r\n                        type => ssh-rsa,\r\n                        host_aliases => $fqdn ? {\r\n                                default                     => [$hostname, $ipaddress]\r\n                        },\r\n                        target => "/etc/ssh/ssh_known_hosts",\r\n                        key => $sshrsakey\r\n        }\r\n\r\n        Sshkey <<| |>>\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5058', 'https://github.com/puppetlabs/puppet/pull/5715', '2015-08-20T15:16:58.000-0700', '2017-06-20T10:49:10.000-0700', '2017-06-20T10:49:10.000-0700', 'Closed', '', 6, '0', 1, 72, 0, 1, '79a065b33ba5c377ac384b52432a884f1f88d01f', 'https://tickets.puppetlabs.com/browse/PUP-5058', 'https://github.com/puppetlabs/puppet/pull/5715'),
('puppet', 119837, 103576704, 5557, 'Make error message for multiple validation errors actionable', 'During rspec tests while migrating from Puppet 3 to Puppet 4, I encountered an error that was non-obvious to me.\r\n{code}\r\n24) wiki Set common params should contain Firewall[105 searchd]\r\n     Failure/Error: it { is_expected.to contain_firewall("105 searchd") }\r\n     Puppet::ParseErrorWithIssue:\r\n       Found 2 errors. Giving up in <PATH>/puppet/controlrepo/dist/wiki/spec/fixtures/modules/wiki/manifests/init.pp on node chi-build04.mss.local\r\n{code}\r\nThe error message that I focused on was "Found 2 errors. Giving up in ..." It doesn"t say, or show, the errors. Eventually I determined this came from https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/issue_reporter.rb#L72 due to some help from Henrik on IRC, at which point I realized I was running "puppet parser validate" against the file instead of "bundle exec puppet parser validate" (the node is still on v3.7 as we"re not migrating yet).\r\n\r\nI feel an error message such as "Found # errors during parser validation" would be an improvement here. If the actual errors can be floated up to rspec-puppet even better.', 'https://tickets.puppetlabs.com/browse/PUP-6006', 'https://github.com/puppetlabs/puppet/pull/5557', '2016-03-03T15:45:03.000-0800', '2017-06-20T11:58:51.000-0700', '2017-06-20T11:58:51.000-0700', 'Closed', '', 8, '0', 1, 1, 1, 1, 'efcdf580b1013541da3f92104e0ac3ebac52f901', 'https://tickets.puppetlabs.com/browse/PUP-6006', 'https://github.com/puppetlabs/puppet/pull/5557'),
('puppet', 21689, 101538455, 5505, 'metadata.json is parsed twice', 'When an instance of class Puppet::Module is created, the initialize method will first call has_metadata? to check if the metadata.json file is present and valid. This method will do a full parse of the file to check its validity. Next, the initializer will call the method load_metadata. It parses the same file once again.\r\n\r\nSuggestion:\r\n# Add a validity check to the load_metadata method by adding a begin/rescue around its PSON.parse\r\n# Remove the call to has_metadata? from the initialize method', 'https://tickets.puppetlabs.com/browse/PUP-5027', 'https://github.com/puppetlabs/puppet/pull/5505', '2013-12-18T01:50:08.000-0800', '2017-06-20T11:59:51.000-0700', '2017-06-20T11:59:51.000-0700', 'Closed', '', 8, '0', 1, 99, 82, 3, 'f2e8e6649d392d5d3b7b8e79efbf15815adcdcc8', 'https://tickets.puppetlabs.com/browse/PUP-5027', 'https://github.com/puppetlabs/puppet/pull/5505'),
('puppet', 166569, 105728011, 5634, 'Prevent incompatible encodings reaching Puppet::Parameter#format from ruby Etc module', '[Puppet::Parameter#format|https://github.com/puppetlabs/puppet/blob/83909490a047b15f7fd4ca4f72490112740a7aec/lib/puppet/parameter.rb#L541-L543] currently does not check if the strings it is interpolating are of incompatible encodings.\r\n\r\nThis method is used, among other places, in the resource harness when [setting the message for failed change events|https://github.com/puppetlabs/puppet/blob/83909490a047b15f7fd4ca4f72490112740a7aec/lib/puppet/transaction/resource_harness.rb#L147-L149]. If the strings contain incompatible encodings (i.e., they cannot be concatenated) the format method will fail, the event will not contain a message, and then it will fail to be logged.\r\n\r\nThis also results in error messages that look like this:\r\n{code}\r\nError: /Stage[main]/Main/Node[ubuntu16.localdomain]/User[foo]: Could not evaluate: Puppet::Util::Log requires a message\r\n{code}\r\n\r\n*Notes*\r\n* After diving further into this, this form of problem is scattered all through puppet - the concatenation of strings without regard to encoding. The deeper problem is that strings are entering the system in incompatible encodings to begin with. The problem-area that gave rise to this specific bug is the nameservice provider, and specifically it"s reliance on the {{Etc}} module in ruby, which can return strings in default external encoding which are then sent around puppet to be compared and munged with utf-8 strings. Thus this ticket is now re-scoped from it"s original (smaller context) to include a broader fix of setting strings incoming from {{Etc}} to utf-8.\r\n\r\n*In Scope*\r\n* Anywhere we take strings in the from the {{Etc}} module in a provider, these strings should have UTF-8 encoding\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7021', 'https://github.com/puppetlabs/puppet/pull/5634', '2016-12-15T15:13:28.000-0800', '2017-06-20T14:47:24.000-0700', '2017-06-20T14:47:24.000-0700', 'Closed', '', 8, '0', 2, 440, 59, 5, '346036876996ff1a6d7c169a818c7453c0cc47a6', 'https://tickets.puppetlabs.com/browse/PUP-7021', 'https://github.com/puppetlabs/puppet/pull/5634'),
('puppet', 189770, 122673351, 5918, 'Remove Puppet::Log alias to Puppet::Util::Log', 'At the bottom of Puppet::Util::Log:\r\n{code}\r\n# This is for backward compatibility from when we changed the constant to Puppet::Util::Log\r\n# because the reports include the constant name.  Apparently the alias was created in\r\n# March 2007, should could probably be removed soon.\r\nPuppet::Log = Puppet::Util::Log\r\n{code}\r\n\r\nThat is from https://github.com/puppetlabs/puppet/commit/1c6d57e94196c8238a1609858bad5e5db15d1f0e, added in 0.26.\r\n\r\nWe have a few places in the code where we reference Puppet::Log, and many many more that reference Puppet::Util::Log\r\n\r\nBefore Puppet::Log proliferates further lets remove it and do the cleanup in the code?', 'https://tickets.puppetlabs.com/browse/PUP-7502', 'https://github.com/puppetlabs/puppet/pull/5918', '2017-05-08T10:42:08.000-0700', '2017-06-20T18:17:52.000-0700', '2017-06-20T18:17:52.000-0700', 'Closed', '', 4, '0', 1, 3, 3, 1, '112362128a22ddba2f419de20669c3e3785c882f', 'https://tickets.puppetlabs.com/browse/PUP-7502', 'https://github.com/puppetlabs/puppet/pull/5918'),
('puppet', 22649, 32272468, 3770, 'Windows Group and User fail during deletion even though it is successful', 'This is due to commit being called in the flush method when it should not be.\r\n\r\nSteps to reproduce:\r\n\r\n 1. Create a user `puppet apply -e "user{"FakeTestUser": ensure => present, password => "nobodyknowssupersecret", }"\r\n 2. Delete a user - `puppet apply -e "user{"FakeTestUser": ensure => absent, }"\r\n\r\n{noformat}\r\nNotice: /User[FakeTestUser]/ensure: removed\r\nError: /User[FakeTestUser]: Could not evaluate: User update failed: ADSI connection error: failed to parse display name of moniker `WinNT://./FakeTestUser,user"\r\n    HRESULT error code:0x800708ad\r\n      The user name could not be found.\r\nC:/code/puppetlabs/puppet/lib/puppet/util/adsi.rb:101:in `rescue in commit"\r\nC:/code/puppetlabs/puppet/lib/puppet/util/adsi.rb:98:in `commit"\r\nC:/code/puppetlabs/puppet/lib/puppet/provider/user/windows_adsi.rb:54:in `flush"\r\n\r\nC:/code/puppetlabs/puppet/lib/puppet/type.rb:963:in `flush"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction/resource_harness.rb:144:in `evaluate"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction.rb:161:in `apply"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction.rb:174:in `eval_resource"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction.rb:104:in `call"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction.rb:104:in `block (2 levels) in evaluate"\r\nC:/code/puppetlabs/puppet/lib/puppet/util.rb:354:in `block in thinmark"\r\nC:/ruby193/lib/ruby/1.9.1/benchmark.rb:295:in `realtime"\r\nC:/code/puppetlabs/puppet/lib/puppet/util.rb:353:in `thinmark"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction.rb:104:in `block in evaluate"\r\nC:/code/puppetlabs/puppet/lib/puppet/graph/relationship_graph.rb:118:in `traverse"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction.rb:95:in `evaluate"\r\nC:/code/puppetlabs/puppet/lib/puppet/resource/catalog.rb:164:in `block in apply"\r\n\r\nC:/code/puppetlabs/puppet/lib/puppet/util/log.rb:147:in `with_destination"\r\nC:/code/puppetlabs/puppet/lib/puppet/transaction/report.rb:108:in `as_logging_destination"\r\nC:/code/puppetlabs/puppet/lib/puppet/resource/catalog.rb:163:in `apply"\r\nC:/code/puppetlabs/puppet/lib/puppet/configurer.rb:125:in `block in apply_catalog"\r\nC:/code/puppetlabs/puppet/lib/puppet/util.rb:182:in `block in benchmark"\r\nC:/ruby193/lib/ruby/1.9.1/benchmark.rb:295:in `realtime"\r\nC:/code/puppetlabs/puppet/lib/puppet/util.rb:181:in `benchmark"\r\nC:/code/puppetlabs/puppet/lib/puppet/configurer.rb:124:in `apply_catalog"\r\nC:/code/puppetlabs/puppet/lib/puppet/configurer.rb:190:in `run"\r\nC:/code/puppetlabs/puppet/lib/puppet/application/apply.rb:273:in `apply_catalog"\r\n\r\nC:/code/puppetlabs/puppet/lib/puppet/application/apply.rb:223:in `main"\r\nC:/code/puppetlabs/puppet/lib/puppet/application/apply.rb:151:in `run_command"\r\nC:/code/puppetlabs/puppet/lib/puppet/application.rb:364:in `block (2 levels) in run"\r\nC:/code/puppetlabs/puppet/lib/puppet/application.rb:457:in `plugin_hook"\r\nC:/code/puppetlabs/puppet/lib/puppet/application.rb:364:in `block in run"\r\nC:/code/puppetlabs/puppet/lib/puppet/util.rb:511:in `exit_on_fail"\r\nC:/code/puppetlabs/puppet/lib/puppet/application.rb:364:in `run"\r\nC:/code/puppetlabs/puppet/lib/puppet/util/command_line.rb:132:in `run"\r\nC:/code/puppetlabs/puppet/lib/puppet/util/command_line.rb:86:in `execute"\r\nC:/code/puppetlabs/puppet/bin/puppet:4:in `&lt;top (required)&gt;"\r\nC:/ruby193/lib/ruby/gems/1.9.1/bin/puppet:23:in `load"\r\nC:/ruby193/lib/ruby/gems/1.9.1/bin/puppet:23:in `&lt;main&gt;"\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-1279', 'https://github.com/puppetlabs/puppet/pull/3770', '2013-12-30T10:26:52.000-0800', '2017-06-27T11:16:06.000-0700', '2017-06-27T11:16:06.000-0700', 'Closed', 'redmine;windows', 20, '0', 1, 36, 2, 4, 'dc41d16c95c009bfb05f5f5a5cf2ebe12cc0e966', 'https://tickets.puppetlabs.com/browse/PUP-1279', 'https://github.com/puppetlabs/puppet/pull/3770'),
('puppet', 191929, 121386410, 5888, 'Add CLI flag to pass job-id to puppet agent', 'In order to actually thread job-id from orchestrator through the agent to PuppetDB, we need to have a facility to provide the job-id to the agent. As of PUP-7149, the code exists internally in puppet to handle job-id, but there"s no way to pass it in from the outside. That ticket was contingent on a refactor of the way pxp-agent interfaces with puppet to start using the API instead of the command line. That work is deferred due to complexity, so the revised solution is to just provide a flag to set job-id on the command line.', 'https://tickets.puppetlabs.com/browse/PUP-7575', 'https://github.com/puppetlabs/puppet/pull/5888', '2017-05-18T14:31:19.000-0700', '2017-06-28T12:20:40.000-0700', '2017-06-28T12:20:40.000-0700', 'Closed', '', 1, '0', 1, 16, 1, 2, '5e418972fc4de53fd85c05bb79d222f4bbee2f4c', 'https://tickets.puppetlabs.com/browse/PUP-7575', 'https://github.com/puppetlabs/puppet/pull/5888'),
('puppet', 192705, 122310994, 5909, '"Classes are not virtualizable" warning with resource-type non-virtual class declaration', 'On master, a basic manifest triggers a warning for virtualizable classes, which I think is incorrect:\r\n\r\ntest.pp:\r\n\r\n{noformat}\r\nclass a { }\r\nclass { "a": }\r\n{noformat}\r\n\r\n{noformat}\r\n$ be puppet parser validate test.pp\r\nWarning: Classes are not virtualizable at test.pp:2:1\r\n{noformat}\r\n\r\nPrior to PUP-1606 being merged into master, this didn"t occur. This warning does not appear to occur on the stable branch with PUP-1606, only on master with PUP-1606, so may only affect Puppet 5.', 'https://tickets.puppetlabs.com/browse/PUP-7590', 'https://github.com/puppetlabs/puppet/pull/5909', '2017-05-24T04:33:55.000-0700', '2017-06-28T12:20:40.000-0700', '2017-06-28T12:20:40.000-0700', 'Closed', '', 3, '0', 2, 9, 2, 3, '7bb08e13285c448e2c1b20dc49a38ab03f0ce354', 'https://tickets.puppetlabs.com/browse/PUP-7590', 'https://github.com/puppetlabs/puppet/pull/5909'),
('puppet', 193310, 122899938, 5924, 'StringConverter should be more diligent about using single quotes ', 'The `StringConverter`, when converting strings to their "%p" format, will currently use double quotes in many cases where it is unnecessary. In essence, the only time that double qoutes are needed when producing a string, is when the string contains control characters (codepoint < 0x20) or non-ascii characters (codepoint > 0x7f). In all other cases, it"s desirable to use single quotes since the representation gets more compact and is more efficient to parse.', 'https://tickets.puppetlabs.com/browse/PUP-7603', 'https://github.com/puppetlabs/puppet/pull/5924', '2017-05-29T06:42:30.000-0700', '2017-06-28T12:20:40.000-0700', '2017-06-28T12:20:40.000-0700', 'Closed', '', 0, '0', 4, 75, 36, 7, 'f9f01c319d72a8ef28bb0f71fb4ddae9f86b3b2b', 'https://tickets.puppetlabs.com/browse/PUP-7603', 'https://github.com/puppetlabs/puppet/pull/5924'),
('puppet', 193883, 124590293, 5959, 'Can"t turn off deprecation warnings', 'There are a few different issues with how {{warn_once}} is implemented that prevent deprecation warnings from being silenced.\r\n\r\n# There are typos, e.g. {{deprecatation}}\r\n# We use both symbols and strings:\r\n{noformat}\r\nPuppet.warn_once("deprecation", "AST::ResourceParam", _("Use of Puppet::Parser::AST::ResourceParam is deprecated and not fully functional"))\r\nPuppet.warn_once(:deprecation, "metadata.json#data_provider-#{module_name}",\r\n{noformat}\r\n# The {{warn_once}} logic doesn"t account for string vs symbol, which probably wasn"t a problem before we removed the symbol string monkey_patch:\r\n{code:ruby}\r\n    return if Puppet[:disable_warnings].include?(kind)\r\n{code}\r\n# The {{disable_warnings}} setting only accepts plural {{deprecations}}, but all of the {{warn_once}} call sites use singular {{deprecation}}, so the {{include?}} check never matches\r\n# There is another {{warnonce}} method defined in {{Puppet::Util::Warnings}}.\r\n\r\nBut the main issue is that you can"t turn deprecations off:\r\n\r\n{code:puppet}\r\nnotify { "1":\r\n  message => strftime("%s")\r\n}\r\nnotify { "2":\r\n  message => strftime("%s")\r\n}\r\n{code}\r\n\r\n{noformat}\r\n$ bundle exec puppet apply warnings.pp --disable_warnings deprecations\r\n/Users/josh/work/puppet/.bundle/ruby/2.4.0/gems/CFPropertyList-2.2.8/lib/cfpropertylist/rbCFTypes.rb:24: warning: constant ::Fixnum is deprecated\r\nWarning: The argument signature (String format, [String timezone]) is deprecated for #strfime. See #strftime documentation and Timespan type for more info\r\n   (file & line not available)\r\nNotice: Compiled catalog for chara.corp.puppetlabs.net in environment production in 0.02 seconds\r\nNotice: 1496267306\r\nNotice: /Stage[main]/Main/Notify[1]/message: defined "message" as "1496267306"\r\nNotice: 1496267306\r\nNotice: /Stage[main]/Main/Notify[2]/message: defined "message" as "1496267306"\r\nNotice: 1496267306\r\n{noformat}\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7611', 'https://github.com/puppetlabs/puppet/pull/5959', '2017-05-31T14:52:13.000-0700', '2017-06-28T12:20:40.000-0700', '2017-06-28T12:20:40.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 3, 32, 25, 16, 'e85e65b0f5c451abeebcd0734b6a9ecde2e2495a', 'https://tickets.puppetlabs.com/browse/PUP-7611', 'https://github.com/puppetlabs/puppet/pull/5959'),
('puppet', 183104, 114896440, 5788, 'handle trailing slashes in references between file resources', 'This change:\r\nhttps://github.com/puppetlabs/puppet/commit/3577fc913373f05b6c58fd7389e097ba7271c147/lib/puppet/parser/compiler/catalog_validator/relationship_validator.rb#diff-0\r\n\r\nchanged the legal relationships between file resources with trailing slashes. Specifically, this manifest\r\n\r\n{code}\r\nfile {"/home/wyatt/foo":\r\n  ensure => directory,\r\n  require => File["/home/wyatt/foo/"],\r\n}\r\n{code}\r\n\r\nwill compile on Puppet < 5, and store a catalog in PuppetDB, while presenting an error to the user about a circular dependency. On Puppet 5, the same catalog will fail compilation because it is considering the path with the trailing slash to be different than the one in the resource title, meaning the referenced resource is considered missing. Consequently, the catalog is not stored in PuppetDB.\r\n\r\nThis issue was caught by the PuppetDB spec tests around this case here:\r\nhttps://github.com/puppetlabs/puppetdb/blob/master/puppet/spec/unit/indirector/catalog/puppetdb_spec.rb#L623\r\n\r\nAfter talking it over with [~henrik.lindberg], we determined that the tests should probably be ported to Puppet and that Puppet compilation needs to handle the trailing slash in a backwards compatible way.', 'https://tickets.puppetlabs.com/browse/PUP-7402', 'https://github.com/puppetlabs/puppet/pull/5788', '2017-03-28T14:51:39.000-0700', '2017-06-28T12:20:41.000-0700', '2017-06-28T12:20:41.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 1, 3, 15, 1, '65c7b25dd0ff83cf0c65ea778855cbaaf2c66fb6', 'https://tickets.puppetlabs.com/browse/PUP-7402', 'https://github.com/puppetlabs/puppet/pull/5788'),
('puppet', 187930, 121475959, 5892, 'misleading error message with classname errors ', '{code}\r\n$ bundle exec puppet --version\r\n4.10.0\r\n$ bundle exec puppet apply -e "class "foo" {}" --trace\r\nError: Could not parse for environment production: "class" is not a valid classname at line 1:1 on node davids\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/pops/parser/parser_support.rb:73:in `error"\r\negrammar.ra:659:in `_reduce_190"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/pops/parser/lexer2.rb:712:in `scan"\r\n/usr/lib/ruby/2.3.0/racc/parser.rb:320:in `_racc_yyparse_c"\r\n/usr/lib/ruby/2.3.0/racc/parser.rb:320:in `yyparse"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/pops/parser/parser_support.rb:240:in `_parse"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/pops/parser/parser_support.rb:134:in `parse_string"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/pops/parser/evaluating_parser.rb:28:in `parse_string"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/parser/e4_parser_adapter.rb:29:in `parse"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/node/environment.rb:507:in `perform_initial_import"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/node/environment.rb:247:in `known_resource_types"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/parser/compiler.rb:766:in `block in initvars"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/context.rb:65:in `override"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet.rb:294:in `override"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/parser/compiler.rb:764:in `initvars"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/parser/compiler.rb:422:in `initialize"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/parser/compiler.rb:33:in `new"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/parser/compiler.rb:33:in `compile"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/indirector/catalog/compiler.rb:266:in `block (2 levels) in compile"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/util/profiler.rb:51:in `profile"\r\n/home/david/gems/ruby/2.3.0/gems/puppet-4.10.0/lib/puppet/indirector/catalog/compiler.rb:264:in `block in compile"\r\n[...]\r\n$ bundle exec puppet apply -e "class foo {}"\r\nNotice: Compiled catalog for davids in environment production in 0.06 seconds\r\nNotice: Applied catalog in 0.03 seconds\r\n$ \r\n{code}\r\n\r\nPutting a String, instead of a Classname into the manifest produces the misleading error message " "class" is not a valid classname". Emitting " "foo" is a String, not a class name", would be much more informative, and help the user to figure out what"s going wrong.\r\n\r\nInterestingly, a {{define}} with the same mistake, will complain "Syntax error at "foo"  at line 1:8 on node davids", which is much more useful.', 'https://tickets.puppetlabs.com/browse/PUP-7471', 'https://github.com/puppetlabs/puppet/pull/5892', '2017-04-26T07:06:36.000-0700', '2017-06-28T12:20:41.000-0700', '2017-06-28T12:20:41.000-0700', 'Closed', '', 4, '0', 2, 975, 964, 3, 'a8691fb6f05606013690b61637ea89dba8774c53', 'https://tickets.puppetlabs.com/browse/PUP-7471', 'https://github.com/puppetlabs/puppet/pull/5892'),
('puppet', 192509, 121971319, 5900, 'TypeCalculator#infer should consider Hash and Array subclasses to be Runtime types.', 'The {{TypeCalcuclator}}, when inferring the type of an arbitrary value, will traverse the class inheritance chain when resolving types. The traversal stops when a class is recognized and when all else fails (and class {{Object}} is reached), the type is considered to be a {{Runtime}} type.\r\n\r\nThis works for most cases, but if someone would derive from a known class, such as {{Hash}} or {{Array}}, then the type of such instances will be inferred to {{Hash}} or {{Array}}, which is wrong. Since they are unkown classes, the inferred type must be {{Runtime}}.', 'https://tickets.puppetlabs.com/browse/PUP-7587', 'https://github.com/puppetlabs/puppet/pull/5900', '2017-05-22T23:26:39.000-0700', '2017-06-28T12:20:41.000-0700', '2017-06-28T12:20:41.000-0700', 'Closed', 'resolved-issue-added', 0, '0', 4, 264, 54, 6, '4252ace720287340d764e235dec0bcd815599a1a', 'https://tickets.puppetlabs.com/browse/PUP-7587', 'https://github.com/puppetlabs/puppet/pull/5900'),
('puppet', 194662, 124796695, 5965, ' puppet-master logcheck rule needs adjustment', 'Hi together, \r\n\r\nit seems the problem described in https://projects.puppetlabs.com/issues/5405 , which sadly has been closed without any change to the sources, is still valid for 4.10.1. \r\n\r\nIn short, ext/logcheck/puppet should be changed like: \r\n{noformat}\r\n-^\w{3} [ :0-9]{11} [._[:alnum:]-]+ puppet-master\[[0-9]+\]: Compiled catalog for [._[:alnum:]-]+ in [.0-9]+ seconds$\r\n+^\w{3} [ :0-9]{11} [._[:alnum:]-]+ puppet-master\[[0-9]+\]: Compiled catalog for [._[:alnum:]-]+ in environment [._[:alnum:]-]+ in [.[:digit:]]+ seconds$\r\n{noformat}\r\nDebian downstream is still patching the package accordingly. Sadly, this patch did not make it upstream (i.e. "here"). \r\n\r\nCheers, Oliver', 'https://tickets.puppetlabs.com/browse/PUP-7625', 'https://github.com/puppetlabs/puppet/pull/5965', '2017-06-06T08:03:41.000-0700', '2017-06-28T12:20:41.000-0700', '2017-06-28T12:20:41.000-0700', 'Closed', 'resolved-issue-added', 4, '0', 1, 1, 1, 1, 'e34bfdcb1913ee1a8da8477b1037520a710d2868', 'https://tickets.puppetlabs.com/browse/PUP-7625', 'https://github.com/puppetlabs/puppet/pull/5965'),
('puppet', 194579, 124239728, 5949, 'Resource defaults and resource overrides can lead to incorrect parameter conflicts', 'The error message is:\r\n\r\n{noformat}\r\nError: Parameter "require" is already set on Package[pip] by #<Puppet::Resource::Type:0x005570c96bc260> at /home/branan/.puppetlabs/etc/code/environments/production/modules/foo/manifests/init.pp:4; cannot redefine at /home/branan/.puppetlabs/etc/code/environments/production/site.pp:1 on node rycon.delivery.puppetlabs.net\r\n{noformat}\r\n\r\nThis was discovered while Ops was trying to upgrade to a pre-release hoyt build.\r\n\r\nSee the attached tarball for a minimal reproduction. This is an environment that can be untarred into a code dir and verified with {{puppet apply --debug --noop $CODEDIR/environments/repro/site.pp}}. The error only occurs when the resource override is in place. If the overridden parameters are inlined into the resource declaration, it works as expected.\r\n\r\nThis was apparently introduced as part of PUP-7484, and is in general related to the PUP-25 work.\r\n\r\nAccording to a bisect, the breaking commit is 38413cd78c61fe34d2ee343ef773a07b4786f65a', 'https://tickets.puppetlabs.com/browse/PUP-7623', 'https://github.com/puppetlabs/puppet/pull/5949', '2017-06-05T15:02:19.000-0700', '2017-06-28T12:20:42.000-0700', '2017-06-28T12:20:42.000-0700', 'Closed', '', 9, '0', 2, 28, 0, 2, 'fcade1ac5ecf4f3b165ae4ae3ba0b3cf5aa77f72', 'https://tickets.puppetlabs.com/browse/PUP-7623', 'https://github.com/puppetlabs/puppet/pull/5949'),
('puppet', 191975, 121418201, 5890, 'Minor error in arity error in face_base.rb', 'The exception raised when the wrong number of arguments is supplied to a face command has an incorrect externalization that references an undefined variable, s.', 'https://tickets.puppetlabs.com/browse/PUP-7576', 'https://github.com/puppetlabs/puppet/pull/5890', '2017-05-18T20:18:32.000-0700', '2017-06-28T12:20:42.000-0700', '2017-06-28T12:20:42.000-0700', 'Closed', '', 0, '0', 1, 1, 1, 1, '824f23fa15a112666379db09ed327a295e7b240e', 'https://tickets.puppetlabs.com/browse/PUP-7576', 'https://github.com/puppetlabs/puppet/pull/5890'),
('puppet', 192126, 127306408, 6016, 'Tags do not support UTF-8 characters', 'The Regex for tag validation (at https://github.com/puppetlabs/puppet/blob/master/lib/puppet/util/tagging.rb#L4) is strictly ASCII:\r\n\r\n{code}\r\nValidTagRegex = /\A[0-9A-Za-z_][0-9A-Za-z_:.-]*\Z/\r\n{code}\r\n\r\nThis prevents the usage of tags in the following case:\r\n\r\n{code}\r\npuppet apply -e "notify { "hi": tag => "_メインディレクトリ_醸造所" }"\r\n{code}\r\n\r\nWith a stack like:\r\n\r\n{noformat}\r\nError: Invalid tag "_メインディレクトリ_醸造所" at /root/foo.pp:1 on node h3a12zjzc6608rh.delivery.puppetlabs.net\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/errors.rb:106:in `fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/tagging.rb:27:in `block in tag"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/tagging.rb:13:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/tagging.rb:13:in `tag"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:185:in `set_parameter"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:385:in `block in extract_parameters"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:381:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:381:in `extract_parameters"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource.rb:368:in `initialize"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:130:in `initialize"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:38:in `new"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:38:in `block in create_resources"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:37:in `map"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_resource_support.rb:37:in `create_resources"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/runtime3_support.rb:321:in `create_resources"\r\n\r\n▽\r\nrequire "puppet/util/tag_set"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:842:in `block in eval_ResourceExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:839:in `map"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:839:in `eval_ResourceExpression"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:48:in `block in visit_this"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `visit_this"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:71:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/root/foo.pp:in `stack"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:30:in `eval"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/puppet_stack.rb:30:in `stack"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:715:in `eval_Program"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:48:in `block in visit_this"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `each"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:42:in `visit_this"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/visitor.rb:71:in `visit_this_1"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/evaluator/evaluator_impl.rb:82:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/pops/parser/evaluating_parser.rb:63:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast/pops_bridge.rb:132:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/ast.rb:31:in `safeevaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/type.rb:184:in `evaluate_code"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:81:in `block in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/resource.rb:73:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:635:in `evaluate_main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:174:in `block (2 levels) in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:174:in `block in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:294:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:162:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/parser/compiler.rb:33:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:268:in `block (2 levels) in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler/around_profiler.rb:58:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/profiler.rb:51:in `profile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:266:in `block in compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:224:in `block in benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:264:in `compile"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/catalog/compiler.rb:55:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/indirector/indirection.rb:194:in `find"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:256:in `block in main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:294:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:225:in `main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:170:in `run_command"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:358:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:542:in `exit_on_fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:358:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:132:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>"\r\n{noformat}\r\n\r\n\r\nA more lenient and Unicode friendly approach is to use the Unicode friendly word regex like:\r\n\r\n{code}\r\nValidTagRegex = /\A[[:word:]][[[:word:]]:.-]*\Z/\r\n{code}\r\n\r\nThis appears necessary to fix the concat module issue reported at MODULES-4684\r\n\r\nThe open question around this is whether or not tags are restricted in this fashion due to some important underlying reason.\r\n\r\n[~thomas.hallgren] spent some time optimizing regular expressions for tags in https://github.com/puppetlabs/puppet/commit/0badfce72bafc767bf3099718c63324f51108996 and the original check (based on words) goes back 10 years to https://github.com/puppetlabs/puppet/commit/f98be4a7198326b26f1072c401b3e337f340db40#diff-ac9d5450f67274b038705194387c3907R31', 'https://tickets.puppetlabs.com/browse/PUP-7579', 'https://github.com/puppetlabs/puppet/pull/6016', '2017-05-19T15:55:27.000-0700', '2017-06-28T12:20:42.000-0700', '2017-06-28T12:20:42.000-0700', 'Closed', 'resolved-issue-added', 8, '0', 1, 2, 2, 1, '42845b7b8815d0becb84298032b6fa36ef33bfa5', 'https://tickets.puppetlabs.com/browse/PUP-7579', 'https://github.com/puppetlabs/puppet/pull/6016'),
('puppet', 188356, 118193408, 5833, 'gettext-setup isn"t stubbed enough', 'In PUP-7116, the gettext-setup is made optional by trapping a failed {{require "gettext-setup"}} and stubbing the {{\_()}} method. That is however not enough since the method {{n\_()}} is referenced in several places in the code-base.', 'https://tickets.puppetlabs.com/browse/PUP-7480', 'https://github.com/puppetlabs/puppet/pull/5833', '2017-04-27T22:57:47.000-0700', '2017-06-28T12:20:43.000-0700', '2017-06-28T12:20:43.000-0700', 'Closed', '', 2, '0', 2, 9, 1, 2, '901f4dd606a66ce0eb11cb9043abd7c0d0a8012c', 'https://tickets.puppetlabs.com/browse/PUP-7480', 'https://github.com/puppetlabs/puppet/pull/5833'),
('puppet', 184817, 0, 0, 'Make `pkgng` default package provider for dragonfly bsd', 'Since version 3.4 (2013) Dragonfly BSD has shipped with pkgng as its default packaging system. Puppet currently has it as `pkgin`. \r\n\r\nUpdate default provider in Puppet to reflect the correct packaging system.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7437', '', '2017-04-07T09:19:15.000-0700', '2017-06-28T12:20:43.000-0700', '2017-06-28T12:20:43.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 0, 0, 0, 0, '12c2c0c848d1e70f790fd9cd8de14100a49c0a55', 'https://tickets.puppetlabs.com/browse/PUP-7437', 'https://github.com/puppetlabs/puppet/commit/12c2c0c848d1e70f790fd9cd8de14100a49c0a55'),
('puppet', 187960, 117750204, 5826, 'remove dead code in Puppet::Type::instances', 'This block in Puppet::Type: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/type.rb#L1163-L1168 iterates over all of the properties of the type, checks if the given provider supports the property, and returns an array of all the supported property names.\r\n\r\nExcept we don"t do anything with the result.\r\n\r\nBefore commit http://github.com/puppetlabs/puppet/commit/53241a91, which was a maint commit to remove superfluous variables we never used, the result of this block was assigned to the variable `all_properties` - which was never used. The commit removed the variable, but not the associated block.\r\n\r\nI believe the intention was to filter out properties that weren"t supported by the provider before we called `newattr` on them, except `newattr` https://github.com/puppetlabs/puppet/blob/master/lib/puppet/type.rb#L769-L773 already does this filtering, and provides helpful debug output that a provider doesn"t support a property so we"re not managing it.\r\n\r\nThe block can be removed.', 'https://tickets.puppetlabs.com/browse/PUP-7473', 'https://github.com/puppetlabs/puppet/pull/5826', '2017-04-26T08:51:42.000-0700', '2017-06-28T12:20:44.000-0700', '2017-06-28T12:20:44.000-0700', 'Closed', '', 4, '0', 1, 0, 6, 1, '5620b138338b7caa879a23c61022d34608e7162c', 'https://tickets.puppetlabs.com/browse/PUP-7473', 'https://github.com/puppetlabs/puppet/pull/5826'),
('puppet', 195205, 124873307, 5966, 'A Report containing rich-data should allow presence of unresolved custom types.', 'When an agent that deals with custom rich-data types (Objects) sends a report to the server, the server will not have a correct environment/loaders configured to instantiate the values that are contained in the report events. It currently does, which results in an error.\r\n\r\nThe desired behavior is to retain the hash that is the result of serializing such objects.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7642', 'https://github.com/puppetlabs/puppet/pull/5966', '2017-06-09T06:49:27.000-0700', '2017-06-28T12:20:44.000-0700', '2017-06-28T12:20:44.000-0700', 'Closed', '', 1, '0', 3, 76, 10, 4, 'df436038b373dd6e3cc25410dc40ddfd7eb5035c', 'https://tickets.puppetlabs.com/browse/PUP-7642', 'https://github.com/puppetlabs/puppet/pull/5966'),
('puppet', 191351, 124026940, 5948, 'Update default fileserver.conf that allow/deny are no longer allowed', 'We are removing allow/deny directives from fileserver.conf. See PUP-6359. This ticket is about updating the {{Permissions}} section in the default fileserver.conf to explain that {{allow}} and {{deny}} directives should be set in the ruby {{auth.conf}} if using legacy auth.conf, or in trapperkeeper"s tk-auth.', 'https://tickets.puppetlabs.com/browse/PUP-7555', 'https://github.com/puppetlabs/puppet/pull/5948', '2017-05-16T15:31:01.000-0700', '2017-06-28T12:20:44.000-0700', '2017-06-28T12:20:44.000-0700', 'Closed', '', 1, '0', 3, 28, 12, 2, '7e7947606aa90ced305f9704c27f5aceadb0f936', 'https://tickets.puppetlabs.com/browse/PUP-7555', 'https://github.com/puppetlabs/puppet/pull/5948'),
('puppet', 188685, 122734724, 5923, 'Default to JSON when sending facts and reports', 'In PUP-7259, we modified the agent to requests catalogs and file_metadata from the server in one of the agent"s supported formats, i.e. {{Accept: application/json, pson, etc}}. The server will select the first format from the list that it also supports.\r\n\r\nHowever, puppet still sends facts and reports in PSON. \r\n\r\nPUP-7259 enabled the server to start accepting reports in JSON and has already been resolved.\r\n\r\nPUP-7257 will enable the server to start accepting facts in JSON. Once that lands --and is promoted into puppetserver--, we can modify the agent to start sending facts and reports as JSON (this ticket).', 'https://tickets.puppetlabs.com/browse/PUP-7487', 'https://github.com/puppetlabs/puppet/pull/5923', '2017-05-01T12:55:26.000-0700', '2017-06-28T12:20:44.000-0700', '2017-06-28T12:20:44.000-0700', 'Closed', '', 4, '0', 2, 65, 46, 9, '049ffbdfcf99d06e3363656ad889188132b5a7a7', 'https://tickets.puppetlabs.com/browse/PUP-7487', 'https://github.com/puppetlabs/puppet/pull/5923'),
('puppet', 195996, 126131224, 5996, 'Puppet 5 fails when facter facts contain ampersands', 'This is related to PUP-7658, except that it applies to when the agent sends the catalog request in JSON, as we do not currently escape the fact values. So the {{&}} is interpreted as a query parameter delimiter instead of a fact value.\r\n\r\nTo repro. Create external facts with the following in either {{/etc/puppetlabs/facter/facts.d}} if running as root, or {{~/.facter/facts.d}}:\r\n\r\n{code:yaml}\r\n---\r\nspace: "foo bar"\r\nplus: "foo+bar"\r\nstar: "foo*bar"\r\nhash: "foo#bar"\r\npercent: "foo%bar"\r\nampersand: "foo & bar"\r\n{code}\r\n\r\nDo an agent run, and it will fail with:\r\n\r\n{noformat}\r\n<- "POST /puppet/v3/catalog/chara.corp.puppetlabs.net?environment=production HTTP/1.1\r\nAccept: application/json, application/x-msgpack, text/pson\r\nX-Puppet-Version: 5.0.0\r\nAccept-Encoding: gzip;q=1.0,deflate;q=0.6,identity;q=0.3\r\nUser-Agent: Puppet/5.0.0 Ruby/2.4.1-p111 (x86_64-darwin15)\r\nHost: chara.corp.puppetlabs.net:8140\r\nContent-Length: 5599\r\nContent-Type: application/x-www-form-urlencoded\r\n\r\n"\r\n<- "environment=production&facts_format=application%2Fjson&facts=%7B%22name%22%3A%22XXX.corp.puppetlabs.net%22%2C%22values%22%3A%7B%22puppetversion%22%3A%225.0.0%22%2C%22architecture%22%3A%22x86_64%22%2C%22kernel%22%3A%22Darwin%22%2C%22space%22%3A%22foo%20bar%22%2C%22plus%22%3A%22foo%2Bbar%22%2C%22star%22%3A%22foo%2Abar%22%2C%22hash%22%3A%22foo%23bar%22%2C%22percent%22%3A%22foo%25bar%22%2C%22ampersand%22%3A%22foo%20&%20bar%22%2C...\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Could not intern from json: 743: unexpected token at "{"name":"chara.corp.puppetlabs.net","values":{"puppetversion":"5.0.0","architecture":"x86_64","kernel":"Darwin","space":"foo bar","plus":"foo+bar","star":"foo*bar","hash":"foo#bar","percent":"foo%bar","ampersand":"foo "\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7665', 'https://github.com/puppetlabs/puppet/pull/5996', '2017-06-14T13:03:11.000-0700', '2017-06-28T12:20:45.000-0700', '2017-06-28T12:20:45.000-0700', 'Closed', '', 6, '0', 1, 65, 75, 4, '422cd5c2757bd78e90dfefa9461373a868ef40e3', 'https://tickets.puppetlabs.com/browse/PUP-7665', 'https://github.com/puppetlabs/puppet/pull/5996'),
('puppet', 181888, 123161035, 5928, 'Consistently use encode_with for YAML serialization', 'Puppet serializes objects to YAML using both {{to_yaml_properties}}:\r\n\r\n{noformat}\r\nlib/puppet/graph/simple_graph.rb\r\nlib/puppet/parser/yaml_trimmer.rb\r\nlib/puppet/resource/status.rb\r\nlib/puppet/resource.rb\r\nlib/puppet/transaction/event.rb\r\nlib/puppet/transaction/report.rb\r\n{noformat}\r\n\r\nand {{encode_with}} (provided by PsychSupport):\r\n\r\n{noformat}\r\nlib/puppet/indirector/request.rb\r\nlib/puppet/node/facts.rb\r\nlib/puppet/node.rb\r\nlib/puppet/resource/status.rb\r\nlib/puppet/util/log.rb\r\n{noformat}\r\n\r\nThis is bad for a few reasons:\r\n\r\n1. Relying on {{YAML#to_yaml_properties}} has been deprecated since ruby 1.9.3\r\n2. Note that {{Puppet::Resource::Status}} defines both {{to_yaml_properties}} and uses {{encode_with}}. As a result the serialization behavior depends on the ruby version and YAML engines (Syck vs Psych) and the 2 serialization methods could serialize different instance variables.\r\n3. Ruby 2.1 changed how Array subclasses are serialized, and Ruby 2.3 does the same for \r\nHash subclasses. Note the {{ivars}} and the {{hash-with-ivars}} tag:\r\n\r\n{code:yaml}\r\n--- !ruby/array:MyArrayObject\r\ninternal:\r\n- 1\r\nivars:\r\n  :@foo: 2\r\n{code}\r\n\r\n{code:yaml}\r\n--- !ruby/hash-with-ivars:MyHashObject\r\nelements:\r\n  1: 2\r\nivars:\r\n  :@bar: 3\r\n{code}\r\n\r\nThis means YAML data written by an agent running ruby 2.3 may not be readable by puppetserver using JRuby 1.7 (which is compatible with MRI ruby 1.9.3).\r\n\r\nPuppet should consistently use {{PsychSupport}} and its {{encode_with}} methods. Similarly, we should be using {{init_with}} and leveraging the {{from_data_hash}} methods to deserialize instances. This ensures that objects explicitly state which data to serialize, and ensures that object initializers and setters are called during deserialization, instead of using bypassing that with {{instance_variable_set}}.\r\n\r\nSee discussion in https://github.com/puppetlabs/puppet/pull/4214#issuecomment-138691121\r\n\r\n/cc [~henrik.lindberg], [~geoff.nichols], [~ethan]', 'https://tickets.puppetlabs.com/browse/PUP-7381', 'https://github.com/puppetlabs/puppet/pull/5928', '2017-03-21T22:20:25.000-0700', '2017-06-28T12:21:34.000-0700', '2017-06-28T12:21:34.000-0700', 'Closed', 'resolved-issue-added', 16, '0', 3, 73, 93, 3, 'f2d097b0c98a3f3e120df9f71c4ced9657ca9010', 'https://tickets.puppetlabs.com/browse/PUP-7381', 'https://github.com/puppetlabs/puppet/pull/5928'),
('puppet', 172628, 105033314, 5619, 'Make autoloader recognize types declared in TypeSets.', 'A Pcore {{TypeSet}} can, as it name suggests, declare a set of types. All types in such a set have names that are prefixed with the name of the {{TypeSet}}. At present, the auto-loader will find a {{TypeSet}} by name (since it"s a type in its own right), but it will not find the types that it declare.\r\n\r\nA {{TypeSet}} should be able to declare types that live in the module namespace, i.e. where the name of the {{TypeSet}} is actually the name of the module. Example:\r\n{code:puppet}\r\ntype Mod = TypeSet[{\r\n  pcore_version => "1.0.0",\r\n  version => "1.0.0",\r\n  types => { Xyz => String[1] }\r\n}]\r\n{code}\r\ndefines the type {{Mod::Xyz}} (when found in module "mod").\r\n\r\nQuestions that need answers are:\r\n1. Where would the _.pp_ file containing this {{TypeSet}} reside and what should it be named?\r\n2. Can the _version_ in such a {{TypeSet}} be optional (given that what it declares is in the module root)?\r\n3. Is the module root {{TypeSet}} mutually exclusive to other types declared under the _types_ directory?\r\n4. Should it be possible for a module to declare several typesets? If so, how do we differ the "root" set that uses the module name as it"s name, from other sets? Can we simply decide that the set using that name automatically gets propagated and thereby forbid namespaces that start with the module name twice, i.e. Mod::Mod::Xyz?\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7142', 'https://github.com/puppetlabs/puppet/pull/5619', '2017-01-30T07:05:49.000-0800', '2017-06-28T12:21:34.000-0700', '2017-06-28T12:21:34.000-0700', 'Closed', '', 2, '0', 1, 141, 20, 5, 'b97885219da347fab11c6a3e3c104e8d4db4950f', 'https://tickets.puppetlabs.com/browse/PUP-7142', 'https://github.com/puppetlabs/puppet/pull/5619'),
('puppet', 169082, 102349439, 5513, 'Comparisons between SELinux file categories should always translate to the numeric version', 'SELinux file contexts have a category that is assigned to every file on the system.\r\n\r\nIf the system is using {{mcstransd}} (which most higher security systems will be for user convenience) changes to the system at runtime can cause issues with category translation until {{mcstransd}} is restarted.\r\n\r\nThese conditions cannot be clearly enumerated and may happen at any time. When this occurs, Puppet will try to reset the context on *every* managed file as well as triggering service restarts based on those files.\r\n\r\nThis can cause your systems to restart *every* service each time Puppet runs.\r\n\r\nPuppet should, instead, use the output of {{chcat -L}} to obtain the list of mappings from the system and translate any categories on files back to their numeric form in all cases.\r\n\r\nTo do this, simply discard any right hand side values that contain a hyphen ({{-}}) and then use the left hand corresponding value for all context comparisons.\r\n\r\nSetting a context via either method is equivalent so that code should not need to change.', 'https://tickets.puppetlabs.com/browse/PUP-7073', 'https://github.com/puppetlabs/puppet/pull/5513', '2017-01-06T11:20:39.000-0800', '2017-06-28T12:21:34.000-0700', '2017-06-28T12:21:34.000-0700', 'Closed', 'resolved-issue-added;selinux', 10, '0', 2, 70, 9, 3, '51636c065e0625b32af2cd98f2060eb7428704f5', 'https://tickets.puppetlabs.com/browse/PUP-7073', 'https://github.com/puppetlabs/puppet/pull/5513'),
('puppet', 179422, 109965623, 5701, '"puppet describe" garbles description when there a long lines with no spaces.', 'When a description of a Puppet type, <type>, has long lines with no\r\nspaces, the output from "puppet describe <type>" is garbled.  The\r\ncause of this is an error in a regular expression in\r\nlib/puppet/application/describe.rb.', 'https://tickets.puppetlabs.com/browse/PUP-7329', 'https://github.com/puppetlabs/puppet/pull/5701', '2017-03-09T08:59:22.000-0800', '2017-06-28T12:21:36.000-0700', '2017-06-28T12:21:36.000-0700', 'Closed', 'resolved-issue-added', 1, '0', 1, 20, 1, 2, '23f033aa2451d4a2edf0fb3a0dd3a37d8f83b6df', 'https://tickets.puppetlabs.com/browse/PUP-7329', 'https://github.com/puppetlabs/puppet/pull/5701'),
('puppet', 171875, 107300290, 5653, 'Fix problems with Puppet running on Ruby 2.4', 'Ruby 2.4 introduces a couple of subtle differences that breaks puppet.\r\n\r\n1. It [unifies the Fixnum and Bignum into Integer|http://blog.bigbinary.com/2016/11/18/ruby-2-4-unifies-fixnum-and-bignum-into-integer.html]. This causes problems in several places.\r\n\r\n2. Prior to 2.4.0, the following code would raise an exception "couldn"t find HOME" but in 2.4.0, the resolution works even when HOME is nil.\r\n{code:ruby}\r\nENV["HOME"] = nil\r\npath = File.expand_path("~/tmp")\r\n{code}\r\n\r\n3. The handling of DateTime.to_time has changed. Prior to 2.4:\r\n{code:puppet}\r\nx = DateTime.httpdate("Sat, 03 Feb 2001 04:05:06 GMT").to_time.to_s\r\n{code}\r\nwould produce a local time such as "2001-02-03 05:05:06 +0100". In 2.4.0, it retains its timezone and produces "2001-02-03 04:05:06 +0000".\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7130', 'https://github.com/puppetlabs/puppet/pull/5653', '2017-01-25T07:35:34.000-0800', '2017-06-28T12:21:36.000-0700', '2017-06-28T12:21:36.000-0700', 'Closed', 'resolved-issue-added', 2, '0', 3, 72, 50, 27, '7619782821b82cb1c5bcea0bbec035d96b3233b5', 'https://tickets.puppetlabs.com/browse/PUP-7130', 'https://github.com/puppetlabs/puppet/pull/5653'),
('puppet', 181889, 124342877, 5951, 'Ensure current values are YAML serializable', 'As described in MODULES-4275, a provider may return arbitrary objects as the {{current}} value. This value is written (as YAML) in the corrective change file and in the report (if there is a change). The assumption has always been that the {{current}} value is primitive (string, integer, etc), but the ACL module returns Hash subclasses. Since we rely on {{to_yaml_properties}} for report serialization (see PUP-7381), Ruby 2.3 will serialize instance variables of our subclasses, which causes puppet to try to serialize the provider instance. This wasn"t a problem previously, because Ruby 2.2 and below just serialize the hash key/value pairs. (The commit changing the Ruby behavior is https://github.com/ruby/ruby/commit/fe0414b5473b5332706126d2a017a9bf235c8146#diff-aed2624c7e8f254dd7356f2a32d8358fR471)\r\n\r\nPuppet needs to be more defensive about how {{current}} values are handled. Presumably this could be done by always writing out the {{to_s}} version of the object.\r\n\r\n/cc [~geoff.nichols], [~ethan], [~henrik.lindberg]', 'https://tickets.puppetlabs.com/browse/PUP-7382', 'https://github.com/puppetlabs/puppet/pull/5951', '2017-03-21T22:30:09.000-0700', '2017-06-28T12:21:37.000-0700', '2017-06-28T12:21:37.000-0700', 'Closed', 'resolved-issue-added', 13, '0', 1, 98, 5, 4, '17e7614ca7503d1f2c877aaa3f46d42edacd9994', 'https://tickets.puppetlabs.com/browse/PUP-7382', 'https://github.com/puppetlabs/puppet/pull/5951'),
('puppet', 173267, 122726872, 5922, 'PCore resource output improperly quoted', 'When using [~thomas.hallgren] rich-data-wip [branch|https://github.com/thallgren/puppet/tree/rich-data-wip] PCore resources are output with incorrect top level quoting:\r\n\r\n{noformat}\r\n$ puppet resource xe_ietf_ospf\r\nxe_ietf_ospf { "100":\r\n  routing_instance => "Vanilla_ice::Ospf::Routing_instance({ #<-This value should not be quoted\r\n  "name" => "default",\r\n  "description" => "default-vrf [read-only]",\r\n  "routing_protocols" => Vanilla_ice::Ospf::Routing_protocols({\r\n...\r\n{noformat}\r\n\r\n[~thomas.hallgren]"s best guess is "Resource #to_s just quotes everything that it doesn"t recognize in single qoutes"\r\n\r\nThis prevents users from directly copying the output of a PCore resource into a manifest.', 'https://tickets.puppetlabs.com/browse/PUP-7155', 'https://github.com/puppetlabs/puppet/pull/5922', '2017-02-01T09:36:53.000-0800', '2017-06-28T12:21:38.000-0700', '2017-06-28T12:21:38.000-0700', 'Closed', 'resolved-issue-added', 21, '0', 1, 3, 3, 2, '1a560a17e6fe0ab9e8779dce7e659082d0e04f42', 'https://tickets.puppetlabs.com/browse/PUP-7155', 'https://github.com/puppetlabs/puppet/pull/5922'),
('puppet', 172151, 123343311, 5932, 'Remove always_cache_features setting', 'The setting has been deprecated for awhile (in favor of {{always_retry_plugins}}). See also PUP-6947', 'https://tickets.puppetlabs.com/browse/PUP-7133', 'https://github.com/puppetlabs/puppet/pull/5932', '2017-01-25T15:16:52.000-0800', '2017-06-28T12:21:39.000-0700', '2017-06-28T12:21:39.000-0700', 'Closed', '', 4, '0', 1, 3, 34, 4, 'cb2205b5d47cba6bb5f271d5befbd2983e9541bc', 'https://tickets.puppetlabs.com/browse/PUP-7133', 'https://github.com/puppetlabs/puppet/pull/5932'),
('puppet', 136182, 124736906, 5962, 'file type documentation does not have quotes around modes in doc comments', 'The file resource type has several mentions of various modes without showing them as quoted strings. This is a source of confusion/error for users who take the information literally.\r\n\r\nThis needs to be fixed in the file resource type source code. The end result is shown here: https://docs.puppet.com/puppet/latest/reference/type.html#file', 'https://tickets.puppetlabs.com/browse/PUP-6395', 'https://github.com/puppetlabs/puppet/pull/5962', '2016-06-08T15:23:21.000-0700', '2017-06-28T12:22:31.000-0700', '2017-06-28T12:22:31.000-0700', 'Closed', 'DOCS', 4, '0', 1, 6, 6, 3, 'd72ea3d1954aac196fcc17f4f709e4dd83655714', 'https://tickets.puppetlabs.com/browse/PUP-6395', 'https://github.com/puppetlabs/puppet/pull/5962'),
('puppet', 127141, 80307027, 5178, 'Application declarations don"t properly validate component mappings', 'This ticket captures a set of bugs in component mapping for application declarations.\r\n\r\n1) Non-existent components are ignored when compiling environment catalog or agent catalog\r\n\r\n{code}\r\nsite {\r\n  my_app { "foo":\r\n    nodes => {\r\n      Node["node.example.com"] => [ Imaginary[component] ],\r\n    }\r\n  }\r\n}\r\n{code}\r\n\r\nThis will compile without issue, even if my_app doesn"t declare such a component. Indeed, even if the component type doesn"t exist.\r\n\r\n2) Missing {{nodes}} param causes an exception when compiling environment catalog, is ignored when compiling agent catalog\r\n\r\n3) Nodes not mapped to any component are ignored when compiling environment catalog or agent catalog\r\n\r\n{code}\r\nsite {\r\n  my_app { "foo":\r\n    nodes => {\r\n      Node["node.example.com"] => [ ],\r\n    }\r\n  }\r\n}\r\n{code}\r\n\r\nThe node mentioned here is completely irrelevant to the application, but is just ignored rather than causing an error or warning. There may be a use case for this behavior with components that are being dynamically generated/mapped.', 'https://tickets.puppetlabs.com/browse/PUP-6182', 'https://github.com/puppetlabs/puppet/pull/5178', '2016-04-18T14:50:46.000-0700', '2017-06-28T12:22:31.000-0700', '2017-06-28T12:22:31.000-0700', 'Closed', 'resolved-issue-added', 4, '0', 2, 161, 16, 3, '0d85f51a39f02a0d426fe236decc42b9486d2b0b', 'https://tickets.puppetlabs.com/browse/PUP-6182', 'https://github.com/puppetlabs/puppet/pull/5178'),
('puppet', 111456, 58085139, 4620, 'Puppet master does not fail catalog on unexisting resource in resource parameter', 'The behavior of Resources in require => parameter and in relations is different.\r\n\r\nWhen compiling the catalog of the two following nodes, the first one fails on the _client_ side, and the second one on the _server_ side. This is very annoying because you think that the catalog can be applied successfully (e.g if you test using puppet master compile).\r\n\r\n\r\n{code:puppet}\r\nnode missing1 {\r\n  notify {"a":\r\n    require => Notify["b"],\r\n  }\r\n}\r\n\r\nnode missing2 {\r\n  notify {"a": }\r\n  Notify["b"] -> Notify["a"]\r\n}\r\n{code}\r\n\r\nWhen validation is added it must:\r\n* Allow the value to be a resource reference tree\r\n* Update the language specification and documentation and clearly state that trailing punctuation makes two type references not considered equal. (i.e. File[/tmp/foo/], and File[/tmp//foo]) as this knowledge is implementation specific and may even depend on the provider and underlying target system state). i.e. this will *not* be supported:\r\n{code:puppet}\r\nfile { "/tmp/": } ... notify { "a": require => File["/tmp"] } (note the trailing forward slash).\r\n{code}\r\n* Support Aliases (the relationship operators do not do that correctly).\r\n{code:puppet}\r\nnotify { "a": alias => "b"} ... notify { "c": require => Notify["b"] }\r\n{code}\r\n\r\nNote that this ticket was originally added to Puppet 4.4.0, but was reverted before release in PUP-5850 as that implementation caused too much downstream breakage.', 'https://tickets.puppetlabs.com/browse/PUP-5659', 'https://github.com/puppetlabs/puppet/pull/4620', '2016-01-07T07:15:02.000-0800', '2017-06-28T12:22:32.000-0700', '2017-06-28T12:22:32.000-0700', 'Closed', 'resolved-issue-added', 28, '0', 2, 37, 5, 2, '676f0b7a2d78b2727c991f44e1c23f6df8e5233e', 'https://tickets.puppetlabs.com/browse/PUP-5659', 'https://github.com/puppetlabs/puppet/pull/4620'),
('puppet', 117812, 102146172, 5511, 'Change deprecation from PUP-2695 (merge class) to error', '', 'https://tickets.puppetlabs.com/browse/PUP-5954', 'https://github.com/puppetlabs/puppet/pull/5511', '2016-02-21T16:22:25.000-0800', '2017-06-28T12:22:32.000-0700', '2017-06-28T12:22:32.000-0700', 'Closed', '', 1, '0', 3, 22, 15, 3, '75a81f6cb9e81b4b3094c1e6324c462da6f61f43', 'https://tickets.puppetlabs.com/browse/PUP-5954', 'https://github.com/puppetlabs/puppet/pull/5511'),
('puppet', 72791, 100698401, 5472, 'Update PMT to use only semantic_puppet versions (not SemVer)', 'Currently, PMT uses both the vendored Semantic library and the Puppet::SemVer module to check version numbers for modules. PMT should be only using the vendored Semantic library.', 'https://tickets.puppetlabs.com/browse/PUP-4283', 'https://github.com/puppetlabs/puppet/pull/5472', '2015-03-23T22:40:23.000-0700', '2017-06-28T12:22:32.000-0700', '2017-06-28T12:22:32.000-0700', 'Closed', 'resolved-issue-added', 5, '0', 1, 27, 22, 10, '4d297235bb666dd2770955f1740af0bc91eb4b8d', 'https://tickets.puppetlabs.com/browse/PUP-4283', 'https://github.com/puppetlabs/puppet/pull/5472'),
('puppet', 151093, 117976592, 5829, 'Fix various type system glitches, Puppet Data type should be limited to JSON types.', 'The motivation behind the Data type is that instances of this type can be represented as JSON without conversion. As such, it must only represent the following:\r\n{code}\r\nData\r\n|- Boolean\r\n|- Integer\r\n|- Float\r\n|- String\r\n|- Undef\r\n|- Array[Data]\r\n|- Hash[String,Data]\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6694', 'https://github.com/puppetlabs/puppet/pull/5829', '2016-09-09T05:45:37.000-0700', '2017-06-28T12:22:33.000-0700', '2017-06-28T12:22:33.000-0700', 'Closed', '', 8, '0', 10, 440, 386, 26, 'a48795dadefa67005759b77a107f07e27748077b', 'https://tickets.puppetlabs.com/browse/PUP-6694', 'https://github.com/puppetlabs/puppet/pull/5829'),
('puppet', 49776, 103554040, 5556, 'Cap integer and float sizes', 'The language specification now (PUP-3133) says that Integer and Float are capped to signed 64 bit integer, and 64 bit double precision floats (IEEE 754). This used to be unspecified, and "just work the way Ruby works". There was also a misconception in how Ruby transitions between the available fixed types and Big representations (it simply does not do widening to Big for floating point). The cap is needed because neither serialization formats nor Puppet DB can work efficiently (if at all) with values outside of the now specified range.\r\n\r\nWe should cap the runtime size of Integers (error on under/overflow).\r\n\r\nWe should also update / verify that the type system does not accept Integer values that are BigInteger, and that Float should not accept BigDecimal, except possibly if those data types hold values that fit 64 bit signed and IEEE 754 binary64 respectively and can be transformed to the 64 bit variants.\r\n\r\nThis also means that we should type check attribute and variable assignments since {{Any}} does not mean "any ruby type". This last step may have performance implications.', 'https://tickets.puppetlabs.com/browse/PUP-3170', 'https://github.com/puppetlabs/puppet/pull/5556', '2014-09-02T09:33:47.000-0700', '2017-06-28T12:22:33.000-0700', '2017-06-28T12:22:33.000-0700', 'Closed', 'resolved-issue-added', 16, '0', 8, 141, 4, 9, '112e3b3ac03394258ac0b47d47b7faff5638c2c4', 'https://tickets.puppetlabs.com/browse/PUP-3170', 'https://github.com/puppetlabs/puppet/pull/5556'),
('puppet', 118524, 116478520, 5807, 'Remove IO#binwrite monkey patch', 'Remove IO#binwrite monkey patch. The method has been present since ruby 1.9.3, no need to monkey patch it.', 'https://tickets.puppetlabs.com/browse/PUP-5974', 'https://github.com/puppetlabs/puppet/pull/5807', '2016-02-24T21:08:42.000-0800', '2017-06-28T12:22:33.000-0700', '2017-06-28T12:22:33.000-0700', 'Closed', '', 1, '0', 2, 0, 81, 2, '821aa018df0c3782a8ab086eb2a03951e49300bb', 'https://tickets.puppetlabs.com/browse/PUP-5974', 'https://github.com/puppetlabs/puppet/pull/5807'),
('puppet', 134308, 71783120, 4999, 'Puppet::Transaction#failed? is unused - remove it', 'The one use of Puppet::Transaction#failed? was removed in https://github.com/puppetlabs/puppet/commit/84be695ddee004d7e358d9256f7929e1a2c400a3, so we can now remove the method itself.\r\n\r\nNote that the entire class is marked as {{api private}}.', 'https://tickets.puppetlabs.com/browse/PUP-6372', 'https://github.com/puppetlabs/puppet/pull/4999', '2016-05-27T16:06:02.000-0700', '2017-06-28T12:22:34.000-0700', '2017-06-28T12:22:34.000-0700', 'Closed', '', 2, '0', 1, 0, 4, 1, '85f744c28b766bffdc613713dc886610e1577c60', 'https://tickets.puppetlabs.com/browse/PUP-6372', 'https://github.com/puppetlabs/puppet/pull/4999'),
('puppet', 35214, 122046781, 5902, 'Certname must be lowercase error not helpful', 'Currently if you set a non lowercase certname you get this error:\r\n{code}\r\nError: Could not initialize global default settings: Certificate names must be lower case; see #1168\r\n{code}\r\n\r\nIts not terribly helpful for a couple reasons.\r\n# We"ve moved away from RedMine. Only seasoned puppet veterans will see #1168 and say "oh right, redmine, duh."\r\n# #1168 is an ancient thread that represents a dark time in puppet"s history we"d all rather forget. Who cares about these comments? We need a succinct snippet for why we require lowercase names. Not force new users to read the insane old days. Especially since there really isn"t any resolution on that thread.\r\n\r\nI seem to recall there was a better resource somewhere that had a more definitive explanation. I"ve helped numerous people get past this.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-2551', 'https://github.com/puppetlabs/puppet/pull/5902', '2014-05-12T22:19:38.000-0700', '2017-06-28T12:22:34.000-0700', '2017-06-28T12:22:34.000-0700', 'Closed', 'beginner;help_wanted', 13, '0', 1, 2, 2, 1, '1166adfa1e1fbeaf38a121f42e938961096ed1e8', 'https://tickets.puppetlabs.com/browse/PUP-2551', 'https://github.com/puppetlabs/puppet/pull/5902'),
('puppet', 134008, 123805516, 5940, 'Completely remove allow/deny rules from fileserver.conf syntax', 'fileserver.conf is useful for defining custom mount points, but it predates a unified authorization system in Puppet, so it has its own redundant syntax for access controls. If a request passes auth.conf, fileserver.conf can apply an extra layer of restrictions... but why didn"t you just write those in auth.conf??? Yeah, exactly, you did. \r\n\r\nFurthermore, I believe fileserver.conf"s auth rules use the same code paths as auth.conf (legacy edition), which is slated for demolition in 5.0. (This is the reason IP-based fileserver.conf auth rules broke in 3.0, because we changed the auth.conf code paths to separate them from certname rules.) So it"ll break at the 5.0 boundary anyway, without heroic efforts. \r\n\r\nWe probably should have deleted this feature in 4.0, so let"s kill it now. \r\n\r\nSpecifically, I suggest:\r\n\r\n* Today, start logging warnings if fileserver.conf contains any auth rules other than {{allow \*}}.\r\n* At 5.0, start disregarding all auth rules in fileserver.conf (behaving like every mount point has allow \*), and log warnings if any are present. ', 'https://tickets.puppetlabs.com/browse/PUP-6359', 'https://github.com/puppetlabs/puppet/pull/5940', '2016-05-25T17:01:47.000-0700', '2017-06-28T12:22:34.000-0700', '2017-06-28T12:22:34.000-0700', 'Closed', 'deprecation', 21, '0', 1, 28, 3, 4, '183c661bed1fc53de23fdfe792543bf11b47811d', 'https://tickets.puppetlabs.com/browse/PUP-6359', 'https://github.com/puppetlabs/puppet/pull/5940'),
('puppet', 118523, 106165141, 5642, 'Remove Symbol monkey patch', 'Remove Symbol#<=> monkey patch. See PUP-5968', 'https://tickets.puppetlabs.com/browse/PUP-5973', 'https://github.com/puppetlabs/puppet/pull/5642', '2016-02-24T21:05:47.000-0800', '2017-06-28T12:22:34.000-0700', '2017-06-28T12:22:34.000-0700', 'Closed', 'resolved-issue-added', 6, '0', 2, 0, 78, 2, 'eba2bcdae2200b4ea706cde43e4ff769878dada6', 'https://tickets.puppetlabs.com/browse/PUP-5973', 'https://github.com/puppetlabs/puppet/pull/5642'),
('puppet', 118525, 118912475, 5842, 'Remove Range#intersection monkey patch', 'Range#intersection was monkey patched in b6d052e7 so that semver ranges could be compared for the PMT.... This should be removed and handled in the code that actually cares about comparing semver strings.', 'https://tickets.puppetlabs.com/browse/PUP-5975', 'https://github.com/puppetlabs/puppet/pull/5842', '2016-02-24T21:14:46.000-0800', '2017-06-28T12:22:35.000-0700', '2017-06-28T12:22:35.000-0700', 'Closed', '', 11, '0', 1, 0, 95, 2, 'ce6c2a3cd416e9458e644723b3e11e78cdc9a6d2', 'https://tickets.puppetlabs.com/browse/PUP-5975', 'https://github.com/puppetlabs/puppet/pull/5842'),
('puppet', 146109, 122093001, 5904, 'Update CFPropertyList gem to 2.3.5 and add plain format to puppet/util/plist', 'Puppet currently bundles version 2.2.7 of the CFPropertyList gem.  This works fine, but the newest version 2.3.3 has a couple of bug fixes and also adds support for the rare plain ASCII format.   Having support for this format would be very useful in certain situations, as Xcode and System Profiler still use it.\r\n\r\nWe"ve also recently discovered a serious bug in string handling, see PUP-6696.', 'https://tickets.puppetlabs.com/browse/PUP-6596', 'https://github.com/puppetlabs/puppet/pull/5904', '2016-08-09T15:10:05.000-0700', '2017-06-28T12:22:35.000-0700', '2017-06-28T12:22:35.000-0700', 'Closed', 'resolved-issue-added', 5, '0', 1, 4, 2, 3, '7365e60e77e33742ee2504b88a9e7caea373d9d6', 'https://tickets.puppetlabs.com/browse/PUP-6596', 'https://github.com/puppetlabs/puppet/pull/5904'),
('puppet', 144200, 120927242, 5875, 'Face based application help should say (c) Puppet Inc. not Puppet Labs.', 'There is a spec test that asserts that all help texts have "(c) Puppet Labs" when it should be "(c) Puppet Inc.". The test was updated in the PR for PUP-5948 to allow both. All faces should be updated and the test changed.', 'https://tickets.puppetlabs.com/browse/PUP-6566', 'https://github.com/puppetlabs/puppet/pull/5875', '2016-07-31T11:50:01.000-0700', '2017-06-28T12:22:35.000-0700', '2017-06-28T12:22:35.000-0700', 'Closed', '', 0, '0', 1, 42, 42, 37, 'f4a016e5602249e9ffe78fc9d1cbd75edb7c7cfd', 'https://tickets.puppetlabs.com/browse/PUP-6566', 'https://github.com/puppetlabs/puppet/pull/5875'),
('puppet', 149339, 119992014, 5853, 'cached catalogs setting not respected when --test is specified', 'h1. Description\r\n\r\nDuring UTF-8 testing for upgrades we discovered that the {{use_cached_catalog}} setting is not being respected in {{gf12ba81}} or {{ga7c5f6b}} versions of Davis (we have not tested other versions).  The impact of this is that customers will not be able to use cached catalogs.\r\n\r\nPE2015.2.0 (cached catalogs enabled on CentOS6):\r\n{code}\r\n[root@node0 ~]# puppet agent -t\r\nInfo: Using cached catalog from environment "production"\r\nInfo: Loading facts\r\nInfo: Applying configuration version "1472295113"\r\nNotice: こんにちは\r\nNotice: /Stage[main]/Utf_8/Notify[こんにちは]/message: defined "message" as "こんにちは"\r\nNotice: ブランク\r\nNotice: /Utf_8::App[ブランク]/Utf_8::Component_one[ブランク_first]/Notify[ブランク]/message: defined "message" as "ブランク"\r\nNotice: English\r\nNotice: /Utf_8::App[English]/Utf_8::Component_one[English_first]/Notify[English]/message: defined "message" as "English"\r\nNotice: Applied catalog in 1.66 seconds\r\n[root@node0 ~]# puppet agent -t\r\nInfo: Using cached catalog from environment "production"\r\nInfo: Loading facts\r\nInfo: Applying configuration version "1472295113"\r\nNotice: こんにちは\r\nNotice: /Stage[main]/Utf_8/Notify[こんにちは]/message: defined "message" as "こんにちは"\r\nNotice: ブランク\r\nNotice: /Utf_8::App[ブランク]/Utf_8::Component_one[ブランク_first]/Notify[ブランク]/message: defined "message" as "ブランク"\r\nNotice: English\r\nNotice: /Utf_8::App[English]/Utf_8::Component_one[English_first]/Notify[English]/message: defined "message" as "English"\r\nNotice: Applied catalog in 1.95 seconds\r\n{code}\r\n\r\nDavis (on CentOS7 and Ubuntu 16.04):\r\n{code}\r\n[root@node1 ~]# cat /etc/puppetlabs/puppet/puppet.conf\r\n# This file can be used to override the default puppet settings.\r\n# See the following links for more details on what settings are available:\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_important_settings.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_about_settings.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/config_file_main.html\r\n# - https://docs.puppetlabs.com/puppet/latest/reference/configuration.html\r\n[main]\r\nserver = master.puppet.vm\r\n[agent]\r\ncertname = node1.puppet.vm\r\nuse_cached_catalog = true\r\n[root@node1 ~]# systemctl restart puppet\r\n[root@node1 ~]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for node1.puppet.vm\r\nInfo: Applying configuration version "1472300511"\r\nNotice: こんにちは\r\nNotice: /Stage[main]/Utf_8/Notify[こんにちは]/message: defined "message" as "こんにちは"\r\nNotice: ブランク\r\nNotice: /Utf_8::App[ブランク]/Utf_8::Component_one[ブランク_second]/Notify[ブランク]/message: defined "message" as "ブランク"\r\nNotice: English\r\nNotice: /Utf_8::App[English]/Utf_8::Component_one[English_second]/Notify[English]/message: defined "message" as "English"\r\nNotice: Applied catalog in 0.89 seconds\r\n[root@node1 ~]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for node1.puppet.vm\r\nInfo: Applying configuration version "1472300535"\r\nNotice: こんにちは\r\nNotice: /Stage[main]/Utf_8/Notify[こんにちは]/message: defined "message" as "こんにちは"\r\nNotice: ブランク\r\nNotice: /Utf_8::App[ブランク]/Utf_8::Component_one[ブランク_second]/Notify[ブランク]/message: defined "message" as "ブランク"\r\nNotice: English\r\nNotice: /Utf_8::App[English]/Utf_8::Component_one[English_second]/Notify[English]/message: defined "message" as "English"\r\nNotice: Applied catalog in 0.83 seconds\r\n[root@node1 ~]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for node1.puppet.vm\r\nInfo: Applying configuration version "1472300560"\r\nNotice: こんにちは\r\nNotice: /Stage[main]/Utf_8/Notify[こんにちは]/message: defined "message" as "こんにちは"\r\nNotice: ブランク\r\nNotice: /Utf_8::App[ブランク]/Utf_8::Component_one[ブランク_second]/Notify[ブランク]/message: defined "message" as "ブランク"\r\nNotice: English\r\nNotice: /Utf_8::App[English]/Utf_8::Component_one[English_second]/Notify[English]/message: defined "message" as "English"\r\nNotice: Applied catalog in 0.98 seconds\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6660', 'https://github.com/puppetlabs/puppet/pull/5853', '2016-08-27T05:43:34.000-0700', '2017-06-28T12:22:35.000-0700', '2017-06-28T12:22:35.000-0700', 'Closed', 'resolved-issue-added', 23, '0', 1, 2, 18, 3, '268135c915d531ffc4d33f2eeb1bcad0bed95939', 'https://tickets.puppetlabs.com/browse/PUP-6660', 'https://github.com/puppetlabs/puppet/pull/5853'),
('puppet', 124182, 100910813, 5480, 'trusted_server_facts should be on by default', 'Not sure why this is off by default but this is super valuable and if people are to use it in shared modules it should be on by default\r\n\r\n{code}\r\n% puppet --version;puppet apply --configprint trusted_server_facts\r\n4.4.1\r\nfalse\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-6112', 'https://github.com/puppetlabs/puppet/pull/5480', '2016-03-30T03:48:07.000-0700', '2017-06-28T12:22:36.000-0700', '2017-06-28T12:22:36.000-0700', 'Closed', '', 4, '0', 1, 28, 124, 8, 'ec4e6de0cdbb7bde7ba7e8713d1a4a47b63b12c7', 'https://tickets.puppetlabs.com/browse/PUP-6112', 'https://github.com/puppetlabs/puppet/pull/5480'),
('puppet', 142014, 121445005, 5891, 'undefined method `backtrace" for Puppet::Error:Class with package with unresolvable source', 'Puppet throws an ugly error that crashes the catalog application, when the source of the package cannot be resolved by dns.\r\n\r\nThe error should be caught correctly and just this resource should fail.\r\n\r\nPuppet Code to trigger the issue:\r\n{code:puppet}\r\n# /root/package-test.pp\r\n  package { foo:\r\n    ensure   => "latest",\r\n    provider => "rpm",\r\n    source   =>\r\n  "http://cannotresolve.foo/foo.rpm",\r\n  }\r\n{code}\r\n\r\n\r\n\r\n{code:java}\r\n# puppet apply --debug --trace --evaltrace /root/package-test.pp\r\n ...\r\nInfo: /Stage[main]/Main/Package[foo]: Starting to evaluate the resource\r\nDebug: Executing: "/usr/bin/rpm -q foo --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n"\r\nDebug: Executing: "/usr/bin/rpm -q foo --nosignature --nodigest --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n --whatprovides"\r\nDebug: Executing: "/usr/bin/rpm -q --qf %{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n -p http://cannotresolve.foo/foo.rpm"\r\nError: Could not update: undefined method `backtrace" for Puppet::Error:Class\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/execution.rb:105:in `rescue in execfail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/execution.rb:102:in `execfail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider.rb:126:in `execfail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/rpm.rb:135:in `latest"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/rpm.rb:147:in `install"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/provider/package/rpm.rb:181:in `update"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/type/package.rb:112:in `block (3 levels) in <module:Puppet>"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:427:in `set"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/property.rb:501:in `sync"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:189:in `sync"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:114:in `sync_if_needed"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:79:in `perform_changes"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/resource_harness.rb:20:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:212:in `apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:228:in `eval_resource"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:151:in `call"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:151:in `block (2 levels) in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:386:in `block in thinmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:385:in `thinmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:151:in `block in evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:118:in `traverse"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction.rb:142:in `evaluate"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:222:in `block in apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/log.rb:155:in `with_destination"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/transaction/report.rb:118:in `as_logging_destination"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:221:in `apply"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:171:in `block in apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:223:in `block in benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/2.1.0/benchmark.rb:294:in `realtime"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:222:in `benchmark"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:170:in `apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:315:in `run_internal"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:186:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:240:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/configurer.rb:185:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:350:in `apply_catalog"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:274:in `block in main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet.rb:240:in `override"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:225:in `main"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application/apply.rb:170:in `run_command"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `block in run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util.rb:540:in `exit_on_fail"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/application.rb:344:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:128:in `run"\r\n/opt/puppetlabs/puppet/lib/ruby/vendor_ruby/puppet/util/command_line.rb:72:in `execute"\r\n/opt/puppetlabs/puppet/bin/puppet:5:in `<main>"\r\nError: /Stage[main]/Main/Package[foo]/ensure: change from absent to latest failed: Could not update: undefined method `backtrace" for Puppet::Error:Class\r\nInfo: /Stage[main]/Main/Package[foo]: Evaluated in 0.14 seconds\r\nInfo: Class[Main]: Starting to evaluate the resource\r\nDebug: Class[Main]: Resource is being skipped, unscheduling all events\r\n...\r\n{code}\r\n\r\n\r\n{noformat}\r\n# /usr/bin/rpm -q --qf "%{NAME} %|EPOCH?{%{EPOCH}}:{0}| %{VERSION} %{RELEASE} %{ARCH}\n" -p http://cannotresolve.foo/foo.rpm\r\ncurl: (6) Could not resolve host: cannotresolve.foo; Name or service not known\r\nerror: open of http://cannotresolve.foo/foo.rpm failed: No such file or directory\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6517', 'https://github.com/puppetlabs/puppet/pull/5891', '2016-07-18T04:36:29.000-0700', '2017-06-28T12:22:36.000-0700', '2017-06-28T12:22:36.000-0700', 'Closed', 'resolved-issue-added', 4, '0', 1, 50, 8, 5, 'd47a2c1d14a08e350001f536aee70295839e9921', 'https://tickets.puppetlabs.com/browse/PUP-6517', 'https://github.com/puppetlabs/puppet/pull/5891'),
('puppet', 47152, 124307875, 5950, 'If a catalog has a dependency cycle, it does not count as failed', 'If a catalog has a dependency cycle in it, the catalog fails to apply, but it counts it as a successful run.\r\n\r\n{noformat}\r\n# puppet agent -t\r\nInfo: Retrieving plugin\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/postgresql/lib/facter/postgres_default_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/root_home.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/stdlib/lib/facter/pe_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/pe_staging/lib/facter/staging_http_get.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/puppet_enterprise/lib/facter/pe_build.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/puppet_enterprise/lib/facter/windows.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/puppet_enterprise/lib/facter/platform_tag.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/firewall/lib/facter/iptables_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/firewall/lib/facter/iptables_persistent_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/firewall/lib/facter/ip6tables_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/pe_puppetdb/lib/facter/pe_puppetdb_server_status.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/pe_postgresql/lib/facter/pe_postgres_default_version.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/auth_conf/lib/facter/custom_auth_conf.rb\r\nInfo: Loading facts in /opt/puppet/share/puppet/modules/concat/lib/facter/concat_basedir.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/pe_puppetdb_server_status.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/custom_auth_conf.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/root_home.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/pe_build.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/windows.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/staging_http_get.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/facter_dot_d.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/puppet_vardir.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/iptables_version.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/iptables_persistent_version.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/ip6tables_version.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/platform_tag.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/pe_postgres_default_version.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/pe_version.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/concat_basedir.rb\r\nInfo: Loading facts in /var/opt/lib/pe-puppet/lib/facter/postgres_default_version.rb\r\nInfo: Caching catalog for pe-330-master.puppetdebug.vlan\r\nInfo: Applying configuration version "1407772716"\r\nError: Could not apply complete catalog: Found 1 dependency cycle:\r\n(Exec[step1] => Exec[step2] => Exec[step1])\r\nCycle graph written to /var/opt/lib/pe-puppet/state/graphs/cycles.dot.\r\nNotice: Finished catalog run in 0.35 seconds\r\n# echo $?\r\n0\r\n{noformat}\r\n\r\nThis in turn causes the node to show up as unchanged in the PE Console, and thus bury problems.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-3042', 'https://github.com/puppetlabs/puppet/pull/5950', '2014-08-11T09:09:07.000-0700', '2017-06-28T12:22:36.000-0700', '2017-06-28T12:22:36.000-0700', 'Closed', 'resolved-issue-added', 29, '0', 3, 209, 127, 8, '9fc067141de2ac9355a1db4d18aaa84de248f3b4', 'https://tickets.puppetlabs.com/browse/PUP-3042', 'https://github.com/puppetlabs/puppet/pull/5950'),
('puppet', 110427, 119398610, 5848, 'accessing facts via another scope', 'It"s possible to access a fact via another scope other then the currently active or top scope:\r\n\r\n{code:java}\r\nclass test::params {}\r\n\r\nclass test  (\r\n  timezone = $test::params::timezone,\r\n) inherits params {\r\n  notice($timezone)\r\n}\r\n\r\ninclude ::test\r\n{code}\r\n\r\nI would expect with strict_variables active that this would generate an error because timezone isn"t declared in test::params. But instead the value of the fact timezone is returned. Accessing facts and other automatically imported variables via top scope for historical reasons I can understand. But for any other scopes, then the currently active, I can see no valid reasons to access a fact or other automatically imported variables via them. Also the behavior is unexpected, at least for me. So I think this can be classified as a bug and not a feature. But I"m not sure so if you think this is a feature you can close this bug report.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5635', 'https://github.com/puppetlabs/puppet/pull/5848', '2015-12-22T13:36:14.000-0800', '2017-06-28T12:22:37.000-0700', '2017-06-28T12:22:37.000-0700', 'Closed', 'resolved-issue-added', 19, '0', 20, 142, 231, 8, '47d493eab8e49a2df4ca37a95c54ba91ef9f5272', 'https://tickets.puppetlabs.com/browse/PUP-5635', 'https://github.com/puppetlabs/puppet/pull/5848'),
('puppet', 126289, 122029938, 5901, 'Update links.puppetlabs.com links to links.puppet.com', 'This will need to be done in facter, hiera, puppet-agent, mco and possibly other projects as well. Setting this ticket in the PUP project for now, and we can just use (docs) for the commit message.', 'https://tickets.puppetlabs.com/browse/PUP-6164', 'https://github.com/puppetlabs/puppet/pull/5901', '2016-04-12T11:40:42.000-0700', '2017-06-28T12:22:37.000-0700', '2017-06-28T12:22:37.000-0700', 'Closed', 'help_wanted;tech-debt', 6, '0', 1, 21, 21, 12, '3a66c62e789e3171bb38856b6dd23f6831095390', 'https://tickets.puppetlabs.com/browse/PUP-6164', 'https://github.com/puppetlabs/puppet/pull/5901'),
('puppet', 10967, 25519212, 3379, 'Resource defaults aren"t completely evaluated by the compiler ', 'Resource defaults are merged in when [finish is called on resources|https://github.com/puppetlabs/puppet/blob/3.2.0/lib/puppet/parser/compiler.rb#L358] by the compiler [which leads to|https://github.com/puppetlabs/puppet/blob/3.2.0/lib/puppet/parser/resource.rb#L107] the [add_defaults method|https://github.com/puppetlabs/puppet/blob/3.2.0/lib/puppet/parser/resource.rb#L236-L244] in parser/resource.rb:\r\n\r\n{code}\r\n    def add_defaults\r\n      scope.lookupdefaults(self.type).each do |name, param|\r\n        unless @parameters.include?(name)\r\n          self.debug "Adding default for #{name}"\r\n\r\n          @parameters[name] = param.dup\r\n        end\r\n      end\r\n    end\r\n{code}\r\n\r\nThis method loops over each default and adds values to the @parameters hash if they are unset. No more, no less. The problem is that simply altering the @parameters hash isn"t sufficient to trigger the full effect of a resource parameter---the value must be present in the hash when the resource is evaluated by the compiler.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-25', 'https://github.com/puppetlabs/puppet/pull/3379', '2013-06-17T17:40:21.000-0700', '2017-06-28T12:23:40.000-0700', '2017-06-28T12:23:40.000-0700', 'Closed', 'redmine;resolved-issue-added', 9, '0', 1, 10, 2, 2, '64af2e856c5b8607500ae7c0e07747fbade97ada', 'https://tickets.puppetlabs.com/browse/PUP-25', 'https://github.com/puppetlabs/puppet/pull/3379'),
('puppet', 193234, 125487800, 5979, 'If the catalog contains binary content, the server should downgrade to pson', 'If the catalog contains binary content, then the master won"t be able to serialize it to json, generating an HTTP 500 error. To make it easy to migrate to Puppet 5, the master should detect when there is an encoding error when serializing the catalog, and downgrade to {{pson}}. It should also emit the correct mime-type.\r\n\r\nThe agent should still be able to cache the catalog (as PSON), and later load the catalog and apply, e.g. {{puppet agent -t --use_cached_catalog}}.\r\n\r\nThis issue is blocking puppetdb tests because they verify binary file content transfer from agent to server to puppetdb.', 'https://tickets.puppetlabs.com/browse/PUP-7602', 'https://github.com/puppetlabs/puppet/pull/5979', '2017-05-26T15:46:57.000-0700', '2017-06-28T13:15:40.000-0700', '2017-06-28T13:15:40.000-0700', 'Closed', '', 5, '0', 7, 219, 56, 12, 'c79dc64cce23d033f18693a6a7ed5152e6396b80', 'https://tickets.puppetlabs.com/browse/PUP-7602', 'https://github.com/puppetlabs/puppet/pull/5979'),
('puppet', 196739, 126323691, 5997, 'Resource collectors fails to load generated resource types.', 'A resource collector will always load the ruby resource, even if resources has been generated using {{puppet generate types}}.', 'https://tickets.puppetlabs.com/browse/PUP-7674', 'https://github.com/puppetlabs/puppet/pull/5997', '2017-06-19T07:40:24.000-0700', '2017-06-28T13:18:14.000-0700', '2017-06-28T13:18:14.000-0700', 'Closed', 'resolved-issue-added', 2, '0', 2, 16, 6, 4, '5595a82ee0683df4c502bc8e20c5deec1d463141', 'https://tickets.puppetlabs.com/browse/PUP-7674', 'https://github.com/puppetlabs/puppet/pull/5997'),
('puppet', 195902, 125646138, 5981, 'Metaparameters are validated on unrealized resources', 'I would not expect these to be validated unless the resource is actually realized, since an unrealized resource could indicate that other related resources are missing.\r\n\r\n{noformat}\r\nbranan@rycon:~/proj/pl/puppet$ bundle exec puppet apply foo.pp\r\nError: Could not find resource "Package[aptitude]" in parameter "require" at /home/branan/proj/pl/puppet/foo.pp:2 on node rycon\r\nbranan@rycon:~/proj/pl/puppet$ cat foo.pp\r\n@package { "apt":\r\n  require => Package["aptitude"]\r\n}\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7660', 'https://github.com/puppetlabs/puppet/pull/5981', '2017-06-14T09:31:04.000-0700', '2017-06-29T13:20:18.000-0700', '2017-06-29T13:20:18.000-0700', 'Closed', 'resolved-issue-added', 4, '0', 2, 18, 0, 2, '15b2e709b10e85b0ec95f85a47605f0f2f812a5a', 'https://tickets.puppetlabs.com/browse/PUP-7660', 'https://github.com/puppetlabs/puppet/pull/5981'),
('puppet', 192817, 122327746, 5910, 'utf8_user_comments test fails on AIX', 'We have been seeing the following failure on AIX for over two weeks now:\r\n\r\n{code}\r\nfailed to modify UTF-8 user comment in UTF-8 environment.\r\nExpected /changed "Aۿ" to "ᚠ𠜎"/ to match "\e[mNotice: Compiled catalog for pe-aix-61-spec.delivery.puppetlabs.net in environment production in 0.03 seconds\e[0m\n\e[0;32mInfo: Applying configuration version "1495597093"\e[0m\n\e[mNotice: /Stage[main]/Main/User[foo1347]/comment: comment changed "AÛ¿" to "á\u009A ð \u009C\u008E"\e[0m\n\e[mNotice: Applied catalog in 0.43 seconds\e[0m\n".\r\n{code}\r\n\r\nLast passing SHA of puppet through these tests was a207e6ec2ba1d662510de3b438a21476643a45e0.\r\n\r\n[~josh] and [~ethan] believe this might be related to work that has been going on around Etc.', 'https://tickets.puppetlabs.com/browse/PUP-7592', 'https://github.com/puppetlabs/puppet/pull/5910', '2017-05-24T13:25:22.000-0700', '2017-07-06T15:25:46.000-0700', '2017-07-06T15:25:46.000-0700', 'Closed', '', 5, '0', 1, 3, 1, 1, 'e81f82ccb4733192c9c0a58804b01f62a3129bad', 'https://tickets.puppetlabs.com/browse/PUP-7592', 'https://github.com/puppetlabs/puppet/pull/5910'),
('puppet', 189398, 119277649, 5846, 'Puppet merges two users in different encodings into one', 'If the user José bytes [74, 111, 115, 233] LATIN-1 and the user José bytes [74, 111, 115, 195, 169] UTF-8 both exist on the system, Puppet will pick whichever one is read in from the system first and ignore the other one silently without warning the user which is getting managed.\r\n\r\nAdditionally, if two resources in different encodings do make it through the system when gathered by `puppet resource`, that application can explode because of incompatible encodings \r\n\r\nFinally, if we get resources in binary encoding we may not be able to convert them to UTF-8 without first expecting them as encoding.default_external, so we might as well do that. \r\n\r\nThis, among other issues and potential improvements need addressed. ', 'https://tickets.puppetlabs.com/browse/PUP-7498', 'https://github.com/puppetlabs/puppet/pull/5846', '2017-05-04T15:25:30.000-0700', '2017-07-12T17:32:53.000-0700', '2017-07-12T17:32:53.000-0700', 'Closed', 'resolved-issue-added', 5, '0', 6, 800, 333, 12, '1958c497433a40f3c94a4529c089c99a22774d8a', 'https://tickets.puppetlabs.com/browse/PUP-7498', 'https://github.com/puppetlabs/puppet/pull/5846'),
('puppet', 200588, 130756061, 6077, 'execpipe raises method error if the command fails with no output', 'I"m trying to install a package as followed:\r\n\r\n{code}\r\n  package { "unifi":\r\n    ensure => latest\r\n  }\r\n{code}\r\n\r\nThe error I get with --debug:\r\n\r\n{code}\r\nDebug: Prefetching pacman resources for package\r\nDebug: Executing "/usr/bin/pacman -Q"\r\nDebug: Executing "/usr/bin/pacman -Sgg"\r\nDebug: Executing "/usr/bin/pacman -Q"\r\nDebug: Executing "/usr/bin/pacman -Sgg unifi"\r\nError: /Stage[main]/Unifi/Package[unifi]: Could not evaluate: undefined method `encoding" for #<IO:(closed)>\r\nDid you mean?  set_encoding\r\nNotice: /Stage[main]/Unifi/Service[unifi]: Dependency Package[unifi] has failures: true\r\n{code}\r\n\r\nDid some digging, and the command it"s failing on is where it checks for package groups: https://github.com/puppetlabs/puppet/blob/5.0.0/lib/puppet/provider/package/pacman.rb#L102\r\n\r\nSo it calls execpipe with the command, and the command returns 1 because the group doesn"t exist, but otherwise returns no output. This lands us here: https://github.com/puppetlabs/puppet/blob/5.0.0/lib/puppet/util/execution.rb#L86\r\n\r\nThe act of returning "output" as part of the exception attempts to stringify it. It"s a closed IO pipe, so that fails when trying to call ".encoding". I confirmed this by replacing "output" on the raise line with an empty string, which fixed the error.', 'https://tickets.puppetlabs.com/browse/PUP-7782', 'https://github.com/puppetlabs/puppet/pull/6077', '2017-07-15T16:22:05.000-0700', '2017-07-17T13:49:08.000-0700', '2017-07-17T13:49:08.000-0700', 'Closed', '', 7, '0', 1, 1, 1, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-7782', 'https://github.com/puppetlabs/puppet/pull/6077'),
('puppet', 200002, 130022848, 6059, 'Pip provider cannot manage any system python packages', 'The pip package provider cannot manage the installation of setuptools, distribute, or wheel as they are excluded from the output of "pip freeze".  What happens is that puppet tries to install them on every run because it does not know they are installed.  In versions of pip newer than 8.0.3 there is an "--all" flag that can be passed to pip to list them.  PR is incoming to fix this, just wanted to have a jira ticket to reference :).', 'https://tickets.puppetlabs.com/browse/PUP-7770', 'https://github.com/puppetlabs/puppet/pull/6059', '2017-07-11T15:17:44.000-0700', '2017-07-18T08:29:14.000-0700', '2017-07-18T08:29:14.000-0700', 'Closed', '', 1, '0', 1, 7, 4, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-7770', 'https://github.com/puppetlabs/puppet/pull/6059'),
('puppet', 170944, 119319571, 5847, 'Unable to halt Puppet service on Solaris using Puppet', 'The way Puppet works when run as a service is that it forks off a child process to perform the agent run; on most platforms, the service can be halted and the child process will continue to completion, which allows Puppet to manage its own service.\r\n\r\nOn Solaris, this doesn"t work because service handling uses contracts, and the child process is still part of the same contract that the service runs in. Attempting to stop the Puppet service during an agent run triggered by that service will send SIGTERM/SIGKILL to the service, stopping the agent run.', 'https://tickets.puppetlabs.com/browse/PUP-7110', 'https://github.com/puppetlabs/puppet/pull/5847', '2017-01-18T15:32:27.000-0800', '2017-07-19T11:01:46.000-0700', '2017-07-19T11:01:46.000-0700', 'Closed', 'resolved-issue-added', 6, '0', 2, 380, 8, 5, 'a820a7d4c0c8e6e452ebf379279541289aa4052f', 'https://tickets.puppetlabs.com/browse/PUP-7110', 'https://github.com/puppetlabs/puppet/pull/5847'),
('puppet', 198117, 128335535, 6030, '"bundle exec puppet module install" fails on Puppet 5.0.0', 'We have a Puppet 4.10.x pipeline running librarian puppet to install modules from Puppetfile. \r\n\r\nThis now failes on Puppet 5.0 with: \r\n\r\n{noformat}\r\n10:51:05 10:51:05 Error executing puppet module install. Check that this command succeeds:\r\n10:51:05 10:51:05 puppet module install --version 4.17.1 --target-dir /xxxx/.tmp/librarian/cache/source/puppet/forge/forgeapi_puppetlabs_com/puppetlabs-stdlib/4.17.1 --module_repository https://forgeapi.puppetlabs.com --modulepath /xxxx/.tmp/librarian/cache/source/puppet/forge/forgeapi_puppetlabs_com/puppetlabs-stdlib/4.17.1 --module_working_dir /xxxx/.tmp/librarian/cache/source/puppet/forge/forgeapi_puppetlabs_com/puppetlabs-stdlib/4.17.1 --ignore-dependencies puppetlabs-stdlib\r\n10:51:05 10:51:05 Error:\r\n10:51:05 10:51:05 Warning: Support for ruby version 2.0.0 is deprecated and will be removed in a future release. See https://docs.puppet.com/puppet/latest/system_requirements.html#ruby for a list of supported ruby versions.\r\n10:51:05 10:51:05    (at /yyyyy/gems/ruby/gems/puppet-5.0.0/lib/puppet.rb:181:in `<module:Puppet>")\r\n10:51:05 10:51:05 Error: wrong number of arguments (2 for 1)\r\n10:51:05 10:51:05 Error: Try "puppet help module install" for usage\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7738', 'https://github.com/puppetlabs/puppet/pull/6030', '2017-06-28T03:30:50.000-0700', '2017-07-19T14:22:47.000-0700', '2017-07-19T14:22:47.000-0700', 'Closed', '', 28, '0', 8, 161, 34, 14, 'f214d30b58d45547c901965b311d35a4fd088169', 'https://tickets.puppetlabs.com/browse/PUP-7738', 'https://github.com/puppetlabs/puppet/pull/6030'),
('puppet', 198912, 128907566, 6037, 'Acceptance test tests/resource/service/service_enable_linux.rb fails on Amazon Linux', '{{tests/resource/service/service_enable_linux.rb}} fails because the test interprets the {{majrelease}} version of {{2017}} to be greater than {{6}} and assumes that it is using {{systemd}} to manage services. Since Amazon Linux verison {{2017.03}} is built upon Redhat 6, it uses SysV and cannot find the systemd files referenced in the test.', 'https://tickets.puppetlabs.com/browse/PUP-7752', 'https://github.com/puppetlabs/puppet/pull/6037', '2017-07-05T01:08:41.000-0700', '2017-07-19T14:22:48.000-0700', '2017-07-19T14:22:48.000-0700', 'Closed', '', 2, '0', 1, 5, 1, 1, '8bf0dda8e7f30b5b465e6480ff65123dc4ad819b', 'https://tickets.puppetlabs.com/browse/PUP-7752', 'https://github.com/puppetlabs/puppet/pull/6037'),
('puppet', 198964, 129166032, 6044, 'Timestamp doesn"t provide a default format for date and time separated by space', 'When you have Timestamp process a time stamp, it can choose to only process some of the string without providing any feedback on it. For example:\r\n\r\nnotice(Timestamp("1970-01-01 01:02:03 UTC"))\r\n\r\nWill result in a timestamp of "1970-01-01T00:00:00.000000000 UTC"', 'https://tickets.puppetlabs.com/browse/PUP-7753', 'https://github.com/puppetlabs/puppet/pull/6044', '2017-07-05T09:01:41.000-0700', '2017-07-19T14:22:49.000-0700', '2017-07-19T14:22:49.000-0700', 'Closed', '', 2, '0', 1, 32, 3, 2, 'd7fff45e093b40a9cbfcf4e666d60e8f14bc3c28', 'https://tickets.puppetlabs.com/browse/PUP-7753', 'https://github.com/puppetlabs/puppet/pull/6044'),
('puppet', 197094, 128396895, 6031, 'Puppet acceptance tests failures on Power 8 Ubuntu 16.04 and Rhel 7', 'Ubuntu on Power 8\r\n\r\nThe following tests are failing they"re all test issues as the fqdn and the agent.hostname are not the same and the test is expects them to be.\r\n\r\nTest Case tests/reports/corrective_change_new_resource.rb\r\nTest Case tests/reports/corrective_change_outside_puppet.rb\r\nTest Case tests/reports/corrective_change_via_puppet.rb\r\nTest Case tests/resource/file/ticket_6448_file_with_utf8_source.rb', 'https://tickets.puppetlabs.com/browse/PUP-7684', 'https://github.com/puppetlabs/puppet/pull/6031', '2017-06-20T13:12:31.000-0700', '2017-07-19T14:22:49.000-0700', '2017-07-19T14:22:49.000-0700', 'Closed', '', 1, '0', 1, 131, 122, 5, '41ee03b412582931dffe0b280f836a769c07cb05', 'https://tickets.puppetlabs.com/browse/PUP-7684', 'https://github.com/puppetlabs/puppet/pull/6031'),
('puppet', 199823, 130493096, 6072, 'Puppet 5.0 Regression: puppet resource with --modulepath no longer loads expected code', 'Previously, when calling {{puppet resource}}, a {{--modulepath}} could be specified to load additional type / provider code.\r\n\r\nFor instance, with Puppet 4.10.4 / Ruby 2.3 running against a Windows node:\r\n\r\n{code}\r\nbundle exec puppet resource acl c:\windows --modulepath C:\source\puppetlabs-acl-master\spec\fixtures\modules\r\nacl { "c:\windows":\r\n  group                      => "S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464",\r\n  inherit_parent_permissions => "false",\r\n  owner                      => "S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464",\r\n  permissions                => [{"affects" => "self_only", "identity" => "NT SERVICE\TrustedInstaller", "rights" => ["full"]}, {"affects" => "children_only", "child_types" => "containers", "identity" => "NT SERVICE\TrustedInstaller", "rights" => ["full"]}, {"affects" => "self_only", "identity" => "NT AUTHORITY\SYSTEM", "rights" => ["modify"]}, {"affects" => "children_only", "identity" => "NT AUTHORITY\SYSTEM", "rights" => ["full"]}, {"affects" => "self_only", "identity" => "BUILTIN\Administrators", "rights" => ["modify"]}, {"affects" => "children_only", "identity" => "BUILTIN\Administrators", "rights" => ["full"]}, {"affects" => "self_only", "identity" => "BUILTIN\Users", "rights" => ["read", "execute"]}, {"affects" => "children_only", "identity" => "BUILTIN\Users", "rights" => ["read", "execute"]}, {"affects" => "children_only", "identity" => "CREATOR OWNER", "rights" => ["full"]}, {"affects" => "self_only", "identity" => "APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES", "rights" => ["read", "execute"]}, {"affects" => "children_only", "identity" => "APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES", "rights" => ["read", "execute"]}],\r\n}\r\n{code}\r\n\r\nHowever, on Puppet 5:\r\n\r\n{code}\r\n bundle exec puppet resource acl c:\windows --modulepath C:\source\puppetlabs-acl-master\spec\fixtures\modules --trace --debug --verbose\r\nDebug: Runtime environment: puppet_version=5.0.0, ruby_version=2.4.1, run_mode=user, default_encoding=IBM437\r\nDebug: Evicting cache entry for environment "production"\r\nDebug: Caching environment "production" (ttl = 0 sec)\r\nError: Could not run: Could not find type acl\r\nC:/source/puppet/lib/puppet/application/resource.rb:193:in `parse_args"\r\nC:/source/puppet/lib/puppet/application/resource.rb:134:in `block in main"\r\nC:/source/puppet/lib/puppet/context.rb:65:in `override"\r\nC:/source/puppet/lib/puppet.rb:308:in `override"\r\nC:/source/puppet/lib/puppet/application/resource.rb:133:in `main"\r\nC:/source/puppet/lib/puppet/application.rb:366:in `run_command"\r\nC:/source/puppet/lib/puppet/application.rb:358:in `block in run"\r\nC:/source/puppet/lib/puppet/util.rb:666:in `exit_on_fail"\r\nC:/source/puppet/lib/puppet/application.rb:358:in `run"\r\nC:/source/puppet/lib/puppet/util/command_line.rb:132:in `run"\r\nC:/source/puppet/lib/puppet/util/command_line.rb:72:in `execute"\r\nC:/source/puppet/bin/puppet:5:in `<top (required)>"\r\nC:/source/puppet/.bundle/gems/ruby/2.4.0/bin/puppet:22:in `load"\r\nC:/source/puppet/.bundle/gems/ruby/2.4.0/bin/puppet:22:in `<main>"\r\n{code}\r\n\r\nI was able to git bisect to determine the source of the problem in https://github.com/puppetlabs/puppet/commit/72ecbe429ce5136ffe4ab628672d6dc9faabfcdc\r\n\r\nIt seems that only code in the extended environment directory will now be loaded, which is a regression from previous behavior.  I believe that {{--modulepath}} is commonly in use for module development workflows.  For instance, I have been using the below for several years:\r\n\r\n{code}\r\nbundle exec rake spec_prep\r\n\r\n# work on code\r\n\r\n# run unit tests\r\nbundle exec rake spec_standalone\r\n\r\n# run interactive tests with apply or resource\r\nbundle exec puppet apply foo.pp --modulepath ./spec/fixtures/modules\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7766', 'https://github.com/puppetlabs/puppet/pull/6072', '2017-07-10T16:58:25.000-0700', '2017-07-19T14:22:49.000-0700', '2017-07-19T14:22:49.000-0700', 'Closed', 'regression', 10, '0', 3, 36, 1, 2, '53308fc8622329fdc65f01be9c897cd1fde7698b', 'https://tickets.puppetlabs.com/browse/PUP-7766', 'https://github.com/puppetlabs/puppet/pull/6072'),
('puppet', 198741, 128479838, 6034, 'Update vendored version of the semantic_puppet gem to version 1.0.1', 'The bug detected in MODULES-5159 was fixed in [PR-26 for semantic_puppet|https://github.com/puppetlabs/semantic_puppet/pull/26] and subsequently released in version 1.0.1 of the gem. This fix must be propagated to the gem that is vendored in the puppet code-base.', 'https://tickets.puppetlabs.com/browse/PUP-7747', 'https://github.com/puppetlabs/puppet/pull/6034', '2017-06-30T23:58:26.000-0700', '2017-07-19T14:22:49.000-0700', '2017-07-19T14:22:49.000-0700', 'Closed', '', 1, '0', 1, 2, 2, 2, '8481d4131f05ec07c0dea6508996297881553fa0', 'https://tickets.puppetlabs.com/browse/PUP-7747', 'https://github.com/puppetlabs/puppet/pull/6034'),
('puppet', 200253, 130259480, 6065, 'Acceptance tests/resource/package/common_package_name_in_different_providers.rb fails in Amazon Linux', 'The test installs a {{guid}} gem and package, but the package cannot be installed in the Amazon Linux environment:\r\n\r\n{noformat}\r\n14:43:31       ec2-35-166-77-127.us-west-2.compute.amazonaws.com (redhat6-64-2) 14:43:31$ puppet apply --verbose /tmp/apply_manifest.pp.xrEZ1D\r\n14:43:31         Notice: Compiled catalog for ec2-35-166-77-127.us-west-2.compute.amazonaws.com in environment production in 0.62 seconds\r\n14:43:33         Info: Applying configuration version "1499895812"\r\n14:43:33         Error: Execution of "/usr/bin/yum -d 0 -e 0 -y install guid" returned 1: Error: Nothing to do\r\n14:43:34         Error: /Stage[main]/Main/Package[guid]/ensure: change from purged to present failed: Execution of "/usr/bin/yum -d 0 -e 0 -y install guid" returned 1: Error: Nothing to do\r\n14:43:34         Notice: /Stage[main]/Main/Package[gem-guid]/ensure: created\r\n14:43:36         Info: Class[Main]: Unscheduling all events on Class[Main]\r\n14:43:36         Notice: Applied catalog in 2.66 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7774', 'https://github.com/puppetlabs/puppet/pull/6065', '2017-07-12T16:21:19.000-0700', '2017-07-19T14:22:50.000-0700', '2017-07-19T14:22:50.000-0700', 'Closed', '', 1, '0', 1, 1, 0, 1, '924c70645bbd6558c5432240881e4bded9aa9193', 'https://tickets.puppetlabs.com/browse/PUP-7774', 'https://github.com/puppetlabs/puppet/pull/6065'),
('puppet', 198012, 127763837, 6023, 'Puppet 5 adds generate_ast_model rake task which breaks gem/tarball creatio', 'Most of the machines we use at build-time do not have puppet/facter installed as gems. The generate_ast_model rake task requires puppet (which in turn requires facter), which causes gem and tarball generation to fail since the build environment can"t load facter and the Rakefile loads all rake files under tasks.\r\n\r\nThe generate_ast_model tasks are not required at build time and as such should be conditionally enabled, if we are able to successfully load puppet.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7736', 'https://github.com/puppetlabs/puppet/pull/6023', '2017-06-27T12:20:57.000-0700', '2017-07-19T14:22:50.000-0700', '2017-07-19T14:22:50.000-0700', 'Closed', '', 2, '0', 1, 48, 44, 1, '796d179ee6011d46f159c5ad9a6ac7593a8a4916', 'https://tickets.puppetlabs.com/browse/PUP-7736', 'https://github.com/puppetlabs/puppet/pull/6023'),
('puppet', 197035, 129051109, 6041, 'Create acceptance test for PUP-7671', '', 'https://tickets.puppetlabs.com/browse/PUP-7680', 'https://github.com/puppetlabs/puppet/pull/6041', '2017-06-20T10:11:32.000-0700', '2017-07-19T14:22:50.000-0700', '2017-07-19T14:22:50.000-0700', 'Closed', '', 2, '0', 1, 133, 0, 3, '6b88623b665c685d2dc549aab7790e8d89f82ee6', 'https://tickets.puppetlabs.com/browse/PUP-7680', 'https://github.com/puppetlabs/puppet/pull/6041'),
('puppet', 198347, 130095382, 6060, 'Regression: cannot set file owner to new user when purging unmanaged users', 'When using "resources { "user": purge => true }", a file owned by a puppet-managed user cannot be created when that user is being created in the same run.\r\n\r\nSimple test case:\r\n\r\n{code:title=test.pp}\r\ngroup { "test":\r\n  ensure => "present",\r\n  system => true,\r\n}\r\n\r\nuser { "test":\r\n  ensure => "present",\r\n  system => true,\r\n  groups => [],\r\n}\r\n\r\nfile { "/tmp/test":\r\n  ensure => "file",\r\n  owner  => "test",\r\n  group  => "test",\r\n  mode   => "0644",\r\n}\r\n\r\nresources { "user":\r\n  purge => true,\r\n}\r\n{code}\r\n\r\nUnder CentOS 7.3, this successfully creates the user and group, and creates the /tmp/test file with ownership root:root (should be test:test), and errors:\r\n\r\n{code}\r\n[vagrant@hashiserver-1 vagrant]$ sudo puppet apply test.pp \r\nNotice: Compiled catalog for hashiserver-1.node.vagrant.consul in environment production in 0.12 seconds\r\nNotice: /Stage[main]/Main/Group[test]/ensure: created\r\nNotice: /Stage[main]/Main/User[test]/ensure: created\r\nError: Could not set "file" on ensure: Could not find user test at /vagrant/test.pp:12\r\nError: Could not set "file" on ensure: Could not find user test at /vagrant/test.pp:12\r\nWrapped exception:\r\nCould not find user test\r\nError: /Stage[main]/Main/File[/tmp/test]/ensure: change from absent to file failed: Could not set "file" on ensure: Could not find user test at /vagrant/test.pp:12\r\nNotice: Applied catalog in 0.29 seconds\r\n{code}\r\n\r\nA subsequent "sudo puppet apply test.pp" completes successfully.\r\n\r\nThis problem was introduced in puppet-agent 4.10.2.', 'https://tickets.puppetlabs.com/browse/PUP-7742', 'https://github.com/puppetlabs/puppet/pull/6060', '2017-06-29T06:34:24.000-0700', '2017-07-19T14:22:51.000-0700', '2017-07-19T14:22:51.000-0700', 'Closed', '', 5, '0', 2, 4, 2, 1, '0817775f9c1539e432b9187b6152c84976e2fa67', 'https://tickets.puppetlabs.com/browse/PUP-7742', 'https://github.com/puppetlabs/puppet/pull/6060'),
('puppet', 25797, 127579253, 6020, 'symbolic_modes.rb acceptance test is really slow', '[~ethan] added performance data to Jenkins which pointed out that the symbolic_modes.rb test is really slow. It would be nice to speed this test up so that acceptance runs are quicker.', 'https://tickets.puppetlabs.com/browse/PUP-1607', 'https://github.com/puppetlabs/puppet/pull/6020', '2014-02-06T22:04:38.000-0800', '2017-07-19T14:22:51.000-0700', '2017-07-19T14:22:51.000-0700', 'Closed', 'maintenance', 8, '0', 1, 246, 185, 1, 'd5c248c52a838026b7158dc91f8657ee7b3edf9b', 'https://tickets.puppetlabs.com/browse/PUP-1607', 'https://github.com/puppetlabs/puppet/pull/6020'),
('puppet', 198911, 128928832, 6038, 'Lookup sort_merged_arrays vs. sort_merge_arrays', 'When specifying sort_merged_arrays in hiera data as shown here:\r\n\r\n{noformat}\r\nlookup_options:\r\n  classifier::extra_classes:\r\n    merge:\r\n      strategy: deep\r\n      knockout_prefix: --\r\n      sort_merged_arrays: true\r\n  classifier::rules:\r\n    merge:\r\n      strategy: deep\r\n      knockout_prefix: --\r\n{noformat}\r\n\r\nthe compiler fails:\r\n\r\n{noformat}\r\nError: Evaluation Error: Error while evaluating a Function Call, The merge options has wrong type, unrecognized key "sort_merged_arrays" at /home/user/.puppetlabs/etc/code/environments/production/manifests/site.pp:4:3 on node notebook.local\r\n{noformat}\r\n\r\nspelling it {{sort_merge_arrays}}  fixes the problem.\r\n\r\nalso this snippet fails: \r\n\r\n{noformat}\r\n  lookup({\r\n    "name" => "classifier::rules",\r\n    "merge" => {\r\n      "strategy" => "deep",\r\n      "sort_merged_arrays" => true,\r\n     },\r\n  })\r\n{noformat}\r\n\r\noutput:\r\n\r\n{noformat}\r\nError: Evaluation Error: Error while evaluating a Function Call, The merge options has wrong type, unrecognized key "sort_merged_arrays" at /home/user/.puppetlabs/etc/code/environments/production/manifests/site.pp:4:3 on node notebook.local\r\n{noformat}\r\n\r\nGrepping the puppet git repo there are different places where sort_merge_arrays and sort_merged_arrays is used.\r\n\r\nsort_merged_arrays is documented here: https://docs.puppet.com/puppet/5.0/hiera_use_function.html', 'https://tickets.puppetlabs.com/browse/PUP-7751', 'https://github.com/puppetlabs/puppet/pull/6038', '2017-07-05T00:55:02.000-0700', '2017-07-19T14:22:51.000-0700', '2017-07-19T14:22:51.000-0700', 'Closed', '', 4, '0', 1, 30, 4, 4, 'a0bfb3669968d6c7cf187651acc92e2ff753b047', 'https://tickets.puppetlabs.com/browse/PUP-7751', 'https://github.com/puppetlabs/puppet/pull/6038'),
('puppet', 200243, 130263112, 6066, 'Puppet fails to create error message when an exec fails', 'The chocolatey module was failing spec tests on Ruby 2.4.0 and Puppet 5.  example output\r\nhttps://ci.appveyor.com/project/puppetlabs/puppetlabs-chocolatey/build/1.1.x.379/job/8k8kvkt9moka317t\r\n{code}\r\n...\r\nFailures:\r\n  1) Puppet::Type::Package::ProviderChocolatey when fetching a package list should invoke provider listcmd\r\n     Failure/Error:\r\n       execpipe(listcmd) do |process|\r\n         process.each_line do |line|\r\n           line.chomp!\r\n           if line.empty? or line.match(/Reading environment variables.*/); next; end\r\n           raise Puppet::Error, "At least one source must be enabled." if line.match(/Unable to search for packages.*/)\r\n           if choco_exe\r\n             values = line.split("|")\r\n           else\r\n             values = line.split(" ")\r\n           end\r\n     NoMethodError:\r\n       undefined method `encoding" for #<IO:(closed)>\r\n       Did you mean?  set_encoding\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/puppet-5.0.0-x86-mingw32/lib/puppet/util/character_encoding.rb:93:in `scrub"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/puppet-5.0.0-x86-mingw32/lib/puppet/error.rb:6:in `initialize"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/puppet-5.0.0-x86-mingw32/lib/puppet/util/execution.rb:86:in `exception"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/puppet-5.0.0-x86-mingw32/lib/puppet/util/execution.rb:86:in `raise"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/puppet-5.0.0-x86-mingw32/lib/puppet/util/execution.rb:86:in `execpipe"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/puppet-5.0.0-x86-mingw32/lib/puppet/provider.rb:117:in `execpipe"\r\n     # ./lib/puppet/provider/package/chocolatey.rb:198:in `instances"\r\n     # ./spec/unit/puppet/provider/package/chocolatey_spec.rb:432:in `block (3 levels) in <top (required)>"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:254:in `instance_exec"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:254:in `block in run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:500:in `block in with_around_and_singleton_context_hooks"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:457:in `block in with_around_example_hooks"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:464:in `block in run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:602:in `run_around_example_hooks_for"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/hooks.rb:464:in `run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:457:in `with_around_example_hooks"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:500:in `with_around_and_singleton_context_hooks"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example.rb:251:in `run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:627:in `block in run_examples"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:623:in `map"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:623:in `run_examples"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:589:in `run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:590:in `block in run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:590:in `map"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/example_group.rb:590:in `run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:118:in `block (3 levels) in run_specs"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:118:in `map"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:118:in `block (2 levels) in run_specs"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/configuration.rb:1894:in `with_suite_hooks"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:113:in `block in run_specs"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/reporter.rb:79:in `report"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:112:in `run_specs"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:87:in `run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:71:in `run"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/lib/rspec/core/runner.rb:45:in `invoke"\r\n     # C:/Ruby24/lib/ruby/gems/2.4.0/gems/rspec-core-3.6.0/exe/rspec:4:in `<top (required)>"\r\n     # C:/Ruby24/bin/rspec:23:in `load"\r\n     # C:/Ruby24/bin/rspec:23:in `<main>"\r\nFinished in 2.06 seconds (files took 2.91 seconds to load)\r\n194 examples, 1 failure\r\nFailed examples:\r\n{code}\r\n\r\nFurther digging found:\r\n1.  The spec test is ending up with a nil value for the command_str which causes the open command to error\r\nhttps://github.com/puppetlabs/puppet/blame/master/lib/puppet/util/execution.rb#L80\r\n\r\n2. This error is then caught however instead of {{output}} having the output of the command, it has the output of the failed open state, i.e. an IO<closed> object\r\n\r\n3. This is then raised as an error at\r\nhttps://github.com/puppetlabs/puppet/blame/master/lib/puppet/util/execution.rb#L86\r\n\r\n4. The error class  is then initialized and the new scrub function called at;\r\nhttps://github.com/puppetlabs/puppet/blame/master/lib/puppet/error.rb#L6\r\n\r\n5. The scrub function at;\r\nhttps://github.com/puppetlabs/puppet/blame/master/lib/puppet/util/character_encoding.rb#L89-L96\r\n\r\nThen tries to scrub the object, however it assumes that it"s a string, but what"s passed in is an IO object.  This then fails on (https://github.com/puppetlabs/puppet/blame/master/lib/puppet/util/character_encoding.rb#L89-L96) because it does not have an encoding method.\r\n\r\nThis only appears to have started in Puppet 5.\r\n\r\nPossible resolutions:\r\n1. Scrub function should not assume it"s a string coming in.  If it"s not a string, just spit the original value out.\r\n\r\n2. The execpipe should not assume the output is a string and should cast output to a string prior to raising the error message', 'https://tickets.puppetlabs.com/browse/PUP-7772', 'https://github.com/puppetlabs/puppet/pull/6066', '2017-07-12T15:59:52.000-0700', '2017-07-28T14:12:23.000-0700', '2017-07-28T14:12:23.000-0700', 'Closed', '', 5, '0', 1, 9, 1, 2, 'd92dfb447a1fb139f5773cdb3f55d5b52d785701', 'https://tickets.puppetlabs.com/browse/PUP-7772', 'https://github.com/puppetlabs/puppet/pull/6066'),
('puppet', 202310, 132433059, 6087, 'Disabling automatic class parameter lookup in Hiera 5 also disables the global hierarchy layer', 'Disabling automatic class parameter lookup in Hiera 5 also disables the global hierarchy layer\r\n\r\nPrior to Puppet 4.9.0 and the integration of Hiera 5, setting the {{data_binding_terminus}} to {{none}} would disable automatic lookup of class parameters while keeping explicit lookups via the {{hiera()}} functions enabled. Starting with Puppet 4.9.0, setting {{data_binding_terminus}} to {{none}} disables {{hiera()}} entirely.\r\n\r\nh2. Reproduction Case\r\n\r\n*  Install PE 2016.4.6.\r\n*  Replace ` /etc/puppetlabs/code/environments/production/manifests/site.pp` with the following content:\r\n\r\n{code:puppet}\r\nclass testclass (\r\n  $param1 = "default",\r\n  $param2 = "default",\r\n) {\r\n\r\n  notify {"param1: ${param1}": }\r\n  notify {"param2: ${param2}": }\r\n\r\n}\r\n\r\nnode default {\r\n  class {"testclass":\r\n    param1 => hiera("param1"),\r\n  }\r\n}\r\n{code}\r\n\r\n*  Add the following data to {{/etc/puppetlabs/code/environments/production/hieradata/common.yaml}}:\r\n\r\n{code}\r\nparam1: hiera_override\r\ntestclass::param2: hiera_override\r\n{code}\r\n\r\n*  Disable the data_binding_terminus:\r\n\r\n{code}\r\npuppet config set --section master data_binding_terminus none\r\n{code}\r\n\r\n*  Re-start {{pe-puppetserver}}\r\n*  Run {{puppet agent -t}}\r\n\r\nh3. Outcome\r\n\r\nThe puppet run fails with a {{lookup()}} error:\r\n\r\n{noformat}\r\n[root@pe-201646-master production]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Function lookup() did not find a value for the name "param1" on node pe-201646-master.puppetdebug.vlan\r\nWarning: Not using cache on failed catalog\r\nError: Could not retrieve catalog; skipping run\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe run succeeds, and only param1 of testclass is overridden via Hiera data:\r\n\r\n{noformat}\r\n[root@pe-201643-master manifests]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201643-master.puppetdebug.vlan\r\nInfo: Applying configuration version "1500938483"\r\nNotice: param1: hiera_override\r\nNotice: /Stage[main]/Testclass/Notify[param1: hiera_override]/message: defined "message" as "param1: hiera_override"\r\nNotice: param2: default\r\nNotice: /Stage[main]/Testclass/Notify[param2: default]/message: defined "message" as "param2: default"\r\nNotice: Applied catalog in 11.76 seconds\r\n{noformat}\r\n\r\nThis was the behavior prior to Puppet 4.9.', 'https://tickets.puppetlabs.com/browse/PUP-7802', 'https://github.com/puppetlabs/puppet/pull/6087', '2017-07-24T16:28:17.000-0700', '2017-08-10T10:46:10.000-0700', '2017-08-10T10:46:10.000-0700', 'Closed', '', 12, '0', 1, 7, 1, 2, 'afd9821b650889a6e8b80553a7e66a8ce31b8278', 'https://tickets.puppetlabs.com/browse/PUP-7802', 'https://github.com/puppetlabs/puppet/pull/6087'),
('puppet', 177470, 108398741, 5668, 'Acceptance:  Modified test to add tstpool & pointed manifest to available interface', 'This test currently fails because the manifest does not create the /ztstpool directory before trying to create the /ztstpool/mnt directory', 'https://tickets.puppetlabs.com/browse/PUP-7282', 'https://github.com/puppetlabs/puppet/pull/5668', '2017-02-28T09:50:47.000-0800', '2017-08-16T08:20:39.000-0700', '2017-08-16T08:20:39.000-0700', 'Closed', '', 3, '0', 1, 17, 3, 1, '8b8e962bae6c9f8e38926c1466c7c2231106bed9', 'https://tickets.puppetlabs.com/browse/PUP-7282', 'https://github.com/puppetlabs/puppet/pull/5668'),
('puppet', 190046, 120077391, 5857, 'reduce does not work with break()', 'It is not possible to call {{break()}} from within a {{reduce}} function. The result is an error stating that\r\n{code}\r\nError: break() from context where this is illegal\r\n{code}\r\n\r\nThis is because the handling of the {{StopIteration}} required is missing in the implementation of {{reduce}}.', 'https://tickets.puppetlabs.com/browse/PUP-7514', 'https://github.com/puppetlabs/puppet/pull/5857', '2017-05-10T02:25:37.000-0700', '2017-08-16T12:19:36.000-0700', '2017-08-16T12:19:36.000-0700', 'Closed', 'resolved-issue-added', 6, '0', 3, 45, 5, 3, 'ea8beb05a2afab3b848e6cb92b05d9f147033c41', 'https://tickets.puppetlabs.com/browse/PUP-7514', 'https://github.com/puppetlabs/puppet/pull/5857'),
('puppet', 159905, 122086902, 5903, 'Puppet package provider for Python"s pip fails when Perl"s pip is installed', 'pip provider does not work with perl pip (pip.bat) installed on windows\r\nworkaround is to add "pip.exe"\r\n\r\nunder \r\n\r\n{code}\r\ndef self.cmd\r\n    ["pip", "pip-python"]\r\nend\r\n{code}\r\n\r\nat https://github.com/puppetlabs/puppet/blob/484623eda09d8e8b9857f5279ebb891a423588dc/lib/puppet/provider/package/pip.rb#L51\r\n\r\nother links for reference:\r\nhttp://www.penwatch.net/cms/?p=561\r\nhttps://codedump.io/share/cdbKgmH5wJvW/1/pip-on-windows-giving-the-error---unknown-or-unsupported-command-39install39\r\nhttp://stackoverflow.com/questions/7469361/pip-on-windows-giving-the-error-unknown-or-unsupported-command-install\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6895', 'https://github.com/puppetlabs/puppet/pull/5903', '2016-11-06T19:23:03.000-0800', '2017-08-18T07:13:45.000-0700', '2017-08-18T07:13:45.000-0700', 'Closed', 'help_wanted;maintenance;windows', 6, '0', 1, 33, 23, 2, '43f42a624c13ba12df38a17189c8fe4d86320676', 'https://tickets.puppetlabs.com/browse/PUP-6895', 'https://github.com/puppetlabs/puppet/pull/5903'),
('puppet', 136960, 110172242, 5702, 'Pip package provider runs every time when updating setuptools', 'Similar to PUP-6120, I see a problem with "setuptools" (which also doesn"t show up in pip output). The current workaround seems kind of cumbersome. While this is with 3.8.7, I imagine the setuptools problem might be reproducible in newer puppet.\r\n\r\nHow common is pip < 1.2.2? Seems like "pip freeze --all" would also work, but appears to also not be implemented in 1.0.x.\r\n\r\nMaybe pip could just update itself first (or require a minimum version), then use "pip list" or "pip freeze \-\-all" for determining versions of everything else? Or determine pip version first, then add the "--all" flag in cases where it"s supported? Then at least it would "see" pip and setuptools if the version of pip is recent enough.\r\n\r\nThis is with older Puppet (3.8) without the fix for 6120, but same \r\n\r\n{noformat}\r\nDebug: Executing "/bin/pip freeze"\r\nDebug: Executing "/bin/pip install -q --upgrade setuptools"\r\nNotice: /Stage[main]/Role::Dp/Package[setuptools]/ensure: created\r\n{noformat}\r\n\r\n{noformat}\r\n  package { "pip":\r\n              ensure   => latest,\r\n              install_options => "--upgrade",\r\n              provider => "pip" } ->\r\n  package { "setuptools":\r\n              ensure   => latest,\r\n              install_options => "--upgrade",\r\n              provider => "pip" } ->\r\n{noformat}\r\n\r\n{noformat}\r\n# pip --version\r\npip 8.1.2 from /usr/lib/python2.7/site-packages (python 2.7)\r\n# pip freeze | grep ^setuptools\r\n# pip freeze --all | grep ^setuptools\r\nsetuptools==23.0.0\r\n# pip list | grep ^setuptools\r\nsetuptools (23.0.0)\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-6405', 'https://github.com/puppetlabs/puppet/pull/5702', '2016-06-14T10:24:02.000-0700', '2017-08-18T07:13:45.000-0700', '2017-08-18T07:13:45.000-0700', 'Closed', '', 8, '0', 2, 23, 3, 2, 'fa1d845c71b8e171b787da070c9abbbd9403fb55', 'https://tickets.puppetlabs.com/browse/PUP-6405', 'https://github.com/puppetlabs/puppet/pull/5702'),
('puppet', 93963, 131805826, 6083, 'POSIX Exec throws error when group has no name', 'If trying to execute with the group set to a group that has no name (just number), an error will be thrown:\r\n\r\nBad file descriptor (Errno::EBADF)\r\n\r\nThis occurs even if the group ID is passed in.\r\n\r\nDigging in, seems to be a failure in Puppet::Util::POSIX#gid. If I add a check to see if the group ID is an integer and skip this call, it skips this check and the exec works fine [1]\r\n\r\nThis is reproducible with Etc.getgrgid, so not sure if it"s an issue elsewhere. Overall though, if an integer is passed in as the group seems like we can just skip this altogether. It will remove intentional verification, but we will end up with an error regardless so I"m not sure that"s a big issue.\r\n\r\nIf it"s agreed this is an issue, I"m happy to work up a proper PR.\r\n\r\n[1]: https://github.com/lstoll/puppet/commit/53efaffcb45fc165b12685f2085c1f732e4bfb9b', 'https://tickets.puppetlabs.com/browse/PUP-5047', 'https://github.com/puppetlabs/puppet/pull/6083', '2015-08-17T18:13:17.000-0700', '2017-08-18T07:13:46.000-0700', '2017-08-18T07:13:46.000-0700', 'Closed', '', 8, '0', 1, 1, 0, 1, '1223bb8968af4f62550bb9a36d9cb3d757f9be82', 'https://tickets.puppetlabs.com/browse/PUP-5047', 'https://github.com/puppetlabs/puppet/pull/6083'),
('puppet', 110901, 133813971, 6099, 'Can"t install gems on Arch Linux', 'Update: This might be a [gem issue|https://bugs.ruby-lang.org/issues/12070] rather than a Puppet issue. Keeping this open since it"s not clear yet what the issue is, and since I can only reproduce when the gem command is run with Puppet.\r\n\r\nFrom [unix.stackexchange.com post|https://unix.stackexchange.com/q/252937/3645]:\r\n\r\nI"ve got [the following|https://github.com/l0b0/root/blob/cf94a48397bb2323bbecfd657b43d6fd748818c8/modules/travis_linter/manifests/init.pp]:\r\n\r\n{code:puppet}\r\nclass travis_linter {\r\n  include shell\r\n\r\n  package { "travis-lint":\r\n    ensure   => latest,\r\n    provider => gem,\r\n  }\r\n}\r\n{code}\r\n\r\nWhen I try to [test it|https://github.com/l0b0/root/tree/cf94a48397bb2323bbecfd657b43d6fd748818c8#test], however, I get the following Puppet output:\r\n\r\n{noformat}\r\n==> default: Debug: Executing: "/usr/bin/gem install --no-rdoc --no-ri travis-lint"\r\n==> default: Error: Could not update: Execution of "/usr/bin/gem install --no-rdoc --no-ri travis-lint" returned 1: ERROR:  While executing gem ... (TypeError)\r\n==> default:     wrong argument type nil (expected Regexp)\r\n==> default: Error: /Stage[main]/Travis_linter/Package[travis-lint]/ensure: change from absent to latest failed: Could not update: Execution of "/usr/bin/gem install --no-rdoc --no-ri travis-lint" returned 1: ERROR:  While executing gem ... (TypeError)\r\n==> default:     wrong argument type nil (expected Regexp)\r\n{noformat}\r\n\r\nOther possibly relevant output from the [full log file|http://pastebin.com/GgT3Vy1E]:\r\n\r\n\r\n{noformat}\r\nDebug: Puppet::Type::Package::ProviderPuppet_gem: file /opt/puppetlabs/puppet/bin/gem does not exist\r\nDebug: /Package[puppet-lint]: Provider gem does not support features virtual_packages; not managing attribute allow_virtual\r\nDebug: /Package[reek]: Provider gem does not support features virtual_packages; not managing attribute allow_virtual\r\nDebug: /Package[travis-lint]: Provider gem does not support features virtual_packages; not managing attribute allow_virtual\r\n{noformat}\r\n\r\nSetting `ensure` to `2.0.0` didn"t help, so it"s not related to the `latest` keyword:\r\n\r\n{noformat}\r\nError: Could not update: Execution of "/usr/bin/gem install -v 2.0.0 --no-rdoc --no-ri travis-lint" returned 1: ERROR:  While executing gem ... (TypeError)\r\n    wrong argument type nil (expected Regexp)\r\n{noformat}\r\n\r\nI am able to run the exact same command manually:\r\n\r\n{noformat}\r\n[vagrant@archlinux ~]$ /usr/bin/gem install --no-rdoc --no-ri travis-lint\r\nFetching: travis-lint-2.0.0.gem (100%)\r\nWARNING:  You don"t have /home/vagrant/.gem/ruby/2.3.0/bin in your PATH,\r\n          gem executables will not run.\r\nSuccessfully installed travis-lint-2.0.0\r\n1 gem installed\r\n{noformat}\r\n\r\nIs my Puppet manifest wrong, or is something broken about Puppet/Gem? Is it possible that `latest` is not a valid value for gems?\r\n\r\nIt works fine on [Travis CI (Ubuntu 12.04)|https://travis-ci.org/l0b0/root/builds/99846406#L1153-L1156]:\r\n\r\n{noformat}\r\nDebug: Executing: "/home/travis/.rvm/rubies/ruby-2.2.3/bin/gem list --local ^travis-lint$"\r\nDebug: Executing: "/home/travis/.rvm/rubies/ruby-2.2.3/bin/gem install --no-rdoc --no-ri travis-lint"\r\nNotice: /Stage[main]/Travis_linter/Package[travis-lint]/ensure: created\r\nDebug: /Package[travis-lint]: The container Class[Travis_linter] will propagate my refresh event\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-5645', 'https://github.com/puppetlabs/puppet/pull/6099', '2016-01-03T05:03:22.000-0800', '2017-08-18T07:13:47.000-0700', '2017-08-18T07:13:47.000-0700', 'Closed', 'gem;manage-package;non-root', 8, '0', 1, 8, 8, 2, '073fe37b516e0c9c9ff8e4bb01c346deebd2f6ab', 'https://tickets.puppetlabs.com/browse/PUP-5645', 'https://github.com/puppetlabs/puppet/pull/6099'),
('puppet', 154008, 87196003, 5306, 'Puppet::FileBucket::Dipper specs fail silently', 'dipper_spec assumes gnu diff AND executes diff via ``s notably this fails on Solaris but may also fail on other platforms\r\n\r\nCurrent\r\n----\r\n{code:ruby}\r\nrspec spec/unit/file_bucket/dipper_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n....diff: illegal option -- N\r\nusage: diff [-bitw] [-c | -e | -f | -h | -n | -u] file1 file2\r\n       diff [-bitw] [-C number | -U number] file1 file2\r\n       diff [-bitw] [-D string] file1 file2\r\n       diff [-bitw] [-c | -e | -f | -h | -n | -u] [-l] [-r] [-s] [-S name] directory1 directory2\r\ndiff: illegal option -- N\r\nusage: diff [-bitw] [-c | -e | -f | -h | -n | -u] file1 file2\r\n       diff [-bitw] [-C number | -U number] file1 file2\r\n       diff [-bitw] [-D string] file1 file2\r\n       diff [-bitw] [-c | -e | -f | -h | -n | -u] [-l] [-r] [-s] [-S name] directory1 directory2\r\n..diff: illegal option -- N\r\nusage: diff [-bitw] [-c | -e | -f | -h | -n | -u] file1 file2\r\n       diff [-bitw] [-C number | -U number] file1 file2\r\n       diff [-bitw] [-D string] file1 file2\r\n       diff [-bitw] [-c | -e | -f | -h | -n | -u] [-l] [-r] [-s] [-S name] directory1 directory2\r\ndiff: illegal option -- N\r\nusage: diff [-bitw] [-c | -e | -f | -h | -n | -u] file1 file2\r\n       diff [-bitw] [-C number | -U number] file1 file2\r\n       diff [-bitw] [-D string] file1 file2\r\n       diff [-bitw] [-c | -e | -f | -h | -n | -u] [-l] [-r] [-s] [-S name] directory1 directory2\r\n................................\r\n\r\nFinished in 1.6 seconds (files took 2.47 seconds to load)\r\n38 examples, 0 failures\r\n{code}\r\n\r\n\r\nWith Puppet::Util::Execution.execute\r\n----\r\n{code:java}\r\nrspec spec/unit/file_bucket/dipper_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n....F.F...............................\r\n\r\nFailures:\r\n\r\n  1) Puppet::FileBucket::Dipper when diffing on a local filebucket in non-windows environments when digest_algorithm is md5 should properly diff files on the filebucket\r\n     Failure/Error: expect(@dipper.diff(checksum1, checksum2, nil, nil)).to include(diff12)\r\n\r\n       expected "--- /tmp/rspecrun20160928-29191-mm3g5/bucket20160928-29191-ucq5dv/a/a/e/e/8/e/f/2/aaee8ef2aebce5861b...e7/contents\t2016-09-28 13:05:52.245200560 -0700\n@@ -1 +1 @@\n-OriginalContent\n+ModifiedContent\n" to include "diff: illegal option -- N\nusage: diff [-bitw] [-c | -e | -f | -h | -n | -u] file1 file2\n       dif...n       diff [-bitw] [-c | -e | -f | -h | -n | -u] [-l] [-r] [-s] [-S name] directory1 directory2\n"\r\n       Diff:\r\n       @@ -1,2 +1,6 @@\r\n       -diff: illegal option -- N\nusage: diff [-bitw] [-c | -e | -f | -h | -n | -u] file1 file2\n       diff [-bitw] [-C number | -U number] file1 file2\n       diff [-bitw] [-D string] file1 file2\n       diff [-bitw] [-c | -e | -f | -h | -n | -u] [-l] [-r] [-s] [-S name] directory1 directory2\n\r\n       +--- /tmp/rspecrun20160928-29191-mm3g5/bucket20160928-29191-ucq5dv/a/a/e/e/8/e/f/2/aaee8ef2aebce5861bddd2c59afdf3f1/contents     2016-09-28 13:05:52.244125030 -0700\r\n       ++++ /tmp/rspecrun20160928-29191-mm3g5/bucket20160928-29191-ucq5dv/7/c/3/0/c/6/c/4/7c30c6c414286afdd1ad6b78cf6c75e7/contents     2016-09-28 13:05:52.245200560 -0700\r\n       +@@ -1 +1 @@\r\n       +-OriginalContent\r\n       ++ModifiedContent\r\n     # ./spec/unit/file_bucket/dipper_spec.rb:111:in `block (5 levels) in <top (required)>"\r\n\r\n  ...\r\n\r\nFinished in 1.15 seconds (files took 3.46 seconds to load)\r\n38 examples, 2 failures\r\n\r\nFailed examples:\r\n\r\nrspec ./spec/unit/file_bucket/dipper_spec.rb[1:3:1:1:2] # Puppet::FileBucket::Dipper when diffing on a local filebucket in non-windows environments when digest_algorithm is md5 should properly diff files on the filebucket\r\nrspec ./spec/unit/file_bucket/dipper_spec.rb[1:3:1:2:2] # Puppet::FileBucket::Dipper when diffing on a local filebucket in non-windows environments when digest_algorithm is sha256 should properly diff files on the filebucket\r\n\r\n{code}\r\n\r\n\r\nAfter\r\n----\r\n{code:java}\r\nrspec spec/unit/file_bucket/dipper_spec.rb\r\nRun options: exclude {:broken=>true, :benchmark=>true}\r\n......................................\r\n\r\nFinished in 2.24 seconds (files took 3.6 seconds to load)\r\n38 examples, 0 failures\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6756', 'https://github.com/puppetlabs/puppet/pull/5306', '2016-09-28T13:13:12.000-0700', '2017-08-18T07:13:48.000-0700', '2017-08-18T07:13:48.000-0700', 'Closed', 'maintenance', 2, '0', 1, 13, 4, 1, 'facfe1ffde2617413bcd6fa37cbbe8e96afae59f', 'https://tickets.puppetlabs.com/browse/PUP-6756', 'https://github.com/puppetlabs/puppet/pull/5306'),
('puppet', 165856, 131635919, 6082, 'acceptance: no_exception_in_reduce_with_bignum doesn"t test anything', 'The acceptance test defines a function which relies on a {{merge}} function:\r\n\r\nhttps://github.com/puppetlabs/puppet/blob/9dda0a424b5067cabdfd70f72b286fa7f29f604a/acceptance/tests/parser_functions/no_exception_in_reduce_with_bignum.rb#L51\r\n\r\nThe merge function is defined by stdlib, but isn"t in puppet. If you try to run webrick against the {{site.pp}} manifest from the test, you"ll get two problems.\r\n\r\nFirst, the quotes in site.pp are not escaped (they"re escaped in beaker, but it needs an additional set of escapes).\r\n\r\n{code:puppet}\r\n"keyname1"=>{\r\n  "key"=>"ABCDEF",\r\n  "options"=>["from="10.0.0.0/8""]\r\n},\r\n{code}\r\n\r\nIf you change that to {{"from=\"10.0.0.0/8\""}} along with the others, and try to run puppet, you get:\r\n\r\n{noformat}\r\nError: Evaluation Error: Unknown function: "merge". at /etc/puppetlabs/code/environments/production/manifests/site.pp:40:7 on node wu5mldrtuv6zfap.delivery.puppetlabs.net\r\nError: Evaluation Error: Unknown function: "merge". at /etc/puppetlabs/code/environments/production/manifests/site.pp:40:7 on node wu5mldrtuv6zfap.delivery.puppetlabs.net\r\nError: Server Error: Evaluation Error: Unknown function: "merge". at /etc/puppetlabs/code/environments/production/manifests/site.pp:40:7 on node wu5mldrtuv6zfap.delivery.puppetlabs.net\r\n/tmp/bundle/ruby/bundler/gems/puppet-9dda0a424b50/lib/puppet/pops/evaluator/runtime3_support.rb:39:in `optionally_fail"\r\n{noformat}\r\n\r\nWhen running in CI against puppetserver packages, the test passes, e.g. https://jenkins.puppetlabs.com/view/puppet-agent/view/stable/view/puppet-agent/job/platform_puppet-agent_intn-van-sys_suite-daily-puppet-stable/248/SLAVE_LABEL=beaker,TEST_TARGET=redhat6-64a/consoleFull\r\n\r\nI think it"s "passing" because the test sets the directory permissions to 666:\r\n\r\n{code:ruby}\r\non(master, "chmod -R 666 #{File.join(environmentpath,tmp_environment)}")\r\n{code}\r\n\r\nSo the environment isn"t traversible by puppetserver running as the {{puppet}} user, which causes the test to never try to parse {{site.pp}}.\r\n\r\nInterestingly, puppetserver doesn"t complain about that, but puppet webrick does. /cc [~jeremy.barlow]', 'https://tickets.puppetlabs.com/browse/PUP-6994', 'https://github.com/puppetlabs/puppet/pull/6082', '2016-12-09T12:24:48.000-0800', '2017-08-18T07:13:48.000-0700', '2017-08-18T07:13:48.000-0700', 'Closed', '', 4, '0', 1, 43, 50, 1, 'ffb1e1c428e33c3d87130f434be55f3ab58d3847', 'https://tickets.puppetlabs.com/browse/PUP-6994', 'https://github.com/puppetlabs/puppet/pull/6082'),
('puppet', 180947, 127323493, 6017, 'Parser result no longer contains current method', 'The puppet debugger uses the AST model to get a model object in order to import itself into the known resource types.  In order to make this work with puppet 5 I had to refactor my code slightly to account for the missing method.  Not a huge deal but this might break other third party code.\r\n\r\nPreviously I was calling parse_result.current to get the model.  However, with puppet 5 I actually don"t need to do that anymore since the model object is the parsed result.\r\n\r\nBut because puppet-debugger supports puppet 3-5 I had to write the following code to work around the issue.  Puppet 5 should add a current method to the parsed_result object that points to itself, thus keeping third party integrations working.\r\n\r\nExample:\r\n\r\n\r\n{code:ruby}\r\n# adds backward compatible call so we don"t break third party programs.\r\ndef current\r\n  self\r\nend\r\n{code}\r\n\r\n\r\nPuppet debugger code that was modified\r\n{code:ruby}\r\nparse_result = parser.parse_string(string, "")\r\nmodel = parse_result.respond_to?(:current) ? parse_result.current : parse_result\r\n{code}\r\n\r\n\r\n\r\nBigger Code snippet from puppet-debugger\r\n\r\n{code:ruby}\r\n# @param String - any valid puppet language code\r\n    # @return Hostclass - a puppet Program object which is considered the main class\r\n    def generate_ast(string = nil)\r\n      parse_result = parser.parse_string(string, "")\r\n      # the parse_result may be\r\n      # * empty / nil (no input)\r\n      # * a Model::Program\r\n      # * a Model::Expression\r\n      #\r\n      # should return nil or Puppet::Pops::Model::Program\r\n      # puppet 5 does not have the method current\r\n      model = parse_result.respond_to?(:current) ? parse_result.current : parse_result\r\n      args = {}\r\n      ::Puppet::Pops::Model::AstTransformer.new("").merge_location(args, model)\r\n\r\n      ast_code =\r\n        if model.is_a? ::Puppet::Pops::Model::Program\r\n          ::Puppet::Parser::AST::PopsBridge::Program.new(model, args)\r\n        else\r\n          args[:value] = model\r\n          ::Puppet::Parser::AST::PopsBridge::Expression.new(args)\r\n        end\r\n      # Create the "main" class for the content - this content will get merged with all other "main" content\r\n      ::Puppet::Parser::AST::Hostclass.new("", code: ast_code)\r\n    end\r\n\r\n    # @param String - any valid puppet language code\r\n    # @return Object - returns either a string of the result or object from puppet evaulation\r\n    def puppet_eval(input)\r\n      # in order to add functions to the scope the loaders must be created\r\n      # in order to call native functions we need to set the global_scope\r\n      ast = generate_ast(input)\r\n      # record the input for puppet to retrieve and reference later\r\n      file = Tempfile.new(["puppet_debugger_input", ".pp"])\r\n      File.open(file, "w") do |f|\r\n        f.write(input)\r\n      end\r\n      Puppet.override({ code: input, global_scope: scope, loaders: scope.compiler.loaders }, "For puppet-debugger") do\r\n        # because the repl is not a module we leave the modname blank\r\n        scope.environment.known_resource_types.import_ast(ast, "")\r\n        parser.evaluate_string(scope, input, File.expand_path(file))\r\n      end\r\n    end\r\n{code}\r\n\r\n\r\nhttps://github.com/nwops/puppet-debugger', 'https://tickets.puppetlabs.com/browse/PUP-7364', 'https://github.com/puppetlabs/puppet/pull/6017', '2017-03-16T09:59:05.000-0700', '2017-08-18T07:13:49.000-0700', '2017-08-18T07:13:49.000-0700', 'Closed', '', 7, '0', 1, 9, 2, 2, '4338876eda9904522d62ac55a03e7675a40b7d1f', 'https://tickets.puppetlabs.com/browse/PUP-7364', 'https://github.com/puppetlabs/puppet/pull/6017'),
('puppet', 164748, 97631149, 5423, 'Tidy and File cannot remove fifo or socket files', 'h4. Problem:\r\n\r\n(Reported to Customer Support)\r\n\r\nThe Tidy resource throws an error: "Error: Could not back up files of type socket." when managing /tmp and it encounters a socket file. Tidy then fails to remove anything else after it errors. However, Tidy should not be backing up any files given the backup attribute. \r\n\r\nThat kind of defeats the purpose of using the Tidy resource, doesn"t it? I understand about not being able to ensure special file existence (creation), but I would think special file absence should be easy. I was hoping Tidy would be the answer (it sure seems like it should) especially since I"m telling Puppet to not backup anything it"s deleting.\r\n\r\nWord.\r\n\r\nh4. Example:\r\n\r\nCreate a test file:\r\n\r\n{code}\r\npython -c "import socket as s; sock = s.socket(s.AF_UNIX); sock.bind("/tmp/testsocket")"\r\n{code}\r\n\r\nCreate a test:\r\n\r\n{code}\r\nclass test_tidy_tmp {\r\n  tidy {"/tmp":\r\n    age => "1w",\r\n    size => "1m",\r\n    backup => false,\r\n  }\r\n}\r\n\r\nnode default {\r\n  include test_tidy_tmp\r\n}\r\n{code}\r\n\r\nExecute the test:\r\n\r\n{code}\r\n[root@pe-201642-master ~]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201642-master.puppetdebug.vlan\r\nNotice: /Stage[main]/Test_tidy_tmp/Tidy[/tmp]: Tidying 1 file\r\nInfo: Applying configuration version "1480552981"\r\nError: Could not back up files of type socket\r\nError: /Stage[main]/Test_tidy_tmp/File[/tmp/testsocket]/ensure: change from socket to absent failed: Could not back up files of type socket\r\nNotice: /Stage[main]/Test_tidy_tmp/Tidy[/tmp]: Dependency File[/tmp/testsocket] has failures: true\r\nWarning: /Stage[main]/Test_tidy_tmp/Tidy[/tmp]: Skipping because of failed dependencies\r\nNotice: Applied catalog in 9.99 seconds\r\n{code}\r\n\r\nh4. Solutions:\r\n\r\nHere are two solutions, either solves the problem, I propose implementing both. \r\n\r\nh5. Modify Tidy to ignore/skip files it cannot manage via File resources\r\n\r\n{code}\r\ntom:puppet tom.kishel$ diff /tmp/tidy.rb  lib/puppet/type/tidy.rb\r\n259,263c259\r\n<\r\n<     # Exclude files that cannot be made into a file resource in mkfile.\r\n<     valid_file_resource_files = files.find_all { |f| ["directory", "file", "symlink"].include? File.ftype(f) }\r\n<\r\n<     found_files = valid_file_resource_files.find_all { |path| tidy?(path) }.collect { |path| mkfile(path) }\r\n---\r\n>     found_files = files.find_all { |path| tidy?(path) }.collect { |path| mkfile(path) }\r\n{code}\r\n\r\nExecute the solution test for Tidy:\r\n\r\n{code}\r\n[root@pe-201642-master ~]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201642-master.puppetdebug.vlan\r\nNotice: /Stage[main]/Test_tidy_tmp/Tidy[/tmp]: Tidying 0 files\r\nInfo: Applying configuration version "1480555895"\r\nNotice: Applied catalog in 9.99 seconds\r\n{code}\r\n\r\nResult: Success\r\n\r\nh5. Modify File to allow ensure => absent for (fifo and) socket\r\n\r\n{code}\r\ntom:puppet tom.kishel$ diff /tmp/file.rb  lib/puppet/type/file.rb  \r\n717c717\r\n<   # @raises [fail???] If the current file is one of %w{blockSpecial characterSpecial unknown} and can"t be removed.\r\n---\r\n>   # @raises [fail???] If the current file isn"t one of %w{file link directory} and can"t be removed.\r\n737c737\r\n<     when "link", "file", "fifo", "socket"\r\n---\r\n>     when "link", "file"\r\n740,741c740\r\n<       # Potentially: "blockSpecial", "characterSpecial", "unknown"\r\n<       self.fail "Could not remove file of type #{current_type}"\r\n---\r\n>       self.fail "Could not back up files of type #{current_type}"\r\n938,945c937,939\r\n<     if type == "directory" and force?\r\n<       # (#18110) Directories cannot be removed without :force, \r\n<       # so it doesn"t make sense to back them up unless using :force.\r\n<       true\r\n<     elsif type == "file" or type == "link"\r\n<       true\r\n<     else\r\n<       # Potentially: "blockSpecial", "characterSpecial", "fifo", "socket", "unknown"\r\n---\r\n>     if type == "directory" and not force?\r\n>       # (#18110) Directories cannot be removed without :force, so it doesn"t\r\n>       # make sense to back them up.\r\n946a941,942\r\n>     else\r\n>       true\r\n{code}\r\n\r\nCreate test files for File via Tidy:\r\n\r\n{code}\r\nmkfifo /tmo/testfifo\r\npython -c "import socket as s; sock = s.socket(s.AF_UNIX); sock.bind("/tmp/testsocket")"\r\n{code}\r\n\r\nExecute the solution test for File via Tidy:\r\n\r\n{code}\r\n[root@pe-201642-master tmp]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201642-master.puppetdebug.vlan\r\nNotice: /Stage[main]/Tmp_tidy/Tidy[/tmp]: Tidying 2 files\r\nInfo: Applying configuration version "1480616019"\r\nNotice: /Stage[main]/Tmp_tidy/File[/tmp/testfifo]/ensure: removed\r\nNotice: /Stage[main]/Tmp_tidy/File[/tmp/testsocket]/ensure: removed\r\nNotice: Applied catalog in 9.99 seconds\r\n{code}\r\n\r\nResult: Success\r\n\r\nCreate a test for just File:\r\n\r\n{code}\r\nnode default {\r\n  file {"/tmp/testfifo":\r\n    ensure => absent,\r\n    backup => false,\r\n  }\r\n\r\n  file {"/tmp/testsocket":\r\n    ensure => absent,\r\n    backup => false,\r\n  }\r\n}\r\n{code}\r\n\r\nExecute the solution test for just File:\r\n\r\n{code}\r\n[root@pe-201642-master ~]# puppet agent -t\r\nInfo: Using configured environment "production"\r\nInfo: Retrieving pluginfacts\r\nInfo: Retrieving plugin\r\nInfo: Loading facts\r\nInfo: Caching catalog for pe-201642-master.puppetdebug.vlan\r\nInfo: Applying configuration version "1480555713"\r\nNotice: /Stage[main]/Main/Node[default]/File[/tmp/testfifo]/ensure: removed\r\nNotice: /Stage[main]/Main/Node[default]/File[/tmp/testsocket]/ensure: removed\r\nNotice: Applied catalog in 9.99 seconds\r\n{code}\r\n\r\nResult: Success', 'https://tickets.puppetlabs.com/browse/PUP-6966', 'https://github.com/puppetlabs/puppet/pull/5423', '2016-12-01T14:35:09.000-0800', '2017-08-21T07:17:24.000-0700', '2017-08-21T07:17:24.000-0700', 'Closed', 'maintenance', 16, '0', 2, 43, 28, 2, '84c3b5ba4658cfe57cb4a7c290d5bcba6e05ad56', 'https://tickets.puppetlabs.com/browse/PUP-6966', 'https://github.com/puppetlabs/puppet/pull/5423'),
('puppet', 204703, 138531851, 6166, 'regexp"s with flags and slashes is incorrectly presented using %s and %p', 'The puppet {{StringFormatter}} relies on the ruby {{#inspect}} method when a regexp has flags. This is bad because a) the output is not consistent between different ruby versions, and b) the "/" character is incorrectly escaped. This leads to problems in other implementations where "/" isn"t used as a regexp delimiter at all.\r\n\r\nThe problem is minor because such regexps cannot be created from Puppet code (puppet doesn"t support flags).', 'https://tickets.puppetlabs.com/browse/PUP-7825', 'https://github.com/puppetlabs/puppet/pull/6166', '2017-08-09T08:51:23.000-0700', '2017-09-07T06:55:51.000-0700', '2017-09-07T06:55:51.000-0700', 'Closed', '', 1, '0', 3, 89, 16, 10, '5443043726107000de5bf35108e6900606c37043', 'https://tickets.puppetlabs.com/browse/PUP-7825', 'https://github.com/puppetlabs/puppet/pull/6166'),
('puppet', 202635, 132611364, 6089, 'Should not fall back to "server" for requesting file resources when "server_list" is specified', 'In general the server setting should be ignored when server_list is present.\r\n\r\nIn the case of PE HA, both "server" and "server_list" are present on a promoted replica, however the "server" is incorrectly the old master certname rather than the current master (the promoted replica) certname.\r\n\r\nThis is causing an issue on rebooted masters where the automatic puppet agent run on reboot fails, and each file resource request times out individually - currently causing the reboot test in CI to take 30+ minutes for the puppet agent run to complete and fail.', 'https://tickets.puppetlabs.com/browse/PUP-7804', 'https://github.com/puppetlabs/puppet/pull/6089', '2017-07-26T11:28:15.000-0700', '2017-09-07T13:26:19.000-0700', '2017-09-07T13:26:19.000-0700', 'Closed', '', 3, '0', 1, 45, 4, 2, 'e9e64612e2b58295367913c70ee218765cf91837', 'https://tickets.puppetlabs.com/browse/PUP-7804', 'https://github.com/puppetlabs/puppet/pull/6089'),
('puppet', 200387, 130491142, 6071, 'tests/loader.autoload_from_resource_type_decl.rb fails when the test crosses into a new day', 'If the test is running at just the right time, it can fail because the first check of the puppetserver log is in one days log file, and then if we cross into the next day, a check of the log file fails because the log has rotated into the next day.', 'https://tickets.puppetlabs.com/browse/PUP-7776', 'https://github.com/puppetlabs/puppet/pull/6071', '2017-07-13T11:34:24.000-0700', '2017-09-08T08:08:45.000-0700', '2017-09-08T08:08:45.000-0700', 'Closed', '', 4, '0', 1, 99, 37, 2, 'b6460615e9246f10722eeba0a17af55172647203', 'https://tickets.puppetlabs.com/browse/PUP-7776', 'https://github.com/puppetlabs/puppet/pull/6071'),
('puppet', 208437, 138492984, 6164, 'AIX 5.3 tests/resource/mount/mounted.rb failure', 'Aix 5.3 mount tests are failing.\r\n\r\nWe found the root cause: New 5.3 images are up and they use jfs2, not jfs. Updating the test suite should fix the issue', 'https://tickets.puppetlabs.com/browse/PUP-7893', 'https://github.com/puppetlabs/puppet/pull/6164', '2017-08-30T11:09:14.000-0700', '2017-09-12T08:52:22.000-0700', '2017-09-12T08:52:22.000-0700', 'Closed', '', 0, '0', 1, 1, 6, 1, '211b17d4659fc6c7db56836a9671b257c4e553c8', 'https://tickets.puppetlabs.com/browse/PUP-7893', 'https://github.com/puppetlabs/puppet/pull/6164'),
('puppet', 205220, 135360978, 6119, 'undefined method `from" for #<Puppet::Pops::Types::PStructType:0x6d4ca435>', 'The problem occurs when including a class that might look like the following:\r\n\r\n{code:puppet}\r\nclass test (\r\n  String $var,\r\n  Test::Options $opts\r\n) {\r\n}\r\n{code}\r\n\r\nLet"s assume that Test::Options is defined as:\r\n\r\n{code:puppet}\r\ntype Test::Options = Struct[{\r\n  var => String\r\n}]\r\n{code}\r\n\r\nIf the "var" parameter doesn"t get passed to the test class, an evaluation error would be generated as expected. This works indeed.\r\n\r\nHowever, one would expected to see the same evaluation error popping up if var is not specified in the "opts" hash, since it is required. Instead, the following error occurs:\r\n\r\n{noformat}\r\nError: Could not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Method call, undefined method `from" for #<Puppet::Pops::Types::PStructType:0x6d4ca435>\r\n{noformat}\r\n\r\nThis problem does not occur when using puppet apply (masterless).', 'https://tickets.puppetlabs.com/browse/PUP-7835', 'https://github.com/puppetlabs/puppet/pull/6119', '2017-08-11T04:00:31.000-0700', '2017-09-14T10:39:44.000-0700', '2017-09-14T10:39:44.000-0700', 'Closed', '', 3, '0', 3, 99, 131, 3, 'a7499fe1b27a175e03395ce61811da9a72ab96b3', 'https://tickets.puppetlabs.com/browse/PUP-7835', 'https://github.com/puppetlabs/puppet/pull/6119'),
('puppet', 196111, 125854902, 5987, 'ResourceExpression has incorrect offset when inside of an else block', 'The example used to create this failure is below. The service resource has an offset of 34, which is actually the start of the else keyword. It should be 45.\r\n\r\n{code}\r\nclass firewall {\r\n  if(true) {\r\n  } else {\r\n    service { "service":\r\n      ensure    => running\r\n    }\r\n  }\r\n}\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7668', 'https://github.com/puppetlabs/puppet/pull/5987', '2017-06-15T08:50:17.000-0700', '2017-09-14T10:39:46.000-0700', '2017-09-14T10:39:46.000-0700', 'Closed', '', 0, '0', 2, 848, 695, 5, 'f92c5d7e432d82d94c87750f4a8e8101bbe492e8', 'https://tickets.puppetlabs.com/browse/PUP-7668', 'https://github.com/puppetlabs/puppet/pull/5987'),
('puppet', 206857, 137018745, 6138, 'Module initialization code attempts to use GettextSetup before it has been required', 'In the recent refactor of the GettextSetup initialization code, a reference to the GettextSetup gem in the module initialization code was left unguarded, which means that sometimes (e.g. in Puppet Server unit tests), the method is called before GettextSetup has been required. This would also fail if GettextSetup had failed to load. We need to refactor this to behave correctly if GettextSetup is not present.', 'https://tickets.puppetlabs.com/browse/PUP-7857', 'https://github.com/puppetlabs/puppet/pull/6138', '2017-08-22T08:59:12.000-0700', '2017-09-14T10:39:49.000-0700', '2017-09-14T10:39:49.000-0700', 'Closed', '', 2, '0', 1, 6, 1, 1, '2065e34758cc45b1f700e68325ab037c2e60c91d', 'https://tickets.puppetlabs.com/browse/PUP-7857', 'https://github.com/puppetlabs/puppet/pull/6138'),
('puppet', 204698, 134919628, 6109, 'Regexp for String format specifier is not anchored at the end', 'When formatting strings in puppet and providing a format specifier such as "%s" or "%p", the regexp for validating that specifier is not anchored. Consequently, passing a specifier like "%strange" will succeed since the "%s" at the beginning fulfills the match.', 'https://tickets.puppetlabs.com/browse/PUP-7824', 'https://github.com/puppetlabs/puppet/pull/6109', '2017-08-09T08:08:57.000-0700', '2017-09-14T10:39:50.000-0700', '2017-09-14T10:39:50.000-0700', 'Closed', '', 0, '0', 2, 11, 4, 3, '2b4bb95bffa1916f2b0c09be6d0bd9b9e8ba106b', 'https://tickets.puppetlabs.com/browse/PUP-7824', 'https://github.com/puppetlabs/puppet/pull/6109'),
('puppet', 209447, 139691627, 6183, 'Puppet PRs failing travis against ruby 1.9.3 with `undefined method spec for nil:NilClass`', 'Travis is currently failing for all puppet PRs, regardless of branch, against ruby 1.9.3.\r\n\r\n{code}\r\nNoMethodError: undefined method `spec" for nil:NilClass\r\nAn error occurred while installing puppet (5.1.0), and Bundler cannot continue.\r\nMake sure that `gem install puppet -v "5.1.0"` succeeds before bundling.\r\n{code}\r\n\r\nThe failure looks like the following:\r\n{code}\r\n44.67s$ rvm use 1.9.3 --install --binary --fuzzy\r\nruby-1.9.3-p551 is not installed - installing.\r\nSearching for binary rubies, this might take some time.\r\nFound remote file https://rvm_io.global.ssl.fastly.net/binaries/ubuntu/14.04/x86_64/ruby-1.9.3-p551.tar.bz2\r\nChecking requirements for ubuntu.\r\nRequirements installation successful.\r\nruby-1.9.3-p551 - #configure\r\nruby-1.9.3-p551 - #download\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 13.3M  100 13.3M    0     0  45.9M      0 --:--:-- --:--:-- --:--:-- 46.1M\r\nruby-1.9.3-p551 - #validate archive\r\nruby-1.9.3-p551 - #extract\r\nruby-1.9.3-p551 - #validate binary\r\nruby-1.9.3-p551 - #setup\r\nruby-1.9.3-p551 - #gemset created /home/travis/.rvm/gems/ruby-1.9.3-p551@global\r\nUpdating rubygems-update\r\nFetching: rubygems-update-2.6.13.gem (100%)\r\nSuccessfully installed rubygems-update-2.6.13\r\nInstalling RubyGems 2.6.13\r\nRubyGems 2.6.13 installed\r\n=== 2.6.13 / 2017-08-27\r\nSecurity fixes:\r\n* Fix a DNS request hijacking vulnerability.\r\n  Fix by Samuel Giddins.\r\n* Fix an ANSI escape sequence vulnerability.\r\n  Fix by Evan Phoenix.\r\n* Fix a DOS vulernerability in the `query` command.\r\n  Fix by Samuel Giddins.\r\n* Fix a vulnerability in the gem installer that allowed\r\n  a malicious gem to overwrite arbitrary files.\r\n  Fix by Samuel Giddins.\r\n=== 2.6.12 / 2017-04-30\r\nBug fixes:\r\n* Fix test_self_find_files_with_gemfile to sort expected files. Pull\r\n  request #1880 by Kazuaki Matsuo.\r\n* Fix issue for MinGW / MSYS2 builds and testing. Pull request #1879 by\r\n  MSP-Greg.\r\n* Fix gem open to open highest version number rather than lowest. Pull\r\n  request #1877 by Tim Pope.\r\n* Add a test for requiring a default spec as installed by the ruby\r\n  installer. Pull request #1899 by Samuel Giddins.\r\n* Fix broken --exact parameter to gem command. Pull request #1873 by Jason\r\n  Frey.\r\n* [Installer] Generate backwards-compatible binstubs. Pull request #1904\r\n  by Samuel Giddins.\r\n* Fix pre-existing source recognition on add action. Pull request #1883 by\r\n  Jonathan Claudius.\r\n* Prevent negative IDs in output of #inspect. Pull request #1908 by Vít\r\n  Ondruch.\r\n* Allow Gem.finish_resolve to respect already-activated specs. Pull\r\n  request #1910 by Samuel Giddins.\r\n=== 2.6.11 / 2017-03-16\r\nBug fixes:\r\n* Fixed broken tests on ruby-head. Pull request #1841 by\r\n  SHIBATA Hiroshi.\r\n* Update vendored Molinillo to 0.5.7. Pull request #1859 by Samuel\r\n  Giddins.\r\n* Avoid activating Ruby 2.5 default gems when possible. Pull request #1843\r\n  by Samuel Giddins.\r\n* Use improved resolver sorting algorithm. Pull request #1856 by\r\n  Samuel Giddins.\r\n=== 2.6.10 / 2017-01-23\r\nBug fixes:\r\n* Fix `require` calling the wrong `gem` method when it is overridden.\r\n  Pull request #1822 by Samuel Giddins.\r\n=== 2.6.9 / 2017-01-20\r\nBug fixes:\r\n* Allow initializing versions with empty strings. Pull request #1767 by\r\n  Luis Sagastume.\r\n* Fix TypeError on 2.4. Pull request #1788 by Nobuyoshi Nakada.\r\n* Don"t output mkmf.log message if compilation didn"t fail. Pull request\r\n  #1808 by Jeremy Evans.\r\n* Fixed broken links and overzealous URL encoding in gem server. Pull\r\n  request #1809 by Nicole Orchard.\r\n* Update vendored Molinillo to 0.5.5. Pull request #1812 by Samuel\r\n  Giddins.\r\n* RakeBuilder: avoid frozen string issue. Pull request #1819 by Olle\r\n  Jonsson.\r\n=== 2.6.8 / 2016-10-29\r\nBug fixes:\r\n* Improve SSL verification failure message. Pull request #1751\r\n  by Eric Hodel.\r\n* Ensure `to_spec` falls back on prerelease specs. Pull request\r\n  #1755 by André Arko.\r\n* Update vendored Molinillo to 0.5.3. Pull request #1763 by\r\n  Samuel Giddins.\r\n=== 2.6.7 / 2016-09-26\r\nBug fixes:\r\n* Install native extensions in the correct location when using the\r\n  `--user-install` flag. Pull request #1683 by Noah Kantrowitz.\r\n* When calling `Gem.sources`, load sources from `configuration`\r\n  if present, else use the default sources. Pull request #1699\r\n  by Luis Sagastume.\r\n* Fail gracefully when attempting to redirect without a Location.\r\n  Pull request #1711 by Samuel Giddins.\r\n* Update vendored Molinillo to 0.5.1. Pull request #1714 by\r\n  Samuel Giddins.\r\n=== 2.6.6 / 2016-06-22\r\nBug fixes:\r\n* Sort installed versions to make sure we install the latest version when\r\n  running `gem update --system`. As a one-time fix, run\r\n  `gem update --system=2.6.6`. Pull request #1601 by David Radcliffe.\r\n=== 2.6.5 / 2016-06-21\r\nMinor enhancements:\r\n* Support for unified Integer in Ruby 2.4. Pull request #1618\r\n  by SHIBATA Hiroshi.\r\n* Update vendored Molinillo to 0.5.0 for performance improvements.\r\n  Pull request #1638 by Samuel Giddins.\r\nBug fixes:\r\n* Raise an explicit error if Signer#sign is called with no certs. Pull\r\n  request #1605 by Daniel Berger.\r\n* Update `update_bundled_ca_certificates` utility script for directory\r\n  nesting. Pull request #1583 by James Wen.\r\n* Fix broken symlink support in tar writer (+ fix broken test). Pull\r\n  request #1578 by Cezary Baginski.\r\n* Remove extension directory before (re-)installing. Pull request #1576\r\n  by Jeremy Hinegardner.\r\n* Regenerate test CA certificates with appropriate extensions. Pull\r\n  request #1611 by rhenium.\r\n* Rubygems does not terminate on failed file lock when not superuser. Pull\r\n  request #1582 by Ellen Marie Dash.\r\n* Fix tar headers with a 101 character name. Pull request #1612 by Paweł\r\n  Tomulik.\r\n* Add Gem.platform_defaults to allow implementations to override defaults.\r\n  Pull request #1644 by Charles Oliver Nutter.\r\n* Run Bundler tests on TravisCI. Pull request #1650 by Samuel Giddins.\r\n=== 2.6.4 / 2016-04-26\r\nMinor enhancements:\r\n* Use Gem::Util::NULL_DEVICE instead of hard coded strings. Pull request #1588\r\n  by Chris Charabaruk.\r\n* Use File.symlink on MS Windows if supported. Pull request #1418\r\n  by Nobuyoshi Nakada.\r\nBug fixes:\r\n* Redact uri password from error output when gem fetch fails. Pull request\r\n  #1565 by Brian Fletcher.\r\n* Suppress warnings. Pull request #1594 by Nobuyoshi Nakada.\r\n* Escape user-supplied content served on web pages by `gem server` to avoid\r\n  potential XSS vulnerabilities. Samuel Giddins.\r\n=== 2.6.3 / 2016-04-05\r\nMinor enhancements:\r\n* Lazily calculate Gem::LoadError exception messages. Pull request #1550\r\n  by Aaron Patterson.\r\n* New fastly cert. Pull request #1548 by David Radcliffe.\r\n* Organize and cleanup SSL certs. Pull request #1555 by James Wen.\r\n* [RubyGems] Make deprecation message for paths= more helpful. Pull\r\n  request #1562 by Samuel Giddins.\r\n* Show default gems when using "gem list". Pull request #1570 by Luis\r\n  Sagastume.\r\nBug fixes:\r\n* Stub ordering should be consistent regardless of how cache is populated.\r\n  Pull request #1552 by Aaron Patterson.\r\n* Handle cases when the @@stubs variable contains non-stubs. Pull request\r\n  #1558 by Per Lundberg.\r\n* Fix test on Windows for inconsistent temp path. Pull request #1554 by\r\n  Hiroshi Shirosaki.\r\n* Fix `Gem.find_spec_for_exe` picks oldest gem. Pull request #1566 by\r\n  Shinichi Maeshima.\r\n* [Owner] Fallback to email and userid when owner email is missing. Pull\r\n  request #1569 by Samuel Giddins.\r\n* [Installer] Handle nil existing executable. Pull request #1561 by Samuel\r\n  Giddins.\r\n* Allow two digit version numbers in the tests. Pull request #1575 by unak.\r\n=== 2.6.2 / 2016-03-12\r\nBug fixes:\r\n* Fix wrong version of gem activation for bin stub. Pull request #1527 by\r\n  Aaron Patterson.\r\n* Speed up gem activation failures. Pull request #1539 by Aaron Patterson.\r\n* Fix platform sorting in the resolver. Pull request #1542 by Samuel E.\r\n  Giddins.\r\n* Ensure we unlock the monitor even if try_activate throws. Pull request\r\n  #1538 by Charles Oliver Nutter.\r\n=== 2.6.1 / 2016-02-28\r\nBug fixes:\r\n* Ensure `default_path` and `home` are set for paths. Pull request #1513\r\n  by Aaron Patterson.\r\n* Restore but deprecate support for Array values on `Gem.paths=`. Pull\r\n  request #1514 by Aaron Patterson.\r\n* Fix invalid gem file preventing gem install from working. Pull request\r\n  #1499 by Luis Sagastume.\r\n=== 2.6.0 / 2016-02-26\r\nMinor enhancements:\r\n* RubyGems now defaults the `gem push` to the gem"s "allowed_push_host"\r\n  metadata setting.  Pull request #1486 by Josh Lane.\r\n* Update bundled Molinillo to 0.4.3. Pull request #1493 by Samuel E. Giddins.\r\n* Add version option to gem open command. Pull request #1483 by Hrvoje\r\n  Šimić.\r\n* Feature/add silent flag. Pull request #1455 by Luis Sagastume.\r\n* Allow specifying gem requirements via env variables. Pull request #1472\r\n  by Samuel E. Giddins.\r\nBug fixes:\r\n* RubyGems now stores `gem push` credentials under the host you signed-in for.\r\n  Pull request #1485 by Josh Lane.\r\n* Move `coding` location to first line. Pull request #1471 by SHIBATA\r\n  Hiroshi.\r\n* [PathSupport] Handle a regexp path separator. Pull request #1469 by\r\n  Samuel E. Giddins.\r\n* Clean up the PathSupport object. Pull request #1094 by Aaron Patterson.\r\n* Join with File::PATH_SEPARATOR in Gem.use_paths. Pull request #1476 by\r\n  Samuel E. Giddins.\r\n* Handle when the gem home and gem path arent set in the config file. Pull\r\n  request #1478 by Samuel E. Giddins.\r\n* Terminate TimeoutHandler. Pull request #1479 by Nobuyoshi Nakada.\r\n* Remove redundant cache. Pull request #1482 by Eileen M. Uchitelle.\r\n* Freeze `Gem::Version@segments` instance variable. Pull request #1487 by\r\n  Ben Dean.\r\n* Gem cleanup is trying to uninstall gems outside GEM_HOME and reporting\r\n  an error after it tries. Pull request #1353 by Luis Sagastume.\r\n* Avoid duplicated sources. Pull request #1489 by Luis Sagastume.\r\n* Better description for quiet flag. Pull request #1491 by Luis Sagastume.\r\n* Raise error if find_by_name returns with nil. Pull request #1494 by\r\n  Zoltán Hegedüs.\r\n* Find_files only from loaded_gems when using gemdeps. Pull request #1277\r\n  by Michal Papis.\r\n=== 2.5.2 / 2016-01-31\r\nBug fixes:\r\n* Fix memoization of Gem::Version#prerelease? Pull request #1125 by Matijs van\r\n  Zuijlen.\r\n* Handle trailing colons in GEM_PATH, by Damien Robert.\r\n* Improve the Gemfile `gemspec` method, fixing #1204 and #1033. Pull request\r\n  #1276 by Michael Papis.\r\n* Warn only once when a gemspec license is invalid. Pull request #1414 by Samuel\r\n  E. Giddins.\r\n* Check for exact constants before using them, fixing Ruby bug #11940. Pull\r\n  request #1438 by Nobuyoshi Nakada.\r\n* Fix building C extensions on Ruby 1.9.x on Windows. Pull request #1453 by Marie\r\n  Markwell.\r\n* Handle symlinks containing ".." correctly. Pull request #1457 by Samuel E.\r\n  Giddins.\r\nMinor enhancements:\r\n* Add `--no-rc` flag, which skips loading `.gemrc`. Pull request #1329 by Luis\r\n  Sagastume.\r\n* Allow basic auth to be excluded from `allowed_push_host`. By Josh Lane.\r\n* Add `gem list --exact`, which finds gems by string match instead of regex. Pull\r\n  request #1344 by Luis Sagastume.\r\n* Suggest alternatives when gem license is unknown. Pull request #1443 by Samuel\r\n  E. Giddins.\r\n* Print a useful error if a binstub expects a newer version of a gem than is\r\n  installed. Pull request #1407 by Samuel E. Giddins.\r\n* Allow the (supported) s3:// scheme to be used with `--source`. Pull request\r\n  #1416 by Dave Adams.\r\n* Add `--[no-]post-install-message` to `install` and `update`. Pull request #1162\r\n  by Josef Šimánek.\r\n* Add `--host` option to `yank`, providing symmetry with `pull`. Pull request\r\n  #1361 by Mike Virata-Stone.\r\n* Update bundled Molinillo to 0.4.1. Pull request #1452 by Samuel E. Giddins.\r\n* Allow calling `build` without ".gemspec". Pull request #1454 by Stephen\r\n  Blackstone.\r\n* Add support for `source` option on gems in Gemfile. Pull request #1355 by\r\n  Michael Papis.\r\n* Function correctly when string literals are frozen on Ruby 2.3. Pull request\r\n  #1408 by Samuel E. Giddins.\r\n=== 2.5.1 / 2015-12-10\r\nBug fixes:\r\n* Ensure platform sorting only uses strings. Affected binary installs on Windows.\r\n  Issue #1369 reported by Ryan Atball (among others).\r\n  Pull request #1375 by Samuel E. Giddins.\r\n* Revert PR #1332. Unable to reproduce, and nil should be impossible.\r\n* Gem::Specification#to_fullpath now returns .rb extensions when such a file\r\n  exists.  Pull request #1114 by y-yagi.\r\n* RubyGems now handles Net::HTTPFatalError instead of crashing.  Pull\r\n  request #1314 by Samuel E. Giddins.\r\n* Updated bundled Molinillo to 0.4.0.  Pull request #1322, #1396 by Samuel E.\r\n  Giddins.\r\n* Improved performance of spec loading by reducing likelihood of loading the\r\n  complete specification.  Pull request #1373 by Aaron Patterson.\r\n* Improved caching of requirable files  Pull request #1377 by Aaron Patterson.\r\n* Fixed activation of gems with development dependencies.  Pull request #1388\r\n  by Samuel E. Giddins.\r\n* RubyGems now uses the same Molinillo vendoring strategy as Bundler.  Pull\r\n  request #1397 by Samuel E. Giddins.\r\n* Fixed documentation of Gem::Requirement.parse.  Pull request #1398 by\r\n  Juanito Fatas.\r\n* RubyGems no longer warns when a prerelease gem has prerelease dependencies.\r\n  Pull request #1399 by Samuel E. Giddins.\r\n* Fixed Gem::Version documentation example.  Pull request #1401 by Guilherme\r\n  Goettems Schneider.\r\n* Updated documentation links to https://.  Pull request #1404 by Suriyaa\r\n  Kudo.\r\n* Fixed double word typo.  Pull request #1411 by Jake Worth.\r\n=== 2.5.0 / 2015-11-03\r\nMajor enhancements:\r\n* Added the Gem::Licenses class which provides a set of standard license\r\n  identifiers as set by spdx.org. This is now used by the\r\n  Gem::Specification#license attribute to try to standardize (though not\r\n  enforce) licenses set by gem authors.\r\n  Pull request #1249 by Kyle Mitchell.\r\nMinor enhancements:\r\n* Use Molinillo as the resolver library.  This is the same resolver as used by\r\n  Bundler.  Pull request #1189 by Samuel E. Giddins.\r\n* Add `--skip=gem_name` to Pristine command.  Pull request #1018 by windwiny.\r\n* The parsed gem dependencies file is now available via Gem.gemdeps following\r\n  Gem.use_gemdeps.  Pull request #1224 by Hsing-Hui Hsu, issue #1213 by\r\n  Michal Papis.\r\n* Moved description attribute to recommended for Gem::Specification.\r\n  Pull request #1046 by Michal Papis\r\n* Moved `Gem::Indexer#abbreviate` and `#sanitize` to `Gem::Specification`.\r\n  Pull request #1145 by Arthur Nogueira Neves\r\n* Cache Gem::Version segments for `#bump` and `#release`.\r\n  Pull request #1131 by Matijs van Zuijlen\r\n* Fix edge case in `levenshtein_distance` for comparing longer strings.\r\n  Pull request #1173 by Richard Schneeman\r\n* Remove duplication from List#to_a, improving from O(n^2) to O(n) time.\r\n  Pull request #1200 by Marc Siegel.\r\n* Gem::Specification.add_specs is deprecated and will be removed from version\r\n  3.0 with no replacement.  To add specs, install the gem, then reset the\r\n  cache.\r\n* Gem::Specification.add_spec is deprecated and will be removed from version\r\n  3.0 with no replacement.  To add specs, install the gem, then reset the\r\n  cache.\r\n* Gem::Specification.remove_spec is deprecated and will be removed from version\r\n  3.0 with no replacement.  To remove specs, uninstall the gem, then reset the\r\n  cache by calling Gem::Specification.reset.\r\n* Call Array#compact before calling Array#uniq for minor speed improvement in\r\n  the Gem::Specification#files method.\r\n  Pull request #1253 by Marat Amerov.\r\n* Use stringio instead of custom String classes.\r\n  Pull request #1250 by Petr Skocik.\r\n* Use URI#host instead of URI#hostname to retain backwards compatibility with\r\n  Ruby 1.9.2 and earlier in util library.\r\n  Pull request #1288 by Joe Rafaniello.\r\n* Documentation update for gem sources.\r\n  Pull request #1324 by Ilya Vassilevsky.\r\n* Documentation update for required_ruby_version.\r\n  Pull request #1321 by Matt Patterson.\r\n* Documentation update for gem update.\r\n  Pull request #1306 by Tim Blair.\r\n* Emit a warning on SRV resolve failure.\r\n  Pull request #1023 by Ivan Kuchin.\r\n* Allow duplicate dependencies between runtime and development.\r\n  Pull request #1032 by Murray Steele.\r\n* The gem env command now shows the user installation directory.\r\n  Pull request #1343 by Luis Sagastume.\r\n* The Gem::Platform#=== method now treats a nil cpu arch the same as "universal".\r\n  Pull request #1356 by Daniel Berger.\r\n* Improved memory performance in Gem::Specification.traverse.  Pull request\r\n  #1188 by Aaron Patterson.\r\n* RubyGems packages now support symlinks.  Pull request #1209 by Samuel E.\r\n  Giddins.\r\n* RubyGems no longer outputs mkmf.log if it does not exist.  Pull request\r\n  #1222 by Andrew Hooker.\r\n* Added Bitrig platform.  Pull request #1233 by John C. Vernaleo.\r\n* Improved error message for first-time RubyGems developers.  Pull request\r\n  #1241 by André Arko\r\n* Improved performance of Gem::Specification#load with cached specs.  Pull\r\n  request #1297 by Samuel E. Giddins.\r\n* Gem::RemoteFetcher allows users to set HTTP headers.  Pull request #1363 by\r\n  Agis Anastasopoulos.\r\nBug fixes:\r\n* Fixed Rake homepage url in example for Gem::Specification#homepage.\r\n  Pull request #1171 by Arthur Nogueira Neves\r\n* Don"t crash if partially uninstalled gem can"t be found.\r\n  Pull request #1283 by Cezary Baginski.\r\n* Test warning cleanup.\r\n  Pull request #1298 by Samuel E. Giddins.\r\n* Documentation fix for GemDependencyAPI.\r\n  Pull request #1308 by Michael Papis.\r\n* Fetcher now ignores ENOLCK errors in single threaded environments. This\r\n  handles an issue with gem installation on NFS as best we can. Addresses\r\n  issue #1176 by Ryan Moore.\r\n  Pull request #1327 by Daniel Berger.\r\n* Fix some path quoting issues in the test suite.\r\n  Pull request #1328 by Gavin Miller.\r\n* Fix NoMethodError in running ruby processes when gems are uninstalled.\r\n  Pull request #1332 by Peter Drake.\r\n* Fixed a potential NoMethodError for gem cleanup.\r\n  Pull request #1333 by Peter Drake.\r\n* Fixed gem help bug.\r\n  Issue #1352 reported by bogem, pull request #1357 by Luis Sagastume.\r\n* Remove temporary directories after tests finish.  Pull request #1181 by\r\n  Nobuyoshi Nokada.\r\n* Update links in RubyGems documentation.  Pull request #1185 by Darío Hereñú.\r\n* Prerelease gem executables can now be run.  Pull request #1186 by Samuel E.\r\n  Giddins.\r\n* Updated RubyGems travis-ci ruby versions.  Pull request #1187 by Samuel E.\r\n  Giddins.\r\n* Fixed release date of RubyGems 2.4.6.  Pull request #1190 by Frieder\r\n  Bluemle.\r\n* Fixed bugs in gem activation.  Pull request #1202 by Miklós Fazekas.\r\n* Fixed documentation for `gem list`.  Pull request #1228 by Godfrey Chan.\r\n* Fixed #1200 history entry.  Pull request #1234 by Marc Siegel.\r\n* Fixed synchronization issue when resetting the Gem::Specification gem list.\r\n  Pull request #1239 by Samuel E. Giddins.\r\n* Fixed running tests in parallel.  Pull request #1257 by SHIBATA Hiroshi.\r\n* Fixed running tests with `--program-prefix` or `--program-suffix` for ruby.\r\n  Pull request #1258 by Shane Gibbs.\r\n* Fixed Gem::Specification#to_yaml.  Pull request #1262 by Hiroaki Izu.\r\n* Fixed taintedness of Gem::Specification#raw_require_paths.  Pull request\r\n  #1268 by Sam Ruby.\r\n* Fixed sorting of platforms when installing gems.  Pull request #1271 by\r\n  nonsequitur.\r\n* Use `--no-document` over deprecated documentation options when installing\r\n  dependencies on travis.  Pull request #1272 by takiy33.\r\n* Improved support for IPv6 addresses in URIs.  Pull request #1275 by Joe\r\n  Rafaniello.\r\n* Spec validation no longer crashes if a file does not exist.  Pull request\r\n  #1278 by Samuel E. Giddins.\r\n* Gems can now be installed within `rescue`.  Pull request #1282 by Samuel E.\r\n  Giddins.\r\n* Increased Diffie-Hellman key size for tests for modern OpenSSL.  Pull\r\n  request #1290 by Vít Ondruch.\r\n* RubyGems handles invalid config files better.  Pull request #1367 by Agis\r\n  Anastasopoulos.\r\n=== 2.4.8 / 2015-06-08\r\nBug fixes:\r\n* Tightened API endpoint checks for CVE-2015-3900\r\n=== 2.4.7 / 2015-05-14\r\nBug fixes:\r\n* Limit API endpoint to original security domain for CVE-2015-3900.\r\n  Fix by claudijd\r\n=== 2.4.6 / 2015-02-05\r\nBug fixes:\r\n* Fixed resolving gems with both upper and lower requirement boundaries.\r\n  Issue #1141 by Jakub Jirutka.\r\n* Moved extension directory after require_paths to fix missing constant bugs\r\n  in some gems with C extensions.  Issue #784 by André Arko, pull request\r\n  #1137 by Barry Allard.\r\n* Use Gem::Dependency#requirement when adding a dependency to an existing\r\n  dependency instance.  Pull request #1101 by Josh Cheek.\r\n* Fixed warning of shadowed local variable in Gem::Specification.  Pull request\r\n  #1109 by Rohit Arondekar\r\n* Gem::Requirement should always sort requirements before coercion to Hash.\r\n  Pull request #1139 by Eito Katagiri.\r\n* The `gem open` command should change the current working directory before\r\n  opening the editor.  Pull request #1142 by Alex Wood.\r\n* Ensure quotes are stripped from the Windows launcher script used to install\r\n  gems.  Pull request #1115 by Youngjun Song.\r\n* Fixed errors when writing to NFS to to 0444 files.  Issue #1161 by Emmanuel\r\n  Hadoux.\r\n* Removed dead code in Gem::StreamUI.  Pull request #1117 by mediaslave24.\r\n* Fixed typos.  Pull request #1096 by hakeda.\r\n* Relaxed CMake dependency for RHEL 6 and CentOS 6.  Pull request #1124 by Vít\r\n  Ondruch.\r\n* Relaxed Psych dependency.  Pull request #1128 by Vít Ondruch.\r\n=== 2.4.5 / 2014-12-03\r\nBug fixes:\r\n* Improved speed of requiring gems.  (Around 25% for a 60 gem test).  Pull\r\n  request #1060 by unak.\r\n* RubyGems no longer attempts to look up gems remotely with the --local flag.\r\n  Pull request #1084 by Jeremy Evans.\r\n* Executable stubs use the correct gem version when RUBYGEMS_GEMDEPS is\r\n  active.  Issue #1072 by Michael Kaiser-Nyman.\r\n* Fixed handling of pinned gems in lockfiles with versions.  Issue #1078 by\r\n  Ian Ker-Seymer.\r\n* Fixed handling of git@example:gem.git URIs.  Issue #1054 by Mogutan Mogu.\r\n* Fixed handling of platforms retrieved from the dependencies API.  Issue\r\n  #1058 and patch suggestion by tux-mind.\r\n* RubyGems now suggests a copy-pasteable `gem pristine` command when\r\n  extensions are missing.  Pull request #1057 by Shannon Skipper.\r\n* Improved errors for long file names when packaging.  Pull request #1016 by\r\n  Piotrek Bator.\r\n* `gem pristine` now skips gems cannot be found remotely.  Pull request #1064\r\n  by Tuomas Kareinen.\r\n* `gem pristine` now caches gems to the proper directory.  Pull request #1064\r\n  by Tuomas Kareinen.\r\n* `gem pristine` now skips bundled gems properly.  Pull request #1064 by\r\n  Tuomas Kareinen.\r\n* Improved interoperability of Vagrant with RubyGems.  Pull request #1057 by\r\n  Vít Ondruch.\r\n* Renamed CONTRIBUTING to CONTRIBUTING.rdoc to allow markup.  Pull request\r\n  #1090 by Roberto Miranda.\r\n* Switched from #partition to #reject as only one collection is used.  Pull\r\n  request #1074 by Tuomas Kareinen.\r\n* Fixed installation of gems on systems using memory-mapped files.  Pull\r\n  request #1038 by Justin Li.\r\n* Fixed bug in Gem::Text#min3 where `a == b < c`.  Pull request #1026 by\r\n  fortissimo1997.\r\n* Fixed uninitialized variable warning in BasicSpecification.  Pull request\r\n  #1019 by Piotr Szotkowski.\r\n* Removed unneeded exception handling for cyclic dependencies.  Pull request\r\n  #1043 by Jens Wille.\r\n* Fixed grouped expression warning.  Pull request #1081 by André Arko.\r\n* Fixed handling of platforms when writing lockfiles.\r\n=== 2.4.4 / 2014-11-12\r\nBug fixes:\r\n* Add alternate Root CA for upcoming certificate change. Fixes #1050 by\r\n  Protosac\r\n=== 2.4.3 / 2014-11-10\r\nBug fixes:\r\n* Fix redefine MirrorCommand issue. Pull request #1044 by @akr.\r\n* Fix typo in platform= docs.  Pull request #1048 by @jasonrclark\r\n* Add root SSL certificates for upcoming certificate change.  Fixes #1050 by\r\n  Protosac\r\n------------------------------------------------------------------------------\r\nRubyGems installed the following executables:\r\n	/home/travis/.rvm/rubies/ruby-1.9.3-p551/bin/gem\r\nRubyGems system software updated\r\nruby-1.9.3-p551 - #importing gemset /home/travis/.rvm/gemsets/global.gems.....................................\r\nruby-1.9.3-p551 - #generating global wrappers........\r\nLatest version currently installed. Aborting.\r\nruby-1.9.3-p551 - #uninstalling gem rubygems-bundler-1.4.4.\r\nruby-1.9.3-p551 - #gemset created /home/travis/.rvm/gems/ruby-1.9.3-p551\r\nLatest version currently installed. Aborting.\r\nruby-1.9.3-p551 - #importing gemset /home/travis/.rvm/gemsets/default.gems...............\r\nruby-1.9.3-p551 - #generating default wrappers........\r\nUsing /home/travis/.rvm/gems/ruby-1.9.3-p551\r\nLatest version currently installed. Aborting.\r\n$ export BUNDLE_GEMFILE=$PWD/Gemfile\r\n$ ruby --version\r\nruby 1.9.3p551 (2014-11-13 revision 48407) [x86_64-linux]\r\n$ rvm --version\r\nrvm 1.29.2 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io/]\r\n$ bundle --version\r\nBundler version 1.7.6\r\n$ gem --version\r\n2.6.13\r\n28.27s$ bundle install --without development extra\r\nFetching gem metadata from https://rubygems.org/............\r\nResolving dependencies...\r\nInstalling rake 10.1.1\r\nInstalling CFPropertyList 2.3.5\r\nInstalling addressable 2.4.0\r\nInstalling ast 2.3.0\r\nInstalling builder 3.2.3\r\nInstalling safe_yaml 1.0.4\r\nInstalling crack 0.4.3\r\nInstalling diff-lcs 1.3\r\nInstalling facter 2.5.1\r\nInstalling fast_gettext 1.1.0\r\nInstalling locale 2.1.2\r\nInstalling text 1.3.1\r\nInstalling gettext 3.2.4\r\nInstalling gettext-setup 0.28\r\nInstalling hashdiff 0.3.6\r\nInstalling hiera 3.4.0\r\nInstalling highline 1.6.21\r\nInstalling trollop 2.1.2\r\nInstalling hiera-eyaml 2.1.0\r\nInstalling hocon 1.2.5\r\nInstalling json-schema 2.1.1\r\nInstalling metaclass 0.0.4\r\nInstalling mocha 0.10.5\r\nInstalling multi_json 1.7.7\r\nInstalling parser 2.4.0.0\r\nInstalling powerpack 0.1.1\r\nNoMethodError: undefined method `spec" for nil:NilClass\r\nAn error occurred while installing puppet (5.1.0), and Bundler cannot continue.\r\nMake sure that `gem install puppet -v "5.1.0"` succeeds before bundling.\r\n{code}\r\n\r\nA previous successful run looked like this:\r\n{code}\r\n$ rvm use 1.9.3 --install --binary --fuzzy\r\nruby-1.9.3-p551 is not installed - installing.\r\nSearching for binary rubies, this might take some time.\r\nFound remote file https://rvm_io.global.ssl.fastly.net/binaries/ubuntu/14.04/x86_64/ruby-1.9.3-p551.tar.bz2\r\nChecking requirements for ubuntu.\r\nRequirements installation successful.\r\nruby-1.9.3-p551 - #configure\r\nruby-1.9.3-p551 - #download\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 13.3M  100 13.3M    0     0  74.1M      0 --:--:-- --:--:-- --:--:-- 74.5M\r\nruby-1.9.3-p551 - #validate archive\r\nruby-1.9.3-p551 - #extract\r\nruby-1.9.3-p551 - #validate binary\r\nruby-1.9.3-p551 - #setup\r\nruby-1.9.3-p551 - #gemset created /home/travis/.rvm/gems/ruby-1.9.3-p551@global\r\nruby-1.9.3-p551 - #importing gemset /home/travis/.rvm/gemsets/global.gems.....................................\r\nruby-1.9.3-p551 - #generating global wrappers........\r\nruby-1.9.3-p551 - #uninstalling gem rubygems-bundler-1.4.4.\r\nruby-1.9.3-p551 - #gemset created /home/travis/.rvm/gems/ruby-1.9.3-p551\r\nruby-1.9.3-p551 - #importing gemset /home/travis/.rvm/gemsets/default.gems...............\r\nruby-1.9.3-p551 - #generating default wrappers........\r\nUsing /home/travis/.rvm/gems/ruby-1.9.3-p551\r\n$ export BUNDLE_GEMFILE=$PWD/Gemfile\r\n$ ruby --version\r\nruby 1.9.3p551 (2014-11-13 revision 48407) [x86_64-linux]\r\n$ rvm --version\r\nrvm 1.29.2 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io/]\r\n$ bundle --version\r\nBundler version 1.7.6\r\n$ gem --version\r\n2.4.3\r\ninstall.bundler\r\n18.57s$ bundle install --without development extra\r\nFetching gem metadata from https://rubygems.org/............\r\nResolving dependencies...\r\nInstalling rake 10.1.1\r\nInstalling CFPropertyList 2.3.5\r\nInstalling addressable 2.4.0\r\nInstalling ast 2.3.0\r\nInstalling builder 3.2.3\r\nInstalling safe_yaml 1.0.4\r\nInstalling crack 0.4.3\r\nInstalling diff-lcs 1.3\r\nInstalling facter 2.5.0\r\nInstalling fast_gettext 1.1.0\r\nInstalling locale 2.1.2\r\nInstalling text 1.3.1\r\nInstalling gettext 3.2.4\r\nInstalling gettext-setup 0.26\r\nInstalling hashdiff 0.3.5\r\nInstalling hiera 3.4.0\r\nInstalling highline 1.6.21\r\nInstalling trollop 2.1.2\r\nInstalling hiera-eyaml 2.1.0\r\nInstalling hocon 1.2.5\r\nInstalling json-schema 2.1.1\r\nInstalling metaclass 0.0.4\r\nInstalling mocha 0.10.5\r\nInstalling multi_json 1.7.7\r\nInstalling parser 2.4.0.0\r\nInstalling powerpack 0.1.1\r\nUsing puppet 5.0.1 from source at /home/travis/build/puppetlabs/puppet\r\nInstalling rainbow 2.1.0\r\nInstalling rdoc 4.3.0\r\nInstalling rspec-support 3.6.0\r\nInstalling rspec-core 3.6.0\r\nInstalling rspec-expectations 3.6.0\r\nInstalling rspec-mocks 3.6.0\r\nInstalling rspec 3.6.0\r\nInstalling rspec-collection_matchers 1.1.3\r\nInstalling rspec-its 1.2.0\r\nInstalling rspec-legacy_formatters 1.0.1\r\nInstalling ruby-progressbar 1.8.1\r\nInstalling unicode-display_width 1.3.0\r\nInstalling rubocop 0.39.0\r\nInstalling vcr 2.9.3\r\nInstalling webmock 1.24.6\r\nInstalling yard 0.9.9\r\nInstalling yarjuf 2.0.0\r\nUsing bundler 1.7.6\r\nYour bundle is complete!\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7920', 'https://github.com/puppetlabs/puppet/pull/6183', '2017-09-06T14:44:24.000-0700', '2017-09-14T10:39:51.000-0700', '2017-09-14T10:39:51.000-0700', 'Closed', '', 1, '0', 1, 7, 0, 1, '405ab53cd4d57633ec16c57f55d21a0539b1f5b7', 'https://tickets.puppetlabs.com/browse/PUP-7920', 'https://github.com/puppetlabs/puppet/pull/6183'),
('puppet', 206953, 137102318, 6140, '`puppet help` output contains untranslated subcommand summaries', 'Currently only some of the subcommands listed when running `puppet help` are translated. This is because only Puppet Faces pulled these summaries into standalone strings. Applications extract the summary from a large heredoc that provides the full help text for the subcommand. The full subcommand text should not be translated, but the summary messages should be, since `puppet help` is such a visible entry point for the software. We need to isolate the summary strings from the full subcommand help text.', 'https://tickets.puppetlabs.com/browse/PUP-7858', 'https://github.com/puppetlabs/puppet/pull/6140', '2017-08-22T14:13:09.000-0700', '2017-09-14T10:39:51.000-0700', '2017-09-14T10:39:51.000-0700', 'Closed', '', 1, '0', 1, 90, 39, 16, '634d629b2dd23df07907020bfc9f43013daf8738', 'https://tickets.puppetlabs.com/browse/PUP-7858', 'https://github.com/puppetlabs/puppet/pull/6140'),
('puppet', 134149, 137354929, 6150, 'On AIX, an already installed package is not updated when using "ensure => latest"', '{quote}\r\nOn AIX (reported on 7.1 TL3 SP5), when using "ensure => latest" on a package, puppet does not install the latest version available if the package (in this case, an older version) is already installed. If specifying a version number (i.e. 6.0.0.5), the package is updated to this version.\r\n\r\nBelow is a sample output of the command puppet uses to produce a list of packages and their version numbers:\r\n\r\n{code}\r\n#/usr/sbin/installp -L -d .\r\nEMC:EMC.CELERRA.aix.rte:6.0.0.5::I:C:::::b:EMC CELERRA AIX Support Software::::0::\r\nEMC:EMC.CELERRA.iscsi.rte:6.0.0.5::I:C:::::b:EMC CELERRA iSCSI Support Software::::0::\r\nEMC:EMC.CLARiiON.aix.rte:6.0.0.5::I:C:::::b:EMC CLARiiON AIX Support Software::::0::\r\nEMC:EMC.CLARiiON.fcp.MPIO.rte:6.0.0.5::I:C:::::b:EMC CLARiiON FCP MPIO Support Software::::0::\r\nEMC:EMC.CLARiiON.fcp.rte:6.0.0.5::I:T:::::b:EMC CLARiiON FCP Support Software::::0::\r\nEMC:EMC.CLARiiON.iscsi.rte:6.0.0.5::I:C:::::b:EMC CLARiiON iSCSI Support Software::::0::\r\nEMC:EMC.INVISTA.aix.rte:6.0.0.5::I:C:::::b:EMC INVISTA AIX Support Software::::0::\r\nEMC:EMC.INVISTA.fcp.MPIO.rte:6.0.0.5::I:C:::::b:EMC INVISTA FCP MPIO Support Software::::0::\r\nEMC:EMC.INVISTA.fcp.rte:6.0.0.5::I:T:::::b:EMC INVISTA FCP Support Software::::0::\r\nEMC:EMC.Symmetrix.aix.rte:6.0.0.5::I:C:::::b:EMC Symmetrix AIX Support Software::::0::\r\nEMC:EMC.Symmetrix.fcp.MPIO.rte:6.0.0.5::I:T:::::b:EMC Symmetrix FCP MPIO Support Software::::0::\r\nEMC:EMC.Symmetrix.fcp.rte:6.0.0.5::I:T:::::b:EMC Symmetrix FCP Support Software::::0::\r\nEMC:EMC.Symmetrix.iscsi.rte:6.0.0.5::I:T:::::b:EMC Symmetrix iSCSI Support Software::::0::\r\nEMC:EMC.XtremIO.aix.rte:6.0.0.5::I:T:::::b:EMC XtremIO AIX Support Software::::0::\r\nEMC:EMC.XtremIO.fcp.MPIO.rte:6.0.0.5::I:T:::::b:EMC XtremIO FCP MPIO Support Software::::0::\r\nEMC:EMC.XtremIO.fcp.rte:6.0.0.5::I:T:::::b:EMC XtremIO FCP Support Software::::0::\r\n{code}\r\n\r\nSo the version available to install is 6.0.0.5, version 6.0.0.3 is currently installed, but the newer version is not installed when using ensure => latest. When specifying 6.0.0.5 as the version, the package is updated.\r\n\r\n{quote}', 'https://tickets.puppetlabs.com/browse/PUP-6364', 'https://github.com/puppetlabs/puppet/pull/6150', '2016-05-26T16:04:27.000-0700', '2017-09-14T10:39:53.000-0700', '2017-09-14T10:39:53.000-0700', 'Closed', 'aix-parity;client-onboarding;manage-package', 8, '0', 1, 21, 4, 2, '2b3062a7578dce2cd356d3c4b334d6c95a2d4275', 'https://tickets.puppetlabs.com/browse/PUP-6364', 'https://github.com/puppetlabs/puppet/pull/6150'),
('puppet', 204514, 134918716, 6108, 'error string needs update for I18N support', 'While doing I18N testing I noticed this error message in the puppet.po file which should be updated for I18N\r\n\r\n#: ../lib/puppet/pops/issues.rb:755\r\nmsgid "\"#{label.a_an_uc(semantic)} resulted in a value outside of Puppet Integer #{range_end} range, got "#{\"%#+x\" % value}"\""\r\nmsgstr ""\r\n"\"#{ŀȧƀḗŀ.ȧ_ȧƞ_ŭƈ(şḗḿȧƞŧīƈ)} řḗşŭŀŧḗḓ īƞ ȧ ṽȧŀŭḗ ǿŭŧşīḓḗ ǿƒ Ƥŭƥƥḗŧ Īƞŧḗɠḗř "\r\n"#{řȧƞɠḗ_ḗƞḓ} řȧƞɠḗ, ɠǿŧ "#{\"%#+ẋ\" % ṽȧŀŭḗ}"\""\r\n\r\nAnd another\r\n\r\n#: ../lib/puppet/pops/issues.rb:444\r\nmsgid "\"#{label.article(actual_type)} #{actual_type}\""\r\nmsgstr ""\r\n\r\nAnd another\r\n\r\n"The string "#{before}" was automatically coerced to the numerical value #{after}"', 'https://tickets.puppetlabs.com/browse/PUP-7820', 'https://github.com/puppetlabs/puppet/pull/6108', '2017-08-08T08:52:23.000-0700', '2017-09-14T10:39:54.000-0700', '2017-09-14T10:39:54.000-0700', 'Closed', '', 0, '0', 1, 7, 5, 1, 'bc6e4c98452963c6ce93608235bbb57ad421b479', 'https://tickets.puppetlabs.com/browse/PUP-7820', 'https://github.com/puppetlabs/puppet/pull/6108'),
('puppet', 207528, 138161899, 6160, 'Enum accepts arguments that are not strings', '"Enum[foo, 1]" parses in ruby but not in java\r\ncom.puppet.pcore.TypeResolverException: Invalid parameter type specified: "Enum" requires parameter 1 to be a "String", Long provided\r\n\r\nI don"t how important this is.', 'https://tickets.puppetlabs.com/browse/PUP-7885', 'https://github.com/puppetlabs/puppet/pull/6160', '2017-08-25T10:44:33.000-0700', '2017-09-14T10:39:55.000-0700', '2017-09-14T10:39:55.000-0700', 'Closed', '', 4, '0', 1, 21, 0, 2, '2efe57f8285f7a37b7b5d464ef6ed540639a6bd9', 'https://tickets.puppetlabs.com/browse/PUP-7885', 'https://github.com/puppetlabs/puppet/pull/6160'),
('puppet', 206763, 136942478, 6137, 'Rich data is used for serializing symbols even when rich_data is not enabled.', 'When serializing the {{default}} value using the {{ToDataConverter}}/{{FromDataConverter}} pair, the value is serialized as:\r\n{code:json}\r\n{"key":{"__pcore_type__":"Default"}}\r\n{code}\r\neven when {{rich_data}} is not enabled.', 'https://tickets.puppetlabs.com/browse/PUP-7855', 'https://github.com/puppetlabs/puppet/pull/6137', '2017-08-22T02:43:34.000-0700', '2017-09-14T10:39:58.000-0700', '2017-09-14T10:39:58.000-0700', 'Closed', '', 0, '0', 2, 83, 4, 4, '2994068af388c1a8e41175e93ce618f228dc78dc', 'https://tickets.puppetlabs.com/browse/PUP-7855', 'https://github.com/puppetlabs/puppet/pull/6137'),
('puppet', 199845, 135295421, 6117, 'Heredoc is not accepted by the Puppet TypeParser', 'The following type definition results in an exception when parsed.\r\n{code:puppet}\r\nnotice(Type(@(TYPESPEC)))\r\nObject[{\r\n  attributes => {\r\n    text => {\r\n      type => String,\r\n      value => @(TEXT)\r\n        Some text\r\n        |TEXT\r\n    }\r\n  }\r\n}]\r\nTYPESPEC\r\n{code}\r\nThe following works OK though, since it is parsed by the evaluating parser.\r\n{code:puppet}\r\nnotice(Object[{\r\n  attributes => {\r\n    text => {\r\n      type => String,\r\n      value => @(TEXT)\r\n        Some text\r\n        |TEXT\r\n    }\r\n  }\r\n}])\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7768', 'https://github.com/puppetlabs/puppet/pull/6117', '2017-07-11T06:18:52.000-0700', '2017-09-14T10:39:59.000-0700', '2017-09-14T10:39:59.000-0700', 'Closed', '', 3, '0', 3, 21, 4, 2, '5767de39eb41a332dce1f3ffeb39b947b4fdeaf0', 'https://tickets.puppetlabs.com/browse/PUP-7768', 'https://github.com/puppetlabs/puppet/pull/6117'),
('puppet', 206993, 137165744, 6142, 'The Default type is not considered RichData', 'The {{Default}} type, which maps to the {{default}} keyword in the puppet language is not part of the {{RichData}} variant. This is wrong. It must be possible to pass the {{default}} as {{RichData}}.', 'https://tickets.puppetlabs.com/browse/PUP-7863', 'https://github.com/puppetlabs/puppet/pull/6142', '2017-08-23T01:42:22.000-0700', '2017-09-20T13:06:18.000-0700', '2017-09-20T13:06:18.000-0700', 'Closed', '', 0, '0', 1, 7, 3, 4, 'fce5bcdd9b7c54646770867379024f2c460750a4', 'https://tickets.puppetlabs.com/browse/PUP-7863', 'https://github.com/puppetlabs/puppet/pull/6142'),
('puppet', 206989, 137159821, 6141, 'Optional types are not assignable to Data and RichData', 'The implementation assumes that all values assignable to {{ScalarData}} also inherits from {{ScalarData}}. This means that an {{Optional}}, {{NotUndef}}, or {{Variant}} type that is limited to contain {{ScalarData}} types still isn"t assignable to {{ScalarData}}.\r\n\r\nThe same problem applies to {{Scalar}}.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7862', 'https://github.com/puppetlabs/puppet/pull/6141', '2017-08-22T23:52:40.000-0700', '2017-09-20T13:07:05.000-0700', '2017-09-20T13:07:05.000-0700', 'Closed', '', 0, '0', 1, 80, 25, 4, '416bbd1d27cbd92e9e9d7bf7aa58169b204aa837', 'https://tickets.puppetlabs.com/browse/PUP-7862', 'https://github.com/puppetlabs/puppet/pull/6141'),
('puppet', 196290, 126013165, 5993, 'Resource definition via Resource["string"] { "title": ... } fails in Puppet 4.10.3', 'We have been using the following snippet to generate a number of resources dynamically in an each loop for a while now without problems. After the upgrade to 4.10.3 this morning (including a restart of the Puppetserver) we get this error on multiple nodes\r\n\r\n{noformat}\r\nCould not retrieve catalog from remote server: Error 500 on SERVER: Server Error: Evaluation Error: Error while evaluating a Resource Statement, Unknown resource type: "Saltnetwork::Iptables::Service_chain::Icmp" at <location of Resource in snippet below>\r\n{noformat}\r\n\r\nThe files are still in the\r\n\r\n{code:puppet}\r\n  each([ "icmp"\r\n       , "ssh"\r\n       , "http"\r\n       , "http81"\r\n       , "https"\r\n       , "dhcp_client"\r\n       , "smtp"       \r\n       , "nrpe"\r\n       ]) |$service_chain| {\r\n    $service_chain_dashes = regsubst($service_chain, "_", "-", "G")\r\n    Resource["saltnetwork::iptables::service_chain::${service_chain}"] { "allow_${service_chain}":\r\n      rule_set_name => "common"\r\n    , rule_target  => { table => "filter", chain => "allow-${service_chain_dashes}", target => "ACCEPT" }\r\n    }                          \r\n  } \r\n\r\n{code}\r\n\r\nFor reference, the definition of the resource is in one of our module paths in saltnetwork/manifests/iptables/service_chain/icmp.pp\r\n\r\n\r\n{code:puppet}\r\ndefine saltnetwork::iptables::service_chain::icmp(\r\n    SaltNetwork::IPTables::Rule_Set_Name $rule_set_name\r\n  , SaltNetwork::IPTables::Rule_Target_Both $rule_target\r\n  , Boolean $return = true\r\n  ) {\r\n\r\n  $chain_name = $rule_target["chain"]\r\n\r\n  $table = saltnetwork::iptables::table_for_target($rule_target)\r\n\r\n  saltnetwork::iptables::custom_chain_both { "${rule_set_name}_${table}_${chain_name}":\r\n      rule_set_name => $rule_set_name\r\n    , table      => $table\r\n    , chain_name => $chain_name\r\n    , return     => $return\r\n  }\r\n\r\n  saltnetwork::iptables::rule_both { "${rule_set_name}_${table}_${chain_name}_icmp":\r\n      rule_set_name => $rule_set_name\r\n    , rule_order => 10\r\n    , rule_matches => [ { match => "iana_protocol", protocol => "icmp" } ]\r\n    , rule_target => $rule_target\r\n    , rule_comment => "ICMP"\r\n  }\r\n\r\n}\r\n\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7671', 'https://github.com/puppetlabs/puppet/pull/5993', '2017-06-16T01:29:12.000-0700', '2017-09-28T09:54:54.000-0700', '2017-09-28T09:54:54.000-0700', 'Closed', 'regression;resolved-issue-added', 10, '0', 1, 7, 0, 2, '013b7ffc4f1077aa20ae930d01547370d34f8754', 'https://tickets.puppetlabs.com/browse/PUP-7671', 'https://github.com/puppetlabs/puppet/pull/5993'),
('puppet', 195438, 125519094, 5980, '"Attempt to redefine entity" caused by upper/lower case name confusion in Loader', 'A load of a resource type will _sometimes_ create a {{Puppet::Pops::Loader::TypedName}} that starts with an uppercase letter. When this name is used in order to find a type generated with {{puppet generate types}}, it isn"t found. Since it"s not found, a load of the Ruby type is performed instead, which results in an "Attempt to redefine entity" error when that a successful load of the generated type has been performed earlier (with a {{TypedName}} that didn"t start with an uppercase letter).', 'https://tickets.puppetlabs.com/browse/PUP-7650', 'https://github.com/puppetlabs/puppet/pull/5980', '2017-06-12T07:02:24.000-0700', '2017-09-28T09:59:09.000-0700', '2017-09-28T09:59:09.000-0700', 'Closed', '', 6, '0', 1, 0, 2, 1, '6f0e92737e149408882a92732ab9b8c920343e34', 'https://tickets.puppetlabs.com/browse/PUP-7650', 'https://github.com/puppetlabs/puppet/pull/5980'),
('puppet', 204789, 135083080, 6113, 'TypeParser accepts Variant parameters that are not types.', 'The {{TypeParser}} class, used for parsing parameter types in Ruby dispatchers, allows parameters that are not types. The Puppet evaluator does however check that all parameters\r\nare types.\r\n\r\nThe behavior should be the same for both. It does not make sense for a Variant to accept parameters that are not types.', 'https://tickets.puppetlabs.com/browse/PUP-7829', 'https://github.com/puppetlabs/puppet/pull/6113', '2017-08-09T22:52:44.000-0700', '2017-10-02T06:14:12.000-0700', '2017-10-02T06:14:12.000-0700', 'Closed', '', 0, '0', 4, 39, 14, 10, '853465398dd92a5a4e79f69d6cedf07ff3b0fe98', 'https://tickets.puppetlabs.com/browse/PUP-7829', 'https://github.com/puppetlabs/puppet/pull/6113'),
('puppet', 203673, 136152346, 6128, 'Yum package provider: ensure => latest fails when packages update available', 'If one package is listed in the output of "yum check-update", any package update fails.\r\n\r\n{noformat}\r\n# puppet resource package kernel ensure=latest\r\nError: Could not get latest version: undefined method `[]" for nil:NilClass\r\nError: /Package[kernel]/ensure: change from 3.10.0-514.26.2.el7 to latest failed: Could not get latest version: undefined method `[]" for nil:NilClass\r\npackage { "kernel":\r\n  ensure => "3.10.0-514.26.2.el7",\r\n}\r\n{noformat}\r\n\r\n{noformat}\r\n\r\n# /bin/yum check-update\r\nLoaded plugins: enabled_repos_upload, fastestmirror, package_upload, product-id, search-disabled-repos, subscription-\r\n              : manager, tracer_upload\r\nKS_Centos_Centos_7_Base                                                                       | 2.1 kB  00:00:00     \r\nKS_Centos_Centos_7_Updates                                                                    | 2.5 kB  00:00:00     \r\nKS_Katello_Server_3_4                                                                         | 2.1 kB  00:00:00     \r\nLoading mirror speeds from cached hostfile\r\n\r\nforeman-installer-katello.noarch                          3.4.4-1.el7                           KS_Katello_Server_3_4\r\nkatello-debug.noarch                                      3.4.4-2.el7                           KS_Katello_Server_3_4\r\nkatello-installer-base.noarch                             3.4.4-1.el7                           KS_Katello_Server_3_4\r\nkatello-service.noarch                                    3.4.4-2.el7                           KS_Katello_Server_3_4\r\nUploading Enabled Reposistories Report\r\nLoaded plugins: fastestmirror, product-id\r\n\r\n{noformat}\r\n\r\n\r\n{noformat}\r\n# yum-config-manager --disable KS_Katello_Server_3_4\r\n{noformat}\r\n\r\n\r\n{noformat}\r\n# puppet resource  package kernel ensure=latest\r\npackage { "kernel":\r\n  ensure => "3.10.0-514.26.2.el7",\r\n}\r\n{noformat}\r\n\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7813', 'https://github.com/puppetlabs/puppet/pull/6128', '2017-08-02T10:24:00.000-0700', '2017-10-02T08:27:34.000-0700', '2017-10-02T08:27:34.000-0700', 'Closed', 'puppet-agent', 11, '0', 1, 47, 0, 3, 'b21b5ca230d9a8394d4aae7092ead8aba197499a', 'https://tickets.puppetlabs.com/browse/PUP-7813', 'https://github.com/puppetlabs/puppet/pull/6128'),
('puppet', 209323, 139567453, 6177, 'An Object Data Type with an unresolved parent causes an undefined method error', 'If an Object type is created with an unresolved parent type, this causes an unnamed anonymous class to be created which in turn results in the error an undefined error.\r\n\r\nThis error should normally never happen since the fact that the parent type is unresolved will be trapped by the evaluator. In order to this to happen, the unresolved parent must first be cloaked by having a string resolved into a {{TypeReference}}. Example:\r\n{code}$ bundle exec puppet apply -e "notice(Object[{name => "Bar", parent => Type("Foo")}].new)"\r\nError: Evaluation Error: Error while evaluating a Method call, undefined method `sub" for nil:NilClass  at line 1:54 on node localhost\r\n{code}\r\nThis however (which would be the common case) correctly reports the unresolved parent:\r\n{code}\r\n$ bundle exec puppet apply -e "notice(Object[{name => "Bar", parent => Foo}].new)"\r\nError: Evaluation Error: Resource type not found: Foo  at line 1:41 on node localhost\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7916', 'https://github.com/puppetlabs/puppet/pull/6177', '2017-09-06T04:25:43.000-0700', '2017-10-03T06:17:55.000-0700', '2017-10-03T06:17:55.000-0700', 'Closed', '', 2, '0', 4, 31, 6, 7, '3ed098c71f2f52f43f7e591d78f9d77aeee3626d', 'https://tickets.puppetlabs.com/browse/PUP-7916', 'https://github.com/puppetlabs/puppet/pull/6177'),
('puppet', 210150, 140418442, 6194, 'Remove documentation about "last" in scheduledtasks type', 'When trying to set a scheduled_task trigger I get the following error:\r\n\r\n{code}\r\nC:/Program Files/Puppet Labs/Puppet/puppet/bin/puppet:8:in `<main>"\r\nError: /Stage[main]/Adoberum::Service/Scheduled_task[Adobe Remote Update Manager\r\n]/ensure: change from absent to present failed: Failed to call #<Win32::TaskSche\r\nduler::COM::TaskTrigger:0x0000000872bd18>::SetTrigger with HRESULT: -2147024809.\r\n:  The parameter is incorrect.\r\n{code}\r\n\r\nThis happens for both month-by-date and month-by-weekday.\r\n\r\nMy scheduled_task resource is as follows:\r\n{code}\r\nscheduled_task { "Adobe Remote Update Manager":\r\n      ensure    => present,\r\n      command   => $adoberum::command_source,\r\n      enabled   => true,\r\n      trigger   => {schedule => monthly, on => [1,3,last,17], start_time => "08:00", months => [1, 3, 5]},\r\n    }\r\n{code}\r\n\r\nI"ve tried quoting and unquoting the parameter in the triggers hash. Works completely fine for daily and weekly triggers.\r\n\r\nThis has been tested on two different windows 7 machines with two different puppet version and the error is the same.\r\n\r\nFull Trace(from 3.7.4 Puppet):\r\n{code}\r\nError: Failed to call #<Win32::TaskScheduler::COM::TaskTrigger:0x0000000872bd18>\r\n::SetTrigger with HRESULT: -2147024809.:  The parameter is incorrect.\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/com.rb:142:in\r\n `block (3 levels) in []"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:966:in `block (2 levels) in populate_trigger"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:918:in `initialize"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:918:in `new"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:918:in `block in populate_trigger"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:917:in `initialize"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:917:in `new"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:917:in `populate_trigger"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:621:in `block (2 levels) in trigger="\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/com.rb:117:in\r\n `block in UseInstance"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/com.rb:114:in\r\n `initialize"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/com.rb:114:in\r\n `new"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/com.rb:114:in\r\n `UseInstance"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:620:in `block in trigger="\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:615:in `initialize"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:615:in `new"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/windows/taskscheduler\r\n.rb:615:in `trigger="\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/scheduled_task/wi\r\nn32_taskscheduler.rb:193:in `block in trigger="\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/scheduled_task/wi\r\nn32_taskscheduler.rb:188:in `each"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/scheduled_task/wi\r\nn32_taskscheduler.rb:188:in `trigger="\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/scheduled_task/wi\r\nn32_taskscheduler.rb:216:in `block in create"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/scheduled_task/wi\r\nn32_taskscheduler.rb:215:in `each"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/provider/scheduled_task/wi\r\nn32_taskscheduler.rb:215:in `create"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/property/ensure.rb:16:in `\r\nblock in defaultvalues"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/property.rb:197:in `call_v\r\naluemethod"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/property.rb:498:in `set"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/property.rb:581:in `sync"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harne\r\nss.rb:204:in `sync"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harne\r\nss.rb:128:in `sync_if_needed"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harne\r\nss.rb:81:in `perform_changes"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction/resource_harne\r\nss.rb:20:in `evaluate"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:204:in `app\r\nly"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:217:in `eva\r\nl_resource"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:147:in `cal\r\nl"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:147:in `blo\r\nck (2 levels) in evaluate"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:327:in `block in t\r\nhinmark"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/2.0.0/benchmark.rb:296:in\r\n`realtime"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:326:in `thinmark"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:147:in `blo\r\nck in evaluate"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/graph/relationship_graph.r\r\nb:118:in `traverse"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction.rb:138:in `eva\r\nluate"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/resource/catalog.rb:169:in\r\n `block in apply"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/log.rb:149:in `with_d\r\nestination"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/transaction/report.rb:112:\r\nin `as_logging_destination"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/resource/catalog.rb:168:in\r\n `apply"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:120:in `bloc\r\nk in apply_catalog"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:161:in `block in b\r\nenchmark"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/2.0.0/benchmark.rb:296:in\r\n`realtime"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:160:in `benchmark"\r\n\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:119:in `appl\r\ny_catalog"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:227:in `run_\r\ninternal"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:134:in `bloc\r\nk in run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/context.rb:64:in `override\r\n"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet.rb:244:in `override"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/configurer.rb:133:in `run"\r\n\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:47:in `block (4 l\r\nevels) in run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent/locker.rb:20:in `loc\r\nk"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:47:in `block (3 l\r\nevels) in run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:117:in `with_clie\r\nnt"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:44:in `block (2 l\r\nevels) in run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:82:in `run_in_for\r\nk"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:43:in `block in r\r\nun"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:179:in `cal\r\nl"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:179:in `con\r\ntrolled_run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/agent.rb:41:in `run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application/agent.rb:356:i\r\nn `onetime"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application/agent.rb:322:i\r\nn `run_command"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:381:in `blo\r\nck (2 levels) in run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:507:in `plu\r\ngin_hook"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:381:in `blo\r\nck in run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util.rb:488:in `exit_on_fa\r\nil"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/application.rb:381:in `run\r\n"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/command_line.rb:146:i\r\nn `run"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/lib/puppet/util/command_line.rb:92:in\r\n `execute"\r\nC:/Program Files/Puppet Labs/Puppet/puppet/bin/puppet:8:in `<main>"\r\nError: /Stage[main]/Adoberum::Service/Scheduled_task[Adobe Remote Update Manager\r\n]/ensure: change from absent to present failed: Failed to call #<Win32::TaskSche\r\nduler::COM::TaskTrigger:0x0000000872bd18>::SetTrigger with HRESULT: -2147024809.\r\n:  The parameter is incorrect.\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7933', 'https://github.com/puppetlabs/puppet/pull/6194', '2017-09-11T08:54:41.000-0700', '2017-10-03T06:17:59.000-0700', '2017-10-03T06:17:59.000-0700', 'Closed', 'hresult;monthly;scheduled_task;settrigger;windows', 5, '0', 1, 4, 5, 1, 'cebc038d4d0934e30eb77e9eaebf1b7a020fc05b', 'https://tickets.puppetlabs.com/browse/PUP-7933', 'https://github.com/puppetlabs/puppet/pull/6194'),
('puppet', 211486, 0, 0, 'acceptance: zypper reports errors when uninstalling apache2-worker on SLES 12 Power8', 'The puppet acceptance test resource/service/ticket_5024_systemd_enabling_masked_service.rb fails on the SLES 12 Power8 host with the following:\r\n\r\n{noformat}\r\n\r\npower8-sles12-3.ops.puppetlabs.net (sles12-POWER-1) 16:52:26$ zypper remove -y apache2 apache2-prefork apache2-worker libapr1 libapr-util1\r\n  Loading repository data...\r\n  Reading installed packages...\r\n  Package "apache2-worker" not found.\r\n  Resolving package dependencies...\r\n  \r\n  The following 5 packages are going to be REMOVED:\r\n    apache2 apache2-prefork apache2-utils libapr-util1 libapr1\r\n  5 packages to remove.\r\n  After the operation, 11.3 MiB will be freed.\r\n  Continue? [y/n/...? shows all options] (y): y\r\n  (1/5) Removing apache2-prefork-2.4.23-29.3.2.ppc64le [.  .  .  .  .  done]\r\n  (2/5) Removing apache2-2.4.23-29.3.2.ppc64le [.  .  .  .  .  done]\r\n  (3/5) Removing apache2-utils-2.4.23-29.3.2.ppc64le [.  .  .  .  .done]\r\n  (4/5) Removing libapr-util1-1.5.3-1.77.ppc64le [.  .  .  .  .done]\r\n  (5/5) Removing libapr1-1.5.1-2.7.ppc64le [.  .  .  .  .  done]\r\n  Installation has completed with error.\r\n\r\npower8-sles12-3.ops.puppetlabs.net (sles12-POWER-1) executed in 1.46 seconds\r\nExited: 104\r\nBeaker::Host::CommandFailure: Host "power8-sles12-3.ops.puppetlabs.net" exited with 104 running:\r\n zypper remove -y apache2 apache2-prefork apache2-worker libapr1 libapr-util1\r\nLast 10 lines of output were:\r\n	\r\n	5 packages to remove.\r\n	After the operation, 11.3 MiB will be freed.\r\n	Continue? [y/n/...? shows all options] (y): y\r\n	(1/5) Removing apache2-prefork-2.4.23-29.3.2.ppc64le [.....done]\r\n	(2/5) Removing apache2-2.4.23-29.3.2.ppc64le [.....done]\r\n	(3/5) Removing apache2-utils-2.4.23-29.3.2.ppc64le [.....done]\r\n	(4/5) Removing libapr-util1-1.5.3-1.77.ppc64le [.....done]\r\n	(5/5) Removing libapr1-1.5.1-2.7.ppc64le [.....done]\r\n	Installation has completed with error.\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/host.rb:375\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/dsl/helpers/host_helpers.rb:83\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/shared/host_manager.rb:127\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/dsl/patterns.rb:37\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/dsl/helpers/host_helpers.rb:63\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/tests/resource/service/ticket_5024_systemd_enabling_masked_service.rb:63\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_case.rb:146\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_case.rb:144\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_case.rb:144\r\n/home/sgarman/.rbenv/versions/2.3.3/lib/ruby/2.3.0/benchmark.rb:308\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_case.rb:130\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_suite.rb:66\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_suite.rb:63\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_suite.rb:63\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/test_suite.rb:112\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/cli.rb:205\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/lib/beaker/cli.rb:131\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/gems/beaker-3.24.0/bin/beaker:9\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/bin/beaker:22\r\n/home/sgarman/pl/wip/sles12p8-beaker/puppet/acceptance/vendor/bundle/ruby/2.3.0/bin/beaker:22\r\nEnd teardown\r\nWarning: tests/resource/service/ticket_5024_systemd_enabling_masked_service.rb errored in 24.28 seconds\r\n      Test Suite: tests @ 2017-09-18 16:52:03 +0000\r\n\r\n      - Host Configuration Summary -\r\n\r\n\r\n              - Test Case Summary for suite "tests" -\r\n       Total Suite Time: 24.28 seconds\r\n      Average Test Time: 24.28 seconds\r\n              Attempted: 1\r\n                 Passed: 0\r\n                 Failed: 0\r\n                Errored: 1\r\n                Skipped: 0\r\n                Pending: 0\r\n                  Total: 1\r\n\r\n      - Specific Test Case Status -\r\n        \r\nFailed Tests Cases:\r\nErrored Tests Cases:\r\n  Test Case tests/resource/service/ticket_5024_systemd_enabling_masked_service.rb reported: #<Beaker::Host::CommandFailure: Host "power8-sles12-3.ops.puppetlabs.net" exited with 104 running:\r\n zypper remove -y apache2 apache2-prefork apache2-worker libapr1 libapr-util1\r\n{noformat}\r\n\r\nIt seems that I can reproduce the failure with:\r\n\r\n\r\n{noformat}\r\nzypper in apache2-worker\r\nzypper rm apache2 apache2-prefork apache2-utils libapr-util1 libapr1\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7959', '', '2017-09-18T09:58:05.000-0700', '2017-10-03T06:17:59.000-0700', '2017-10-03T06:17:59.000-0700', 'Closed', '', 2, '0', 0, 0, 0, 0, '8bcaba7d90ea9115f6e89a6805d20f4c866c7f3f', 'https://tickets.puppetlabs.com/browse/PUP-7959', 'https://github.com/puppetlabs/puppet/commit/8bcaba7d90ea9115f6e89a6805d20f4c866c7f3f'),
('puppet', 209793, 141500683, 6208, 'vendored pathspec library has an over-reaching regexp', 'pathspec has a regular expression to match for Windows drive letters.\r\nIt is contains [a-zA-z] - which unintentionally also matches _, ^ and other non-letter characters between Z and a.\r\nSee https://github.com/highb/pathspec-ruby/pull/16 for the pull request for upstream pathspec-ruby.', 'https://tickets.puppetlabs.com/browse/PUP-7926', 'https://github.com/puppetlabs/puppet/pull/6208', '2017-09-08T09:08:27.000-0700', '2017-10-03T06:18:02.000-0700', '2017-10-03T06:18:02.000-0700', 'Closed', '', 6, '0', 1, 1, 1, 1, 'f5103faff14662e721cff951f3f0b881ec3e1fb5', 'https://tickets.puppetlabs.com/browse/PUP-7926', 'https://github.com/puppetlabs/puppet/pull/6208'),
('puppet', 213182, 143058907, 6234, 'Puppetserver errors reading pcore objects with non-english locale', '{code}\r\n$ puppet agent -t\r\nInfo: 設定された環境"production"を使用しています。\r\nInfo: pluginfactsを取得しています。\r\nInfo: pluginを取得しています。\r\nInfo: Loading facts\r\nError: リモートサーバからカタログを取得できませんでした: SERVERのエラー500 : サーバエラー: Evaluation Error: a Resource Statementの検証中にエラーが生じました。Evaluation Error: a Resource Statementの検証中にエラーが生じました。/etc/puppetlabs/code/environments/production/.resource_types/pe_anchor.ppからロードしたコードでは、リソースタイプ"pe_anchor"は作成されません - Puppet::Resource::ResourceType3.newに対するコールが見つかりませんでした。 at /opt/puppetlabs/puppet/modules/puppet_enterprise/manifests/init.pp:228:3 on node mom.puppet.vm\r\nWarning: 失敗したカタログではキャッシュを使用できません。\r\nError: カタログを取得できませんでした; 実行をスキップしています。\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-7992', 'https://github.com/puppetlabs/puppet/pull/6234', '2017-09-26T00:37:04.000-0700', '2017-10-03T06:18:02.000-0700', '2017-10-03T06:18:02.000-0700', 'Closed', '', 2, '0', 2, 21, 21, 14, '04dafbe12af7dbab79a7df246de4ba2df2ccabc4', 'https://tickets.puppetlabs.com/browse/PUP-7992', 'https://github.com/puppetlabs/puppet/pull/6234'),
('puppet', 211153, 141791492, 6213, 'Types with a trailing comma fail on 5.2.0', 'Type Aliases are broken if they include a trailing comma during testing on 5.2.0.\r\n\r\nI created a demo repository with a Travis hook right here: https://github.com/pegasd/puppet-broken_type\r\n\r\nAs you can see from the latest build, both types work fine under 5.1.0, but one of them (with a trailing comma) fails:\r\nhttps://travis-ci.org/pegasd/puppet-broken_type', 'https://tickets.puppetlabs.com/browse/PUP-7952', 'https://github.com/puppetlabs/puppet/pull/6213', '2017-09-15T06:46:21.000-0700', '2017-10-03T06:18:04.000-0700', '2017-10-03T06:18:04.000-0700', 'Closed', '', 3, '0', 1, 409, 379, 3, '41fd66ccf8995c13380fefe0ccda5ec479ecea41', 'https://tickets.puppetlabs.com/browse/PUP-7952', 'https://github.com/puppetlabs/puppet/pull/6213'),
('puppet', 205933, 135866287, 6124, 'A Puppet report from an interrupted run can cause exit_status to throw an exception', 'Recently when playing around with reports in irb, I discovered that the exit_status method raises an exception when called against a report from an interrupted (ctrl + c or other) puppet run.\r\n\r\n{code}\r\nirb(main):007:0> a.exit_status\r\nNoMethodError: undefined method `[]" for nil:NilClass\r\n        from /Users/matthaus/src/puppet/lib/puppet/transaction/report.rb:380:in `exit_status"\r\n        from (irb):7\r\n        from /usr/local/opt/ruby/bin/irb:11:in `<main>"\r\n{code}\r\n\r\nThe metrics instance variable is not fully populated for that report and the lookups performed in the exit_status method are not safe with respect to metrics being an empty hash.', 'https://tickets.puppetlabs.com/browse/PUP-7844', 'https://github.com/puppetlabs/puppet/pull/6124', '2017-08-15T11:43:24.000-0700', '2017-10-03T06:18:05.000-0700', '2017-10-03T06:18:05.000-0700', 'Closed', '', 3, '0', 1, 14, 3, 2, 'c2109da6e773a6abf502209764d3838dca5bd5d1', 'https://tickets.puppetlabs.com/browse/PUP-7844', 'https://github.com/puppetlabs/puppet/pull/6124'),
('puppet', 209004, 139176542, 6171, 'Heredoc with hyphen strips extra newlines', 'A heredoc set to [suppress the final line break|https://docs.puppet.com/puppet/5.1/lang_data_string.html#suppressing-the-final-line-break] also converts double line breaks into single line breaks.\r\n\r\n{code:title=Without suppression (END)}\r\n❯ cat test.pp \r\nnotice(@(END))\r\nline1\r\nline2\r\n\r\nline4\r\nEND\r\n❯ puppet apply test.pp \r\nNotice: Scope(Class[main]): line1\r\nline2\r\n\r\nline4\r\n\r\nNotice: Compiled catalog for marla.local in environment production in 0.03 seconds\r\nNotice: Applied catalog in 0.01 seconds\r\n{code}\r\n\r\n{code:title=With suppression (-END)}\r\n❯ cat test.pp \r\nnotice(@(END))\r\nline1\r\nline2\r\n\r\nline4\r\n-END\r\n❯ puppet apply test.pp\r\nNotice: Scope(Class[main]): line1\r\nline2\r\nline4\r\nNotice: Compiled catalog for marla.local in environment production in 0.03 seconds\r\nNotice: Applied catalog in 0.01 seconds\r\n{code}\r\n\r\n{{-END}} should only supress the final line break.', 'https://tickets.puppetlabs.com/browse/PUP-7902', 'https://github.com/puppetlabs/puppet/pull/6171', '2017-09-03T22:56:07.000-0700', '2017-10-03T11:24:21.000-0700', '2017-10-03T11:24:21.000-0700', 'Closed', '', 7, '0', 3, 31, 1, 2, 'be3c8ed4ac0ad30450b7992de5f50e4dfea77289', 'https://tickets.puppetlabs.com/browse/PUP-7902', 'https://github.com/puppetlabs/puppet/pull/6171'),
('puppet', 214086, 144262693, 6252, 'Performance regression with lots of modules and gettext', 'We"ve seen a ~30% reduction in compilation capacity with Puppet 5.3 (over Puppet 4.10). It appears to be related to gettext setup at https://github.com/puppetlabs/puppet/blob/master/lib/puppet/gettext/config.rb#L37-L69.\r\n\r\nWe haven"t fully isolated why, but the best guess is that code related to accessing modules during compilation is being called too frequently, and resulting in lots of disk-related activity.', 'https://tickets.puppetlabs.com/browse/PUP-8009', 'https://github.com/puppetlabs/puppet/pull/6252', '2017-10-02T10:16:24.000-0700', '2017-10-06T06:39:57.000-0700', '2017-10-06T06:39:57.000-0700', 'Closed', '', 10, '0', 2, 83, 21, 6, '80a499ad8b52d8f9a52688ee114365d75a870e2b', 'https://tickets.puppetlabs.com/browse/PUP-8009', 'https://github.com/puppetlabs/puppet/pull/6252'),
('puppet', 188421, 0, 0, 'YAML.load can be called on arbitrary input', 'The compiler will extract facts from the POST, and will deserialize using whatever format the user specifies. As a result, an attacker with a valid agent cert can cause the master to execute YAML.load on user specified input.', 'https://tickets.puppetlabs.com/browse/PUP-7483', '', '2017-04-28T11:50:04.000-0700', '2017-10-06T14:35:19.000-0700', '2017-10-06T14:35:19.000-0700', 'Closed', '', 6, '0', 0, 0, 0, 0, '06d8c51367ca932b9da5d9b01958cfc0adf0f2ea', 'https://tickets.puppetlabs.com/browse/PUP-7483', 'https://github.com/puppetlabs/puppet/commit/06d8c51367ca932b9da5d9b01958cfc0adf0f2ea'),
('puppet', 215883, 146244056, 6281, 'Tasks with an ensure parameter cause plan failure', 'When tasks that have an ensure parameter are used in a plan, they cause a stack trace.\r\n\r\nI am seeing this when using gcompute::instance in a plan on bolt 0.5.0', 'https://tickets.puppetlabs.com/browse/PUP-8046', 'https://github.com/puppetlabs/puppet/pull/6281', '2017-10-11T15:16:44.000-0700', '2017-10-27T16:03:39.000-0700', '2017-10-27T16:03:39.000-0700', 'Closed', '', 5, '0', 1, 266, 27, 3, 'a2cd1cc3789eaa3dae2e84a28dd901916215c283', 'https://tickets.puppetlabs.com/browse/PUP-8046', 'https://github.com/puppetlabs/puppet/pull/6281'),
('puppet', 18858, 132364827, 6086, 'Windows does not support :links :follow on symlinks', 'With the addition of Windows symlink support, interesting behavior was discovered with respect to setting `:link` to `:follow` instead of the default `:manage` behavior.\r\n\r\nThere is one test that verifies the existing behavior that was last active in 2010, and was re-enabled during the work on symlinks.  However, this test has been set to pending as Windows doesn"t have this support.\r\nhttps://github.com/puppetlabs/puppet/pull/1997/files#diff-dc02733a866500a00802c3dff20797c6R1342', 'https://tickets.puppetlabs.com/browse/PUP-745', 'https://github.com/puppetlabs/puppet/pull/6086', '2013-11-13T14:29:25.000-0800', '2017-10-30T14:49:28.000-0700', '2017-10-30T14:49:28.000-0700', 'Closed', '', 9, '0', 5, 184, 9, 2, 'd1dd6c7d6c068126c15d76653c31b68601219547', 'https://tickets.puppetlabs.com/browse/PUP-745', 'https://github.com/puppetlabs/puppet/pull/6086'),
('puppet', 19720, 406732902, 8107, 'Deprecate puppet inspect and the audit metaparameter', 'This was added for one customer and is no longer used or supported in PE.  We should deprecate it.  Per Eric0:\r\n\r\nRe: inspect/audit reports – no resistance, i put it out to sales, SE, support, PS and got no push-back. Please add it to the chopping block.', 'https://tickets.puppetlabs.com/browse/PUP-893', 'https://github.com/puppetlabs/puppet/pull/8107', '2013-11-26T11:47:29.000-0800', '2017-11-01T15:39:00.000-0700', '2017-11-01T15:39:00.000-0700', 'Closed', '', 21, '0', 1, 46, 2, 2, '2d8514a6e6c138d4a7f6db701bbf5d48e994c255', 'https://tickets.puppetlabs.com/browse/PUP-893', 'https://github.com/puppetlabs/puppet/pull/8107'),
('puppet', 212701, 145549061, 6271, 'Enable testing puppet-agent built against system openssl on RHEL in PA CI pipes', 'Testing PA built against system openssl thru CI has turned into quite a non-trivial exercise. First attempt resulted in some tests failing on the master host that CI sets up. Ironically, such agents have been able to get their certificate signed by the master fine when setup manually. \r\nThat led to reproducing the failure using beaker locally. Testing using beaker led to a different failure during the pre-suite/setup step of PA acceptance tests.\r\nManaged to overcome that by customizing pre-suite scripts in puppet. Now need to use this custom version of puppet when launching CI. Lets see how long this goes on... \r\nAll to get a PA CI test passing certificate to be able to submit PR in puppet to enable building against system openssl. ', 'https://tickets.puppetlabs.com/browse/PUP-7983', 'https://github.com/puppetlabs/puppet/pull/6271', '2017-09-22T13:43:00.000-0700', '2017-11-06T22:17:25.000-0800', '2017-11-06T22:17:25.000-0800', 'Closed', '', 5, '0', 7, 130, 681, 12, '', 'https://tickets.puppetlabs.com/browse/PUP-7983', 'https://github.com/puppetlabs/puppet/pull/6271'),
('puppet', 217917, 148271542, 6300, 'NTFS reparse points return invalid path data strings for mount points (like those in a DFS share)', 'While investigating MODULES-4934, it was realized that NTFS reparse points inside of DFS mounts were using an inappropriate data structure.\r\n\r\nThis would result in {{Puppet::Util::Windows::File.resolve_symlink}} returning a path string missing the first 4 bytes (and reading an extra 4 bytes of junk data off the end of the buffer).\r\n\r\nIn short, DFS shares with reparse points never work in Puppet properly.  A simple repro scenario is to use a file resource in Puppet to recursively copy from a DFS path (that contains the default hidden reparse point to the host drives {{C:\\Volume Information}}) like:\r\n\r\n{code}\r\nfile { "c:/Share1-test":\r\n     ensure  => directory,\r\n     recurse => true,\r\n     source  => "//dfsdemo.local/Puppet/TestShare",\r\n     source_permissions => "ignore"\r\n }\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8083', 'https://github.com/puppetlabs/puppet/pull/6300', '2017-10-23T16:43:01.000-0700', '2017-11-07T07:18:52.000-0800', '2017-11-07T07:18:52.000-0800', 'Closed', '', 5, '0', 3, 35, 4, 1, '487a1944ef57903f2354042fae579c272ab278e8', 'https://tickets.puppetlabs.com/browse/PUP-8083', 'https://github.com/puppetlabs/puppet/pull/6300'),
('puppet', 211143, 144557419, 6261, 'agent - server setup - file bucketing for binary files fails in case same file is bucketed for 2 different paths', 'Scenario: Puppet Agent is bucketing file to Puppetserver\r\n\r\nFollowing scenario (but in agent-server) configuration should show the error:\r\npuppet apply -e "file { "/tmp/d1/file1": source => "/usr/bin/at" }"\r\n\r\npuppet apply -e "file { "/tmp/d1/file1": source => "/usr/bin/bash" }"\r\n# file1 already exists, so it is bucketed before rewritten by contents of "bash"\r\n\r\npuppet apply -e "file { "/tmp/d2/file2": source => "/usr/bin/at" }"\r\n\r\npuppet apply -e "file { "/tmp/d2/file2": source => "/usr/bin/bash" }"\r\n# file2 already exists, so it is bucketed before rewritten by contents of "bash". It is bucketed to same directory on server because md5 hash of file2 is same as md5 hash of bucketed file1. And bucketing fails.\r\n\r\n\r\nIn theory this should work. And for local bucketing it works. \r\nThere are 2 artefacts on server for each bucketed file - contents and paths. Paths contains all paths where contents was stored on origin system.\r\n\r\nWhen file is bucketed there are multiple checks - size, md5 hash and file to be bucketed is byte-to-byte compared with already bucketed file.\r\n\r\nIn case that given file is bucketed (file with md5sum hash exists on server) and path on origin system is different to path stored in "paths" than there are 2 checks - size of bucketed file and checksum. Size is compared between data of file received over network from agent and existing "contents" on server.\r\n\r\nThe problem is, that this comparison usually fails because encoding of data received over network are "UTF-8" encoded and contents is "like" plain bytes. So size doesn"t match and it is considered error and processing of file resource fails.\r\n\r\nFor puppet-agent-1.10.4-1.el7.x86_64 rpm:\r\nComparison is in: method Puppet::FileBucketFile::File.verify_identical_file()\r\nbucket_file is: Puppet::FileBucket::File::StringContents\r\n\r\nSolution should be to ensure size of data received over network to be converted to something like "ASCII-8BIT" encoding even for "size" operation.', 'https://tickets.puppetlabs.com/browse/PUP-7951', 'https://github.com/puppetlabs/puppet/pull/6261', '2017-09-15T00:42:04.000-0700', '2017-11-07T07:18:55.000-0800', '2017-11-07T07:18:55.000-0800', 'Closed', '', 7, '0', 1, 21, 6, 2, '22356dc60a112aeb0f6861d32ddae6799ab8ed2c', 'https://tickets.puppetlabs.com/browse/PUP-7951', 'https://github.com/puppetlabs/puppet/pull/6261'),
('puppet', 217192, 147525287, 6290, 'Class documentation for PBinaryType is copy/pasted and incorrect', 'The [class documentation|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/pops/types/p_binary_type.rb#L5-L6] for the {{PBinaryType}} is copied verbatim from the {{PVersionType}}. It should be changed to describe the {{Binary}} data type.', 'https://tickets.puppetlabs.com/browse/PUP-8071', 'https://github.com/puppetlabs/puppet/pull/6290', '2017-10-19T03:31:05.000-0700', '2017-11-07T07:18:56.000-0800', '2017-11-07T07:18:56.000-0800', 'Closed', '', 1, '0', 1, 9, 2, 1, 'baf560a3dfc7ee99268dc723fe788e417308977f', 'https://tickets.puppetlabs.com/browse/PUP-8071', 'https://github.com/puppetlabs/puppet/pull/6290'),
('puppet', 52980, 144486500, 6258, 'nagios_contact no longer is able to parse utf-8 from nagios config files', 'Our manifest used to work with Ubuntu precise 12.04 amd64. I upgraded ubuntu, which upgraded ruby. That should be the limit of the changes to the environment.\r\n\r\nRepeatedly applying the attached manifest results in the output below:\r\n{quote}\r\n# puppet apply test.pp \r\nNotice: Compiled catalog for monitor.corp.zenrobotics.com in environment production in 0.04 seconds\r\nError: Could not convert change "alias" to string: incompatible character encodings: ASCII-8BIT and UTF-8\r\nError: Could not convert change "alias" to string: incompatible character encodings: ASCII-8BIT and UTF-8\r\nError: /Stage[main]/Main/Nagios_contact[ptman]: Could not evaluate: Puppet::Util::Log requires a message\r\nNotice: Finished catalog run in 0.34 seconds\r\nError: Could not write report for monitor.corp.zenrobotics.com at /var/lib/puppet/reports/monitor.corp.zenrobotics.com/201409301029.yaml: incompatible character encodings: ASCII-8BIT and UTF-8\r\nError: Could not send report: incompatible character encodings: ASCII-8BIT and UTF-8\r\n{quote}\r\n\r\nIf the accented character are removed or replaced, the errors go away. But trying to apply the manifest with utf-8 again results in no errors on the first run, and the same error on subsequent runs, which leads me to believe that the problem is in the provider parsing the current state of the config files.', 'https://tickets.puppetlabs.com/browse/PUP-3368', 'https://github.com/puppetlabs/puppet/pull/6258', '2014-09-30T03:35:04.000-0700', '2017-11-07T07:18:56.000-0800', '2017-11-07T07:18:56.000-0800', 'Closed', 'encoding;naginator;nagios;utf-8', 8, '0', 1, 23, 3, 3, '4eb814703cb04dd8b6af4d74e90072f30cc4bd77', 'https://tickets.puppetlabs.com/browse/PUP-3368', 'https://github.com/puppetlabs/puppet/pull/6258'),
('puppet', 178810, 141899949, 6214, 'classes do not honor refresh events when running with tags ', 'It appears that classes are not inheriting tags properly when included, but their resources are. This breaks notifying a class when running with --tags, and results in the relevant resources not getting the notify.\r\n\r\ntagsbug.pp:\r\n\r\n\r\n{noformat}\r\nclass foo {\r\n  exec { "notify test":\r\n    command     => "/bin/true",\r\n    refreshonly => true,\r\n  }\r\n}\r\n\r\nclass test {\r\n  include foo\r\n\r\n  exec { "test":\r\n    command => "/bin/true",\r\n    #notify  => Class["foo"],\r\n    notify  => Exec["notify test"],\r\n  }\r\n}\r\n\r\ninclude test\r\n\r\n\r\n{noformat}\r\n\r\nRunning: puppet apply --test --tags test tagsbug.pp\r\n\r\nWith Exec["test"] notifying Exec["notify test"]:\r\n\r\n\r\n{noformat}\r\nInfo: Applying configuration version "1488579119"\r\nNotice: /Stage[main]/Test/Exec[test]/returns: executed successfully\r\nInfo: /Stage[main]/Test/Exec[test]: Scheduling refresh of Exec[notify test]\r\nNotice: /Stage[main]/Foo/Exec[notify test]: Triggered "refresh" from 1 events\r\nInfo: Class[Foo]: Unscheduling all events on Class[Foo]\r\nInfo: Stage[main]: Unscheduling all events on Stage[main]\r\n{noformat}\r\n\r\nWith Exec["test"] notifying Class["foo"]:\r\n\r\n\r\n{noformat}\r\nInfo: Applying configuration version "1488579147"\r\nNotice: /Stage[main]/Test/Exec[test]/returns: executed successfully\r\nInfo: /Stage[main]/Test/Exec[test]: Scheduling refresh of Class[Foo]\r\nInfo: Class[Foo]: Unscheduling all events on Class[Foo]\r\nInfo: Stage[main]: Unscheduling all events on Stage[main]\r\n{noformat}\r\n\r\nExec["notify test"] does not get notified/run. Looking at the --debug output:\r\n\r\n\r\n{noformat}\r\nDebug: Class[Foo]: Not tagged with test\r\nDebug: Class[Foo]: Resource is being skipped, unscheduling all events\r\n{noformat}\r\n\r\n\r\nIs this expected behavior?  I even tried replacing "include foo" with:\r\n\r\n{noformat}\r\n class { "foo":\r\n   tag => "test",\r\n }\r\n{noformat}\r\n\r\nbut the behavior of sending a notify to Class["foo"] is the same (it\r\ndoes not trigger Exec["notify test"]).\r\n\r\n*Notes*\r\n* Initial guess was that this was due to use of `include` instead of `contain` but it was determined that `contain`ed classes also fail to properly refresh events\r\n* Internally, classes (containers) are replaced in the graph with whit "resources" (see https://github.com/puppetlabs/puppet/blob/ebd96213cab43bb2a8071b7ac0206c3ed0be8e58/lib/puppet/graph/relationship_graph.rb#L230-L273)\r\n* it"s possible tags are not correctly being propagated or evaluated to these resources ', 'https://tickets.puppetlabs.com/browse/PUP-7308', 'https://github.com/puppetlabs/puppet/pull/6214', '2017-03-06T12:30:30.000-0800', '2017-11-07T07:18:57.000-0800', '2017-11-07T07:18:57.000-0800', 'Closed', 'tags;the-goods', 20, '0', 4, 56, 2, 3, 'c2494f3063ac8c41a6e5f8388acfbd0f96ee52a4', 'https://tickets.puppetlabs.com/browse/PUP-7308', 'https://github.com/puppetlabs/puppet/pull/6214'),
('puppet', 206127, 140223462, 6189, 'Capitals in variable names in EPP templates hang threads forever', 'Hi,\r\n\r\nThe following EPP snippet compiles with no issues and in a timely manner\r\n\r\n{noformat}\r\nUSER="<%= $hg_oais::archivematica::requirements::automation_tools::user %>"\r\n{noformat}\r\n\r\nhowever this one (note the capitals) ends up in a catalog request that never finishes, indefinitely consuming 100% CPU in the thread where the jRuby instance assigned to compile is running.\r\n\r\n{noformat}\r\nUSER="<%= $hg_oais::archivematica::requirements::automation_tools::USER %>"\r\n{noformat}\r\n\r\nNo timeouts/errors master-side, nothing, just huge CPU usage forever.\r\n\r\nThe variable name ought have no capitals indeed but the master should either fail or resolve to empty, but never hang.\r\n\r\nWe"re using Puppet agent 1.9.3 (Puppet 4.9.4) and Puppetserver 2.7.2. No attempts to hit the bug using Puppetserver5 were made so far.\r\n\r\n!2.png|thumbnail! shows how two threads that had to compile that code have been consuming a large amount of CPU hours. That time roughly matches the time lapsed between the moment when the compilation request was issued and the time when the screenshot was taken. We don"t see that pattern on masters that never saw that snippet.\r\n\r\nCould you please try to reproduce the issue?\r\n\r\nThanks.\r\n\r\n(CERN internal reference: AI-4900)', 'https://tickets.puppetlabs.com/browse/PUP-7848', 'https://github.com/puppetlabs/puppet/pull/6189', '2017-08-16T05:55:51.000-0700', '2017-11-07T19:42:15.000-0800', '2017-11-07T19:42:15.000-0800', 'Closed', '', 25, '0', 2, 19, 3, 3, '0619eda2fde1d6343070b859836b887689765e91', 'https://tickets.puppetlabs.com/browse/PUP-7848', 'https://github.com/puppetlabs/puppet/pull/6189'),
('puppet', 155267, 96839183, 5413, 'service should check for smf service first', 'The service provider should check for the smf service first and exit with a more informative message if it does not exist. ', 'https://tickets.puppetlabs.com/browse/PUP-6797', 'https://github.com/puppetlabs/puppet/pull/5413', '2016-10-05T12:45:06.000-0700', '2017-11-12T19:06:14.000-0800', '2017-11-12T19:06:14.000-0800', 'Closed', 'maintenance', 4, '0', 2, 17, 131, 5, '3d7a3c4c1c6697047ae356c8765928f68618bc69', 'https://tickets.puppetlabs.com/browse/PUP-6797', 'https://github.com/puppetlabs/puppet/pull/5413'),
('puppet', 219740, 149878231, 6328, 'puppet device cannot create certs when run as root (5.3.x backport)', 'Backport fix into 5.3.x\r\n\r\nbroken -- output of `puppet device --debug` when ran as root:\r\n{noformat}\r\ninfo: Creating a new SSL key for 10.0.1.3\r\nerr: Could not request certificate: Could not write /var/opt/lib/pe-puppet/devices/10.0.1.3/ssl/private_keys/10.0.1.3.pem to privatekeydir: Permission denied - /var/opt/lib/pe-puppet/devices/10.0.1.3/ssl/private_keys/10.0.1.3.pem\r\n{noformat}\r\n\r\nsuccess -- output of `puppet device --debug` when ran as a normal user:\r\n{noformat}\r\nwarning: peer certificate won"t be verified in this SSL session\r\ninfo: Caching certificate for ca\r\nwarning: peer certificate won"t be verified in this SSL session\r\nwarning: peer certificate won"t be verified in this SSL session\r\ninfo: Creating a new SSL certificate request for 10.0.1.3\r\ninfo: Certificate Request fingerprint (md5): 6C:1C:4C:37:A7:1D:B3:6E:F3:94:25:67:55:27:89:4C\r\nwarning: peer certificate won"t be verified in this SSL session\r\ndebug: Using cached certificate for ca\r\nwarning: peer certificate won"t be verified in this SSL session\r\ninfo: Caching certificate for 10.0.1.3\r\n{noformat}\r\n\r\nNote, that you have to copy `/etc/puppetlabs/puppet/device.conf` to `~/.puppet/`', 'https://tickets.puppetlabs.com/browse/PUP-8109', 'https://github.com/puppetlabs/puppet/pull/6328', '2017-10-31T10:47:02.000-0700', '2017-11-16T16:05:18.000-0800', '2017-11-16T16:05:18.000-0800', 'Closed', 'redmine', 0, '0', 1, 2, 0, 1, '', 'https://tickets.puppetlabs.com/browse/PUP-8109', 'https://github.com/puppetlabs/puppet/pull/6328'),
('puppet', 46677, 19416141, 2945, 'PMT fails to download modules with The HTTP response we received was "200 OK"', 'When download a module from forge PMT fails with \r\n\r\n{noformat}\r\nError: Request to Puppet Forge failed.\r\n  The server being queried was /v3/files/puppetlabs-apache-1.1.1.tar.gz\r\n  The HTTP response we received was "200 OK"\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-3019', 'https://github.com/puppetlabs/puppet/pull/2945', '2014-08-06T09:29:35.000-0700', '2017-11-27T11:39:43.000-0800', '2017-11-27T11:39:43.000-0800', 'Closed', '', 0, '0', 1, 3, 4, 2, '359509ff7a0e4b3c6ed86dd46dd06dfbf37097fe', 'https://tickets.puppetlabs.com/browse/PUP-3019', 'https://github.com/puppetlabs/puppet/pull/2945'),
('puppet', 77996, 45941150, 4286, 'Puppet 3.5.0 introduced a regression in tag filtering for catalog runs', 'Puppet 3.5.0 introduced a regression to agent tag filtering where a single tag, {{--tag foo::bar}} would be split on the namespace separator {{::}} and expanded to a set of {{["foo::bar", "foo", "bar"]}}.\r\n\r\nThis causes the agent to sync more resources than the user intended when tag filtering is in effect.\r\n\r\nh2. Reproduction Case\r\n\r\nApply the following test manifest with a tag filter of {{--tag test::step1}}:\r\n\r\n{code:puppet}\r\n# tag_test.pp\r\n\r\nclass test {\r\n  include test::step1\r\n  include test::step2\r\n}\r\n\r\nclass test::step1 {\r\n  file { "/tmp/test1.txt":\r\n    ensure => "file",\r\n  }\r\n}\r\n\r\nclass test::step2 {\r\n  file { "/tmp/test2.txt":\r\n    ensure => "file",\r\n  }\r\n}\r\n\r\ninclude test\r\n{code}\r\n\r\nh3. Outcome\r\n\r\nBoth file resources from from the {{Step1}} and {{Step2}} classes are applied:\r\n\r\n{noformat}\r\n# puppet --version\r\n3.8.0\r\n# puppet apply tag_test.pp --tags test::step1\r\n\r\nNotice: Compiled catalog for poss-head-centos.puppetdebug.vlan in environment production in 0.37 seconds\r\nNotice: Finished catalog run in 0.01 seconds\r\n[root@poss-head-centos ZEN-11318]# rm -f /tmp/test*\r\n[root@poss-head-centos ZEN-11318]# puppet apply tag_test.pp --tags test::step1\r\nNotice: Compiled catalog for poss-head-centos.puppetdebug.vlan in environment production in 0.41 seconds\r\nNotice: /Stage[main]/Test::Step2/File[/tmp/test2.txt]/ensure: created\r\nNotice: /Stage[main]/Test::Step1/File[/tmp/test1.txt]/ensure: created\r\nNotice: Finished catalog run in 0.02 seconds\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nOnly file resources from the {{Step1}} class are applied. This was the behavior prior to Puppet 3.5:\r\n\r\n{noformat}\r\n# puppet --version\r\n3.4.3\r\n# puppet apply tag_test.pp --tags test::step1\r\n\r\nNotice: Compiled catalog for poss-head-centos.puppetdebug.vlan in environment production in 0.38 seconds\r\nNotice: /Stage[main]/Test::Step1/File[/tmp/test1.txt]/ensure: created\r\nNotice: Finished catalog run in 0.20 seconds\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-4495', 'https://github.com/puppetlabs/puppet/pull/4286', '2015-04-29T14:07:27.000-0700', '2017-11-29T10:24:24.000-0800', '2017-11-29T10:24:24.000-0800', 'Closed', 'customer;support', 10, '0', 2, 18, 7, 3, 'ce1c0267bbf1067f912bb84ba210ed854dfb1ed4', 'https://tickets.puppetlabs.com/browse/PUP-4495', 'https://github.com/puppetlabs/puppet/pull/4286'),
('puppet', 216304, 148880725, 6313, 'Ruby Rational data type matches Numeric when it should not', 'The {{Numeric}} type returns {{true}} for a ruby {{Rational}} value when it should return {{false}}. This is probably because it blindly accepts subtypes of ruby numeric.', 'https://tickets.puppetlabs.com/browse/PUP-8057', 'https://github.com/puppetlabs/puppet/pull/6313', '2017-10-16T06:52:48.000-0700', '2017-12-01T10:18:25.000-0800', '2017-12-01T10:18:25.000-0800', 'Resolved', '', 1, '0', 1, 23, 0, 2, 'd411dc381fafe08c64b980e548050902850bd120', 'https://tickets.puppetlabs.com/browse/PUP-8057', 'https://github.com/puppetlabs/puppet/pull/6313'),
('puppet', 187953, 135686595, 6123, 'unable to have puppet master listen on both IPv4 and IPv6', 'I"d like have Puppet being dual-stacked, so I did set {{bindaddress = ::}} in my {{puppet.conf}}, as suggested in "Learning Puppet 4: A Guide to Configuration Management and Automation"/ "IPv6 Dual-Stack Puppet Master" (Page 309 in Google Books), also described [here|https://projects.puppetlabs.com/issues/6370].\r\n\r\nThis should make the puppet master listen on both IPv4 and IPv6.\r\n\r\nWhen running the puppet master, {{netstat -anl|grep 8140}} shows the following:\r\n{{tcp6       0      0 :::8140                 :::*                    LISTEN}}\r\n\r\nI can connect via IPv6:\r\ncurl -k "https://[::]:8140/puppet/v3/"\r\n{"message":"Bad Request: The indirection name must be purely alphanumeric, not ""","issue_kind":"RUNTIME_ERROR"}\r\n\r\nBut connecting via IPv4 fails:\r\ncurl -k "https://127.0.0.1:8140/puppet/v3/" \r\ncurl: (7) Failed to connect to 127.0.0.1 port 8140: Connection refused\r\n\r\nSo the socket does not seem to be listening under IPv4, contrary to the docs.\r\n\r\nAdditionally, it"s not possible to bind to two different addresses (:: and 0.0.0.0), so it currently simply isn"t possible to start puppet listening both on IPv4 and Ipv6.', 'https://tickets.puppetlabs.com/browse/PUP-7472', 'https://github.com/puppetlabs/puppet/pull/6123', '2017-04-26T08:36:25.000-0700', '2017-12-11T06:17:59.000-0800', '2017-12-11T06:17:59.000-0800', 'Closed', '', 13, '0', 1, 1, 0, 1, '696710fc97a5fc018aa5a2c0c07b110e786fd442', 'https://tickets.puppetlabs.com/browse/PUP-7472', 'https://github.com/puppetlabs/puppet/pull/6123'),
('puppet', 187405, 118811589, 5841, 'Warning when trying to JSON-serialise undef value ("hash will be converted to string")', 'A warning message like the following appears in Puppetserver"s logs (line breaks added for readability):\r\n\r\n{code}\r\n2017-04-23 16:12:15,935 WARN  [qtp2095795815-27357] [puppetserver] Puppet Resource "Icinga2::Object::Host[dns01.prod.example.com]"\r\ncontains a Hash value. It will be converted to the String \r\n"{"distro"=>"Ubuntu", "is_virtual"=>true, "manufacturer"=>"QEMU", "os"=>"Linux", \r\n"parent"=>:undef, "project"=>"dns", "fqdn"=>"dns01.prod.example.com", "service"=>"dns-cluster",\r\n"stage"=>"prod", "virtual"=>"kvm",\r\n"notification"=>{"mail"=>{"groups"=>["admins"]}, "sms"=>{"groups"=>["admins"]}}}"\r\n{code}\r\n\r\nThe resource in question looks like this:\r\n\r\n{code}\r\n...\r\nif getvar("::virtualisation_host") {\r\n  $_parent = $::virtualisation_host\r\n} else {\r\n  $_parent = undef\r\n}\r\n...\r\n@@icinga2::object::host { $::fqdn:\r\n  import       => $_import,\r\n  display_name => $::fqdn,\r\n  address      => $::fqdn,\r\n  target       => "/etc/icinga2/objects/hosts.conf",\r\n  tag          => $::stage,\r\n  vars         => {\r\n    applications => $_applications,\r\n    distro       => $::operatingsystem,\r\n    fqdn         => $::fqdn,\r\n    is_virtual   => $::is_virtual,\r\n    manufacturer => $::manufacturer,\r\n    os           => $::kernel,\r\n    parent       => $_parent,\r\n    project      => $::project,\r\n    service      => $_service,\r\n    stage        => $::stage,\r\n    virtual      => $::virtual,\r\n    notification => {\r\n      mail => {\r\n        groups => $mail_groups,\r\n      },\r\n      sms  => {\r\n        groups => $sms_groups,\r\n      },\r\n    },\r\n  },\r\n}\r\n{code}\r\n\r\nIn this case {{$_parent}} (and therefore the {{parent}} value in the {{vars}} hash) is set to {{undef}} explicitly. This seems to trip up something in Puppet related to JSON-serialisation.\r\n\r\nI"ll update this ticket with some reproducible code in the coming days.', 'https://tickets.puppetlabs.com/browse/PUP-7464', 'https://github.com/puppetlabs/puppet/pull/5841', '2017-04-23T09:07:48.000-0700', '2017-12-12T07:01:38.000-0800', '2017-12-12T07:01:38.000-0800', 'Closed', 'resolved-issue-added', 3, '0', 5, 30, 11, 2, '67040cebfda51b68610c0fa58f7f73a0b060476a', 'https://tickets.puppetlabs.com/browse/PUP-7464', 'https://github.com/puppetlabs/puppet/pull/5841'),
('puppet', 214744, 150566691, 6337, 'Concatenated strings causing breakages with Japanese', 'There are some concatenated strings in Puppet that are resulting in mistranslations because the translator doesn"t have the full context of what the complete sentence is supposed to be, and cannot change the sentence order,\r\n\r\nExample:\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/indirector/catalog/compiler.rb#L273-L276\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/indirector/catalog/compiler.rb#L291-L292\r\n\r\nThese might be the only two occurrences [~eric.delaney]', 'https://tickets.puppetlabs.com/browse/PUP-8029', 'https://github.com/puppetlabs/puppet/pull/6337', '2017-10-05T11:22:41.000-0700', '2017-12-14T10:09:59.000-0800', '2017-12-14T10:09:59.000-0800', 'Closed', 'i18n', 3, '0', 1, 428, 243, 29, 'fa40faf975825dd750ce81f244556a57481530b1', 'https://tickets.puppetlabs.com/browse/PUP-8029', 'https://github.com/puppetlabs/puppet/pull/6337'),
('puppet', 63365, 28767121, 3579, 'Use of cfacter on Windows causes error', 'Using puppet"s --cfacter option on Windows results in {{Error: Could not initialize global default settings: facter has already evaluated facts.}}\r\n\r\nAn example is \r\n\r\n{code}\r\npuppet apply --cfacter -e "notify { "a": message => "$facterversion" }"\r\n{code}\r\n\r\n[~peter.huene] suggested trying "if your winver > 6, you could try commenting out the version check logic in admin? in lib/puppet/util/windows/user.rb to see if my guess is correct that Puppet.features.root? uses facts on Windows but not POSIX"', 'https://tickets.puppetlabs.com/browse/PUP-3821', 'https://github.com/puppetlabs/puppet/pull/3579', '2015-01-08T15:44:46.000-0800', '2018-01-08T10:24:11.000-0800', '2018-01-08T10:24:11.000-0800', 'Closed', '', 20, '0', 1, 62, 5, 3, '87517ad99578d9f99f455d50449265450358d588', 'https://tickets.puppetlabs.com/browse/PUP-3821', 'https://github.com/puppetlabs/puppet/pull/3579'),
('puppet', 215525, 145572291, 6272, 'Puppet 4.10.x: Only warn once when gettext cannot be found', 'Currently in Puppet >4.10.5, if the gettext-setup gem cannot be found we will issue a warning for every single module that is loaded, each time that module is loaded. This causes a huge amount of log spam in environments that load a lot of modules, all with nearly the same message:\r\n{{2017-09-26 00:05:19,103 WARN  [qtp1394837016-64] [puppetserver] Puppet GettextSetup is not available, skipping GettextSetup initialization for <module_name>.}}\r\n\r\nWe should only issue this warning once.', 'https://tickets.puppetlabs.com/browse/PUP-8039', 'https://github.com/puppetlabs/puppet/pull/6272', '2017-10-09T16:53:49.000-0700', '2018-01-11T13:27:23.000-0800', '2018-01-11T13:27:23.000-0800', 'Closed', '', 3, '0', 1, 1, 1, 1, '317ab6fbef6326c2950c6b84e219f407ab82df54', 'https://tickets.puppetlabs.com/browse/PUP-8039', 'https://github.com/puppetlabs/puppet/pull/6272'),
('puppet', 204150, 139615249, 6181, 'AIX provider prefetch will fail if any package does not have a source', 'Prefetching in AIX assumes that all packages have a valid {{source}} attribute. This is not always the case, as {{ensure => absent}} does not require such a source. Thus the following manifest will cause prefetch to fail:\r\n\r\n{noformat}\r\npackage { "sudo.rte":\r\n    ensure => latest,\r\n    source => "/mnt/my-packages"\r\n}\r\n\r\npackage { "curl.rte":\r\n    ensure => absent,\r\n}\r\n{noformat}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7818', 'https://github.com/puppetlabs/puppet/pull/6181', '2017-08-04T11:51:14.000-0700', '2018-01-19T15:51:40.000-0800', '2018-01-19T15:51:40.000-0800', 'Closed', '', 11, '0', 1, 4, 0, 1, 'd1cd838a86193a0e780c3c5692e0f79d7fa55122', 'https://tickets.puppetlabs.com/browse/PUP-7818', 'https://github.com/puppetlabs/puppet/pull/6181'),
('puppet', 193629, 153008133, 6368, 'Lookup unique merge doesn"t deduplicate with a single layer', 'The {{lookup}} function with a unique merge doesn"t seem to deduplicate when there is only one layer of Hiera that the key appears in.\r\n\r\nFor example, when I run this:\r\n{noformat}\r\npuppet lookup people::tags --merge unique\r\n---\r\n- syseng\r\n- syseng-identity_dev\r\n- identity\r\n- identity-dev\r\n- identity\r\n- identity-identity_dev\r\n{noformat}\r\n\r\nIf I add the key with {{identity}} to another layer I get\r\n{noformat}\r\n---\r\n- identity\r\n- syseng\r\n- syseng-identity_dev\r\n- identity-dev\r\n- identity-identity_dev\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-7608', 'https://github.com/puppetlabs/puppet/pull/6368', '2017-05-30T22:28:38.000-0700', '2018-01-23T15:52:23.000-0800', '2018-01-23T15:52:23.000-0800', 'Closed', 'resolved-issue-added', 5, '0', 1, 34, 1, 2, '9ad726ca9bdd2a94d96d3abaa6f6223df6a1c382', 'https://tickets.puppetlabs.com/browse/PUP-7608', 'https://github.com/puppetlabs/puppet/pull/6368'),
('puppet', 165475, 112416208, 5760, 'resource references to aliased resources does not always work', 'An alias on (at least) package and exec resources that worked fine to resolve a dependency at least in Puppet 3.4 doesn"t work anymore in Puppet 4.8.0.\r\nI would expect that the manifest below would not create the Warning it gives. \r\n(I"m surprised by a warning that the dependency isn"t found, but then getting a "dependency failed" on just that resource, though referenced by the title, not the alias, which in turn is OK)\r\n\r\nAlmost minimal reproduction case:\r\n\r\n{noformat}\r\n$ cat /tmp/t.pp; sudo puppet apply --detailed-exitcodes /tmp/t.pp; echo $?\r\n# $Id$\r\npackage{"postfix":\r\n  alias  => "mta",\r\n  ensure => latest,\r\n}\r\n\r\nexec{"/bin/false":\r\n  alias => "something",\r\n}\r\n\r\nnotify{"Depended on mta":\r\n  require => [Exec["something"], Package["mta"]],\r\n}\r\n{noformat}\r\n\r\n{noformat}\r\nWarning: Could not find resource "Exec[something]" in parameter "require"\r\n   (at /tmp/t.pp:12)\r\nWarning: Could not find resource "Package[mta]" in parameter "require"\r\n   (at /tmp/t.pp:12)\r\nNotice: Compiled catalog for 90cdc197-bd0d-4ee2-8e22-cf4962548eb1 in environment standalone_puppet in 0.49 seconds\r\nError: /bin/false returned 1 instead of one of [0]\r\nError: /Stage[main]/Main/Exec[/bin/false]/returns: change from notrun to 0 failed: /bin/false returned 1 instead of one of [0]\r\nNotice: /Stage[main]/Main/Notify[Depended on mta]: Dependency Exec[/bin/false] has failures: true\r\nWarning: /Stage[main]/Main/Notify[Depended on mta]: Skipping because of failed dependencies\r\nNotice: Applied catalog in 0.62 seconds\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-6984', 'https://github.com/puppetlabs/puppet/pull/5760', '2016-12-07T10:24:10.000-0800', '2018-02-05T11:22:50.000-0800', '2018-02-05T11:22:50.000-0800', 'Closed', 'resolved-issue-added', 13, '0', 3, 91, 70, 7, '3aa97102de760b10b9afd8a74bc5b4cfa05ef31a', 'https://tickets.puppetlabs.com/browse/PUP-6984', 'https://github.com/puppetlabs/puppet/pull/5760'),
('puppet', 222322, 153008133, 6368, 'Lookup unique merge doesn"t deduplicate with a single layer - backport PUP 7608 to 4.10.z', 'Ticket PUP-7608 was created against Puppet 5.0.  This same issue also affects Puppet 4, and is a behavioral change from earlier Puppet 4 versions.\r\n\r\nGiven a single hiera file containing\r\n{noformat}\r\n---\r\nfoo:\r\n  - this is a test\r\n  - this is another test\r\n  - this is a test\r\n{noformat}\r\n\r\nIn Puppet 4.2.3, {{hiera_array("foo")}} will return a two-element array:\r\n{noformat}\r\n$ puppet apply -t --noop -e "$foo = hiera_array("foo"); notice("${::clientversion}: ${foo}")"\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nNotice: Scope(Class[main]): 4.2.3: [this is a test, this is another test]\r\nNotice: Compiled catalog for foo.example.com in environment production in 0.32 seconds\r\nInfo: Applying configuration version "1510798433"\r\nNotice: Applied catalog in 0.02 seconds\r\n{noformat}\r\nHowever, in Puppet 4.10.8, it returns all three elements, including the duplicated element:\r\n{noformat}\r\n$ puppet apply --strict=off -t --noop -e "$foo = hiera_array("foo"); notice("${::clientversion}: ${foo}")"\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nInfo: Loading facts\r\nNotice: Scope(Class[main]): 4.10.8: [this is a test, this is another test, this is a test]\r\nNotice: Compiled catalog for foo.example.com in environment production in 0.13 seconds\r\nInfo: Applying configuration version "1510798413"\r\nNotice: Applied catalog in 0.04 seconds\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8182', 'https://github.com/puppetlabs/puppet/pull/6368', '2017-11-15T18:37:10.000-0800', '2018-02-05T12:47:47.000-0800', '2018-02-05T12:47:47.000-0800', 'Closed', '', 4, '0', 1, 34, 1, 2, '065d8ca5e8f6f10c265100d59d7ffea107c03f9d', 'https://tickets.puppetlabs.com/browse/PUP-8182', 'https://github.com/puppetlabs/puppet/pull/6368'),
('puppet', 107262, 153902864, 6377, 'sprintf fails when using named format parameters', 'Puppet"s documentation indicates that *sprintf * is using the same capabilities as ruby"s one.\r\n\r\nBut when I use in puppet the following call:\r\n{code:puppet}\r\nsprintf("-o %{logdir}/stdout", { logdir => "/var/log/"})\r\n{code}\r\nI end up with the following message:\r\n{code}\r\nError: Evaluation Error: Error while evaluating a Function Call, key{logdir} not found at /...\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-5556', 'https://github.com/puppetlabs/puppet/pull/6377', '2015-11-27T06:45:36.000-0800', '2018-02-05T12:47:49.000-0800', '2018-02-05T12:47:49.000-0800', 'Closed', '', 7, '0', 4, 43, 3, 2, '0857aac1a5ffdde8ec0bbec34b4a7dc65b67fa72', 'https://tickets.puppetlabs.com/browse/PUP-5556', 'https://github.com/puppetlabs/puppet/pull/6377'),
('puppet', 224656, 155657095, 6407, 'Hiera 5 "uris" hierarchy parameter inappropriately type-checked', 'The documentation for configuring a Hiera 5 hierarchy level can be found [here|https://puppet.com/docs/puppet/5.2/hiera_config_yaml_5.html#configuring-a-hierarchy-level-general-format]. In these docs, the {{uris}} key is described as appropriate for _"\[...\] any kind of data source. Hiera doesn’t ensure URIs are resolvable before calling the backend, and doesn’t need to understand any given URI schema."_\r\n\r\nHowever, in implementation the {{uris}} key is not implemented this way, and seems to require that values match a preconception of what a URI is.\r\n\r\n{code}\r\n---\r\nversion: 5\r\n\r\ndefaults:\r\n  datadir: "data"\r\n\r\nhierarchy:\r\n  - name: "Consul backend"\r\n    lookup_key: consul_lookup_key\r\n    uris:\r\n      - "/v1/kv/configuration/%{fqdn}"\r\n      - "/v1/kv/configuration/common"\r\n{code}\r\n\r\n{code}\r\n[cloud-user@master-of-puppets-aws-1 work]$ puppet lookup --hiera_config=hiera.yaml --modulepath=modules test --explain\r\nError: Could not run: Lookup of key "lookup_options" failed: The Lookup Configuration at "/home/cloud-user/work/hiera.yaml" has wrong type, entry "hierarchy" index 0 entry "uri" exp\r\nects a match for Pcore::URI = Pattern[/(?x-mi:\r\n        ([a-zA-Z][\-+.a-zA-Z\d]*):                           (?# 1: scheme)\r\n        (?:\r\n           ((?:[\-_.!~*"()a-zA-Z\d;?:@&=+$,]|%[a-fA-F\d]{2})(?:[\-_.!~*"()a-zA-Z\d;\/?:@&=+$,\[\]]|%[a-fA-F\d]{2})*)                    (?# 2: opaque)\r\n        |\r\n           (?:(?:\r\n             \/\/(?:\r\n                 (?:(?:((?:[\-_.!~*"()a-zA-Z\d;:&=+$,]|%[a-fA-F\d]{2})*)@)?        (?# 3: userinfo)\r\n                   (?:((?:(?:[a-zA-Z0-9\-.]|%\h\h)+|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\[(?:(?:[a-fA-F\d]{1,4}:)*(?:[a-fA-F\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:(?:[a-fA-F\d]{1,4}:)*[a-fA-F\d]{1,4})?::(?:(?:[a-fA-F\d]{1,4}:)*(?:[a-fA-F\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?)\]))(?::(\d*))?))? (?# 4: host, 5: port)\r\n               |\r\n                 ((?:[\-_.!~*"()a-zA-Z\d$,;:@&=+]|%[a-fA-F\d]{2})+)                 (?# 6: registry)\r\n               )\r\n             |\r\n             (?!\/\/))                           (?# XXX: "\/\/" is the mark for hostport)\r\n             (\/(?:[\-_.!~*"()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*(?:;(?:[\-_.!~*"()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*)*(?:\/(?:[\-_.!~*"()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*(?:;(?:[\-_.!~*"()a-zA-Z\d:@&=+$,]|%[a-fA-F\d]{2})*)*)*)?                    (?# 7: path)\r\n           )(?:\?((?:[\-_.!~*"()a-zA-Z\d;\/?:@&=+$,\[\]]|%[a-fA-F\d]{2})*))?                 (?# 8: query)\r\n        )\r\n        (?:\#((?:[\-_.!~*"()a-zA-Z\d;\/?:@&=+$,\[\]]|%[a-fA-F\d]{2})*))?                  (?# 9: fragment)\r\n      )/], got "/v1/kv/configuration/common"\r\n{code}\r\n\r\nAs a custom backend author, I read the documentation for {{uris}} as a standardized key that I can use to specify "levels" for my backend, where the format and validation of strings representing levels is left to me. However, the implementation prevents this.\r\n\r\nThere should be a standard key that can be used to describe levels, for which format and validation of entries is left to the backend. If {{uris}} is already this key, the undocumented type checking is a bug that needs to be removed before it can be effectively used. ', 'https://tickets.puppetlabs.com/browse/PUP-8216', 'https://github.com/puppetlabs/puppet/pull/6407', '2017-11-29T10:53:24.000-0800', '2018-02-05T12:47:50.000-0800', '2018-02-05T12:47:50.000-0800', 'Closed', '', 12, '0', 3, 72, 5, 2, 'd5e2e404fdbf448599e41fa15ad83929c27fe15c', 'https://tickets.puppetlabs.com/browse/PUP-8216', 'https://github.com/puppetlabs/puppet/pull/6407'),
('puppet', 69910, 155291840, 6397, 'errors/warnings in environment.conf should not be duplicated', 'warnings in an environment.conf can produce three or more repeated messages:\r\non master (4x) with parser as a setting in production"s environment.conf\r\n{code}\r\n[root@fe3bsczu8tto8hg puppet]# puppet apply -e "notify{"yep":}"\r\nWarning: Invalid settings in environment.conf at "/etc/puppetlabs/code/environments/production/environment.conf". The following unknown setting(s) are being ignored: parser\r\nWarning: Invalid settings in environment.conf at "/etc/puppetlabs/code/environments/production/environment.conf". The following unknown setting(s) are being ignored: parser\r\nWarning: Invalid settings in environment.conf at "/etc/puppetlabs/code/environments/production/environment.conf". The following unknown setting(s) are being ignored: parser\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-4065', 'https://github.com/puppetlabs/puppet/pull/6397', '2015-03-02T15:47:22.000-0800', '2018-02-05T12:47:50.000-0800', '2018-02-05T12:47:50.000-0800', 'Closed', 'beginner;this_issue_is_bad_and_you_should_feel_bad', 9, '0', 2, 28, 5, 4, '5dc9a1f0dcc538fc32a5f061fd5e36da841ddaaa', 'https://tickets.puppetlabs.com/browse/PUP-4065', 'https://github.com/puppetlabs/puppet/pull/6397'),
('puppet', 219989, 152544648, 6361, 'Remove incorrect deprecation warning for `audit` metaparam', 'When we decided not to remove the audit metaparameter, we forgot to remove the corresponding deprecation warning stating the metaparam would be removed. We should get rid of the deprecation warning.\r\n\r\nFor details on the audit metaparameter can be found here: https://puppet.com/docs/puppet/5.3/metaparameter.html#audit (and there also appears to be a stray deprecation warning in the docs for it that should also be removed).\r\n\r\nThis should be merged first to the 4.10.x stream and then merged up.', 'https://tickets.puppetlabs.com/browse/PUP-8113', 'https://github.com/puppetlabs/puppet/pull/6361', '2017-11-01T15:38:05.000-0700', '2018-02-05T12:47:51.000-0800', '2018-02-05T12:47:51.000-0800', 'Closed', '', 9, '0', 1, 1, 9, 1, '477b603568f3d0323f7ae398e0b66521e5da0f73', 'https://tickets.puppetlabs.com/browse/PUP-8113', 'https://github.com/puppetlabs/puppet/pull/6361'),
('puppet', 182889, 152076917, 6357, 'Aliased types are not indistinguishable from the original type', 'I stumbled across a behavior relating to aliased data types which seems inconsistent with the documentation / specification. Per https://github.com/puppetlabs/puppet-specifications/blob/master/language/types_values_variables.md#type-aliases "An aliased type is indistinguishable from the original type." I believe I have found at least one instance where that is not so.\r\n\r\nExample 1:\r\n{code:title=enum.pp}\r\n$a = Enum["a","b"]\r\n$a.each |$x| { notice($x) }\r\n{code}\r\n\r\n{noformat}\r\n$ puppet apply enum.pp \r\nNotice: Scope(Class[main]): a\r\nNotice: Scope(Class[main]): b\r\nNotice: Compiled catalog for localhost.localdomain in environment production in 0.02 seconds\r\nNotice: Applied catalog in 0.09 seconds\r\n{noformat}\r\n\r\nExample 2 (with aliased type):\r\n{code:title=custom.pp}\r\ntype Custom = Enum["a","b"]\r\n$a = Custom\r\n$a.each |$x| { notice($x) }\r\n{code}\r\n\r\n{noformat}\r\n$ puppet apply custom.pp \r\nError: Evaluation Error: Error while evaluating a Method call, "each" expects one of:\r\n  (Hash[Any, Any] hash, Callable[2, 2] block)\r\n    rejected: parameter "hash" expects a Hash value, got Type\r\n  (Hash[Any, Any] hash, Callable[1, 1] block)\r\n    rejected: parameter "hash" expects a Hash value, got Type\r\n  (Iterable enumerable, Callable[2, 2] block)\r\n    rejected: parameter "enumerable" expects an Iterable value, got Type\r\n  (Iterable enumerable, Callable[1, 1] block)\r\n    rejected: parameter "enumerable" expects an Iterable value, got Type at custom.pp:4:3 on node localhost.localdomain\r\n{noformat}\r\n\r\nI would have expected that the Iterable behavior would have transitioned with the custom type.\r\n\r\nI have seen this behavior on 4.7.0 as well as a current master branch (4.9.4-488-gcef0271).\r\n\r\nThank you.', 'https://tickets.puppetlabs.com/browse/PUP-7401', 'https://github.com/puppetlabs/puppet/pull/6357', '2017-03-28T05:58:24.000-0700', '2018-02-05T12:47:52.000-0800', '2018-02-05T12:47:52.000-0800', 'Closed', '', 10, '0', 2, 25, 0, 3, 'e8dd796e26a26183a91c17bc854f00cbcd985899', 'https://tickets.puppetlabs.com/browse/PUP-7401', 'https://github.com/puppetlabs/puppet/pull/6357'),
('puppet', 119008, 151509724, 6345, 'Documentation for logdest is confusing ', 'The logdest option is described as such in puppet apply :\r\n[-l|--logdest syslog|eventlog|<FILE>|console] [--noop]\r\n\r\nBut it would more accurately be described as: \r\n[-l|--logdest syslog|eventlog|<ABS FILEPATH>|console] [--noop]\r\n\r\nThe logdest does not accept a file, only an absolute path, which is misleading.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-5987', 'https://github.com/puppetlabs/puppet/pull/6345', '2016-02-28T12:11:09.000-0800', '2018-02-05T12:47:53.000-0800', '2018-02-05T12:47:53.000-0800', 'Closed', 'beginner;the-goods', 6, '0', 1, 2, 2, 2, '770e88c4a639d985ec805a1a2f756e13d6be97bc', 'https://tickets.puppetlabs.com/browse/PUP-5987', 'https://github.com/puppetlabs/puppet/pull/6345'),
('puppet', 221245, 151736743, 6350, 'NoMethodErrors involving Puppet::Face instances do not have a useful error message', 'The Puppet::Face class does not define a useful text representation for use in some error messages --- I.E. {{NoMethodError}}. This makes errors involving missing methods on Puppet Faces especially difficult to track down. Puppet Faces allow multiple versions, so these errors are easy to create by third-party modules defining a new Face version that other Puppet components don"t expect.\r\n\r\nh2. Reproduction Case.\r\n\r\n  - Install the latest puppet-agent 4.10.x on CentOS 7:\r\n\r\n{code:bash}\r\nrpm -Uvh http://yum.puppetlabs.com/puppetlabs-release-pc1-el-7.noarch.rpm\r\nyum install -y puppet-agent\r\n{code}\r\n\r\n  - Create a module containing a Puppet Face that can fail due to multiple versions:\r\n\r\n{code:bash}\r\nmkdir -p /etc/puppetlabs/code/environments/production/modules/test_face/lib/puppet/application\r\ncat <<EOF > /etc/puppetlabs/code/environments/production/modules/test_face/lib/puppet/application/foo.rb\r\nrequire "puppet/application/face_base"\r\n\r\nclass Puppet::Application::Foo < Puppet::Application::FaceBase\r\nend\r\nEOF\r\n\r\nmkdir -p /etc/puppetlabs/code/environments/production/modules/test_face/lib/puppet/face\r\ncat <<EOF > /etc/puppetlabs/code/environments/production/modules/test_face/lib/puppet/face/foo.rb\r\nPuppet::Face.define(:foo, "0.0.1") do\r\n  action :bar do\r\n    when_invoked do |*args|\r\n      puts "Bar action called!"\r\n    end\r\n  end\r\n\r\n  action :baz do\r\n    when_invoked do |*args|\r\n      puts "Baz action called!"\r\n      Puppet::Face[:foo, :current].bar\r\n    end\r\n  end\r\nend\r\n\r\nPuppet::Face.define(:foo, "0.0.2") do\r\n  action :bim do\r\n    when_invoked do |*args|\r\n      puts "Bim action called!"\r\n    end\r\n  end\r\nend\r\nEOF\r\n{code}\r\n\r\n  - Run the face to generate a failure: {{/opt/puppetlabs/puppet/bin/puppet foo baz}}\r\n\r\nh3. Outcome\r\n\r\nThe error message indicates no {{baz}} method is avaiailble, but provides no clue that Face versions are coming into play:\r\n\r\n{noformat}\r\n# /opt/puppetlabs/puppet/bin/puppet foo baz\r\nBaz action called!\r\nError: undefined method `bar" for #<Puppet::Interface:0x00000004668948>\r\nError: Try "puppet help foo baz" for usage\r\n{noformat}\r\n\r\nh3. Expected Outcome\r\n\r\nThe error message should include the face name and version number, as provided by the {{to_s}} method of the Puppet::Interface class:\r\n\r\n{noformat}\r\n# /opt/puppetlabs/puppet/bin/puppet foo baz\r\nBaz action called!\r\nError: undefined method `bar" for Puppet::Face[:foo, v0.0.2]:Puppet::Interface\r\nError: Try "puppet help foo baz" for usage\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8140', 'https://github.com/puppetlabs/puppet/pull/6350', '2017-11-09T10:18:45.000-0800', '2018-02-05T12:47:54.000-0800', '2018-02-05T12:47:54.000-0800', 'Closed', 'cs_pr_review', 4, '0', 1, 13, 0, 2, '9b1664f363f8a18a86cf092dae158d654a37e82a', 'https://tickets.puppetlabs.com/browse/PUP-8140', 'https://github.com/puppetlabs/puppet/pull/6350'),
('puppet', 219738, 149875763, 6327, 'puppet device cannot create certs when run as root (4.10.x backport)', 'Back port fix from 5.4.0 to 4.10.x\r\n\r\n\r\nbroken -- output of `puppet device --debug` when ran as root:\r\n{noformat}\r\ninfo: Creating a new SSL key for 10.0.1.3\r\nerr: Could not request certificate: Could not write /var/opt/lib/pe-puppet/devices/10.0.1.3/ssl/private_keys/10.0.1.3.pem to privatekeydir: Permission denied - /var/opt/lib/pe-puppet/devices/10.0.1.3/ssl/private_keys/10.0.1.3.pem\r\n{noformat}\r\n\r\nsuccess -- output of `puppet device --debug` when ran as a normal user:\r\n{noformat}\r\nwarning: peer certificate won"t be verified in this SSL session\r\ninfo: Caching certificate for ca\r\nwarning: peer certificate won"t be verified in this SSL session\r\nwarning: peer certificate won"t be verified in this SSL session\r\ninfo: Creating a new SSL certificate request for 10.0.1.3\r\ninfo: Certificate Request fingerprint (md5): 6C:1C:4C:37:A7:1D:B3:6E:F3:94:25:67:55:27:89:4C\r\nwarning: peer certificate won"t be verified in this SSL session\r\ndebug: Using cached certificate for ca\r\nwarning: peer certificate won"t be verified in this SSL session\r\ninfo: Caching certificate for 10.0.1.3\r\n{noformat}\r\n\r\nNote, that you have to copy `/etc/puppetlabs/puppet/device.conf` to `~/.puppet/`', 'https://tickets.puppetlabs.com/browse/PUP-8108', 'https://github.com/puppetlabs/puppet/pull/6327', '2017-10-31T10:46:01.000-0700', '2018-02-05T12:47:54.000-0800', '2018-02-05T12:47:54.000-0800', 'Closed', 'redmine', 3, '0', 1, 2, 0, 1, 'f38545b8df951af8eedb22a40e065af0d677cba0', 'https://tickets.puppetlabs.com/browse/PUP-8108', 'https://github.com/puppetlabs/puppet/pull/6327'),
('puppet', 207101, 0, 0, 'PMT unpacks modules with tarball permissions when using minitar', 'When installing a module using the system tar, the PMT will filter filesystem permissions to a sane value. This may just be based on the user"s umask.\r\n\r\nWhen using minitar, files are unpacked with whatever permissions are in the tarball. This is potentially unsafe, as tarballs can be easily created with weird permissions.', 'https://tickets.puppetlabs.com/browse/PUP-7866', '', '2017-08-23T13:49:02.000-0700', '2018-02-05T12:53:12.000-0800', '2018-02-05T12:53:12.000-0800', 'Closed', 'Security', 8, '0', 0, 0, 0, 0, '17d9e02da3882e44c1876e2805cf9708481715ee', 'https://tickets.puppetlabs.com/browse/PUP-7866', 'https://github.com/puppetlabs/puppet/commit/17d9e02da3882e44c1876e2805cf9708481715ee'),
('puppet', 221872, 157702084, 6444, 'Older server version errors when an agent tries to download from the locales mountpoint', 'As part of supporting module translations, we added a default mountpoint to Puppet for serving module translation files. However, this mountpoint will not be available on older versions of Puppetserver, so when an agent tries to query it, Puppetserver throws an error:\r\n{code}\r\nError: /File[/Users/josh/.puppetlabs/opt/puppet/cache/locales]: Failed to generate additional resources using "eval_generate": Error 500 on SERVER: Server Error: Not authorized to call search on /file_metadata/locales with {:rest=>"locales", :links=>"follow", :recurse=>true, :source_permissions=>"ignore", :ignore=>[".svn", "CVS", ".git", ".hg", "*.pot", "config.yaml"], :checksum_type=>"sha256"}\r\n{code}\r\n\r\nWe need to handle this gracefully, since it is not really an error (it just means module translations won"t be available agent-side). We cannot simply catch the exception, since at the [downloader level|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/configurer/plugin_handler.rb] the error has already been caught and logged as part of the [HTTP handler|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/indirector/rest.rb#L309]. So ideally we should prevent the query from being made in the first place, dependent on the version of Puppetserver being queried.\r\n\r\nThe server version is currently not available [beyond the HTTP layer|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/indirector/rest.rb#L264]. Two options to explore for making it available include:\r\n1) adding something to Puppet"s [context object|https://github.com/puppetlabs/puppet/blob/master/lib/puppet/context.rb]\r\n2) creating a setting to skip downloading locale files\r\n\r\nThe context gives us a lifecycle for the data and tight control over it (no user can enable translation downloading by accident). However, a setting would give us the option to support people turning off translation downloads if they should prove problematic in certain use cases.', 'https://tickets.puppetlabs.com/browse/PUP-8177', 'https://github.com/puppetlabs/puppet/pull/6444', '2017-11-13T16:12:23.000-0800', '2018-02-05T14:18:24.000-0800', '2018-02-05T14:18:24.000-0800', 'Closed', 'i18n', 3, '0', 1, 134, 28, 5, '7c29116766e33e119b67421912379cf302dc6c22', 'https://tickets.puppetlabs.com/browse/PUP-8177', 'https://github.com/puppetlabs/puppet/pull/6444'),
('puppet', 220820, 160791988, 6481, 'Refactor error location strings to not use words for better I18n support', 'For better translations we should look at how we add the location information to an error in "ExternalFileError". Instead of using words like "at", "at line", and "in" we should change to something like "(file:line:pos)". Then we have no words to translate while still providing the location information.\r\n\r\nI think replacing the output with the below. Based on which variables are set the names on the left, would cause the output on the right:\r\n{code}\r\nfile line pos -> (file:line:pos)\r\nfile line -> (file:line)\r\nline pos -> (line:pos)\r\nline -> (line)\r\n{code}\r\n\r\nAn example with all location information set\r\n{code}\r\nError: Something went wrong (/Users/eric.delaney/work/my_repos/puppet/foo.pp:1:9)\r\nError: Something went wrong (/Users/eric.delaney/work/my_repos/puppet/foo.pp:1)\r\nError: Something went wrong (1:9)\r\nError: Something went wrong (1)\r\n{code}\r\n\r\nPlaces that need to be updated:\r\n./puppet/error.rb - ExternalFileError -> to_s\r\n./puppet/parser/resource.rb - def merge(resource)\r\n./puppet/pops/validation.rb - DiagnosticFormatterPuppetStyle\r\n./puppet/util/errors.rb - Puppet::Util::Errors -> def error_context\r\n./puppet/util/log.rb - Puppet::Util::Log -> to_s line 403\r\n\r\nSome of the code that needs to be updated:\r\n{code}\r\n  module ExternalFileError\r\n    # This module implements logging with a filename and line number. Use this\r\n    # for errors that need to report a location in a non-ruby file that we\r\n    # parse.\r\n    attr_accessor :line, :file, :pos\r\n\r\n    # May be called with 3 arguments for message, file, line, and exception, or\r\n    # 4 args including the position on the line.\r\n    #\r\n    def initialize(message, file=nil, line=nil, pos=nil, original=nil)\r\n      if pos.kind_of? Exception\r\n        original = pos\r\n        pos = nil\r\n      end\r\n      super(message, original)\r\n      @file = file unless (file.is_a?(String) && file.empty?)\r\n      @line = line\r\n      @pos = pos\r\n    end\r\n    def to_s\r\n      msg = super\r\n      @file = nil if (@file.is_a?(String) && @file.empty?)\r\n      if @file and @line and @pos\r\n        "#{msg} at #{@file}:#{@line}:#{@pos}"\r\n      elsif @file and @line\r\n        "#{msg} at #{@file}:#{@line}"\r\n      elsif @line and @pos\r\n          "#{msg} at line #{@line}:#{@pos}"\r\n      elsif @line\r\n        "#{msg} at line #{@line}"\r\n      elsif @file\r\n        "#{msg} in #{@file}"\r\n      else\r\n        msg\r\n      end\r\n    end\r\n  end\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8127', 'https://github.com/puppetlabs/puppet/pull/6481', '2017-11-07T08:29:49.000-0800', '2018-02-05T14:18:24.000-0800', '2018-02-05T14:18:24.000-0800', 'Closed', '', 11, '0', 1, 118, 182, 22, 'f31193ee68666c18d336a56532500b9f86b1627c', 'https://tickets.puppetlabs.com/browse/PUP-8127', 'https://github.com/puppetlabs/puppet/pull/6481'),
('puppet', 221361, 152839045, 6367, 'Some Solaris Init services are not functional with Puppet 5', 'The service resource with the init provider in puppet 5.3.3 does not work for all services in Solaris. The service start is called, however the service is never started. This is a regression from 4.10.8. The following is always seen, however the script is never fully called and the service does not start. \r\n\r\n{code}\r\nDebug: Executing: "/etc/init.d/splunk status"\r\nDebug: Executing: "/usr/bin/ctrun -l none /etc/init.d/splunk start"\r\nNotice: /Stage[main]/Main/Service[splunk]/ensure: ensure changed "stopped" to "running"\r\n{code}\r\n\r\nCalling the init script manually will successfully start the service and produce an exit code of 0. \r\n\r\nInit based services on Solaris 10 use `ctrun` to create a new contract. It looks like the ctrun contract lifetime may be the issue as it is configured to immediately orphan the contract. When the contract is immediately orphaned and the service takes several seconds to start the service may be aborted. I am not sure why this behavior changed from 4.10.8 to 5.3.3 as the code is the same, so it may have to do with the new ruby version. \r\n\r\nI did some basic testing on this and found that if we switch the lifetime to {{child}} instead of {{none}} in the [init provider|https://github.com/puppetlabs/puppet/blob/5.3.3/lib/puppet/provider/service/init.rb#L174], the init script is successfully run and services is started in it"s own contract. \r\n\r\n{code}\r\n[process contract 137]\r\n  3955  splunkd -p 8089 start\r\n    3956  splunkd -p 8089 start\r\n      3996  /opt/splunk/bin/splunkd instrument-resource-usage -p 8089\r\n      3997  /opt/splunk/bin/python -O /opt/splunk/lib/python2.7/site-packages/splunk/appser\r\n{code}\r\n\r\nSince we expect that the init script return, it would make sense to utilize the {{child}}, but I am uncertain of the overall impact of this change. From the man page:\r\n\r\n\r\n{noformat}\r\nchild\r\n   ctrun exits when the command exits, regardless of whether the contract is empty.\r\ncontract\r\n   ctrun exits only when the contract exits. This is the default.\r\nnone\r\n   ctrun exits immediately, orphaning the contract.\r\n{noformat}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8143', 'https://github.com/puppetlabs/puppet/pull/6367', '2017-11-10T00:11:02.000-0800', '2018-02-05T14:18:25.000-0800', '2018-02-05T14:18:25.000-0800', 'Closed', '', 8, '0', 1, 2, 2, 2, 'aaf2bfbcabea3a42cbc1dd8d0d23f8b1c19b8079', 'https://tickets.puppetlabs.com/browse/PUP-8143', 'https://github.com/puppetlabs/puppet/pull/6367'),
('puppet', 220408, 155608478, 6404, 'Class parameter scope is not used when resolving qualified names', 'Looking at https://puppet.com/docs/puppet/5.0/release_notes.html there was a language deprecation that was missed.\r\n\r\nIn Puppet 4, the following code works as expected and prints "{{does it work yes}}"\r\n\r\n{code}\r\nclass foo ( \r\n  $var1 = "does it work",\r\n  $var2 = "${foo::var1} yes"\r\n) { \r\n  notice($var2)\r\n}\r\n\r\ninclude "foo"\r\n{code}\r\n\r\nIn Puppet 5, the same code only prints " {{yes}}"\r\n\r\nApparently, there was a change in the parser that means that local names can only be used when referencing earlier parameters.\r\n\r\nThe corrected code would be:\r\n\r\n{code}\r\nclass foo ( \r\n  $var1 = "does it work",\r\n  $var2 = "${var1} yes"\r\n) { \r\n  notice($var2)\r\n}\r\n\r\ninclude "foo"\r\n{code}\r\n\r\nCCing [~henrik.lindberg] for validation that this is not a regression instead of a documentation bug', 'https://tickets.puppetlabs.com/browse/PUP-8124', 'https://github.com/puppetlabs/puppet/pull/6404', '2017-11-03T10:27:02.000-0700', '2018-02-05T14:18:25.000-0800', '2018-02-05T14:18:25.000-0800', 'Closed', 'regression', 3, '0', 1, 24, 0, 2, '26e81dbdc32ed850627c05c2daa9d1e2eaf421fb', 'https://tickets.puppetlabs.com/browse/PUP-8124', 'https://github.com/puppetlabs/puppet/pull/6404'),
('puppet', 62834, 153424211, 6372, '"puppet config print" should sort the output', 'It"s pretty simple, and the output with all options is basically unreadable otherwise.', 'https://tickets.puppetlabs.com/browse/PUP-3807', 'https://github.com/puppetlabs/puppet/pull/6372', '2015-01-04T22:54:52.000-0800', '2018-02-05T14:18:26.000-0800', '2018-02-05T14:18:26.000-0800', 'Closed', 'puppethack;the-goods', 3, '0', 1, 8, 8, 2, 'a769828a36ef5506230b77b5a48b1012f81adb2a', 'https://tickets.puppetlabs.com/browse/PUP-3807', 'https://github.com/puppetlabs/puppet/pull/6372'),
('puppet', 175481, 155470623, 6402, 'puppet type schedule: weekday parameters: should accept integers', 'See https://github.com/puppetlabs/puppet/blame/master/lib/puppet/type/schedule.rb#L373\r\n\r\nDocumentation says numbers may be used for day-of-week, but code clearly expects strings.\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7221', 'https://github.com/puppetlabs/puppet/pull/6402', '2017-02-15T17:09:19.000-0800', '2018-02-05T14:18:27.000-0800', '2018-02-05T14:18:27.000-0800', 'Closed', '', 7, '0', 1, 39, 13, 2, 'cbbe4eacb7d7ef43826a739c324329b7856a5ae3', 'https://tickets.puppetlabs.com/browse/PUP-7221', 'https://github.com/puppetlabs/puppet/pull/6402'),
('puppet', 231445, 164923967, 6567, 'Non-English windows puppet agent run fails with "incompatible character encodings" when run against non-existent server', 'On a Windows Japanese box if you run "puppet agent -t  --server no_such_host" the agent prints errors about incompatible encodings:\r\n\r\n{code}\r\n$ puppet.bat agent -t --server no_such_host\r\nWarning: ノード定義を取得できませんが、agent実行を続行します:\r\nWarning: Failed to open TCP connection to no_such_host:8140 (getaddrinfo: そのようなホストは不明です。 )\r\nInfo: pluginfactsを取得しています。\r\nWarning: detail.class: SocketError\r\nWarning: detail.to_s.encoding: ASCII-8BIT\r\nError: カタログ適用に失敗しました: incompatible character encodings: UTF-8 and ASCII-8BIT\r\nError: Puppet設定クライアントを実行できません: incompatible character encodings: UTF-8 and ASCII-8BIT\r\n{code}\r\n\r\n\r\nThe underlying issue appears to be when an error has be rescued, and as the error string is ASCII-8BIT and the formatting of the string blows up:\r\n\r\n{code}\r\n  def eval_generate(resource)\r\n    return false unless resource.respond_to?(:eval_generate)\r\n    raise Puppet::DevError, _("Depthfirst resources are not supported by eval_generate") if resource.depthfirst?\r\n    begin\r\n      generated = replace_duplicates_with_catalog_resources(resource.eval_generate)\r\n      return false if generated.empty?\r\n    rescue => detail\r\n      @resources_failed_to_generate = true\r\n      #TRANSLATORS eval_generate is a method name and should be left untranslated\r\n      resource.log_exception(detail, _("Failed to generate additional resources using "eval_generate": %{detail}") % { detail: detail })\r\n{code}\r\n\r\nIf you print out the class and string encoding value:\r\n{code}\r\nWarning: detail.class: SocketError\r\nWarning: detail.to_s: Failed to open TCP connection to no_such_host:8140 (getaddrinfo: そのようなホストは不明です。 )\r\nWarning: detail.to_s.encoding: ASCII-8BIT\r\n{code}\r\n\r\nHere is the stack trace:\r\n{code}\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.4.0/gems/fast_gettext-1.1.1/lib/fast_gettext/vendor/string.rb:70:in `%"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/gems/2.4.0/gems/fast_gettext-1.1.1/lib/fast_gettext/vendor/string.rb:70:in `%"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/additional_resource_generator.rb:64:in `rescue in eval_generate"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/additional_resource_generator.rb:55:in `eval_generate"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction.rb:112:in `block in evaluate"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/graph/relationship_graph.rb:119:in `traverse"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction.rb:169:in `evaluate"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:231:in `block in apply"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/util/log.rb:160:in `with_destination"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/transaction/report.rb:144:in `as_logging_destination"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/resource/catalog.rb:230:in `apply"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer/downloader.rb:13:in `evaluate"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer/plugin_handler.rb:19:in `download_plugins"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer.rb:450:in `download_plugins"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer.rb:118:in `get_facts"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer.rb:312:in `run_internal"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer.rb:225:in `block in run"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/context.rb:65:in `override"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet.rb:260:in `override"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/configurer.rb:199:in `run"\r\nC:/Program Files/Puppet Labs/Puppet/sys/ruby/lib/ruby/vendor_ruby/puppet/agent.rb:59:in `block (5 levels) in run"\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8368', 'https://github.com/puppetlabs/puppet/pull/6567', '2018-01-18T16:07:49.000-0800', '2018-02-05T14:18:27.000-0800', '2018-02-05T14:18:27.000-0800', 'Closed', '', 12, '0', 1, 0, 1, 1, 'c0be86c6933adb19826a1154b42429114e230fd6', 'https://tickets.puppetlabs.com/browse/PUP-8368', 'https://github.com/puppetlabs/puppet/pull/6567'),
('puppet', 220333, 159756232, 6470, 'I18n strings that include repeated lists of sentence fragments can be hard to translate', 'We need to review the PO file and source code of puppet looking for strings where we build up a list of things where we include  sentence fragment in the repeated list and determine if this should be change to allow for better translations\r\n\r\nFor example the below code includes a sentence fragment "which depends on" which will be hard to translate into Japanese, We should create a list of cases, review them and determine which ones we want to change string in.\r\n\r\nlib/puppet/module_tool/errors/shared.rb\r\n\r\n{code}_("    which depends on "%{name}" (%{version})") % { name: m[:name], version: v(m[:version]) }{code}\r\n{code}\r\n      dependency_list = @source[1..-1].map do |m|\r\n        #TRANSLATORS This message repeats as separate lines as a list under the heading "You specified "%{name}" (%{version})\n"\r\n        _("    which depends on "%{name}" (%{version})") % { name: m[:name], version: v(m[:version]) }\r\n      end.join(",\n")\r\n\r\n      msg_variables = { requested_module: @requested_module, version: v(@requested_version), module_name: @module_name,\r\n                        name: @source.first[:name], dependency_list: dependency_list }\r\n      _(<<-EOM).chomp % msg_variables\r\nCould not install module "%{requested_module}" (%{version})\r\n  No version of "%{module_name}" will satisfy dependencies\r\n    You specified "%{name}" (%{version})\r\n%{dependency_list}\r\n    Use `puppet module install --force` to install this module anyway\r\n      EOM\r\n{code}\r\n\r\nWe should look to update the repeated list text to be (and remove the TRANSLATOR comment)\r\n{code}\r\n        _("    This depends on "%{name}" (%{version})") % { name: m[:name], version: v(m[:version]) }\r\n{code}\r\n\r\n\r\n        ', 'https://tickets.puppetlabs.com/browse/PUP-8122', 'https://github.com/puppetlabs/puppet/pull/6470', '2017-11-02T16:08:55.000-0700', '2018-02-05T14:18:29.000-0800', '2018-02-05T14:18:29.000-0800', 'Closed', '', 4, '0', 1, 3, 3, 1, 'f2a8aa703d3005fada0e41be1ca9acebeb67eb2e', 'https://tickets.puppetlabs.com/browse/PUP-8122', 'https://github.com/puppetlabs/puppet/pull/6470'),
('puppet', 210745, 155739179, 6408, 'selmodversion_loaded lines variable broken', 'I was playing with rubocop when it complained about:\r\n\r\n{code}\r\n== lib/puppet/provider/selmodule/semodule.rb ==\r\nW:121: 13: Lint/EmptyExpression: Avoid empty expressions.\r\n{code}\r\n\r\nLooking at the code its complaining about the "lines = ()" assignment:\r\n\r\n{code}\r\n  def selmodversion_loaded\r\n    lines = ()\r\n    begin\r\n      execpipe("#{command(:semodule)} --list") do |output|\r\n        output.each_line do |line|\r\n          line.chomp!\r\n          bits = line.split\r\n          if bits[0] == @resource[:name]\r\n            self.debug "load version #{bits[1]}"\r\n            return bits[1]\r\n          end\r\n        end\r\n      end\r\n    rescue Puppet::ExecutionFailure\r\n      raise Puppet::ExecutionFailure, "Could not list policy modules: #{lines.join(" ").chomp!}", $!.backtrace\r\n    end\r\n    nil\r\n  end\r\n{code}\r\n\r\nLooking at the code, lines will be assigned "nil" which doesn"t have a .join method. So the exception will fail. We also fail to do anything with the lines variable in the method so if it was intended to be an array, it never gets changed from an empty array which is kind of pointless.\r\n\r\nWe should enable "Lint/EmptyExpression" in the .robocop.yml if when this is fixed and we"re on 0.49 or greater.\r\n\r\nBranch off of 5.3.x', 'https://tickets.puppetlabs.com/browse/PUP-7948', 'https://github.com/puppetlabs/puppet/pull/6408', '2017-09-13T14:31:55.000-0700', '2018-02-05T14:18:29.000-0800', '2018-02-05T14:18:29.000-0800', 'Closed', '', 2, '0', 1, 12, 5, 3, 'b95e384a0e29d1aae307d5679f94bf81c06e559b', 'https://tickets.puppetlabs.com/browse/PUP-7948', 'https://github.com/puppetlabs/puppet/pull/6408'),
('puppet', 214120, 0, 0, 'Translations should be stored in different text domains based on environment', 'Users can have different sets and different versions of modules per Puppet environment. In the current system we only load module translations once, so if a user changes their environment to one with a new version of the module in it, the translations will not be updated.\r\n\r\n----\r\n\r\nWe should make translations environment-aware by creating a new text domain for each environment. (note that it appears the current text domain setting is thread local, like locales https://github.com/grosser/fast_gettext/blob/master/lib/fast_gettext/storage.rb#L54) When we load a module"s translations, they should be added to the appropriate text domain, and that domain should be loaded when we select an environment (such as on each compilation request, start an application with a configured environment, or switch environment during an agent run).\r\n\r\nModules should be responsible for loading their own translation files, by adding the translations to a gettext repository and adding that repository to the correct text domain. This should be idempotent.\r\n\r\nWe need to decide where to initialize the text domains themselves. On the server side, this probably happens as part of the HTTP handler for compilation. On the agent side, this is part of application startup. On the agent side, we don"t need to tie text domains to environments because we only ever have one active at once.\r\n\r\nText domains should be tied to the environment lifecycle; i.e. when an environment is refreshed, the text domains should be too, to pick up any updates to module translations that occurred. The {{EnvironmentLoader}} might be a good place to put the logic to blow away outdated text domains.\r\n\r\n[~henrik.lindberg] probably has the most expertise on the environment lifecycle and how things are loaded within an environment.', 'https://tickets.puppetlabs.com/browse/PUP-8013', '', '2017-10-02T13:14:32.000-0700', '2018-02-05T14:18:30.000-0800', '2018-02-05T14:18:30.000-0800', 'Closed', 'i18n', 3, '0', 0, 0, 0, 0, 'e5eed5b1a14c401a0399def195a41729d7dbc201', 'https://tickets.puppetlabs.com/browse/PUP-8013', 'https://github.com/puppetlabs/puppet/commit/e5eed5b1a14c401a0399def195a41729d7dbc201'),
('puppet', 218731, 152322187, 6359, 'Concatenated strings causing breakages with Japanese group 2', 'There are some concatenated strings in Puppet that are resulting in mistranslations because the translator doesn"t have the full context of what the complete sentence is supposed to be, and cannot change the sentence order,\r\n\r\n{code} [centos@ericdelaney lib]$ find . -type f -print | xargs grep "+= _"\r\n./puppet/graph/simple_graph.rb:      message += _("Cycle graph written to %{filename}.") % { filename: filename }\r\n./puppet/graph/simple_graph.rb:      message += _("Try the "--graph" option and opening the resulting ".dot" file in OmniGraffle or GraphViz")\r\n./puppet/parameter/value_collection.rb:      str += _("Valid values are %{value_list}. ") % { value_list: values.join(", ") } unless values.empty?\r\n./puppet/parameter/value_collection.rb:      str += _("Valid values match %{pattern}.") % { pattern: regexes.join(", ") } unless regexes.empty?\r\n./puppet/pops/lookup/lookup_adapter.rb:        msg += _(". A "%{config}" file should be used instead") % { config: HieraConfig::CONFIG_FILE_NAME } if mp.nil?\r\n./puppet/pops/lookup/lookup_adapter.rb:        msg += _(". A "%{config}" file should be used instead") % { config: HieraConfig::CONFIG_FILE_NAME } if ep.nil?\r\n[centos@ericdelaney lib]$\r\n{code}\r\n\r\n{code}\r\n[centos@ericdelaney puppet]$ find lib -type f -print | xargs grep "_(" | grep "+"\r\nlib/puppet/face/epp.rb:        raise Puppet::Error, _("One or more file(s) specified did not exist:\n") + missing_files.map { |f| "   #{f}" }.join("\n")\r\nlib/puppet/face/epp.rb:          raise Puppet::Error, _("One or more file(s) specified did not exist:\n") + missing_files.collect { |f| "   #{f}" }.join("\n")\r\nlib/puppet/face/help.rb:          summary = face.deprecated? ? face.summary + _(" (Deprecated)") : face.summary\r\nlib/puppet/face/module/build.rb:      _("Module built: ") + return_value.expand_path.to_s\r\nlib/puppet/face/module/list.rb:        str << "  " + colorize(:red, _("invalid"))\r\nlib/puppet/face/module/list.rb:          str << "  " + colorize(:red, _("invalid"))\r\nlib/puppet/face/parser.rb:        raise Puppet::Error, _("One or more file(s) specified did not exist:\n%{files}") % { files: missing_files.collect {|f| " " * 3 + f + "\n"} }\r\nlib/puppet/face/parser.rb:          dumps + _("One or more file(s) specified did not exist:\n") + missing_files.collect { |f| "   #{f}" }.join("\n")\r\nlib/puppet/functions/slice.rb:      raise ArgumentError, _("slice(): block must define one parameter, or ") +\r\nlib/puppet/functions/slice.rb:        _("the same number of parameters as the given size of the slice (%{slice_size}). Block has %{serving_size}; ") % { slice_size: slice_size, serving_size: serving_size }+\r\nlib/puppet/graph/simple_graph.rb:      message += _("Cycle graph written to %{filename}.") % { filename: filename }\r\nlib/puppet/graph/simple_graph.rb:      message += _("Try the "--graph" option and opening the resulting ".dot" file in OmniGraffle or GraphViz")\r\nlib/puppet/module_tool/errors/shared.rb:      trace += @source[1..-1].map { |m| _("which depends on "%{name}" (%{version})") % { name: m[:name], version: v(m[:version]) } }\r\nlib/puppet/network/http/error.rb:      super(_("Not Acceptable: ") + message, CODE, issue_kind)\r\nlib/puppet/network/http/error.rb:      super(_("Not Found: ") + message, CODE, issue_kind)\r\nlib/puppet/network/http/error.rb:      super(_("Not Authorized: ") + message, CODE, issue_kind)\r\nlib/puppet/network/http/error.rb:      super(_("Bad Request: ") + message, CODE, issue_kind)\r\nlib/puppet/network/http/error.rb:      super(_("Method Not Allowed: ") + message, CODE, issue_kind)\r\nlib/puppet/network/http/error.rb:      super(_("Unsupported Media Type: ") + message, CODE, issue_kind)\r\nlib/puppet/network/http/error.rb:      super(_("Server Error: ") + original_error.message, CODE, issue_kind)\r\nlib/puppet/parameter/value_collection.rb:      str += _("Valid values are %{value_list}. ") % { value_list: values.join(", ") } unless values.empty?\r\nlib/puppet/parameter/value_collection.rb:      str += _("Valid values match %{pattern}.") % { pattern: regexes.join(", ") } unless regexes.empty?\r\nlib/puppet/pops/lookup/lookup_adapter.rb:        msg += _(". A "%{config}" file should be used instead") % { config: HieraConfig::CONFIG_FILE_NAME } if mp.nil?\r\nlib/puppet/pops/lookup/lookup_adapter.rb:            _("Defining environment_data_provider="%{provider_name}" in environment.conf is deprecated") % { provider_name: provider_name }, env_path + "environment.conf")\r\nlib/puppet/pops/lookup/lookup_adapter.rb:              _("The environment_data_provider="%{provider_name}" setting is ignored since "%{config_path}" version >= 5") % { provider_name: provider_name, config_path: config_path }, env_path + "environment.conf")\r\nlib/puppet/pops/lookup/lookup_adapter.rb:        msg += _(". A "%{config}" file should be used instead") % { config: HieraConfig::CONFIG_FILE_NAME } if ep.nil?\r\nlib/puppet/pops/model/ast_transformer.rb:    raise _("Not a valid expression in a collection query: ")+o.class.name\r\nlib/puppet/util/plist.rb:          Puppet.warning(_("Cannot read file %{file_path}; Puppet is skipping it.\n") % { file_path: file_path } + _("Details: %{detail}") % { detail: detail })\r\nlib/puppet/util/reference.rb:    "\n\n----------------\n\n*" + _("This page autogenerated on ") + "#{Time.now}*\n"\r\nlib/puppet/util/reference.rb:    text << _("\n\n**This page is autogenerated; any changes will get overwritten** *(last generated on ") + "#{Time.now.to_s})*\n\n"\r\n{code}\r\n\r\n{code}\r\n/puppet/syntax_checkers/base64.rb\r\n      if (cleaned_text.bytes.to_a.size * 8) % 6 != 0\r\n        msg2 = _("padding is not correct")\r\n      else\r\n        msg2 = _("contains letters outside strict base 64 range (or whitespace)")\r\n      end\r\n      msg = _("Base64 syntax checker: Cannot parse invalid Base64 string - %{msg2}") % { msg2: msg2 }\r\n{code}\r\n\r\n{code}\r\n[centos@ericdelaney puppet]$ find lib -type f -print | xargs grep "_(" | grep "<<"\r\nlib/puppet/face/module/uninstall.rb:      Puppet.notice _("Preparing to uninstall "%{name}"") % { name: name } << (options[:version] ? " (#{colorize(:cyan, options[:version].sub(/^(?=\d)/, "v"))})" : "") << " ..."\r\nlib/puppet/face/module/list.rb:        str << "  " + colorize(:red, _("invalid"))\r\nlib/puppet/face/module/list.rb:          str << "  " + colorize(:red, _("invalid"))\r\nlib/puppet/forge/errors.rb:      message = _(<<-EOS).chomp % { uri: @uri, response: @response }\r\nlib/puppet/forge/errors.rb:      message << _("\n  The message we received said "%{message}"") % { message: @message } if @message\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("Could not install module "%{module_name}" (%{version})") % { module_name: @module_name, version: @requested_version }\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("  Module "%{module_name}" (%{version}) is already installed") % { module_name: @module_name, version: @installed_version }\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("    Installed module has had changes made locally") unless @local_changes.empty?\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("    Use `puppet module upgrade` to install a different version")\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("    Use `puppet module install --force` to re-install only this module")\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("Could not install "%{requested_package}"") % { requested_package: @requested_package }\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("  No releases are available from %{source}") % { source: @source }\r\nlib/puppet/module_tool/errors/installer.rb:      message << _("    Does "%{requested_package}" have at least one published release?") % { requested_package: @requested_package }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not %{action} module "%{module_name}" (%{version})") % { action: @action, module_name: @requested_name, version: vstring }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("  No version of "%{module_name}" can satisfy all dependencies") % { module_name: @requested_name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("    Use `puppet module %{action} --ignore-dependencies` to %{action} only this module") % { action: @action }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not %{action} "%{module_name}" (%{version})") % { action: @action, module_name: @module_name, version: vstring }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("  No releases are available from %{source}") % { source: @source }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("    Does "%{module_name}" have at least one published release?") % { module_name: @module_name }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("  No releases matching "%{version}" are available from %{source}") % { version: @requested_version, source: @source }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not install module "%{module_name}" (%{version})") % { module_name: @requested_module, version: @requested_version }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("  Dependency "%{name}" (%{version}) would overwrite %{dir}") % { name: @dependency[:name], version: v(@dependency[:version]), dir: @directory }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("  Installation would overwrite %{dir}") % { dir: @directory }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("    Currently, "%{name}" (%{version}) is installed to that directory") % { name: @metadata["name"], version: v(@metadata["version"]) }\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("    Use `puppet module install --ignore-dependencies` to install only this module")\r\nlib/puppet/module_tool/errors/shared.rb:        message << _("    Use `puppet module install --force` to install this module anyway")\r\nlib/puppet/module_tool/errors/shared.rb:      trace << _("You specified "%{name}" (%{version})") % { name: @source.first[:name], version: v(@requested_version) }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not install module "%{module_name}" (%{version})") % { module_name: @requested_module, version: v(@requested_version) }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("  No version of "%{module_name}" will satisfy dependencies") % { module_name: @module_name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("    Use `puppet module install --force` to install this module anyway")\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not %{action} module "%{module_name}"") % { action: @action, module_name: @module_name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("  Module "%{module_name}" is not installed") % { module_name: @module_name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("    Use `puppet module install` to install this module") if @action == :upgrade\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not %{action} module "%{module_name}"") % { action: @action, module_name: @module_name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("  Module "%{module_name}" appears multiple places in the module path") % { module_name: @module_name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("    Use the `--modulepath` option to limit the search to specific directories")\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not %{action} module "%{module_name}" (%{version})") % { action: @action, module_name: @module_name, version: vstring }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("  Installed module has had changes made locally")\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("    Use `puppet module %{action} --ignore-changes` to %{action} this module anyway") % { action: @action }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("Could not %{action} module "%{module_name}"") % { action: @action, module_name: @name }\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("  Failure trying to parse metadata")\r\nlib/puppet/module_tool/errors/shared.rb:      message << _("    Original message was: %{message}") % { message: @error.message }\r\nlib/puppet/module_tool/errors/uninstaller.rb:      message << _("Could not uninstall module "%{module_name}" (%{version})") % { module_name: @module_name, version: v(@version) }\r\nlib/puppet/module_tool/errors/uninstaller.rb:      message << _("  No installed version of "%{module_name}" matches (%{version})") % { module_name: @module_name, version: v(@version) }\r\nlib/puppet/module_tool/errors/uninstaller.rb:        message << _("Could not uninstall module "%{module_name}" (v%{requested_version})") % { module_name: @module_name, requested_version: @requested_version }\r\nlib/puppet/module_tool/errors/uninstaller.rb:        message << _("Could not uninstall module "%{module_name}"") % { module_name: @module_name }\r\nlib/puppet/module_tool/errors/uninstaller.rb:      message << _("  Other installed modules have dependencies on "%{module_name}" (%{version})") % { module_name: @module_name, version: v(@installed_version) }\r\nlib/puppet/module_tool/errors/uninstaller.rb:      message << _("    Use `puppet module uninstall --force` to uninstall this module anyway")\r\nlib/puppet/module_tool/errors/upgrader.rb:      message << _("Could not upgrade module "%{module_name}" (%{version})") % { module_name: @module_name, version: vstring }\r\nlib/puppet/module_tool/errors/upgrader.rb:        message << _("  The installed version is already the latest version matching %{version}") % { version: vstring }\r\nlib/puppet/module_tool/errors/upgrader.rb:        message << _("  There are %{count} newer versions") % { count: @newer_versions.length }\r\nlib/puppet/module_tool/errors/upgrader.rb:        message << _("    No combination of dependency upgrades would satisfy all dependencies")\r\nlib/puppet/module_tool/errors/upgrader.rb:          message << _("    Dependencies will not be automatically upgraded across major versions")\r\nlib/puppet/module_tool/errors/upgrader.rb:          message << _("    Upgrading one or more of these modules may permit the upgrade to succeed:")\r\nlib/puppet/module_tool/errors/upgrader.rb:      message << _("    Use `puppet module upgrade --force` to upgrade only this module")\r\nlib/puppet/module_tool/errors/upgrader.rb:      message << _("Could not %{action} module "%{module_name}" (%{version})") % { action: @action, module_name: @module_name, version: vstring }\r\nlib/puppet/module_tool/errors/upgrader.rb:      message << _("  Downgrading is not allowed.")\r\nlib/puppet/node/environment.rb:      errors << _("The "disable_per_environment_manifest" setting is true, and the "%{env_name}" environment has an environment.conf manifest that conflicts with the "default_manifest" setting.") % { env_name: name }\r\nlib/puppet/parser/resource.rb:      msg << _(" by %{source}") % { source: current.source.to_s } unless current.source.to_s == ""\r\nlib/puppet/parser/resource.rb:      msg << _("; cannot redefine")\r\nlib/puppet/provider/package/nim.rb:        errmsg << _("with version "%{version}" ") % { version: version }\r\nlib/puppet/reference/providers.rb:            details << _("  - Missing files %{files}\n") % { files: values.join(", ") }\r\nlib/puppet/reference/providers.rb:                details << _("  - Setting %{name} (currently %{value}) not in list %{facts}\n") % { name: name, value: Puppet.settings.value(name).inspect, facts: facts.join(", ") }\r\nlib/puppet/reference/providers.rb:                details << _("  - Fact %{name} (currently %{value}) not in list %{facts}\n") % { name: name, value: Facter.value(name).inspect, facts: facts.join(", ") }\r\nlib/puppet/reference/providers.rb:            details << _("  - Got %{values} true tests that should have been false\n") % { values: values }\r\nlib/puppet/reference/providers.rb:            details << _("  - Got %{values} false tests that should have been true\n") % { values: values }\r\nlib/puppet/reference/providers.rb:            details << _("  - Missing features %{values}\n") % { values: values.collect { |f| f.to_s }.join(",") }\r\nlib/puppet/util/log.rb:    annotated_string << _("Backtrace:") << "\n" << caller[0..10].join("\n")\r\nlib/puppet/util/logging.rb:        arr << _("Wrapped exception:")\r\nlib/puppet/util/logging.rb:      arr << _("Wrapped exception:")\r\nlib/puppet/util/reference.rb:    text << _("\n\n**This page is autogenerated; any changes will get overwritten** *(last generated on ") + "#{Time.now.to_s})*\n\n"\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8092', 'https://github.com/puppetlabs/puppet/pull/6359', '2017-10-25T16:01:31.000-0700', '2018-02-05T14:18:31.000-0800', '2018-02-05T14:18:31.000-0800', 'Closed', 'i18n', 3, '0', 1, 60, 16, 2, '490a34367486fb8f1bb5ea71520801b8c793ecc0', 'https://tickets.puppetlabs.com/browse/PUP-8092', 'https://github.com/puppetlabs/puppet/pull/6359'),
('puppet', 221334, 162013564, 6506, 'Certain environments return "invalid byte sequence in <locale>" when parsing module PO files', 'If you load the eputnam-i18ndemo module which has a fact that causes and error that has a Japanese translation, when its run on OSX the error is replaced by "invalid byte sequence in US-ASCII"\r\n\r\n{code}\r\nxh734nh8owpuouo:~ root# puppet module install eputnam-i18ndemo\r\nNotice: Preparing to install into /etc/puppetlabs/code/environments/production/modules ...\r\nNotice: Downloading from https://forgeapi.puppet.com ...\r\nNotice: Installing -- do not interrupt ...\r\n/etc/puppetlabs/code/environments/production/modules\r\n└─┬ eputnam-i18ndemo (v0.2.0)\r\n  ├── puppetlabs-stdlib (v4.21.0)\r\n  └── puppetlabs-translate (v1.1.0)\r\nxh734nh8owpuouo:~ root# LANGUAGE=ja_JP puppet facts\r\nError: Facter: error while resolving custom fact "i18ndemo_fact": invalid byte sequence in US-ASCII\r\n{code}\r\n\r\nInstead of the expected Japanese string (which should look like this pattern)\r\n\r\n{code}\r\n        assert_match(/Error:.*eputnam-i18ndemo fact: これはeputnam-i18ndemoからのカスタムファクトからのレイズです/, result.stderr, "missing translation for raise from ruby fact")\r\n{code}\r\n\r\nThis also appears, for example, on the Japanese Windows pooler image. If you install the module, then attempt to uninstall it, the uninstall will fail with a similar error, and a trace like the one in the comments.', 'https://tickets.puppetlabs.com/browse/PUP-8249', 'https://github.com/puppetlabs/puppet/pull/6506', '2017-11-09T15:17:52.000-0800', '2018-02-05T14:18:34.000-0800', '2018-02-05T14:18:34.000-0800', 'Closed', '', 12, '0', 1, 3, 1, 2, '53aa50aaf6347ac166620f08224d072552e57dc3', 'https://tickets.puppetlabs.com/browse/PUP-8249', 'https://github.com/puppetlabs/puppet/pull/6506'),
('puppet', 228185, 161783271, 6500, 'filebucket backup with an alternate bucket may not backup', '*Puppet Version:* 5.3.3\r\n*Puppet Server Version:* N/A, running agent only\r\n*OS Name/Version:* Ubuntu 16.04\r\n\r\nWhile trying to document what {{puppet filebucket --bucket}}/{{-b}} does, I"ve noticed some unexpected or inconsistent behavior. If this behavior is by design, it isn"t sufficiently explained in any user-facing documentation.\r\n\r\n*Steps to reproduce:*\r\n\r\n1. Create a test file: {{touch /tmp/testfile}}\r\n2. Back up the file to the local filebucket: {{puppet filebucket -l backup /tmp/testfile}}\r\n3. Back up the same file to a filebucket on a specific path: {{puppet filebucket -b /tmp/testbucket backup /tmp/testfile}}\r\n4. Back up a new file to that same new filebucket: {{touch /tmp/testfile2; puppet filebucket -b /tmp/testbucket backup /tmp/testfile2}}\r\n\r\n*Desired Behavior:*\r\n\r\nThe default local filebucket at /opt/puppetlabs/puppet/cache/bucket contains /tmp/testfile.\r\n\r\nPuppet creates a filebucket at /tmp/testbucket, and that filebucket contains /tmp/testfile and /tmp/testfile2.\r\n\r\nThe documentation explains what --bucket is expected to do.\r\n\r\n*Actual Behavior:*\r\n\r\nThe function and behavior of {{--bucket}} are not documented, so I don"t know what the true expected behavior is. It is listed with the flags in the command"s help text and man page, but with no context explaining what it does or is expected to do. See also PUP-5206 and PUP-5392.\r\n\r\n{code}\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# touch /tmp/testfile\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -l backup /tmp/testfile\r\n/tmp/testfile: d41d8cd98f00b204e9800998ecf8427e\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# ls bucket\r\nd\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -l list\r\nd41d8cd98f00b204e9800998ecf8427e 2017-12-21 11:55:44 /tmp/testfile\r\n{code}\r\n\r\nThis is as expected. After backing up the file to the default local filebucket, however, I can"t back up the same file to a bucket at a different path, and puppet produces no output suggesting that the file wasn"t backed up to the specified bucket path, or why.\r\n\r\nThe new bucket isn"t created, but Puppet doesn"t state this, so subsequently running {{puppet filebucket -b /tmp/testbucket list}} fails unexpected with a file not found error:\r\n\r\n{code}\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -b /tmp/testbucket backup /tmp/testfile\r\n/tmp/testfile: d41d8cd98f00b204e9800998ecf8427e\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# echo $?\r\n0\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -b /tmp/testbucket list\r\nError: Could not run: File not found\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# ls -la /tmp/testbucket\r\nls: cannot access "/tmp/testbucket": No such file or directory\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -l list\r\nd41d8cd98f00b204e9800998ecf8427e 2017-12-21 11:55:44 /tmp/testfile\r\n{code}\r\n\r\nBut if I back up a file not already in the local filebucket to the specified path, it creates a new filebucket at that path and backs up the file to that filebucket instead of the default local filebucket, which is what I expect would happen:\r\n\r\n{code}\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# touch /tmp/testfile2\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -b /tmp/testbucket backup /tmp/testfile2\r\n/tmp/testfile2: d41d8cd98f00b204e9800998ecf8427e\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -b /tmp/testbucket list\r\nd41d8cd98f00b204e9800998ecf8427e 2017-12-21 12:00:41 /tmp/testfile2\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -l list\r\nd41d8cd98f00b204e9800998ecf8427e 2017-12-21 11:55:44 /tmp/testfile\r\n{code}\r\n\r\nFurthermore, even when /tmp/testbucket exists, I still can"t backup the first /tmp/testfile to it. and Puppet returns a successful result without reporting which bucket received the file. So for all I get back from Puppet, I"d expect /tmp/testfile to be in /tmp/testbucket, but it isn"t:\r\n\r\n{code}\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -b /tmp/testbucket backup /tmp/testfile\r\n/tmp/testfile: d41d8cd98f00b204e9800998ecf8427e\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# echo $?\r\n0\r\nroot@mtwdsw7jqqaoq8c:/opt/puppetlabs/puppet/cache# puppet filebucket -b /tmp/testbucket list\r\nd41d8cd98f00b204e9800998ecf8427e 2017-12-21 12:00:41 /tmp/testfile2\r\n{code}\r\n\r\nThe above commands produce the same output using {{-b}} or {{--bucket}}.\r\n\r\nNone of the documentation explains that a new local filebucket can be created by using the {{--bucket}}/{{-b}} flag, a path, and a file not already backed up to the local filebucket.\r\n\r\nAlso, if the above behavior is not a bug, none of the documentation explains a file already backed up to the default local filebucket can"t be backed up to a bucket specified by {{--bucket}}, and the command output doesn"t explain that {{--bucket}} was ignored or why, making it difficult to figure out why the file isn"t backed up to the specified filebucket.\r\n\r\nAdding this ticket as a blocker to PUP-5392 because the suggested fix is to explain how to manage puppetserver"s filebucket using {{--bucket}}, but I"m not sure how using {{--bucket}} would consistently work in that context.', 'https://tickets.puppetlabs.com/browse/PUP-8285', 'https://github.com/puppetlabs/puppet/pull/6500', '2017-12-21T12:28:25.000-0800', '2018-02-06T09:13:45.000-0800', '2018-02-06T09:13:45.000-0800', 'Closed', '', 3, '0', 1, 6, 4, 3, '335b82e9f180da4cdf54c330fc7f96b346412e2f', 'https://tickets.puppetlabs.com/browse/PUP-8285', 'https://github.com/puppetlabs/puppet/pull/6500'),
('puppet', 136291, 81215748, 5197, 'File autorequire in Mount causes dependency loops', 'One of the autorequires added to Mount in 4.5.0 causes dependency loops in our install. See Acceptance Criteria first for a sample use case.\r\n\r\nThe root cause is the File type assuming that the path is a unique identifier (namevar), while that"s not true when Mounts are involved. PUP-6099 broke the workaround for that situation.\r\n\r\nWhen /x is a mountpoint, there are actually two /x directories: the *mountpoint* on the parent filesystem (/x in the / filesystem, invisible once mounted) and the *mounted directory* (the root of the mounted /x filesystem). These two directories are different system objects and may have different owners/modes/etc.\r\n\r\nThe mountpoint is just a technical prerequisite to make mount work. What we usually want to manage in depth is the mounted directory. However, PUP-6099 makes Puppet only manage the mountpoint:\r\n{noformat}\r\nFile[/x] -> Mount[/x]                    # Forced by PUP-6099\r\nMountpoint[/x] -> Mount[/x] -> File[/x]  # What we would want to do\r\n{noformat}\r\n\r\nWith Mountpoint a (not yet written) lightweight File clone that just ensures directory existence and root-ownership. So far I used an Exec hack as a quick workaround.\r\n\r\nWhy it is important that File manages the mounted directory and not the mountpoint:\r\n* This is where the content lives and where we want the full power of the File type.\r\n* Doing otherwise breaks modules which manage the mounted directory as a File (see Acceptance Criteria).\r\n\r\nSuggested course of action: roll back the autorequire (lib/puppet/type/mount.rb:301) until a resolution for the more general issue described above is available. At the very least, please make it optional.', 'https://tickets.puppetlabs.com/browse/PUP-6397', 'https://github.com/puppetlabs/puppet/pull/5197', '2016-06-09T10:05:52.000-0700', '2018-02-06T11:44:51.000-0800', '2018-02-06T11:44:51.000-0800', 'Closed', '', 17, '0', 2, 7, 18, 2, '92cce241dafc37ca204191b9f6a18ca82ccac9e9', 'https://tickets.puppetlabs.com/browse/PUP-6397', 'https://github.com/puppetlabs/puppet/pull/5197'),
('puppet', 179345, 149582892, 6320, 'Filtering resources by tag interferes with corrective vs. intentional change determination', 'Reproduction steps:\r\n• Add a _new_ resource to site.pp\r\n• Run {{puppet agent -t}} on the node\r\n• Observe that the change is properly marked as intentional\r\n• Modify the resource on disk\r\n• Run {{puppet agent -t}} on the node\r\n• Observe that the change is properly marked as corrective\r\n• Modify the resource on disk\r\n• Run {{puppet agent -t --tags faketag}} on the node (this can be done before or after the previous step)\r\n• Observe that no change is made\r\n• Run {{puppet agent -t}} on the node\r\n• Observe that the change is _wrongly_ marked as intentional\r\n\r\nThe agent uses a transaction persistence file to store the previous desired state (or actual state? unclear) which it can compare to the current state on the next run. That file seems to only include resources that are actually managed on a given run, so any resource that is skipped due to tags is omitted. That causes the agent to think that every change is intentional the next time around.\r\n\r\nI expect this is also broken for resources which are skipped due to failed dependencies, though I haven"t tested that.', 'https://tickets.puppetlabs.com/browse/PUP-8096', 'https://github.com/puppetlabs/puppet/pull/6320', '2017-03-08T14:41:52.000-0800', '2018-02-06T13:56:34.000-0800', '2018-02-06T13:56:34.000-0800', 'Closed', 'scr-candidate-irving', 5, '0', 1, 31, 0, 3, 'f4aeb95f9fd681c80b9843e2525259fa41386b2e', 'https://tickets.puppetlabs.com/browse/PUP-8096', 'https://github.com/puppetlabs/puppet/pull/6320'),
('puppet', 176372, 107745831, 5660, 'gzip decompression mangles utf-8 content in catalog', 'It appears a regression in UTF-8 handling by Puppet was introduced when gzip compression was fixed in trapperkeeper / puppet server via https://tickets.puppetlabs.com/browse/TK-429\r\n\r\nThis was discovered in investigating a local failure of the agent 1.9 series against https://github.com/puppetlabs/puppet/blob/master/acceptance/tests/resource/file/ticket_6448_file_with_utf8_source.rb against puppet server 2.7.2.master-0.1SNAPSHOT.2017.02.22T1106. We are not seeing this failure in CI presumably because CI is pinned to a released version of puppet server without this change.\r\n\r\nThe catalog returned by the server in this test contains a UTF-8 named file resource,\r\n{code}"\u9759\u7864"{code}\r\n\r\nPrior to the change, the catalog received by the agent was uncompressed and contained:\r\n{code}\r\n[5] pry(#<Puppet::Resource::Catalog::Rest>)> response.body\r\n=> "{\"tags\":[\"settings\"],\"name\":\"cpq55y0vuphp44u.delivery.puppetlabs.net\",\"version\":1487871618,\"code_id\":null,\"catalog_uuid\":\"cf89d5fd-ebdf-426a-832b-68812066c165\",\"catalog_format\":1,\"environment\":\"ticket_6448_file_with_utf8_source_j9w3rhmk\",\"resources\":[{\"type\":\"Stage\",\"title\":\"main\",\"tags\":[\"stage\"],\"exported\":false,\"parameters\":{\"name\":\"main\"}},{\"type\":\"Class\",\"title\":\"Settings\",\"tags\":[\"class\",\"settings\"],\"exported\":false},{\"type\":\"Class\",\"title\":\"main\",\"tags\":[\"class\"],\"exported\":false,\"parameters\":{\"name\":\"main\"}},{\"type\":\"File\",\"title\":\"/tmp/ticket_6448_file_with_utf8_source_j9w3rhmk.7EeVuV/\xEF\xBD\xB2\xEF\xBD\xA7\xE3\x83\x95\xE3\x83\xAB\",\"tags\":[\"file\",\"class\"],\"file\":\"/etc/puppetlabs/code/environments/ticket_6448_file_with_utf8_source_j9w3rhmk/manifests/site.pp\",\"line\":2,\"exported\":false,\"parameters\":{\"ensure\":\"present\",\"source\":\"puppet:///modules/utf8_file_module/\xE9\x9D\x99\xE7\x9A\x84\"}}],\"edges\":[{\"source\":\"Stage[main]\",\"target\":\"Class[Settings]\"},{\"source\":\"Stage[main]\",\"target\":\"Class[main]\"},{\"source\":\"Class[main]\",\"target\":\"File[/tmp/ticket_6448_file_with_utf8_source_j9w3rhmk.7EeVuV/\xEF\xBD\xB2\xEF\xBD\xA7\xE3\x83\x95\xE3\x83\xAB]\"}],\"classes\":[\"settings\"]}"\r\n{code}\r\n\r\nIt thus did not go through gzip decompression, here:\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/network/http/compression.rb#L23\r\n\r\nAfter the change, the catalog requires decompression - and the decompressed result is mangled UTF-8:\r\n{code}\r\n[4] pry(#<Puppet::Resource::Catalog::Rest>)> Zlib::GzipReader.new(StringIO.new(response.body)).read\r\n=> "{\"tags\":[\"settings\"],\"name\":\"cpq55y0vuphp44u.delivery.puppetlabs.net\",\"version\":1487871046,\"code_id\":null,\"catalog_uuid\":\"413cbbbb-9035-4ffd-84bd-d792a7cf7976\",\"catalog_format\":1,\"environment\":\"ticket_6448_file_with_utf8_source_j9w3rhmk\",\"resources\":[{\"type\":\"Stage\",\"title\":\"main\",\"tags\":[\"stage\"],\"exported\":false,\"parameters\":{\"name\":\"main\"}},{\"type\":\"Class\",\"title\":\"Settings\",\"tags\":[\"class\",\"settings\"],\"exported\":false},{\"type\":\"Class\",\"title\":\"main\",\"tags\":[\"class\"],\"exported\":false,\"parameters\":{\"name\":\"main\"}},{\"type\":\"File\",\"title\":\"/tmp/ticket_6448_file_with_utf8_source_j9w3rhmk.7EeVuV/ï½²ï½§ã\x83\x95ã\x83«\",\"tags\":[\"file\",\"class\"],\"file\":\"/etc/puppetlabs/code/environments/ticket_6448_file_with_utf8_source_j9w3rhmk/manifests/site.pp\",\"line\":2,\"exported\":false,\"parameters\":{\"ensure\":\"present\",\"source\":\"puppet:///modules/utf8_file_module/é\x9D\x99ç\x9A\x84\"}}],\"edges\":[{\"source\":\"Stage[main]\",\"target\":\"Class[Settings]\"},{\"source\":\"Stage[main]\",\"target\":\"Class[main]\"},{\"source\":\"Class[main]\",\"target\":\"File[/tmp/ticket_6448_file_with_utf8_source_j9w3rhmk.7EeVuV/ï½²ï½§ã\x83\x95ã\x83«]\"}],\"classes\":[\"settings\"]}"\r\n{code}\r\n\r\nThis is because ruby"s {{Zlib::GzipReader}} will default to decompressing as {{Encoding.default_external}} - in our environment this is not always UTF-8.\r\n\r\nThe solution is to specify -UTF\-8- BINARY encoding as part of the decompression, ie at:\r\nhttps://github.com/puppetlabs/puppet/blob/master/lib/puppet/network/http/compression.rb#L23:\r\n{code}\r\n-Zlib::GzipReader.new(StringIO.new(response.body), :encoding => Encoding::UTF_8).read-\r\nZlib::GzipReader.new(StringIO.new(response.body), :encoding => Encoding::BINARY)\r\n{code}\r\n\r\nNote - originally it was thought that we should coerce the decompressed body to UTF-8, but per https://docs.puppet.com/puppet/latest/http_api/pson.html#differences-from-json it was determined that PSON specifies ASCII-8BIT (binary). Thus we need to encode the decompressed result as binary. This is confirmed by analyzing the body returned when puppet server"s webserver is run with decompression disabled. In this case we fall through to the final statement in the compression determination, here: https://github.com/puppetlabs/puppet/blob/master/lib/puppet/network/http/compression.rb#L27, which simply returns {{response.body}}. With compression disabled, the encoding of {{response.body}} is binary:\r\n{code}\r\n[1] pry(#<Puppet::Resource::Catalog::Rest>)> response.body\r\n=> "{\"tags\":[\"settings\"],\"name\":\"beth2uuaz9mwtt3.delivery.puppetlabs.net\",\"version\":1487877686,\"code_id\":null,\"catalog_uuid\":\"f2cb0993-b259-4c77-8776-7df5500caace\",\"catalog_format\":1,\"environment\":\"ticket_6448_file_with_utf8_source_w1h8my9a\",\"resources\":[{\"type\":\"Stage\",\"title\":\"main\",\"tags\":[\"stage\"],\"exported\":false,\"parameters\":{\"name\":\"main\"}},{\"type\":\"Class\",\"title\":\"Settings\",\"tags\":[\"class\",\"settings\"],\"exported\":false},{\"type\":\"Class\",\"title\":\"main\",\"tags\":[\"class\"],\"exported\":false,\"parameters\":{\"name\":\"main\"}},{\"type\":\"File\",\"title\":\"/tmp/ticket_6448_file_with_utf8_source_w1h8my9a.4Nw2GO/\xEF\xBD\xB2\xEF\xBD\xA7\xE3\x83\x95\xE3\x83\xAB\",\"tags\":[\"file\",\"class\"],\"file\":\"/etc/puppetlabs/code/environments/ticket_6448_file_with_utf8_source_w1h8my9a/manifests/site.pp\",\"line\":2,\"exported\":false,\"parameters\":{\"ensure\":\"present\",\"source\":\"puppet:///modules/utf8_file_module/\xE9\x9D\x99\xE7\x9A\x84\"}}],\"edges\":[{\"source\":\"Stage[main]\",\"target\":\"Class[Settings]\"},{\"source\":\"Stage[main]\",\"target\":\"Class[main]\"},{\"source\":\"Class[main]\",\"target\":\"File[/tmp/ticket_6448_file_with_utf8_source_w1h8my9a.4Nw2GO/\xEF\xBD\xB2\xEF\xBD\xA7\xE3\x83\x95\xE3\x83\xAB]\"}],\"classes\":[\"settings\"]}"\r\n[2] pry(#<Puppet::Resource::Catalog::Rest>)> response.body.encoding\r\n=> #<Encoding:ASCII-8BIT>\r\n{code}\r\n\r\nNote - we also rely on Zlib::Inflate but this defaults to decompressing as ASCII-8BIT rather than default-external, which may be appropriate for our purposes.', 'https://tickets.puppetlabs.com/browse/PUP-7251', 'https://github.com/puppetlabs/puppet/pull/5660', '2017-02-23T10:29:32.000-0800', '2018-02-07T00:59:41.000-0800', '2018-02-07T00:59:41.000-0800', 'Closed', 'utf-8', 11, '0', 1, 41, 9, 2, '4d2589f35ba0a6284c376dfd06b73707c6356f06', 'https://tickets.puppetlabs.com/browse/PUP-7251', 'https://github.com/puppetlabs/puppet/pull/5660'),
('puppet', 223214, 162517109, 6513, 'Package source on Windows errors out on deduped installation files', 'We just swapped out a Windows Server 2008 R2 with a Windows Server 2016. We have deduplication enabled on the 2016 server. We have a few Windows machines with Puppet Agent installed. Since swapping to the new server, any module that uses the package resource type errors out with this:\r\n\r\n{code:java}\r\nError: DeviceIoControl(940, FSCTL_GET_REPARSE_POINT) returned unknown tag 0x80000013:  The operation completed successfully.\r\nError: /Stage[main]/Sophos::Install/Package[Sophos Anti-Virus]/ensure: change from "absent" to "present" failed: DeviceIoControl(940, FSCTL_GET_REPARSE_POINT) returned unknown tag 0x80000013:  The operation completed successfully.\r\n{code}\r\n\r\nThe only thing I can find about that error is it has something to do with deduplication. I replaced an installation file with a newer one and ran the agent again. The application installed like it did before swapping servers.\r\nIt"s not a big deal if this gets fixed for me or not. I"m fine excluding the folder with all my installations from being deduped. I just thought I"d bring it to your attention if this isn"t known yet.\r\n\r\nThis is the code for the package resource type:\r\n{code:java}\r\npackage { "Sophos Anti-Virus":\r\n  ensure => installed,\r\n  source => "//server.domain.com/installations/SophosInstallFull.exe"\r\n}\r\n{code}\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8337', 'https://github.com/puppetlabs/puppet/pull/6513', '2017-11-21T08:27:39.000-0800', '2018-02-07T09:54:07.000-0800', '2018-02-07T09:54:07.000-0800', 'Closed', '', 7, '0', 2, 61, 9, 1, '7b191840ab4ceb1f1b6d7c90528b2670ac6cac88', 'https://tickets.puppetlabs.com/browse/PUP-8337', 'https://github.com/puppetlabs/puppet/pull/6513'),
('puppet', 108731, 66360010, 4879, 'Monkey patch attempts to load same certs into OpenSSL::X509::Store objects multiple times', 'We monkey patch OpenSSL::X509::Store#set_default_paths to load our own additional certs. Specifically in the case of code that uses Net::HTTP, however, the monkey patch can be invoked multiple times, and on the second and subsequent invocations the cert(s) are already loaded into the object. This causes a warning to print very verbosely, obscuring useful output.\r\n\r\nPuppet faces or extensions that use Net::HTTP or open-uri can trigger these superfluous warnings.', 'https://tickets.puppetlabs.com/browse/PUP-5588', 'https://github.com/puppetlabs/puppet/pull/4879', '2015-12-08T12:23:42.000-0800', '2018-02-08T17:42:01.000-0800', '2018-02-08T17:42:01.000-0800', 'Closed', '', 9, '0', 2, 7, 4, 2, '4373d41b3943cc7830277a37c3ba100d04037254', 'https://tickets.puppetlabs.com/browse/PUP-5588', 'https://github.com/puppetlabs/puppet/pull/4879'),
('puppet', 232352, 166135778, 6595, 'solaris 10 doesn"t show raise from custom fact because module expects openssl in the path', 'The test tests/i18n/modules/puppet_apply_unsupported_lang.rb is intended to verify that we can get all warning and error messages when we ask for an unsupported language on the system. In this case even if you don"t ask for a different language then the default, we don"t see the "raise" message we"re expecting from the custom fact:\r\n\r\n{code}\r\n      pfuqyhk1tw6udul.delivery.puppetlabs.net (solaris10-64-1) 08:49:51$ puppet apply -e "class { "i18ndemo": filename => "/tmp/provider.LpaqLb" }"\r\n        Warning: This method is deprecated, please use the stdlib validate_legacy function,\r\n                            with Stdlib::Compat::Absolute_Path. There is further documentation for validate_legacy function in the README. at ["/etc/puppetlabs/code/environments/production/modules/i18ndemo/manifests/init.pp", 15]:\r\n           (at /etc/puppetlabs/code/environments/production/modules/stdlib/lib/puppet/functions/deprecation.rb:28:in `deprecation")\r\n        Warning: Scope(Class[I18ndemo]): Creating an i18ndemo file\r\n        Notice: Compiled catalog for pfuqyhk1tw6udul.delivery.puppetlabs.net in environment production in 0.06 seconds\r\n        Warning: /Stage[main]/I18ndemo/File[/tmp/provider.LpaqLb]: Ensure set to :present but file type is directory so no content will be synced\r\n        Notice: Applied catalog in 0.02 seconds\r\n{code}\r\n\r\nThe problem is that module is getting the openssl version available (which there isn"t one in the path on the solaris 10 boxes). Since its its not set we don"t raise.\r\n\r\n{code}\r\nopensslv = Facter::Util::Resolution.exec("openssl version")\r\n    raise _("i18ndemo_fact: this is a raise from a custom fact from eputnam-i18ndemo") if opensslv\r\n{code}\r\n\r\nWe should change the module to always raise an error and re-enable the test on solaris10\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8377', 'https://github.com/puppetlabs/puppet/pull/6595', '2018-01-23T09:01:38.000-0800', '2018-02-14T06:33:59.000-0800', '2018-02-14T06:33:59.000-0800', 'Closed', '', 5, '0', 1, 0, 2, 1, '0716fa9c5baa987fef2ff59ccbb9811e5f92f628', 'https://tickets.puppetlabs.com/browse/PUP-8377', 'https://github.com/puppetlabs/puppet/pull/6595'),
('puppet', 234347, 166576820, 6599, 'types generated by puppet generate types with title patterns are handled the wrong way', 'If a resource type has title patterns, it would end up using the default regular expression instead of the specified pattern. For most resource types this is the default and no problem would be noticed.\r\n\r\nWe found this problem in code review as there was a typo in the implementation.', 'https://tickets.puppetlabs.com/browse/PUP-8411', 'https://github.com/puppetlabs/puppet/pull/6599', '2018-02-01T02:00:58.000-0800', '2018-02-14T06:33:59.000-0800', '2018-02-14T06:33:59.000-0800', 'Closed', '', 2, '0', 1, 2, 2, 2, '13332c2e06b54c533244961e1bc407aadb9ce871', 'https://tickets.puppetlabs.com/browse/PUP-8411', 'https://github.com/puppetlabs/puppet/pull/6599'),
('puppet', 226711, 167798009, 6620, 'gem package provider broken with Rubygems 2.7.x', 'The format of {{gem list --local}} changed with the recent Rubygems 2.7.0 release. It now indicates default Gems, which looks like this:\r\n\r\n{noformat}\r\n$ gem list --local\r\n\r\n*** LOCAL GEMS ***\r\n\r\nbigdecimal (default: 1.2.8)\r\nbundler (default: 1.16.0, 1.15.1)\r\ndeep_merge (1.0.1)\r\ndid_you_mean (1.0.0)\r\n...\r\n{noformat}\r\n\r\nThis confuses the {{gem}} package provider as it now views the string {{default:}} as part of the version number. Puppet then tries to install the desired version on every Puppet agent run (for example when using the puppetlabs-ruby module):\r\n\r\n{noformat}\r\nNotice: /Stage[main]/Ruby::Dev/Package[bundler]/ensure: ensure changed ["default:", "1.15.1"] to "1.16.0"\r\n{noformat}\r\n\r\nI have implemented a naive fix for this in https://github.com/antaflos/puppet/commit/4edfeeb9a8f2546539b1c9f544440a5d30d9f55a but I am not sure if this change in Rubygems has any other implications and if my fix for this is good enough.\r\n\r\nFor reference, this is the output of {{gem env}} on an affected node:\r\n\r\n{noformat}\r\nRubyGems Environment:\r\n  - RUBYGEMS VERSION: 2.7.3\r\n  - RUBY VERSION: 2.3.1 (2016-04-26 patchlevel 112) [x86_64-linux-gnu]\r\n  - INSTALLATION DIRECTORY: /var/lib/gems/2.3.0\r\n  - USER INSTALLATION DIRECTORY: /home/ant/.gem/ruby/2.3.0\r\n  - RUBY EXECUTABLE: /usr/bin/ruby2.3\r\n  - EXECUTABLE DIRECTORY: /usr/local/bin\r\n  - SPEC CACHE DIRECTORY: /home/ant/.gem/specs\r\n  - SYSTEM CONFIGURATION DIRECTORY: /etc\r\n  - RUBYGEMS PLATFORMS:\r\n    - ruby\r\n    - x86_64-linux\r\n  - GEM PATHS:\r\n     - /var/lib/gems/2.3.0\r\n     - /home/ant/.gem/ruby/2.3.0\r\n     - /usr/lib/x86_64-linux-gnu/rubygems-integration/2.3.0\r\n     - /usr/share/rubygems-integration/2.3.0\r\n     - /usr/share/rubygems-integration/all\r\n  - GEM CONFIGURATION:\r\n     - :update_sources => true\r\n     - :verbose => true\r\n     - :backtrace => false\r\n     - :bulk_threshold => 1000\r\n  - SHELL PATH:\r\n     - /usr/local/sbin\r\n     - /usr/local/bin\r\n     - /usr/sbin\r\n     - /usr/bin\r\n     - /sbin\r\n     - /bin\r\n     - /snap/bin\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8255', 'https://github.com/puppetlabs/puppet/pull/6620', '2017-12-14T12:33:58.000-0800', '2018-02-14T06:33:59.000-0800', '2018-02-14T06:33:59.000-0800', 'Closed', '', 3, '0', 1, 11, 1, 2, '6508eb73a4f87a524dab6baf3097b1b780ae5255', 'https://tickets.puppetlabs.com/browse/PUP-8255', 'https://github.com/puppetlabs/puppet/pull/6620'),
('puppet', 235355, 167557113, 6610, 'Regression: puppet apply does not decompress response bodies for http file sources', 'The following file resource behaves incorrectly and results in a corrupt file:\r\n\r\n{code}\r\n   file { "service installer":\r\n        path => "/usr/local/bin/cleo-service",\r\n        ensure => "present",\r\n        mode => "0700",\r\n        source => "https://raw.githubusercontent.com/jthielens/versalex-ops/master/service/cleo-service",\r\n   }\r\n{code}', 'https://tickets.puppetlabs.com/browse/PUP-8420', 'https://github.com/puppetlabs/puppet/pull/6610', '2018-02-06T05:57:09.000-0800', '2018-02-14T06:34:00.000-0800', '2018-02-14T06:34:00.000-0800', 'Closed', 'regression', 4, '0', 1, 27, 3, 3, '59f2055b176271404a2a58b8145e2ccfe73db08e', 'https://tickets.puppetlabs.com/browse/PUP-8420', 'https://github.com/puppetlabs/puppet/pull/6610'),
('puppet', 235558, 167578051, 6613, 'Remove gettext-setup as a runtime gem dependency', 'Puppet version: 5.3.4\r\n\r\nWe meant to remove {{gettext-setup}} as a puppet runtime dependency, but we store gem dependencies in 3 different places for different use cases, so it was missed. See https://github.com/puppetlabs/puppet/commit/53aa50aaf6347ac166620f08224d072552e57dc3#diff-8b7db4d5cc4b8f6dc8feb7030baa2478.\r\n\r\nThis is a problem because it increases the chances of running into PUP-8418 (if gettext-setup is ever required).', 'https://tickets.puppetlabs.com/browse/PUP-8432', 'https://github.com/puppetlabs/puppet/pull/6613', '2018-02-06T17:25:57.000-0800', '2018-02-14T06:34:00.000-0800', '2018-02-14T06:34:00.000-0800', 'Closed', '', 4, '0', 1, 3, 3, 2, '2dffc4eab942e987dbf9d365b4c3c3e2448cfafa', 'https://tickets.puppetlabs.com/browse/PUP-8432', 'https://github.com/puppetlabs/puppet/pull/6613'),
('puppet', 180466, 163861677, 6551, 'resource type tidy does not honor metaparameter noop', 'The resource type tidy ignores the noop parameter. The code below removes the matching files where it should noop that operation.\r\n\r\n{code:puppet}\r\ntidy { "remove_dot_files":\r\n      path    => "/home",\r\n      matches => [ ".rhost", ".netrc", ".forward" ],\r\n      recurse => true,\r\n      noop    => true,\r\n}\r\n{code}\r\n', 'https://tickets.puppetlabs.com/browse/PUP-7349', 'https://github.com/puppetlabs/puppet/pull/6551', '2017-03-14T10:02:35.000-0700', '2018-02-14T06:34:02.000-0800', '2018-02-14T06:34:02.000-0800', 'Closed', '', 3, '0', 1, 22, 1, 2, '0c7afa95ec1d937d8376b9233650e9a7ac783c31', 'https://tickets.puppetlabs.com/browse/PUP-7349', 'https://github.com/puppetlabs/puppet/pull/6551'),
('puppet', 168858, 100283908, 5465, 'Relative paths in a hiera v3 config must not be resolved against parent of hiera.yaml', 'A datadir that is defined as a _relative path_ in a Hiera version 3 configuration must be treated as relative to the current working directory and not, as it is now, relative to the directory where the hiera.yaml file resides.', 'https://tickets.puppetlabs.com/browse/PUP-7068', 'https://github.com/puppetlabs/puppet/pull/5465', '2017-01-05T03:39:54.000-0800', '2018-02-15T04:43:49.000-0800', '2018-02-15T04:43:49.000-0800', 'Closed', '', 7, '0', 1, 61, 16, 2, '5ea197c4d04bc139fa7701e417929a5652035d8a', 'https://tickets.puppetlabs.com/browse/PUP-7068', 'https://github.com/puppetlabs/puppet/pull/5465'),
('puppet', 227641, 159594546, 6468, 'init plans in bolt do not load correctly from "bolt plan show"', '*Puppet Version: vendored \r\nbranch = feature_puppet-tasks\r\n\r\nDescribe your issue in as much detail as possible…\r\nDescribe steps to reproduce…\r\n\r\n*Desired Behavior:*\r\n\r\n\r\n*Actual Behavior:\r\nGiven the following plan\r\n{code:title=modules/foo/plans/init.pp}\r\nplan foo() {\r\n  notice "I am the init plan for the foo module"\r\n}\r\n{code}\r\n\r\nAnd I use "bolt plan show", I get the following.\r\n{code}\r\n[root@p0dv972ia1yz1v1 ~]# bolt plan show --modulepath ~/modules\r\n   (at /usr/local/share/gems/gems/bolt-9.9.afe6bdc/vendored/puppet/lib/puppet.rb:130:in `<module:Puppet>")\r\nError: The code loaded from /root/modules/foo/plans/init.pp produced plan with the wrong name, expected foo::init, actual foo on node p0dv972ia1yz1v1.delivery.puppetlabs.net\r\nFailure while reading plans\r\n{code}\r\n\r\nIf I attempt to run this plan it works correctly.  \r\n{code}\r\n[root@p0dv972ia1yz1v1 ~]# bolt plan run foo --modulepath ~/modules\r\nNotice: Scope(<module>/foo/plans/init.pp, 2): I am the init plan\r\n{code}\r\n\r\nThere is a second related issue where both list_task and list_plan methods return objects that don"t remove the {{init}} part of the task and plan names.\r\n\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8271', 'https://github.com/puppetlabs/puppet/pull/6468', '2017-12-20T11:36:07.000-0800', '2018-02-15T06:49:12.000-0800', '2018-02-15T06:49:12.000-0800', 'Closed', '', 4, '0', 1, 40, 8, 2, 'f753171016fd6ab96e233c8cfb2efda69c5e83da', 'https://tickets.puppetlabs.com/browse/PUP-8271', 'https://github.com/puppetlabs/puppet/pull/6468'),
('puppet', 225538, 156731048, 6420, 'Regression in Puppet system loader', 'One of the [commits for PUP-7864|https://github.com/puppetlabs/puppet/commit/2bc0bb869914cb33aa0078c3f9fe1fddaaefe16c] caused a regression in the puppet system loader because it assumed that "puppet/lib" would always be reachable using "lib". The regression was caught in acceptance tests where the "puppet/lib" folder is renamed to "site_ruby".\r\n', 'https://tickets.puppetlabs.com/browse/PUP-8229', 'https://github.com/puppetlabs/puppet/pull/6420', '2017-12-06T05:09:51.000-0800', '2018-02-15T06:49:12.000-0800', '2018-02-15T06:49:12.000-0800', 'Closed', '', 0, '0', 1, 34, 6, 2, '052251fdda264ec3ae5904ab55df6b699a4f5096', 'https://tickets.puppetlabs.com/browse/PUP-8229', 'https://github.com/puppetlabs/puppet/pull/6420'),
('puppet', 224773, 155640305, 6406, 'TaskSignature#runnable_with? should yield type mismatch error', 'When the PAL API TaskSignature#runnable_with? was implemented the feature found in the similar {{callable_with?}} methods for other signatures that yields a type mismatch error to a given block was forgotten.\r\n\r\nThis should be implemented so that a user of the API does not have to construct that error message manually.', 'https://tickets.puppetlabs.com/browse/PUP-8221', 'https://github.com/puppetlabs/puppet/pull/6406', '2017-11-30T03:22:33.000-0800', '2018-02-15T06:49:13.000-0800', '2018-02-15T06:49:13.000-0800', 'Closed', '', 0, '0', 1, 41, 2, 2, '244bae7c8ea8ebe2795e13f040810f1239d34599', 'https://tickets.puppetlabs.com/browse/PUP-8221', 'https://github.com/puppetlabs/puppet/pull/6406'),
('puppet', 226937, 160914040, 6489, 'PAL list_tasks doesn"t return useful results unless all task metadata is valid', 'If invalid metadata is found, {{list_tasks}} will throw an exception. We"d like to be able to log tasks that have invalid metadata (in a more controlled method, i.e. catch the exception and print a summary) while still presenting a list of valid tasks. With the current implementation of {{list_tasks}} we can"t do that.', 'https://tickets.puppetlabs.com/browse/PUP-8259', 'https://github.com/puppetlabs/puppet/pull/6489', '2017-12-15T15:11:44.000-0800', '2018-02-15T06:49:15.000-0800', '2018-02-15T06:49:15.000-0800', 'Closed', '', 6, '0', 1, 100, 33, 9, '83548e1a3413bd3fd7a46c7287816de67b6ebb85', 'https://tickets.puppetlabs.com/browse/PUP-8259', 'https://github.com/puppetlabs/puppet/pull/6489'),
('puppet', 232563, 164977045, 6569, 'modifycmd does not correctly catch and handle the `password_warn_days` option', '*Puppet Version:4.10.x\r\n\r\nWhen modifying users and passing in `--warndays` (a feature introduced in https://github.com/puppetlabs/puppet/commit/31089218e84e898e4b2388bf1ed98e08bf892968), the useradd module does not correctly handle this flag. It is supposed to use either `usermod` or `chage` depending on which aspect it is modifying, but the regex set up to catch this misses the warn days scenario (https://github.com/puppetlabs/puppet/blob/4d96086ac88b34f3ed78d61a14e246016db22b17/lib/puppet/provider/nameservice/objectadd.rb#L16). Currently, it only catches and properly handles those flags that deal with password age.\r\n\r\n*Desired Behavior: When specifying option `:password_warn_days`, use command defined for `:password" or `:localpassword`.\r\n\r\n\r\n*Actual Behavior: When passing in `:password_warn_days`, command is set to `:modify` or `:localmodify`.', 'https://tickets.puppetlabs.com/browse/PUP-8381', 'https://github.com/puppetlabs/puppet/pull/6569', '2018-01-23T15:12:22.000-0800', '2018-02-15T06:49:15.000-0800', '2018-02-15T06:49:15.000-0800', 'Closed', '', 5, '0', 1, 91, 19, 3, '331be470d7d6bd141202a390d88ca9f59c77af04', 'https://tickets.puppetlabs.com/browse/PUP-8381', 'https://github.com/puppetlabs/puppet/pull/6569'),
('puppet', 226542, 158325907, 6450, 'Parser locator doesn"t cache anything and doesn"t appear to work.', 'The Puppet::Pops::Parser::Locator attempts to cache line location information, but it ends up calling local variables {{prev_line}} etc that shadow the accessor methods of the same name.\r\n\r\nEven after fixing the code, e.g.\r\n\r\n{code:ruby}\r\n        self.prev_offset = offset\r\n        self.prev_line = line_nbr\r\n{code}\r\n\r\nThe caching mechanism does not appear to work even when using unlimited environment timeouts. Given a manifest:\r\n\r\n{code:puppet}\r\nfile { "/tmp/testing":\r\n  ensure => present,\r\n}\r\n{code}\r\n\r\nI get the following instrumented output which shows it keeps getting cache misses:\r\n\r\n{noformat}\r\nDebug: Evaluating match for Route /.*/\r\nNotice: Locator cache miss offset=25 => line number=2\r\nNotice: Locator cache miss offset=0 => line number=1\r\nNotice: Compiled catalog for localhost in environment production in 0.00 seconds\r\n{noformat}\r\n\r\nThis ticket is to fix the cache implementation and add tests that it works. Currently the Locator unit tests only show that it can handle multibyte input.\r\n\r\nSecond issue is we seem to collect locator information for puppet data types on every request. Since those are immutable, why not do that once and freeze the results for the lifetime of the process?\r\n\r\n{noformat}\r\nNotice: Locator string=Annotation, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Any, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::CatalogEntryType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarDataType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::NumericType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarDataType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarDataType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::NumericType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarDataType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::CollectionType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::StructElement, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarDataType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::ScalarType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::CollectionType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::CatalogEntryType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Pcore::AnyType, file=, index=, char_offsets=false\r\nNotice: Locator string=Puppet::Resource::Param, file=, index=, char_offsets=false\r\nNotice: Locator string=Puppet::Resource::Param, file=, index=, char_offsets=false\r\nNotice: Locator string=Any, file=, index=, char_offsets=false\r\nNotice: Locator string=RichDataKey, file=, index=, char_offsets=false\r\nNotice: Locator string=RichData, file=, index=, char_offsets=false\r\n{noformat}', 'https://tickets.puppetlabs.com/browse/PUP-8247', 'https://github.com/puppetlabs/puppet/pull/6450', '2017-12-13T13:29:06.000-0800', '2018-02-15T06:49:16.000-0800', '2018-02-15T06:49:16.000-0800', 'Closed', '', 4, '0', 2, 25, 7, 2, '62bd012537555685dfd6c9da862039535a626d6c', 'https://tickets.puppetlabs.com/browse/PUP-8247', 'https://github.com/puppetlabs/puppet/pull/6450');
